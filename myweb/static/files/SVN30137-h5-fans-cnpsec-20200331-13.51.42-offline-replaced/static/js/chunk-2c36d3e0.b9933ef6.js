(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2c36d3e0"],{"097d":function(t,e,r){var a=r("5ca1"),o=r("8378"),n=r("7726"),i=r("ebd6"),s=r("bcaa");a(a.P+a.R,"Promise",{finally:function(t){var e=i(this,o.Promise||n.Promise),r="function"==typeof t;return this.then(r?function(r){return s(e,t()).then((function(){return r}))}:t,r?function(r){return s(e,t()).then((function(){throw r}))}:t)}})},6703:function(t,e,r){r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"page-container"},[r("Search",{staticClass:"order-search",attrs:{searchFunc:t.searchOrder,searchResult:t.searchOrderResult},on:{cancelSearch:t.handleCancelSearch},scopedSlots:t._u([{key:"search-result",fn:function(t){var e=t.resultItem;return[r("OrderCard",{staticClass:"order-card",attrs:{orderData:e}})]}}])}),r("CommonTab",{staticClass:"order-tab",attrs:{tabList:t.orderTabList},model:{value:t.orderStatus,callback:function(e){t.orderStatus=e},expression:"orderStatus"}}),r("div",{staticClass:"order-list"},[r("LoadMore",{attrs:{bottomMethod:t.loadBottom,canInif:t.canInif,isFinal:!t.canInif}},[t._l(t.orderList,(function(t,e){return r("OrderCard",{key:e,staticClass:"order-card",attrs:{orderData:t}})})),!t.loading&&t.noDataFlag?r("NoData"):t._e(),t.canInif||t.noDataFlag?t._e():r("div",{staticClass:"reach-bottom"},[t._v("已经到底了")])],2)],1)],1)},o=[],n=(r("097d"),r("d225")),i=r("b0b4"),s=r("308d"),c=r("6bb5"),d=r("4e2b"),u=r("9ab4"),l=r("60a3"),f=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"order-card-container",class:{"order-cancel":"2"===t.orderData.order_status},on:{click:t.handleClickOrder}},[r("div",{staticClass:"order-title"},[r("span",[r("b",{staticClass:"order-type-icon",style:t.formatOrderTypeColor(t.orderData.order_type)},[r("i",{staticClass:"icon iconfont-cnpsec",class:t.formatOrderTypeIcon(t.orderData.order_type)})]),t._v(t._s(t._f("formatOrderType")(t.orderData.order_type))+"\n    ")]),r("b",{class:t.formatOrderStatusClass(t.orderData.order_status)},[t._v(t._s(t._f("formatOrderStatus")(t.orderData.order_status)))])]),r("div",{staticClass:"order-content"},[r("div",{staticClass:"order-name"},[t._v(t._s(t._f("formatOrderType")(t.orderData.order_type))+"名称："+t._s(t.orderData.order_title))]),r("ul",{staticClass:"order-info-list"},[r("li",[r("span",[t._v("下单时间")]),r("em",[t._v(t._s(t.orderData.order_time))])]),r("li",[r("span",[t._v("支付时间")]),r("em",[t._v(t._s(t.orderData.time_end))])]),r("li",[r("span",[t._v("到期日")]),r("em",[t._v(t._s(t.orderData.order_type>=4?t.orderData.expire_time:""))])])])]),r("div",{staticClass:"order-foot"},[r("div",{staticClass:"order-price"},[t._v("合计：¥"+t._s(t.orderData.order_price))]),r("div",{staticClass:"order-option"},[0===+t.orderData.order_status?r("div",{staticClass:"order-btn cancel",on:{click:function(e){return e.target!==e.currentTarget?null:(e.stopPropagation(),t.handleClickCancel(e))}}},[t._v("取消订单\n      ")]):t._e(),0===+t.orderData.order_status?r("div",{staticClass:"order-btn pay",on:{click:function(e){return e.target!==e.currentTarget?null:(e.stopPropagation(),t.handleClickPay(e))}}},[t._v("付款")]):t._e(),1===+t.orderData.order_status?r("div",{staticClass:"order-btn cancel",on:{click:function(e){return e.target!==e.currentTarget?null:(e.stopPropagation(),t.handleClickRefund(e))}}},[t._v("退款")]):t._e(),3===+t.orderData.order_status?r("div",{staticClass:"order-btn cancel",on:{click:function(e){return e.target!==e.currentTarget?null:(e.stopPropagation(),t.handleClickRefundCancel(e))}}},[t._v("\n        取消退款\n      ")]):t._e()])])])},h=[],v=(r("a481"),r("96cf"),r("3b8d")),p=r("d257"),_=r("4bb5"),g=function(t){function e(){var t;return Object(n["a"])(this,e),t=Object(s["a"])(this,Object(c["a"])(e).apply(this,arguments)),t.payResultShow=!1,t.payResultState=0,t.btnClock=!1,t}return Object(d["a"])(e,t),Object(i["a"])(e,[{key:"formatOrderTypeColor",value:function(t){var e={1:"#629EFA",2:"#E84342",3:"#629EFA",4:"#FF7006",5:"#FF7006",6:"#FF7006",7:"#FF7006",8:"#E84342",9:"#E84342",10:"#E84342",11:"#E84342"};return{backgroundColor:e[t]}}},{key:"formatOrderTypeIcon",value:function(t){var e={1:"iconfont-order-answer",2:"iconfont-order-viewpoint",3:"iconfont-order-answer",4:"iconfont-order-combine",5:"iconfont-order-combine",6:"iconfont-order-combine",7:"iconfont-order-combine",8:"iconfont-order-viewpointpkg",9:"iconfont-order-viewpointpkg",10:"iconfont-order-viewpointpkg",11:"iconfont-order-viewpointpkg"};return e[t]}},{key:"formatOrderStatusClass",value:function(t){var e={0:"not-pay",1:"payed",2:"",3:"",4:"",5:""};return e[t]}},{key:"handleClickRefund",value:function(){var t=this,e=this.$options.filters;this.$dialog.confirm({title:"系统提示",message:'<span class="text-overflow">'.concat(e.formatOrderType(this.orderData.order_type),"名称：").concat(this.orderData.order_title,"</span><br>确定要退款?"),showCancelButton:!0,cancelButtonColor:"#999",cancelButtonText:"取消",confirmButtonColor:"#E84A4D",confirmButtonText:"确定"}).then((function(){t.refundOrder()})).catch((function(){}))}},{key:"refundOrder",value:function(){var t=this;this.$services.modifyOrder({data:{order_id:this.orderData.order_id,order_status:"3"}}).then((function(e){var r=e;"0"===r.error_no&&(t.$toast("退款申请成功提交，请等待客服处理"),t.orderData.order_status="3")}))}},{key:"handleClickRefundCancel",value:function(){var t=this,e=this.$options.filters;this.$dialog.confirm({title:"系统提示",message:'<span class="text-overflow">'.concat(e.formatOrderType(this.orderData.order_type),"名称：").concat(this.orderData.order_title,"</span><br>确定要取消退款?"),showCancelButton:!0,cancelButtonColor:"#999",cancelButtonText:"取消",confirmButtonColor:"#E84A4D",confirmButtonText:"确定"}).then((function(){t.$services.modifyOrder({data:{order_id:t.orderData.order_id,order_status:"1"}}).then((function(e){var r=e;"0"===r.error_no&&(t.$toast("退款申请已取消"),t.orderData.order_status="1")}))})).catch((function(){}))}},{key:"handleClickCancel",value:function(){var t=this;this.$dialog.confirm({title:"系统提示",message:"确定要取消此订单吗？",showCancelButton:!0,cancelButtonColor:"#E84A4D",cancelButtonText:"再看看",confirmButtonColor:"#999",confirmButtonText:"确定取消"}).then((function(){t.$services.orderCancel({data:{order_id:t.orderData.order_id}}).then((function(e){t.orderData.order_status="2",t.$toast("取消订单成功")})).catch((function(e){console.log("orderCancel error: ",e),t.$toast("取消订单失败")}))})).catch((function(){}))}},{key:"handleClickPay",value:function(){var t=this;this.userInfo.is_trade_login?this.$services.getOrderStatus({data:{order_type:this.orderData.order_type,relation_id:this.orderData.relation_id}}).then((function(e){var r=e;r.order_string||t.$toast("支付失败！")})).catch((function(e){t.$toast("支付失败！"),console.log("getOrderStatus error: ",e)})):this.$store.dispatch("nativeFundAccountLogin")}},{key:"payResult",value:function(){var t=Object(v["a"])(regeneratorRuntime.mark((function t(e,r){var a,o,n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=r.replace(/^\{|}$/g,"").replace(/\"\"/g,""),o=a.resultStatus,this.$services.getPayResult({data:{order_id:e}}).then((function(t){console.log("getPayResult",t),9e3===+o?(n.orderData.order_status=t.data.order_status,n.$toast("支付成功！")):n.$toast("支付失败！")})).catch((function(t){n.$toast("支付失败！"),console.log("payResult error: ",t)}));case 2:case"end":return t.stop()}}),t,this)})));function e(e,r){return t.apply(this,arguments)}return e}()},{key:"handleClickOrder",value:function(){var t={1:this.navigateToAskDetail,2:this.navigateToViewDetail,4:this.navigateToProductDetail,5:this.navigateToProductDetail,6:this.navigateToProductDetail,7:this.navigateToProductDetail,8:this.navigateToViewPkgDetail,9:this.navigateToViewPkgDetail,10:this.navigateToViewPkgDetail,11:this.navigateToViewPkgDetail};t[this.orderData.order_type]()}},{key:"navigateToProductDetail",value:function(){Object(p["m"])("/productDetail",{combineCode:this.orderData.relation_id,combineName:this.orderData.order_title,brokerId:this.orderData.broker_id})}},{key:"navigateToViewPkgDetail",value:function(){Object(p["m"])("/viewPackageDetail",{viewpointPkgId:this.orderData.relation_id,brokerId:this.orderData.broker_id})}},{key:"navigateToAskDetail",value:function(){"0"!==this.orderData.order_status?Object(p["m"])("/askDetail",{questionId:this.orderData.relation_id}):this.$toast("悬赏提问，需要先支付，才能看细节")}},{key:"navigateToViewDetail",value:function(){Object(p["m"])("/viewDetail",{viewId:this.orderData.relation_id,brokerId:this.orderData.broker_id})}}]),e}(l["c"]);Object(u["a"])([Object(l["b"])({type:Object,default:function(){return{}}})],g.prototype,"orderData",void 0),Object(u["a"])([_["a"]],g.prototype,"payResultOption",void 0),Object(u["a"])([_["a"]],g.prototype,"userInfo",void 0),g=Object(u["a"])([Object(l["a"])({filters:{formatOrderType:function(t){var e={1:"问答",2:"观点",3:"围观",4:"组合",5:"组合",6:"组合",7:"组合",8:"观点包",9:"观点包",10:"观点包",11:"观点包"};return e[t]},formatOrderStatus:function(t){var e={0:"待支付",1:"已支付",2:"已失效",3:"待退款",4:"已退款",5:"已评价"};return e[t]}}})],g);var b=g,y=b,k=(r("8a23"),r("2877")),D=Object(k["a"])(y,f,h,!1,null,"e6300828",null),m=D.exports,O=r("a2c9"),C=r("501e"),w=r("9d59"),T=r("26b9"),j=r("b3af"),S=function(t){function e(){var t;return Object(n["a"])(this,e),t=Object(s["a"])(this,Object(c["a"])(e).apply(this,arguments)),t.pageNo=1,t.orderList=[],t.loading=!1,t.canInif=!0,t.orderTabList=[{name:"全部",key:"-1"},{name:"待支付",key:"0"},{name:"待退款",key:"3"}],t.orderStatus="-1",t.keyword="",t.searchOrderResult=[],t}return Object(d["a"])(e,t),Object(i["a"])(e,[{key:"onTabIndexChange",value:function(){var t=this;this.pageNo=1,this.canInif=!0,this.getOrderList().then((function(e){t.orderList=e,t.updateListState(e)}))}},{key:"activated",value:function(){var t=this;this.getOrderList().then((function(e){t.orderList=e,t.updateListState(e)}))}},{key:"deactivated",value:function(){this.resetListData()}},{key:"resetListData",value:function(){this.pageNo=1,this.orderList=[],this.loading=!1,this.canInif=!0,this.keyword=""}},{key:"getOrderList",value:function(){var t=this;this.loading=!0;var e={order_status:"-1"===this.orderStatus?"":this.orderStatus,page_no:this.pageNo,page_size:j["g"],tenant_id:this.userInfo.tenant_id,user_id:this.userInfo.user_id,keyword:this.keyword};return this.$services.funcOrderManage({data:e}).then((function(t){return t.data_list||[]})).catch((function(e){return t.$toast("获取订单列表失败"),console.log("funcOrderManage error: ",e),[]})).finally((function(){t.loading=!1}))}},{key:"updateListState",value:function(t){t.length&&(this.pageNo+=1),t.length<j["g"]&&(this.canInif=!1)}},{key:"loadBottom",value:function(){var t=this;this.getOrderList().then((function(e){t.orderList=t.orderList.concat(e),t.updateListState(e)}))}},{key:"searchOrder",value:function(t){var e=this;return this.keyword=t,this.pageNo=1,this.getOrderList().then((function(t){e.searchOrderResult=t}))}},{key:"handleTabChange",value:function(t){this.orderStatus!==t&&(this.resetListData(),this.orderStatus=t)}},{key:"handleCancelSearch",value:function(){this.keyword=""}},{key:"noDataFlag",get:function(){return 0===this.orderList.length}}]),e}(l["c"]);Object(u["a"])([_["a"]],S.prototype,"userInfo",void 0),Object(u["a"])([Object(l["d"])("orderStatus")],S.prototype,"onTabIndexChange",null),S=Object(u["a"])([Object(l["a"])({components:{OrderCard:m,LoadMore:O["a"],NoData:C["a"],Search:w["a"],CommonTab:T["a"]}})],S);var L=S,$=L,I=(r("fd8f"),Object(k["a"])($,a,o,!1,null,"2f291a4c",null));e["default"]=I.exports},"8a23":function(t,e,r){var a=r("c86b"),o=r.n(a);o.a},"9f94":function(t,e,r){},c86b:function(t,e,r){},f6ab:function(t,e,r){t.exports=r.p+"static/img/bg_no_data.93c56ab0.png"},fd8f:function(t,e,r){var a=r("9f94"),o=r.n(a);o.a}}]);