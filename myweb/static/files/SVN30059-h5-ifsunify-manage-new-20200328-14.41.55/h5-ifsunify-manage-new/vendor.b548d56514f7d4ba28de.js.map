{"version":3,"sources":["webpack:///vendor.b548d56514f7d4ba28de.js","webpack:///./~/ng-table-excel-export/ng-table-excel-export.js","webpack:///./~/ng-table-excel-export/ng-table-excel-export.js?db66","webpack:///./~/script-loader/addScript.js","webpack:///./~/ng-table-excel-export/ng-table-excel-export.js?6e20","webpack:///./~/tinymce/tinymce.js","webpack:///./~/sha256/lib/sha256.js","webpack:///./~/convert-hex/convert-hex.js","webpack:///./~/convert-string/convert-string.js"],"names":["webpackJsonp","3","module","exports","__webpack_require__","global","ExcellentExport","b64toBlob","b64Data","contentType","sliceSize","offset","byteCharacters","window","atob","byteArrays","length","i","slice","byteNumbers","Array","charCodeAt","byteArray","Uint8Array","push","Blob","type","createDownloadLink","anchor","base64data","exporttype","filename","blob","navigator","msSaveBlob","URL","createObjectURL","blobUrl","href","hrefvalue","download","template","excel","csvDelimiter","csvNewLine","base64","s","btoa","unescape","encodeURIComponent","format","c","replace","RegExp","m","p","get","element","nodeType","document","getElementById","fixCSVField","value","fixedValue","addQuotes","indexOf","replaceDoubleQuotes","tableToCSV","table","j","row","col","data","columnStart","rows","rowData","className","cells","textContent","trim","tableToHTML","name","htmlTableData","worksheet","csv","delimiter","newLine","undefined","csvData","309","310","src","log","error","console","execScript","attachEvent","addEventListener","eval","call","311","312","domGlobals","curry","fn","initialArgs","_i","arguments","restArgs","all","concat","apply","__rest","e","t","Object","prototype","hasOwnProperty","getOwnPropertySymbols","propertyIsEnumerable","StyleSheetLoader","settings","maxLoadTime","idCount","loadedStates","_setReferrerPolicy","referrerPolicy","appendToHead","node","getElementsByTagName","appendChild","load","url","loadedCallback","errorCallback","link","style","startTime","state","resolve","status","passed","failed","onload","onerror","callbacks","wait","testCallback","waitCallback","Date","getTime","Delay","setTimeout","waitForWebKitLinkLoaded","styleSheet","owner","styleSheets","ownerNode","owningElement","id","waitForGeckoLinkLoaded","cssRules","sheet","ex","Tools","_addCacheSuffix","createElement","rel","async","defer","contentCssCors","crossOrigin","set","Element","fromDom","webKitChunks","userAgent","match","parseInt","loadF","Future","nu","compose","constant","Result","unbox","result","fold","identity","loadAll","urls","success","failure","par$1","map","parts","partition","r","isValue","fail","pass","Schema","validStyles","invalidStyles","schemaItems","whiteSpaceElementsMap","selfClosingElementsMap","shortEndedElementsMap","boolAttrMap","validClasses","blockElementsMap","nonEmptyElementsMap","moveCaretBeforeOnEnterElementsMap","textBlockElementsMap","textInlineElementsMap","elements","children","patternElements","customElementsMap","specialElements","createLookupTable","option","defaultValue","extendWith","makeMap$2","toUpperCase","mapCache","extend$1","compileSchema","schema","verify_html","valid_elements","compileElementMap","valid_styles","invalid_styles","valid_classes","each$3","special","split","patternToRegExp","str","addValidElements","validElements","ei","el","ai","al","matches","attr","attrData","elementName","attrName","attrType","attributes","attributesOrder","prefix","outputName","globalAttributes","globalAttributesOrder","key","elementRuleRegExp","attrRuleRegExp","hasPatternsRegExp","exec","paddEmpty","removeEmpty","removeEmptyAttrs","attributesRequired","required","splice","inArray","attributesDefault","attributesForced","forcedValue","validValues","test","attributePatterns","pattern","setValidElements","addCustomElements","customElements","customElementRegExp","text_block_elements","block_elements","rule","inline","cloneName","customRule","elmName","addValidChildren","validChildren","childRuleRegExp","parent","child","getElementRule","item","custom_elements","valid_children","extended_valid_elements","dd","dt","li","td","th","tr","tbody","thead","tfoot","legend","area","param","parents","parentsRequired","invalid_elements","explode$1","getValidStyles","getInvalidStyles","getValidClasses","getBoolAttrs","getBlockElements","getTextBlockElements","getTextInlineElements","getShortEndedElements","getSelfClosingElements","getNonEmptyElements","getMoveCaretBeforeOnEnterElements","getWhiteSpaceElements","getSpecialElements","isValidChild","toLowerCase","isValid","attrPatterns","getCustomElements","createCache","cache","keys","Expr","cacheLength","shift","markFunction","expando","siblingCheck","a","b","cur","diff","sourceIndex","MAX_NEGATIVE","nextSibling","createPositionalPseudo","argument","seed","matchIndexes","testContext","context","strundefined","setFilters","toSelector","tokens","len","selector","addCombinator","matcher","combinator","base","dir","checkNonElements","doneName","done","first","elem","xml","oldCache","outerCache","newCache","dirruns","elementMatcher","matchers","multipleContexts","contexts","results","Sizzle","condense","unmatched","filter","newUnmatched","mapped","setMatcher","preFilter","postFilter","postFinder","postSelector","temp","preMap","postMap","preexisting","elems","matcherIn","matcherOut","indexOf$2","matcherFromTokens","checkContext","leadingRelative","relative","implicitRelative","matchContext","matchAnyContext","outermostContext","rtrim","matcherFromGroupMatchers","elementMatchers","setMatchers","bySet","byElement","superMatcher","outermost","matchedCount","setMatched","contextBackup","find","TAG","dirrunsUnique","Math","random","pop","uniqueSort","DOMUtils","doc","_this","this","attrHooks","addedStyles","win","files","counter","styleSheetLoader","boundEvents","styles","Styles","url_converter","url_converter_scope","events","ownEvents","EventUtils","Event","$","DomQuery","overrideDefaults","self","getRoot","isBlock","nodeName","elm","getElementsByName","$$","getAttrib","defaultVal","hook","$elm","getAttribs","setAttrib","originalValue","onSetAttrib","attrElm","attrValue","clone","deep","isIE","cloneNode","clone_1","each$5","root_element","body","getViewPort","argWin","vp","getBounds","x","y","w","width","h","height","getPos","rootElm","Position$1","setStyle","isString","css","update_styles","updateInternalStyleAttr","setStyles","stylesArg","getStyle","computed","Env","browser","getSize","offsetWidth","clientWidth","offsetHeight","clientHeight","getRect","pos","size","is","isArray","simpleSelectorRe","selectors","elms","ownerDocument","getParents","root","collect","selectorVal","parentNode","getParent","_findSib","func","getNext","getPrev","select","scope","run","setAttribs","attrs","each","setHTML","html","target","canHaveHTML","firstChild","removeChild","innerHTML","contents","appendTo","add","parentElm","create","newElm","decode","Entities","encode","encodeAllRaw","createHTML","outHtml","createFragment","container","frag","createDocumentFragment","remove","keepChildren","$node","insertBefore","toArray","removeAllAttribs","removeAttributeNode","parseStyle","cssText","parse","serializeStyle","serialize","addStyle","head","styleElm","DOM","createTextNode","loadCSS","__assign","toggleClass","cls","addClass","removeClass","hasClass","show","hide","isHidden","uniqueId","getOuterHTML","NodeType","isElement","outerHTML","append","setOuterHTML","insertAfter","reference","referenceNode","oldElm","grep$1","childNodes","replaceChild","rename","attrNode","findCommonAncestor","pe","ps","documentElement","toHex","rgbVal","isEmpty","brCount","walker","TreeWalker","whitespace","bogusVal","getAttribute","next","whiteSpaceRegExp$2","nodeValue","createRng","createRange","splitElm","replacementElm","bef","aft","pa","setStart","findNodeIndex","setEnd","extractContents","TrimNode","trimNode","bind","rv","unbind","fire","evt","getContentEditable","contentEditable","getContentEditableParent","destroy","setDocument","isChildOf","dumpRng","startContainer","startOffset","endContainer","endOffset","stdMode","boxModel","nodeIndex","setupAttrHooks","AddOnManager","items","lookup","_listeners","runListeners","matchedListeners","listener","callback","instance","dependencies","requireLangPack","languages","languageLoad","waitFor","language","I18n","getCode","wrappedLanguages","ScriptLoader","addOn","addOnConstructor","createUrl","baseUrl","dep","resource","suffix","addComponents","pluginName","scripts","pluginUrl","script","loadDependencies","addOnUrl","deps","newUrl","urlString","baseURL","substring","lastIndexOf","has","ClosestOrAncestor","ancestor","isRoot","Option","some","isFunction","none","CaretPosition","clientRects","isAtStart","isText$4","isAtEnd","toRange","range","getClientRects","getCaretPositionClientRects","isVisible","isEqual","caretPosition","getNode","before","resolveIndex","SaxParser","noop","fix_self_closing","comment","cdata","text","start","end","pi","doctype","endRegExp","attrList","textData","isInternalElement","removeInternalElements","shortEndedElements","fillAttrsMap","isShortEnded","validate","elementRule","isValidElement","attribsValue","validAttributesMap","validAttributePatterns","processHtml","anyAttributesRequired","selfClosing","tokenRegExp","attrRegExp","fixSelfClosing","index","stack","filteredUrlAttrs","makeMap","scriptUriRegExp","parsingMode","processEndTag","valid","processComment","charAt","allow_conditional_comments","substr","processMalformedComment","startIndex","startTag","isBogus","startsWith","endIndex","findCommentEndIndex","parseAttribute","val2","val3","attrRule","trimRegExp","isValidPrefixAttrName","allow_script_urls","uri","decodeURIComponent","isInvalidUri","self_closing_elements","remove_internals","matchText","bogusValue","checkBogusAttribute","findEndTagIndex","lastIndex","isValidCdataSection","preserve_cdata","NotificationManagerImpl","unimplemented","Error","open","close","reposition","getArgs","NotificationManager","editor","notifications","getImplementation","theme","getNotificationManagerImpl","getTopNotification","from","progressBar","timeout","addNotification","notification","closeNotification","findIndex","otherNotification","spec","removed","EditorView","isEditorAttachedToDom","getOrThunk","editorManager","setActive","getNotifications","on","serviceMessage","service_message","requestAnimationFrame","WindowManagerImpl","openUrl","alert","confirm","getParams","setParams","BookmarkManager","selection","getBookmark","Bookmarks","moveToBookmark","SelectorChanged","dom","selectorChangedData","currentSelectors","selectorChangedWithUnbind","matchedSelectors","deleteFromCallbackMap","ImageScanner","uploadStatus","blobCache","cachedPromises","findAll","predicate","images","getAllImages","img","fileApi","hasAttribute","transparentSrc","isUploaded","promises","promiseObj","then","imageInfo","image","blobInfo","newPromise","reject","imageToBlobInfo","catch","Uploader","pendingPromises","pathJoin","path1","path2","defaultHandler","progress","xhr","formData","XMLHttpRequest","withCredentials","credentials","upload","onprogress","loaded","total","json","JSON","responseText","location","basePath","FormData","send","noUpload","handlerSuccess","handlerFailure","resolvePending","blobUri","uploadBlobInfo","handler","openNotification","markPending","closeNotification_1","markUploaded","removeFailed","percent","message","isDefaultHandler","pendingUploadBlobInfo","uploadBlobs","blobInfos","grep","isPending","UploadStatus","blobUriStatuses","createStatus","resultUri","hasBlobUri","getResultUri","FormatRegistry","formats","has$1","register","mixed","block_expand","classes","unregister","DefaultFormats","RangeUtils","walk","rng","RangeWalk","split$1","normalize","NormalizeRange","normalizedRng","fa","fb","args","not","f","die","msg","never","always","NONE","eq","o","isNone","thunk","n","me","isSome","getOr","getOrDie","getOrNull","getOrUndefined","or","orThunk","exists","forall","equals","equals_","toString","freeze","constant_a","v","elementEq","typeOf","isPrototypeOf","constructor","String","isType","isObject","isNull","isBoolean","isNumber","nativeSlice","nativeIndexOf","nativePush","rawIndexOf","ts","xs","contains","pred","eachr","foldr","acc","foldl","flatten","reverse","difference","a1","a2","mapToObject","sort","comparator","copy","last","from$1","each$1","obj","props","k","map$1","tupleMap","tuple","objAcc","internalFilter","onTrue","onFalse","bifilter","assign","fromHtml","div","hasChildNodes","fromTag","tag","fromText","fromPoint","docElm","elementFromPoint","Cell","initial","firstMatch","regexes","find$1","agent","major","minor","group","Number","detect","versionRegexes","cleanedAgent","unknown","Version","isBrowser","current","unknown$1","nu$1","version","info","isEdge","isChrome","isOpera","isFirefox","isSafari","Browser","edge","chrome","ie","opera","firefox","safari","isOS","unknown$2","nu$2","isWindows","isiOS","isAndroid","isOSX","isLinux","isSolaris","isFreeBSD","isChromeOS","OperatingSystem","windows","ios","android","linux","osx","solaris","freebsd","chromeos","DeviceType","os","mediaMatch","isiPad","isiPhone","isMobile","isTouch","isTablet","isPhone","iOSwebview","isDesktop","isWebView","detect$1","candidates","candidate","search","detectBrowser","browsers","detectOs","oses","UaString","checkRange","contains$1","lTrim","rTrim","normalVersionRegex","checkContains","uastring","PlatformInfo","detect$2","deviceType","PlatformDetection","query","matchMedia","platform","detect$3","Immutable","fields","values","struct","recurse","Recurse","compareDocumentPosition","documentPositionPreceding","Node","DOCUMENT_POSITION_PRECEDING","documentPositionContainedBy","DOCUMENT_POSITION_CONTAINED_BY","DOCUMENT","ATTRIBUTE_NODE","CDATA_SECTION_NODE","COMMENT_NODE","DOCUMENT_NODE","ELEMENT","DOCUMENT_TYPE_NODE","DOCUMENT_FRAGMENT_NODE","ELEMENT_NODE","TEXT","TEXT_NODE","ELEMENT$1","PROCESSING_INSTRUCTION_NODE","ENTITY_REFERENCE_NODE","ENTITY_NODE","NOTATION_NODE","DOCUMENT$1","msMatchesSelector","webkitMatchesSelector","mozMatchesSelector","bypassSelector","childElementCount","querySelectorAll","one","querySelector","e1","e2","regularContains","d1","d2","ieContains","contains$2","defaultView","stop","ret","rawParent","prevSibling","previousSibling","prevSiblings","nextSiblings","cs","lastChild","childNodesCount","marker","after","prepend","wrap","wrapper","before$1","append$1","empty","rogue","unwrap","children$1","Function","isType$1","isText","inBody","left","top","translate","Position","boxPosition","box","getBoundingClientRect","firstDefinedOrZero","absolute","offsetLeft","offsetTop","scrollTop","pageYOffset","scrollLeft","pageXOffset","clientTop","clientLeft","viewport","get$1","_DOC","to","scrollTo","intoView","alignToTop","scrollIntoViewIfNeeded","scrollIntoView","get$2","_win","bounds","right","bottom","scroll","visualViewport","max","pageLeft","pageTop","isNodeType","isRestrictedNode","getPrototypeOf","isElement$1","matchNodeNames","names","lowercasedNames","matchStyleValues","getComputedStyle","getPropertyValue","hasPropValue","propName","propValue","hasAttributeValue","isBogusAll","isTable","tagName","hasContentEditableState","isTextareaOrInput","isText$1","isComment","isDocument","isDocumentFragment","isBr","isContentEditableTrue","isContentEditableFalse","isSupported","rawSet","setAttribute","setAll","get$3","getOpt","remove$1","removeAttribute","get$4","property","getUnsafeProperty","getRaw","raw","reflow","browser$1","firstElement","nodes","getTableCaptionDeltaY","caption","bodyTop","captionTop","captionHeight","hasChild","offsetParent","exports$1","module$1","define","require","amd","g","EphoxContactWrapper","u","code","1","defaultSetTimout","defaultClearTimeout","runTimeout","fun","cachedSetTimeout","runClearTimeout","cachedClearTimeout","clearTimeout","cleanUpNextTick","draining","currentQueue","queue","queueIndex","drainQueue","Item","array","process","nextTick","title","env","argv","versions","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","binding","cwd","chdir","umask","2","setImmediate","thisArg","Promise","TypeError","_state","_handled","_value","_deferreds","doResolve","handle","deferred","_immediateFn","cb","onFulfilled","onRejected","promise","newValue","finale","_unhandledRejectionFn","Handler","reason","setTimeoutFunc","prom","arr","res","val","remaining","race","err","_setImmediateFn","_setUnhandledRejectionFn","clearImmediate","Timeout","clearFn","_id","_clearFn","immediateIds","nextImmediateId","setInterval","clearInterval","unref","ref","enroll","msecs","_idleTimeoutId","_idleTimeout","unenroll","_unrefActive","active","_onTimeout","4","promisePolyfill","Global","boltExport","requestAnimationFramePromise","namedEntities","baseEntities","reverseEntities","nu$3","baseFn","nCallback","isReady","cbs","pure","LazyValue","errorReporter","make","fab","aFutureB","toPromise","anonBind","futureB","toLazy","toCached","nu$4","pure$1","par","asyncValues","count","asyncValue","futures","opt","mapError","_","onValue","toOption","isError","onError","fromOption","asap","immediateFn","requestAnimationFrameFunc","vendors","featurefill","wrappedSetTimeout","time","wrappedSetInterval","wrappedClearTimeout","wrappedClearInterval","debounce","timer","setEditorTimeout","setEditorInterval","throttle","platform$1","browser$2","webkit","windowsPhone","gecko","mac","iOS","caretAfter","getSelection","documentMode","ceFalse","cacheSuffix","experimentalShadowDom","canHaveCSP","desktop","isArray$1","toArray$1","l","each$2","map$2","out","filter$1","indexOf$1","reduce","collection","iteratee","accumulator","findIndex$1","find$2","idx","last$1","ArrUtils","whiteSpaceRegExp","trim$1","is$1","delim","hasOwnProperty$1","prop","sp","ns","cn","scn","de","createNS","onCreate","extend","static","ext","explode","d","hasOwn","blocks","voids","tableCells","tableSections","textBlocks","headings","listItems","lists","wsElements","lazyLookup","isHeading","isTable$1","isInline","isBr$1","isTextBlock","isList","isListItem","isVoid","isTableSection","isTableCell","isWsPreserveElement","surroundedBySpans","previousIsSpan","nextIsSpan","isBookmarkNode","trimmedLength","makeMap$1","attrsCharsRegExp","textCharsRegExp","rawCharsRegExp","entityRegExp","asciiMap","128","130","131","132","133","134","135","136","137","138","139","140","142","145","146","147","148","149","150","151","152","153","154","155","156","158","159","'","nativeDecode","innerText","buildEntitiesLookup","radix","chr","entity","fromCharCode","support","getText","isXML","tokenize","compile","sortInput","hasDuplicate","docElem","documentIsHTML","rbuggyQSA","rbuggyMatches","contains$3","encodeRaw","encodeNumeric","encodeNamed","entities","getEncodeFunc","entitiesMap","encodeNamedAndNumeric","encodeCustomNamed","nameMap","named","numeric","dummyObj","blockContent","phrasingContent","flowContent","html4BlockContent","html4PhrasingContent","ni","arrayToMap","join","addAttrs","schemaItem","mode","hex","encodingItems","rgbRegExp","urlOrStrRegExp","styleRegExp","trimRightRegExp","encodingLookup","color","isEncoded","urlConverter","urlConverterScope","compress","noJoin","canCompress","keepSlashes","decodeSingleHexSequence","escSeq","decodeHexSequences","processUrl","url2","url3","str2","scriptUrl","allow_svg_data_urls","border","serializeStyles","styleList","styleMap","eventExpandoPrefix","mouseEventRe","deprecated","keyLocation","layerX","layerY","returnValue","webkitMovementX","webkitMovementY","keyIdentifier","mozPressure","hasIsDefaultPrevented","event","isDefaultPrevented","returnTrue","returnFalse","addEvent","capture","removeEvent","removeEventListener","detachEvent","getTargetFromShadowDom","defaultTarget","composedPath","fix","originalEvent","srcElement","pageX","clientX","eventDoc","pageY","clientY","preventDefault","stopPropagation","isPropagationStopped","cancelBubble","stopImmediatePropagation","isImmediatePropagationStopped","metaKey","bindOnReady","eventUtils","domLoaded","readyHandler","readyState","hasMouseEnterLeave","hasFocusIn","callbackList","fakeName","nativeHandler","defaultNativeHandler","executeHandlers","namesList","mouseEnterLeave","related","currentTarget","relatedTarget","ci","eventMap","parentWindow","clean","cancel","preferredDoc","classCache","tokenCache","compilerCache","sortOrder","push_native","identifier","pseudos","rcomma","rcombinators","rattributeQuotes","rpseudo","ridentifier","matchExpr","ID","CLASS","ATTR","PSEUDO","CHILD","bool","needsContext","rinputs","rheader","rnative","rquickExpr","rsibling","rescape","runescape","funescape","escaped","escapedWhitespace","high","els","groups","old","nid","newContext","newSelector","getElementsByClassName","qsa","qsaError","hasCompare","getById","attrId","tmp","disconnectedMatch","adown","bup","compare","sortDetached","aup","ap","bp","unshift","expr","matchesSelector","attrHandle","getAttributeNode","specified","duplicates","detectDuplicates","sortStable","createPseudo","excess","unquoted","nodeNameSelector","operator","check","what","simple","forward","ofType","useCache","pseudo","matched","input","lang","elemLang","hash","focus","activeElement","hasFocus","tabIndex","enabled","disabled","checked","selected","selectedIndex","header","button","even","odd","lt","gt","nth","radio","checkbox","file","password","submit","reset","filters","parseOnly","soFar","preFilters","cached","token","compiled","push$1","slice$1","rquickExpr$1","skipUniques","isDefined","isString$1","isWindow","fragDoc","domManipulate","targetNodes","sourceItem","getElementDocument","makeArray","wrap$1","lastParent","newWrapper","numericCssMap","booleanMap","propFix","for","class","readonly","cssFix","float","cssHooks","DomQueryConstructor","init","inArray$1","whiteSpaceRegExp$1","trim$2","each$4","unique","removeAttr","camel","dashed","removeProperty","currentStyle","host","prependTo","replaceWith","content","wrapAll","wrapInner","existingClassName","classState","trigger","closest","object","until","sibling","siblingName","firstSibling","prev","contentDocument","contentWindow","wrappedResult","parentsUntil","nextUntil","prevUntil","defaults","sub","startNode","rootNode","prev2","shallow","findSibling","findPreviousNode","startName","getContext","keepValues","keep_values","keepUrlHook","rawValue","normalized","lastNodeType","DOMUtils$1","each$6","grep$2","states","scriptLoadedCallbacks","queueLoadedCallbacks","loading","loadScript","onreadystatechange","isDone","markDone","loadQueue","loadScripts","failures","execCallbacks","loadingScripts","notifyCallbacks","isRaw","isTokenised","currentCode","getLanguageData","getData","setCode","newCode","langData","translation","getLangData","textstr","removeContext","translated","values_1","$1","$2","isRtl","hasCode","PluginManager","ThemeManager","AddOnManager$1","rate","last$2","read","add$1","remove$2","supports","classList","get$5","add$2","clazz","remove$3","add$3","cleanClass","remove$4","has$2","descendants","descendants$1","ancestor$1","descendant","closest$1","annotation","dataAnnotation","dataAnnotationId","identify","annotationName","getRng","getBody","an","newStart","getAttr","uid","findMarkers","isAnnotation","markers","directory","nodesAlready","setup","registry","changeCallbacks","initData","previous","withCallbacks","updateCallbacks","callbackMap","outputData","fireCallbacks","fireNoAnnotation","onNodeChange","annotations","_a","setup$1","identifyParserNode","span","serializer","addNodeFilter","spans","persistent","create$1","generate","date","floor","add$4","fromHtml$1","get$6","set$1","owner$1","docDom","fragment","contentElements","original","isDeep","isZwsp","trim$3","Zwsp","ZWSP","isElement$2","isText$2","isCaretContainerBlock","isCaretContainerInline","isCaretContainer","hasContent","insertInline","textNode","endsWithCaretContainer","splitText","startsWithCaretContainer","isBeforeInline","isAfterInline","createBogusBr","br","insertBlock","blockName","blockNode","trimBogusBr","brs","lastBr","showCaretContainerBlock","caretContainer","isRangeInCaretContainerBlock","isContentEditableTrue$1","isContentEditableFalse$1","isBr$2","isText$3","isInvalidTextElement","isAtomicInline","isTable$2","isCaretContainer$1","isCaretCandidate","isNonUiContentEditableFalse","isUnselectable","isInEditable","isAtomicContentEditableFalse","isAtomic","isEditableCaretCandidate","round","clone$1","rect","collapse","toStart","rect1","rect2","isValidOverflow","overflowY","min","isAbove","isBelow","containsXY","getSelectedNode","extendingChars","isExtendingChar","ch","lift2","oa","ob","lift3","oc","someIf","slice$2","and","Predicate","isElement$3","isCaretCandidate$1","isBlock$1","isFloated","isValidElementCaretCandidate","isNotPre","isBr$3","isWhiteSpace","isRange","isHiddenWhiteSpaceRange","getBrClientRect","brNode","clientRect","nbsp$1","getBoundingClientRectWebKitText","sc","ec","so","eo","newRng","cloneRange","setEndAfter","isZeroRect","collapseAndInflateWidth","newClientRect","beforeNode","addUniqueAndValidRect","addCharacterOffset","fromRangeStart","fromRangeEnd","pos1","pos2","isTextPosition","isElementPosition","HDirection","CaretPosition$1","isText$5","isBogus$1","nodeIndex$1","normalizedParent","getChildNodes","normalizedTextOffset","equal","normalizedNodeIndex","numTextFragments","createPathItem","create$2","outputOffset","path","resolvePathItem","findTextPosition","dataLen","targetOffset","resolve$1","trimEmptyTextNode","insertNode","insertFragment","rangeInsertNode","isContentEditableFalse$2","getNormalizedTextOffset","trimmedOffset","getPoint","point","getLocation","bookmark","isCollapsed","findIndex$2","moveEndPoint","normalizeTableCellSelection","findAdjacentContentEditableFalseElm","getOffsetBookmark","getCaretBookmark","getRangeBookmark","createBookmarkSpan","filled","getPersistentBookmark","collapsed","rng2","endBookmarkNode","startBookmarkNode","keep","GetBookmark","getUndoBookmark","TextWalker","isBoundary","direction","TextSeeker","isBlockBoundary","newOffset","backwards","forwards","isCaretNode","getParentCaretContainer","isElement$4","isText$6","removeNode","getNodeValue","setNodeValue","trimCount","trimmedText","removeUnchanged","remove$5","removeTextAndReposition","removeElementAndReposition","newPosition","removeTextCaretContainer","removeElementCaretContainer","removeAndReposition","caretContainerNode","CaretContainerRemove","DOM$1","getBodySetting","getParam","bodyObj","getIframeAttrs","getDocType","getDocumentBaseUrl","getBodyId","getBodyClass","getContentSecurityPolicy","shouldPutBrInPre","getForcedRootBlock","block","getForcedRootBlockAttrs","getBrNewLineSelector","getNoNewLineSelector","shouldKeepStyles","shouldEndContainerOnEmptyBlock","getFontStyleValues","getFontSizeClasses","getImagesDataImgFilter","isAutomaticUploadsEnabled","shouldReuseFileName","shouldReplaceBlobUris","getIconPackName","getIconsUrl","getImageUploadUrl","getImageUploadBasePath","getImagesUploadCredentials","getImagesUploadHandler","shouldUseContentCssCors","getReferrerPolicy","getLanguageCode","getLanguageUrl","shouldIndentUseMargin","getIndentation","getContentCss","contentCss","content_css","getDirectionality","getInlineBoundarySelector","getObjectResizing","getResizeImgProportional","getPlaceholder","getElement","Settings","browser$3","isContentEditableFalse$3","isTableCell$1","getAbsoluteClientRect","scrollX","scrollY","margin","rootRect","trimInlineCaretContainers","contentEditableFalseNodes","deleteData","FakeCaret","cursorInterval","lastVisualCaret","rootBlock","caretBlock","caret","caretState","startBlink","getCss","isFakeCaretTableBrowser","isFakeCaretTarget","isContentEditableFalse$4","isBlockLike","isCaretContainer$2","isCaretContainerBlock$1","isElement$5","isCaretCandidate$2","isForwards","isBackwards","skipCaretContainers","findNode","predicateFn","getParentBlock","isInSameBlock","caretPosition1","caretPosition2","getChildNodeAtRelativeOffset","relativeOffset","beforeAfter","setStartBefore","setEndBefore","setStartAfter","isNodesInSameBlock","node1","node2","lean","before$2","after$1","normalizeRange","leanLeft","leanRight","getRelativeCefElm","getNormalizedRangeEndPoint","normalizedRange","getElementFromPosition","getElementFromPrevPosition","getVisualCaretPosition","walkFn","isMoveInsideSameBlock","inSameBlock","isContentEditableFalse$5","isText$7","isElement$6","isBr$4","isCaretCandidate$3","isAtomic$1","isEditableCaretCandidate$1","nodeAtIndex","getCaretCandidatePosition","moveForwardFromBr","nextNode","findCaretPosition","Forwards","startPos","innerNode","rootContentEditableFalseElm","CaretWalker","Backwards","walkToPositionIn","position","fromPosition","afterElement","isBeforeOrStart","isAfterOrEnd","isBeforeAfterSameElement","isAtBr","shouldSkipPosition","navigate","navigateIgnore","ignoreFilter","positionIn","nextPosition","prevPosition","CaretFinder","firstPositionIn","lastPositionIn","isStringPathBookmark","isRangeBookmark","isIdBookmark","isIndexBookmark","isPathBookmark","addBogus","resolveCaretPositionBookmark","insertZwsp","tryFindRangePosition","padEmptyCaretContainer","setEndPoint","isValidTextNode","restoreEndPoint","appendData","resolvePaths","resolveId","endPos","spos","epos","resolveIndex$1","selectNode","resolve$2","ResolveBookmark","getBookmark$1","setRng","isBookmarkNode$1","isNbsp","expected","actual","isWhiteSpace$1","isContent","isNode","isInlineBlock","moveStart","isWhiteSpaceNode","getNonWhiteSpaceSibling","inc","nextName","isTextBlock$1","ed","isEmptyTextNode","replaceVars","vars","isEq","str1","normalizeStyleValue","getTextDecoration","decoration","getParents$1","isBookmarkNode$2","getParents$2","isWhiteSpaceNode$1","isTextBlock$2","isBogusBr","findParentContentEditable","walkText","findSpace","findContent","findWordEndPoint","includeTrailingSpaces","lastTextNode","textSeeker","textOffset","findSelectorEndPoint","curFormat","findBlockEndPoint","scopeRoot","findParentContainer","expandRng","includeTrailingSpace","expand","each$7","getEndChild","walk$1","exclude","collectSiblings","endNode","siblings","findEndPoint","walkBoundary","parent_1","siblings_1","startPoint","endPoint","api","getOption","get$7","isZeroWidth","wrapName","applyWordGrab","makeAnnotation","eDoc","decorate","_b","master","_c","_d","_e","annotate","newWrappers","getDoc","finishWrapper","getOrOpenWrapper","processElements","processElement","processNodes","annotateWithBookmark","undoManager","transact","initialRng","Annotator","changes","annotationChanged","getAll","whiteSpaceRegExp$3","typeLookup","walk$2","isEmptyTextNode$1","Node$1","insert","selfAttrs","cloneAttrs","selfAttr","shortEnded","refNode","name_1","allow_html_data_urls","isConditionalComment","lcHtml","endIfIndex","endCommentRegexp","regExp","attrString","findEndTag","documentFocusInHandler","SaxParser$1","trimHtml","tempAttrs","trimContentRegExp","trimInternal","endTagIndex","matchLength","bogusAllRegExp","getTempAttrs","trimExternal","TrimHtml","trimEmptyContents","emptyRegExp","getContentFromBody","getInner","no_events","getContent","makeMap$3","Writer","indent","indentBefore","indentAfter","htmlOutput","indent_before","indent_after","entity_encoding","element_format","Serializer","writer","handlers","8","7","10","11","sortedAttrs","inner","traverse","findMatchingNodes","nodeFilters","attributeFilters","nodeMatches","attrMatches","name_2","filter$2","_doc","generate$1","cases","constructors","adt","acase","keys$1","argLength","branches","branchKeys","reqKey","label","params","Adt","create$3","SimRange","cata","subject","onBefore","onOn","onAfter","getStart","situ","before$3","after$2","Situ","adt$1","domRange","exact","exactFromRange","simRange","soffset","finish","foffset","getStart$1","startSitu","finishSitu","getWin","Selection","browser$4","clamp","normalizeRng","isOrContains","isRngInRoot","shouldStore","nativeRangeToSelectionRange","readRange","rangeCount","getRangeAt","getBookmark$2","bookmarkToNativeRng","store","newBookmark","storeNative","restore","SelectionBookmark","isEditorUIElement","FocusManager","isManualNodeChange","selectionChange","registerPageMouseUp","throttledStore","mouseUpPage","registerFocusOut","registerMouseUp","registerEditorEvents","SelectionRestore","DOM$2","isEditorUIElement$1","isEditorContentAreaElement","isUIElement","customSelector","custom_ui_selector","getActiveElement","registerEvents","focusedEditor","blurredEditor","activeEditor","unregisterDocumentEvents","setup$2","FocusController","getContentEditableHost","getCollapsedNode","getFocusInElement","normalizeSelection","caretPos","focusBody","hasElementFocus","hasIframeFocus","iframeElement","hasInlineFocus","rawBody","hasUiFocus","hasFocus$1","hasEditorOrUiFocus","focusEditor","quirks","refreshContentEditable","bookmarkRng","contentEditableHost","activateEditor","skipFocus","EditorFocus","isTreeNode","moveSelection","setEditorHtml","setContentString","forcedRootBlockName","padd","forced_root_block_attrs","parser","isRootContent","setContentTree","getNodeFilters","getAttributeFilters","setContent","firePreProcess","firePostProcess","fireRemove","fireDetach","fireSwitchMode","fireObjectResizeStart","fireObjectResized","firePreInit","firePostRender","fireInit","firePlaceholderToggle","fireError","errorType","DOM$3","restoreOriginalStyles","orgDisplay","safeDestroy","clearDomReferences","contentAreaContainer","formElement","editorContainer","bodyElement","targetElm","restoreForm","form","_mceOldSubmit","formEventDelegate","remove$6","_selectionOverrides","editorUpload","save","is_removing","unbindAllNativeEvents","hasHiddenInput","getContainer","automatic","destroyed","_beforeUnload","hasOwnProperty$2","deep$1","deepMerge","merger","objects","curObject","sectionResult","deviceDetection","legacyMobilePlugins","defaultTouchSettings","table_grid","object_resizing","resize","normalizePlugins","plugins","pluginNames","trimmedPlugins","filterLegacyMobilePlugins","extractSections","getSection","sections","sectionSettings","hasSection","isSectionTheme","section","getSectionConfig","getToolbarMode","getDefaultSettings","documentBaseUrl","baseDefaults","toolbar_mode","document_base_url","add_form_submit_trigger","submit_patch","add_unload_trigger","convert_urls","relative_urls","remove_script_host","visual","font_size_legacy_values","forced_root_block","hidden_input","inline_styles","convert_fonts_to_spans","convertURL","getDefaultMobileSettings","defaultMobileSettings","toolbar_sticky","defaultPhoneSettings","menubar","getExternalPlugins","overrideSettings","userDefinedExternalPlugins","external_plugins","combinePlugins","forcedPlugins","processPlugins","isMobileDevice","defaultOverrideSettings","forced_plugins","desktopPlugins","mobileConfig","mobilePlugins","platformPlugins","combinedPlugins","isOnMobile","combineSettings","defaultSettings","defaultDeviceSettings","mobile","extendedSettings","getEditorSettings","getFiltered","getParamObject","output","isArrayOf","IconManager","iconPack","icons","getProp","getComputedSizeProp","getClientWidth","getClientHeight","getMarginTop","getMarginLeft","getBoundingClientRect$1","isInsideElementContentArea","bodyElm","transpose","isXYInContentArea","transposedPoint","fromDomSafe","rawContainer","getContentAreaContainer","WindowManager","dialogs","getWindowManagerImpl","funcBind","fireOpenEvent","dialog","fireCloseEvent","addDialog","closeDialog","otherDialog","getTopDialog","storeSelectionAndOpenDialog","openDialog","displayNotification","notificationManager","displayError","_skinLoaded","uploadError","logError","createLoadError","pluginLoadError","iconsLoadError","languageLoadError","pluginInitError","initError","ErrorReporter","isContentCssSkinName","getContentCssUrls","skinUrl","contentCssFile","documentBaseURI","toAbsolute","appendContentCssFromSettings","contentCSS","BookmarkManager$1","isXYWithinRange","RangePoint","VK","BACKSPACE","DELETE","DOWN","ENTER","LEFT","RIGHT","SPACEBAR","TAB","UP","END","HOME","modifierPressed","shiftKey","ctrlKey","altKey","metaKeyPressed","isContentEditableFalse$6","isContentEditableTrue$2","getContentEditableRoot","ControlSelection","selectedElm","selectedElmGhost","resizeHelper","resizeHandles","selectedHandle","startX","startY","selectedElmX","selectedElmY","startW","startH","ratio","resizeStarted","startScrollWidth","startScrollHeight","editableDoc","rootDocument","abs","rootElement","nw","ne","se","sw","isImage","isEventOnImageOutsideRange","touch","touches","contextMenuSelectImage","getResizeTarget","isResizable","resizeGhostElement","deltaX","deltaY","proportional","resizeHelperX","resizeHelperY","screenX","screenY","display","scrollWidth","scrollHeight","endGhostResize","setSizeProp","showResizeRect","nodeChanged","targetWidth","targetHeight","hideResizeRect","unbindResizeHandleEvents","handleElm","startDrag","unSelectabe","updateResizeRect","startElm","controlElm","isChildOrEqual","disableGeckoResize","getEnd","isWithinContentEditableFalse","execCommand","handleMSControlSelect_1","delayedSelect","throttledUpdateResizeRect","composing","api$1","getOffset","parseFloat","getOuter","aggregate","properties","isNaN","cumulativeInclusions","get$8","walkUp","navigation","view","pathTo","frameElement","Navigation","__proto__","find$3","frames","loc","excludeFromDescend","fireScrollIntoViewEvent","fireAfterScrollIntoViewEvent","descend","markerInfo","cleanupFun","cleanup","createMarker","elementMarker","withMarker","preserveWith","_s","applyWithMarker","withScrollEvents","withElement","startElement","endElement","scrollToMarker","viewHeight","intoWindowIfNeeded","viewportBottom","markerTop","markerBottom","largerThanViewport","align","intoWindow","innerHeight","intoFrame","frameViewHeight","op","viewportBounds","rangeIntoWindow","elementIntoWindow","rangeIntoFrame","elementIntoFrame","elementIntoView","rangeIntoView","ScrollIntoView","scrollElementIntoView","scrollRangeIntoView","hasCeProperty","findParent","findClosestIeRange","rects","createTextRange","moveToElementText","moveToPoint","moveOutOfContentEditableFalse","parentElement","fromPoint$1","pointDoc","caretPositionFromPoint","offsetNode","caretRangeFromPoint","CaretRangeFromPoint","processRanges","ranges","EventProcessRanges","fromElements","dropLast","parentsUntil$1","parents$1","parentsAndSelf","Parents","getStartNode","getEndNode","getFirstChildren","getLastChildren","hasAllContentsSelected","moveEndPoint$1","hasAnyRanges","sel","getSel","tableModel","tableRow","cellPosition","getSpan","fillout","rowspan","colspan","y2","x2","cellExists","skipCellsX","getWidth","findElementPos","extractRows","sx","sy","ey","newRows","subTable","createDomTable","tableElement","tableBody","modelRowsToDomRows","cell","fromDom$1","tableElm","toDom","subsection","SimpleTableModel","getRanges","getSelectedNodes","hasMultipleRanges","MultiRange","getCellsFromRanges","getCellsFromElement","getCellsFromElementOrRanges","selectedCells","rangeCells","getCellsFromEditor","TableCellSelection","findParentListContainer","getFullySelectedListWrappers","listCont","wrap$2","innerElm","wrapped","directListWrappers","commonAnchorContainer","listElm","getWrapElements","commonAncestorContainer","wrapElements","listWrappers","allWrappers","emptyFragment","getFragmentFromRange","cloneContents","getParentTable","getTableFragment","selectedTableCells","firstCell","lastCell","fullTableModel","sectionedTableModel","getSelectionFragment","read$1","FragmentReader","getTextContent","bin","getHtmlContent","tmpElm","contextual","getContent$1","GetSelectionContent","isEq$1","rng1","RangeCompare","findParent$1","hasParent","hasParentWithName","isTable$3","isTableCell$2","isCeFalseCaretContainer","hasBrBeforeAfter","isPrevNode","hasContentEditableFalseParent","findTextNodeRelative","isAfterNode","lastInlineElement","parentBlockContainer","normalizeEndPoint","directionLeft","normRng","prependData","insertData","rngSetContent","deleteContents","prevText","nextText","oldLength","setupArgs","setContent$1","createContextualFragment","SetSelectionContent","getEndpointElement","real","getStart$2","skipEmptyTextNodes","orig","getNode$1","getSelectedBlocks","endElm","selectedBlocks","select$1","newCallbacks","isNativeIeSelection","isAttachedToDom","isValidRange","Selection$1","bookmarkManager","controlSelection","selectedRange","explicitRange","setCursorLocation","getEnd$1","compareEndPoints","tryCompareBoundaryPoints","how","sourceRange","destinationRange","compareBoundaryPoints","anchorNode","START_TO_START","END_TO_END","ieRange","removeAllRanges","addRange","setBaseAndExtent","focusNode","setNode","getSelectedBlocks$1","isForward","anchorRange","focusRange","anchorOffset","focusOffset","selectorChanged","getScrollContainer","scrollContainer","placeCaretAt","removeAttrs","addFontToSpansFilter","domParser","fontSizes","face","addStrikeToSpanFilter","addFilters","register$1","LegacyFilter","paddEmptyNode","blockElements","padd_empty_with_br","isPaddedWithNbsp","hasOnlyChild","isPadded","isEmpty$1","nonEmptyElements","whitespaceElements","isLineBreakNode","register$2","remove_trailing_brs","prevName","whiteSpaceElements","addAttributeFilter","appendRel","allow_unsafe_link_target","newRel","allow_html_in_named_anchor","fix_list_elements","classValue","validClassesMap","makeMap$4","each$8","explode$2","extend$2","DomParser","matchedNodes","matchedAttributes","root_name","fixInvalidChildren","newParent","currentNode","tempNode","childNode","nonSplitableElements","textBlockElements","fixed","filterNode","list","fi","fl","isInWhiteSpacePreservedElement","invalidChildren","rootBlockName","startWhiteSpaceRegExp","endWhiteSpaceRegExp","allWhiteSpaceRegExp","isAllWhiteSpaceRegExp","createNode","removeWhitespaceBefore","textNodeNext","textVal","newNode","attrFiltersLen","invalid","rootBlockNode","register$3","htmlParser","internalName","hasChildren","trimTrailingBr","brNode1","brNode2","DomSerializerFilters","preProcess","impl","oldDoc","implementation","createHTMLDocument","importNode","shouldFireEvent","hasEventListeners","DomSerializerPreProcess","addTempAttr","postProcess","getHtmlFromNode","parseHtml","parserArgs","serializeNode","toHtml","DomSerializer","targetNode","addRules","rules","setRules","Serializer$1","domSerializer","blobUriToBlob","rejectWithError","responseType","response","parseDataUri","uriParts","dataUriToBlob","uriToBlob","blobToDataUri","reader","FileReader","onloadend","readAsDataURL","Conversions","getByUri","dataUri","findFirst","cachedBlobInfo","count$1","rnd","uuid","Uuid","BlobCache","mimeToExt","mime","toBlobInfo","removeByUri","revokeObjectURL","EditorUpload","uploader","imageScanner","urlFilters","aliveGuard","cacheInvalidator","replaceString","replaceImageUrl","targetUrl","replacementUrl","replaceUrlInUndoStack","level","fragments","replaceImageUri","uploadImages","scanForImages","imageInfos","filteredResult","uploadInfo","uploadImagesAuto","isValidDataUriImage","imgElm","addFilter","resultItem","replaceBlobUris","source_view","getLastChildren$1","rawNode","removeTrailingBr","allBrs","fillWithPaddingBr","isPaddingContents","isPaddedElement","trimBlockTrailingBr","lastChildPrevSibling","PaddingBr","isEq$2","matchesUnInheritedFormatSelector","formatList","formatter","inherit","matchParents","matchNode","matchName","matchItems","itemName","similar","onmatch","matchAll","matchedFormatNames","checkedMap","canApply","defaultBlock","normalizeContent","isStartOfContent","isEndOfContent","previousCharIsSpace","normalize$1","replaceData","normalizeWhitespaceAfter","whitespaceCount","normalizeWhitespaceBefore","mergeTextNodes","prevNode","normalizeWhitespace","whitespaceOffset","ancestor$2","hasWhitespacePreserveParent","isWhitespace","isNamedAnchor","isContent$1","isBookmark","isBogus$2","isBogusAll$1","isEmptyNode","skipBogus","isEmpty$2","Empty","needsReposition","beforeOrStartOf","afterOrEndOf","getPreviousSiblingCaretPosition","getNextSiblingCaretPosition","findCaretPositionBackwardsFromElm","startPosition","findCaretPositionForwardsFromElm","findCaretPositionBackwards","findCaretPositionForward","findCaretPosition$1","findCaretPosOutsideElmAfterDelete","setSelection","eqRawNode","isBlock$2","paddEmptyBlock","deleteNormalized","afterDeletePosOpt","prevTextOpt","nextTextOpt","isInlineElement","deleteElement","moveCaret","afterDeletePos","parentBlock","normalizedAfterDeletePos","paddPos","DeleteElement","ZWSP$1","getEmptyCaretContainers","isCaretContainerEmpty","findFirstTextNode","createCaretContainer","fill","trimZwspFromCaretContainer","removeCaretContainerNode","removeCaretContainer","insertCaretContainerNode","formatNode","appendNode","insertFormatNodesIntoCaretContainer","formatNodes","innerMostFormatNode","applyCaretFormat","wordcharRegex","removeCaretFormat","hasContentAfter","expandedRng","newCaretContainer","caretNode","disableCaretContainer","keyCode","setup$3","replaceWithCaretFormat","innerMost","isFormatElement","isEmptyCaretFormatElement","postProcessHooks","filter$3","each$9","postProcess$1","hooks","isPre","hasPreSibling","pre","joinPre","pre1","pre2","VDirection","each$a","ElementUtils","attribs","compareObjects","obj1","obj2","MCE_ATTR_RE","each$b","isEq$3","isTableCell$3","isChildOfInlineParent","lastIdx","wrap$3","wrapWithSiblings","matchName$1","isColorFormatAndAnchor","links","find$4","removeNode$1","rootBlockElm","forcedRootBlock","list_block","removeFormat","compareNode","stylesModified","remove_similar","valueOut","findFormatRoot","formatRoot","wrapAndSplit","lastClone","firstClone","formatRootParent","remove$7","splitToFormatRoot","isRemoveBookmarkNode","lastContentEditable","removeRngStyle","textDecoration","ceFalseOverride","each$c","isElementNode","findElementSibling","mergeSiblingsNodes","tmpSibling","elementUtils","processChildElements","hasStyle","applyStyle","unwrapEmptySpan","processUnderlineAndColor","mergeUnderlineAndColor","mergeBackgroundColorAndFontSize","backgroundColor","mergeSubSup","mergeSiblings","merge_siblings","clearChildStyles","clear_child_styles","mergeWithChildren","mergeWithParents","merge_with_parents","createRange$1","normalizeBlockSelectionRange","newEndPos","normalize$2","RangeNormalizer","each$d","isElementNode$1","applyFormat","setElementFormat","fmt","onformat","styleVal","applyNodeStyle","found","applyRngStyle","nodeSpecific","wrapElm","currentWrapElm","parentName","childCount","getChildElementNode","curSelNode","setup$4","registeredFormatListeners","currentFormats","updateAndFireChangeCallbacks","formatChangeData","formatsList","newFormats","matchedFormats","remainingFormats","filterRemainingFormats","addListeners","formatChangeItems","removeListeners","formatChanged","get$9","valigntop","verticalAlign","valignmiddle","valignbottom","alignleft","preview","textAlign","aligncenter","marginLeft","marginRight","alignright","alignjustify","bold","fontWeight","italic","fontStyle","underline","strikethrough","forecolor","hilitecolor","fontname","toggle","fontFamily","fontsize","fontSize","fontsize_class","blockquote","subscript","superscript","removeformat","each$e","parsedSelectorToHtml","ancestry","sItem","getRequiredParent","elmRule","wrapInHtml","parentCandidate","parentRequired","ancestorName","siblingElm","parseSelectorItem","$0","$3","$4","parseSelector","getCssText","previewFrag","previewElm","parentFontSize","previewStyles","previewCss","preview_styles","removeVars","setup$5","addShortcut","FormatShortcuts","Formatter","formatChangeState","vDown","vUp","snake","diag","buildScript","start1","end1","start2","end2","middle","getMiddleSnake","i2","buildSnake","delta","sum","Diff","KEEP","INSERT","getOuterHtml","createFragment$1","insertAt","removeAt","applyDiff","action","read$2","write","currentFragments","Fragments","undoLevelDocument","lazyTempDocument","hasIframes","createFragmentedLevel","beforeBookmark","createCompleteLevel","createFromEditor","trimmedFragments","trimmed","applyToEditor","getLevelContent","getCleanLevelContent","hasEqualContent","level1","level2","hasEqualCleanedContent","isEq$4","Levels","isUnlocked","locks","setTyping","typing","endTyping","endTypingLevelIgnoreLocks","beforeChange","addUndoLevel","currentLevel","lastLevel","bm","custom_undo_redo_levels","setDirty","clear","extra","callback1","callback2","redo","undo","hasUndo","hasRedo","ignore","registerEvents$1","isFirstTypedCharacter","addNonTypingUndoLevel","cmd","command","isDirty","modKey","isInsertReplacementText","inputType","isInsertTextDataNull","addKeyboardShortcuts","UndoManager","nonTypingKeycodes","isKeyboardEvent","isDeleteEvent","isNonTypingKeyboardEvent","isTypingKeyboardEvent","isVisuallyEmpty","isForcedRootBlockFalse","firstElementChild","setup$6","placeholder","updatePlaceholder","showPlaceholder","getTouch","isFarEnough","distX","distY","setup$7","startData","longpressFired","debounceLongpress","isEqualNode","TouchEvents","isBlockElement","isValidTarget","hasBlockParent","shouldRemoveTextNode","addRootBlocks","restoreSelection","rootNodeName","setup$8","ForceBlocks","isText$8","startsWithCaretContainer$1","endsWithCaretContainer$1","createZwsp","insertInline$1","insertInlineBefore","insertInlineAfter","insertInlinePos","isPosCaretContainer","renderCaret","BoundaryCaret","strongRtl","hasStrongRtl","isInlineTarget","isRtl$1","findInlineParents","findRootInline","hasSameParentBlock","block1","block2","isAtZwsp","normalizePosition","normalizeForwards","normalizeBackwards","InlineUtils","evaluateUntil","fns","LazyEvaluator","Location","rescope","before$4","nPos","isNotInsideFormatCaretContainer","findInsideRootInline","after$3","isValidLocation","readLocation","getName","outside","inside","isEq$5","location1","location2","betweenInlines","fromInline","toInline","skipNoMovement","fromLocation","toLocation","findLocationTraverse","findLocationSimple","findLocation","BoundaryLocation","prevLocation","nextLocation","hasSelectionModifyApi","modify","moveRel","moveByWord","WordSelection","setCaretPosition","isFeatureEnabled","inline_boundaries","setSelected","renderCaretLocation","findLocation$1","toggleInlines","selectedInlines","targetInlines","safeRemoveCaretContainer","renderInsideInlineCaret","inlines","move","moveWord","setupSelectedState","moveNextWord","movePrevWord","BoundarySelection","getNodeClientRects","toArrayWithNode","BreakType","findUntil","walkUntil","isAboveFn","isBeflowFn","targetClientRect","line","aboveLineNumber","lineNumber","isLineNumber","upUntil","Up","downUntil","Down","positionsUntil","isBelowFn","caretWalker","getClientRect","isAboveLine","isLine","isContentEditableFalse$7","findNode$1","distanceToRectLeft","distanceToRectRight","isInside","findClosestClientRect","oldClientRect","oldDistance","newDistance","walkUntil$1","findLineNodeRects","targetNodeRect","checkPosFn","lineRects","getFakeCaretTargets","caretInfo","closestCaret","closestNodeRect","contentEditableFalseNodeRects","targetNodeRects","isContentEditableTrue$3","isContentEditableFalse$8","showCaret","getNodeRange","renderCaretAtRange","caretPositionNode","caretPositionBeforeNode","ceRoot","renderRangeCaret","caretRange","isChar","isBeforeSpace","isAfterSpace","isEmptyText","matchesElementPosition","isImageBlock","isCefNode","isBeforeImageBlock","isAfterImageBlock","isBeforeTable","isAfterTable","isBeforeContentEditableFalse","isAfterContentEditableFalse","customEventRootDelegates","beforeUnloadDelegate","flip","positions","walk$3","getBreakType","currentPos","nextPos","Br","Block","Wrap","getPositionsUntil","breakType","breakAt","Eol","getAdjacentLinePositions","getPositionsUntilBreak","findClosestHorizontalPositionFromPoint","newPos","lastPos","lastRect","newRect","lastDist","findClosestHorizontalPosition","targetRect","getPositionsUntilPreviousLine","getPositionsUntilNextLine","isAtFirstLine","isAtLastLine","getPositionsAbove","getPositionsBelow","getFirstLinePositions","getLastLinePositions","isContentEditableFalse$9","getSelectedNode$1","moveToCeFalseHorizontally","getNextPosFn","isBeforeContentEditableFalseFn","rangeIsInContainerBlock","nextCaretPosition","peekCaretPosition","moveToCeFalseVertically","walkerFn","linePositions","nextLinePositions","closestNextLineRect","caretClientRect","dist1","dist2","contentEditableFalseNode","caretPositions","createTextBlock","textBlock","exitPreBlock","newBlock","getNextVisualCaretPosition","getPrevVisualCaretPosition","getHorizontalRange","newRange","getVerticalRange","down","moveH","moveV","isCefPosition","moveToLineEndPoint","deflate","getCorners","getYAxisValue","tds","findClosestCorner","corners","newCorner","oldCorner","oldDist","sqrt","newDist","getClosestCell","isTargetCorner","corner","getBottomValue","getTopValue","isAbove$1","isBelow$1","getClosestCellAbove","getClosestCellBelow","findClosestPositionInAboveCell","findClosestPositionInBelowCell","moveToRange","hasNextBreak","lineInfo","breakPos","startsWithWrapBreak","startsWithBrBreak","isAtTableCellLine","isAtFirstTableCellLine","isAtLastTableCellLine","isCaretAtStartOrEndOfTable","navigateHorizontally","getClosestAbovePosition","getClosestBelowPosition","getTable","renderBlock","navigateVertically","moveH$1","moveV$1","isTarget","rangeBefore","insertElement","insertBr","insertBlock$1","insertEmptyLine","getClosestTargetBlock","isAtFirstOrLastLine","moveCaretToNewEmptyLine","rootBlockAttrs","moveV$2","defaultPatterns","patterns","matchesEvent","match$1","execute","MatchKeys","executeKeydownOverride","setup$9","ArrowKeys","isBeforeRoot","getParentBlock$1","placeCaretInEmptyBody","paddEmptyBody","willDeleteLastPositionInElement","fromPos","firstPos","normalizedFirstPos","normalizedLastPos","normalizedFromPos","prevPos","DeleteUtils","blockPosition","blockBoundary","getBlockPosition","containerElm","isDifferentBlocks","hasSameParent","parent1","parent2","isEditable","skipLastBr","lastPositionInBlock","readFromRange","fromBlockPos","toBlockPos","blockPos","read$3","BlockMergeBoundary","getChildrenUntilBlockBoundary","extractChildren","removeEmptyRoot","isEmptyBefore","nestedBlockMerge","fromBlock","toBlock","insertionPoint","sidelongBlockMerge","findInsertionPoint","getInsertionPoint","trimBr","mergeBlockInto","mergeBlocks","MergeBlocks","backspaceDelete","BlockBoundaryDelete","deleteRangeMergeBlocks","isRawNodeInTable","isSelectionInTable","isEverythingSelected","noPrevious","noNext","emptyEditor","deleteRange","backspaceDelete$1","BlockRangeDelete","isBr$5","findBr","parentBlocks","isBeforeBr","isAfterBr","findPreviousBr","findNextBr","isCompoundElement","DeleteAction","moveToElement","moveToPosition","isAtContentEditableBlockCaret","caretLocation","isDeleteFromCefDifferentBlocks","deleteEmptyBlockOrMoveToCef","toCefElm","blockElm","findCefPosition","getContentEditableBlockAction","skipMoveToActionFromInlineCefToContent","deleteAction","getContentEditableAction","read$4","deleteElement$1","hideFakeCaret","getAncestorCe","getContentEditableRoot$1","backspaceDeleteCaret","selectedNode","deleteOffscreenSelection","backspaceDeleteRange","paddEmptyElement","backspaceDelete$2","CefDelete","trimEmptyTextNode$1","deleteContentAndShowCaret","deleteCefBoundaryText","backspaceDelete$3","CefBoundaryDelete","isFeatureEnabled$1","rangeFromPositions","hasOnlyTwoOrLessPositionsLeft","setCaretLocation","deleteFromTo","rescope$1","backspaceDeleteCollapsed","toPosition","backspaceDelete$4","BoundaryDelete","getParentInlines","hasOnlyOneChild","deleteLastPosition","parentInlines","isFormatElement$1","deleteCaret","backspaceDelete$5","InlineFormatDelete","tableCellRng","tableSelection","removeTable","emptyCells","isRootFromElement","getClosestCell$1","getClosestTable","isExpandedCellRng","cellRng","getTableFromCellRng","startParentTable","endParentTable","getTableCells","getCellRangeFromStartTable","endCell","partialSelection","startCell","isWithinSameTable","getCellRng","getTableSelectionFromCellRng","getTableSelectionFromRng","getCellIndex","getSelectedCells","getAction","getActionFromRange","deleteTableElement","deleteCellRange","deleteCaptionRange","emptyElement","deleteTableRange","getParentCaption","deleteRange$1","getParentCell","deleteBetweenCells","fromCell","toCell","isDeleteOfLastCharPos","fromCaption","emptyCaretCaption","validateCaretCaption","toCaption","deleteCaretInsideCaption","deleteCaretCells","deleteCaretCaption","isNearTable","isBeforeOrAfterTable","deleteCaret$1","backspaceDelete$6","TableDelete","deleteCaret$2","backspaceDelete$7","PageBreakDelete","isEditable$1","parseIndentValue","number","getIndentStyleName","useMargin","indentElement","unit","indentStyleName","styleValue","validateBlocks","intentValue","canOutdent","getBlocksToIndent","isListComponent","parentIsListComponent","indentation","indentUnit","indentValue","queryCommandState","navigateIgnoreEmptyTextNodes","getClosestBlock","isAtBeforeAfterBlockBoundary","isAtBlockBoundary","isAtStartOfBlock","isAtEndOfBlock","isBeforeBlock","isAfterBlock","backspaceDelete$8","_caret","_forward","Outdent","executeKeydownOverride$1","executeKeyupOverride","setup$a","DeleteBackspaceKeys","firstNonWhiteSpaceNodeSibling","moveToCaretPosition","lastNode","getEditableRoot","editableRoot","getParentBlock$2","getParentBlockName","isListItemParentBlock","NewLineUtils","hasFirstChild","hasParent$1","isListBlock","isNestedList","getContainerBlock","containerBlock","containerBlockParent","isFirstOrLastLi","createNewBlock","newBlockName","tmpRng","InsertLi","trimZwsp","isEmptyAnchor","isTableCell$4","emptyBlock","containerAndSiblingName","canSplitBlock","trimInlineElementsOnLeftSideOfBlock","firstChilds","normalizeZwspOffset","includeZwspInRange","trimLeadingLineBreaks","getEditableRoot$1","setForcedBlockAttrs","wrapSelfAndSiblingsInDefaultBlock","addBrToBlockIfNeeded","insert$1","parentBlockName","containerBlockName","isAfterLastNodeInContainer","clonedNode","textInlineElements","isCaretAtStartOrEndOfBlock","normalizedOffset","insertNewBlockAfter","InsertBlock","hasRightSideContent","scrollToBr","brElm","moveSelectionToBr","extraBr","insertBrAtCaret","isControlKey","insertBrBefore","insertBrAfter","hasBrAfter","isBeforeBr$1","isAnchorLink","isInsideAnchor","readInlineAnchorLocation","insertBrOutsideAnchor","insert$2","anchorLocation","InsertBr","shouldInsertBr","shouldBlockNewLine","ContextSelectors","newLineAction","shouldBlockNewLine$1","isBrMode","requiredState","inListBlock","inBlock","inPreBlock","inSummaryBlock","shouldPutBrInPre$1","inBrContext","hasShiftKey","canInsertIntoEditableRoot","rootEditable","match$2","predicates","getAction$1","NewLineAction","insert$3","InsertNewLine","handleEnterKeyEvent","setup$b","EnterKey","insertTextAtPosition","insertNbspAtPosition","insertSpaceAtPosition","isInMiddleOfText","getClosestBlock$1","hasSpaceBefore","hasSpaceAfter","isPreValue","isInPre","isAtBeginningOfBody","isAtEndOfBody","isAtLineBoundary","needsToHaveNbsp","needsToBeNbspLeft","needsToBeNbspRight","afterPos","needsToBeNbsp","isNbspAt","hasNbsp","normalizeNbspMiddle","chars","normalizeNbspAtStart","normalizeNbspInMiddleOfTextNode","newText","normalizeNbspAtEnd","normalizeNbsps","normalizeNbspsInEditor","locationToCaretPosition","insertInlineBoundarySpaceOrNbsp","checkPos","setSelection$1","insertSpaceOrNbspAtSelection","executeKeydownOverride$2","setup$c","SpaceKey","findBlockCaretContainer","removeIeControlRect","showBlockCaretContainer","blockCaretContainer","handleBlockContainer","setup$d","CaretContainerInput","browser$5","setupIeInput","keypressThrotter","setup$e","isComposing","executeKeydownOverride$3","setup$f","HomeEndKeys","setup$g","KeyboardOverrides","NodeChange","lastPath","lastRng","nativeRng","fakeRng","isSameElementPath","initialized","disable_nodechange","currentPath","preventSummaryToggle","filterDetails","details","setup$h","isTextBlockNode","normalizeSelection$1","setup$i","detail","getAbsolutePosition","getBodyPosition","getScrollPosition","getBodyScroll","inlineScroll","iframeScroll","getMousePosition","iframePosition","scrollPosition","calculatePosition","bodyPosition","mousePosition","calc","MousePosition","isContentEditableFalse$a","isContentEditableTrue$4","isDraggable","isValidDropTarget","targetElement","dragElement","cloneElement","cloneElm","createGhost","clonedElm","ghostElm","opacity","overflow","padding","boxSizing","appendGhostToBody","moveGhost","maxX","maxY","overflowX","removeElement","isLeftMouseButtonPressed","hasDraggableElement","applyRelPos","relX","start$1","ceElm","elmPos","relY","ghost","move$1","throttledPlaceCaretAt","movement","dragging","targetPos","getRawTarget","drop","targetClone_1","targetClone","insertContent","removeDragState","bindFakeDragEvents","pageDom","dragStartHandler","dragHandler","dropHandler","dragEndHandler","blockIeDrop","realTarget","DragDropOverrides","setup$j","renderFocusCaret","CefFocus","isContentEditableTrue$5","isContentEditableFalse$b","getContentEditableRoot$2","SelectionOverrides","selectedContentEditableNode","fakeCaret","realSelectionId","isFakeSelectionElement","getRealSelectionElement","setRange","getRange","isWithinCaretContainer","isRangeInCaretContainer","normalizeShortEndedElementSelection","setContentEditableSelection","$realSelectionContainer","origTargetClone","nodeElm","removeContentEditableSelection","contentEditableRoot","hasNormalCaretPosition","hasBetterMouseTarget","targetBlock","isPasteBin","clipboardData","realSelectionElement","clearData","setData","outerText","Quirks","isGecko","isWebKit","mceInternalDataType","setEditorCommandState","setMceInternalContent","selectionHtml","internalContent","dataTransfer","escape","getMceInternalContent","insertClipboardContents","internal","queryCommandSupported","selectAll","shortcuts","disableBackspaceIntoATable","bodyHeight","contentStyles","serializeRng","allContentsSelected","allRng","Range","body_1","blur","getAttributeApplyFunction","setAttributeNode","isSelectionAcrossElements","applyAttributes","setOpts","fixLinks","DOM$4","appendStyle","createParser","autoFocus","auto_focus","moveSelectionToFirstCaretPosition","initEditor","bindPendingEventDelegates","execCallback","getStyleSheetLoader","initContentBody","skipWrite","contentCssText","visibility","orgVisibility","iframeHTML","bodyEl","hex_colors","force_hex_style_colors","annotator","_nodeChangeDispatcher","browser_spellcheck","gecko_spellcheck","spellcheck","directionality","protect","addVisual","startContent","content_style","InitContentBody","DOM$5","relaxDomain","ifr","domain","hostname","bodyUuid","domainRelaxUrl","createIframeElement","customAttrs","iframe","frameBorder","allowTransparency","getIframeHtml","bodyId","bodyClass","getURI","createIframe","isDomainRelaxed","iframeContainer","init$1","boxInfo","hidden","InitIframe","DOM$6","initPlugin","initializedPlugins","plugin","Plugin","pluginInstance","trimLegacyPrefix","initPlugins","initIcons","iconPackName","currentIcons","ui","defaultIcons","loadIcons","svgData","icon","addIcon","initTheme","Theme","renderFromLoadedTheme","renderUI","renderFromThemeFunc","iframeHeight","createThemeFalseResult","renderThemeFalseIframe","renderThemeFalse","renderThemeUi","init$2","Init","DOM$7","hasSkipLoadPrefix","loadLanguage","scriptLoader","languageCode","languageUrl","url_1","loadTheme","themeUrl","theme_url","getIconsUrlMetaFromUrl","getIconsUrlMetaFromName","urlMeta","loadPlugins","depPlugin","url_2","render","resetContent","triggerSave","windowManager","encoding","set_dirty","Render","hasOnlyOneChild$1","isPaddingNode","isPaddedEmptyBlock","isEmptyFragmentElement","isListFragment","cleanupDomFragment","domFragment","toDomFragment","listItems$1","isPadding","isListItemPadded","isEmptyOrPadded","trimListItems","getParentLi","isParentBlockLi","getSplit","beforeRng","afterRng","findFirstIn","newCaretPos","findLastOf","insertMiddle","insertBefore$1","insertAfter$1","insertAtCaret","liTarget","liElms","isAt","InsertList","isAfterNbsp","trimOrPadLeftRight","hasSiblingText","trimNbspAfterDeleteAndPadValue","isTableCell$5","selectionSetContent","validInsertion","trimBrsFromTableCell","reduceInlineTextElements","merge","root_1","elementUtils_1","testNode","markFragmentElements","umarkFragmentElements","isPartOfFragment","canHaveChildren","moveSelectionToMarker","parentEditableFalseElm","nextRng","insertHtmlAtCaret","bookmarkHtml","paste","caretElement","processValue","insertAtCaret$1","InsertContent","nativeCommand","deleteCommand","forwardDeleteCommand","DeleteCommands","ancestor$3","transform","transformed","closest$2","legacyPropNames","getSpecifiedFontProp","getProperty","legacyPropName","round$1","precision","factor","pow","toPt","normalizeFontFamily","getComputedFontProp","getFontProp","FontInfo","getFontSize","getFontFamily","findFirstCaretElement","isRangeAtStartOfNode","getCaretElement","fromFontSizeNumber","fontSizeNumber","fontClasses","normalizeFontNames","font","fonts","fontNameAction","fontNameQuery","fontSizeAction","fontSizeQuery","each$f","map$3","inArray$2","EditorCommands","commands","setupCommands","customCommand","skip_focus","queryCommandValue","addCommands","commandList","addCommand","addQueryStateHandler","addQueryValueHandler","hasCustomCommand","execNativeCommand","isFormatMatch","toggleFormat","storeSelection","selectionBookmark","queryCommandEnabled","listParent","hasVisual","editingHost","selectNodeContents","alignStates","Undo","Redo","nativeEvents","EventDispatcher","bindings","toggleEvent","isNative","beforeFire","wrappedCallback","bindingName","hi","getEventDispatcher","_eventDispatcher","toggleNativeEvent","Observable","bubble","dispatcherArgs","setContentEditable","switchOffContentEditableTrue","switchOnContentEditableTrue","removeFakeSelection","restoreFakeSelection","toggleReadOnly","isReadOnly","registerFilters","registerReadOnlyContentFilters","isClickEvent","isInAnchor","preventReadOnlyEvents","registerReadOnlySelectionBlockers","DOM$8","getEventTarget","eventName","event_root","eventRoot","isListening","fireEvent","bindEventDelegate","eventRootElm","delegate","delegates","editors","EditorObservable","_pendingNativeEvents","defaultModes","switchToMode","activeMode","availableModes","oldMode","newMode","activate","deactivate","editorReadOnly","setMode","registerMode","create$4","design","each$g","explode$3","keyCodeLookup","f1","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11","f12","modifierNames","Shortcuts","pendingPatterns","hasModifier","isFunctionKey","shortcut","matchShortcut","subpatterns","executeShortcutAction","desc","cmdFunc","createShortcut","parseShortcut","charCode","access","alt","ctrl","meta","create$5","buttons","menuItems","popups","contextMenus","contextToolbars","sidebars","addButton","addGroupToolbarButton","addToggleButton","addMenuButton","addSplitButton","addMenuItem","addNestedMenuItem","addToggleMenuItem","addAutocompleter","addContextMenu","addContextToolbar","addContextForm","addSidebar","bridge","each$h","trim$4","queryParts","DEFAULT_PORTS","ftp","http","https","mailto","URI","baseUri","base_uri","source","isProtocolRelative","protocol","toAbsPath","urlMatch","part","userInfo","port","uriComponents","pathname","setPath","pathMatch","toRelative","relativeUri","tu","uu","toRelPath","noHost","absoluteUri","isSameOrigin","defaultPort","breakPoint","normalizedBase","outPath","nb","normalizedPath","noProtoHost","DOM$9","extend$3","each$i","resolve$3","ie$1","Editor","loadedCSS","isNotDirty","documentBaseURL","base_url","_setBaseUrl","baseURI","referrer_policy","language_load","editorCommands","cache_suffix","modeInstance","callbackLookup","setProgressState","initialContent","oldState","urlconverter_callback","visual_table_class","visual_anchor_class","_scanForImages","DOM$a","explode$4","each$j","extend$4","instanceCounter","boundGlobalEvents","legacyEditors","isValidLegacyKey","globalEventDelegate","EditorManager","toggleGlobalEvents","removeEditorFromList","targetEditor","oldEditors","purgeDestroyedEditor","isQuirksMode","compatMode","majorVersion","minorVersion","releaseDate","i18n","preInit","tinymce","tinyMCEPreInit","srcScript","currentScript","pluginBaseUrls","plugin_base_urls","invalidInlineTargets","isInvalidInlineTarget","createId","findTargets","targets","types","forms","editor_deselector","editor_selector","provideResults","initEditors","initCount","createEditor","addI18n","compareRanges","getCaretRangeFromPoint","extendClass","initializing","RangeUtils$1","awaiter","resolveCb","rejectCb","complete","completer","Resource","tasks","resultFns","loadErrMsg","runErrMsg","task","waiter","round$2","relativePosition","targetW","targetH","create$7","findBestRelativePosition","constrainRect","rels","inflate","intersect","cropRect","x1","y1","clamp$1","clampRect","fixedSize","underflowX1","underflowY1","overflowX2","overflowY2","cx2","cy2","fromClientRect","Rect","each$k","extend$5","Class","member","_super","mixins","mixin","Mixins","dummy","Methods","Properties","fieldName","Statics","Defaults","localStorage","min$1","max$1","round$3","Color","rgb2hsv","minRGB","maxRGB","hsvToRgb","hue","saturation","brightness","side","chroma","toRgb","toHsv","stringify","hexCode","JSONUtils","JSONP","XHR","ready","success_scope","error_scope","overrideMimeType","content_type","crossDomain","setRequestHeader","requestheaders","extend$6","JSONRequest","sendRPC","ecb","scb","xhrArgs","ty","method","storage","getItem","setItem","removeItem","defineProperty","configurable","enumerable","LocalStorage","publicApi","geom","util","isMac","tinyMCE","globals","sha256","options","_imports","convertString","UTF8","stringToBytes","H","bytesToWords","processBlock","digestbytes","wordsToBytes","asBytes","asString","bytesToString","bytesToHex","convertHex","K","nPrime","sqrtN","bytes","words","W","M","gamma0x","gamma0","gamma1x","gamma1","maj","sigma0","sigma1","t1","t2","98","arrBytesToHex","padLeft","hexToBytes","99"],"mappings":"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,EAAGk3C,EAAIpe,EAAE/4B,OAAQC,EAAIk3C,IAC5Bve,EAAIA,EAAEG,EAAE94B,KADuBA,KAMjC,MAAO24B,IAELsgB,QAAU,SAAUp3C,EAAGq3C,GACzB,OAAKr3C,GAAKs2C,KAAKt2C,EAAG,SACTA,EAEFm2C,SAAS/sC,IAAIpJ,EAAEgM,MAAMqrC,GAAK,KAAMhB,SAErC9uC,gBAAkB,SAAUjC,KAC9B,GAAIyvC,aAAc94B,IAAI84B,WAItB,OAHIA,eACFzvC,OAA8B,IAAtBA,IAAInE,QAAQ,KAAc,IAAM,KAAO4zC,aAE1CzvC,KAELgC,OACFrF,KAAMo0C,OACNz5B,QAASu5B,SAASv5B,QAClBD,GAAI25B,KACJ12B,QAASu2B,SAASv2B,QAClBuL,QAASA,QACTnN,KAAMm4B,SAASn4B,KACf5U,IAAK+sC,SAAS/sC,IACdsrB,KAAMyhB,SAASjhC,OACflH,QAASmoC,SAASh1C,QAClBm2C,OAAQd,iBACRS,OAAQA,OACRr4B,OAAQA,OACRgX,KAAMA,KACNmhB,SAAUA,SACVlxC,QAASA,QACTuxC,QAASA,QACT7vC,gBAAiBA,iBAsKfgwC,QACF,UACA,QACA,UACA,MACA,KACA,aACA,SACA,OACA,WACA,SACA,SACA,OACA,OACA,MACA,UACA,UACA,OACA,IACA,KACA,WACA,KACA,SACA,UACA,SACA,aACA,KACA,KACA,KACA,KACA,KACA,KACA,UACA,MACA,MACA,YACA,OACA,MACA,KACA,KACA,KACA,KACA,QACA,QACA,QACA,QACA,KACA,KACA,KACA,WAEEC,OACF,OACA,OACA,WACA,KACA,MACA,QACA,KACA,MACA,QACA,UACA,OACA,OACA,QACA,QACA,SACA,MACA,SAEEC,YACF,KACA,MAEEC,eACF,QACA,QACA,SAEEC,YACF,KACA,KACA,KACA,KACA,KACA,KACA,IACA,MACA,UACA,MACA,OACA,aACA,SACA,MACA,WACA,SACA,SACA,UACA,UACA,SACA,QACA,MACA,UAEEC,UACF,KACA,KACA,KACA,KACA,KACA,MAEEC,WACF,KACA,KACA,MA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","file":"vendor.b548d56514f7d4ba28de.js","sourcesContent":["webpackJsonp([3],{\n\n/***/ 3:\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_RESULT__;/**\n * ngTableExcelExport 1.0.0\n * JavaScript export to Excel or CSV from HTML tables automatically in the browser and also compatible with all browsers.\n *\n * @author: Murugavel Ramachandran (blsrm@yahoo.com)\n * @url: https://github.com/blsrm/ngTableExcelExport\n *\n */\n/*jslint browser: true, bitwise: true, vars: true, white: true */\n/*global define, exports, module */\n\n(function (global) {\n    'use strict';\n\nvar ExcellentExport = (function() {\n\n    function b64toBlob(b64Data, contentType, sliceSize) {\n        // function taken from http://stackoverflow.com/a/16245768/2591950\n        // author Jeremy Banks http://stackoverflow.com/users/1114/jeremy-banks\n        contentType = contentType || '';\n        sliceSize = sliceSize || 512;\n\n        var byteCharacters = window.atob(b64Data);\n        var byteArrays = [];\n\n        var offset;\n        for (offset = 0; offset < byteCharacters.length; offset += sliceSize) {\n            var slice = byteCharacters.slice(offset, offset + sliceSize);\n\n            var byteNumbers = new Array(slice.length);\n            var i;\n            for (i = 0; i < slice.length; i = i + 1) {\n                byteNumbers[i] = slice.charCodeAt(i);\n            }\n\n            var byteArray = new window.Uint8Array(byteNumbers);\n\n            byteArrays.push(byteArray);\n        }\n\n        var blob = new window.Blob(byteArrays, {\n            type: contentType\n        });\n        return blob;\n    }\n\n    var version = \"1.5.0\";\n    var uri = {excel: 'data:application/vnd.ms-excel;base64,', csv: 'data:application/csv;base64,'};\n    var template = {excel: '<html xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:x=\"urn:schemas-microsoft-com:office:excel\" xmlns=\"http://www.w3.org/TR/REC-html40\"><head><meta name=ProgId content=Excel.Sheet> <meta name=Generator content=\"Microsoft Excel 11\"><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table border=\"1\">{table}</table></body></html>'};\n    var csvDelimiter = \",\";\n    var csvNewLine = \"\\r\\n\";\n    var base64 = function(s) {\n        return window.btoa(window.unescape(encodeURIComponent(s)));\n    };\n    var format = function(s, c) {\n        return s.replace(new RegExp(\"{(\\\\w+)}\", \"g\"), function(m, p) {\n            return c[p];\n        });\n    };\n\n    var get = function(element) {\n        if (!element.nodeType) {\n            return document.getElementById(element);\n        }\n        return element;\n    };\n\n    var fixCSVField = function(value) {\n        var fixedValue = value;\n        var addQuotes = (value.indexOf(csvDelimiter) !== -1) || (value.indexOf('\\r') !== -1) || (value.indexOf('\\n') !== -1);\n        var replaceDoubleQuotes = (value.indexOf('\"') !== -1);\n\n        if (replaceDoubleQuotes) {\n            fixedValue = fixedValue.replace(/\"/g, '\"\"');\n        }\n        if (addQuotes || replaceDoubleQuotes) {\n            fixedValue = '\"' + fixedValue + '\"';\n        }\n\n        return fixedValue;\n    };\n\n    var tableToCSV = function(table) {\n        var data = \"SEP=\"+csvDelimiter+csvNewLine;\n        var i, j, row, col;\n        var columnStart = 0;\n        for (i = 0; i < table.rows.length; i=i+1) {\n            row = table.rows[i];\n            var rowData = '';\n            \n            //Checking ng table style for filters\n            if(row.className.indexOf('ng-table-filters') !== -1) {\n\t\t\t\tcontinue;\n            }\n            \n            //remove first column having check box in angular JS, in future will provide option from UI to control\n            if(table.rows[0].cells[0].textContent.trim() === '') {\n            \tcolumnStart = 1;\n            }else {\n            \tcolumnStart = 0;\n            }\n\n            for (j = columnStart; j < row.cells.length; j=j+1) {\n                col = row.cells[j];\n                rowData = rowData + fixCSVField(col.textContent.trim()) + (j ? csvDelimiter : ' ');\n            }\n            rowData = rowData.slice(0, rowData.length - 1); //remove last semicolon\n            data += rowData + csvNewLine;\n        }\n        return data;\n    };\n\n    var tableToHTML = function(table) {\n        var data = \"\";\n        var i, j, row, col;\n        var columnStart = 0;\n        for (i = 0; i < table.rows.length; i=i+1) {\n            row = table.rows[i];\n            var rowData = '';\n            \n            //Checking ng table style for filters\n            if(row.className.indexOf('ng-table-filters') !== -1) {\n\t\t\t\tcontinue;\n            }\n            \n            //remove first column having check box in angular JS, in future will provide option from UI to control\n            if(table.rows[0].cells[0].textContent.trim() === '') {\n            \tcolumnStart = 1;\n            }else {\n            \tcolumnStart = 0;\n            }\n\n            for (j = columnStart; j < row.cells.length; j=j+1) {\n                col = row.cells[j];\n                if (i === 0) {\n                \trowData += '<th>' + col.textContent.trim() + '</th>';\n                } else {\n                \trowData += '<td>' + col.textContent.trim() + '</td>';\n                }\n            }\n            data += '<tr>' + rowData + '</tr>';\n        }\n        return data;\n    };\n\n    function createDownloadLink(anchor, base64data, exporttype, filename) {\n        var blob;\n        if (window.navigator.msSaveBlob) {\n            blob = b64toBlob(base64data, exporttype);\n            window.navigator.msSaveBlob(blob, filename);\n            return false;\n        } else if(window.URL.createObjectURL) {\n            blob = b64toBlob(base64data, exporttype);\n            var blobUrl = window.URL.createObjectURL(blob, exporttype, filename);\n            anchor.href = blobUrl;\n        } else {\n            var hrefvalue = \"data:\" + exporttype + \";base64,\" + base64data;\n            anchor.download = filename;\n            anchor.href = hrefvalue;\n        }\n\n        // Return true to allow the link to work\n        return true;\n    }\n\n    var ee = {\n        /** @export */\n        excel: function(anchor, table, name) {\n            table = get(table);\n\n            var htmlTableData = tableToHTML(table);\n            \n            var ctx = {worksheet: name || 'Worksheet', table: htmlTableData};\n            var b64 = base64(format(template.excel, ctx));\n            return createDownloadLink(anchor, b64, 'application/vnd.ms-excel','export.xls');\n        },\n        /** @export */\n        csv: function(anchor, table, delimiter, newLine) {\n            if (delimiter !== undefined && delimiter) {\n                csvDelimiter = delimiter;\n            }\n            if (newLine !== undefined && newLine) {\n                csvNewLine = newLine;\n            }\n\n            table = get(table);\n            var csvData = tableToCSV(table);\n            var b64 = base64(csvData);\n            return createDownloadLink(anchor,b64,'application/csv','export.csv');\n        }\n    };\n\n    return ee;\n}());\n\n    // AMD support\n    if (true) {\n        !(__WEBPACK_AMD_DEFINE_RESULT__ = function () { return ExcellentExport; }.call(exports, __webpack_require__, exports, module),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n    // CommonJS and Node.js module support.\n    } else if (typeof exports !== 'undefined') {\n        // Support Node.js specific `module.exports` (which can be a function)\n        if (typeof module !== 'undefined' && module.exports) {\n            exports = module.exports = ExcellentExport;\n        }\n        // But always support CommonJS module 1.1.1 spec (`exports` cannot be a function)\n        exports.ExcellentExport = ExcellentExport;\n    } else {\n        global.ExcellentExport = ExcellentExport;\n    }\n})(this);\n\n\n\n/***/ }),\n\n/***/ 309:\n/***/ (function(module, exports) {\n\nmodule.exports = \"/**\\n * ngTableExcelExport 1.0.0\\n * JavaScript export to Excel or CSV from HTML tables automatically in the browser and also compatible with all browsers.\\n *\\n * @author: Murugavel Ramachandran (blsrm@yahoo.com)\\n * @url: https://github.com/blsrm/ngTableExcelExport\\n *\\n */\\n/*jslint browser: true, bitwise: true, vars: true, white: true */\\n/*global define, exports, module */\\n\\n(function (global) {\\n    'use strict';\\n\\nvar ExcellentExport = (function() {\\n\\n    function b64toBlob(b64Data, contentType, sliceSize) {\\n        // function taken from http://stackoverflow.com/a/16245768/2591950\\n        // author Jeremy Banks http://stackoverflow.com/users/1114/jeremy-banks\\n        contentType = contentType || '';\\n        sliceSize = sliceSize || 512;\\n\\n        var byteCharacters = window.atob(b64Data);\\n        var byteArrays = [];\\n\\n        var offset;\\n        for (offset = 0; offset < byteCharacters.length; offset += sliceSize) {\\n            var slice = byteCharacters.slice(offset, offset + sliceSize);\\n\\n            var byteNumbers = new Array(slice.length);\\n            var i;\\n            for (i = 0; i < slice.length; i = i + 1) {\\n                byteNumbers[i] = slice.charCodeAt(i);\\n            }\\n\\n            var byteArray = new window.Uint8Array(byteNumbers);\\n\\n            byteArrays.push(byteArray);\\n        }\\n\\n        var blob = new window.Blob(byteArrays, {\\n            type: contentType\\n        });\\n        return blob;\\n    }\\n\\n    var version = \\\"1.5.0\\\";\\n    var uri = {excel: 'data:application/vnd.ms-excel;base64,', csv: 'data:application/csv;base64,'};\\n    var template = {excel: '<html xmlns:o=\\\"urn:schemas-microsoft-com:office:office\\\" xmlns:x=\\\"urn:schemas-microsoft-com:office:excel\\\" xmlns=\\\"http://www.w3.org/TR/REC-html40\\\"><head><meta name=ProgId content=Excel.Sheet> <meta name=Generator content=\\\"Microsoft Excel 11\\\"><meta http-equiv=\\\"Content-Type\\\" content=\\\"text/html; charset=UTF-8\\\"><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table border=\\\"1\\\">{table}</table></body></html>'};\\n    var csvDelimiter = \\\",\\\";\\n    var csvNewLine = \\\"\\\\r\\\\n\\\";\\n    var base64 = function(s) {\\n        return window.btoa(window.unescape(encodeURIComponent(s)));\\n    };\\n    var format = function(s, c) {\\n        return s.replace(new RegExp(\\\"{(\\\\\\\\w+)}\\\", \\\"g\\\"), function(m, p) {\\n            return c[p];\\n        });\\n    };\\n\\n    var get = function(element) {\\n        if (!element.nodeType) {\\n            return document.getElementById(element);\\n        }\\n        return element;\\n    };\\n\\n    var fixCSVField = function(value) {\\n        var fixedValue = value;\\n        var addQuotes = (value.indexOf(csvDelimiter) !== -1) || (value.indexOf('\\\\r') !== -1) || (value.indexOf('\\\\n') !== -1);\\n        var replaceDoubleQuotes = (value.indexOf('\\\"') !== -1);\\n\\n        if (replaceDoubleQuotes) {\\n            fixedValue = fixedValue.replace(/\\\"/g, '\\\"\\\"');\\n        }\\n        if (addQuotes || replaceDoubleQuotes) {\\n            fixedValue = '\\\"' + fixedValue + '\\\"';\\n        }\\n\\n        return fixedValue;\\n    };\\n\\n    var tableToCSV = function(table) {\\n        var data = \\\"SEP=\\\"+csvDelimiter+csvNewLine;\\n        var i, j, row, col;\\n        var columnStart = 0;\\n        for (i = 0; i < table.rows.length; i=i+1) {\\n            row = table.rows[i];\\n            var rowData = '';\\n            \\n            //Checking ng table style for filters\\n            if(row.className.indexOf('ng-table-filters') !== -1) {\\n\\t\\t\\t\\tcontinue;\\n            }\\n            \\n            //remove first column having check box in angular JS, in future will provide option from UI to control\\n            if(table.rows[0].cells[0].textContent.trim() === '') {\\n            \\tcolumnStart = 1;\\n            }else {\\n            \\tcolumnStart = 0;\\n            }\\n\\n            for (j = columnStart; j < row.cells.length; j=j+1) {\\n                col = row.cells[j];\\n                rowData = rowData + fixCSVField(col.textContent.trim()) + (j ? csvDelimiter : ' ');\\n            }\\n            rowData = rowData.slice(0, rowData.length - 1); //remove last semicolon\\n            data += rowData + csvNewLine;\\n        }\\n        return data;\\n    };\\n\\n    var tableToHTML = function(table) {\\n        var data = \\\"\\\";\\n        var i, j, row, col;\\n        var columnStart = 0;\\n        for (i = 0; i < table.rows.length; i=i+1) {\\n            row = table.rows[i];\\n            var rowData = '';\\n            \\n            //Checking ng table style for filters\\n            if(row.className.indexOf('ng-table-filters') !== -1) {\\n\\t\\t\\t\\tcontinue;\\n            }\\n            \\n            //remove first column having check box in angular JS, in future will provide option from UI to control\\n            if(table.rows[0].cells[0].textContent.trim() === '') {\\n            \\tcolumnStart = 1;\\n            }else {\\n            \\tcolumnStart = 0;\\n            }\\n\\n            for (j = columnStart; j < row.cells.length; j=j+1) {\\n                col = row.cells[j];\\n                if (i === 0) {\\n                \\trowData += '<th>' + col.textContent.trim() + '</th>';\\n                } else {\\n                \\trowData += '<td>' + col.textContent.trim() + '</td>';\\n                }\\n            }\\n            data += '<tr>' + rowData + '</tr>';\\n        }\\n        return data;\\n    };\\n\\n    function createDownloadLink(anchor, base64data, exporttype, filename) {\\n        var blob;\\n        if (window.navigator.msSaveBlob) {\\n            blob = b64toBlob(base64data, exporttype);\\n            window.navigator.msSaveBlob(blob, filename);\\n            return false;\\n        } else if(window.URL.createObjectURL) {\\n            blob = b64toBlob(base64data, exporttype);\\n            var blobUrl = window.URL.createObjectURL(blob, exporttype, filename);\\n            anchor.href = blobUrl;\\n        } else {\\n            var hrefvalue = \\\"data:\\\" + exporttype + \\\";base64,\\\" + base64data;\\n            anchor.download = filename;\\n            anchor.href = hrefvalue;\\n        }\\n\\n        // Return true to allow the link to work\\n        return true;\\n    }\\n\\n    var ee = {\\n        /** @export */\\n        excel: function(anchor, table, name) {\\n            table = get(table);\\n\\n            var htmlTableData = tableToHTML(table);\\n            \\n            var ctx = {worksheet: name || 'Worksheet', table: htmlTableData};\\n            var b64 = base64(format(template.excel, ctx));\\n            return createDownloadLink(anchor, b64, 'application/vnd.ms-excel','export.xls');\\n        },\\n        /** @export */\\n        csv: function(anchor, table, delimiter, newLine) {\\n            if (delimiter !== undefined && delimiter) {\\n                csvDelimiter = delimiter;\\n            }\\n            if (newLine !== undefined && newLine) {\\n                csvNewLine = newLine;\\n            }\\n\\n            table = get(table);\\n            var csvData = tableToCSV(table);\\n            var b64 = base64(csvData);\\n            return createDownloadLink(anchor,b64,'application/csv','export.csv');\\n        }\\n    };\\n\\n    return ee;\\n}());\\n\\n    // AMD support\\n    if (typeof define === 'function' && define.amd) {\\n        define(function () { return ExcellentExport; });\\n    // CommonJS and Node.js module support.\\n    } else if (typeof exports !== 'undefined') {\\n        // Support Node.js specific `module.exports` (which can be a function)\\n        if (typeof module !== 'undefined' && module.exports) {\\n            exports = module.exports = ExcellentExport;\\n        }\\n        // But always support CommonJS module 1.1.1 spec (`exports` cannot be a function)\\n        exports.ExcellentExport = ExcellentExport;\\n    } else {\\n        global.ExcellentExport = ExcellentExport;\\n    }\\n})(this);\\n\\n\"\n\n/***/ }),\n\n/***/ 310:\n/***/ (function(module, exports) {\n\n/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\nmodule.exports = function(src) {\n\tfunction log(error) {\n\t\t(typeof console !== \"undefined\")\n\t\t&& (console.error || console.log)(\"[Script Loader]\", error);\n\t}\n\n\t// Check for IE =< 8\n\tfunction isIE() {\n\t\treturn typeof attachEvent !== \"undefined\" && typeof addEventListener === \"undefined\";\n\t}\n\n\ttry {\n\t\tif (typeof execScript !== \"undefined\" && isIE()) {\n\t\t\texecScript(src);\n\t\t} else if (typeof eval !== \"undefined\") {\n\t\t\teval.call(null, src);\n\t\t} else {\n\t\t\tlog(\"EvalError: No eval function available\");\n\t\t}\n\t} catch (error) {\n\t\tlog(error);\n\t}\n}\n\n\n/***/ }),\n\n/***/ 311:\n/***/ (function(module, exports, __webpack_require__) {\n\n__webpack_require__(310)(__webpack_require__(309))\n\n/***/ }),\n\n/***/ 312:\n/***/ (function(module, exports, __webpack_require__) {\n\n/* WEBPACK VAR INJECTION */(function(global) {/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.2.0 (2020-02-13)\n */\n(function (domGlobals) {\n    'use strict';\n\n    var noop = function () {\n    };\n    var compose = function (fa, fb) {\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        return fa(fb.apply(null, args));\n      };\n    };\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    var identity = function (x) {\n      return x;\n    };\n    function curry(fn) {\n      var initialArgs = [];\n      for (var _i = 1; _i < arguments.length; _i++) {\n        initialArgs[_i - 1] = arguments[_i];\n      }\n      return function () {\n        var restArgs = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          restArgs[_i] = arguments[_i];\n        }\n        var all = initialArgs.concat(restArgs);\n        return fn.apply(null, all);\n      };\n    }\n    var not = function (f) {\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        return !f.apply(null, args);\n      };\n    };\n    var die = function (msg) {\n      return function () {\n        throw new Error(msg);\n      };\n    };\n    var never = constant(false);\n    var always = constant(true);\n\n    var none = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var eq = function (o) {\n        return o.isNone();\n      };\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = function (n) {\n        return n;\n      };\n      var me = {\n        fold: function (n, s) {\n          return n();\n        },\n        is: never,\n        isSome: never,\n        isNone: always,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: constant(null),\n        getOrUndefined: constant(undefined),\n        or: id,\n        orThunk: call,\n        map: none,\n        each: noop,\n        bind: none,\n        exists: never,\n        forall: always,\n        filter: none,\n        equals: eq,\n        equals_: eq,\n        toArray: function () {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      if (Object.freeze) {\n        Object.freeze(me);\n      }\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = constant(a);\n      var self = function () {\n        return me;\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        is: function (v) {\n          return a === v;\n        },\n        isSome: always,\n        isNone: never,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: function (f) {\n          return some(f(a));\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        },\n        equals: function (o) {\n          return o.is(a);\n        },\n        equals_: function (o, elementEq) {\n          return o.fold(never, function (b) {\n            return elementEq(a, b);\n          });\n        }\n      };\n      return me;\n    };\n    var from = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Option = {\n      some: some,\n      none: none,\n      from: from\n    };\n\n    var typeOf = function (x) {\n      if (x === null) {\n        return 'null';\n      }\n      var t = typeof x;\n      if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n        return 'array';\n      }\n      if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n        return 'string';\n      }\n      return t;\n    };\n    var isType = function (type) {\n      return function (value) {\n        return typeOf(value) === type;\n      };\n    };\n    var isString = isType('string');\n    var isObject = isType('object');\n    var isArray = isType('array');\n    var isNull = isType('null');\n    var isBoolean = isType('boolean');\n    var isFunction = isType('function');\n    var isNumber = isType('number');\n\n    var nativeSlice = Array.prototype.slice;\n    var nativeIndexOf = Array.prototype.indexOf;\n    var nativePush = Array.prototype.push;\n    var rawIndexOf = function (ts, t) {\n      return nativeIndexOf.call(ts, t);\n    };\n    var indexOf = function (xs, x) {\n      var r = rawIndexOf(xs, x);\n      return r === -1 ? Option.none() : Option.some(r);\n    };\n    var contains = function (xs, x) {\n      return rawIndexOf(xs, x) > -1;\n    };\n    var exists = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return true;\n        }\n      }\n      return false;\n    };\n    var map = function (xs, f) {\n      var len = xs.length;\n      var r = new Array(len);\n      for (var i = 0; i < len; i++) {\n        var x = xs[i];\n        r[i] = f(x, i);\n      }\n      return r;\n    };\n    var each = function (xs, f) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var eachr = function (xs, f) {\n      for (var i = xs.length - 1; i >= 0; i--) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var partition = function (xs, pred) {\n      var pass = [];\n      var fail = [];\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        var arr = pred(x, i) ? pass : fail;\n        arr.push(x);\n      }\n      return {\n        pass: pass,\n        fail: fail\n      };\n    };\n    var filter = function (xs, pred) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          r.push(x);\n        }\n      }\n      return r;\n    };\n    var foldr = function (xs, f, acc) {\n      eachr(xs, function (x) {\n        acc = f(acc, x);\n      });\n      return acc;\n    };\n    var foldl = function (xs, f, acc) {\n      each(xs, function (x) {\n        acc = f(acc, x);\n      });\n      return acc;\n    };\n    var find = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return Option.some(x);\n        }\n      }\n      return Option.none();\n    };\n    var findIndex = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return Option.some(i);\n        }\n      }\n      return Option.none();\n    };\n    var flatten = function (xs) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        if (!isArray(xs[i])) {\n          throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n        }\n        nativePush.apply(r, xs[i]);\n      }\n      return r;\n    };\n    var bind = function (xs, f) {\n      return flatten(map(xs, f));\n    };\n    var forall = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        var x = xs[i];\n        if (pred(x, i) !== true) {\n          return false;\n        }\n      }\n      return true;\n    };\n    var reverse = function (xs) {\n      var r = nativeSlice.call(xs, 0);\n      r.reverse();\n      return r;\n    };\n    var difference = function (a1, a2) {\n      return filter(a1, function (x) {\n        return !contains(a2, x);\n      });\n    };\n    var mapToObject = function (xs, f) {\n      var r = {};\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        r[String(x)] = f(x, i);\n      }\n      return r;\n    };\n    var sort = function (xs, comparator) {\n      var copy = nativeSlice.call(xs, 0);\n      copy.sort(comparator);\n      return copy;\n    };\n    var head = function (xs) {\n      return xs.length === 0 ? Option.none() : Option.some(xs[0]);\n    };\n    var last = function (xs) {\n      return xs.length === 0 ? Option.none() : Option.some(xs[xs.length - 1]);\n    };\n    var from$1 = isFunction(Array.from) ? Array.from : function (x) {\n      return nativeSlice.call(x);\n    };\n\n    var keys = Object.keys;\n    var hasOwnProperty = Object.hasOwnProperty;\n    var each$1 = function (obj, f) {\n      var props = keys(obj);\n      for (var k = 0, len = props.length; k < len; k++) {\n        var i = props[k];\n        var x = obj[i];\n        f(x, i);\n      }\n    };\n    var map$1 = function (obj, f) {\n      return tupleMap(obj, function (x, i) {\n        return {\n          k: i,\n          v: f(x, i)\n        };\n      });\n    };\n    var tupleMap = function (obj, f) {\n      var r = {};\n      each$1(obj, function (x, i) {\n        var tuple = f(x, i);\n        r[tuple.k] = tuple.v;\n      });\n      return r;\n    };\n    var objAcc = function (r) {\n      return function (x, i) {\n        r[i] = x;\n      };\n    };\n    var internalFilter = function (obj, pred, onTrue, onFalse) {\n      var r = {};\n      each$1(obj, function (x, i) {\n        (pred(x, i) ? onTrue : onFalse)(x, i);\n      });\n      return r;\n    };\n    var bifilter = function (obj, pred) {\n      var t = {};\n      var f = {};\n      internalFilter(obj, pred, objAcc(t), objAcc(f));\n      return {\n        t: t,\n        f: f\n      };\n    };\n    var get = function (obj, key) {\n      return has(obj, key) ? Option.from(obj[key]) : Option.none();\n    };\n    var has = function (obj, key) {\n      return hasOwnProperty.call(obj, key);\n    };\n\n    var __assign = function () {\n      __assign = Object.assign || function __assign(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s)\n            if (Object.prototype.hasOwnProperty.call(s, p))\n              t[p] = s[p];\n        }\n        return t;\n      };\n      return __assign.apply(this, arguments);\n    };\n    function __rest(s, e) {\n      var t = {};\n      for (var p in s)\n        if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n          t[p] = s[p];\n      if (s != null && typeof Object.getOwnPropertySymbols === 'function')\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n          if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n            t[p[i]] = s[p[i]];\n        }\n      return t;\n    }\n\n    var fromHtml = function (html, scope) {\n      var doc = scope || domGlobals.document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      if (!div.hasChildNodes() || div.childNodes.length > 1) {\n        domGlobals.console.error('HTML does not have a single root node', html);\n        throw new Error('HTML must have a single root node');\n      }\n      return fromDom(div.childNodes[0]);\n    };\n    var fromTag = function (tag, scope) {\n      var doc = scope || domGlobals.document;\n      var node = doc.createElement(tag);\n      return fromDom(node);\n    };\n    var fromText = function (text, scope) {\n      var doc = scope || domGlobals.document;\n      var node = doc.createTextNode(text);\n      return fromDom(node);\n    };\n    var fromDom = function (node) {\n      if (node === null || node === undefined) {\n        throw new Error('Node cannot be null or undefined');\n      }\n      return { dom: constant(node) };\n    };\n    var fromPoint = function (docElm, x, y) {\n      var doc = docElm.dom();\n      return Option.from(doc.elementFromPoint(x, y)).map(fromDom);\n    };\n    var Element = {\n      fromHtml: fromHtml,\n      fromTag: fromTag,\n      fromText: fromText,\n      fromDom: fromDom,\n      fromPoint: fromPoint\n    };\n\n    var Cell = function (initial) {\n      var value = initial;\n      var get = function () {\n        return value;\n      };\n      var set = function (v) {\n        value = v;\n      };\n      var clone = function () {\n        return Cell(get());\n      };\n      return {\n        get: get,\n        set: set,\n        clone: clone\n      };\n    };\n\n    var firstMatch = function (regexes, s) {\n      for (var i = 0; i < regexes.length; i++) {\n        var x = regexes[i];\n        if (x.test(s)) {\n          return x;\n        }\n      }\n      return undefined;\n    };\n    var find$1 = function (regexes, agent) {\n      var r = firstMatch(regexes, agent);\n      if (!r) {\n        return {\n          major: 0,\n          minor: 0\n        };\n      }\n      var group = function (i) {\n        return Number(agent.replace(r, '$' + i));\n      };\n      return nu(group(1), group(2));\n    };\n    var detect = function (versionRegexes, agent) {\n      var cleanedAgent = String(agent).toLowerCase();\n      if (versionRegexes.length === 0) {\n        return unknown();\n      }\n      return find$1(versionRegexes, cleanedAgent);\n    };\n    var unknown = function () {\n      return nu(0, 0);\n    };\n    var nu = function (major, minor) {\n      return {\n        major: major,\n        minor: minor\n      };\n    };\n    var Version = {\n      nu: nu,\n      detect: detect,\n      unknown: unknown\n    };\n\n    var edge = 'Edge';\n    var chrome = 'Chrome';\n    var ie = 'IE';\n    var opera = 'Opera';\n    var firefox = 'Firefox';\n    var safari = 'Safari';\n    var isBrowser = function (name, current) {\n      return function () {\n        return current === name;\n      };\n    };\n    var unknown$1 = function () {\n      return nu$1({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$1 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      return {\n        current: current,\n        version: version,\n        isEdge: isBrowser(edge, current),\n        isChrome: isBrowser(chrome, current),\n        isIE: isBrowser(ie, current),\n        isOpera: isBrowser(opera, current),\n        isFirefox: isBrowser(firefox, current),\n        isSafari: isBrowser(safari, current)\n      };\n    };\n    var Browser = {\n      unknown: unknown$1,\n      nu: nu$1,\n      edge: constant(edge),\n      chrome: constant(chrome),\n      ie: constant(ie),\n      opera: constant(opera),\n      firefox: constant(firefox),\n      safari: constant(safari)\n    };\n\n    var windows = 'Windows';\n    var ios = 'iOS';\n    var android = 'Android';\n    var linux = 'Linux';\n    var osx = 'OSX';\n    var solaris = 'Solaris';\n    var freebsd = 'FreeBSD';\n    var chromeos = 'ChromeOS';\n    var isOS = function (name, current) {\n      return function () {\n        return current === name;\n      };\n    };\n    var unknown$2 = function () {\n      return nu$2({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$2 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      return {\n        current: current,\n        version: version,\n        isWindows: isOS(windows, current),\n        isiOS: isOS(ios, current),\n        isAndroid: isOS(android, current),\n        isOSX: isOS(osx, current),\n        isLinux: isOS(linux, current),\n        isSolaris: isOS(solaris, current),\n        isFreeBSD: isOS(freebsd, current),\n        isChromeOS: isOS(chromeos, current)\n      };\n    };\n    var OperatingSystem = {\n      unknown: unknown$2,\n      nu: nu$2,\n      windows: constant(windows),\n      ios: constant(ios),\n      android: constant(android),\n      linux: constant(linux),\n      osx: constant(osx),\n      solaris: constant(solaris),\n      freebsd: constant(freebsd),\n      chromeos: constant(chromeos)\n    };\n\n    var DeviceType = function (os, browser, userAgent, mediaMatch) {\n      var isiPad = os.isiOS() && /ipad/i.test(userAgent) === true;\n      var isiPhone = os.isiOS() && !isiPad;\n      var isMobile = os.isiOS() || os.isAndroid();\n      var isTouch = isMobile || mediaMatch('(pointer:coarse)');\n      var isTablet = isiPad || !isiPhone && isMobile && mediaMatch('(min-device-width:768px)');\n      var isPhone = isiPhone || isMobile && !isTablet;\n      var iOSwebview = browser.isSafari() && os.isiOS() && /safari/i.test(userAgent) === false;\n      var isDesktop = !isPhone && !isTablet && !iOSwebview;\n      return {\n        isiPad: constant(isiPad),\n        isiPhone: constant(isiPhone),\n        isTablet: constant(isTablet),\n        isPhone: constant(isPhone),\n        isTouch: constant(isTouch),\n        isAndroid: os.isAndroid,\n        isiOS: os.isiOS,\n        isWebView: constant(iOSwebview),\n        isDesktop: constant(isDesktop)\n      };\n    };\n\n    var detect$1 = function (candidates, userAgent) {\n      var agent = String(userAgent).toLowerCase();\n      return find(candidates, function (candidate) {\n        return candidate.search(agent);\n      });\n    };\n    var detectBrowser = function (browsers, userAgent) {\n      return detect$1(browsers, userAgent).map(function (browser) {\n        var version = Version.detect(browser.versionRegexes, userAgent);\n        return {\n          current: browser.name,\n          version: version\n        };\n      });\n    };\n    var detectOs = function (oses, userAgent) {\n      return detect$1(oses, userAgent).map(function (os) {\n        var version = Version.detect(os.versionRegexes, userAgent);\n        return {\n          current: os.name,\n          version: version\n        };\n      });\n    };\n    var UaString = {\n      detectBrowser: detectBrowser,\n      detectOs: detectOs\n    };\n\n    var checkRange = function (str, substr, start) {\n      if (substr === '') {\n        return true;\n      }\n      if (str.length < substr.length) {\n        return false;\n      }\n      var x = str.substr(start, start + substr.length);\n      return x === substr;\n    };\n    var contains$1 = function (str, substr) {\n      return str.indexOf(substr) !== -1;\n    };\n    var startsWith = function (str, prefix) {\n      return checkRange(str, prefix, 0);\n    };\n    var trim = function (str) {\n      return str.replace(/^\\s+|\\s+$/g, '');\n    };\n    var lTrim = function (str) {\n      return str.replace(/^\\s+/g, '');\n    };\n    var rTrim = function (str) {\n      return str.replace(/\\s+$/g, '');\n    };\n\n    var normalVersionRegex = /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/;\n    var checkContains = function (target) {\n      return function (uastring) {\n        return contains$1(uastring, target);\n      };\n    };\n    var browsers = [\n      {\n        name: 'Edge',\n        versionRegexes: [/.*?edge\\/ ?([0-9]+)\\.([0-9]+)$/],\n        search: function (uastring) {\n          return contains$1(uastring, 'edge/') && contains$1(uastring, 'chrome') && contains$1(uastring, 'safari') && contains$1(uastring, 'applewebkit');\n        }\n      },\n      {\n        name: 'Chrome',\n        versionRegexes: [\n          /.*?chrome\\/([0-9]+)\\.([0-9]+).*/,\n          normalVersionRegex\n        ],\n        search: function (uastring) {\n          return contains$1(uastring, 'chrome') && !contains$1(uastring, 'chromeframe');\n        }\n      },\n      {\n        name: 'IE',\n        versionRegexes: [\n          /.*?msie\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*?rv:([0-9]+)\\.([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return contains$1(uastring, 'msie') || contains$1(uastring, 'trident');\n        }\n      },\n      {\n        name: 'Opera',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?opera\\/([0-9]+)\\.([0-9]+).*/\n        ],\n        search: checkContains('opera')\n      },\n      {\n        name: 'Firefox',\n        versionRegexes: [/.*?firefox\\/\\ ?([0-9]+)\\.([0-9]+).*/],\n        search: checkContains('firefox')\n      },\n      {\n        name: 'Safari',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?cpu os ([0-9]+)_([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return (contains$1(uastring, 'safari') || contains$1(uastring, 'mobile/')) && contains$1(uastring, 'applewebkit');\n        }\n      }\n    ];\n    var oses = [\n      {\n        name: 'Windows',\n        search: checkContains('win'),\n        versionRegexes: [/.*?windows\\ nt\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'iOS',\n        search: function (uastring) {\n          return contains$1(uastring, 'iphone') || contains$1(uastring, 'ipad');\n        },\n        versionRegexes: [\n          /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*cpu os ([0-9]+)_([0-9]+).*/,\n          /.*cpu iphone os ([0-9]+)_([0-9]+).*/\n        ]\n      },\n      {\n        name: 'Android',\n        search: checkContains('android'),\n        versionRegexes: [/.*?android\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'OSX',\n        search: checkContains('mac os x'),\n        versionRegexes: [/.*?mac\\ os\\ x\\ ?([0-9]+)_([0-9]+).*/]\n      },\n      {\n        name: 'Linux',\n        search: checkContains('linux'),\n        versionRegexes: []\n      },\n      {\n        name: 'Solaris',\n        search: checkContains('sunos'),\n        versionRegexes: []\n      },\n      {\n        name: 'FreeBSD',\n        search: checkContains('freebsd'),\n        versionRegexes: []\n      },\n      {\n        name: 'ChromeOS',\n        search: checkContains('cros'),\n        versionRegexes: [/.*?chrome\\/([0-9]+)\\.([0-9]+).*/]\n      }\n    ];\n    var PlatformInfo = {\n      browsers: constant(browsers),\n      oses: constant(oses)\n    };\n\n    var detect$2 = function (userAgent, mediaMatch) {\n      var browsers = PlatformInfo.browsers();\n      var oses = PlatformInfo.oses();\n      var browser = UaString.detectBrowser(browsers, userAgent).fold(Browser.unknown, Browser.nu);\n      var os = UaString.detectOs(oses, userAgent).fold(OperatingSystem.unknown, OperatingSystem.nu);\n      var deviceType = DeviceType(os, browser, userAgent, mediaMatch);\n      return {\n        browser: browser,\n        os: os,\n        deviceType: deviceType\n      };\n    };\n    var PlatformDetection = { detect: detect$2 };\n\n    var mediaMatch = function (query) {\n      return domGlobals.window.matchMedia(query).matches;\n    };\n    var platform = Cell(PlatformDetection.detect(domGlobals.navigator.userAgent, mediaMatch));\n    var detect$3 = function () {\n      return platform.get();\n    };\n\n    var Immutable = function () {\n      var fields = [];\n      for (var _i = 0; _i < arguments.length; _i++) {\n        fields[_i] = arguments[_i];\n      }\n      return function () {\n        var values = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          values[_i] = arguments[_i];\n        }\n        if (fields.length !== values.length) {\n          throw new Error('Wrong number of arguments to struct. Expected \"[' + fields.length + ']\", got ' + values.length + ' arguments');\n        }\n        var struct = {};\n        each(fields, function (name, i) {\n          struct[name] = constant(values[i]);\n        });\n        return struct;\n      };\n    };\n\n    var toArray = function (target, f) {\n      var r = [];\n      var recurse = function (e) {\n        r.push(e);\n        return f(e);\n      };\n      var cur = f(target);\n      do {\n        cur = cur.bind(recurse);\n      } while (cur.isSome());\n      return r;\n    };\n    var Recurse = { toArray: toArray };\n\n    var compareDocumentPosition = function (a, b, match) {\n      return (a.compareDocumentPosition(b) & match) !== 0;\n    };\n    var documentPositionPreceding = function (a, b) {\n      return compareDocumentPosition(a, b, domGlobals.Node.DOCUMENT_POSITION_PRECEDING);\n    };\n    var documentPositionContainedBy = function (a, b) {\n      return compareDocumentPosition(a, b, domGlobals.Node.DOCUMENT_POSITION_CONTAINED_BY);\n    };\n    var Node = {\n      documentPositionPreceding: documentPositionPreceding,\n      documentPositionContainedBy: documentPositionContainedBy\n    };\n\n    var ATTRIBUTE = domGlobals.Node.ATTRIBUTE_NODE;\n    var CDATA_SECTION = domGlobals.Node.CDATA_SECTION_NODE;\n    var COMMENT = domGlobals.Node.COMMENT_NODE;\n    var DOCUMENT = domGlobals.Node.DOCUMENT_NODE;\n    var DOCUMENT_TYPE = domGlobals.Node.DOCUMENT_TYPE_NODE;\n    var DOCUMENT_FRAGMENT = domGlobals.Node.DOCUMENT_FRAGMENT_NODE;\n    var ELEMENT = domGlobals.Node.ELEMENT_NODE;\n    var TEXT = domGlobals.Node.TEXT_NODE;\n    var PROCESSING_INSTRUCTION = domGlobals.Node.PROCESSING_INSTRUCTION_NODE;\n    var ENTITY_REFERENCE = domGlobals.Node.ENTITY_REFERENCE_NODE;\n    var ENTITY = domGlobals.Node.ENTITY_NODE;\n    var NOTATION = domGlobals.Node.NOTATION_NODE;\n\n    var ELEMENT$1 = ELEMENT;\n    var DOCUMENT$1 = DOCUMENT;\n    var is = function (element, selector) {\n      var dom = element.dom();\n      if (dom.nodeType !== ELEMENT$1) {\n        return false;\n      } else {\n        var elem = dom;\n        if (elem.matches !== undefined) {\n          return elem.matches(selector);\n        } else if (elem.msMatchesSelector !== undefined) {\n          return elem.msMatchesSelector(selector);\n        } else if (elem.webkitMatchesSelector !== undefined) {\n          return elem.webkitMatchesSelector(selector);\n        } else if (elem.mozMatchesSelector !== undefined) {\n          return elem.mozMatchesSelector(selector);\n        } else {\n          throw new Error('Browser lacks native selectors');\n        }\n      }\n    };\n    var bypassSelector = function (dom) {\n      return dom.nodeType !== ELEMENT$1 && dom.nodeType !== DOCUMENT$1 || dom.childElementCount === 0;\n    };\n    var all = function (selector, scope) {\n      var base = scope === undefined ? domGlobals.document : scope.dom();\n      return bypassSelector(base) ? [] : map(base.querySelectorAll(selector), Element.fromDom);\n    };\n    var one = function (selector, scope) {\n      var base = scope === undefined ? domGlobals.document : scope.dom();\n      return bypassSelector(base) ? Option.none() : Option.from(base.querySelector(selector)).map(Element.fromDom);\n    };\n\n    var eq = function (e1, e2) {\n      return e1.dom() === e2.dom();\n    };\n    var regularContains = function (e1, e2) {\n      var d1 = e1.dom();\n      var d2 = e2.dom();\n      return d1 === d2 ? false : d1.contains(d2);\n    };\n    var ieContains = function (e1, e2) {\n      return Node.documentPositionContainedBy(e1.dom(), e2.dom());\n    };\n    var browser = detect$3().browser;\n    var contains$2 = browser.isIE() ? ieContains : regularContains;\n\n    var owner = function (element) {\n      return Element.fromDom(element.dom().ownerDocument);\n    };\n    var documentElement = function (element) {\n      return Element.fromDom(element.dom().ownerDocument.documentElement);\n    };\n    var defaultView = function (element) {\n      return Element.fromDom(element.dom().ownerDocument.defaultView);\n    };\n    var parent = function (element) {\n      return Option.from(element.dom().parentNode).map(Element.fromDom);\n    };\n    var parents = function (element, isRoot) {\n      var stop = isFunction(isRoot) ? isRoot : never;\n      var dom = element.dom();\n      var ret = [];\n      while (dom.parentNode !== null && dom.parentNode !== undefined) {\n        var rawParent = dom.parentNode;\n        var p = Element.fromDom(rawParent);\n        ret.push(p);\n        if (stop(p) === true) {\n          break;\n        } else {\n          dom = rawParent;\n        }\n      }\n      return ret;\n    };\n    var prevSibling = function (element) {\n      return Option.from(element.dom().previousSibling).map(Element.fromDom);\n    };\n    var nextSibling = function (element) {\n      return Option.from(element.dom().nextSibling).map(Element.fromDom);\n    };\n    var prevSiblings = function (element) {\n      return reverse(Recurse.toArray(element, prevSibling));\n    };\n    var nextSiblings = function (element) {\n      return Recurse.toArray(element, nextSibling);\n    };\n    var children = function (element) {\n      return map(element.dom().childNodes, Element.fromDom);\n    };\n    var child = function (element, index) {\n      var cs = element.dom().childNodes;\n      return Option.from(cs[index]).map(Element.fromDom);\n    };\n    var firstChild = function (element) {\n      return child(element, 0);\n    };\n    var lastChild = function (element) {\n      return child(element, element.dom().childNodes.length - 1);\n    };\n    var childNodesCount = function (element) {\n      return element.dom().childNodes.length;\n    };\n    var spot = Immutable('element', 'offset');\n\n    var before = function (marker, element) {\n      var parent$1 = parent(marker);\n      parent$1.each(function (v) {\n        v.dom().insertBefore(element.dom(), marker.dom());\n      });\n    };\n    var after = function (marker, element) {\n      var sibling = nextSibling(marker);\n      sibling.fold(function () {\n        var parent$1 = parent(marker);\n        parent$1.each(function (v) {\n          append(v, element);\n        });\n      }, function (v) {\n        before(v, element);\n      });\n    };\n    var prepend = function (parent, element) {\n      var firstChild$1 = firstChild(parent);\n      firstChild$1.fold(function () {\n        append(parent, element);\n      }, function (v) {\n        parent.dom().insertBefore(element.dom(), v.dom());\n      });\n    };\n    var append = function (parent, element) {\n      parent.dom().appendChild(element.dom());\n    };\n    var wrap = function (element, wrapper) {\n      before(element, wrapper);\n      append(wrapper, element);\n    };\n\n    var before$1 = function (marker, elements) {\n      each(elements, function (x) {\n        before(marker, x);\n      });\n    };\n    var append$1 = function (parent, elements) {\n      each(elements, function (x) {\n        append(parent, x);\n      });\n    };\n\n    var empty = function (element) {\n      element.dom().textContent = '';\n      each(children(element), function (rogue) {\n        remove(rogue);\n      });\n    };\n    var remove = function (element) {\n      var dom = element.dom();\n      if (dom.parentNode !== null) {\n        dom.parentNode.removeChild(dom);\n      }\n    };\n    var unwrap = function (wrapper) {\n      var children$1 = children(wrapper);\n      if (children$1.length > 0) {\n        before$1(wrapper, children$1);\n      }\n      remove(wrapper);\n    };\n\n    var Global = typeof domGlobals.window !== 'undefined' ? domGlobals.window : Function('return this;')();\n\n    var name = function (element) {\n      var r = element.dom().nodeName;\n      return r.toLowerCase();\n    };\n    var type = function (element) {\n      return element.dom().nodeType;\n    };\n    var isType$1 = function (t) {\n      return function (element) {\n        return type(element) === t;\n      };\n    };\n    var isElement = isType$1(ELEMENT);\n    var isText = isType$1(TEXT);\n\n    var inBody = function (element) {\n      var dom = isText(element) ? element.dom().parentNode : element.dom();\n      return dom !== undefined && dom !== null && dom.ownerDocument.body.contains(dom);\n    };\n\n    var r = function (left, top) {\n      var translate = function (x, y) {\n        return r(left + x, top + y);\n      };\n      return {\n        left: constant(left),\n        top: constant(top),\n        translate: translate\n      };\n    };\n    var Position = r;\n\n    var boxPosition = function (dom) {\n      var box = dom.getBoundingClientRect();\n      return Position(box.left, box.top);\n    };\n    var firstDefinedOrZero = function (a, b) {\n      return a !== undefined ? a : b !== undefined ? b : 0;\n    };\n    var absolute = function (element) {\n      var doc = element.dom().ownerDocument;\n      var body = doc.body;\n      var win = doc.defaultView;\n      var html = doc.documentElement;\n      if (body === element.dom()) {\n        return Position(body.offsetLeft, body.offsetTop);\n      }\n      var scrollTop = firstDefinedOrZero(win.pageYOffset, html.scrollTop);\n      var scrollLeft = firstDefinedOrZero(win.pageXOffset, html.scrollLeft);\n      var clientTop = firstDefinedOrZero(html.clientTop, body.clientTop);\n      var clientLeft = firstDefinedOrZero(html.clientLeft, body.clientLeft);\n      return viewport(element).translate(scrollLeft - clientLeft, scrollTop - clientTop);\n    };\n    var viewport = function (element) {\n      var dom = element.dom();\n      var doc = dom.ownerDocument;\n      var body = doc.body;\n      if (body === dom) {\n        return Position(body.offsetLeft, body.offsetTop);\n      }\n      if (!inBody(element)) {\n        return Position(0, 0);\n      }\n      return boxPosition(dom);\n    };\n\n    var isSafari = detect$3().browser.isSafari();\n    var get$1 = function (_DOC) {\n      var doc = _DOC !== undefined ? _DOC.dom() : domGlobals.document;\n      var x = doc.body.scrollLeft || doc.documentElement.scrollLeft;\n      var y = doc.body.scrollTop || doc.documentElement.scrollTop;\n      return Position(x, y);\n    };\n    var to = function (x, y, _DOC) {\n      var doc = _DOC !== undefined ? _DOC.dom() : domGlobals.document;\n      var win = doc.defaultView;\n      win.scrollTo(x, y);\n    };\n    var intoView = function (element, alignToTop) {\n      if (isSafari && isFunction(element.dom().scrollIntoViewIfNeeded)) {\n        element.dom().scrollIntoViewIfNeeded(false);\n      } else {\n        element.dom().scrollIntoView(alignToTop);\n      }\n    };\n\n    var get$2 = function (_win) {\n      var win = _win === undefined ? domGlobals.window : _win;\n      return Option.from(win['visualViewport']);\n    };\n    var bounds = function (x, y, width, height) {\n      return {\n        x: constant(x),\n        y: constant(y),\n        width: constant(width),\n        height: constant(height),\n        right: constant(x + width),\n        bottom: constant(y + height)\n      };\n    };\n    var getBounds = function (_win) {\n      var win = _win === undefined ? domGlobals.window : _win;\n      var doc = win.document;\n      var scroll = get$1(Element.fromDom(doc));\n      return get$2(win).fold(function () {\n        var html = win.document.documentElement;\n        var width = html.clientWidth;\n        var height = html.clientHeight;\n        return bounds(scroll.left(), scroll.top(), width, height);\n      }, function (visualViewport) {\n        return bounds(Math.max(visualViewport.pageLeft, scroll.left()), Math.max(visualViewport.pageTop, scroll.top()), visualViewport.width, visualViewport.height);\n      });\n    };\n\n    var isNodeType = function (type) {\n      return function (node) {\n        return !!node && node.nodeType === type;\n      };\n    };\n    var isRestrictedNode = function (node) {\n      return !!node && !Object.getPrototypeOf(node);\n    };\n    var isElement$1 = isNodeType(1);\n    var matchNodeNames = function (names) {\n      var lowercasedNames = names.map(function (s) {\n        return s.toLowerCase();\n      });\n      return function (node) {\n        if (node && node.nodeName) {\n          var nodeName = node.nodeName.toLowerCase();\n          return contains(lowercasedNames, nodeName);\n        }\n        return false;\n      };\n    };\n    var matchStyleValues = function (name, values) {\n      var items = values.toLowerCase().split(' ');\n      return function (node) {\n        var i, cssValue;\n        if (isElement$1(node)) {\n          for (i = 0; i < items.length; i++) {\n            var computed = node.ownerDocument.defaultView.getComputedStyle(node, null);\n            cssValue = computed ? computed.getPropertyValue(name) : null;\n            if (cssValue === items[i]) {\n              return true;\n            }\n          }\n        }\n        return false;\n      };\n    };\n    var hasPropValue = function (propName, propValue) {\n      return function (node) {\n        return isElement$1(node) && node[propName] === propValue;\n      };\n    };\n    var hasAttribute = function (attrName, attrValue) {\n      return function (node) {\n        return isElement$1(node) && node.hasAttribute(attrName);\n      };\n    };\n    var hasAttributeValue = function (attrName, attrValue) {\n      return function (node) {\n        return isElement$1(node) && node.getAttribute(attrName) === attrValue;\n      };\n    };\n    var isBogus = function (node) {\n      return isElement$1(node) && node.hasAttribute('data-mce-bogus');\n    };\n    var isBogusAll = function (node) {\n      return isElement$1(node) && node.getAttribute('data-mce-bogus') === 'all';\n    };\n    var isTable = function (node) {\n      return isElement$1(node) && node.tagName === 'TABLE';\n    };\n    var hasContentEditableState = function (value) {\n      return function (node) {\n        if (isElement$1(node)) {\n          if (node.contentEditable === value) {\n            return true;\n          }\n          if (node.getAttribute('data-mce-contenteditable') === value) {\n            return true;\n          }\n        }\n        return false;\n      };\n    };\n    var isTextareaOrInput = matchNodeNames([\n      'textarea',\n      'input'\n    ]);\n    var isText$1 = isNodeType(3);\n    var isComment = isNodeType(8);\n    var isDocument = isNodeType(9);\n    var isDocumentFragment = isNodeType(11);\n    var isBr = matchNodeNames(['br']);\n    var isContentEditableTrue = hasContentEditableState('true');\n    var isContentEditableFalse = hasContentEditableState('false');\n    var NodeType = {\n      isText: isText$1,\n      isElement: isElement$1,\n      isComment: isComment,\n      isDocument: isDocument,\n      isDocumentFragment: isDocumentFragment,\n      isBr: isBr,\n      isContentEditableTrue: isContentEditableTrue,\n      isContentEditableFalse: isContentEditableFalse,\n      isRestrictedNode: isRestrictedNode,\n      matchNodeNames: matchNodeNames,\n      hasPropValue: hasPropValue,\n      hasAttribute: hasAttribute,\n      hasAttributeValue: hasAttributeValue,\n      matchStyleValues: matchStyleValues,\n      isBogus: isBogus,\n      isBogusAll: isBogusAll,\n      isTable: isTable,\n      isTextareaOrInput: isTextareaOrInput\n    };\n\n    var isSupported = function (dom) {\n      return dom.style !== undefined && isFunction(dom.style.getPropertyValue);\n    };\n\n    var rawSet = function (dom, key, value) {\n      if (isString(value) || isBoolean(value) || isNumber(value)) {\n        dom.setAttribute(key, value + '');\n      } else {\n        domGlobals.console.error('Invalid call to Attr.set. Key ', key, ':: Value ', value, ':: Element ', dom);\n        throw new Error('Attribute value was not simple');\n      }\n    };\n    var set = function (element, key, value) {\n      rawSet(element.dom(), key, value);\n    };\n    var setAll = function (element, attrs) {\n      var dom = element.dom();\n      each$1(attrs, function (v, k) {\n        rawSet(dom, k, v);\n      });\n    };\n    var get$3 = function (element, key) {\n      var v = element.dom().getAttribute(key);\n      return v === null ? undefined : v;\n    };\n    var getOpt = function (element, key) {\n      return Option.from(get$3(element, key));\n    };\n    var has$1 = function (element, key) {\n      var dom = element.dom();\n      return dom && dom.hasAttribute ? dom.hasAttribute(key) : false;\n    };\n    var remove$1 = function (element, key) {\n      element.dom().removeAttribute(key);\n    };\n\n    var get$4 = function (element, property) {\n      var dom = element.dom();\n      var styles = domGlobals.window.getComputedStyle(dom);\n      var r = styles.getPropertyValue(property);\n      var v = r === '' && !inBody(element) ? getUnsafeProperty(dom, property) : r;\n      return v === null ? undefined : v;\n    };\n    var getUnsafeProperty = function (dom, property) {\n      return isSupported(dom) ? dom.style.getPropertyValue(property) : '';\n    };\n    var getRaw = function (element, property) {\n      var dom = element.dom();\n      var raw = getUnsafeProperty(dom, property);\n      return Option.from(raw).filter(function (r) {\n        return r.length > 0;\n      });\n    };\n    var reflow = function (e) {\n      return e.dom().offsetWidth;\n    };\n\n    var browser$1 = detect$3().browser;\n    var firstElement = function (nodes) {\n      return find(nodes, isElement);\n    };\n    var getTableCaptionDeltaY = function (elm) {\n      if (browser$1.isFirefox() && name(elm) === 'table') {\n        return firstElement(children(elm)).filter(function (elm) {\n          return name(elm) === 'caption';\n        }).bind(function (caption) {\n          return firstElement(nextSiblings(caption)).map(function (body) {\n            var bodyTop = body.dom().offsetTop;\n            var captionTop = caption.dom().offsetTop;\n            var captionHeight = caption.dom().offsetHeight;\n            return bodyTop <= captionTop ? -captionHeight : 0;\n          });\n        }).getOr(0);\n      } else {\n        return 0;\n      }\n    };\n    var hasChild = function (elm, child) {\n      return elm.children && contains(elm.children, child);\n    };\n    var getPos = function (body, elm, rootElm) {\n      var x = 0, y = 0, offsetParent;\n      var doc = body.ownerDocument;\n      var pos;\n      rootElm = rootElm ? rootElm : body;\n      if (elm) {\n        if (rootElm === body && elm.getBoundingClientRect && get$4(Element.fromDom(body), 'position') === 'static') {\n          pos = elm.getBoundingClientRect();\n          x = pos.left + (doc.documentElement.scrollLeft || body.scrollLeft) - doc.documentElement.clientLeft;\n          y = pos.top + (doc.documentElement.scrollTop || body.scrollTop) - doc.documentElement.clientTop;\n          return {\n            x: x,\n            y: y\n          };\n        }\n        offsetParent = elm;\n        while (offsetParent && offsetParent !== rootElm && offsetParent.nodeType && !hasChild(offsetParent, rootElm)) {\n          x += offsetParent.offsetLeft || 0;\n          y += offsetParent.offsetTop || 0;\n          offsetParent = offsetParent.offsetParent;\n        }\n        offsetParent = elm.parentNode;\n        while (offsetParent && offsetParent !== rootElm && offsetParent.nodeType && !hasChild(offsetParent, rootElm)) {\n          x -= offsetParent.scrollLeft || 0;\n          y -= offsetParent.scrollTop || 0;\n          offsetParent = offsetParent.parentNode;\n        }\n        y += getTableCaptionDeltaY(Element.fromDom(elm));\n      }\n      return {\n        x: x,\n        y: y\n      };\n    };\n    var Position$1 = { getPos: getPos };\n\n    var exports$1 = {}, module$1 = { exports: exports$1 };\n    (function (define, exports, module, require) {\n      (function (f) {\n        if (typeof exports === 'object' && typeof module !== 'undefined') {\n          module.exports = f();\n        } else if (typeof define === 'function' && define.amd) {\n          define([], f);\n        } else {\n          var g;\n          if (typeof window !== 'undefined') {\n            g = window;\n          } else if (typeof global !== 'undefined') {\n            g = global;\n          } else if (typeof self !== 'undefined') {\n            g = self;\n          } else {\n            g = this;\n          }\n          g.EphoxContactWrapper = f();\n        }\n      }(function () {\n        return function () {\n          function r(e, n, t) {\n            function o(i, f) {\n              if (!n[i]) {\n                if (!e[i]) {\n                  var c = 'function' == typeof require && require;\n                  if (!f && c)\n                    return c(i, !0);\n                  if (u)\n                    return u(i, !0);\n                  var a = new Error('Cannot find module \\'' + i + '\\'');\n                  throw a.code = 'MODULE_NOT_FOUND', a;\n                }\n                var p = n[i] = { exports: {} };\n                e[i][0].call(p.exports, function (r) {\n                  var n = e[i][1][r];\n                  return o(n || r);\n                }, p, p.exports, r, e, n, t);\n              }\n              return n[i].exports;\n            }\n            for (var u = 'function' == typeof require && require, i = 0; i < t.length; i++)\n              o(t[i]);\n            return o;\n          }\n          return r;\n        }()({\n          1: [\n            function (require, module, exports) {\n              var process = module.exports = {};\n              var cachedSetTimeout;\n              var cachedClearTimeout;\n              function defaultSetTimout() {\n                throw new Error('setTimeout has not been defined');\n              }\n              function defaultClearTimeout() {\n                throw new Error('clearTimeout has not been defined');\n              }\n              (function () {\n                try {\n                  if (typeof setTimeout === 'function') {\n                    cachedSetTimeout = setTimeout;\n                  } else {\n                    cachedSetTimeout = defaultSetTimout;\n                  }\n                } catch (e) {\n                  cachedSetTimeout = defaultSetTimout;\n                }\n                try {\n                  if (typeof clearTimeout === 'function') {\n                    cachedClearTimeout = clearTimeout;\n                  } else {\n                    cachedClearTimeout = defaultClearTimeout;\n                  }\n                } catch (e) {\n                  cachedClearTimeout = defaultClearTimeout;\n                }\n              }());\n              function runTimeout(fun) {\n                if (cachedSetTimeout === setTimeout) {\n                  return setTimeout(fun, 0);\n                }\n                if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n                  cachedSetTimeout = setTimeout;\n                  return setTimeout(fun, 0);\n                }\n                try {\n                  return cachedSetTimeout(fun, 0);\n                } catch (e) {\n                  try {\n                    return cachedSetTimeout.call(null, fun, 0);\n                  } catch (e) {\n                    return cachedSetTimeout.call(this, fun, 0);\n                  }\n                }\n              }\n              function runClearTimeout(marker) {\n                if (cachedClearTimeout === clearTimeout) {\n                  return clearTimeout(marker);\n                }\n                if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n                  cachedClearTimeout = clearTimeout;\n                  return clearTimeout(marker);\n                }\n                try {\n                  return cachedClearTimeout(marker);\n                } catch (e) {\n                  try {\n                    return cachedClearTimeout.call(null, marker);\n                  } catch (e) {\n                    return cachedClearTimeout.call(this, marker);\n                  }\n                }\n              }\n              var queue = [];\n              var draining = false;\n              var currentQueue;\n              var queueIndex = -1;\n              function cleanUpNextTick() {\n                if (!draining || !currentQueue) {\n                  return;\n                }\n                draining = false;\n                if (currentQueue.length) {\n                  queue = currentQueue.concat(queue);\n                } else {\n                  queueIndex = -1;\n                }\n                if (queue.length) {\n                  drainQueue();\n                }\n              }\n              function drainQueue() {\n                if (draining) {\n                  return;\n                }\n                var timeout = runTimeout(cleanUpNextTick);\n                draining = true;\n                var len = queue.length;\n                while (len) {\n                  currentQueue = queue;\n                  queue = [];\n                  while (++queueIndex < len) {\n                    if (currentQueue) {\n                      currentQueue[queueIndex].run();\n                    }\n                  }\n                  queueIndex = -1;\n                  len = queue.length;\n                }\n                currentQueue = null;\n                draining = false;\n                runClearTimeout(timeout);\n              }\n              process.nextTick = function (fun) {\n                var args = new Array(arguments.length - 1);\n                if (arguments.length > 1) {\n                  for (var i = 1; i < arguments.length; i++) {\n                    args[i - 1] = arguments[i];\n                  }\n                }\n                queue.push(new Item(fun, args));\n                if (queue.length === 1 && !draining) {\n                  runTimeout(drainQueue);\n                }\n              };\n              function Item(fun, array) {\n                this.fun = fun;\n                this.array = array;\n              }\n              Item.prototype.run = function () {\n                this.fun.apply(null, this.array);\n              };\n              process.title = 'browser';\n              process.browser = true;\n              process.env = {};\n              process.argv = [];\n              process.version = '';\n              process.versions = {};\n              function noop() {\n              }\n              process.on = noop;\n              process.addListener = noop;\n              process.once = noop;\n              process.off = noop;\n              process.removeListener = noop;\n              process.removeAllListeners = noop;\n              process.emit = noop;\n              process.prependListener = noop;\n              process.prependOnceListener = noop;\n              process.listeners = function (name) {\n                return [];\n              };\n              process.binding = function (name) {\n                throw new Error('process.binding is not supported');\n              };\n              process.cwd = function () {\n                return '/';\n              };\n              process.chdir = function (dir) {\n                throw new Error('process.chdir is not supported');\n              };\n              process.umask = function () {\n                return 0;\n              };\n            },\n            {}\n          ],\n          2: [\n            function (require, module, exports) {\n              (function (setImmediate) {\n                (function (root) {\n                  var setTimeoutFunc = setTimeout;\n                  function noop() {\n                  }\n                  function bind(fn, thisArg) {\n                    return function () {\n                      fn.apply(thisArg, arguments);\n                    };\n                  }\n                  function Promise(fn) {\n                    if (typeof this !== 'object')\n                      throw new TypeError('Promises must be constructed via new');\n                    if (typeof fn !== 'function')\n                      throw new TypeError('not a function');\n                    this._state = 0;\n                    this._handled = false;\n                    this._value = undefined;\n                    this._deferreds = [];\n                    doResolve(fn, this);\n                  }\n                  function handle(self, deferred) {\n                    while (self._state === 3) {\n                      self = self._value;\n                    }\n                    if (self._state === 0) {\n                      self._deferreds.push(deferred);\n                      return;\n                    }\n                    self._handled = true;\n                    Promise._immediateFn(function () {\n                      var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n                      if (cb === null) {\n                        (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n                        return;\n                      }\n                      var ret;\n                      try {\n                        ret = cb(self._value);\n                      } catch (e) {\n                        reject(deferred.promise, e);\n                        return;\n                      }\n                      resolve(deferred.promise, ret);\n                    });\n                  }\n                  function resolve(self, newValue) {\n                    try {\n                      if (newValue === self)\n                        throw new TypeError('A promise cannot be resolved with itself.');\n                      if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n                        var then = newValue.then;\n                        if (newValue instanceof Promise) {\n                          self._state = 3;\n                          self._value = newValue;\n                          finale(self);\n                          return;\n                        } else if (typeof then === 'function') {\n                          doResolve(bind(then, newValue), self);\n                          return;\n                        }\n                      }\n                      self._state = 1;\n                      self._value = newValue;\n                      finale(self);\n                    } catch (e) {\n                      reject(self, e);\n                    }\n                  }\n                  function reject(self, newValue) {\n                    self._state = 2;\n                    self._value = newValue;\n                    finale(self);\n                  }\n                  function finale(self) {\n                    if (self._state === 2 && self._deferreds.length === 0) {\n                      Promise._immediateFn(function () {\n                        if (!self._handled) {\n                          Promise._unhandledRejectionFn(self._value);\n                        }\n                      });\n                    }\n                    for (var i = 0, len = self._deferreds.length; i < len; i++) {\n                      handle(self, self._deferreds[i]);\n                    }\n                    self._deferreds = null;\n                  }\n                  function Handler(onFulfilled, onRejected, promise) {\n                    this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n                    this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n                    this.promise = promise;\n                  }\n                  function doResolve(fn, self) {\n                    var done = false;\n                    try {\n                      fn(function (value) {\n                        if (done)\n                          return;\n                        done = true;\n                        resolve(self, value);\n                      }, function (reason) {\n                        if (done)\n                          return;\n                        done = true;\n                        reject(self, reason);\n                      });\n                    } catch (ex) {\n                      if (done)\n                        return;\n                      done = true;\n                      reject(self, ex);\n                    }\n                  }\n                  Promise.prototype['catch'] = function (onRejected) {\n                    return this.then(null, onRejected);\n                  };\n                  Promise.prototype.then = function (onFulfilled, onRejected) {\n                    var prom = new this.constructor(noop);\n                    handle(this, new Handler(onFulfilled, onRejected, prom));\n                    return prom;\n                  };\n                  Promise.all = function (arr) {\n                    var args = Array.prototype.slice.call(arr);\n                    return new Promise(function (resolve, reject) {\n                      if (args.length === 0)\n                        return resolve([]);\n                      var remaining = args.length;\n                      function res(i, val) {\n                        try {\n                          if (val && (typeof val === 'object' || typeof val === 'function')) {\n                            var then = val.then;\n                            if (typeof then === 'function') {\n                              then.call(val, function (val) {\n                                res(i, val);\n                              }, reject);\n                              return;\n                            }\n                          }\n                          args[i] = val;\n                          if (--remaining === 0) {\n                            resolve(args);\n                          }\n                        } catch (ex) {\n                          reject(ex);\n                        }\n                      }\n                      for (var i = 0; i < args.length; i++) {\n                        res(i, args[i]);\n                      }\n                    });\n                  };\n                  Promise.resolve = function (value) {\n                    if (value && typeof value === 'object' && value.constructor === Promise) {\n                      return value;\n                    }\n                    return new Promise(function (resolve) {\n                      resolve(value);\n                    });\n                  };\n                  Promise.reject = function (value) {\n                    return new Promise(function (resolve, reject) {\n                      reject(value);\n                    });\n                  };\n                  Promise.race = function (values) {\n                    return new Promise(function (resolve, reject) {\n                      for (var i = 0, len = values.length; i < len; i++) {\n                        values[i].then(resolve, reject);\n                      }\n                    });\n                  };\n                  Promise._immediateFn = typeof setImmediate === 'function' ? function (fn) {\n                    setImmediate(fn);\n                  } : function (fn) {\n                    setTimeoutFunc(fn, 0);\n                  };\n                  Promise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n                    if (typeof console !== 'undefined' && console) {\n                      console.warn('Possible Unhandled Promise Rejection:', err);\n                    }\n                  };\n                  Promise._setImmediateFn = function _setImmediateFn(fn) {\n                    Promise._immediateFn = fn;\n                  };\n                  Promise._setUnhandledRejectionFn = function _setUnhandledRejectionFn(fn) {\n                    Promise._unhandledRejectionFn = fn;\n                  };\n                  if (typeof module !== 'undefined' && module.exports) {\n                    module.exports = Promise;\n                  } else if (!root.Promise) {\n                    root.Promise = Promise;\n                  }\n                }(this));\n              }.call(this, require('timers').setImmediate));\n            },\n            { 'timers': 3 }\n          ],\n          3: [\n            function (require, module, exports) {\n              (function (setImmediate, clearImmediate) {\n                var nextTick = require('process/browser.js').nextTick;\n                var apply = Function.prototype.apply;\n                var slice = Array.prototype.slice;\n                var immediateIds = {};\n                var nextImmediateId = 0;\n                exports.setTimeout = function () {\n                  return new Timeout(apply.call(setTimeout, window, arguments), clearTimeout);\n                };\n                exports.setInterval = function () {\n                  return new Timeout(apply.call(setInterval, window, arguments), clearInterval);\n                };\n                exports.clearTimeout = exports.clearInterval = function (timeout) {\n                  timeout.close();\n                };\n                function Timeout(id, clearFn) {\n                  this._id = id;\n                  this._clearFn = clearFn;\n                }\n                Timeout.prototype.unref = Timeout.prototype.ref = function () {\n                };\n                Timeout.prototype.close = function () {\n                  this._clearFn.call(window, this._id);\n                };\n                exports.enroll = function (item, msecs) {\n                  clearTimeout(item._idleTimeoutId);\n                  item._idleTimeout = msecs;\n                };\n                exports.unenroll = function (item) {\n                  clearTimeout(item._idleTimeoutId);\n                  item._idleTimeout = -1;\n                };\n                exports._unrefActive = exports.active = function (item) {\n                  clearTimeout(item._idleTimeoutId);\n                  var msecs = item._idleTimeout;\n                  if (msecs >= 0) {\n                    item._idleTimeoutId = setTimeout(function onTimeout() {\n                      if (item._onTimeout)\n                        item._onTimeout();\n                    }, msecs);\n                  }\n                };\n                exports.setImmediate = typeof setImmediate === 'function' ? setImmediate : function (fn) {\n                  var id = nextImmediateId++;\n                  var args = arguments.length < 2 ? false : slice.call(arguments, 1);\n                  immediateIds[id] = true;\n                  nextTick(function onNextTick() {\n                    if (immediateIds[id]) {\n                      if (args) {\n                        fn.apply(null, args);\n                      } else {\n                        fn.call(null);\n                      }\n                      exports.clearImmediate(id);\n                    }\n                  });\n                  return id;\n                };\n                exports.clearImmediate = typeof clearImmediate === 'function' ? clearImmediate : function (id) {\n                  delete immediateIds[id];\n                };\n              }.call(this, require('timers').setImmediate, require('timers').clearImmediate));\n            },\n            {\n              'process/browser.js': 1,\n              'timers': 3\n            }\n          ],\n          4: [\n            function (require, module, exports) {\n              var promisePolyfill = require('promise-polyfill');\n              var Global = function () {\n                if (typeof window !== 'undefined') {\n                  return window;\n                } else {\n                  return Function('return this;')();\n                }\n              }();\n              module.exports = { boltExport: Global.Promise || promisePolyfill };\n            },\n            { 'promise-polyfill': 2 }\n          ]\n        }, {}, [4])(4);\n      }));\n    }(undefined, exports$1, module$1, undefined));\n    var Promise = module$1.exports.boltExport;\n\n    var nu$3 = function (baseFn) {\n      var data = Option.none();\n      var callbacks = [];\n      var map = function (f) {\n        return nu$3(function (nCallback) {\n          get(function (data) {\n            nCallback(f(data));\n          });\n        });\n      };\n      var get = function (nCallback) {\n        if (isReady()) {\n          call(nCallback);\n        } else {\n          callbacks.push(nCallback);\n        }\n      };\n      var set = function (x) {\n        data = Option.some(x);\n        run(callbacks);\n        callbacks = [];\n      };\n      var isReady = function () {\n        return data.isSome();\n      };\n      var run = function (cbs) {\n        each(cbs, call);\n      };\n      var call = function (cb) {\n        data.each(function (x) {\n          domGlobals.setTimeout(function () {\n            cb(x);\n          }, 0);\n        });\n      };\n      baseFn(set);\n      return {\n        get: get,\n        map: map,\n        isReady: isReady\n      };\n    };\n    var pure = function (a) {\n      return nu$3(function (callback) {\n        callback(a);\n      });\n    };\n    var LazyValue = {\n      nu: nu$3,\n      pure: pure\n    };\n\n    var errorReporter = function (err) {\n      domGlobals.setTimeout(function () {\n        throw err;\n      }, 0);\n    };\n    var make = function (run) {\n      var get = function (callback) {\n        run().then(callback, errorReporter);\n      };\n      var map = function (fab) {\n        return make(function () {\n          return run().then(fab);\n        });\n      };\n      var bind = function (aFutureB) {\n        return make(function () {\n          return run().then(function (v) {\n            return aFutureB(v).toPromise();\n          });\n        });\n      };\n      var anonBind = function (futureB) {\n        return make(function () {\n          return run().then(function () {\n            return futureB.toPromise();\n          });\n        });\n      };\n      var toLazy = function () {\n        return LazyValue.nu(get);\n      };\n      var toCached = function () {\n        var cache = null;\n        return make(function () {\n          if (cache === null) {\n            cache = run();\n          }\n          return cache;\n        });\n      };\n      var toPromise = run;\n      return {\n        map: map,\n        bind: bind,\n        anonBind: anonBind,\n        toLazy: toLazy,\n        toCached: toCached,\n        toPromise: toPromise,\n        get: get\n      };\n    };\n    var nu$4 = function (baseFn) {\n      return make(function () {\n        return new Promise(baseFn);\n      });\n    };\n    var pure$1 = function (a) {\n      return make(function () {\n        return Promise.resolve(a);\n      });\n    };\n    var Future = {\n      nu: nu$4,\n      pure: pure$1\n    };\n\n    var par = function (asyncValues, nu) {\n      return nu(function (callback) {\n        var r = [];\n        var count = 0;\n        var cb = function (i) {\n          return function (value) {\n            r[i] = value;\n            count++;\n            if (count >= asyncValues.length) {\n              callback(r);\n            }\n          };\n        };\n        if (asyncValues.length === 0) {\n          callback([]);\n        } else {\n          each(asyncValues, function (asyncValue, i) {\n            asyncValue.get(cb(i));\n          });\n        }\n      });\n    };\n\n    var par$1 = function (futures) {\n      return par(futures, Future.nu);\n    };\n\n    var value = function (o) {\n      var is = function (v) {\n        return o === v;\n      };\n      var or = function (opt) {\n        return value(o);\n      };\n      var orThunk = function (f) {\n        return value(o);\n      };\n      var map = function (f) {\n        return value(f(o));\n      };\n      var mapError = function (f) {\n        return value(o);\n      };\n      var each = function (f) {\n        f(o);\n      };\n      var bind = function (f) {\n        return f(o);\n      };\n      var fold = function (_, onValue) {\n        return onValue(o);\n      };\n      var exists = function (f) {\n        return f(o);\n      };\n      var forall = function (f) {\n        return f(o);\n      };\n      var toOption = function () {\n        return Option.some(o);\n      };\n      return {\n        is: is,\n        isValue: always,\n        isError: never,\n        getOr: constant(o),\n        getOrThunk: constant(o),\n        getOrDie: constant(o),\n        or: or,\n        orThunk: orThunk,\n        fold: fold,\n        map: map,\n        mapError: mapError,\n        each: each,\n        bind: bind,\n        exists: exists,\n        forall: forall,\n        toOption: toOption\n      };\n    };\n    var error = function (message) {\n      var getOrThunk = function (f) {\n        return f();\n      };\n      var getOrDie = function () {\n        return die(String(message))();\n      };\n      var or = function (opt) {\n        return opt;\n      };\n      var orThunk = function (f) {\n        return f();\n      };\n      var map = function (f) {\n        return error(message);\n      };\n      var mapError = function (f) {\n        return error(f(message));\n      };\n      var bind = function (f) {\n        return error(message);\n      };\n      var fold = function (onError, _) {\n        return onError(message);\n      };\n      return {\n        is: never,\n        isValue: never,\n        isError: always,\n        getOr: identity,\n        getOrThunk: getOrThunk,\n        getOrDie: getOrDie,\n        or: or,\n        orThunk: orThunk,\n        fold: fold,\n        map: map,\n        mapError: mapError,\n        each: noop,\n        bind: bind,\n        exists: never,\n        forall: always,\n        toOption: Option.none\n      };\n    };\n    var fromOption = function (opt, err) {\n      return opt.fold(function () {\n        return error(err);\n      }, value);\n    };\n    var Result = {\n      value: value,\n      error: error,\n      fromOption: fromOption\n    };\n\n    var promise = function () {\n      function bind(fn, thisArg) {\n        return function () {\n          fn.apply(thisArg, arguments);\n        };\n      }\n      var isArray = Array.isArray || function (value) {\n        return Object.prototype.toString.call(value) === '[object Array]';\n      };\n      var Promise = function (fn) {\n        if (typeof this !== 'object') {\n          throw new TypeError('Promises must be constructed via new');\n        }\n        if (typeof fn !== 'function') {\n          throw new TypeError('not a function');\n        }\n        this._state = null;\n        this._value = null;\n        this._deferreds = [];\n        doResolve(fn, bind(resolve, this), bind(reject, this));\n      };\n      var asap = Promise.immediateFn || typeof domGlobals.setImmediate === 'function' && domGlobals.setImmediate || function (fn) {\n        domGlobals.setTimeout(fn, 1);\n      };\n      function handle(deferred) {\n        var me = this;\n        if (this._state === null) {\n          this._deferreds.push(deferred);\n          return;\n        }\n        asap(function () {\n          var cb = me._state ? deferred.onFulfilled : deferred.onRejected;\n          if (cb === null) {\n            (me._state ? deferred.resolve : deferred.reject)(me._value);\n            return;\n          }\n          var ret;\n          try {\n            ret = cb(me._value);\n          } catch (e) {\n            deferred.reject(e);\n            return;\n          }\n          deferred.resolve(ret);\n        });\n      }\n      function resolve(newValue) {\n        try {\n          if (newValue === this) {\n            throw new TypeError('A promise cannot be resolved with itself.');\n          }\n          if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n            var then = newValue.then;\n            if (typeof then === 'function') {\n              doResolve(bind(then, newValue), bind(resolve, this), bind(reject, this));\n              return;\n            }\n          }\n          this._state = true;\n          this._value = newValue;\n          finale.call(this);\n        } catch (e) {\n          reject.call(this, e);\n        }\n      }\n      function reject(newValue) {\n        this._state = false;\n        this._value = newValue;\n        finale.call(this);\n      }\n      function finale() {\n        for (var i = 0, len = this._deferreds.length; i < len; i++) {\n          handle.call(this, this._deferreds[i]);\n        }\n        this._deferreds = null;\n      }\n      function Handler(onFulfilled, onRejected, resolve, reject) {\n        this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n        this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n        this.resolve = resolve;\n        this.reject = reject;\n      }\n      function doResolve(fn, onFulfilled, onRejected) {\n        var done = false;\n        try {\n          fn(function (value) {\n            if (done) {\n              return;\n            }\n            done = true;\n            onFulfilled(value);\n          }, function (reason) {\n            if (done) {\n              return;\n            }\n            done = true;\n            onRejected(reason);\n          });\n        } catch (ex) {\n          if (done) {\n            return;\n          }\n          done = true;\n          onRejected(ex);\n        }\n      }\n      Promise.prototype.catch = function (onRejected) {\n        return this.then(null, onRejected);\n      };\n      Promise.prototype.then = function (onFulfilled, onRejected) {\n        var me = this;\n        return new Promise(function (resolve, reject) {\n          handle.call(me, new Handler(onFulfilled, onRejected, resolve, reject));\n        });\n      };\n      Promise.all = function () {\n        var args = Array.prototype.slice.call(arguments.length === 1 && isArray(arguments[0]) ? arguments[0] : arguments);\n        return new Promise(function (resolve, reject) {\n          if (args.length === 0) {\n            return resolve([]);\n          }\n          var remaining = args.length;\n          function res(i, val) {\n            try {\n              if (val && (typeof val === 'object' || typeof val === 'function')) {\n                var then = val.then;\n                if (typeof then === 'function') {\n                  then.call(val, function (val) {\n                    res(i, val);\n                  }, reject);\n                  return;\n                }\n              }\n              args[i] = val;\n              if (--remaining === 0) {\n                resolve(args);\n              }\n            } catch (ex) {\n              reject(ex);\n            }\n          }\n          for (var i = 0; i < args.length; i++) {\n            res(i, args[i]);\n          }\n        });\n      };\n      Promise.resolve = function (value) {\n        if (value && typeof value === 'object' && value.constructor === Promise) {\n          return value;\n        }\n        return new Promise(function (resolve) {\n          resolve(value);\n        });\n      };\n      Promise.reject = function (value) {\n        return new Promise(function (resolve, reject) {\n          reject(value);\n        });\n      };\n      Promise.race = function (values) {\n        return new Promise(function (resolve, reject) {\n          for (var i = 0, len = values.length; i < len; i++) {\n            values[i].then(resolve, reject);\n          }\n        });\n      };\n      return Promise;\n    };\n    var promiseObj = window.Promise ? window.Promise : promise();\n\n    var requestAnimationFramePromise;\n    var requestAnimationFrame = function (callback, element) {\n      var i, requestAnimationFrameFunc = domGlobals.window.requestAnimationFrame;\n      var vendors = [\n        'ms',\n        'moz',\n        'webkit'\n      ];\n      var featurefill = function (callback) {\n        domGlobals.window.setTimeout(callback, 0);\n      };\n      for (i = 0; i < vendors.length && !requestAnimationFrameFunc; i++) {\n        requestAnimationFrameFunc = domGlobals.window[vendors[i] + 'RequestAnimationFrame'];\n      }\n      if (!requestAnimationFrameFunc) {\n        requestAnimationFrameFunc = featurefill;\n      }\n      requestAnimationFrameFunc(callback, element);\n    };\n    var wrappedSetTimeout = function (callback, time) {\n      if (typeof time !== 'number') {\n        time = 0;\n      }\n      return domGlobals.setTimeout(callback, time);\n    };\n    var wrappedSetInterval = function (callback, time) {\n      if (typeof time !== 'number') {\n        time = 1;\n      }\n      return domGlobals.setInterval(callback, time);\n    };\n    var wrappedClearTimeout = function (id) {\n      return domGlobals.clearTimeout(id);\n    };\n    var wrappedClearInterval = function (id) {\n      return domGlobals.clearInterval(id);\n    };\n    var debounce = function (callback, time) {\n      var timer, func;\n      func = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        domGlobals.clearTimeout(timer);\n        timer = wrappedSetTimeout(function () {\n          callback.apply(this, args);\n        }, time);\n      };\n      func.stop = function () {\n        domGlobals.clearTimeout(timer);\n      };\n      return func;\n    };\n    var Delay = {\n      requestAnimationFrame: function (callback, element) {\n        if (requestAnimationFramePromise) {\n          requestAnimationFramePromise.then(callback);\n          return;\n        }\n        requestAnimationFramePromise = new promiseObj(function (resolve) {\n          if (!element) {\n            element = domGlobals.document.body;\n          }\n          requestAnimationFrame(resolve, element);\n        }).then(callback);\n      },\n      setTimeout: wrappedSetTimeout,\n      setInterval: wrappedSetInterval,\n      setEditorTimeout: function (editor, callback, time) {\n        return wrappedSetTimeout(function () {\n          if (!editor.removed) {\n            callback();\n          }\n        }, time);\n      },\n      setEditorInterval: function (editor, callback, time) {\n        var timer;\n        timer = wrappedSetInterval(function () {\n          if (!editor.removed) {\n            callback();\n          } else {\n            domGlobals.clearInterval(timer);\n          }\n        }, time);\n        return timer;\n      },\n      debounce: debounce,\n      throttle: debounce,\n      clearInterval: wrappedClearInterval,\n      clearTimeout: wrappedClearTimeout\n    };\n\n    var userAgent = domGlobals.navigator.userAgent;\n    var platform$1 = detect$3();\n    var browser$2 = platform$1.browser;\n    var os = platform$1.os;\n    var deviceType = platform$1.deviceType;\n    var webkit = /WebKit/.test(userAgent) && !browser$2.isEdge();\n    var fileApi = 'FormData' in domGlobals.window && 'FileReader' in domGlobals.window && 'URL' in domGlobals.window && !!domGlobals.URL.createObjectURL;\n    var windowsPhone = userAgent.indexOf('Windows Phone') !== -1;\n    var Env = {\n      opera: browser$2.isOpera(),\n      webkit: webkit,\n      ie: browser$2.isIE() || browser$2.isEdge() ? browser$2.version.major : false,\n      gecko: browser$2.isFirefox(),\n      mac: os.isOSX() || os.isiOS(),\n      iOS: deviceType.isiPad() || deviceType.isiPhone(),\n      android: os.isAndroid(),\n      contentEditable: true,\n      transparentSrc: 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7',\n      caretAfter: true,\n      range: domGlobals.window.getSelection && 'Range' in domGlobals.window,\n      documentMode: browser$2.isIE() ? domGlobals.document.documentMode || 7 : 10,\n      fileApi: fileApi,\n      ceFalse: true,\n      cacheSuffix: null,\n      container: null,\n      experimentalShadowDom: false,\n      canHaveCSP: !browser$2.isIE(),\n      desktop: deviceType.isDesktop(),\n      windowsPhone: windowsPhone,\n      browser: {\n        current: browser$2.current,\n        version: browser$2.version,\n        isChrome: browser$2.isChrome,\n        isEdge: browser$2.isEdge,\n        isFirefox: browser$2.isFirefox,\n        isIE: browser$2.isIE,\n        isOpera: browser$2.isOpera,\n        isSafari: browser$2.isSafari\n      },\n      os: {\n        current: os.current,\n        version: os.version,\n        isAndroid: os.isAndroid,\n        isChromeOS: os.isChromeOS,\n        isFreeBSD: os.isFreeBSD,\n        isiOS: os.isiOS,\n        isLinux: os.isLinux,\n        isOSX: os.isOSX,\n        isSolaris: os.isSolaris,\n        isWindows: os.isWindows\n      },\n      deviceType: {\n        isDesktop: deviceType.isDesktop,\n        isiPad: deviceType.isiPad,\n        isiPhone: deviceType.isiPhone,\n        isPhone: deviceType.isPhone,\n        isTablet: deviceType.isTablet,\n        isTouch: deviceType.isTouch,\n        isWebView: deviceType.isWebView\n      }\n    };\n\n    var isArray$1 = Array.isArray;\n    var toArray$1 = function (obj) {\n      var array = obj, i, l;\n      if (!isArray$1(obj)) {\n        array = [];\n        for (i = 0, l = obj.length; i < l; i++) {\n          array[i] = obj[i];\n        }\n      }\n      return array;\n    };\n    var each$2 = function (o, cb, s) {\n      var n, l;\n      if (!o) {\n        return 0;\n      }\n      s = s || o;\n      if (o.length !== undefined) {\n        for (n = 0, l = o.length; n < l; n++) {\n          if (cb.call(s, o[n], n, o) === false) {\n            return 0;\n          }\n        }\n      } else {\n        for (n in o) {\n          if (o.hasOwnProperty(n)) {\n            if (cb.call(s, o[n], n, o) === false) {\n              return 0;\n            }\n          }\n        }\n      }\n      return 1;\n    };\n    var map$2 = function (array, callback) {\n      var out = [];\n      each$2(array, function (item, index) {\n        out.push(callback(item, index, array));\n      });\n      return out;\n    };\n    var filter$1 = function (a, f) {\n      var o = [];\n      each$2(a, function (v, index) {\n        if (!f || f(v, index, a)) {\n          o.push(v);\n        }\n      });\n      return o;\n    };\n    var indexOf$1 = function (a, v) {\n      var i, l;\n      if (a) {\n        for (i = 0, l = a.length; i < l; i++) {\n          if (a[i] === v) {\n            return i;\n          }\n        }\n      }\n      return -1;\n    };\n    var reduce = function (collection, iteratee, accumulator, thisArg) {\n      var i = 0;\n      if (arguments.length < 3) {\n        accumulator = collection[0];\n      }\n      for (; i < collection.length; i++) {\n        accumulator = iteratee.call(thisArg, accumulator, collection[i], i);\n      }\n      return accumulator;\n    };\n    var findIndex$1 = function (array, predicate, thisArg) {\n      var i, l;\n      for (i = 0, l = array.length; i < l; i++) {\n        if (predicate.call(thisArg, array[i], i, array)) {\n          return i;\n        }\n      }\n      return -1;\n    };\n    var find$2 = function (array, predicate, thisArg) {\n      var idx = findIndex$1(array, predicate, thisArg);\n      if (idx !== -1) {\n        return array[idx];\n      }\n      return undefined;\n    };\n    var last$1 = function (collection) {\n      return collection[collection.length - 1];\n    };\n    var ArrUtils = {\n      isArray: isArray$1,\n      toArray: toArray$1,\n      each: each$2,\n      map: map$2,\n      filter: filter$1,\n      indexOf: indexOf$1,\n      reduce: reduce,\n      findIndex: findIndex$1,\n      find: find$2,\n      last: last$1\n    };\n\n    var whiteSpaceRegExp = /^\\s*|\\s*$/g;\n    var trim$1 = function (str) {\n      return str === null || str === undefined ? '' : ('' + str).replace(whiteSpaceRegExp, '');\n    };\n    var is$1 = function (obj, type) {\n      if (!type) {\n        return obj !== undefined;\n      }\n      if (type === 'array' && ArrUtils.isArray(obj)) {\n        return true;\n      }\n      return typeof obj === type;\n    };\n    var makeMap = function (items, delim, map) {\n      var i;\n      items = items || [];\n      delim = delim || ',';\n      if (typeof items === 'string') {\n        items = items.split(delim);\n      }\n      map = map || {};\n      i = items.length;\n      while (i--) {\n        map[items[i]] = {};\n      }\n      return map;\n    };\n    var hasOwnProperty$1 = function (obj, prop) {\n      return Object.prototype.hasOwnProperty.call(obj, prop);\n    };\n    var create = function (s, p, root) {\n      var self = this;\n      var sp, ns, cn, scn, c, de = 0;\n      s = /^((static) )?([\\w.]+)(:([\\w.]+))?/.exec(s);\n      cn = s[3].match(/(^|\\.)(\\w+)$/i)[2];\n      ns = self.createNS(s[3].replace(/\\.\\w+$/, ''), root);\n      if (ns[cn]) {\n        return;\n      }\n      if (s[2] === 'static') {\n        ns[cn] = p;\n        if (this.onCreate) {\n          this.onCreate(s[2], s[3], ns[cn]);\n        }\n        return;\n      }\n      if (!p[cn]) {\n        p[cn] = function () {\n        };\n        de = 1;\n      }\n      ns[cn] = p[cn];\n      self.extend(ns[cn].prototype, p);\n      if (s[5]) {\n        sp = self.resolve(s[5]).prototype;\n        scn = s[5].match(/\\.(\\w+)$/i)[1];\n        c = ns[cn];\n        if (de) {\n          ns[cn] = function () {\n            return sp[scn].apply(this, arguments);\n          };\n        } else {\n          ns[cn] = function () {\n            this.parent = sp[scn];\n            return c.apply(this, arguments);\n          };\n        }\n        ns[cn].prototype[cn] = ns[cn];\n        self.each(sp, function (f, n) {\n          ns[cn].prototype[n] = sp[n];\n        });\n        self.each(p, function (f, n) {\n          if (sp[n]) {\n            ns[cn].prototype[n] = function () {\n              this.parent = sp[n];\n              return f.apply(this, arguments);\n            };\n          } else {\n            if (n !== cn) {\n              ns[cn].prototype[n] = f;\n            }\n          }\n        });\n      }\n      self.each(p.static, function (f, n) {\n        ns[cn][n] = f;\n      });\n    };\n    var extend = function (obj, ext) {\n      var x = [];\n      for (var _i = 2; _i < arguments.length; _i++) {\n        x[_i - 2] = arguments[_i];\n      }\n      var i, l, name;\n      var args = arguments;\n      var value;\n      for (i = 1, l = args.length; i < l; i++) {\n        ext = args[i];\n        for (name in ext) {\n          if (ext.hasOwnProperty(name)) {\n            value = ext[name];\n            if (value !== undefined) {\n              obj[name] = value;\n            }\n          }\n        }\n      }\n      return obj;\n    };\n    var walk = function (o, f, n, s) {\n      s = s || this;\n      if (o) {\n        if (n) {\n          o = o[n];\n        }\n        ArrUtils.each(o, function (o, i) {\n          if (f.call(s, o, i, n) === false) {\n            return false;\n          }\n          walk(o, f, n, s);\n        });\n      }\n    };\n    var createNS = function (n, o) {\n      var i, v;\n      o = o || domGlobals.window;\n      n = n.split('.');\n      for (i = 0; i < n.length; i++) {\n        v = n[i];\n        if (!o[v]) {\n          o[v] = {};\n        }\n        o = o[v];\n      }\n      return o;\n    };\n    var resolve = function (n, o) {\n      var i, l;\n      o = o || domGlobals.window;\n      n = n.split('.');\n      for (i = 0, l = n.length; i < l; i++) {\n        o = o[n[i]];\n        if (!o) {\n          break;\n        }\n      }\n      return o;\n    };\n    var explode = function (s, d) {\n      if (!s || is$1(s, 'array')) {\n        return s;\n      }\n      return ArrUtils.map(s.split(d || ','), trim$1);\n    };\n    var _addCacheSuffix = function (url) {\n      var cacheSuffix = Env.cacheSuffix;\n      if (cacheSuffix) {\n        url += (url.indexOf('?') === -1 ? '?' : '&') + cacheSuffix;\n      }\n      return url;\n    };\n    var Tools = {\n      trim: trim$1,\n      isArray: ArrUtils.isArray,\n      is: is$1,\n      toArray: ArrUtils.toArray,\n      makeMap: makeMap,\n      each: ArrUtils.each,\n      map: ArrUtils.map,\n      grep: ArrUtils.filter,\n      inArray: ArrUtils.indexOf,\n      hasOwn: hasOwnProperty$1,\n      extend: extend,\n      create: create,\n      walk: walk,\n      createNS: createNS,\n      resolve: resolve,\n      explode: explode,\n      _addCacheSuffix: _addCacheSuffix\n    };\n\n    function StyleSheetLoader(document, settings) {\n      if (settings === void 0) {\n        settings = {};\n      }\n      var idCount = 0;\n      var loadedStates = {};\n      var maxLoadTime;\n      maxLoadTime = settings.maxLoadTime || 5000;\n      var _setReferrerPolicy = function (referrerPolicy) {\n        settings.referrerPolicy = referrerPolicy;\n      };\n      var appendToHead = function (node) {\n        document.getElementsByTagName('head')[0].appendChild(node);\n      };\n      var load = function (url, loadedCallback, errorCallback) {\n        var link, style, startTime, state;\n        var resolve = function (status) {\n          state.status = status;\n          state.passed = [];\n          state.failed = [];\n          if (link) {\n            link.onload = null;\n            link.onerror = null;\n            link = null;\n          }\n        };\n        var passed = function () {\n          var callbacks = state.passed;\n          var i = callbacks.length;\n          while (i--) {\n            callbacks[i]();\n          }\n          resolve(2);\n        };\n        var failed = function () {\n          var callbacks = state.failed;\n          var i = callbacks.length;\n          while (i--) {\n            callbacks[i]();\n          }\n          resolve(3);\n        };\n        var isOldWebKit = function () {\n          var webKitChunks = domGlobals.navigator.userAgent.match(/WebKit\\/(\\d*)/);\n          return !!(webKitChunks && parseInt(webKitChunks[1], 10) < 536);\n        };\n        var wait = function (testCallback, waitCallback) {\n          if (!testCallback()) {\n            if (new Date().getTime() - startTime < maxLoadTime) {\n              Delay.setTimeout(waitCallback);\n            } else {\n              failed();\n            }\n          }\n        };\n        var waitForWebKitLinkLoaded = function () {\n          wait(function () {\n            var styleSheets = document.styleSheets;\n            var styleSheet, i = styleSheets.length, owner;\n            while (i--) {\n              styleSheet = styleSheets[i];\n              owner = styleSheet.ownerNode ? styleSheet.ownerNode : styleSheet.owningElement;\n              if (owner && owner.id === link.id) {\n                passed();\n                return true;\n              }\n            }\n          }, waitForWebKitLinkLoaded);\n        };\n        var waitForGeckoLinkLoaded = function () {\n          wait(function () {\n            try {\n              var cssRules = style.sheet.cssRules;\n              passed();\n              return !!cssRules;\n            } catch (ex) {\n            }\n          }, waitForGeckoLinkLoaded);\n        };\n        url = Tools._addCacheSuffix(url);\n        if (!loadedStates[url]) {\n          state = {\n            passed: [],\n            failed: []\n          };\n          loadedStates[url] = state;\n        } else {\n          state = loadedStates[url];\n        }\n        if (loadedCallback) {\n          state.passed.push(loadedCallback);\n        }\n        if (errorCallback) {\n          state.failed.push(errorCallback);\n        }\n        if (state.status === 1) {\n          return;\n        }\n        if (state.status === 2) {\n          passed();\n          return;\n        }\n        if (state.status === 3) {\n          failed();\n          return;\n        }\n        state.status = 1;\n        link = document.createElement('link');\n        link.rel = 'stylesheet';\n        link.type = 'text/css';\n        link.id = 'u' + idCount++;\n        link.async = false;\n        link.defer = false;\n        startTime = new Date().getTime();\n        if (settings.contentCssCors) {\n          link.crossOrigin = 'anonymous';\n        }\n        if (settings.referrerPolicy) {\n          set(Element.fromDom(link), 'referrerpolicy', settings.referrerPolicy);\n        }\n        if ('onload' in link && !isOldWebKit()) {\n          link.onload = waitForWebKitLinkLoaded;\n          link.onerror = failed;\n        } else {\n          if (domGlobals.navigator.userAgent.indexOf('Firefox') > 0) {\n            style = document.createElement('style');\n            style.textContent = '@import \"' + url + '\"';\n            waitForGeckoLinkLoaded();\n            appendToHead(style);\n            return;\n          }\n          waitForWebKitLinkLoaded();\n        }\n        appendToHead(link);\n        link.href = url;\n      };\n      var loadF = function (url) {\n        return Future.nu(function (resolve) {\n          load(url, compose(resolve, constant(Result.value(url))), compose(resolve, constant(Result.error(url))));\n        });\n      };\n      var unbox = function (result) {\n        return result.fold(identity, identity);\n      };\n      var loadAll = function (urls, success, failure) {\n        par$1(map(urls, loadF)).get(function (result) {\n          var parts = partition(result, function (r) {\n            return r.isValue();\n          });\n          if (parts.fail.length > 0) {\n            failure(parts.fail.map(unbox));\n          } else {\n            success(parts.pass.map(unbox));\n          }\n        });\n      };\n      return {\n        load: load,\n        loadAll: loadAll,\n        _setReferrerPolicy: _setReferrerPolicy\n      };\n    }\n\n    var blocks = [\n      'article',\n      'aside',\n      'details',\n      'div',\n      'dt',\n      'figcaption',\n      'footer',\n      'form',\n      'fieldset',\n      'header',\n      'hgroup',\n      'html',\n      'main',\n      'nav',\n      'section',\n      'summary',\n      'body',\n      'p',\n      'dl',\n      'multicol',\n      'dd',\n      'figure',\n      'address',\n      'center',\n      'blockquote',\n      'h1',\n      'h2',\n      'h3',\n      'h4',\n      'h5',\n      'h6',\n      'listing',\n      'xmp',\n      'pre',\n      'plaintext',\n      'menu',\n      'dir',\n      'ul',\n      'ol',\n      'li',\n      'hr',\n      'table',\n      'tbody',\n      'thead',\n      'tfoot',\n      'th',\n      'tr',\n      'td',\n      'caption'\n    ];\n    var voids = [\n      'area',\n      'base',\n      'basefont',\n      'br',\n      'col',\n      'frame',\n      'hr',\n      'img',\n      'input',\n      'isindex',\n      'link',\n      'meta',\n      'param',\n      'embed',\n      'source',\n      'wbr',\n      'track'\n    ];\n    var tableCells = [\n      'td',\n      'th'\n    ];\n    var tableSections = [\n      'thead',\n      'tbody',\n      'tfoot'\n    ];\n    var textBlocks = [\n      'h1',\n      'h2',\n      'h3',\n      'h4',\n      'h5',\n      'h6',\n      'p',\n      'div',\n      'address',\n      'pre',\n      'form',\n      'blockquote',\n      'center',\n      'dir',\n      'fieldset',\n      'header',\n      'footer',\n      'article',\n      'section',\n      'hgroup',\n      'aside',\n      'nav',\n      'figure'\n    ];\n    var headings = [\n      'h1',\n      'h2',\n      'h3',\n      'h4',\n      'h5',\n      'h6'\n    ];\n    var listItems = [\n      'li',\n      'dd',\n      'dt'\n    ];\n    var lists = [\n      'ul',\n      'ol',\n      'dl'\n    ];\n    var wsElements = [\n      'pre',\n      'script',\n      'textarea',\n      'style'\n    ];\n    var lazyLookup = function (items) {\n      var lookup;\n      return function (node) {\n        lookup = lookup ? lookup : mapToObject(items, constant(true));\n        return lookup.hasOwnProperty(name(node));\n      };\n    };\n    var isHeading = lazyLookup(headings);\n    var isBlock = lazyLookup(blocks);\n    var isTable$1 = function (node) {\n      return name(node) === 'table';\n    };\n    var isInline = function (node) {\n      return isElement(node) && !isBlock(node);\n    };\n    var isBr$1 = function (node) {\n      return isElement(node) && name(node) === 'br';\n    };\n    var isTextBlock = lazyLookup(textBlocks);\n    var isList = lazyLookup(lists);\n    var isListItem = lazyLookup(listItems);\n    var isVoid = lazyLookup(voids);\n    var isTableSection = lazyLookup(tableSections);\n    var isTableCell = lazyLookup(tableCells);\n    var isWsPreserveElement = lazyLookup(wsElements);\n\n    var surroundedBySpans = function (node) {\n      var previousIsSpan = node.previousSibling && node.previousSibling.nodeName === 'SPAN';\n      var nextIsSpan = node.nextSibling && node.nextSibling.nodeName === 'SPAN';\n      return previousIsSpan && nextIsSpan;\n    };\n    var isBookmarkNode = function (node) {\n      return node && node.tagName === 'SPAN' && node.getAttribute('data-mce-type') === 'bookmark';\n    };\n    var trimNode = function (dom, node) {\n      var i, children = node.childNodes;\n      if (NodeType.isElement(node) && isBookmarkNode(node)) {\n        return;\n      }\n      for (i = children.length - 1; i >= 0; i--) {\n        trimNode(dom, children[i]);\n      }\n      if (NodeType.isDocument(node) === false) {\n        if (NodeType.isText(node) && node.nodeValue.length > 0) {\n          var trimmedLength = Tools.trim(node.nodeValue).length;\n          if (dom.isBlock(node.parentNode) || trimmedLength > 0) {\n            return;\n          }\n          if (trimmedLength === 0 && surroundedBySpans(node)) {\n            return;\n          }\n        } else if (NodeType.isElement(node)) {\n          children = node.childNodes;\n          if (children.length === 1 && isBookmarkNode(children[0])) {\n            node.parentNode.insertBefore(children[0], node);\n          }\n          if (children.length || isVoid(Element.fromDom(node))) {\n            return;\n          }\n        }\n        dom.remove(node);\n      }\n      return node;\n    };\n    var TrimNode = { trimNode: trimNode };\n\n    var makeMap$1 = Tools.makeMap;\n    var namedEntities, baseEntities, reverseEntities;\n    var attrsCharsRegExp = /[&<>\\\"\\u0060\\u007E-\\uD7FF\\uE000-\\uFFEF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]/g;\n    var textCharsRegExp = /[<>&\\u007E-\\uD7FF\\uE000-\\uFFEF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]/g;\n    var rawCharsRegExp = /[<>&\\\"\\']/g;\n    var entityRegExp = /&#([a-z0-9]+);?|&([a-z0-9]+);/gi;\n    var asciiMap = {\n      128: '\\u20AC',\n      130: '\\u201A',\n      131: '\\u0192',\n      132: '\\u201E',\n      133: '\\u2026',\n      134: '\\u2020',\n      135: '\\u2021',\n      136: '\\u02c6',\n      137: '\\u2030',\n      138: '\\u0160',\n      139: '\\u2039',\n      140: '\\u0152',\n      142: '\\u017d',\n      145: '\\u2018',\n      146: '\\u2019',\n      147: '\\u201C',\n      148: '\\u201D',\n      149: '\\u2022',\n      150: '\\u2013',\n      151: '\\u2014',\n      152: '\\u02DC',\n      153: '\\u2122',\n      154: '\\u0161',\n      155: '\\u203A',\n      156: '\\u0153',\n      158: '\\u017e',\n      159: '\\u0178'\n    };\n    baseEntities = {\n      '\"': '&quot;',\n      '\\'': '&#39;',\n      '<': '&lt;',\n      '>': '&gt;',\n      '&': '&amp;',\n      '`': '&#96;'\n    };\n    reverseEntities = {\n      '&lt;': '<',\n      '&gt;': '>',\n      '&amp;': '&',\n      '&quot;': '\"',\n      '&apos;': '\\''\n    };\n    var nativeDecode = function (text) {\n      var elm;\n      elm = Element.fromTag('div').dom();\n      elm.innerHTML = text;\n      return elm.textContent || elm.innerText || text;\n    };\n    var buildEntitiesLookup = function (items, radix) {\n      var i, chr, entity;\n      var lookup = {};\n      if (items) {\n        items = items.split(',');\n        radix = radix || 10;\n        for (i = 0; i < items.length; i += 2) {\n          chr = String.fromCharCode(parseInt(items[i], radix));\n          if (!baseEntities[chr]) {\n            entity = '&' + items[i + 1] + ';';\n            lookup[chr] = entity;\n            lookup[entity] = chr;\n          }\n        }\n        return lookup;\n      }\n    };\n    namedEntities = buildEntitiesLookup('50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,' + '5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,' + '5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,' + '5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,' + '68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,' + '6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,' + '6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,' + '75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,' + '7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,' + '7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,' + 'sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,' + 'st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,' + 't9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,' + 'tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,' + 'u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,' + '81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,' + '8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,' + '8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,' + '8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,' + '8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,' + 'nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,' + 'rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,' + 'Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,' + '80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,' + '811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro', 32);\n    var encodeRaw = function (text, attr) {\n      return text.replace(attr ? attrsCharsRegExp : textCharsRegExp, function (chr) {\n        return baseEntities[chr] || chr;\n      });\n    };\n    var encodeAllRaw = function (text) {\n      return ('' + text).replace(rawCharsRegExp, function (chr) {\n        return baseEntities[chr] || chr;\n      });\n    };\n    var encodeNumeric = function (text, attr) {\n      return text.replace(attr ? attrsCharsRegExp : textCharsRegExp, function (chr) {\n        if (chr.length > 1) {\n          return '&#' + ((chr.charCodeAt(0) - 55296) * 1024 + (chr.charCodeAt(1) - 56320) + 65536) + ';';\n        }\n        return baseEntities[chr] || '&#' + chr.charCodeAt(0) + ';';\n      });\n    };\n    var encodeNamed = function (text, attr, entities) {\n      entities = entities || namedEntities;\n      return text.replace(attr ? attrsCharsRegExp : textCharsRegExp, function (chr) {\n        return baseEntities[chr] || entities[chr] || chr;\n      });\n    };\n    var getEncodeFunc = function (name, entities) {\n      var entitiesMap = buildEntitiesLookup(entities) || namedEntities;\n      var encodeNamedAndNumeric = function (text, attr) {\n        return text.replace(attr ? attrsCharsRegExp : textCharsRegExp, function (chr) {\n          if (baseEntities[chr] !== undefined) {\n            return baseEntities[chr];\n          }\n          if (entitiesMap[chr] !== undefined) {\n            return entitiesMap[chr];\n          }\n          if (chr.length > 1) {\n            return '&#' + ((chr.charCodeAt(0) - 55296) * 1024 + (chr.charCodeAt(1) - 56320) + 65536) + ';';\n          }\n          return '&#' + chr.charCodeAt(0) + ';';\n        });\n      };\n      var encodeCustomNamed = function (text, attr) {\n        return encodeNamed(text, attr, entitiesMap);\n      };\n      var nameMap = makeMap$1(name.replace(/\\+/g, ','));\n      if (nameMap.named && nameMap.numeric) {\n        return encodeNamedAndNumeric;\n      }\n      if (nameMap.named) {\n        if (entities) {\n          return encodeCustomNamed;\n        }\n        return encodeNamed;\n      }\n      if (nameMap.numeric) {\n        return encodeNumeric;\n      }\n      return encodeRaw;\n    };\n    var decode = function (text) {\n      return text.replace(entityRegExp, function (all, numeric) {\n        if (numeric) {\n          if (numeric.charAt(0).toLowerCase() === 'x') {\n            numeric = parseInt(numeric.substr(1), 16);\n          } else {\n            numeric = parseInt(numeric, 10);\n          }\n          if (numeric > 65535) {\n            numeric -= 65536;\n            return String.fromCharCode(55296 + (numeric >> 10), 56320 + (numeric & 1023));\n          }\n          return asciiMap[numeric] || String.fromCharCode(numeric);\n        }\n        return reverseEntities[all] || namedEntities[all] || nativeDecode(all);\n      });\n    };\n    var Entities = {\n      encodeRaw: encodeRaw,\n      encodeAllRaw: encodeAllRaw,\n      encodeNumeric: encodeNumeric,\n      encodeNamed: encodeNamed,\n      getEncodeFunc: getEncodeFunc,\n      decode: decode\n    };\n\n    var mapCache = {}, dummyObj = {};\n    var makeMap$2 = Tools.makeMap, each$3 = Tools.each, extend$1 = Tools.extend, explode$1 = Tools.explode, inArray = Tools.inArray;\n    var split = function (items, delim) {\n      items = Tools.trim(items);\n      return items ? items.split(delim || ' ') : [];\n    };\n    var compileSchema = function (type) {\n      var schema = {};\n      var globalAttributes, blockContent;\n      var phrasingContent, flowContent, html4BlockContent, html4PhrasingContent;\n      var add = function (name, attributes, children) {\n        var ni, attributesOrder, element;\n        var arrayToMap = function (array, obj) {\n          var map = {};\n          var i, l;\n          for (i = 0, l = array.length; i < l; i++) {\n            map[array[i]] = obj || {};\n          }\n          return map;\n        };\n        children = children || [];\n        attributes = attributes || '';\n        if (typeof children === 'string') {\n          children = split(children);\n        }\n        name = split(name);\n        ni = name.length;\n        while (ni--) {\n          attributesOrder = split([\n            globalAttributes,\n            attributes\n          ].join(' '));\n          element = {\n            attributes: arrayToMap(attributesOrder),\n            attributesOrder: attributesOrder,\n            children: arrayToMap(children, dummyObj)\n          };\n          schema[name[ni]] = element;\n        }\n      };\n      var addAttrs = function (name, attributes) {\n        var ni, schemaItem, i, l;\n        name = split(name);\n        ni = name.length;\n        attributes = split(attributes);\n        while (ni--) {\n          schemaItem = schema[name[ni]];\n          for (i = 0, l = attributes.length; i < l; i++) {\n            schemaItem.attributes[attributes[i]] = {};\n            schemaItem.attributesOrder.push(attributes[i]);\n          }\n        }\n      };\n      if (mapCache[type]) {\n        return mapCache[type];\n      }\n      globalAttributes = 'id accesskey class dir lang style tabindex title role';\n      blockContent = 'address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul';\n      phrasingContent = 'a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd ' + 'label map noscript object q s samp script select small span strong sub sup ' + 'textarea u var #text #comment';\n      if (type !== 'html4') {\n        globalAttributes += ' contenteditable contextmenu draggable dropzone ' + 'hidden spellcheck translate';\n        blockContent += ' article aside details dialog figure main header footer hgroup section nav';\n        phrasingContent += ' audio canvas command datalist mark meter output picture ' + 'progress time wbr video ruby bdi keygen';\n      }\n      if (type !== 'html5-strict') {\n        globalAttributes += ' xml:lang';\n        html4PhrasingContent = 'acronym applet basefont big font strike tt';\n        phrasingContent = [\n          phrasingContent,\n          html4PhrasingContent\n        ].join(' ');\n        each$3(split(html4PhrasingContent), function (name) {\n          add(name, '', phrasingContent);\n        });\n        html4BlockContent = 'center dir isindex noframes';\n        blockContent = [\n          blockContent,\n          html4BlockContent\n        ].join(' ');\n        flowContent = [\n          blockContent,\n          phrasingContent\n        ].join(' ');\n        each$3(split(html4BlockContent), function (name) {\n          add(name, '', flowContent);\n        });\n      }\n      flowContent = flowContent || [\n        blockContent,\n        phrasingContent\n      ].join(' ');\n      add('html', 'manifest', 'head body');\n      add('head', '', 'base command link meta noscript script style title');\n      add('title hr noscript br');\n      add('base', 'href target');\n      add('link', 'href rel media hreflang type sizes hreflang');\n      add('meta', 'name http-equiv content charset');\n      add('style', 'media type scoped');\n      add('script', 'src async defer type charset');\n      add('body', 'onafterprint onbeforeprint onbeforeunload onblur onerror onfocus ' + 'onhashchange onload onmessage onoffline ononline onpagehide onpageshow ' + 'onpopstate onresize onscroll onstorage onunload', flowContent);\n      add('address dt dd div caption', '', flowContent);\n      add('h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn', '', phrasingContent);\n      add('blockquote', 'cite', flowContent);\n      add('ol', 'reversed start type', 'li');\n      add('ul', '', 'li');\n      add('li', 'value', flowContent);\n      add('dl', '', 'dt dd');\n      add('a', 'href target rel media hreflang type', phrasingContent);\n      add('q', 'cite', phrasingContent);\n      add('ins del', 'cite datetime', flowContent);\n      add('img', 'src sizes srcset alt usemap ismap width height');\n      add('iframe', 'src name width height', flowContent);\n      add('embed', 'src type width height');\n      add('object', 'data type typemustmatch name usemap form width height', [\n        flowContent,\n        'param'\n      ].join(' '));\n      add('param', 'name value');\n      add('map', 'name', [\n        flowContent,\n        'area'\n      ].join(' '));\n      add('area', 'alt coords shape href target rel media hreflang type');\n      add('table', 'border', 'caption colgroup thead tfoot tbody tr' + (type === 'html4' ? ' col' : ''));\n      add('colgroup', 'span', 'col');\n      add('col', 'span');\n      add('tbody thead tfoot', '', 'tr');\n      add('tr', '', 'td th');\n      add('td', 'colspan rowspan headers', flowContent);\n      add('th', 'colspan rowspan headers scope abbr', flowContent);\n      add('form', 'accept-charset action autocomplete enctype method name novalidate target', flowContent);\n      add('fieldset', 'disabled form name', [\n        flowContent,\n        'legend'\n      ].join(' '));\n      add('label', 'form for', phrasingContent);\n      add('input', 'accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate ' + 'formtarget height list max maxlength min multiple name pattern readonly required size src step type value width');\n      add('button', 'disabled form formaction formenctype formmethod formnovalidate formtarget name type value', type === 'html4' ? flowContent : phrasingContent);\n      add('select', 'disabled form multiple name required size', 'option optgroup');\n      add('optgroup', 'disabled label', 'option');\n      add('option', 'disabled label selected value');\n      add('textarea', 'cols dirname disabled form maxlength name readonly required rows wrap');\n      add('menu', 'type label', [\n        flowContent,\n        'li'\n      ].join(' '));\n      add('noscript', '', flowContent);\n      if (type !== 'html4') {\n        add('wbr');\n        add('ruby', '', [\n          phrasingContent,\n          'rt rp'\n        ].join(' '));\n        add('figcaption', '', flowContent);\n        add('mark rt rp summary bdi', '', phrasingContent);\n        add('canvas', 'width height', flowContent);\n        add('video', 'src crossorigin poster preload autoplay mediagroup loop ' + 'muted controls width height buffered', [\n          flowContent,\n          'track source'\n        ].join(' '));\n        add('audio', 'src crossorigin preload autoplay mediagroup loop muted controls ' + 'buffered volume', [\n          flowContent,\n          'track source'\n        ].join(' '));\n        add('picture', '', 'img source');\n        add('source', 'src srcset type media sizes');\n        add('track', 'kind src srclang label default');\n        add('datalist', '', [\n          phrasingContent,\n          'option'\n        ].join(' '));\n        add('article section nav aside main header footer', '', flowContent);\n        add('hgroup', '', 'h1 h2 h3 h4 h5 h6');\n        add('figure', '', [\n          flowContent,\n          'figcaption'\n        ].join(' '));\n        add('time', 'datetime', phrasingContent);\n        add('dialog', 'open', flowContent);\n        add('command', 'type label icon disabled checked radiogroup command');\n        add('output', 'for form name', phrasingContent);\n        add('progress', 'value max', phrasingContent);\n        add('meter', 'value min max low high optimum', phrasingContent);\n        add('details', 'open', [\n          flowContent,\n          'summary'\n        ].join(' '));\n        add('keygen', 'autofocus challenge disabled form keytype name');\n      }\n      if (type !== 'html5-strict') {\n        addAttrs('script', 'language xml:space');\n        addAttrs('style', 'xml:space');\n        addAttrs('object', 'declare classid code codebase codetype archive standby align border hspace vspace');\n        addAttrs('embed', 'align name hspace vspace');\n        addAttrs('param', 'valuetype type');\n        addAttrs('a', 'charset name rev shape coords');\n        addAttrs('br', 'clear');\n        addAttrs('applet', 'codebase archive code object alt name width height align hspace vspace');\n        addAttrs('img', 'name longdesc align border hspace vspace');\n        addAttrs('iframe', 'longdesc frameborder marginwidth marginheight scrolling align');\n        addAttrs('font basefont', 'size color face');\n        addAttrs('input', 'usemap align');\n        addAttrs('select');\n        addAttrs('textarea');\n        addAttrs('h1 h2 h3 h4 h5 h6 div p legend caption', 'align');\n        addAttrs('ul', 'type compact');\n        addAttrs('li', 'type');\n        addAttrs('ol dl menu dir', 'compact');\n        addAttrs('pre', 'width xml:space');\n        addAttrs('hr', 'align noshade size width');\n        addAttrs('isindex', 'prompt');\n        addAttrs('table', 'summary width frame rules cellspacing cellpadding align bgcolor');\n        addAttrs('col', 'width align char charoff valign');\n        addAttrs('colgroup', 'width align char charoff valign');\n        addAttrs('thead', 'align char charoff valign');\n        addAttrs('tr', 'align char charoff valign bgcolor');\n        addAttrs('th', 'axis align char charoff valign nowrap bgcolor width height');\n        addAttrs('form', 'accept');\n        addAttrs('td', 'abbr axis scope align char charoff valign nowrap bgcolor width height');\n        addAttrs('tfoot', 'align char charoff valign');\n        addAttrs('tbody', 'align char charoff valign');\n        addAttrs('area', 'nohref');\n        addAttrs('body', 'background bgcolor text link vlink alink');\n      }\n      if (type !== 'html4') {\n        addAttrs('input button select textarea', 'autofocus');\n        addAttrs('input textarea', 'placeholder');\n        addAttrs('a', 'download');\n        addAttrs('link script img', 'crossorigin');\n        addAttrs('img', 'loading');\n        addAttrs('iframe', 'sandbox seamless allowfullscreen loading');\n      }\n      each$3(split('a form meter progress dfn'), function (name) {\n        if (schema[name]) {\n          delete schema[name].children[name];\n        }\n      });\n      delete schema.caption.children.table;\n      delete schema.script;\n      mapCache[type] = schema;\n      return schema;\n    };\n    var compileElementMap = function (value, mode) {\n      var styles;\n      if (value) {\n        styles = {};\n        if (typeof value === 'string') {\n          value = { '*': value };\n        }\n        each$3(value, function (value, key) {\n          styles[key] = styles[key.toUpperCase()] = mode === 'map' ? makeMap$2(value, /[, ]/) : explode$1(value, /[, ]/);\n        });\n      }\n      return styles;\n    };\n    function Schema(settings) {\n      var elements = {};\n      var children = {};\n      var patternElements = [];\n      var validStyles;\n      var invalidStyles;\n      var schemaItems;\n      var whiteSpaceElementsMap, selfClosingElementsMap, shortEndedElementsMap, boolAttrMap, validClasses;\n      var blockElementsMap, nonEmptyElementsMap, moveCaretBeforeOnEnterElementsMap, textBlockElementsMap, textInlineElementsMap;\n      var customElementsMap = {}, specialElements = {};\n      var createLookupTable = function (option, defaultValue, extendWith) {\n        var value = settings[option];\n        if (!value) {\n          value = mapCache[option];\n          if (!value) {\n            value = makeMap$2(defaultValue, ' ', makeMap$2(defaultValue.toUpperCase(), ' '));\n            value = extend$1(value, extendWith);\n            mapCache[option] = value;\n          }\n        } else {\n          value = makeMap$2(value, /[, ]/, makeMap$2(value.toUpperCase(), /[, ]/));\n        }\n        return value;\n      };\n      settings = settings || {};\n      schemaItems = compileSchema(settings.schema);\n      if (settings.verify_html === false) {\n        settings.valid_elements = '*[*]';\n      }\n      validStyles = compileElementMap(settings.valid_styles);\n      invalidStyles = compileElementMap(settings.invalid_styles, 'map');\n      validClasses = compileElementMap(settings.valid_classes, 'map');\n      whiteSpaceElementsMap = createLookupTable('whitespace_elements', 'pre script noscript style textarea video audio iframe object code');\n      selfClosingElementsMap = createLookupTable('self_closing_elements', 'colgroup dd dt li option p td tfoot th thead tr');\n      shortEndedElementsMap = createLookupTable('short_ended_elements', 'area base basefont br col frame hr img input isindex link ' + 'meta param embed source wbr track');\n      boolAttrMap = createLookupTable('boolean_attributes', 'checked compact declare defer disabled ismap multiple nohref noresize ' + 'noshade nowrap readonly selected autoplay loop controls');\n      nonEmptyElementsMap = createLookupTable('non_empty_elements', 'td th iframe video audio object ' + 'script pre code', shortEndedElementsMap);\n      moveCaretBeforeOnEnterElementsMap = createLookupTable('move_caret_before_on_enter_elements', 'table', nonEmptyElementsMap);\n      textBlockElementsMap = createLookupTable('text_block_elements', 'h1 h2 h3 h4 h5 h6 p div address pre form ' + 'blockquote center dir fieldset header footer article section hgroup aside main nav figure');\n      blockElementsMap = createLookupTable('block_elements', 'hr table tbody thead tfoot ' + 'th tr td li ol ul caption dl dt dd noscript menu isindex option ' + 'datalist select optgroup figcaption details summary', textBlockElementsMap);\n      textInlineElementsMap = createLookupTable('text_inline_elements', 'span strong b em i font strike u var cite ' + 'dfn code mark q sup sub samp');\n      each$3((settings.special || 'script noscript noframes noembed title style textarea xmp').split(' '), function (name) {\n        specialElements[name] = new RegExp('</' + name + '[^>]*>', 'gi');\n      });\n      var patternToRegExp = function (str) {\n        return new RegExp('^' + str.replace(/([?+*])/g, '.$1') + '$');\n      };\n      var addValidElements = function (validElements) {\n        var ei, el, ai, al, matches, element, attr, attrData, elementName, attrName, attrType, attributes, attributesOrder, prefix, outputName, globalAttributes, globalAttributesOrder, key, value;\n        var elementRuleRegExp = /^([#+\\-])?([^\\[!\\/]+)(?:\\/([^\\[!]+))?(?:(!?)\\[([^\\]]+)\\])?$/, attrRuleRegExp = /^([!\\-])?(\\w+[\\\\:]:\\w+|[^=:<]+)?(?:([=:<])(.*))?$/, hasPatternsRegExp = /[*?+]/;\n        if (validElements) {\n          validElements = split(validElements, ',');\n          if (elements['@']) {\n            globalAttributes = elements['@'].attributes;\n            globalAttributesOrder = elements['@'].attributesOrder;\n          }\n          for (ei = 0, el = validElements.length; ei < el; ei++) {\n            matches = elementRuleRegExp.exec(validElements[ei]);\n            if (matches) {\n              prefix = matches[1];\n              elementName = matches[2];\n              outputName = matches[3];\n              attrData = matches[5];\n              attributes = {};\n              attributesOrder = [];\n              element = {\n                attributes: attributes,\n                attributesOrder: attributesOrder\n              };\n              if (prefix === '#') {\n                element.paddEmpty = true;\n              }\n              if (prefix === '-') {\n                element.removeEmpty = true;\n              }\n              if (matches[4] === '!') {\n                element.removeEmptyAttrs = true;\n              }\n              if (globalAttributes) {\n                for (key in globalAttributes) {\n                  attributes[key] = globalAttributes[key];\n                }\n                attributesOrder.push.apply(attributesOrder, globalAttributesOrder);\n              }\n              if (attrData) {\n                attrData = split(attrData, '|');\n                for (ai = 0, al = attrData.length; ai < al; ai++) {\n                  matches = attrRuleRegExp.exec(attrData[ai]);\n                  if (matches) {\n                    attr = {};\n                    attrType = matches[1];\n                    attrName = matches[2].replace(/[\\\\:]:/g, ':');\n                    prefix = matches[3];\n                    value = matches[4];\n                    if (attrType === '!') {\n                      element.attributesRequired = element.attributesRequired || [];\n                      element.attributesRequired.push(attrName);\n                      attr.required = true;\n                    }\n                    if (attrType === '-') {\n                      delete attributes[attrName];\n                      attributesOrder.splice(inArray(attributesOrder, attrName), 1);\n                      continue;\n                    }\n                    if (prefix) {\n                      if (prefix === '=') {\n                        element.attributesDefault = element.attributesDefault || [];\n                        element.attributesDefault.push({\n                          name: attrName,\n                          value: value\n                        });\n                        attr.defaultValue = value;\n                      }\n                      if (prefix === ':') {\n                        element.attributesForced = element.attributesForced || [];\n                        element.attributesForced.push({\n                          name: attrName,\n                          value: value\n                        });\n                        attr.forcedValue = value;\n                      }\n                      if (prefix === '<') {\n                        attr.validValues = makeMap$2(value, '?');\n                      }\n                    }\n                    if (hasPatternsRegExp.test(attrName)) {\n                      element.attributePatterns = element.attributePatterns || [];\n                      attr.pattern = patternToRegExp(attrName);\n                      element.attributePatterns.push(attr);\n                    } else {\n                      if (!attributes[attrName]) {\n                        attributesOrder.push(attrName);\n                      }\n                      attributes[attrName] = attr;\n                    }\n                  }\n                }\n              }\n              if (!globalAttributes && elementName === '@') {\n                globalAttributes = attributes;\n                globalAttributesOrder = attributesOrder;\n              }\n              if (outputName) {\n                element.outputName = elementName;\n                elements[outputName] = element;\n              }\n              if (hasPatternsRegExp.test(elementName)) {\n                element.pattern = patternToRegExp(elementName);\n                patternElements.push(element);\n              } else {\n                elements[elementName] = element;\n              }\n            }\n          }\n        }\n      };\n      var setValidElements = function (validElements) {\n        elements = {};\n        patternElements = [];\n        addValidElements(validElements);\n        each$3(schemaItems, function (element, name) {\n          children[name] = element.children;\n        });\n      };\n      var addCustomElements = function (customElements) {\n        var customElementRegExp = /^(~)?(.+)$/;\n        if (customElements) {\n          mapCache.text_block_elements = mapCache.block_elements = null;\n          each$3(split(customElements, ','), function (rule) {\n            var matches = customElementRegExp.exec(rule), inline = matches[1] === '~', cloneName = inline ? 'span' : 'div', name = matches[2];\n            children[name] = children[cloneName];\n            customElementsMap[name] = cloneName;\n            if (!inline) {\n              blockElementsMap[name.toUpperCase()] = {};\n              blockElementsMap[name] = {};\n            }\n            if (!elements[name]) {\n              var customRule = elements[cloneName];\n              customRule = extend$1({}, customRule);\n              delete customRule.removeEmptyAttrs;\n              delete customRule.removeEmpty;\n              elements[name] = customRule;\n            }\n            each$3(children, function (element, elmName) {\n              if (element[cloneName]) {\n                children[elmName] = element = extend$1({}, children[elmName]);\n                element[name] = element[cloneName];\n              }\n            });\n          });\n        }\n      };\n      var addValidChildren = function (validChildren) {\n        var childRuleRegExp = /^([+\\-]?)(\\w+)\\[([^\\]]+)\\]$/;\n        mapCache[settings.schema] = null;\n        if (validChildren) {\n          each$3(split(validChildren, ','), function (rule) {\n            var matches = childRuleRegExp.exec(rule);\n            var parent, prefix;\n            if (matches) {\n              prefix = matches[1];\n              if (prefix) {\n                parent = children[matches[2]];\n              } else {\n                parent = children[matches[2]] = { '#comment': {} };\n              }\n              parent = children[matches[2]];\n              each$3(split(matches[3], '|'), function (child) {\n                if (prefix === '-') {\n                  delete parent[child];\n                } else {\n                  parent[child] = {};\n                }\n              });\n            }\n          });\n        }\n      };\n      var getElementRule = function (name) {\n        var element = elements[name], i;\n        if (element) {\n          return element;\n        }\n        i = patternElements.length;\n        while (i--) {\n          element = patternElements[i];\n          if (element.pattern.test(name)) {\n            return element;\n          }\n        }\n      };\n      if (!settings.valid_elements) {\n        each$3(schemaItems, function (element, name) {\n          elements[name] = {\n            attributes: element.attributes,\n            attributesOrder: element.attributesOrder\n          };\n          children[name] = element.children;\n        });\n        if (settings.schema !== 'html5') {\n          each$3(split('strong/b em/i'), function (item) {\n            item = split(item, '/');\n            elements[item[1]].outputName = item[0];\n          });\n        }\n        each$3(split('ol ul sub sup blockquote span font a table tbody tr strong em b i'), function (name) {\n          if (elements[name]) {\n            elements[name].removeEmpty = true;\n          }\n        });\n        each$3(split('p h1 h2 h3 h4 h5 h6 th td pre div address caption li'), function (name) {\n          elements[name].paddEmpty = true;\n        });\n        each$3(split('span'), function (name) {\n          elements[name].removeEmptyAttrs = true;\n        });\n      } else {\n        setValidElements(settings.valid_elements);\n      }\n      addCustomElements(settings.custom_elements);\n      addValidChildren(settings.valid_children);\n      addValidElements(settings.extended_valid_elements);\n      addValidChildren('+ol[ul|ol],+ul[ul|ol]');\n      each$3({\n        dd: 'dl',\n        dt: 'dl',\n        li: 'ul ol',\n        td: 'tr',\n        th: 'tr',\n        tr: 'tbody thead tfoot',\n        tbody: 'table',\n        thead: 'table',\n        tfoot: 'table',\n        legend: 'fieldset',\n        area: 'map',\n        param: 'video audio object'\n      }, function (parents, item) {\n        if (elements[item]) {\n          elements[item].parentsRequired = split(parents);\n        }\n      });\n      if (settings.invalid_elements) {\n        each$3(explode$1(settings.invalid_elements), function (item) {\n          if (elements[item]) {\n            delete elements[item];\n          }\n        });\n      }\n      if (!getElementRule('span')) {\n        addValidElements('span[!data-mce-type|*]');\n      }\n      var getValidStyles = function () {\n        return validStyles;\n      };\n      var getInvalidStyles = function () {\n        return invalidStyles;\n      };\n      var getValidClasses = function () {\n        return validClasses;\n      };\n      var getBoolAttrs = function () {\n        return boolAttrMap;\n      };\n      var getBlockElements = function () {\n        return blockElementsMap;\n      };\n      var getTextBlockElements = function () {\n        return textBlockElementsMap;\n      };\n      var getTextInlineElements = function () {\n        return textInlineElementsMap;\n      };\n      var getShortEndedElements = function () {\n        return shortEndedElementsMap;\n      };\n      var getSelfClosingElements = function () {\n        return selfClosingElementsMap;\n      };\n      var getNonEmptyElements = function () {\n        return nonEmptyElementsMap;\n      };\n      var getMoveCaretBeforeOnEnterElements = function () {\n        return moveCaretBeforeOnEnterElementsMap;\n      };\n      var getWhiteSpaceElements = function () {\n        return whiteSpaceElementsMap;\n      };\n      var getSpecialElements = function () {\n        return specialElements;\n      };\n      var isValidChild = function (name, child) {\n        var parent = children[name.toLowerCase()];\n        return !!(parent && parent[child.toLowerCase()]);\n      };\n      var isValid = function (name, attr) {\n        var attrPatterns, i;\n        var rule = getElementRule(name);\n        if (rule) {\n          if (attr) {\n            if (rule.attributes[attr]) {\n              return true;\n            }\n            attrPatterns = rule.attributePatterns;\n            if (attrPatterns) {\n              i = attrPatterns.length;\n              while (i--) {\n                if (attrPatterns[i].pattern.test(name)) {\n                  return true;\n                }\n              }\n            }\n          } else {\n            return true;\n          }\n        }\n        return false;\n      };\n      var getCustomElements = function () {\n        return customElementsMap;\n      };\n      return {\n        children: children,\n        elements: elements,\n        getValidStyles: getValidStyles,\n        getValidClasses: getValidClasses,\n        getBlockElements: getBlockElements,\n        getInvalidStyles: getInvalidStyles,\n        getShortEndedElements: getShortEndedElements,\n        getTextBlockElements: getTextBlockElements,\n        getTextInlineElements: getTextInlineElements,\n        getBoolAttrs: getBoolAttrs,\n        getElementRule: getElementRule,\n        getSelfClosingElements: getSelfClosingElements,\n        getNonEmptyElements: getNonEmptyElements,\n        getMoveCaretBeforeOnEnterElements: getMoveCaretBeforeOnEnterElements,\n        getWhiteSpaceElements: getWhiteSpaceElements,\n        getSpecialElements: getSpecialElements,\n        isValidChild: isValidChild,\n        isValid: isValid,\n        getCustomElements: getCustomElements,\n        addValidElements: addValidElements,\n        setValidElements: setValidElements,\n        addCustomElements: addCustomElements,\n        addValidChildren: addValidChildren\n      };\n    }\n\n    var zeroWidth = '\\uFEFF';\n    var nbsp = '\\xA0';\n\n    var toHex = function (match, r, g, b) {\n      var hex = function (val) {\n        val = parseInt(val, 10).toString(16);\n        return val.length > 1 ? val : '0' + val;\n      };\n      return '#' + hex(r) + hex(g) + hex(b);\n    };\n    var Styles = function (settings, schema) {\n      var rgbRegExp = /rgb\\s*\\(\\s*([0-9]+)\\s*,\\s*([0-9]+)\\s*,\\s*([0-9]+)\\s*\\)/gi;\n      var urlOrStrRegExp = /(?:url(?:(?:\\(\\s*\\\"([^\\\"]+)\\\"\\s*\\))|(?:\\(\\s*\\'([^\\']+)\\'\\s*\\))|(?:\\(\\s*([^)\\s]+)\\s*\\))))|(?:\\'([^\\']+)\\')|(?:\\\"([^\\\"]+)\\\")/gi;\n      var styleRegExp = /\\s*([^:]+):\\s*([^;]+);?/g;\n      var trimRightRegExp = /\\s+$/;\n      var i;\n      var encodingLookup = {};\n      var encodingItems;\n      var validStyles;\n      var invalidStyles;\n      var invisibleChar = zeroWidth;\n      settings = settings || {};\n      if (schema) {\n        validStyles = schema.getValidStyles();\n        invalidStyles = schema.getInvalidStyles();\n      }\n      encodingItems = ('\\\\\" \\\\\\' \\\\; \\\\: ; : ' + invisibleChar).split(' ');\n      for (i = 0; i < encodingItems.length; i++) {\n        encodingLookup[encodingItems[i]] = invisibleChar + i;\n        encodingLookup[invisibleChar + i] = encodingItems[i];\n      }\n      return {\n        toHex: function (color) {\n          return color.replace(rgbRegExp, toHex);\n        },\n        parse: function (css) {\n          var styles = {};\n          var matches, name, value, isEncoded;\n          var urlConverter = settings.url_converter;\n          var urlConverterScope = settings.url_converter_scope || this;\n          var compress = function (prefix, suffix, noJoin) {\n            var top, right, bottom, left;\n            top = styles[prefix + '-top' + suffix];\n            if (!top) {\n              return;\n            }\n            right = styles[prefix + '-right' + suffix];\n            if (!right) {\n              return;\n            }\n            bottom = styles[prefix + '-bottom' + suffix];\n            if (!bottom) {\n              return;\n            }\n            left = styles[prefix + '-left' + suffix];\n            if (!left) {\n              return;\n            }\n            var box = [\n              top,\n              right,\n              bottom,\n              left\n            ];\n            i = box.length - 1;\n            while (i--) {\n              if (box[i] !== box[i + 1]) {\n                break;\n              }\n            }\n            if (i > -1 && noJoin) {\n              return;\n            }\n            styles[prefix + suffix] = i === -1 ? box[0] : box.join(' ');\n            delete styles[prefix + '-top' + suffix];\n            delete styles[prefix + '-right' + suffix];\n            delete styles[prefix + '-bottom' + suffix];\n            delete styles[prefix + '-left' + suffix];\n          };\n          var canCompress = function (key) {\n            var value = styles[key], i;\n            if (!value) {\n              return;\n            }\n            value = value.split(' ');\n            i = value.length;\n            while (i--) {\n              if (value[i] !== value[0]) {\n                return false;\n              }\n            }\n            styles[key] = value[0];\n            return true;\n          };\n          var compress2 = function (target, a, b, c) {\n            if (!canCompress(a)) {\n              return;\n            }\n            if (!canCompress(b)) {\n              return;\n            }\n            if (!canCompress(c)) {\n              return;\n            }\n            styles[target] = styles[a] + ' ' + styles[b] + ' ' + styles[c];\n            delete styles[a];\n            delete styles[b];\n            delete styles[c];\n          };\n          var encode = function (str) {\n            isEncoded = true;\n            return encodingLookup[str];\n          };\n          var decode = function (str, keepSlashes) {\n            if (isEncoded) {\n              str = str.replace(/\\uFEFF[0-9]/g, function (str) {\n                return encodingLookup[str];\n              });\n            }\n            if (!keepSlashes) {\n              str = str.replace(/\\\\([\\'\\\";:])/g, '$1');\n            }\n            return str;\n          };\n          var decodeSingleHexSequence = function (escSeq) {\n            return String.fromCharCode(parseInt(escSeq.slice(1), 16));\n          };\n          var decodeHexSequences = function (value) {\n            return value.replace(/\\\\[0-9a-f]+/gi, decodeSingleHexSequence);\n          };\n          var processUrl = function (match, url, url2, url3, str, str2) {\n            str = str || str2;\n            if (str) {\n              str = decode(str);\n              return '\\'' + str.replace(/\\'/g, '\\\\\\'') + '\\'';\n            }\n            url = decode(url || url2 || url3);\n            if (!settings.allow_script_urls) {\n              var scriptUrl = url.replace(/[\\s\\r\\n]+/g, '');\n              if (/(java|vb)script:/i.test(scriptUrl)) {\n                return '';\n              }\n              if (!settings.allow_svg_data_urls && /^data:image\\/svg/i.test(scriptUrl)) {\n                return '';\n              }\n            }\n            if (urlConverter) {\n              url = urlConverter.call(urlConverterScope, url, 'style');\n            }\n            return 'url(\\'' + url.replace(/\\'/g, '\\\\\\'') + '\\')';\n          };\n          if (css) {\n            css = css.replace(/[\\u0000-\\u001F]/g, '');\n            css = css.replace(/\\\\[\\\"\\';:\\uFEFF]/g, encode).replace(/\\\"[^\\\"]+\\\"|\\'[^\\']+\\'/g, function (str) {\n              return str.replace(/[;:]/g, encode);\n            });\n            while (matches = styleRegExp.exec(css)) {\n              styleRegExp.lastIndex = matches.index + matches[0].length;\n              name = matches[1].replace(trimRightRegExp, '').toLowerCase();\n              value = matches[2].replace(trimRightRegExp, '');\n              if (name && value) {\n                name = decodeHexSequences(name);\n                value = decodeHexSequences(value);\n                if (name.indexOf(invisibleChar) !== -1 || name.indexOf('\"') !== -1) {\n                  continue;\n                }\n                if (!settings.allow_script_urls && (name === 'behavior' || /expression\\s*\\(|\\/\\*|\\*\\//.test(value))) {\n                  continue;\n                }\n                if (name === 'font-weight' && value === '700') {\n                  value = 'bold';\n                } else if (name === 'color' || name === 'background-color') {\n                  value = value.toLowerCase();\n                }\n                value = value.replace(rgbRegExp, toHex);\n                value = value.replace(urlOrStrRegExp, processUrl);\n                styles[name] = isEncoded ? decode(value, true) : value;\n              }\n            }\n            compress('border', '', true);\n            compress('border', '-width');\n            compress('border', '-color');\n            compress('border', '-style');\n            compress('padding', '');\n            compress('margin', '');\n            compress2('border', 'border-width', 'border-style', 'border-color');\n            if (styles.border === 'medium none') {\n              delete styles.border;\n            }\n            if (styles['border-image'] === 'none') {\n              delete styles['border-image'];\n            }\n          }\n          return styles;\n        },\n        serialize: function (styles, elementName) {\n          var css = '', name, value;\n          var serializeStyles = function (name) {\n            var styleList, i, l, value;\n            styleList = validStyles[name];\n            if (styleList) {\n              for (i = 0, l = styleList.length; i < l; i++) {\n                name = styleList[i];\n                value = styles[name];\n                if (value) {\n                  css += (css.length > 0 ? ' ' : '') + name + ': ' + value + ';';\n                }\n              }\n            }\n          };\n          var isValid = function (name, elementName) {\n            var styleMap;\n            styleMap = invalidStyles['*'];\n            if (styleMap && styleMap[name]) {\n              return false;\n            }\n            styleMap = invalidStyles[elementName];\n            if (styleMap && styleMap[name]) {\n              return false;\n            }\n            return true;\n          };\n          if (elementName && validStyles) {\n            serializeStyles('*');\n            serializeStyles(elementName);\n          } else {\n            for (name in styles) {\n              value = styles[name];\n              if (value && (!invalidStyles || isValid(name, elementName))) {\n                css += (css.length > 0 ? ' ' : '') + name + ': ' + value + ';';\n              }\n            }\n          }\n          return css;\n        }\n      };\n    };\n\n    var eventExpandoPrefix = 'mce-data-';\n    var mouseEventRe = /^(?:mouse|contextmenu)|click/;\n    var deprecated = {\n      keyLocation: 1,\n      layerX: 1,\n      layerY: 1,\n      returnValue: 1,\n      webkitMovementX: 1,\n      webkitMovementY: 1,\n      keyIdentifier: 1,\n      mozPressure: 1\n    };\n    var hasIsDefaultPrevented = function (event) {\n      return event.isDefaultPrevented === returnTrue || event.isDefaultPrevented === returnFalse;\n    };\n    var returnFalse = function () {\n      return false;\n    };\n    var returnTrue = function () {\n      return true;\n    };\n    var addEvent = function (target, name, callback, capture) {\n      if (target.addEventListener) {\n        target.addEventListener(name, callback, capture || false);\n      } else if (target.attachEvent) {\n        target.attachEvent('on' + name, callback);\n      }\n    };\n    var removeEvent = function (target, name, callback, capture) {\n      if (target.removeEventListener) {\n        target.removeEventListener(name, callback, capture || false);\n      } else if (target.detachEvent) {\n        target.detachEvent('on' + name, callback);\n      }\n    };\n    var getTargetFromShadowDom = function (event, defaultTarget) {\n      if (event.composedPath) {\n        var composedPath = event.composedPath();\n        if (composedPath && composedPath.length > 0) {\n          return composedPath[0];\n        }\n      }\n      return defaultTarget;\n    };\n    var fix = function (originalEvent, data) {\n      var name;\n      var event = data || {};\n      for (name in originalEvent) {\n        if (!deprecated[name]) {\n          event[name] = originalEvent[name];\n        }\n      }\n      if (!event.target) {\n        event.target = event.srcElement || domGlobals.document;\n      }\n      if (Env.experimentalShadowDom) {\n        event.target = getTargetFromShadowDom(originalEvent, event.target);\n      }\n      if (originalEvent && mouseEventRe.test(originalEvent.type) && originalEvent.pageX === undefined && originalEvent.clientX !== undefined) {\n        var eventDoc = event.target.ownerDocument || domGlobals.document;\n        var doc = eventDoc.documentElement;\n        var body = eventDoc.body;\n        event.pageX = originalEvent.clientX + (doc && doc.scrollLeft || body && body.scrollLeft || 0) - (doc && doc.clientLeft || body && body.clientLeft || 0);\n        event.pageY = originalEvent.clientY + (doc && doc.scrollTop || body && body.scrollTop || 0) - (doc && doc.clientTop || body && body.clientTop || 0);\n      }\n      event.preventDefault = function () {\n        event.isDefaultPrevented = returnTrue;\n        if (originalEvent) {\n          if (originalEvent.preventDefault) {\n            originalEvent.preventDefault();\n          } else {\n            originalEvent.returnValue = false;\n          }\n        }\n      };\n      event.stopPropagation = function () {\n        event.isPropagationStopped = returnTrue;\n        if (originalEvent) {\n          if (originalEvent.stopPropagation) {\n            originalEvent.stopPropagation();\n          } else {\n            originalEvent.cancelBubble = true;\n          }\n        }\n      };\n      event.stopImmediatePropagation = function () {\n        event.isImmediatePropagationStopped = returnTrue;\n        event.stopPropagation();\n      };\n      if (hasIsDefaultPrevented(event) === false) {\n        event.isDefaultPrevented = returnFalse;\n        event.isPropagationStopped = returnFalse;\n        event.isImmediatePropagationStopped = returnFalse;\n      }\n      if (typeof event.metaKey === 'undefined') {\n        event.metaKey = false;\n      }\n      return event;\n    };\n    var bindOnReady = function (win, callback, eventUtils) {\n      var doc = win.document, event = { type: 'ready' };\n      if (eventUtils.domLoaded) {\n        callback(event);\n        return;\n      }\n      var isDocReady = function () {\n        return doc.readyState === 'complete' || doc.readyState === 'interactive' && doc.body;\n      };\n      var readyHandler = function () {\n        removeEvent(win, 'DOMContentLoaded', readyHandler);\n        removeEvent(win, 'load', readyHandler);\n        if (!eventUtils.domLoaded) {\n          eventUtils.domLoaded = true;\n          callback(event);\n        }\n      };\n      if (isDocReady()) {\n        readyHandler();\n      } else {\n        addEvent(win, 'DOMContentLoaded', readyHandler);\n      }\n      addEvent(win, 'load', readyHandler);\n    };\n    var EventUtils = function () {\n      function EventUtils() {\n        this.domLoaded = false;\n        this.events = {};\n        this.count = 1;\n        this.expando = eventExpandoPrefix + (+new Date()).toString(32);\n        this.hasMouseEnterLeave = 'onmouseenter' in domGlobals.document.documentElement;\n        this.hasFocusIn = 'onfocusin' in domGlobals.document.documentElement;\n        this.count = 1;\n      }\n      EventUtils.prototype.bind = function (target, names, callback, scope) {\n        var self = this;\n        var id, callbackList, i, name, fakeName, nativeHandler, capture;\n        var win = domGlobals.window;\n        var defaultNativeHandler = function (evt) {\n          self.executeHandlers(fix(evt || win.event), id);\n        };\n        if (!target || target.nodeType === 3 || target.nodeType === 8) {\n          return;\n        }\n        if (!target[self.expando]) {\n          id = self.count++;\n          target[self.expando] = id;\n          self.events[id] = {};\n        } else {\n          id = target[self.expando];\n        }\n        scope = scope || target;\n        var namesList = names.split(' ');\n        i = namesList.length;\n        while (i--) {\n          name = namesList[i];\n          nativeHandler = defaultNativeHandler;\n          fakeName = capture = false;\n          if (name === 'DOMContentLoaded') {\n            name = 'ready';\n          }\n          if (self.domLoaded && name === 'ready' && target.readyState === 'complete') {\n            callback.call(scope, fix({ type: name }));\n            continue;\n          }\n          if (!self.hasMouseEnterLeave) {\n            fakeName = self.mouseEnterLeave[name];\n            if (fakeName) {\n              nativeHandler = function (evt) {\n                var current, related;\n                current = evt.currentTarget;\n                related = evt.relatedTarget;\n                if (related && current.contains) {\n                  related = current.contains(related);\n                } else {\n                  while (related && related !== current) {\n                    related = related.parentNode;\n                  }\n                }\n                if (!related) {\n                  evt = fix(evt || win.event);\n                  evt.type = evt.type === 'mouseout' ? 'mouseleave' : 'mouseenter';\n                  evt.target = current;\n                  self.executeHandlers(evt, id);\n                }\n              };\n            }\n          }\n          if (!self.hasFocusIn && (name === 'focusin' || name === 'focusout')) {\n            capture = true;\n            fakeName = name === 'focusin' ? 'focus' : 'blur';\n            nativeHandler = function (evt) {\n              evt = fix(evt || win.event);\n              evt.type = evt.type === 'focus' ? 'focusin' : 'focusout';\n              self.executeHandlers(evt, id);\n            };\n          }\n          callbackList = self.events[id][name];\n          if (!callbackList) {\n            self.events[id][name] = callbackList = [{\n                func: callback,\n                scope: scope\n              }];\n            callbackList.fakeName = fakeName;\n            callbackList.capture = capture;\n            callbackList.nativeHandler = nativeHandler;\n            if (name === 'ready') {\n              bindOnReady(target, nativeHandler, self);\n            } else {\n              addEvent(target, fakeName || name, nativeHandler, capture);\n            }\n          } else {\n            if (name === 'ready' && self.domLoaded) {\n              callback(fix({ type: name }));\n            } else {\n              callbackList.push({\n                func: callback,\n                scope: scope\n              });\n            }\n          }\n        }\n        target = callbackList = 0;\n        return callback;\n      };\n      EventUtils.prototype.unbind = function (target, names, callback) {\n        var id, callbackList, i, ci, name, eventMap;\n        if (!target || target.nodeType === 3 || target.nodeType === 8) {\n          return this;\n        }\n        id = target[this.expando];\n        if (id) {\n          eventMap = this.events[id];\n          if (names) {\n            var namesList = names.split(' ');\n            i = namesList.length;\n            while (i--) {\n              name = namesList[i];\n              callbackList = eventMap[name];\n              if (callbackList) {\n                if (callback) {\n                  ci = callbackList.length;\n                  while (ci--) {\n                    if (callbackList[ci].func === callback) {\n                      var nativeHandler = callbackList.nativeHandler;\n                      var fakeName = callbackList.fakeName, capture = callbackList.capture;\n                      callbackList = callbackList.slice(0, ci).concat(callbackList.slice(ci + 1));\n                      callbackList.nativeHandler = nativeHandler;\n                      callbackList.fakeName = fakeName;\n                      callbackList.capture = capture;\n                      eventMap[name] = callbackList;\n                    }\n                  }\n                }\n                if (!callback || callbackList.length === 0) {\n                  delete eventMap[name];\n                  removeEvent(target, callbackList.fakeName || name, callbackList.nativeHandler, callbackList.capture);\n                }\n              }\n            }\n          } else {\n            for (name in eventMap) {\n              callbackList = eventMap[name];\n              removeEvent(target, callbackList.fakeName || name, callbackList.nativeHandler, callbackList.capture);\n            }\n            eventMap = {};\n          }\n          for (name in eventMap) {\n            return this;\n          }\n          delete this.events[id];\n          try {\n            delete target[this.expando];\n          } catch (ex) {\n            target[this.expando] = null;\n          }\n        }\n        return this;\n      };\n      EventUtils.prototype.fire = function (target, name, args) {\n        var id;\n        if (!target || target.nodeType === 3 || target.nodeType === 8) {\n          return this;\n        }\n        var event = fix(null, args);\n        event.type = name;\n        event.target = target;\n        do {\n          id = target[this.expando];\n          if (id) {\n            this.executeHandlers(event, id);\n          }\n          target = target.parentNode || target.ownerDocument || target.defaultView || target.parentWindow;\n        } while (target && !event.isPropagationStopped());\n        return this;\n      };\n      EventUtils.prototype.clean = function (target) {\n        var i, children;\n        if (!target || target.nodeType === 3 || target.nodeType === 8) {\n          return this;\n        }\n        if (target[this.expando]) {\n          this.unbind(target);\n        }\n        if (!target.getElementsByTagName) {\n          target = target.document;\n        }\n        if (target && target.getElementsByTagName) {\n          this.unbind(target);\n          children = target.getElementsByTagName('*');\n          i = children.length;\n          while (i--) {\n            target = children[i];\n            if (target[this.expando]) {\n              this.unbind(target);\n            }\n          }\n        }\n        return this;\n      };\n      EventUtils.prototype.destroy = function () {\n        this.events = {};\n      };\n      EventUtils.prototype.cancel = function (e) {\n        if (e) {\n          e.preventDefault();\n          e.stopImmediatePropagation();\n        }\n        return false;\n      };\n      EventUtils.prototype.executeHandlers = function (evt, id) {\n        var callbackList, i, l, callback;\n        var container = this.events[id];\n        callbackList = container && container[evt.type];\n        if (callbackList) {\n          for (i = 0, l = callbackList.length; i < l; i++) {\n            callback = callbackList[i];\n            if (callback && callback.func.call(callback.scope, evt) === false) {\n              evt.preventDefault();\n            }\n            if (evt.isImmediatePropagationStopped()) {\n              return;\n            }\n          }\n        }\n      };\n      EventUtils.Event = new EventUtils();\n      return EventUtils;\n    }();\n\n    var i, support, Expr, getText, isXML, tokenize, compile, select, outermostContext, sortInput, hasDuplicate, setDocument, document, docElem, documentIsHTML, rbuggyQSA, rbuggyMatches, matches, contains$3, expando = 'sizzle' + -new Date(), preferredDoc = domGlobals.window.document, dirruns = 0, done = 0, classCache = createCache(), tokenCache = createCache(), compilerCache = createCache(), sortOrder = function (a, b) {\n        if (a === b) {\n          hasDuplicate = true;\n        }\n        return 0;\n      }, strundefined = typeof undefined, MAX_NEGATIVE = 1 << 31, hasOwn = {}.hasOwnProperty, arr = [], pop = arr.pop, push_native = arr.push, push = arr.push, slice = arr.slice, indexOf$2 = arr.indexOf || function (elem) {\n        var i = 0, len = this.length;\n        for (; i < len; i++) {\n          if (this[i] === elem) {\n            return i;\n          }\n        }\n        return -1;\n      }, booleans = 'checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped', whitespace = '[\\\\x20\\\\t\\\\r\\\\n\\\\f]', identifier = '(?:\\\\\\\\.|[\\\\w-]|[^\\\\x00-\\\\xa0])+', attributes = '\\\\[' + whitespace + '*(' + identifier + ')(?:' + whitespace + '*([*^$|!~]?=)' + whitespace + '*(?:\\'((?:\\\\\\\\.|[^\\\\\\\\\\'])*)\\'|\"((?:\\\\\\\\.|[^\\\\\\\\\"])*)\"|(' + identifier + '))|)' + whitespace + '*\\\\]', pseudos = ':(' + identifier + ')(?:\\\\((' + '(\\'((?:\\\\\\\\.|[^\\\\\\\\\\'])*)\\'|\"((?:\\\\\\\\.|[^\\\\\\\\\"])*)\")|' + '((?:\\\\\\\\.|[^\\\\\\\\()[\\\\]]|' + attributes + ')*)|' + '.*' + ')\\\\)|)', rtrim = new RegExp('^' + whitespace + '+|((?:^|[^\\\\\\\\])(?:\\\\\\\\.)*)' + whitespace + '+$', 'g'), rcomma = new RegExp('^' + whitespace + '*,' + whitespace + '*'), rcombinators = new RegExp('^' + whitespace + '*([>+~]|' + whitespace + ')' + whitespace + '*'), rattributeQuotes = new RegExp('=' + whitespace + '*([^\\\\]\\'\"]*?)' + whitespace + '*\\\\]', 'g'), rpseudo = new RegExp(pseudos), ridentifier = new RegExp('^' + identifier + '$'), matchExpr = {\n        ID: new RegExp('^#(' + identifier + ')'),\n        CLASS: new RegExp('^\\\\.(' + identifier + ')'),\n        TAG: new RegExp('^(' + identifier + '|[*])'),\n        ATTR: new RegExp('^' + attributes),\n        PSEUDO: new RegExp('^' + pseudos),\n        CHILD: new RegExp('^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\\\(' + whitespace + '*(even|odd|(([+-]|)(\\\\d*)n|)' + whitespace + '*(?:([+-]|)' + whitespace + '*(\\\\d+)|))' + whitespace + '*\\\\)|)', 'i'),\n        bool: new RegExp('^(?:' + booleans + ')$', 'i'),\n        needsContext: new RegExp('^' + whitespace + '*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\\\(' + whitespace + '*((?:-\\\\d)?\\\\d*)' + whitespace + '*\\\\)|)(?=[^-]|$)', 'i')\n      }, rinputs = /^(?:input|select|textarea|button)$/i, rheader = /^h\\d$/i, rnative = /^[^{]+\\{\\s*\\[native \\w/, rquickExpr = /^(?:#([\\w-]+)|(\\w+)|\\.([\\w-]+))$/, rsibling = /[+~]/, rescape = /'|\\\\/g, runescape = new RegExp('\\\\\\\\([\\\\da-f]{1,6}' + whitespace + '?|(' + whitespace + ')|.)', 'ig'), funescape = function (_, escaped, escapedWhitespace) {\n        var high = '0x' + escaped - 65536;\n        return high !== high || escapedWhitespace ? escaped : high < 0 ? String.fromCharCode(high + 65536) : String.fromCharCode(high >> 10 | 55296, high & 1023 | 56320);\n      };\n    try {\n      push.apply(arr = slice.call(preferredDoc.childNodes), preferredDoc.childNodes);\n      arr[preferredDoc.childNodes.length].nodeType;\n    } catch (e) {\n      push = {\n        apply: arr.length ? function (target, els) {\n          push_native.apply(target, slice.call(els));\n        } : function (target, els) {\n          var j = target.length, i = 0;\n          while (target[j++] = els[i++]) {\n          }\n          target.length = j - 1;\n        }\n      };\n    }\n    var Sizzle = function (selector, context, results, seed) {\n      var match, elem, m, nodeType, i, groups, old, nid, newContext, newSelector;\n      if ((context ? context.ownerDocument || context : preferredDoc) !== document) {\n        setDocument(context);\n      }\n      context = context || document;\n      results = results || [];\n      if (!selector || typeof selector !== 'string') {\n        return results;\n      }\n      if ((nodeType = context.nodeType) !== 1 && nodeType !== 9) {\n        return [];\n      }\n      if (documentIsHTML && !seed) {\n        if (match = rquickExpr.exec(selector)) {\n          if (m = match[1]) {\n            if (nodeType === 9) {\n              elem = context.getElementById(m);\n              if (elem && elem.parentNode) {\n                if (elem.id === m) {\n                  results.push(elem);\n                  return results;\n                }\n              } else {\n                return results;\n              }\n            } else {\n              if (context.ownerDocument && (elem = context.ownerDocument.getElementById(m)) && contains$3(context, elem) && elem.id === m) {\n                results.push(elem);\n                return results;\n              }\n            }\n          } else if (match[2]) {\n            push.apply(results, context.getElementsByTagName(selector));\n            return results;\n          } else if ((m = match[3]) && support.getElementsByClassName) {\n            push.apply(results, context.getElementsByClassName(m));\n            return results;\n          }\n        }\n        if (support.qsa && (!rbuggyQSA || !rbuggyQSA.test(selector))) {\n          nid = old = expando;\n          newContext = context;\n          newSelector = nodeType === 9 && selector;\n          if (nodeType === 1 && context.nodeName.toLowerCase() !== 'object') {\n            groups = tokenize(selector);\n            if (old = context.getAttribute('id')) {\n              nid = old.replace(rescape, '\\\\$&');\n            } else {\n              context.setAttribute('id', nid);\n            }\n            nid = '[id=\\'' + nid + '\\'] ';\n            i = groups.length;\n            while (i--) {\n              groups[i] = nid + toSelector(groups[i]);\n            }\n            newContext = rsibling.test(selector) && testContext(context.parentNode) || context;\n            newSelector = groups.join(',');\n          }\n          if (newSelector) {\n            try {\n              push.apply(results, newContext.querySelectorAll(newSelector));\n              return results;\n            } catch (qsaError) {\n            } finally {\n              if (!old) {\n                context.removeAttribute('id');\n              }\n            }\n          }\n        }\n      }\n      return select(selector.replace(rtrim, '$1'), context, results, seed);\n    };\n    function createCache() {\n      var keys = [];\n      function cache(key, value) {\n        if (keys.push(key + ' ') > Expr.cacheLength) {\n          delete cache[keys.shift()];\n        }\n        return cache[key + ' '] = value;\n      }\n      return cache;\n    }\n    function markFunction(fn) {\n      fn[expando] = true;\n      return fn;\n    }\n    function siblingCheck(a, b) {\n      var cur = b && a, diff = cur && a.nodeType === 1 && b.nodeType === 1 && (~b.sourceIndex || MAX_NEGATIVE) - (~a.sourceIndex || MAX_NEGATIVE);\n      if (diff) {\n        return diff;\n      }\n      if (cur) {\n        while (cur = cur.nextSibling) {\n          if (cur === b) {\n            return -1;\n          }\n        }\n      }\n      return a ? 1 : -1;\n    }\n    function createInputPseudo(type) {\n      return function (elem) {\n        var name = elem.nodeName.toLowerCase();\n        return name === 'input' && elem.type === type;\n      };\n    }\n    function createButtonPseudo(type) {\n      return function (elem) {\n        var name = elem.nodeName.toLowerCase();\n        return (name === 'input' || name === 'button') && elem.type === type;\n      };\n    }\n    function createPositionalPseudo(fn) {\n      return markFunction(function (argument) {\n        argument = +argument;\n        return markFunction(function (seed, matches) {\n          var j, matchIndexes = fn([], seed.length, argument), i = matchIndexes.length;\n          while (i--) {\n            if (seed[j = matchIndexes[i]]) {\n              seed[j] = !(matches[j] = seed[j]);\n            }\n          }\n        });\n      });\n    }\n    function testContext(context) {\n      return context && typeof context.getElementsByTagName !== strundefined && context;\n    }\n    support = Sizzle.support = {};\n    isXML = Sizzle.isXML = function (elem) {\n      var documentElement = elem && (elem.ownerDocument || elem).documentElement;\n      return documentElement ? documentElement.nodeName !== 'HTML' : false;\n    };\n    setDocument = Sizzle.setDocument = function (node) {\n      var hasCompare, doc = node ? node.ownerDocument || node : preferredDoc, parent = doc.defaultView;\n      function getTop(win) {\n        try {\n          return win.top;\n        } catch (ex) {\n        }\n        return null;\n      }\n      if (doc === document || doc.nodeType !== 9 || !doc.documentElement) {\n        return document;\n      }\n      document = doc;\n      docElem = doc.documentElement;\n      documentIsHTML = !isXML(doc);\n      if (parent && parent !== getTop(parent)) {\n        if (parent.addEventListener) {\n          parent.addEventListener('unload', function () {\n            setDocument();\n          }, false);\n        } else if (parent.attachEvent) {\n          parent.attachEvent('onunload', function () {\n            setDocument();\n          });\n        }\n      }\n      support.attributes = true;\n      support.getElementsByTagName = true;\n      support.getElementsByClassName = rnative.test(doc.getElementsByClassName);\n      support.getById = true;\n      Expr.find.ID = function (id, context) {\n        if (typeof context.getElementById !== strundefined && documentIsHTML) {\n          var m = context.getElementById(id);\n          return m && m.parentNode ? [m] : [];\n        }\n      };\n      Expr.filter.ID = function (id) {\n        var attrId = id.replace(runescape, funescape);\n        return function (elem) {\n          return elem.getAttribute('id') === attrId;\n        };\n      };\n      Expr.find.TAG = support.getElementsByTagName ? function (tag, context) {\n        if (typeof context.getElementsByTagName !== strundefined) {\n          return context.getElementsByTagName(tag);\n        }\n      } : function (tag, context) {\n        var elem, tmp = [], i = 0, results = context.getElementsByTagName(tag);\n        if (tag === '*') {\n          while (elem = results[i++]) {\n            if (elem.nodeType === 1) {\n              tmp.push(elem);\n            }\n          }\n          return tmp;\n        }\n        return results;\n      };\n      Expr.find.CLASS = support.getElementsByClassName && function (className, context) {\n        if (documentIsHTML) {\n          return context.getElementsByClassName(className);\n        }\n      };\n      rbuggyMatches = [];\n      rbuggyQSA = [];\n      support.disconnectedMatch = true;\n      rbuggyQSA = rbuggyQSA.length && new RegExp(rbuggyQSA.join('|'));\n      rbuggyMatches = rbuggyMatches.length && new RegExp(rbuggyMatches.join('|'));\n      hasCompare = rnative.test(docElem.compareDocumentPosition);\n      contains$3 = hasCompare || rnative.test(docElem.contains) ? function (a, b) {\n        var adown = a.nodeType === 9 ? a.documentElement : a, bup = b && b.parentNode;\n        return a === bup || !!(bup && bup.nodeType === 1 && (adown.contains ? adown.contains(bup) : a.compareDocumentPosition && a.compareDocumentPosition(bup) & 16));\n      } : function (a, b) {\n        if (b) {\n          while (b = b.parentNode) {\n            if (b === a) {\n              return true;\n            }\n          }\n        }\n        return false;\n      };\n      sortOrder = hasCompare ? function (a, b) {\n        if (a === b) {\n          hasDuplicate = true;\n          return 0;\n        }\n        var compare = !a.compareDocumentPosition - !b.compareDocumentPosition;\n        if (compare) {\n          return compare;\n        }\n        compare = (a.ownerDocument || a) === (b.ownerDocument || b) ? a.compareDocumentPosition(b) : 1;\n        if (compare & 1 || !support.sortDetached && b.compareDocumentPosition(a) === compare) {\n          if (a === doc || a.ownerDocument === preferredDoc && contains$3(preferredDoc, a)) {\n            return -1;\n          }\n          if (b === doc || b.ownerDocument === preferredDoc && contains$3(preferredDoc, b)) {\n            return 1;\n          }\n          return sortInput ? indexOf$2.call(sortInput, a) - indexOf$2.call(sortInput, b) : 0;\n        }\n        return compare & 4 ? -1 : 1;\n      } : function (a, b) {\n        if (a === b) {\n          hasDuplicate = true;\n          return 0;\n        }\n        var cur, i = 0, aup = a.parentNode, bup = b.parentNode, ap = [a], bp = [b];\n        if (!aup || !bup) {\n          return a === doc ? -1 : b === doc ? 1 : aup ? -1 : bup ? 1 : sortInput ? indexOf$2.call(sortInput, a) - indexOf$2.call(sortInput, b) : 0;\n        } else if (aup === bup) {\n          return siblingCheck(a, b);\n        }\n        cur = a;\n        while (cur = cur.parentNode) {\n          ap.unshift(cur);\n        }\n        cur = b;\n        while (cur = cur.parentNode) {\n          bp.unshift(cur);\n        }\n        while (ap[i] === bp[i]) {\n          i++;\n        }\n        return i ? siblingCheck(ap[i], bp[i]) : ap[i] === preferredDoc ? -1 : bp[i] === preferredDoc ? 1 : 0;\n      };\n      return doc;\n    };\n    Sizzle.matches = function (expr, elements) {\n      return Sizzle(expr, null, null, elements);\n    };\n    Sizzle.matchesSelector = function (elem, expr) {\n      if ((elem.ownerDocument || elem) !== document) {\n        setDocument(elem);\n      }\n      expr = expr.replace(rattributeQuotes, '=\\'$1\\']');\n      if (support.matchesSelector && documentIsHTML && (!rbuggyMatches || !rbuggyMatches.test(expr)) && (!rbuggyQSA || !rbuggyQSA.test(expr))) {\n        try {\n          var ret = matches.call(elem, expr);\n          if (ret || support.disconnectedMatch || elem.document && elem.document.nodeType !== 11) {\n            return ret;\n          }\n        } catch (e) {\n        }\n      }\n      return Sizzle(expr, document, null, [elem]).length > 0;\n    };\n    Sizzle.contains = function (context, elem) {\n      if ((context.ownerDocument || context) !== document) {\n        setDocument(context);\n      }\n      return contains$3(context, elem);\n    };\n    Sizzle.attr = function (elem, name) {\n      if ((elem.ownerDocument || elem) !== document) {\n        setDocument(elem);\n      }\n      var fn = Expr.attrHandle[name.toLowerCase()], val = fn && hasOwn.call(Expr.attrHandle, name.toLowerCase()) ? fn(elem, name, !documentIsHTML) : undefined;\n      return val !== undefined ? val : support.attributes || !documentIsHTML ? elem.getAttribute(name) : (val = elem.getAttributeNode(name)) && val.specified ? val.value : null;\n    };\n    Sizzle.error = function (msg) {\n      throw new Error('Syntax error, unrecognized expression: ' + msg);\n    };\n    Sizzle.uniqueSort = function (results) {\n      var elem, duplicates = [], j = 0, i = 0;\n      hasDuplicate = !support.detectDuplicates;\n      sortInput = !support.sortStable && results.slice(0);\n      results.sort(sortOrder);\n      if (hasDuplicate) {\n        while (elem = results[i++]) {\n          if (elem === results[i]) {\n            j = duplicates.push(i);\n          }\n        }\n        while (j--) {\n          results.splice(duplicates[j], 1);\n        }\n      }\n      sortInput = null;\n      return results;\n    };\n    getText = Sizzle.getText = function (elem) {\n      var node, ret = '', i = 0, nodeType = elem.nodeType;\n      if (!nodeType) {\n        while (node = elem[i++]) {\n          ret += getText(node);\n        }\n      } else if (nodeType === 1 || nodeType === 9 || nodeType === 11) {\n        if (typeof elem.textContent === 'string') {\n          return elem.textContent;\n        } else {\n          for (elem = elem.firstChild; elem; elem = elem.nextSibling) {\n            ret += getText(elem);\n          }\n        }\n      } else if (nodeType === 3 || nodeType === 4) {\n        return elem.nodeValue;\n      }\n      return ret;\n    };\n    Expr = Sizzle.selectors = {\n      cacheLength: 50,\n      createPseudo: markFunction,\n      match: matchExpr,\n      attrHandle: {},\n      find: {},\n      relative: {\n        '>': {\n          dir: 'parentNode',\n          first: true\n        },\n        ' ': { dir: 'parentNode' },\n        '+': {\n          dir: 'previousSibling',\n          first: true\n        },\n        '~': { dir: 'previousSibling' }\n      },\n      preFilter: {\n        ATTR: function (match) {\n          match[1] = match[1].replace(runescape, funescape);\n          match[3] = (match[3] || match[4] || match[5] || '').replace(runescape, funescape);\n          if (match[2] === '~=') {\n            match[3] = ' ' + match[3] + ' ';\n          }\n          return match.slice(0, 4);\n        },\n        CHILD: function (match) {\n          match[1] = match[1].toLowerCase();\n          if (match[1].slice(0, 3) === 'nth') {\n            if (!match[3]) {\n              Sizzle.error(match[0]);\n            }\n            match[4] = +(match[4] ? match[5] + (match[6] || 1) : 2 * (match[3] === 'even' || match[3] === 'odd'));\n            match[5] = +(match[7] + match[8] || match[3] === 'odd');\n          } else if (match[3]) {\n            Sizzle.error(match[0]);\n          }\n          return match;\n        },\n        PSEUDO: function (match) {\n          var excess, unquoted = !match[6] && match[2];\n          if (matchExpr.CHILD.test(match[0])) {\n            return null;\n          }\n          if (match[3]) {\n            match[2] = match[4] || match[5] || '';\n          } else if (unquoted && rpseudo.test(unquoted) && (excess = tokenize(unquoted, true)) && (excess = unquoted.indexOf(')', unquoted.length - excess) - unquoted.length)) {\n            match[0] = match[0].slice(0, excess);\n            match[2] = unquoted.slice(0, excess);\n          }\n          return match.slice(0, 3);\n        }\n      },\n      filter: {\n        TAG: function (nodeNameSelector) {\n          var nodeName = nodeNameSelector.replace(runescape, funescape).toLowerCase();\n          return nodeNameSelector === '*' ? function () {\n            return true;\n          } : function (elem) {\n            return elem.nodeName && elem.nodeName.toLowerCase() === nodeName;\n          };\n        },\n        CLASS: function (className) {\n          var pattern = classCache[className + ' '];\n          return pattern || (pattern = new RegExp('(^|' + whitespace + ')' + className + '(' + whitespace + '|$)')) && classCache(className, function (elem) {\n            return pattern.test(typeof elem.className === 'string' && elem.className || typeof elem.getAttribute !== strundefined && elem.getAttribute('class') || '');\n          });\n        },\n        ATTR: function (name, operator, check) {\n          return function (elem) {\n            var result = Sizzle.attr(elem, name);\n            if (result == null) {\n              return operator === '!=';\n            }\n            if (!operator) {\n              return true;\n            }\n            result += '';\n            return operator === '=' ? result === check : operator === '!=' ? result !== check : operator === '^=' ? check && result.indexOf(check) === 0 : operator === '*=' ? check && result.indexOf(check) > -1 : operator === '$=' ? check && result.slice(-check.length) === check : operator === '~=' ? (' ' + result + ' ').indexOf(check) > -1 : operator === '|=' ? result === check || result.slice(0, check.length + 1) === check + '-' : false;\n          };\n        },\n        CHILD: function (type, what, argument, first, last) {\n          var simple = type.slice(0, 3) !== 'nth', forward = type.slice(-4) !== 'last', ofType = what === 'of-type';\n          return first === 1 && last === 0 ? function (elem) {\n            return !!elem.parentNode;\n          } : function (elem, context, xml) {\n            var cache, outerCache, node, diff, nodeIndex, start, dir = simple !== forward ? 'nextSibling' : 'previousSibling', parent = elem.parentNode, name = ofType && elem.nodeName.toLowerCase(), useCache = !xml && !ofType;\n            if (parent) {\n              if (simple) {\n                while (dir) {\n                  node = elem;\n                  while (node = node[dir]) {\n                    if (ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1) {\n                      return false;\n                    }\n                  }\n                  start = dir = type === 'only' && !start && 'nextSibling';\n                }\n                return true;\n              }\n              start = [forward ? parent.firstChild : parent.lastChild];\n              if (forward && useCache) {\n                outerCache = parent[expando] || (parent[expando] = {});\n                cache = outerCache[type] || [];\n                nodeIndex = cache[0] === dirruns && cache[1];\n                diff = cache[0] === dirruns && cache[2];\n                node = nodeIndex && parent.childNodes[nodeIndex];\n                while (node = ++nodeIndex && node && node[dir] || (diff = nodeIndex = 0) || start.pop()) {\n                  if (node.nodeType === 1 && ++diff && node === elem) {\n                    outerCache[type] = [\n                      dirruns,\n                      nodeIndex,\n                      diff\n                    ];\n                    break;\n                  }\n                }\n              } else if (useCache && (cache = (elem[expando] || (elem[expando] = {}))[type]) && cache[0] === dirruns) {\n                diff = cache[1];\n              } else {\n                while (node = ++nodeIndex && node && node[dir] || (diff = nodeIndex = 0) || start.pop()) {\n                  if ((ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1) && ++diff) {\n                    if (useCache) {\n                      (node[expando] || (node[expando] = {}))[type] = [\n                        dirruns,\n                        diff\n                      ];\n                    }\n                    if (node === elem) {\n                      break;\n                    }\n                  }\n                }\n              }\n              diff -= last;\n              return diff === first || diff % first === 0 && diff / first >= 0;\n            }\n          };\n        },\n        PSEUDO: function (pseudo, argument) {\n          var args, fn = Expr.pseudos[pseudo] || Expr.setFilters[pseudo.toLowerCase()] || Sizzle.error('unsupported pseudo: ' + pseudo);\n          if (fn[expando]) {\n            return fn(argument);\n          }\n          if (fn.length > 1) {\n            args = [\n              pseudo,\n              pseudo,\n              '',\n              argument\n            ];\n            return Expr.setFilters.hasOwnProperty(pseudo.toLowerCase()) ? markFunction(function (seed, matches) {\n              var idx, matched = fn(seed, argument), i = matched.length;\n              while (i--) {\n                idx = indexOf$2.call(seed, matched[i]);\n                seed[idx] = !(matches[idx] = matched[i]);\n              }\n            }) : function (elem) {\n              return fn(elem, 0, args);\n            };\n          }\n          return fn;\n        }\n      },\n      pseudos: {\n        not: markFunction(function (selector) {\n          var input = [], results = [], matcher = compile(selector.replace(rtrim, '$1'));\n          return matcher[expando] ? markFunction(function (seed, matches, context, xml) {\n            var elem, unmatched = matcher(seed, null, xml, []), i = seed.length;\n            while (i--) {\n              if (elem = unmatched[i]) {\n                seed[i] = !(matches[i] = elem);\n              }\n            }\n          }) : function (elem, context, xml) {\n            input[0] = elem;\n            matcher(input, null, xml, results);\n            return !results.pop();\n          };\n        }),\n        has: markFunction(function (selector) {\n          return function (elem) {\n            return Sizzle(selector, elem).length > 0;\n          };\n        }),\n        contains: markFunction(function (text) {\n          text = text.replace(runescape, funescape);\n          return function (elem) {\n            return (elem.textContent || elem.innerText || getText(elem)).indexOf(text) > -1;\n          };\n        }),\n        lang: markFunction(function (lang) {\n          if (!ridentifier.test(lang || '')) {\n            Sizzle.error('unsupported lang: ' + lang);\n          }\n          lang = lang.replace(runescape, funescape).toLowerCase();\n          return function (elem) {\n            var elemLang;\n            do {\n              if (elemLang = documentIsHTML ? elem.lang : elem.getAttribute('xml:lang') || elem.getAttribute('lang')) {\n                elemLang = elemLang.toLowerCase();\n                return elemLang === lang || elemLang.indexOf(lang + '-') === 0;\n              }\n            } while ((elem = elem.parentNode) && elem.nodeType === 1);\n            return false;\n          };\n        }),\n        target: function (elem) {\n          var hash = domGlobals.window.location && domGlobals.window.location.hash;\n          return hash && hash.slice(1) === elem.id;\n        },\n        root: function (elem) {\n          return elem === docElem;\n        },\n        focus: function (elem) {\n          return elem === document.activeElement && (!document.hasFocus || document.hasFocus()) && !!(elem.type || elem.href || ~elem.tabIndex);\n        },\n        enabled: function (elem) {\n          return elem.disabled === false;\n        },\n        disabled: function (elem) {\n          return elem.disabled === true;\n        },\n        checked: function (elem) {\n          var nodeName = elem.nodeName.toLowerCase();\n          return nodeName === 'input' && !!elem.checked || nodeName === 'option' && !!elem.selected;\n        },\n        selected: function (elem) {\n          if (elem.parentNode) {\n            elem.parentNode.selectedIndex;\n          }\n          return elem.selected === true;\n        },\n        empty: function (elem) {\n          for (elem = elem.firstChild; elem; elem = elem.nextSibling) {\n            if (elem.nodeType < 6) {\n              return false;\n            }\n          }\n          return true;\n        },\n        parent: function (elem) {\n          return !Expr.pseudos.empty(elem);\n        },\n        header: function (elem) {\n          return rheader.test(elem.nodeName);\n        },\n        input: function (elem) {\n          return rinputs.test(elem.nodeName);\n        },\n        button: function (elem) {\n          var name = elem.nodeName.toLowerCase();\n          return name === 'input' && elem.type === 'button' || name === 'button';\n        },\n        text: function (elem) {\n          var attr;\n          return elem.nodeName.toLowerCase() === 'input' && elem.type === 'text' && ((attr = elem.getAttribute('type')) == null || attr.toLowerCase() === 'text');\n        },\n        first: createPositionalPseudo(function () {\n          return [0];\n        }),\n        last: createPositionalPseudo(function (matchIndexes, length) {\n          return [length - 1];\n        }),\n        eq: createPositionalPseudo(function (matchIndexes, length, argument) {\n          return [argument < 0 ? argument + length : argument];\n        }),\n        even: createPositionalPseudo(function (matchIndexes, length) {\n          var i = 0;\n          for (; i < length; i += 2) {\n            matchIndexes.push(i);\n          }\n          return matchIndexes;\n        }),\n        odd: createPositionalPseudo(function (matchIndexes, length) {\n          var i = 1;\n          for (; i < length; i += 2) {\n            matchIndexes.push(i);\n          }\n          return matchIndexes;\n        }),\n        lt: createPositionalPseudo(function (matchIndexes, length, argument) {\n          var i = argument < 0 ? argument + length : argument;\n          for (; --i >= 0;) {\n            matchIndexes.push(i);\n          }\n          return matchIndexes;\n        }),\n        gt: createPositionalPseudo(function (matchIndexes, length, argument) {\n          var i = argument < 0 ? argument + length : argument;\n          for (; ++i < length;) {\n            matchIndexes.push(i);\n          }\n          return matchIndexes;\n        })\n      }\n    };\n    Expr.pseudos.nth = Expr.pseudos.eq;\n    for (i in {\n        radio: true,\n        checkbox: true,\n        file: true,\n        password: true,\n        image: true\n      }) {\n      Expr.pseudos[i] = createInputPseudo(i);\n    }\n    for (i in {\n        submit: true,\n        reset: true\n      }) {\n      Expr.pseudos[i] = createButtonPseudo(i);\n    }\n    function setFilters() {\n    }\n    setFilters.prototype = Expr.filters = Expr.pseudos;\n    Expr.setFilters = new setFilters();\n    tokenize = Sizzle.tokenize = function (selector, parseOnly) {\n      var matched, match, tokens, type, soFar, groups, preFilters, cached = tokenCache[selector + ' '];\n      if (cached) {\n        return parseOnly ? 0 : cached.slice(0);\n      }\n      soFar = selector;\n      groups = [];\n      preFilters = Expr.preFilter;\n      while (soFar) {\n        if (!matched || (match = rcomma.exec(soFar))) {\n          if (match) {\n            soFar = soFar.slice(match[0].length) || soFar;\n          }\n          groups.push(tokens = []);\n        }\n        matched = false;\n        if (match = rcombinators.exec(soFar)) {\n          matched = match.shift();\n          tokens.push({\n            value: matched,\n            type: match[0].replace(rtrim, ' ')\n          });\n          soFar = soFar.slice(matched.length);\n        }\n        for (type in Expr.filter) {\n          if (!Expr.filter.hasOwnProperty(type))\n            continue;\n          if ((match = matchExpr[type].exec(soFar)) && (!preFilters[type] || (match = preFilters[type](match)))) {\n            matched = match.shift();\n            tokens.push({\n              value: matched,\n              type: type,\n              matches: match\n            });\n            soFar = soFar.slice(matched.length);\n          }\n        }\n        if (!matched) {\n          break;\n        }\n      }\n      return parseOnly ? soFar.length : soFar ? Sizzle.error(selector) : tokenCache(selector, groups).slice(0);\n    };\n    function toSelector(tokens) {\n      var i = 0, len = tokens.length, selector = '';\n      for (; i < len; i++) {\n        selector += tokens[i].value;\n      }\n      return selector;\n    }\n    function addCombinator(matcher, combinator, base) {\n      var dir = combinator.dir, checkNonElements = base && dir === 'parentNode', doneName = done++;\n      return combinator.first ? function (elem, context, xml) {\n        while (elem = elem[dir]) {\n          if (elem.nodeType === 1 || checkNonElements) {\n            return matcher(elem, context, xml);\n          }\n        }\n      } : function (elem, context, xml) {\n        var oldCache, outerCache, newCache = [\n            dirruns,\n            doneName\n          ];\n        if (xml) {\n          while (elem = elem[dir]) {\n            if (elem.nodeType === 1 || checkNonElements) {\n              if (matcher(elem, context, xml)) {\n                return true;\n              }\n            }\n          }\n        } else {\n          while (elem = elem[dir]) {\n            if (elem.nodeType === 1 || checkNonElements) {\n              outerCache = elem[expando] || (elem[expando] = {});\n              if ((oldCache = outerCache[dir]) && oldCache[0] === dirruns && oldCache[1] === doneName) {\n                return newCache[2] = oldCache[2];\n              } else {\n                outerCache[dir] = newCache;\n                if (newCache[2] = matcher(elem, context, xml)) {\n                  return true;\n                }\n              }\n            }\n          }\n        }\n      };\n    }\n    function elementMatcher(matchers) {\n      return matchers.length > 1 ? function (elem, context, xml) {\n        var i = matchers.length;\n        while (i--) {\n          if (!matchers[i](elem, context, xml)) {\n            return false;\n          }\n        }\n        return true;\n      } : matchers[0];\n    }\n    function multipleContexts(selector, contexts, results) {\n      var i = 0, len = contexts.length;\n      for (; i < len; i++) {\n        Sizzle(selector, contexts[i], results);\n      }\n      return results;\n    }\n    function condense(unmatched, map, filter, context, xml) {\n      var elem, newUnmatched = [], i = 0, len = unmatched.length, mapped = map != null;\n      for (; i < len; i++) {\n        if (elem = unmatched[i]) {\n          if (!filter || filter(elem, context, xml)) {\n            newUnmatched.push(elem);\n            if (mapped) {\n              map.push(i);\n            }\n          }\n        }\n      }\n      return newUnmatched;\n    }\n    function setMatcher(preFilter, selector, matcher, postFilter, postFinder, postSelector) {\n      if (postFilter && !postFilter[expando]) {\n        postFilter = setMatcher(postFilter);\n      }\n      if (postFinder && !postFinder[expando]) {\n        postFinder = setMatcher(postFinder, postSelector);\n      }\n      return markFunction(function (seed, results, context, xml) {\n        var temp, i, elem, preMap = [], postMap = [], preexisting = results.length, elems = seed || multipleContexts(selector || '*', context.nodeType ? [context] : context, []), matcherIn = preFilter && (seed || !selector) ? condense(elems, preMap, preFilter, context, xml) : elems, matcherOut = matcher ? postFinder || (seed ? preFilter : preexisting || postFilter) ? [] : results : matcherIn;\n        if (matcher) {\n          matcher(matcherIn, matcherOut, context, xml);\n        }\n        if (postFilter) {\n          temp = condense(matcherOut, postMap);\n          postFilter(temp, [], context, xml);\n          i = temp.length;\n          while (i--) {\n            if (elem = temp[i]) {\n              matcherOut[postMap[i]] = !(matcherIn[postMap[i]] = elem);\n            }\n          }\n        }\n        if (seed) {\n          if (postFinder || preFilter) {\n            if (postFinder) {\n              temp = [];\n              i = matcherOut.length;\n              while (i--) {\n                if (elem = matcherOut[i]) {\n                  temp.push(matcherIn[i] = elem);\n                }\n              }\n              postFinder(null, matcherOut = [], temp, xml);\n            }\n            i = matcherOut.length;\n            while (i--) {\n              if ((elem = matcherOut[i]) && (temp = postFinder ? indexOf$2.call(seed, elem) : preMap[i]) > -1) {\n                seed[temp] = !(results[temp] = elem);\n              }\n            }\n          }\n        } else {\n          matcherOut = condense(matcherOut === results ? matcherOut.splice(preexisting, matcherOut.length) : matcherOut);\n          if (postFinder) {\n            postFinder(null, results, matcherOut, xml);\n          } else {\n            push.apply(results, matcherOut);\n          }\n        }\n      });\n    }\n    function matcherFromTokens(tokens) {\n      var checkContext, matcher, j, len = tokens.length, leadingRelative = Expr.relative[tokens[0].type], implicitRelative = leadingRelative || Expr.relative[' '], i = leadingRelative ? 1 : 0, matchContext = addCombinator(function (elem) {\n          return elem === checkContext;\n        }, implicitRelative, true), matchAnyContext = addCombinator(function (elem) {\n          return indexOf$2.call(checkContext, elem) > -1;\n        }, implicitRelative, true), matchers = [function (elem, context, xml) {\n            return !leadingRelative && (xml || context !== outermostContext) || ((checkContext = context).nodeType ? matchContext(elem, context, xml) : matchAnyContext(elem, context, xml));\n          }];\n      for (; i < len; i++) {\n        if (matcher = Expr.relative[tokens[i].type]) {\n          matchers = [addCombinator(elementMatcher(matchers), matcher)];\n        } else {\n          matcher = Expr.filter[tokens[i].type].apply(null, tokens[i].matches);\n          if (matcher[expando]) {\n            j = ++i;\n            for (; j < len; j++) {\n              if (Expr.relative[tokens[j].type]) {\n                break;\n              }\n            }\n            return setMatcher(i > 1 && elementMatcher(matchers), i > 1 && toSelector(tokens.slice(0, i - 1).concat({ value: tokens[i - 2].type === ' ' ? '*' : '' })).replace(rtrim, '$1'), matcher, i < j && matcherFromTokens(tokens.slice(i, j)), j < len && matcherFromTokens(tokens = tokens.slice(j)), j < len && toSelector(tokens));\n          }\n          matchers.push(matcher);\n        }\n      }\n      return elementMatcher(matchers);\n    }\n    function matcherFromGroupMatchers(elementMatchers, setMatchers) {\n      var bySet = setMatchers.length > 0, byElement = elementMatchers.length > 0, superMatcher = function (seed, context, xml, results, outermost) {\n          var elem, j, matcher, matchedCount = 0, i = '0', unmatched = seed && [], setMatched = [], contextBackup = outermostContext, elems = seed || byElement && Expr.find.TAG('*', outermost), dirrunsUnique = dirruns += contextBackup == null ? 1 : Math.random() || 0.1, len = elems.length;\n          if (outermost) {\n            outermostContext = context !== document && context;\n          }\n          for (; i !== len && (elem = elems[i]) != null; i++) {\n            if (byElement && elem) {\n              j = 0;\n              while (matcher = elementMatchers[j++]) {\n                if (matcher(elem, context, xml)) {\n                  results.push(elem);\n                  break;\n                }\n              }\n              if (outermost) {\n                dirruns = dirrunsUnique;\n              }\n            }\n            if (bySet) {\n              if (elem = !matcher && elem) {\n                matchedCount--;\n              }\n              if (seed) {\n                unmatched.push(elem);\n              }\n            }\n          }\n          matchedCount += i;\n          if (bySet && i !== matchedCount) {\n            j = 0;\n            while (matcher = setMatchers[j++]) {\n              matcher(unmatched, setMatched, context, xml);\n            }\n            if (seed) {\n              if (matchedCount > 0) {\n                while (i--) {\n                  if (!(unmatched[i] || setMatched[i])) {\n                    setMatched[i] = pop.call(results);\n                  }\n                }\n              }\n              setMatched = condense(setMatched);\n            }\n            push.apply(results, setMatched);\n            if (outermost && !seed && setMatched.length > 0 && matchedCount + setMatchers.length > 1) {\n              Sizzle.uniqueSort(results);\n            }\n          }\n          if (outermost) {\n            dirruns = dirrunsUnique;\n            outermostContext = contextBackup;\n          }\n          return unmatched;\n        };\n      return bySet ? markFunction(superMatcher) : superMatcher;\n    }\n    compile = Sizzle.compile = function (selector, match) {\n      var i, setMatchers = [], elementMatchers = [], cached = compilerCache[selector + ' '];\n      if (!cached) {\n        if (!match) {\n          match = tokenize(selector);\n        }\n        i = match.length;\n        while (i--) {\n          cached = matcherFromTokens(match[i]);\n          if (cached[expando]) {\n            setMatchers.push(cached);\n          } else {\n            elementMatchers.push(cached);\n          }\n        }\n        cached = compilerCache(selector, matcherFromGroupMatchers(elementMatchers, setMatchers));\n        cached.selector = selector;\n      }\n      return cached;\n    };\n    select = Sizzle.select = function (selector, context, results, seed) {\n      var i, tokens, token, type, find, compiled = typeof selector === 'function' && selector, match = !seed && tokenize(selector = compiled.selector || selector);\n      results = results || [];\n      if (match.length === 1) {\n        tokens = match[0] = match[0].slice(0);\n        if (tokens.length > 2 && (token = tokens[0]).type === 'ID' && support.getById && context.nodeType === 9 && documentIsHTML && Expr.relative[tokens[1].type]) {\n          context = (Expr.find.ID(token.matches[0].replace(runescape, funescape), context) || [])[0];\n          if (!context) {\n            return results;\n          } else if (compiled) {\n            context = context.parentNode;\n          }\n          selector = selector.slice(tokens.shift().value.length);\n        }\n        i = matchExpr.needsContext.test(selector) ? 0 : tokens.length;\n        while (i--) {\n          token = tokens[i];\n          if (Expr.relative[type = token.type]) {\n            break;\n          }\n          if (find = Expr.find[type]) {\n            if (seed = find(token.matches[0].replace(runescape, funescape), rsibling.test(tokens[0].type) && testContext(context.parentNode) || context)) {\n              tokens.splice(i, 1);\n              selector = seed.length && toSelector(tokens);\n              if (!selector) {\n                push.apply(results, seed);\n                return results;\n              }\n              break;\n            }\n          }\n        }\n      }\n      (compiled || compile(selector, match))(seed, context, !documentIsHTML, results, rsibling.test(selector) && testContext(context.parentNode) || context);\n      return results;\n    };\n    support.sortStable = expando.split('').sort(sortOrder).join('') === expando;\n    support.detectDuplicates = !!hasDuplicate;\n    setDocument();\n    support.sortDetached = true;\n\n    var doc = domGlobals.document, push$1 = Array.prototype.push, slice$1 = Array.prototype.slice;\n    var rquickExpr$1 = /^(?:[^#<]*(<[\\w\\W]+>)[^>]*$|#([\\w\\-]*)$)/;\n    var Event = EventUtils.Event;\n    var skipUniques = Tools.makeMap('children,contents,next,prev');\n    var isDefined = function (obj) {\n      return typeof obj !== 'undefined';\n    };\n    var isString$1 = function (obj) {\n      return typeof obj === 'string';\n    };\n    var isWindow = function (obj) {\n      return obj && obj === obj.window;\n    };\n    var createFragment = function (html, fragDoc) {\n      var frag, node, container;\n      fragDoc = fragDoc || doc;\n      container = fragDoc.createElement('div');\n      frag = fragDoc.createDocumentFragment();\n      container.innerHTML = html;\n      while (node = container.firstChild) {\n        frag.appendChild(node);\n      }\n      return frag;\n    };\n    var domManipulate = function (targetNodes, sourceItem, callback, reverse) {\n      var i;\n      if (isString$1(sourceItem)) {\n        sourceItem = createFragment(sourceItem, getElementDocument(targetNodes[0]));\n      } else if (sourceItem.length && !sourceItem.nodeType) {\n        sourceItem = DomQuery.makeArray(sourceItem);\n        if (reverse) {\n          for (i = sourceItem.length - 1; i >= 0; i--) {\n            domManipulate(targetNodes, sourceItem[i], callback, reverse);\n          }\n        } else {\n          for (i = 0; i < sourceItem.length; i++) {\n            domManipulate(targetNodes, sourceItem[i], callback, reverse);\n          }\n        }\n        return targetNodes;\n      }\n      if (sourceItem.nodeType) {\n        i = targetNodes.length;\n        while (i--) {\n          callback.call(targetNodes[i], sourceItem);\n        }\n      }\n      return targetNodes;\n    };\n    var hasClass = function (node, className) {\n      return node && className && (' ' + node.className + ' ').indexOf(' ' + className + ' ') !== -1;\n    };\n    var wrap$1 = function (elements, wrapper, all) {\n      var lastParent, newWrapper;\n      wrapper = DomQuery(wrapper)[0];\n      elements.each(function () {\n        var self = this;\n        if (!all || lastParent !== self.parentNode) {\n          lastParent = self.parentNode;\n          newWrapper = wrapper.cloneNode(false);\n          self.parentNode.insertBefore(newWrapper, self);\n          newWrapper.appendChild(self);\n        } else {\n          newWrapper.appendChild(self);\n        }\n      });\n      return elements;\n    };\n    var numericCssMap = Tools.makeMap('fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom', ' ');\n    var booleanMap = Tools.makeMap('checked compact declare defer disabled ismap multiple nohref noshade nowrap readonly selected', ' ');\n    var propFix = {\n      for: 'htmlFor',\n      class: 'className',\n      readonly: 'readOnly'\n    };\n    var cssFix = { float: 'cssFloat' };\n    var attrHooks = {}, cssHooks = {};\n    var DomQueryConstructor = function (selector, context) {\n      return new DomQuery.fn.init(selector, context);\n    };\n    var inArray$1 = function (item, array) {\n      var i;\n      if (array.indexOf) {\n        return array.indexOf(item);\n      }\n      i = array.length;\n      while (i--) {\n        if (array[i] === item) {\n          return i;\n        }\n      }\n      return -1;\n    };\n    var whiteSpaceRegExp$1 = /^\\s*|\\s*$/g;\n    var trim$2 = function (str) {\n      return str === null || str === undefined ? '' : ('' + str).replace(whiteSpaceRegExp$1, '');\n    };\n    var each$4 = function (obj, callback) {\n      var length, key, i, value;\n      if (obj) {\n        length = obj.length;\n        if (length === undefined) {\n          for (key in obj) {\n            if (obj.hasOwnProperty(key)) {\n              value = obj[key];\n              if (callback.call(value, key, value) === false) {\n                break;\n              }\n            }\n          }\n        } else {\n          for (i = 0; i < length; i++) {\n            value = obj[i];\n            if (callback.call(value, i, value) === false) {\n              break;\n            }\n          }\n        }\n      }\n      return obj;\n    };\n    var grep = function (array, callback) {\n      var out = [];\n      each$4(array, function (i, item) {\n        if (callback(item, i)) {\n          out.push(item);\n        }\n      });\n      return out;\n    };\n    var getElementDocument = function (element) {\n      if (!element) {\n        return doc;\n      }\n      if (element.nodeType === 9) {\n        return element;\n      }\n      return element.ownerDocument;\n    };\n    DomQueryConstructor.fn = DomQueryConstructor.prototype = {\n      constructor: DomQueryConstructor,\n      selector: '',\n      context: null,\n      length: 0,\n      init: function (selector, context) {\n        var self = this;\n        var match, node;\n        if (!selector) {\n          return self;\n        }\n        if (selector.nodeType) {\n          self.context = self[0] = selector;\n          self.length = 1;\n          return self;\n        }\n        if (context && context.nodeType) {\n          self.context = context;\n        } else {\n          if (context) {\n            return DomQuery(selector).attr(context);\n          }\n          self.context = context = domGlobals.document;\n        }\n        if (isString$1(selector)) {\n          self.selector = selector;\n          if (selector.charAt(0) === '<' && selector.charAt(selector.length - 1) === '>' && selector.length >= 3) {\n            match = [\n              null,\n              selector,\n              null\n            ];\n          } else {\n            match = rquickExpr$1.exec(selector);\n          }\n          if (match) {\n            if (match[1]) {\n              node = createFragment(selector, getElementDocument(context)).firstChild;\n              while (node) {\n                push$1.call(self, node);\n                node = node.nextSibling;\n              }\n            } else {\n              node = getElementDocument(context).getElementById(match[2]);\n              if (!node) {\n                return self;\n              }\n              if (node.id !== match[2]) {\n                return self.find(selector);\n              }\n              self.length = 1;\n              self[0] = node;\n            }\n          } else {\n            return DomQuery(context).find(selector);\n          }\n        } else {\n          this.add(selector, false);\n        }\n        return self;\n      },\n      toArray: function () {\n        return Tools.toArray(this);\n      },\n      add: function (items, sort) {\n        var self = this;\n        var nodes, i;\n        if (isString$1(items)) {\n          return self.add(DomQuery(items));\n        }\n        if (sort !== false) {\n          nodes = DomQuery.unique(self.toArray().concat(DomQuery.makeArray(items)));\n          self.length = nodes.length;\n          for (i = 0; i < nodes.length; i++) {\n            self[i] = nodes[i];\n          }\n        } else {\n          push$1.apply(self, DomQuery.makeArray(items));\n        }\n        return self;\n      },\n      attr: function (name, value) {\n        var self = this;\n        var hook;\n        if (typeof name === 'object') {\n          each$4(name, function (name, value) {\n            self.attr(name, value);\n          });\n        } else if (isDefined(value)) {\n          this.each(function () {\n            var hook;\n            if (this.nodeType === 1) {\n              hook = attrHooks[name];\n              if (hook && hook.set) {\n                hook.set(this, value);\n                return;\n              }\n              if (value === null) {\n                this.removeAttribute(name, 2);\n              } else {\n                this.setAttribute(name, value, 2);\n              }\n            }\n          });\n        } else {\n          if (self[0] && self[0].nodeType === 1) {\n            hook = attrHooks[name];\n            if (hook && hook.get) {\n              return hook.get(self[0], name);\n            }\n            if (booleanMap[name]) {\n              return self.prop(name) ? name : undefined;\n            }\n            value = self[0].getAttribute(name, 2);\n            if (value === null) {\n              value = undefined;\n            }\n          }\n          return value;\n        }\n        return self;\n      },\n      removeAttr: function (name) {\n        return this.attr(name, null);\n      },\n      prop: function (name, value) {\n        var self = this;\n        name = propFix[name] || name;\n        if (typeof name === 'object') {\n          each$4(name, function (name, value) {\n            self.prop(name, value);\n          });\n        } else if (isDefined(value)) {\n          this.each(function () {\n            if (this.nodeType === 1) {\n              this[name] = value;\n            }\n          });\n        } else {\n          if (self[0] && self[0].nodeType && name in self[0]) {\n            return self[0][name];\n          }\n          return value;\n        }\n        return self;\n      },\n      css: function (name, value) {\n        var self = this;\n        var elm, hook;\n        var camel = function (name) {\n          return name.replace(/-(\\D)/g, function (a, b) {\n            return b.toUpperCase();\n          });\n        };\n        var dashed = function (name) {\n          return name.replace(/[A-Z]/g, function (a) {\n            return '-' + a;\n          });\n        };\n        if (typeof name === 'object') {\n          each$4(name, function (name, value) {\n            self.css(name, value);\n          });\n        } else {\n          if (isDefined(value)) {\n            name = camel(name);\n            if (typeof value === 'number' && !numericCssMap[name]) {\n              value = value.toString() + 'px';\n            }\n            self.each(function () {\n              var style = this.style;\n              hook = cssHooks[name];\n              if (hook && hook.set) {\n                hook.set(this, value);\n                return;\n              }\n              try {\n                this.style[cssFix[name] || name] = value;\n              } catch (ex) {\n              }\n              if (value === null || value === '') {\n                if (style.removeProperty) {\n                  style.removeProperty(dashed(name));\n                } else {\n                  style.removeAttribute(name);\n                }\n              }\n            });\n          } else {\n            elm = self[0];\n            hook = cssHooks[name];\n            if (hook && hook.get) {\n              return hook.get(elm);\n            }\n            if (elm.ownerDocument.defaultView) {\n              try {\n                return elm.ownerDocument.defaultView.getComputedStyle(elm, null).getPropertyValue(dashed(name));\n              } catch (ex) {\n                return undefined;\n              }\n            } else if (elm.currentStyle) {\n              return elm.currentStyle[camel(name)];\n            } else {\n              return '';\n            }\n          }\n        }\n        return self;\n      },\n      remove: function () {\n        var self = this;\n        var node, i = this.length;\n        while (i--) {\n          node = self[i];\n          Event.clean(node);\n          if (node.parentNode) {\n            node.parentNode.removeChild(node);\n          }\n        }\n        return this;\n      },\n      empty: function () {\n        var self = this;\n        var node, i = this.length;\n        while (i--) {\n          node = self[i];\n          while (node.firstChild) {\n            node.removeChild(node.firstChild);\n          }\n        }\n        return this;\n      },\n      html: function (value) {\n        var self = this;\n        var i;\n        if (isDefined(value)) {\n          i = self.length;\n          try {\n            while (i--) {\n              self[i].innerHTML = value;\n            }\n          } catch (ex) {\n            DomQuery(self[i]).empty().append(value);\n          }\n          return self;\n        }\n        return self[0] ? self[0].innerHTML : '';\n      },\n      text: function (value) {\n        var self = this;\n        var i;\n        if (isDefined(value)) {\n          i = self.length;\n          while (i--) {\n            if ('innerText' in self[i]) {\n              self[i].innerText = value;\n            } else {\n              self[0].textContent = value;\n            }\n          }\n          return self;\n        }\n        return self[0] ? self[0].innerText || self[0].textContent : '';\n      },\n      append: function () {\n        return domManipulate(this, arguments, function (node) {\n          if (this.nodeType === 1 || this.host && this.host.nodeType === 1) {\n            this.appendChild(node);\n          }\n        });\n      },\n      prepend: function () {\n        return domManipulate(this, arguments, function (node) {\n          if (this.nodeType === 1 || this.host && this.host.nodeType === 1) {\n            this.insertBefore(node, this.firstChild);\n          }\n        }, true);\n      },\n      before: function () {\n        var self = this;\n        if (self[0] && self[0].parentNode) {\n          return domManipulate(self, arguments, function (node) {\n            this.parentNode.insertBefore(node, this);\n          });\n        }\n        return self;\n      },\n      after: function () {\n        var self = this;\n        if (self[0] && self[0].parentNode) {\n          return domManipulate(self, arguments, function (node) {\n            this.parentNode.insertBefore(node, this.nextSibling);\n          }, true);\n        }\n        return self;\n      },\n      appendTo: function (val) {\n        DomQuery(val).append(this);\n        return this;\n      },\n      prependTo: function (val) {\n        DomQuery(val).prepend(this);\n        return this;\n      },\n      replaceWith: function (content) {\n        return this.before(content).remove();\n      },\n      wrap: function (content) {\n        return wrap$1(this, content);\n      },\n      wrapAll: function (content) {\n        return wrap$1(this, content, true);\n      },\n      wrapInner: function (content) {\n        this.each(function () {\n          DomQuery(this).contents().wrapAll(content);\n        });\n        return this;\n      },\n      unwrap: function () {\n        return this.parent().each(function () {\n          DomQuery(this).replaceWith(this.childNodes);\n        });\n      },\n      clone: function () {\n        var result = [];\n        this.each(function () {\n          result.push(this.cloneNode(true));\n        });\n        return DomQuery(result);\n      },\n      addClass: function (className) {\n        return this.toggleClass(className, true);\n      },\n      removeClass: function (className) {\n        return this.toggleClass(className, false);\n      },\n      toggleClass: function (className, state) {\n        var self = this;\n        if (typeof className !== 'string') {\n          return self;\n        }\n        if (className.indexOf(' ') !== -1) {\n          each$4(className.split(' '), function () {\n            self.toggleClass(this, state);\n          });\n        } else {\n          self.each(function (index, node) {\n            var existingClassName, classState;\n            classState = hasClass(node, className);\n            if (classState !== state) {\n              existingClassName = node.className;\n              if (classState) {\n                node.className = trim$2((' ' + existingClassName + ' ').replace(' ' + className + ' ', ' '));\n              } else {\n                node.className += existingClassName ? ' ' + className : className;\n              }\n            }\n          });\n        }\n        return self;\n      },\n      hasClass: function (className) {\n        return hasClass(this[0], className);\n      },\n      each: function (callback) {\n        return each$4(this, callback);\n      },\n      on: function (name, callback) {\n        return this.each(function () {\n          Event.bind(this, name, callback);\n        });\n      },\n      off: function (name, callback) {\n        return this.each(function () {\n          Event.unbind(this, name, callback);\n        });\n      },\n      trigger: function (name) {\n        return this.each(function () {\n          if (typeof name === 'object') {\n            Event.fire(this, name.type, name);\n          } else {\n            Event.fire(this, name);\n          }\n        });\n      },\n      show: function () {\n        return this.css('display', '');\n      },\n      hide: function () {\n        return this.css('display', 'none');\n      },\n      slice: function () {\n        return new DomQuery(slice$1.apply(this, arguments));\n      },\n      eq: function (index) {\n        return index === -1 ? this.slice(index) : this.slice(index, +index + 1);\n      },\n      first: function () {\n        return this.eq(0);\n      },\n      last: function () {\n        return this.eq(-1);\n      },\n      find: function (selector) {\n        var i, l;\n        var ret = [];\n        for (i = 0, l = this.length; i < l; i++) {\n          DomQuery.find(selector, this[i], ret);\n        }\n        return DomQuery(ret);\n      },\n      filter: function (selector) {\n        if (typeof selector === 'function') {\n          return DomQuery(grep(this.toArray(), function (item, i) {\n            return selector(i, item);\n          }));\n        }\n        return DomQuery(DomQuery.filter(selector, this.toArray()));\n      },\n      closest: function (selector) {\n        var result = [];\n        if (selector instanceof DomQuery) {\n          selector = selector[0];\n        }\n        this.each(function (i, node) {\n          while (node) {\n            if (typeof selector === 'string' && DomQuery(node).is(selector)) {\n              result.push(node);\n              break;\n            } else if (node === selector) {\n              result.push(node);\n              break;\n            }\n            node = node.parentNode;\n          }\n        });\n        return DomQuery(result);\n      },\n      offset: function (offset) {\n        var elm, doc, docElm;\n        var x = 0, y = 0, pos;\n        if (!offset) {\n          elm = this[0];\n          if (elm) {\n            doc = elm.ownerDocument;\n            docElm = doc.documentElement;\n            if (elm.getBoundingClientRect) {\n              pos = elm.getBoundingClientRect();\n              x = pos.left + (docElm.scrollLeft || doc.body.scrollLeft) - docElm.clientLeft;\n              y = pos.top + (docElm.scrollTop || doc.body.scrollTop) - docElm.clientTop;\n            }\n          }\n          return {\n            left: x,\n            top: y\n          };\n        }\n        return this.css(offset);\n      },\n      push: push$1,\n      sort: Array.prototype.sort,\n      splice: Array.prototype.splice\n    };\n    Tools.extend(DomQueryConstructor, {\n      extend: Tools.extend,\n      makeArray: function (object) {\n        if (isWindow(object) || object.nodeType) {\n          return [object];\n        }\n        return Tools.toArray(object);\n      },\n      inArray: inArray$1,\n      isArray: Tools.isArray,\n      each: each$4,\n      trim: trim$2,\n      grep: grep,\n      find: Sizzle,\n      expr: Sizzle.selectors,\n      unique: Sizzle.uniqueSort,\n      text: Sizzle.getText,\n      contains: Sizzle.contains,\n      filter: function (expr, elems, not) {\n        var i = elems.length;\n        if (not) {\n          expr = ':not(' + expr + ')';\n        }\n        while (i--) {\n          if (elems[i].nodeType !== 1) {\n            elems.splice(i, 1);\n          }\n        }\n        if (elems.length === 1) {\n          elems = DomQuery.find.matchesSelector(elems[0], expr) ? [elems[0]] : [];\n        } else {\n          elems = DomQuery.find.matches(expr, elems);\n        }\n        return elems;\n      }\n    });\n    var dir = function (el, prop, until) {\n      var matched = [];\n      var cur = el[prop];\n      if (typeof until !== 'string' && until instanceof DomQuery) {\n        until = until[0];\n      }\n      while (cur && cur.nodeType !== 9) {\n        if (until !== undefined) {\n          if (cur === until) {\n            break;\n          }\n          if (typeof until === 'string' && DomQuery(cur).is(until)) {\n            break;\n          }\n        }\n        if (cur.nodeType === 1) {\n          matched.push(cur);\n        }\n        cur = cur[prop];\n      }\n      return matched;\n    };\n    var sibling = function (node, siblingName, nodeType, until) {\n      var result = [];\n      if (until instanceof DomQuery) {\n        until = until[0];\n      }\n      for (; node; node = node[siblingName]) {\n        if (nodeType && node.nodeType !== nodeType) {\n          continue;\n        }\n        if (until !== undefined) {\n          if (node === until) {\n            break;\n          }\n          if (typeof until === 'string' && DomQuery(node).is(until)) {\n            break;\n          }\n        }\n        result.push(node);\n      }\n      return result;\n    };\n    var firstSibling = function (node, siblingName, nodeType) {\n      for (node = node[siblingName]; node; node = node[siblingName]) {\n        if (node.nodeType === nodeType) {\n          return node;\n        }\n      }\n      return null;\n    };\n    each$4({\n      parent: function (node) {\n        var parent = node.parentNode;\n        return parent && parent.nodeType !== 11 ? parent : null;\n      },\n      parents: function (node) {\n        return dir(node, 'parentNode');\n      },\n      next: function (node) {\n        return firstSibling(node, 'nextSibling', 1);\n      },\n      prev: function (node) {\n        return firstSibling(node, 'previousSibling', 1);\n      },\n      children: function (node) {\n        return sibling(node.firstChild, 'nextSibling', 1);\n      },\n      contents: function (node) {\n        return Tools.toArray((node.nodeName === 'iframe' ? node.contentDocument || node.contentWindow.document : node).childNodes);\n      }\n    }, function (name, fn) {\n      DomQueryConstructor.fn[name] = function (selector) {\n        var self = this;\n        var result = [];\n        self.each(function () {\n          var nodes = fn.call(result, this, selector, result);\n          if (nodes) {\n            if (DomQuery.isArray(nodes)) {\n              result.push.apply(result, nodes);\n            } else {\n              result.push(nodes);\n            }\n          }\n        });\n        if (this.length > 1) {\n          if (!skipUniques[name]) {\n            result = DomQuery.unique(result);\n          }\n          if (name.indexOf('parents') === 0) {\n            result = result.reverse();\n          }\n        }\n        var wrappedResult = DomQuery(result);\n        if (selector) {\n          return wrappedResult.filter(selector);\n        }\n        return wrappedResult;\n      };\n    });\n    each$4({\n      parentsUntil: function (node, until) {\n        return dir(node, 'parentNode', until);\n      },\n      nextUntil: function (node, until) {\n        return sibling(node, 'nextSibling', 1, until).slice(1);\n      },\n      prevUntil: function (node, until) {\n        return sibling(node, 'previousSibling', 1, until).slice(1);\n      }\n    }, function (name, fn) {\n      DomQueryConstructor.fn[name] = function (selector, filter) {\n        var self = this;\n        var result = [];\n        self.each(function () {\n          var nodes = fn.call(result, this, selector, result);\n          if (nodes) {\n            if (DomQuery.isArray(nodes)) {\n              result.push.apply(result, nodes);\n            } else {\n              result.push(nodes);\n            }\n          }\n        });\n        if (this.length > 1) {\n          result = DomQuery.unique(result);\n          if (name.indexOf('parents') === 0 || name === 'prevUntil') {\n            result = result.reverse();\n          }\n        }\n        var wrappedResult = DomQuery(result);\n        if (filter) {\n          return wrappedResult.filter(filter);\n        }\n        return wrappedResult;\n      };\n    });\n    DomQueryConstructor.fn.is = function (selector) {\n      return !!selector && this.filter(selector).length > 0;\n    };\n    DomQueryConstructor.fn.init.prototype = DomQueryConstructor.fn;\n    DomQueryConstructor.overrideDefaults = function (callback) {\n      var defaults;\n      var sub = function (selector, context) {\n        defaults = defaults || callback();\n        if (arguments.length === 0) {\n          selector = defaults.element;\n        }\n        if (!context) {\n          context = defaults.context;\n        }\n        return new sub.fn.init(selector, context);\n      };\n      DomQuery.extend(sub, this);\n      return sub;\n    };\n    DomQueryConstructor.attrHooks = attrHooks;\n    DomQueryConstructor.cssHooks = cssHooks;\n    var DomQuery = DomQueryConstructor;\n\n    var TreeWalker = function () {\n      function TreeWalker(startNode, rootNode) {\n        this.node = startNode;\n        this.rootNode = rootNode;\n        this.current = this.current.bind(this);\n        this.next = this.next.bind(this);\n        this.prev = this.prev.bind(this);\n        this.prev2 = this.prev2.bind(this);\n      }\n      TreeWalker.prototype.current = function () {\n        return this.node;\n      };\n      TreeWalker.prototype.next = function (shallow) {\n        this.node = this.findSibling(this.node, 'firstChild', 'nextSibling', shallow);\n        return this.node;\n      };\n      TreeWalker.prototype.prev = function (shallow) {\n        this.node = this.findSibling(this.node, 'lastChild', 'previousSibling', shallow);\n        return this.node;\n      };\n      TreeWalker.prototype.prev2 = function (shallow) {\n        this.node = this.findPreviousNode(this.node, 'lastChild', 'previousSibling', shallow);\n        return this.node;\n      };\n      TreeWalker.prototype.findSibling = function (node, startName, siblingName, shallow) {\n        var sibling, parent;\n        if (node) {\n          if (!shallow && node[startName]) {\n            return node[startName];\n          }\n          if (node !== this.rootNode) {\n            sibling = node[siblingName];\n            if (sibling) {\n              return sibling;\n            }\n            for (parent = node.parentNode; parent && parent !== this.rootNode; parent = parent.parentNode) {\n              sibling = parent[siblingName];\n              if (sibling) {\n                return sibling;\n              }\n            }\n          }\n        }\n      };\n      TreeWalker.prototype.findPreviousNode = function (node, startName, siblingName, shallow) {\n        var sibling, parent, child;\n        if (node) {\n          sibling = node[siblingName];\n          if (this.rootNode && sibling === this.rootNode) {\n            return;\n          }\n          if (sibling) {\n            if (!shallow) {\n              for (child = sibling[startName]; child; child = child[startName]) {\n                if (!child[startName]) {\n                  return child;\n                }\n              }\n            }\n            return sibling;\n          }\n          parent = node.parentNode;\n          if (parent && parent !== this.rootNode) {\n            return parent;\n          }\n        }\n      };\n      return TreeWalker;\n    }();\n\n    var each$5 = Tools.each;\n    var grep$1 = Tools.grep;\n    var isIE = Env.ie;\n    var simpleSelectorRe = /^([a-z0-9],?)+$/i;\n    var whiteSpaceRegExp$2 = /^[ \\t\\r\\n]*$/;\n    var setupAttrHooks = function (styles, settings, getContext) {\n      var keepValues = settings.keep_values;\n      var keepUrlHook = {\n        set: function ($elm, value, name) {\n          if (settings.url_converter) {\n            value = settings.url_converter.call(settings.url_converter_scope || getContext(), value, name, $elm[0]);\n          }\n          $elm.attr('data-mce-' + name, value).attr(name, value);\n        },\n        get: function ($elm, name) {\n          return $elm.attr('data-mce-' + name) || $elm.attr(name);\n        }\n      };\n      var attrHooks = {\n        style: {\n          set: function ($elm, value) {\n            if (value !== null && typeof value === 'object') {\n              $elm.css(value);\n              return;\n            }\n            if (keepValues) {\n              $elm.attr('data-mce-style', value);\n            }\n            if (value !== null && typeof value === 'string') {\n              $elm.removeAttr('style');\n              $elm.css(styles.parse(value));\n            } else {\n              $elm.attr('style', value);\n            }\n          },\n          get: function ($elm) {\n            var value = $elm.attr('data-mce-style') || $elm.attr('style');\n            value = styles.serialize(styles.parse(value), $elm[0].nodeName);\n            return value;\n          }\n        }\n      };\n      if (keepValues) {\n        attrHooks.href = attrHooks.src = keepUrlHook;\n      }\n      return attrHooks;\n    };\n    var updateInternalStyleAttr = function (styles, $elm) {\n      var rawValue = $elm.attr('style');\n      var value = styles.serialize(styles.parse(rawValue), $elm[0].nodeName);\n      if (!value) {\n        value = null;\n      }\n      $elm.attr('data-mce-style', value);\n    };\n    var findNodeIndex = function (node, normalized) {\n      var idx = 0, lastNodeType, nodeType;\n      if (node) {\n        for (lastNodeType = node.nodeType, node = node.previousSibling; node; node = node.previousSibling) {\n          nodeType = node.nodeType;\n          if (normalized && nodeType === 3) {\n            if (nodeType === lastNodeType || !node.nodeValue.length) {\n              continue;\n            }\n          }\n          idx++;\n          lastNodeType = nodeType;\n        }\n      }\n      return idx;\n    };\n    function DOMUtils(doc, settings) {\n      var _this = this;\n      if (settings === void 0) {\n        settings = {};\n      }\n      var attrHooks;\n      var addedStyles = {};\n      var win = domGlobals.window;\n      var files = {};\n      var counter = 0;\n      var stdMode = true;\n      var boxModel = true;\n      var styleSheetLoader = StyleSheetLoader(doc, {\n        contentCssCors: settings.contentCssCors,\n        referrerPolicy: settings.referrerPolicy\n      });\n      var boundEvents = [];\n      var schema = settings.schema ? settings.schema : Schema({});\n      var styles = Styles({\n        url_converter: settings.url_converter,\n        url_converter_scope: settings.url_converter_scope\n      }, settings.schema);\n      var events = settings.ownEvents ? new EventUtils() : EventUtils.Event;\n      var blockElementsMap = schema.getBlockElements();\n      var $ = DomQuery.overrideDefaults(function () {\n        return {\n          context: doc,\n          element: self.getRoot()\n        };\n      });\n      var isBlock = function (node) {\n        if (typeof node === 'string') {\n          return !!blockElementsMap[node];\n        } else if (node) {\n          var type = node.nodeType;\n          if (type) {\n            return !!(type === 1 && blockElementsMap[node.nodeName]);\n          }\n        }\n        return false;\n      };\n      var get = function (elm) {\n        if (elm && doc && typeof elm === 'string') {\n          var node = doc.getElementById(elm);\n          if (node && node.id !== elm) {\n            return doc.getElementsByName(elm)[1];\n          } else {\n            return node;\n          }\n        }\n        return elm;\n      };\n      var $$ = function (elm) {\n        if (typeof elm === 'string') {\n          elm = get(elm);\n        }\n        return $(elm);\n      };\n      var getAttrib = function (elm, name, defaultVal) {\n        var hook, value;\n        var $elm = $$(elm);\n        if ($elm.length) {\n          hook = attrHooks[name];\n          if (hook && hook.get) {\n            value = hook.get($elm, name);\n          } else {\n            value = $elm.attr(name);\n          }\n        }\n        if (typeof value === 'undefined') {\n          value = defaultVal || '';\n        }\n        return value;\n      };\n      var getAttribs = function (elm) {\n        var node = get(elm);\n        if (!node) {\n          return [];\n        }\n        return node.attributes;\n      };\n      var setAttrib = function (elm, name, value) {\n        var originalValue, hook;\n        if (value === '') {\n          value = null;\n        }\n        var $elm = $$(elm);\n        originalValue = $elm.attr(name);\n        if (!$elm.length) {\n          return;\n        }\n        hook = attrHooks[name];\n        if (hook && hook.set) {\n          hook.set($elm, value, name);\n        } else {\n          $elm.attr(name, value);\n        }\n        if (originalValue !== value && settings.onSetAttrib) {\n          settings.onSetAttrib({\n            attrElm: $elm,\n            attrName: name,\n            attrValue: value\n          });\n        }\n      };\n      var clone = function (node, deep) {\n        if (!isIE || node.nodeType !== 1 || deep) {\n          return node.cloneNode(deep);\n        }\n        if (!deep) {\n          var clone_1 = doc.createElement(node.nodeName);\n          each$5(getAttribs(node), function (attr) {\n            setAttrib(clone_1, attr.nodeName, getAttrib(node, attr.nodeName));\n          });\n          return clone_1;\n        }\n        return null;\n      };\n      var getRoot = function () {\n        return settings.root_element || doc.body;\n      };\n      var getViewPort = function (argWin) {\n        var vp = getBounds(argWin);\n        return {\n          x: vp.x(),\n          y: vp.y(),\n          w: vp.width(),\n          h: vp.height()\n        };\n      };\n      var getPos = function (elm, rootElm) {\n        return Position$1.getPos(doc.body, get(elm), rootElm);\n      };\n      var setStyle = function (elm, name, value) {\n        var $elm = isString(name) ? $$(elm).css(name, value) : $$(elm).css(name);\n        if (settings.update_styles) {\n          updateInternalStyleAttr(styles, $elm);\n        }\n      };\n      var setStyles = function (elm, stylesArg) {\n        var $elm = $$(elm).css(stylesArg);\n        if (settings.update_styles) {\n          updateInternalStyleAttr(styles, $elm);\n        }\n      };\n      var getStyle = function (elm, name, computed) {\n        var $elm = $$(elm);\n        if (computed) {\n          return $elm.css(name);\n        }\n        name = name.replace(/-(\\D)/g, function (a, b) {\n          return b.toUpperCase();\n        });\n        if (name === 'float') {\n          name = Env.browser.isIE() ? 'styleFloat' : 'cssFloat';\n        }\n        return $elm[0] && $elm[0].style ? $elm[0].style[name] : undefined;\n      };\n      var getSize = function (elm) {\n        var w, h;\n        elm = get(elm);\n        w = getStyle(elm, 'width');\n        h = getStyle(elm, 'height');\n        if (w.indexOf('px') === -1) {\n          w = 0;\n        }\n        if (h.indexOf('px') === -1) {\n          h = 0;\n        }\n        return {\n          w: parseInt(w, 10) || elm.offsetWidth || elm.clientWidth,\n          h: parseInt(h, 10) || elm.offsetHeight || elm.clientHeight\n        };\n      };\n      var getRect = function (elm) {\n        var pos, size;\n        elm = get(elm);\n        pos = getPos(elm);\n        size = getSize(elm);\n        return {\n          x: pos.x,\n          y: pos.y,\n          w: size.w,\n          h: size.h\n        };\n      };\n      var is = function (elm, selector) {\n        var i;\n        if (!elm) {\n          return false;\n        }\n        if (!Array.isArray(elm)) {\n          if (selector === '*') {\n            return elm.nodeType === 1;\n          }\n          if (simpleSelectorRe.test(selector)) {\n            var selectors = selector.toLowerCase().split(/,/);\n            var elmName = elm.nodeName.toLowerCase();\n            for (i = selectors.length - 1; i >= 0; i--) {\n              if (selectors[i] === elmName) {\n                return true;\n              }\n            }\n            return false;\n          }\n          if (elm.nodeType && elm.nodeType !== 1) {\n            return false;\n          }\n        }\n        var elms = !Array.isArray(elm) ? [elm] : elm;\n        return Sizzle(selector, elms[0].ownerDocument || elms[0], null, elms).length > 0;\n      };\n      var getParents = function (elm, selector, root, collect) {\n        var result = [];\n        var selectorVal;\n        var node = get(elm);\n        collect = collect === undefined;\n        root = root || (getRoot().nodeName !== 'BODY' ? getRoot().parentNode : null);\n        if (Tools.is(selector, 'string')) {\n          selectorVal = selector;\n          if (selector === '*') {\n            selector = function (node) {\n              return node.nodeType === 1;\n            };\n          } else {\n            selector = function (node) {\n              return is(node, selectorVal);\n            };\n          }\n        }\n        while (node) {\n          if (node === root || !node.nodeType || node.nodeType === 9) {\n            break;\n          }\n          if (!selector || typeof selector === 'function' && selector(node)) {\n            if (collect) {\n              result.push(node);\n            } else {\n              return [node];\n            }\n          }\n          node = node.parentNode;\n        }\n        return collect ? result : null;\n      };\n      var getParent = function (node, selector, root) {\n        var parents = getParents(node, selector, root, false);\n        return parents && parents.length > 0 ? parents[0] : null;\n      };\n      var _findSib = function (node, selector, name) {\n        var func = selector;\n        if (node) {\n          if (typeof selector === 'string') {\n            func = function (node) {\n              return is(node, selector);\n            };\n          }\n          for (node = node[name]; node; node = node[name]) {\n            if (typeof func === 'function' && func(node)) {\n              return node;\n            }\n          }\n        }\n        return null;\n      };\n      var getNext = function (node, selector) {\n        return _findSib(node, selector, 'nextSibling');\n      };\n      var getPrev = function (node, selector) {\n        return _findSib(node, selector, 'previousSibling');\n      };\n      var select = function (selector, scope) {\n        return Sizzle(selector, get(scope) || settings.root_element || doc, []);\n      };\n      var run = function (elm, func, scope) {\n        var result;\n        var node = typeof elm === 'string' ? get(elm) : elm;\n        if (!node) {\n          return false;\n        }\n        if (Tools.isArray(node) && (node.length || node.length === 0)) {\n          result = [];\n          each$5(node, function (elm, i) {\n            if (elm) {\n              if (typeof elm === 'string') {\n                elm = get(elm);\n              }\n              result.push(func.call(scope, elm, i));\n            }\n          });\n          return result;\n        }\n        var context = scope ? scope : _this;\n        return func.call(context, node);\n      };\n      var setAttribs = function (elm, attrs) {\n        $$(elm).each(function (i, node) {\n          each$5(attrs, function (value, name) {\n            setAttrib(node, name, value);\n          });\n        });\n      };\n      var setHTML = function (elm, html) {\n        var $elm = $$(elm);\n        if (isIE) {\n          $elm.each(function (i, target) {\n            if (target.canHaveHTML === false) {\n              return;\n            }\n            while (target.firstChild) {\n              target.removeChild(target.firstChild);\n            }\n            try {\n              target.innerHTML = '<br>' + html;\n              target.removeChild(target.firstChild);\n            } catch (ex) {\n              DomQuery('<div></div>').html('<br>' + html).contents().slice(1).appendTo(target);\n            }\n            return html;\n          });\n        } else {\n          $elm.html(html);\n        }\n      };\n      var add = function (parentElm, name, attrs, html, create) {\n        return run(parentElm, function (parentElm) {\n          var newElm = typeof name === 'string' ? doc.createElement(name) : name;\n          setAttribs(newElm, attrs);\n          if (html) {\n            if (typeof html !== 'string' && html.nodeType) {\n              newElm.appendChild(html);\n            } else if (typeof html === 'string') {\n              setHTML(newElm, html);\n            }\n          }\n          return !create ? parentElm.appendChild(newElm) : newElm;\n        });\n      };\n      var create = function (name, attrs, html) {\n        return add(doc.createElement(name), name, attrs, html, true);\n      };\n      var decode = Entities.decode;\n      var encode = Entities.encodeAllRaw;\n      var createHTML = function (name, attrs, html) {\n        var outHtml = '', key;\n        outHtml += '<' + name;\n        for (key in attrs) {\n          if (attrs.hasOwnProperty(key) && attrs[key] !== null && typeof attrs[key] !== 'undefined') {\n            outHtml += ' ' + key + '=\"' + encode(attrs[key]) + '\"';\n          }\n        }\n        if (typeof html !== 'undefined') {\n          return outHtml + '>' + html + '</' + name + '>';\n        }\n        return outHtml + ' />';\n      };\n      var createFragment = function (html) {\n        var node;\n        var container = doc.createElement('div');\n        var frag = doc.createDocumentFragment();\n        if (html) {\n          container.innerHTML = html;\n        }\n        while (node = container.firstChild) {\n          frag.appendChild(node);\n        }\n        return frag;\n      };\n      var remove = function (node, keepChildren) {\n        var $node = $$(node);\n        if (keepChildren) {\n          $node.each(function () {\n            var child;\n            while (child = this.firstChild) {\n              if (child.nodeType === 3 && child.data.length === 0) {\n                this.removeChild(child);\n              } else {\n                this.parentNode.insertBefore(child, this);\n              }\n            }\n          }).remove();\n        } else {\n          $node.remove();\n        }\n        return $node.length > 1 ? $node.toArray() : $node[0];\n      };\n      var removeAllAttribs = function (e) {\n        return run(e, function (e) {\n          var i;\n          var attrs = e.attributes;\n          for (i = attrs.length - 1; i >= 0; i--) {\n            e.removeAttributeNode(attrs.item(i));\n          }\n        });\n      };\n      var parseStyle = function (cssText) {\n        return styles.parse(cssText);\n      };\n      var serializeStyle = function (stylesArg, name) {\n        return styles.serialize(stylesArg, name);\n      };\n      var addStyle = function (cssText) {\n        var head, styleElm;\n        if (self !== DOMUtils.DOM && doc === domGlobals.document) {\n          if (addedStyles[cssText]) {\n            return;\n          }\n          addedStyles[cssText] = true;\n        }\n        styleElm = doc.getElementById('mceDefaultStyles');\n        if (!styleElm) {\n          styleElm = doc.createElement('style');\n          styleElm.id = 'mceDefaultStyles';\n          styleElm.type = 'text/css';\n          head = doc.getElementsByTagName('head')[0];\n          if (head.firstChild) {\n            head.insertBefore(styleElm, head.firstChild);\n          } else {\n            head.appendChild(styleElm);\n          }\n        }\n        if (styleElm.styleSheet) {\n          styleElm.styleSheet.cssText += cssText;\n        } else {\n          styleElm.appendChild(doc.createTextNode(cssText));\n        }\n      };\n      var loadCSS = function (url) {\n        var head;\n        if (self !== DOMUtils.DOM && doc === domGlobals.document) {\n          DOMUtils.DOM.loadCSS(url);\n          return;\n        }\n        if (!url) {\n          url = '';\n        }\n        head = doc.getElementsByTagName('head')[0];\n        each$5(url.split(','), function (url) {\n          var link;\n          url = Tools._addCacheSuffix(url);\n          if (files[url]) {\n            return;\n          }\n          files[url] = true;\n          link = create('link', __assign(__assign({\n            rel: 'stylesheet',\n            type: 'text/css',\n            href: url\n          }, settings.contentCssCors ? { crossOrigin: 'anonymous' } : {}), settings.referrerPolicy ? { referrerPolicy: settings.referrerPolicy } : {}));\n          head.appendChild(link);\n        });\n      };\n      var toggleClass = function (elm, cls, state) {\n        $$(elm).toggleClass(cls, state).each(function () {\n          if (this.className === '') {\n            DomQuery(this).attr('class', null);\n          }\n        });\n      };\n      var addClass = function (elm, cls) {\n        $$(elm).addClass(cls);\n      };\n      var removeClass = function (elm, cls) {\n        toggleClass(elm, cls, false);\n      };\n      var hasClass = function (elm, cls) {\n        return $$(elm).hasClass(cls);\n      };\n      var show = function (elm) {\n        $$(elm).show();\n      };\n      var hide = function (elm) {\n        $$(elm).hide();\n      };\n      var isHidden = function (elm) {\n        return $$(elm).css('display') === 'none';\n      };\n      var uniqueId = function (prefix) {\n        return (!prefix ? 'mce_' : prefix) + counter++;\n      };\n      var getOuterHTML = function (elm) {\n        var node = typeof elm === 'string' ? get(elm) : elm;\n        return NodeType.isElement(node) ? node.outerHTML : DomQuery('<div></div>').append(DomQuery(node).clone()).html();\n      };\n      var setOuterHTML = function (elm, html) {\n        $$(elm).each(function () {\n          try {\n            if ('outerHTML' in this) {\n              this.outerHTML = html;\n              return;\n            }\n          } catch (ex) {\n          }\n          remove(DomQuery(this).html(html), true);\n        });\n      };\n      var insertAfter = function (node, reference) {\n        var referenceNode = get(reference);\n        return run(node, function (node) {\n          var parent, nextSibling;\n          parent = referenceNode.parentNode;\n          nextSibling = referenceNode.nextSibling;\n          if (nextSibling) {\n            parent.insertBefore(node, nextSibling);\n          } else {\n            parent.appendChild(node);\n          }\n          return node;\n        });\n      };\n      var replace = function (newElm, oldElm, keepChildren) {\n        return run(oldElm, function (oldElm) {\n          if (Tools.is(oldElm, 'array')) {\n            newElm = newElm.cloneNode(true);\n          }\n          if (keepChildren) {\n            each$5(grep$1(oldElm.childNodes), function (node) {\n              newElm.appendChild(node);\n            });\n          }\n          return oldElm.parentNode.replaceChild(newElm, oldElm);\n        });\n      };\n      var rename = function (elm, name) {\n        var newElm;\n        if (elm.nodeName !== name.toUpperCase()) {\n          newElm = create(name);\n          each$5(getAttribs(elm), function (attrNode) {\n            setAttrib(newElm, attrNode.nodeName, getAttrib(elm, attrNode.nodeName));\n          });\n          replace(newElm, elm, true);\n        }\n        return newElm || elm;\n      };\n      var findCommonAncestor = function (a, b) {\n        var ps = a, pe;\n        while (ps) {\n          pe = b;\n          while (pe && ps !== pe) {\n            pe = pe.parentNode;\n          }\n          if (ps === pe) {\n            break;\n          }\n          ps = ps.parentNode;\n        }\n        if (!ps && a.ownerDocument) {\n          return a.ownerDocument.documentElement;\n        }\n        return ps;\n      };\n      var toHex = function (rgbVal) {\n        return styles.toHex(Tools.trim(rgbVal));\n      };\n      var isEmpty = function (node, elements) {\n        var i, attributes, type, name, brCount = 0;\n        node = node.firstChild;\n        if (node) {\n          var walker = new TreeWalker(node, node.parentNode);\n          var whitespace = schema ? schema.getWhiteSpaceElements() : {};\n          elements = elements || (schema ? schema.getNonEmptyElements() : null);\n          do {\n            type = node.nodeType;\n            if (NodeType.isElement(node)) {\n              var bogusVal = node.getAttribute('data-mce-bogus');\n              if (bogusVal) {\n                node = walker.next(bogusVal === 'all');\n                continue;\n              }\n              name = node.nodeName.toLowerCase();\n              if (elements && elements[name]) {\n                if (name === 'br') {\n                  brCount++;\n                  node = walker.next();\n                  continue;\n                }\n                return false;\n              }\n              attributes = getAttribs(node);\n              i = attributes.length;\n              while (i--) {\n                name = attributes[i].nodeName;\n                if (name === 'name' || name === 'data-mce-bookmark') {\n                  return false;\n                }\n              }\n            }\n            if (type === 8) {\n              return false;\n            }\n            if (type === 3 && !whiteSpaceRegExp$2.test(node.nodeValue)) {\n              return false;\n            }\n            if (type === 3 && node.parentNode && whitespace[node.parentNode.nodeName] && whiteSpaceRegExp$2.test(node.nodeValue)) {\n              return false;\n            }\n            node = walker.next();\n          } while (node);\n        }\n        return brCount <= 1;\n      };\n      var createRng = function () {\n        return doc.createRange();\n      };\n      var split = function (parentElm, splitElm, replacementElm) {\n        var r = createRng(), bef, aft, pa;\n        if (parentElm && splitElm) {\n          r.setStart(parentElm.parentNode, findNodeIndex(parentElm));\n          r.setEnd(splitElm.parentNode, findNodeIndex(splitElm));\n          bef = r.extractContents();\n          r = createRng();\n          r.setStart(splitElm.parentNode, findNodeIndex(splitElm) + 1);\n          r.setEnd(parentElm.parentNode, findNodeIndex(parentElm) + 1);\n          aft = r.extractContents();\n          pa = parentElm.parentNode;\n          pa.insertBefore(TrimNode.trimNode(self, bef), parentElm);\n          if (replacementElm) {\n            pa.insertBefore(replacementElm, parentElm);\n          } else {\n            pa.insertBefore(splitElm, parentElm);\n          }\n          pa.insertBefore(TrimNode.trimNode(self, aft), parentElm);\n          remove(parentElm);\n          return replacementElm || splitElm;\n        }\n      };\n      var bind = function (target, name, func, scope) {\n        if (Tools.isArray(target)) {\n          var i = target.length;\n          var rv = [];\n          while (i--) {\n            rv[i] = bind(target[i], name, func, scope);\n          }\n          return rv;\n        }\n        if (settings.collect && (target === doc || target === win)) {\n          boundEvents.push([\n            target,\n            name,\n            func,\n            scope\n          ]);\n        }\n        return events.bind(target, name, func, scope || self);\n      };\n      var unbind = function (target, name, func) {\n        var i;\n        if (Tools.isArray(target)) {\n          i = target.length;\n          var rv = [];\n          while (i--) {\n            rv[i] = unbind(target[i], name, func);\n          }\n          return rv;\n        }\n        if (boundEvents && (target === doc || target === win)) {\n          i = boundEvents.length;\n          while (i--) {\n            var item = boundEvents[i];\n            if (target === item[0] && (!name || name === item[1]) && (!func || func === item[2])) {\n              events.unbind(item[0], item[1], item[2]);\n            }\n          }\n        }\n        return events.unbind(target, name, func);\n      };\n      var fire = function (target, name, evt) {\n        return events.fire(target, name, evt);\n      };\n      var getContentEditable = function (node) {\n        if (node && NodeType.isElement(node)) {\n          var contentEditable = node.getAttribute('data-mce-contenteditable');\n          if (contentEditable && contentEditable !== 'inherit') {\n            return contentEditable;\n          }\n          return node.contentEditable !== 'inherit' ? node.contentEditable : null;\n        } else {\n          return null;\n        }\n      };\n      var getContentEditableParent = function (node) {\n        var root = getRoot();\n        var state = null;\n        for (; node && node !== root; node = node.parentNode) {\n          state = getContentEditable(node);\n          if (state !== null) {\n            break;\n          }\n        }\n        return state;\n      };\n      var destroy = function () {\n        if (boundEvents) {\n          var i = boundEvents.length;\n          while (i--) {\n            var item = boundEvents[i];\n            events.unbind(item[0], item[1], item[2]);\n          }\n        }\n        if (Sizzle.setDocument) {\n          Sizzle.setDocument();\n        }\n      };\n      var isChildOf = function (node, parent) {\n        while (node) {\n          if (parent === node) {\n            return true;\n          }\n          node = node.parentNode;\n        }\n        return false;\n      };\n      var dumpRng = function (r) {\n        return 'startContainer: ' + r.startContainer.nodeName + ', startOffset: ' + r.startOffset + ', endContainer: ' + r.endContainer.nodeName + ', endOffset: ' + r.endOffset;\n      };\n      var self = {\n        doc: doc,\n        settings: settings,\n        win: win,\n        files: files,\n        stdMode: stdMode,\n        boxModel: boxModel,\n        styleSheetLoader: styleSheetLoader,\n        boundEvents: boundEvents,\n        styles: styles,\n        schema: schema,\n        events: events,\n        isBlock: isBlock,\n        $: $,\n        $$: $$,\n        root: null,\n        clone: clone,\n        getRoot: getRoot,\n        getViewPort: getViewPort,\n        getRect: getRect,\n        getSize: getSize,\n        getParent: getParent,\n        getParents: getParents,\n        get: get,\n        getNext: getNext,\n        getPrev: getPrev,\n        select: select,\n        is: is,\n        add: add,\n        create: create,\n        createHTML: createHTML,\n        createFragment: createFragment,\n        remove: remove,\n        setStyle: setStyle,\n        getStyle: getStyle,\n        setStyles: setStyles,\n        removeAllAttribs: removeAllAttribs,\n        setAttrib: setAttrib,\n        setAttribs: setAttribs,\n        getAttrib: getAttrib,\n        getPos: getPos,\n        parseStyle: parseStyle,\n        serializeStyle: serializeStyle,\n        addStyle: addStyle,\n        loadCSS: loadCSS,\n        addClass: addClass,\n        removeClass: removeClass,\n        hasClass: hasClass,\n        toggleClass: toggleClass,\n        show: show,\n        hide: hide,\n        isHidden: isHidden,\n        uniqueId: uniqueId,\n        setHTML: setHTML,\n        getOuterHTML: getOuterHTML,\n        setOuterHTML: setOuterHTML,\n        decode: decode,\n        encode: encode,\n        insertAfter: insertAfter,\n        replace: replace,\n        rename: rename,\n        findCommonAncestor: findCommonAncestor,\n        toHex: toHex,\n        run: run,\n        getAttribs: getAttribs,\n        isEmpty: isEmpty,\n        createRng: createRng,\n        nodeIndex: findNodeIndex,\n        split: split,\n        bind: bind,\n        unbind: unbind,\n        fire: fire,\n        getContentEditable: getContentEditable,\n        getContentEditableParent: getContentEditableParent,\n        destroy: destroy,\n        isChildOf: isChildOf,\n        dumpRng: dumpRng\n      };\n      attrHooks = setupAttrHooks(styles, settings, function () {\n        return self;\n      });\n      return self;\n    }\n    (function (DOMUtils) {\n      DOMUtils.DOM = DOMUtils(domGlobals.document);\n      DOMUtils.nodeIndex = findNodeIndex;\n    }(DOMUtils || (DOMUtils = {})));\n    var DOMUtils$1 = DOMUtils;\n\n    var DOM = DOMUtils$1.DOM;\n    var each$6 = Tools.each, grep$2 = Tools.grep;\n    var QUEUED = 0;\n    var LOADING = 1;\n    var LOADED = 2;\n    var FAILED = 3;\n    var ScriptLoader = function () {\n      function ScriptLoader(settings) {\n        if (settings === void 0) {\n          settings = {};\n        }\n        this.states = {};\n        this.queue = [];\n        this.scriptLoadedCallbacks = {};\n        this.queueLoadedCallbacks = [];\n        this.loading = 0;\n        this.settings = settings;\n      }\n      ScriptLoader.prototype._setReferrerPolicy = function (referrerPolicy) {\n        this.settings.referrerPolicy = referrerPolicy;\n      };\n      ScriptLoader.prototype.loadScript = function (url, success, failure) {\n        var dom = DOM;\n        var elm, id;\n        var done = function () {\n          dom.remove(id);\n          if (elm) {\n            elm.onreadystatechange = elm.onload = elm = null;\n          }\n          success();\n        };\n        var error = function () {\n          if (isFunction(failure)) {\n            failure();\n          } else {\n            if (typeof domGlobals.console !== 'undefined' && domGlobals.console.log) {\n              domGlobals.console.log('Failed to load script: ' + url);\n            }\n          }\n        };\n        id = dom.uniqueId();\n        elm = domGlobals.document.createElement('script');\n        elm.id = id;\n        elm.type = 'text/javascript';\n        elm.src = Tools._addCacheSuffix(url);\n        if (this.settings.referrerPolicy) {\n          dom.setAttrib(elm, 'referrerpolicy', this.settings.referrerPolicy);\n        }\n        elm.onload = done;\n        elm.onerror = error;\n        (domGlobals.document.getElementsByTagName('head')[0] || domGlobals.document.body).appendChild(elm);\n      };\n      ScriptLoader.prototype.isDone = function (url) {\n        return this.states[url] === LOADED;\n      };\n      ScriptLoader.prototype.markDone = function (url) {\n        this.states[url] = LOADED;\n      };\n      ScriptLoader.prototype.add = function (url, success, scope, failure) {\n        var state = this.states[url];\n        if (state === undefined) {\n          this.queue.push(url);\n          this.states[url] = QUEUED;\n        }\n        if (success) {\n          if (!this.scriptLoadedCallbacks[url]) {\n            this.scriptLoadedCallbacks[url] = [];\n          }\n          this.scriptLoadedCallbacks[url].push({\n            success: success,\n            failure: failure,\n            scope: scope || this\n          });\n        }\n      };\n      ScriptLoader.prototype.load = function (url, success, scope, failure) {\n        return this.add(url, success, scope, failure);\n      };\n      ScriptLoader.prototype.remove = function (url) {\n        delete this.states[url];\n        delete this.scriptLoadedCallbacks[url];\n      };\n      ScriptLoader.prototype.loadQueue = function (success, scope, failure) {\n        this.loadScripts(this.queue, success, scope, failure);\n      };\n      ScriptLoader.prototype.loadScripts = function (scripts, success, scope, failure) {\n        var self = this;\n        var loadScripts;\n        var failures = [];\n        var execCallbacks = function (name, url) {\n          each$6(self.scriptLoadedCallbacks[url], function (callback) {\n            if (isFunction(callback[name])) {\n              callback[name].call(callback.scope);\n            }\n          });\n          self.scriptLoadedCallbacks[url] = undefined;\n        };\n        self.queueLoadedCallbacks.push({\n          success: success,\n          failure: failure,\n          scope: scope || this\n        });\n        loadScripts = function () {\n          var loadingScripts = grep$2(scripts);\n          scripts.length = 0;\n          each$6(loadingScripts, function (url) {\n            if (self.states[url] === LOADED) {\n              execCallbacks('success', url);\n              return;\n            }\n            if (self.states[url] === FAILED) {\n              execCallbacks('failure', url);\n              return;\n            }\n            if (self.states[url] !== LOADING) {\n              self.states[url] = LOADING;\n              self.loading++;\n              self.loadScript(url, function () {\n                self.states[url] = LOADED;\n                self.loading--;\n                execCallbacks('success', url);\n                loadScripts();\n              }, function () {\n                self.states[url] = FAILED;\n                self.loading--;\n                failures.push(url);\n                execCallbacks('failure', url);\n                loadScripts();\n              });\n            }\n          });\n          if (!self.loading) {\n            var notifyCallbacks = self.queueLoadedCallbacks.slice(0);\n            self.queueLoadedCallbacks.length = 0;\n            each$6(notifyCallbacks, function (callback) {\n              if (failures.length === 0) {\n                if (isFunction(callback.success)) {\n                  callback.success.call(callback.scope);\n                }\n              } else {\n                if (isFunction(callback.failure)) {\n                  callback.failure.call(callback.scope, failures);\n                }\n              }\n            });\n          }\n        };\n        loadScripts();\n      };\n      ScriptLoader.ScriptLoader = new ScriptLoader();\n      return ScriptLoader;\n    }();\n\n    var isRaw = function (str) {\n      return isObject(str) && has(str, 'raw');\n    };\n    var isTokenised = function (str) {\n      return isArray(str) && str.length > 1;\n    };\n    var data = {};\n    var currentCode = Cell('en');\n    var getLanguageData = function () {\n      return get(data, currentCode.get());\n    };\n    var getData = function () {\n      return map$1(data, function (value) {\n        return __assign({}, value);\n      });\n    };\n    var setCode = function (newCode) {\n      if (newCode) {\n        currentCode.set(newCode);\n      }\n    };\n    var getCode = function () {\n      return currentCode.get();\n    };\n    var add = function (code, items) {\n      var langData = data[code];\n      if (!langData) {\n        data[code] = langData = {};\n      }\n      each$1(items, function (translation, name) {\n        langData[name.toLowerCase()] = translation;\n      });\n    };\n    var translate = function (text) {\n      var langData = getLanguageData().getOr({});\n      var toString = function (obj) {\n        if (isFunction(obj)) {\n          return Object.prototype.toString.call(obj);\n        }\n        return !isEmpty(obj) ? '' + obj : '';\n      };\n      var isEmpty = function (text) {\n        return text === '' || text === null || text === undefined;\n      };\n      var getLangData = function (text) {\n        var textstr = toString(text);\n        return get(langData, textstr.toLowerCase()).map(toString).getOr(textstr);\n      };\n      var removeContext = function (str) {\n        return str.replace(/{context:\\w+}$/, '');\n      };\n      var translated = function (text) {\n        return text;\n      };\n      if (isEmpty(text)) {\n        return translated('');\n      }\n      if (isRaw(text)) {\n        return translated(toString(text.raw));\n      }\n      if (isTokenised(text)) {\n        var values_1 = text.slice(1);\n        var substitued = getLangData(text[0]).replace(/\\{([0-9]+)\\}/g, function ($1, $2) {\n          return has(values_1, $2) ? toString(values_1[$2]) : $1;\n        });\n        return translated(removeContext(substitued));\n      }\n      return translated(removeContext(getLangData(text)));\n    };\n    var isRtl = function () {\n      return getLanguageData().bind(function (items) {\n        return get(items, '_dir');\n      }).exists(function (dir) {\n        return dir === 'rtl';\n      });\n    };\n    var hasCode = function (code) {\n      return has(data, code);\n    };\n    var I18n = {\n      getData: getData,\n      setCode: setCode,\n      getCode: getCode,\n      add: add,\n      translate: translate,\n      isRtl: isRtl,\n      hasCode: hasCode\n    };\n\n    function AddOnManager() {\n      var _this = this;\n      var items = [];\n      var urls = {};\n      var lookup = {};\n      var _listeners = [];\n      var runListeners = function (name, state) {\n        var matchedListeners = filter(_listeners, function (listener) {\n          return listener.name === name && listener.state === state;\n        });\n        each(matchedListeners, function (listener) {\n          return listener.callback();\n        });\n      };\n      var get = function (name) {\n        if (lookup[name]) {\n          return lookup[name].instance;\n        }\n        return undefined;\n      };\n      var dependencies = function (name) {\n        var result;\n        if (lookup[name]) {\n          result = lookup[name].dependencies;\n        }\n        return result || [];\n      };\n      var requireLangPack = function (name, languages) {\n        if (AddOnManager.languageLoad !== false) {\n          waitFor(name, function () {\n            var language = I18n.getCode();\n            var wrappedLanguages = ',' + (languages || '') + ',';\n            if (!language || languages && wrappedLanguages.indexOf(',' + language + ',') === -1) {\n              return;\n            }\n            ScriptLoader.ScriptLoader.add(urls[name] + '/langs/' + language + '.js');\n          }, 'loaded');\n        }\n      };\n      var add = function (id, addOn, dependencies) {\n        var addOnConstructor = addOn;\n        items.push(addOnConstructor);\n        lookup[id] = {\n          instance: addOnConstructor,\n          dependencies: dependencies\n        };\n        runListeners(id, 'added');\n        return addOnConstructor;\n      };\n      var remove = function (name) {\n        delete urls[name];\n        delete lookup[name];\n      };\n      var createUrl = function (baseUrl, dep) {\n        if (typeof dep === 'object') {\n          return dep;\n        }\n        return typeof baseUrl === 'string' ? {\n          prefix: '',\n          resource: dep,\n          suffix: ''\n        } : {\n          prefix: baseUrl.prefix,\n          resource: dep,\n          suffix: baseUrl.suffix\n        };\n      };\n      var addComponents = function (pluginName, scripts) {\n        var pluginUrl = _this.urls[pluginName];\n        each(scripts, function (script) {\n          ScriptLoader.ScriptLoader.add(pluginUrl + '/' + script);\n        });\n      };\n      var loadDependencies = function (name, addOnUrl, success, scope) {\n        var deps = dependencies(name);\n        each(deps, function (dep) {\n          var newUrl = createUrl(addOnUrl, dep);\n          load(newUrl.resource, newUrl, undefined, undefined);\n        });\n        if (success) {\n          if (scope) {\n            success.call(scope);\n          } else {\n            success.call(ScriptLoader);\n          }\n        }\n      };\n      var load = function (name, addOnUrl, success, scope, failure) {\n        if (urls[name]) {\n          return;\n        }\n        var urlString = typeof addOnUrl === 'string' ? addOnUrl : addOnUrl.prefix + addOnUrl.resource + addOnUrl.suffix;\n        if (urlString.indexOf('/') !== 0 && urlString.indexOf('://') === -1) {\n          urlString = AddOnManager.baseURL + '/' + urlString;\n        }\n        urls[name] = urlString.substring(0, urlString.lastIndexOf('/'));\n        var done = function () {\n          runListeners(name, 'loaded');\n          loadDependencies(name, addOnUrl, success, scope);\n        };\n        if (lookup[name]) {\n          done();\n        } else {\n          ScriptLoader.ScriptLoader.add(urlString, done, scope, failure);\n        }\n      };\n      var waitFor = function (name, callback, state) {\n        if (state === void 0) {\n          state = 'added';\n        }\n        if (has(lookup, name) && state === 'added') {\n          callback();\n        } else if (has(urls, name) && state === 'loaded') {\n          callback();\n        } else {\n          _listeners.push({\n            name: name,\n            state: state,\n            callback: callback\n          });\n        }\n      };\n      return {\n        items: items,\n        urls: urls,\n        lookup: lookup,\n        _listeners: _listeners,\n        get: get,\n        dependencies: dependencies,\n        requireLangPack: requireLangPack,\n        add: add,\n        remove: remove,\n        createUrl: createUrl,\n        addComponents: addComponents,\n        load: load,\n        waitFor: waitFor\n      };\n    }\n    (function (AddOnManager) {\n      AddOnManager.PluginManager = AddOnManager();\n      AddOnManager.ThemeManager = AddOnManager();\n    }(AddOnManager || (AddOnManager = {})));\n    var AddOnManager$1 = AddOnManager;\n\n    var first = function (fn, rate) {\n      var timer = null;\n      var cancel = function () {\n        if (timer !== null) {\n          domGlobals.clearTimeout(timer);\n          timer = null;\n        }\n      };\n      var throttle = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (timer === null) {\n          timer = domGlobals.setTimeout(function () {\n            fn.apply(null, args);\n            timer = null;\n          }, rate);\n        }\n      };\n      return {\n        cancel: cancel,\n        throttle: throttle\n      };\n    };\n    var last$2 = function (fn, rate) {\n      var timer = null;\n      var cancel = function () {\n        if (timer !== null) {\n          domGlobals.clearTimeout(timer);\n          timer = null;\n        }\n      };\n      var throttle = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (timer !== null) {\n          domGlobals.clearTimeout(timer);\n        }\n        timer = domGlobals.setTimeout(function () {\n          fn.apply(null, args);\n          timer = null;\n        }, rate);\n      };\n      return {\n        cancel: cancel,\n        throttle: throttle\n      };\n    };\n\n    var read = function (element, attr) {\n      var value = get$3(element, attr);\n      return value === undefined || value === '' ? [] : value.split(' ');\n    };\n    var add$1 = function (element, attr, id) {\n      var old = read(element, attr);\n      var nu = old.concat([id]);\n      set(element, attr, nu.join(' '));\n      return true;\n    };\n    var remove$2 = function (element, attr, id) {\n      var nu = filter(read(element, attr), function (v) {\n        return v !== id;\n      });\n      if (nu.length > 0) {\n        set(element, attr, nu.join(' '));\n      } else {\n        remove$1(element, attr);\n      }\n      return false;\n    };\n\n    var supports = function (element) {\n      return element.dom().classList !== undefined;\n    };\n    var get$5 = function (element) {\n      return read(element, 'class');\n    };\n    var add$2 = function (element, clazz) {\n      return add$1(element, 'class', clazz);\n    };\n    var remove$3 = function (element, clazz) {\n      return remove$2(element, 'class', clazz);\n    };\n\n    var add$3 = function (element, clazz) {\n      if (supports(element)) {\n        element.dom().classList.add(clazz);\n      } else {\n        add$2(element, clazz);\n      }\n    };\n    var cleanClass = function (element) {\n      var classList = supports(element) ? element.dom().classList : get$5(element);\n      if (classList.length === 0) {\n        remove$1(element, 'class');\n      }\n    };\n    var remove$4 = function (element, clazz) {\n      if (supports(element)) {\n        var classList = element.dom().classList;\n        classList.remove(clazz);\n      } else {\n        remove$3(element, clazz);\n      }\n      cleanClass(element);\n    };\n    var has$2 = function (element, clazz) {\n      return supports(element) && element.dom().classList.contains(clazz);\n    };\n\n    var descendants = function (scope, predicate) {\n      var result = [];\n      each(children(scope), function (x) {\n        if (predicate(x)) {\n          result = result.concat([x]);\n        }\n        result = result.concat(descendants(x, predicate));\n      });\n      return result;\n    };\n\n    var descendants$1 = function (scope, selector) {\n      return all(selector, scope);\n    };\n\n    function ClosestOrAncestor (is, ancestor, scope, a, isRoot) {\n      return is(scope, a) ? Option.some(scope) : isFunction(isRoot) && isRoot(scope) ? Option.none() : ancestor(scope, a, isRoot);\n    }\n\n    var ancestor = function (scope, predicate, isRoot) {\n      var element = scope.dom();\n      var stop = isFunction(isRoot) ? isRoot : constant(false);\n      while (element.parentNode) {\n        element = element.parentNode;\n        var el = Element.fromDom(element);\n        if (predicate(el)) {\n          return Option.some(el);\n        } else if (stop(el)) {\n          break;\n        }\n      }\n      return Option.none();\n    };\n    var closest = function (scope, predicate, isRoot) {\n      var is = function (s, test) {\n        return test(s);\n      };\n      return ClosestOrAncestor(is, ancestor, scope, predicate, isRoot);\n    };\n\n    var ancestor$1 = function (scope, selector, isRoot) {\n      return ancestor(scope, function (e) {\n        return is(e, selector);\n      }, isRoot);\n    };\n    var descendant = function (scope, selector) {\n      return one(selector, scope);\n    };\n    var closest$1 = function (scope, selector, isRoot) {\n      return ClosestOrAncestor(is, ancestor$1, scope, selector, isRoot);\n    };\n\n    var annotation = constant('mce-annotation');\n    var dataAnnotation = constant('data-mce-annotation');\n    var dataAnnotationId = constant('data-mce-annotation-uid');\n\n    var identify = function (editor, annotationName) {\n      var rng = editor.selection.getRng();\n      var start = Element.fromDom(rng.startContainer);\n      var root = Element.fromDom(editor.getBody());\n      var selector = annotationName.fold(function () {\n        return '.' + annotation();\n      }, function (an) {\n        return '[' + dataAnnotation() + '=\"' + an + '\"]';\n      });\n      var newStart = child(start, rng.startOffset).getOr(start);\n      var closest = closest$1(newStart, selector, function (n) {\n        return eq(n, root);\n      });\n      var getAttr = function (c, property) {\n        if (has$1(c, property)) {\n          return Option.some(get$3(c, property));\n        } else {\n          return Option.none();\n        }\n      };\n      return closest.bind(function (c) {\n        return getAttr(c, '' + dataAnnotationId()).bind(function (uid) {\n          return getAttr(c, '' + dataAnnotation()).map(function (name) {\n            var elements = findMarkers(editor, uid);\n            return {\n              uid: uid,\n              name: name,\n              elements: elements\n            };\n          });\n        });\n      });\n    };\n    var isAnnotation = function (elem) {\n      return isElement(elem) && has$2(elem, annotation());\n    };\n    var findMarkers = function (editor, uid) {\n      var body = Element.fromDom(editor.getBody());\n      return descendants$1(body, '[' + dataAnnotationId() + '=\"' + uid + '\"]');\n    };\n    var findAll = function (editor, name) {\n      var body = Element.fromDom(editor.getBody());\n      var markers = descendants$1(body, '[' + dataAnnotation() + '=\"' + name + '\"]');\n      var directory = {};\n      each(markers, function (m) {\n        var uid = get$3(m, dataAnnotationId());\n        var nodesAlready = directory.hasOwnProperty(uid) ? directory[uid] : [];\n        directory[uid] = nodesAlready.concat([m]);\n      });\n      return directory;\n    };\n\n    var setup = function (editor, registry) {\n      var changeCallbacks = Cell({});\n      var initData = function () {\n        return {\n          listeners: [],\n          previous: Cell(Option.none())\n        };\n      };\n      var withCallbacks = function (name, f) {\n        updateCallbacks(name, function (data) {\n          f(data);\n          return data;\n        });\n      };\n      var updateCallbacks = function (name, f) {\n        var callbackMap = changeCallbacks.get();\n        var data = callbackMap.hasOwnProperty(name) ? callbackMap[name] : initData();\n        var outputData = f(data);\n        callbackMap[name] = outputData;\n        changeCallbacks.set(callbackMap);\n      };\n      var fireCallbacks = function (name, uid, elements) {\n        withCallbacks(name, function (data) {\n          each(data.listeners, function (f) {\n            return f(true, name, {\n              uid: uid,\n              nodes: map(elements, function (elem) {\n                return elem.dom();\n              })\n            });\n          });\n        });\n      };\n      var fireNoAnnotation = function (name) {\n        withCallbacks(name, function (data) {\n          each(data.listeners, function (f) {\n            return f(false, name);\n          });\n        });\n      };\n      var onNodeChange = last$2(function () {\n        var callbackMap = changeCallbacks.get();\n        var annotations = sort(keys(callbackMap));\n        each(annotations, function (name) {\n          updateCallbacks(name, function (data) {\n            var prev = data.previous.get();\n            identify(editor, Option.some(name)).fold(function () {\n              if (prev.isSome()) {\n                fireNoAnnotation(name);\n                data.previous.set(Option.none());\n              }\n            }, function (_a) {\n              var uid = _a.uid, name = _a.name, elements = _a.elements;\n              if (!prev.is(uid)) {\n                fireCallbacks(name, uid, elements);\n                data.previous.set(Option.some(uid));\n              }\n            });\n            return {\n              previous: data.previous,\n              listeners: data.listeners\n            };\n          });\n        });\n      }, 30);\n      editor.on('remove', function () {\n        onNodeChange.cancel();\n      });\n      editor.on('NodeChange', function () {\n        onNodeChange.throttle();\n      });\n      var addListener = function (name, f) {\n        updateCallbacks(name, function (data) {\n          return {\n            previous: data.previous,\n            listeners: data.listeners.concat([f])\n          };\n        });\n      };\n      return { addListener: addListener };\n    };\n\n    var setup$1 = function (editor, registry) {\n      var identifyParserNode = function (span) {\n        return Option.from(span.attr(dataAnnotation())).bind(registry.lookup);\n      };\n      editor.on('init', function () {\n        editor.serializer.addNodeFilter('span', function (spans) {\n          each(spans, function (span) {\n            identifyParserNode(span).each(function (settings) {\n              if (settings.persistent === false) {\n                span.unwrap();\n              }\n            });\n          });\n        });\n      });\n    };\n\n    var create$1 = function () {\n      var annotations = {};\n      var register = function (name, settings) {\n        annotations[name] = {\n          name: name,\n          settings: settings\n        };\n      };\n      var lookup = function (name) {\n        return annotations.hasOwnProperty(name) ? Option.from(annotations[name]).map(function (a) {\n          return a.settings;\n        }) : Option.none();\n      };\n      return {\n        register: register,\n        lookup: lookup\n      };\n    };\n\n    var unique = 0;\n    var generate = function (prefix) {\n      var date = new Date();\n      var time = date.getTime();\n      var random = Math.floor(Math.random() * 1000000000);\n      unique++;\n      return prefix + '_' + random + unique + String(time);\n    };\n\n    var add$4 = function (element, classes) {\n      each(classes, function (x) {\n        add$3(element, x);\n      });\n    };\n\n    var fromHtml$1 = function (html, scope) {\n      var doc = scope || domGlobals.document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      return children(Element.fromDom(div));\n    };\n\n    var get$6 = function (element) {\n      return element.dom().innerHTML;\n    };\n    var set$1 = function (element, content) {\n      var owner$1 = owner(element);\n      var docDom = owner$1.dom();\n      var fragment = Element.fromDom(docDom.createDocumentFragment());\n      var contentElements = fromHtml$1(content, docDom);\n      append$1(fragment, contentElements);\n      empty(element);\n      append(element, fragment);\n    };\n\n    var clone = function (original, isDeep) {\n      return Element.fromDom(original.dom().cloneNode(isDeep));\n    };\n    var shallow = function (original) {\n      return clone(original, false);\n    };\n    var deep = function (original) {\n      return clone(original, true);\n    };\n\n    var ZWSP = zeroWidth;\n    var isZwsp = function (chr) {\n      return chr === ZWSP;\n    };\n    var trim$3 = function (text) {\n      return text.replace(new RegExp(ZWSP, 'g'), '');\n    };\n    var Zwsp = {\n      isZwsp: isZwsp,\n      ZWSP: ZWSP,\n      trim: trim$3\n    };\n\n    var isElement$2 = NodeType.isElement;\n    var isText$2 = NodeType.isText;\n    var isCaretContainerBlock = function (node) {\n      if (isText$2(node)) {\n        node = node.parentNode;\n      }\n      return isElement$2(node) && node.hasAttribute('data-mce-caret');\n    };\n    var isCaretContainerInline = function (node) {\n      return isText$2(node) && Zwsp.isZwsp(node.data);\n    };\n    var isCaretContainer = function (node) {\n      return isCaretContainerBlock(node) || isCaretContainerInline(node);\n    };\n    var hasContent = function (node) {\n      return node.firstChild !== node.lastChild || !NodeType.isBr(node.firstChild);\n    };\n    var insertInline = function (node, before) {\n      var doc, sibling, textNode, parentNode;\n      doc = node.ownerDocument;\n      textNode = doc.createTextNode(Zwsp.ZWSP);\n      parentNode = node.parentNode;\n      if (!before) {\n        sibling = node.nextSibling;\n        if (isText$2(sibling)) {\n          if (isCaretContainer(sibling)) {\n            return sibling;\n          }\n          if (startsWithCaretContainer(sibling)) {\n            sibling.splitText(1);\n            return sibling;\n          }\n        }\n        if (node.nextSibling) {\n          parentNode.insertBefore(textNode, node.nextSibling);\n        } else {\n          parentNode.appendChild(textNode);\n        }\n      } else {\n        sibling = node.previousSibling;\n        if (isText$2(sibling)) {\n          if (isCaretContainer(sibling)) {\n            return sibling;\n          }\n          if (endsWithCaretContainer(sibling)) {\n            return sibling.splitText(sibling.data.length - 1);\n          }\n        }\n        parentNode.insertBefore(textNode, node);\n      }\n      return textNode;\n    };\n    var isBeforeInline = function (pos) {\n      var container = pos.container();\n      if (!pos || !NodeType.isText(container)) {\n        return false;\n      }\n      return container.data.charAt(pos.offset()) === Zwsp.ZWSP || pos.isAtStart() && isCaretContainerInline(container.previousSibling);\n    };\n    var isAfterInline = function (pos) {\n      var container = pos.container();\n      if (!pos || !NodeType.isText(container)) {\n        return false;\n      }\n      return container.data.charAt(pos.offset() - 1) === Zwsp.ZWSP || pos.isAtEnd() && isCaretContainerInline(container.nextSibling);\n    };\n    var createBogusBr = function () {\n      var br = domGlobals.document.createElement('br');\n      br.setAttribute('data-mce-bogus', '1');\n      return br;\n    };\n    var insertBlock = function (blockName, node, before) {\n      var doc, blockNode, parentNode;\n      doc = node.ownerDocument;\n      blockNode = doc.createElement(blockName);\n      blockNode.setAttribute('data-mce-caret', before ? 'before' : 'after');\n      blockNode.setAttribute('data-mce-bogus', 'all');\n      blockNode.appendChild(createBogusBr());\n      parentNode = node.parentNode;\n      if (!before) {\n        if (node.nextSibling) {\n          parentNode.insertBefore(blockNode, node.nextSibling);\n        } else {\n          parentNode.appendChild(blockNode);\n        }\n      } else {\n        parentNode.insertBefore(blockNode, node);\n      }\n      return blockNode;\n    };\n    var startsWithCaretContainer = function (node) {\n      return isText$2(node) && node.data[0] === Zwsp.ZWSP;\n    };\n    var endsWithCaretContainer = function (node) {\n      return isText$2(node) && node.data[node.data.length - 1] === Zwsp.ZWSP;\n    };\n    var trimBogusBr = function (elm) {\n      var brs = elm.getElementsByTagName('br');\n      var lastBr = brs[brs.length - 1];\n      if (NodeType.isBogus(lastBr)) {\n        lastBr.parentNode.removeChild(lastBr);\n      }\n    };\n    var showCaretContainerBlock = function (caretContainer) {\n      if (caretContainer && caretContainer.hasAttribute('data-mce-caret')) {\n        trimBogusBr(caretContainer);\n        caretContainer.removeAttribute('data-mce-caret');\n        caretContainer.removeAttribute('data-mce-bogus');\n        caretContainer.removeAttribute('style');\n        caretContainer.removeAttribute('_moz_abspos');\n        return caretContainer;\n      }\n      return null;\n    };\n    var isRangeInCaretContainerBlock = function (range) {\n      return isCaretContainerBlock(range.startContainer);\n    };\n\n    var isContentEditableTrue$1 = NodeType.isContentEditableTrue;\n    var isContentEditableFalse$1 = NodeType.isContentEditableFalse;\n    var isBr$2 = NodeType.isBr;\n    var isText$3 = NodeType.isText;\n    var isInvalidTextElement = NodeType.matchNodeNames([\n      'script',\n      'style',\n      'textarea'\n    ]);\n    var isAtomicInline = NodeType.matchNodeNames([\n      'img',\n      'input',\n      'textarea',\n      'hr',\n      'iframe',\n      'video',\n      'audio',\n      'object'\n    ]);\n    var isTable$2 = NodeType.matchNodeNames(['table']);\n    var isCaretContainer$1 = isCaretContainer;\n    var isCaretCandidate = function (node) {\n      if (isCaretContainer$1(node)) {\n        return false;\n      }\n      if (isText$3(node)) {\n        if (isInvalidTextElement(node.parentNode)) {\n          return false;\n        }\n        return true;\n      }\n      return isAtomicInline(node) || isBr$2(node) || isTable$2(node) || isNonUiContentEditableFalse(node);\n    };\n    var isUnselectable = function (node) {\n      return NodeType.isElement(node) && node.getAttribute('unselectable') === 'true';\n    };\n    var isNonUiContentEditableFalse = function (node) {\n      return isUnselectable(node) === false && isContentEditableFalse$1(node);\n    };\n    var isInEditable = function (node, root) {\n      for (node = node.parentNode; node && node !== root; node = node.parentNode) {\n        if (isNonUiContentEditableFalse(node)) {\n          return false;\n        }\n        if (isContentEditableTrue$1(node)) {\n          return true;\n        }\n      }\n      return true;\n    };\n    var isAtomicContentEditableFalse = function (node) {\n      if (!isNonUiContentEditableFalse(node)) {\n        return false;\n      }\n      return foldl(from$1(node.getElementsByTagName('*')), function (result, elm) {\n        return result || isContentEditableTrue$1(elm);\n      }, false) !== true;\n    };\n    var isAtomic = function (node) {\n      return isAtomicInline(node) || isAtomicContentEditableFalse(node);\n    };\n    var isEditableCaretCandidate = function (node, root) {\n      return isCaretCandidate(node) && isInEditable(node, root);\n    };\n\n    var round = Math.round;\n    var clone$1 = function (rect) {\n      if (!rect) {\n        return {\n          left: 0,\n          top: 0,\n          bottom: 0,\n          right: 0,\n          width: 0,\n          height: 0\n        };\n      }\n      return {\n        left: round(rect.left),\n        top: round(rect.top),\n        bottom: round(rect.bottom),\n        right: round(rect.right),\n        width: round(rect.width),\n        height: round(rect.height)\n      };\n    };\n    var collapse = function (rect, toStart) {\n      rect = clone$1(rect);\n      if (toStart) {\n        rect.right = rect.left;\n      } else {\n        rect.left = rect.left + rect.width;\n        rect.right = rect.left;\n      }\n      rect.width = 0;\n      return rect;\n    };\n    var isEqual = function (rect1, rect2) {\n      return rect1.left === rect2.left && rect1.top === rect2.top && rect1.bottom === rect2.bottom && rect1.right === rect2.right;\n    };\n    var isValidOverflow = function (overflowY, rect1, rect2) {\n      return overflowY >= 0 && overflowY <= Math.min(rect1.height, rect2.height) / 2;\n    };\n    var isAbove = function (rect1, rect2) {\n      if (rect1.bottom - rect1.height / 2 < rect2.top) {\n        return true;\n      }\n      if (rect1.top > rect2.bottom) {\n        return false;\n      }\n      return isValidOverflow(rect2.top - rect1.bottom, rect1, rect2);\n    };\n    var isBelow = function (rect1, rect2) {\n      if (rect1.top > rect2.bottom) {\n        return true;\n      }\n      if (rect1.bottom < rect2.top) {\n        return false;\n      }\n      return isValidOverflow(rect2.bottom - rect1.top, rect1, rect2);\n    };\n    var containsXY = function (rect, clientX, clientY) {\n      return clientX >= rect.left && clientX <= rect.right && clientY >= rect.top && clientY <= rect.bottom;\n    };\n\n    var getSelectedNode = function (range) {\n      var startContainer = range.startContainer, startOffset = range.startOffset;\n      if (startContainer.hasChildNodes() && range.endOffset === startOffset + 1) {\n        return startContainer.childNodes[startOffset];\n      }\n      return null;\n    };\n    var getNode = function (container, offset) {\n      if (container.nodeType === 1 && container.hasChildNodes()) {\n        if (offset >= container.childNodes.length) {\n          offset = container.childNodes.length - 1;\n        }\n        container = container.childNodes[offset];\n      }\n      return container;\n    };\n\n    var extendingChars = new RegExp('[\\u0300-\\u036f\\u0483-\\u0487\\u0488-\\u0489\\u0591-\\u05bd\\u05bf\\u05c1-\\u05c2\\u05c4-\\u05c5\\u05c7\\u0610-\\u061a' + '\\u064b-\\u065f\\u0670\\u06d6-\\u06dc\\u06df-\\u06e4\\u06e7-\\u06e8\\u06ea-\\u06ed\\u0711\\u0730-\\u074a\\u07a6-\\u07b0' + '\\u07eb-\\u07f3\\u0816-\\u0819\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0859-\\u085b\\u08e3-\\u0902\\u093a\\u093c' + '\\u0941-\\u0948\\u094d\\u0951-\\u0957\\u0962-\\u0963\\u0981\\u09bc\\u09be\\u09c1-\\u09c4\\u09cd\\u09d7\\u09e2-\\u09e3' + '\\u0a01-\\u0a02\\u0a3c\\u0a41-\\u0a42\\u0a47-\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a70-\\u0a71\\u0a75\\u0a81-\\u0a82\\u0abc' + '\\u0ac1-\\u0ac5\\u0ac7-\\u0ac8\\u0acd\\u0ae2-\\u0ae3\\u0b01\\u0b3c\\u0b3e\\u0b3f\\u0b41-\\u0b44\\u0b4d\\u0b56\\u0b57' + '\\u0b62-\\u0b63\\u0b82\\u0bbe\\u0bc0\\u0bcd\\u0bd7\\u0c00\\u0c3e-\\u0c40\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55-\\u0c56' + '\\u0c62-\\u0c63\\u0c81\\u0cbc\\u0cbf\\u0cc2\\u0cc6\\u0ccc-\\u0ccd\\u0cd5-\\u0cd6\\u0ce2-\\u0ce3\\u0d01\\u0d3e\\u0d41-\\u0d44' + '\\u0d4d\\u0d57\\u0d62-\\u0d63\\u0dca\\u0dcf\\u0dd2-\\u0dd4\\u0dd6\\u0ddf\\u0e31\\u0e34-\\u0e3a\\u0e47-\\u0e4e\\u0eb1\\u0eb4-\\u0eb9' + '\\u0ebb-\\u0ebc\\u0ec8-\\u0ecd\\u0f18-\\u0f19\\u0f35\\u0f37\\u0f39\\u0f71-\\u0f7e\\u0f80-\\u0f84\\u0f86-\\u0f87\\u0f8d-\\u0f97' + '\\u0f99-\\u0fbc\\u0fc6\\u102d-\\u1030\\u1032-\\u1037\\u1039-\\u103a\\u103d-\\u103e\\u1058-\\u1059\\u105e-\\u1060\\u1071-\\u1074' + '\\u1082\\u1085-\\u1086\\u108d\\u109d\\u135d-\\u135f\\u1712-\\u1714\\u1732-\\u1734\\u1752-\\u1753\\u1772-\\u1773\\u17b4-\\u17b5' + '\\u17b7-\\u17bd\\u17c6\\u17c9-\\u17d3\\u17dd\\u180b-\\u180d\\u18a9\\u1920-\\u1922\\u1927-\\u1928\\u1932\\u1939-\\u193b\\u1a17-\\u1a18' + '\\u1a1b\\u1a56\\u1a58-\\u1a5e\\u1a60\\u1a62\\u1a65-\\u1a6c\\u1a73-\\u1a7c\\u1a7f\\u1ab0-\\u1abd\\u1ABE\\u1b00-\\u1b03\\u1b34' + '\\u1b36-\\u1b3a\\u1b3c\\u1b42\\u1b6b-\\u1b73\\u1b80-\\u1b81\\u1ba2-\\u1ba5\\u1ba8-\\u1ba9\\u1bab-\\u1bad\\u1be6\\u1be8-\\u1be9' + '\\u1bed\\u1bef-\\u1bf1\\u1c2c-\\u1c33\\u1c36-\\u1c37\\u1cd0-\\u1cd2\\u1cd4-\\u1ce0\\u1ce2-\\u1ce8\\u1ced\\u1cf4\\u1cf8-\\u1cf9' + '\\u1dc0-\\u1df5\\u1dfc-\\u1dff\\u200c-\\u200d\\u20d0-\\u20dc\\u20DD-\\u20E0\\u20e1\\u20E2-\\u20E4\\u20e5-\\u20f0\\u2cef-\\u2cf1' + '\\u2d7f\\u2de0-\\u2dff\\u302a-\\u302d\\u302e-\\u302f\\u3099-\\u309a\\ua66f\\uA670-\\uA672\\ua674-\\ua67d\\ua69e-\\ua69f\\ua6f0-\\ua6f1' + '\\ua802\\ua806\\ua80b\\ua825-\\ua826\\ua8c4\\ua8e0-\\ua8f1\\ua926-\\ua92d\\ua947-\\ua951\\ua980-\\ua982\\ua9b3\\ua9b6-\\ua9b9\\ua9bc' + '\\ua9e5\\uaa29-\\uaa2e\\uaa31-\\uaa32\\uaa35-\\uaa36\\uaa43\\uaa4c\\uaa7c\\uaab0\\uaab2-\\uaab4\\uaab7-\\uaab8\\uaabe-\\uaabf\\uaac1' + '\\uaaec-\\uaaed\\uaaf6\\uabe5\\uabe8\\uabed\\ufb1e\\ufe00-\\ufe0f\\ufe20-\\ufe2f\\uff9e-\\uff9f]');\n    var isExtendingChar = function (ch) {\n      return typeof ch === 'string' && ch.charCodeAt(0) >= 768 && extendingChars.test(ch);\n    };\n\n    var lift2 = function (oa, ob, f) {\n      return oa.isSome() && ob.isSome() ? Option.some(f(oa.getOrDie(), ob.getOrDie())) : Option.none();\n    };\n    var lift3 = function (oa, ob, oc, f) {\n      return oa.isSome() && ob.isSome() && oc.isSome() ? Option.some(f(oa.getOrDie(), ob.getOrDie(), oc.getOrDie())) : Option.none();\n    };\n    var someIf = function (b, a) {\n      return b ? Option.some(a) : Option.none();\n    };\n\n    var slice$2 = [].slice;\n    var or = function () {\n      var x = [];\n      for (var _i = 0; _i < arguments.length; _i++) {\n        x[_i] = arguments[_i];\n      }\n      var args = slice$2.call(arguments);\n      return function (x) {\n        for (var i = 0; i < args.length; i++) {\n          if (args[i](x)) {\n            return true;\n          }\n        }\n        return false;\n      };\n    };\n    var and = function () {\n      var x = [];\n      for (var _i = 0; _i < arguments.length; _i++) {\n        x[_i] = arguments[_i];\n      }\n      var args = slice$2.call(arguments);\n      return function (x) {\n        for (var i = 0; i < args.length; i++) {\n          if (!args[i](x)) {\n            return false;\n          }\n        }\n        return true;\n      };\n    };\n    var Predicate = {\n      and: and,\n      or: or\n    };\n\n    var isElement$3 = NodeType.isElement;\n    var isCaretCandidate$1 = isCaretCandidate;\n    var isBlock$1 = NodeType.matchStyleValues('display', 'block table');\n    var isFloated = NodeType.matchStyleValues('float', 'left right');\n    var isValidElementCaretCandidate = Predicate.and(isElement$3, isCaretCandidate$1, not(isFloated));\n    var isNotPre = not(NodeType.matchStyleValues('white-space', 'pre pre-line pre-wrap'));\n    var isText$4 = NodeType.isText;\n    var isBr$3 = NodeType.isBr;\n    var nodeIndex = DOMUtils$1.nodeIndex;\n    var resolveIndex = getNode;\n    var createRange = function (doc) {\n      return 'createRange' in doc ? doc.createRange() : DOMUtils$1.DOM.createRng();\n    };\n    var isWhiteSpace = function (chr) {\n      return chr && /[\\r\\n\\t ]/.test(chr);\n    };\n    var isRange = function (rng) {\n      return !!rng.setStart && !!rng.setEnd;\n    };\n    var isHiddenWhiteSpaceRange = function (range) {\n      var container = range.startContainer;\n      var offset = range.startOffset;\n      var text;\n      if (isWhiteSpace(range.toString()) && isNotPre(container.parentNode) && NodeType.isText(container)) {\n        text = container.data;\n        if (isWhiteSpace(text[offset - 1]) || isWhiteSpace(text[offset + 1])) {\n          return true;\n        }\n      }\n      return false;\n    };\n    var getBrClientRect = function (brNode) {\n      var doc = brNode.ownerDocument;\n      var rng = createRange(doc);\n      var nbsp$1 = doc.createTextNode(nbsp);\n      var parentNode = brNode.parentNode;\n      var clientRect;\n      parentNode.insertBefore(nbsp$1, brNode);\n      rng.setStart(nbsp$1, 0);\n      rng.setEnd(nbsp$1, 1);\n      clientRect = clone$1(rng.getBoundingClientRect());\n      parentNode.removeChild(nbsp$1);\n      return clientRect;\n    };\n    var getBoundingClientRectWebKitText = function (rng) {\n      var sc = rng.startContainer;\n      var ec = rng.endContainer;\n      var so = rng.startOffset;\n      var eo = rng.endOffset;\n      if (sc === ec && NodeType.isText(ec) && so === 0 && eo === 1) {\n        var newRng = rng.cloneRange();\n        newRng.setEndAfter(ec);\n        return getBoundingClientRect(newRng);\n      } else {\n        return null;\n      }\n    };\n    var isZeroRect = function (r) {\n      return r.left === 0 && r.right === 0 && r.top === 0 && r.bottom === 0;\n    };\n    var getBoundingClientRect = function (item) {\n      var clientRect, clientRects;\n      clientRects = item.getClientRects();\n      if (clientRects.length > 0) {\n        clientRect = clone$1(clientRects[0]);\n      } else {\n        clientRect = clone$1(item.getBoundingClientRect());\n      }\n      if (!isRange(item) && isBr$3(item) && isZeroRect(clientRect)) {\n        return getBrClientRect(item);\n      }\n      if (isZeroRect(clientRect) && isRange(item)) {\n        return getBoundingClientRectWebKitText(item);\n      }\n      return clientRect;\n    };\n    var collapseAndInflateWidth = function (clientRect, toStart) {\n      var newClientRect = collapse(clientRect, toStart);\n      newClientRect.width = 1;\n      newClientRect.right = newClientRect.left + 1;\n      return newClientRect;\n    };\n    var getCaretPositionClientRects = function (caretPosition) {\n      var clientRects = [];\n      var beforeNode, node;\n      var addUniqueAndValidRect = function (clientRect) {\n        if (clientRect.height === 0) {\n          return;\n        }\n        if (clientRects.length > 0) {\n          if (isEqual(clientRect, clientRects[clientRects.length - 1])) {\n            return;\n          }\n        }\n        clientRects.push(clientRect);\n      };\n      var addCharacterOffset = function (container, offset) {\n        var range = createRange(container.ownerDocument);\n        if (offset < container.data.length) {\n          if (isExtendingChar(container.data[offset])) {\n            return clientRects;\n          }\n          if (isExtendingChar(container.data[offset - 1])) {\n            range.setStart(container, offset);\n            range.setEnd(container, offset + 1);\n            if (!isHiddenWhiteSpaceRange(range)) {\n              addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(range), false));\n              return clientRects;\n            }\n          }\n        }\n        if (offset > 0) {\n          range.setStart(container, offset - 1);\n          range.setEnd(container, offset);\n          if (!isHiddenWhiteSpaceRange(range)) {\n            addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(range), false));\n          }\n        }\n        if (offset < container.data.length) {\n          range.setStart(container, offset);\n          range.setEnd(container, offset + 1);\n          if (!isHiddenWhiteSpaceRange(range)) {\n            addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(range), true));\n          }\n        }\n      };\n      if (isText$4(caretPosition.container())) {\n        addCharacterOffset(caretPosition.container(), caretPosition.offset());\n        return clientRects;\n      }\n      if (isElement$3(caretPosition.container())) {\n        if (caretPosition.isAtEnd()) {\n          node = resolveIndex(caretPosition.container(), caretPosition.offset());\n          if (isText$4(node)) {\n            addCharacterOffset(node, node.data.length);\n          }\n          if (isValidElementCaretCandidate(node) && !isBr$3(node)) {\n            addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(node), false));\n          }\n        } else {\n          node = resolveIndex(caretPosition.container(), caretPosition.offset());\n          if (isText$4(node)) {\n            addCharacterOffset(node, 0);\n          }\n          if (isValidElementCaretCandidate(node) && caretPosition.isAtEnd()) {\n            addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(node), false));\n            return clientRects;\n          }\n          beforeNode = resolveIndex(caretPosition.container(), caretPosition.offset() - 1);\n          if (isValidElementCaretCandidate(beforeNode) && !isBr$3(beforeNode)) {\n            if (isBlock$1(beforeNode) || isBlock$1(node) || !isValidElementCaretCandidate(node)) {\n              addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(beforeNode), false));\n            }\n          }\n          if (isValidElementCaretCandidate(node)) {\n            addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(node), true));\n          }\n        }\n      }\n      return clientRects;\n    };\n    function CaretPosition(container, offset, clientRects) {\n      var isAtStart = function () {\n        if (isText$4(container)) {\n          return offset === 0;\n        }\n        return offset === 0;\n      };\n      var isAtEnd = function () {\n        if (isText$4(container)) {\n          return offset >= container.data.length;\n        }\n        return offset >= container.childNodes.length;\n      };\n      var toRange = function () {\n        var range;\n        range = createRange(container.ownerDocument);\n        range.setStart(container, offset);\n        range.setEnd(container, offset);\n        return range;\n      };\n      var getClientRects = function () {\n        if (!clientRects) {\n          clientRects = getCaretPositionClientRects(CaretPosition(container, offset));\n        }\n        return clientRects;\n      };\n      var isVisible = function () {\n        return getClientRects().length > 0;\n      };\n      var isEqual = function (caretPosition) {\n        return caretPosition && container === caretPosition.container() && offset === caretPosition.offset();\n      };\n      var getNode = function (before) {\n        return resolveIndex(container, before ? offset - 1 : offset);\n      };\n      return {\n        container: constant(container),\n        offset: constant(offset),\n        toRange: toRange,\n        getClientRects: getClientRects,\n        isVisible: isVisible,\n        isAtStart: isAtStart,\n        isAtEnd: isAtEnd,\n        isEqual: isEqual,\n        getNode: getNode\n      };\n    }\n    (function (CaretPosition) {\n      CaretPosition.fromRangeStart = function (range) {\n        return CaretPosition(range.startContainer, range.startOffset);\n      };\n      CaretPosition.fromRangeEnd = function (range) {\n        return CaretPosition(range.endContainer, range.endOffset);\n      };\n      CaretPosition.after = function (node) {\n        return CaretPosition(node.parentNode, nodeIndex(node) + 1);\n      };\n      CaretPosition.before = function (node) {\n        return CaretPosition(node.parentNode, nodeIndex(node));\n      };\n      CaretPosition.isAbove = function (pos1, pos2) {\n        return lift2(head(pos2.getClientRects()), last(pos1.getClientRects()), isAbove).getOr(false);\n      };\n      CaretPosition.isBelow = function (pos1, pos2) {\n        return lift2(last(pos2.getClientRects()), head(pos1.getClientRects()), isBelow).getOr(false);\n      };\n      CaretPosition.isAtStart = function (pos) {\n        return pos ? pos.isAtStart() : false;\n      };\n      CaretPosition.isAtEnd = function (pos) {\n        return pos ? pos.isAtEnd() : false;\n      };\n      CaretPosition.isTextPosition = function (pos) {\n        return pos ? NodeType.isText(pos.container()) : false;\n      };\n      CaretPosition.isElementPosition = function (pos) {\n        return CaretPosition.isTextPosition(pos) === false;\n      };\n    }(CaretPosition || (CaretPosition = {})));\n    var CaretPosition$1 = CaretPosition;\n\n    var isText$5 = NodeType.isText;\n    var isBogus$1 = NodeType.isBogus;\n    var nodeIndex$1 = DOMUtils$1.nodeIndex;\n    var normalizedParent = function (node) {\n      var parentNode = node.parentNode;\n      if (isBogus$1(parentNode)) {\n        return normalizedParent(parentNode);\n      }\n      return parentNode;\n    };\n    var getChildNodes = function (node) {\n      if (!node) {\n        return [];\n      }\n      return ArrUtils.reduce(node.childNodes, function (result, node) {\n        if (isBogus$1(node) && node.nodeName !== 'BR') {\n          result = result.concat(getChildNodes(node));\n        } else {\n          result.push(node);\n        }\n        return result;\n      }, []);\n    };\n    var normalizedTextOffset = function (node, offset) {\n      while (node = node.previousSibling) {\n        if (!isText$5(node)) {\n          break;\n        }\n        offset += node.data.length;\n      }\n      return offset;\n    };\n    var equal = function (a) {\n      return function (b) {\n        return a === b;\n      };\n    };\n    var normalizedNodeIndex = function (node) {\n      var nodes, index, numTextFragments;\n      nodes = getChildNodes(normalizedParent(node));\n      index = ArrUtils.findIndex(nodes, equal(node), node);\n      nodes = nodes.slice(0, index + 1);\n      numTextFragments = ArrUtils.reduce(nodes, function (result, node, i) {\n        if (isText$5(node) && isText$5(nodes[i - 1])) {\n          result++;\n        }\n        return result;\n      }, 0);\n      nodes = ArrUtils.filter(nodes, NodeType.matchNodeNames([node.nodeName]));\n      index = ArrUtils.findIndex(nodes, equal(node), node);\n      return index - numTextFragments;\n    };\n    var createPathItem = function (node) {\n      var name;\n      if (isText$5(node)) {\n        name = 'text()';\n      } else {\n        name = node.nodeName.toLowerCase();\n      }\n      return name + '[' + normalizedNodeIndex(node) + ']';\n    };\n    var parentsUntil = function (root, node, predicate) {\n      var parents = [];\n      for (node = node.parentNode; node !== root; node = node.parentNode) {\n        if (predicate && predicate(node)) {\n          break;\n        }\n        parents.push(node);\n      }\n      return parents;\n    };\n    var create$2 = function (root, caretPosition) {\n      var container, offset, path = [], outputOffset, childNodes, parents;\n      container = caretPosition.container();\n      offset = caretPosition.offset();\n      if (isText$5(container)) {\n        outputOffset = normalizedTextOffset(container, offset);\n      } else {\n        childNodes = container.childNodes;\n        if (offset >= childNodes.length) {\n          outputOffset = 'after';\n          offset = childNodes.length - 1;\n        } else {\n          outputOffset = 'before';\n        }\n        container = childNodes[offset];\n      }\n      path.push(createPathItem(container));\n      parents = parentsUntil(root, container);\n      parents = ArrUtils.filter(parents, not(NodeType.isBogus));\n      path = path.concat(ArrUtils.map(parents, function (node) {\n        return createPathItem(node);\n      }));\n      return path.reverse().join('/') + ',' + outputOffset;\n    };\n    var resolvePathItem = function (node, name, index) {\n      var nodes = getChildNodes(node);\n      nodes = ArrUtils.filter(nodes, function (node, index) {\n        return !isText$5(node) || !isText$5(nodes[index - 1]);\n      });\n      nodes = ArrUtils.filter(nodes, NodeType.matchNodeNames([name]));\n      return nodes[index];\n    };\n    var findTextPosition = function (container, offset) {\n      var node = container, targetOffset = 0, dataLen;\n      while (isText$5(node)) {\n        dataLen = node.data.length;\n        if (offset >= targetOffset && offset <= targetOffset + dataLen) {\n          container = node;\n          offset = offset - targetOffset;\n          break;\n        }\n        if (!isText$5(node.nextSibling)) {\n          container = node;\n          offset = dataLen;\n          break;\n        }\n        targetOffset += dataLen;\n        node = node.nextSibling;\n      }\n      if (isText$5(container) && offset > container.data.length) {\n        offset = container.data.length;\n      }\n      return CaretPosition$1(container, offset);\n    };\n    var resolve$1 = function (root, path) {\n      var parts, container, offset;\n      if (!path) {\n        return null;\n      }\n      parts = path.split(',');\n      path = parts[0].split('/');\n      offset = parts.length > 1 ? parts[1] : 'before';\n      container = ArrUtils.reduce(path, function (result, value) {\n        value = /([\\w\\-\\(\\)]+)\\[([0-9]+)\\]/.exec(value);\n        if (!value) {\n          return null;\n        }\n        if (value[1] === 'text()') {\n          value[1] = '#text';\n        }\n        return resolvePathItem(result, value[1], parseInt(value[2], 10));\n      }, root);\n      if (!container) {\n        return null;\n      }\n      if (!isText$5(container)) {\n        if (offset === 'after') {\n          offset = nodeIndex$1(container) + 1;\n        } else {\n          offset = nodeIndex$1(container);\n        }\n        return CaretPosition$1(container.parentNode, offset);\n      }\n      return findTextPosition(container, parseInt(offset, 10));\n    };\n\n    var trimEmptyTextNode = function (dom, node) {\n      if (NodeType.isText(node) && node.data.length === 0) {\n        dom.remove(node);\n      }\n    };\n    var insertNode = function (dom, rng, node) {\n      rng.insertNode(node);\n      trimEmptyTextNode(dom, node.previousSibling);\n      trimEmptyTextNode(dom, node.nextSibling);\n    };\n    var insertFragment = function (dom, rng, frag) {\n      var firstChild = Option.from(frag.firstChild);\n      var lastChild = Option.from(frag.lastChild);\n      rng.insertNode(frag);\n      firstChild.each(function (child) {\n        return trimEmptyTextNode(dom, child.previousSibling);\n      });\n      lastChild.each(function (child) {\n        return trimEmptyTextNode(dom, child.nextSibling);\n      });\n    };\n    var rangeInsertNode = function (dom, rng, node) {\n      if (NodeType.isDocumentFragment(node)) {\n        insertFragment(dom, rng, node);\n      } else {\n        insertNode(dom, rng, node);\n      }\n    };\n\n    var isContentEditableFalse$2 = NodeType.isContentEditableFalse;\n    var getNormalizedTextOffset = function (trim, container, offset) {\n      var node, trimmedOffset;\n      trimmedOffset = trim(container.data.slice(0, offset)).length;\n      for (node = container.previousSibling; node && NodeType.isText(node); node = node.previousSibling) {\n        trimmedOffset += trim(node.data).length;\n      }\n      return trimmedOffset;\n    };\n    var getPoint = function (dom, trim, normalized, rng, start) {\n      var container = rng[start ? 'startContainer' : 'endContainer'];\n      var offset = rng[start ? 'startOffset' : 'endOffset'];\n      var point = [];\n      var childNodes, after = 0;\n      var root = dom.getRoot();\n      if (NodeType.isText(container)) {\n        point.push(normalized ? getNormalizedTextOffset(trim, container, offset) : offset);\n      } else {\n        childNodes = container.childNodes;\n        if (offset >= childNodes.length && childNodes.length) {\n          after = 1;\n          offset = Math.max(0, childNodes.length - 1);\n        }\n        point.push(dom.nodeIndex(childNodes[offset], normalized) + after);\n      }\n      for (; container && container !== root; container = container.parentNode) {\n        point.push(dom.nodeIndex(container, normalized));\n      }\n      return point;\n    };\n    var getLocation = function (trim, selection, normalized, rng) {\n      var dom = selection.dom, bookmark = {};\n      bookmark.start = getPoint(dom, trim, normalized, rng, true);\n      if (!selection.isCollapsed()) {\n        bookmark.end = getPoint(dom, trim, normalized, rng, false);\n      }\n      return bookmark;\n    };\n    var findIndex$2 = function (dom, name, element) {\n      var count = 0;\n      Tools.each(dom.select(name), function (node) {\n        if (node.getAttribute('data-mce-bogus') === 'all') {\n          return;\n        }\n        if (node === element) {\n          return false;\n        }\n        count++;\n      });\n      return count;\n    };\n    var moveEndPoint = function (rng, start) {\n      var container, offset, childNodes;\n      var prefix = start ? 'start' : 'end';\n      container = rng[prefix + 'Container'];\n      offset = rng[prefix + 'Offset'];\n      if (NodeType.isElement(container) && container.nodeName === 'TR') {\n        childNodes = container.childNodes;\n        container = childNodes[Math.min(start ? offset : offset - 1, childNodes.length - 1)];\n        if (container) {\n          offset = start ? 0 : container.childNodes.length;\n          rng['set' + (start ? 'Start' : 'End')](container, offset);\n        }\n      }\n    };\n    var normalizeTableCellSelection = function (rng) {\n      moveEndPoint(rng, true);\n      moveEndPoint(rng, false);\n      return rng;\n    };\n    var findSibling = function (node, offset) {\n      var sibling;\n      if (NodeType.isElement(node)) {\n        node = getNode(node, offset);\n        if (isContentEditableFalse$2(node)) {\n          return node;\n        }\n      }\n      if (isCaretContainer(node)) {\n        if (NodeType.isText(node) && isCaretContainerBlock(node)) {\n          node = node.parentNode;\n        }\n        sibling = node.previousSibling;\n        if (isContentEditableFalse$2(sibling)) {\n          return sibling;\n        }\n        sibling = node.nextSibling;\n        if (isContentEditableFalse$2(sibling)) {\n          return sibling;\n        }\n      }\n    };\n    var findAdjacentContentEditableFalseElm = function (rng) {\n      return findSibling(rng.startContainer, rng.startOffset) || findSibling(rng.endContainer, rng.endOffset);\n    };\n    var getOffsetBookmark = function (trim, normalized, selection) {\n      var element = selection.getNode();\n      var name = element ? element.nodeName : null;\n      var rng = selection.getRng();\n      if (isContentEditableFalse$2(element) || name === 'IMG') {\n        return {\n          name: name,\n          index: findIndex$2(selection.dom, name, element)\n        };\n      }\n      var sibling = findAdjacentContentEditableFalseElm(rng);\n      if (sibling) {\n        name = sibling.tagName;\n        return {\n          name: name,\n          index: findIndex$2(selection.dom, name, sibling)\n        };\n      }\n      return getLocation(trim, selection, normalized, rng);\n    };\n    var getCaretBookmark = function (selection) {\n      var rng = selection.getRng();\n      return {\n        start: create$2(selection.dom.getRoot(), CaretPosition$1.fromRangeStart(rng)),\n        end: create$2(selection.dom.getRoot(), CaretPosition$1.fromRangeEnd(rng))\n      };\n    };\n    var getRangeBookmark = function (selection) {\n      return { rng: selection.getRng() };\n    };\n    var createBookmarkSpan = function (dom, id, filled) {\n      var args = {\n        'data-mce-type': 'bookmark',\n        'id': id,\n        'style': 'overflow:hidden;line-height:0px'\n      };\n      return filled ? dom.create('span', args, '&#xFEFF;') : dom.create('span', args);\n    };\n    var getPersistentBookmark = function (selection, filled) {\n      var dom = selection.dom;\n      var rng = selection.getRng();\n      var id = dom.uniqueId();\n      var collapsed = selection.isCollapsed();\n      var element = selection.getNode();\n      var name = element.nodeName;\n      if (name === 'IMG') {\n        return {\n          name: name,\n          index: findIndex$2(dom, name, element)\n        };\n      }\n      var rng2 = normalizeTableCellSelection(rng.cloneRange());\n      if (!collapsed) {\n        rng2.collapse(false);\n        var endBookmarkNode = createBookmarkSpan(dom, id + '_end', filled);\n        rangeInsertNode(dom, rng2, endBookmarkNode);\n      }\n      rng = normalizeTableCellSelection(rng);\n      rng.collapse(true);\n      var startBookmarkNode = createBookmarkSpan(dom, id + '_start', filled);\n      rangeInsertNode(dom, rng, startBookmarkNode);\n      selection.moveToBookmark({\n        id: id,\n        keep: 1\n      });\n      return { id: id };\n    };\n    var getBookmark = function (selection, type, normalized) {\n      if (type === 2) {\n        return getOffsetBookmark(Zwsp.trim, normalized, selection);\n      } else if (type === 3) {\n        return getCaretBookmark(selection);\n      } else if (type) {\n        return getRangeBookmark(selection);\n      } else {\n        return getPersistentBookmark(selection, false);\n      }\n    };\n    var GetBookmark = {\n      getBookmark: getBookmark,\n      getUndoBookmark: curry(getOffsetBookmark, identity, true),\n      getPersistentBookmark: getPersistentBookmark\n    };\n\n    var TextWalker = function (startNode, rootNode, isBoundary) {\n      if (isBoundary === void 0) {\n        isBoundary = never;\n      }\n      var walker = new TreeWalker(startNode, rootNode);\n      var walk = function (direction) {\n        var next;\n        do {\n          next = walker[direction]();\n        } while (next && !NodeType.isText(next) && !isBoundary(next));\n        return Option.from(next).filter(NodeType.isText);\n      };\n      return {\n        current: function () {\n          return Option.from(walker.current()).filter(NodeType.isText);\n        },\n        next: function () {\n          return walk('next');\n        },\n        prev: function () {\n          return walk('prev');\n        },\n        prev2: function () {\n          return walk('prev2');\n        }\n      };\n    };\n\n    var TextSeeker = function (dom, isBoundary) {\n      var isBlockBoundary = isBoundary ? isBoundary : function (node) {\n        return dom.isBlock(node) || NodeType.isBr(node) || NodeType.isContentEditableFalse(node);\n      };\n      var walk = function (node, offset, walker, process) {\n        if (NodeType.isText(node)) {\n          var newOffset = process(node, offset, node.data);\n          if (newOffset !== -1) {\n            return Option.some({\n              container: node,\n              offset: newOffset\n            });\n          }\n        }\n        return walker().bind(function (next) {\n          return walk(next.container, next.offset, walker, process);\n        });\n      };\n      var backwards = function (node, offset, process, root) {\n        var walker = TextWalker(node, root, isBlockBoundary);\n        return walk(node, offset, function () {\n          return walker.prev().map(function (prev) {\n            return {\n              container: prev,\n              offset: prev.length\n            };\n          });\n        }, process).getOrNull();\n      };\n      var forwards = function (node, offset, process, root) {\n        var walker = TextWalker(node, root, isBlockBoundary);\n        return walk(node, offset, function () {\n          return walker.next().map(function (next) {\n            return {\n              container: next,\n              offset: 0\n            };\n          });\n        }, process).getOrNull();\n      };\n      return {\n        backwards: backwards,\n        forwards: forwards\n      };\n    };\n\n    var CARET_ID = '_mce_caret';\n    var isCaretNode = function (node) {\n      return NodeType.isElement(node) && node.id === CARET_ID;\n    };\n    var getParentCaretContainer = function (body, node) {\n      while (node && node !== body) {\n        if (node.id === CARET_ID) {\n          return node;\n        }\n        node = node.parentNode;\n      }\n      return null;\n    };\n\n    var isElement$4 = NodeType.isElement;\n    var isText$6 = NodeType.isText;\n    var removeNode = function (node) {\n      var parentNode = node.parentNode;\n      if (parentNode) {\n        parentNode.removeChild(node);\n      }\n    };\n    var getNodeValue = function (node) {\n      try {\n        return node.nodeValue;\n      } catch (ex) {\n        return '';\n      }\n    };\n    var setNodeValue = function (node, text) {\n      if (text.length === 0) {\n        removeNode(node);\n      } else {\n        node.nodeValue = text;\n      }\n    };\n    var trimCount = function (text) {\n      var trimmedText = Zwsp.trim(text);\n      return {\n        count: text.length - trimmedText.length,\n        text: trimmedText\n      };\n    };\n    var removeUnchanged = function (caretContainer, pos) {\n      remove$5(caretContainer);\n      return pos;\n    };\n    var removeTextAndReposition = function (caretContainer, pos) {\n      var before = trimCount(caretContainer.data.substr(0, pos.offset()));\n      var after = trimCount(caretContainer.data.substr(pos.offset()));\n      var text = before.text + after.text;\n      if (text.length > 0) {\n        setNodeValue(caretContainer, text);\n        return CaretPosition$1(caretContainer, pos.offset() - before.count);\n      } else {\n        return pos;\n      }\n    };\n    var removeElementAndReposition = function (caretContainer, pos) {\n      var parentNode = pos.container();\n      var newPosition = indexOf(from$1(parentNode.childNodes), caretContainer).map(function (index) {\n        return index < pos.offset() ? CaretPosition$1(parentNode, pos.offset() - 1) : pos;\n      }).getOr(pos);\n      remove$5(caretContainer);\n      return newPosition;\n    };\n    var removeTextCaretContainer = function (caretContainer, pos) {\n      return isText$6(caretContainer) && pos.container() === caretContainer ? removeTextAndReposition(caretContainer, pos) : removeUnchanged(caretContainer, pos);\n    };\n    var removeElementCaretContainer = function (caretContainer, pos) {\n      return pos.container() === caretContainer.parentNode ? removeElementAndReposition(caretContainer, pos) : removeUnchanged(caretContainer, pos);\n    };\n    var removeAndReposition = function (container, pos) {\n      return CaretPosition$1.isTextPosition(pos) ? removeTextCaretContainer(container, pos) : removeElementCaretContainer(container, pos);\n    };\n    var remove$5 = function (caretContainerNode) {\n      if (isElement$4(caretContainerNode) && isCaretContainer(caretContainerNode)) {\n        if (hasContent(caretContainerNode)) {\n          caretContainerNode.removeAttribute('data-mce-caret');\n        } else {\n          removeNode(caretContainerNode);\n        }\n      }\n      if (isText$6(caretContainerNode)) {\n        var text = Zwsp.trim(getNodeValue(caretContainerNode));\n        setNodeValue(caretContainerNode, text);\n      }\n    };\n    var CaretContainerRemove = {\n      removeAndReposition: removeAndReposition,\n      remove: remove$5\n    };\n\n    var DOM$1 = DOMUtils$1.DOM;\n    var getBodySetting = function (editor, name, defaultValue) {\n      var value = editor.getParam(name, defaultValue);\n      if (value.indexOf('=') !== -1) {\n        var bodyObj = editor.getParam(name, '', 'hash');\n        return bodyObj.hasOwnProperty(editor.id) ? bodyObj[editor.id] : defaultValue;\n      } else {\n        return value;\n      }\n    };\n    var getIframeAttrs = function (editor) {\n      return editor.getParam('iframe_attrs', {});\n    };\n    var getDocType = function (editor) {\n      return editor.getParam('doctype', '<!DOCTYPE html>');\n    };\n    var getDocumentBaseUrl = function (editor) {\n      return editor.getParam('document_base_url', '');\n    };\n    var getBodyId = function (editor) {\n      return getBodySetting(editor, 'body_id', 'tinymce');\n    };\n    var getBodyClass = function (editor) {\n      return getBodySetting(editor, 'body_class', '');\n    };\n    var getContentSecurityPolicy = function (editor) {\n      return editor.getParam('content_security_policy', '');\n    };\n    var shouldPutBrInPre = function (editor) {\n      return editor.getParam('br_in_pre', true);\n    };\n    var getForcedRootBlock = function (editor) {\n      if (editor.getParam('force_p_newlines', false)) {\n        return 'p';\n      }\n      var block = editor.getParam('forced_root_block', 'p');\n      if (block === false) {\n        return '';\n      } else if (block === true) {\n        return 'p';\n      } else {\n        return block;\n      }\n    };\n    var getForcedRootBlockAttrs = function (editor) {\n      return editor.getParam('forced_root_block_attrs', {});\n    };\n    var getBrNewLineSelector = function (editor) {\n      return editor.getParam('br_newline_selector', '.mce-toc h2,figcaption,caption');\n    };\n    var getNoNewLineSelector = function (editor) {\n      return editor.getParam('no_newline_selector', '');\n    };\n    var shouldKeepStyles = function (editor) {\n      return editor.getParam('keep_styles', true);\n    };\n    var shouldEndContainerOnEmptyBlock = function (editor) {\n      return editor.getParam('end_container_on_empty_block', false);\n    };\n    var getFontStyleValues = function (editor) {\n      return Tools.explode(editor.getParam('font_size_style_values', 'xx-small,x-small,small,medium,large,x-large,xx-large'));\n    };\n    var getFontSizeClasses = function (editor) {\n      return Tools.explode(editor.getParam('font_size_classes', ''));\n    };\n    var getImagesDataImgFilter = function (editor) {\n      return editor.getParam('images_dataimg_filter', constant(true), 'function');\n    };\n    var isAutomaticUploadsEnabled = function (editor) {\n      return editor.getParam('automatic_uploads', true, 'boolean');\n    };\n    var shouldReuseFileName = function (editor) {\n      return editor.getParam('images_reuse_filename', false, 'boolean');\n    };\n    var shouldReplaceBlobUris = function (editor) {\n      return editor.getParam('images_replace_blob_uris', true, 'boolean');\n    };\n    var getIconPackName = function (editor) {\n      return editor.getParam('icons', '', 'string');\n    };\n    var getIconsUrl = function (editor) {\n      return editor.getParam('icons_url', '', 'string');\n    };\n    var getImageUploadUrl = function (editor) {\n      return editor.getParam('images_upload_url', '', 'string');\n    };\n    var getImageUploadBasePath = function (editor) {\n      return editor.getParam('images_upload_base_path', '', 'string');\n    };\n    var getImagesUploadCredentials = function (editor) {\n      return editor.getParam('images_upload_credentials', false, 'boolean');\n    };\n    var getImagesUploadHandler = function (editor) {\n      return editor.getParam('images_upload_handler', null, 'function');\n    };\n    var shouldUseContentCssCors = function (editor) {\n      return editor.getParam('content_css_cors', false, 'boolean');\n    };\n    var getReferrerPolicy = function (editor) {\n      return editor.getParam('referrer_policy', '', 'string');\n    };\n    var getLanguageCode = function (editor) {\n      return editor.getParam('language', 'en', 'string');\n    };\n    var getLanguageUrl = function (editor) {\n      return editor.getParam('language_url', '', 'string');\n    };\n    var shouldIndentUseMargin = function (editor) {\n      return editor.getParam('indent_use_margin', false);\n    };\n    var getIndentation = function (editor) {\n      return editor.getParam('indentation', '40px', 'string');\n    };\n    var getContentCss = function (editor) {\n      var contentCss = editor.settings.content_css;\n      if (isString(contentCss)) {\n        return map(contentCss.split(','), trim);\n      } else if (isArray(contentCss)) {\n        return contentCss;\n      } else if (contentCss === false || editor.inline) {\n        return [];\n      } else {\n        return ['default'];\n      }\n    };\n    var getDirectionality = function (editor) {\n      return editor.getParam('directionality', I18n.isRtl() ? 'rtl' : undefined);\n    };\n    var getInlineBoundarySelector = function (editor) {\n      return editor.getParam('inline_boundaries_selector', 'a[href],code,.mce-annotation', 'string');\n    };\n    var getObjectResizing = function (editor) {\n      return editor.getParam('object_resizing');\n    };\n    var getResizeImgProportional = function (editor) {\n      return editor.getParam('resize_img_proportional', true, 'boolean');\n    };\n    var getPlaceholder = function (editor) {\n      return editor.getParam('placeholder', DOM$1.getAttrib(editor.getElement(), 'placeholder'), 'string');\n    };\n    var Settings = {\n      getIframeAttrs: getIframeAttrs,\n      getDocType: getDocType,\n      getDocumentBaseUrl: getDocumentBaseUrl,\n      getBodyId: getBodyId,\n      getBodyClass: getBodyClass,\n      getContentSecurityPolicy: getContentSecurityPolicy,\n      shouldPutBrInPre: shouldPutBrInPre,\n      getForcedRootBlock: getForcedRootBlock,\n      getForcedRootBlockAttrs: getForcedRootBlockAttrs,\n      getBrNewLineSelector: getBrNewLineSelector,\n      getNoNewLineSelector: getNoNewLineSelector,\n      shouldKeepStyles: shouldKeepStyles,\n      shouldEndContainerOnEmptyBlock: shouldEndContainerOnEmptyBlock,\n      getFontStyleValues: getFontStyleValues,\n      getFontSizeClasses: getFontSizeClasses,\n      getIconPackName: getIconPackName,\n      getIconsUrl: getIconsUrl,\n      getImagesDataImgFilter: getImagesDataImgFilter,\n      isAutomaticUploadsEnabled: isAutomaticUploadsEnabled,\n      shouldReuseFileName: shouldReuseFileName,\n      shouldReplaceBlobUris: shouldReplaceBlobUris,\n      getImageUploadUrl: getImageUploadUrl,\n      getImageUploadBasePath: getImageUploadBasePath,\n      getImagesUploadCredentials: getImagesUploadCredentials,\n      getImagesUploadHandler: getImagesUploadHandler,\n      shouldUseContentCssCors: shouldUseContentCssCors,\n      getReferrerPolicy: getReferrerPolicy,\n      getLanguageCode: getLanguageCode,\n      getLanguageUrl: getLanguageUrl,\n      shouldIndentUseMargin: shouldIndentUseMargin,\n      getIndentation: getIndentation,\n      getContentCss: getContentCss,\n      getDirectionality: getDirectionality,\n      getInlineBoundarySelector: getInlineBoundarySelector,\n      getObjectResizing: getObjectResizing,\n      getResizeImgProportional: getResizeImgProportional,\n      getPlaceholder: getPlaceholder\n    };\n\n    var browser$3 = detect$3().browser;\n    var isContentEditableFalse$3 = NodeType.isContentEditableFalse;\n    var isTableCell$1 = function (node) {\n      return NodeType.isElement(node) && /^(TD|TH)$/i.test(node.tagName);\n    };\n    var getAbsoluteClientRect = function (root, element, before) {\n      var clientRect = collapse(element.getBoundingClientRect(), before);\n      var docElm, scrollX, scrollY, margin, rootRect;\n      if (root.tagName === 'BODY') {\n        docElm = root.ownerDocument.documentElement;\n        scrollX = root.scrollLeft || docElm.scrollLeft;\n        scrollY = root.scrollTop || docElm.scrollTop;\n      } else {\n        rootRect = root.getBoundingClientRect();\n        scrollX = root.scrollLeft - rootRect.left;\n        scrollY = root.scrollTop - rootRect.top;\n      }\n      clientRect.left += scrollX;\n      clientRect.right += scrollX;\n      clientRect.top += scrollY;\n      clientRect.bottom += scrollY;\n      clientRect.width = 1;\n      margin = element.offsetWidth - element.clientWidth;\n      if (margin > 0) {\n        if (before) {\n          margin *= -1;\n        }\n        clientRect.left += margin;\n        clientRect.right += margin;\n      }\n      return clientRect;\n    };\n    var trimInlineCaretContainers = function (root) {\n      var contentEditableFalseNodes, node, sibling, i, data;\n      contentEditableFalseNodes = DomQuery('*[contentEditable=false]', root);\n      for (i = 0; i < contentEditableFalseNodes.length; i++) {\n        node = contentEditableFalseNodes[i];\n        sibling = node.previousSibling;\n        if (endsWithCaretContainer(sibling)) {\n          data = sibling.data;\n          if (data.length === 1) {\n            sibling.parentNode.removeChild(sibling);\n          } else {\n            sibling.deleteData(data.length - 1, 1);\n          }\n        }\n        sibling = node.nextSibling;\n        if (startsWithCaretContainer(sibling)) {\n          data = sibling.data;\n          if (data.length === 1) {\n            sibling.parentNode.removeChild(sibling);\n          } else {\n            sibling.deleteData(0, 1);\n          }\n        }\n      }\n    };\n    var FakeCaret = function (editor, root, isBlock, hasFocus) {\n      var lastVisualCaret = Cell(Option.none());\n      var cursorInterval, caretContainerNode;\n      var rootBlock = Settings.getForcedRootBlock(editor);\n      var caretBlock = rootBlock.length > 0 ? rootBlock : 'p';\n      var show = function (before, element) {\n        var clientRect, rng;\n        hide();\n        if (isTableCell$1(element)) {\n          return null;\n        }\n        if (isBlock(element)) {\n          caretContainerNode = insertBlock(caretBlock, element, before);\n          clientRect = getAbsoluteClientRect(root, element, before);\n          DomQuery(caretContainerNode).css('top', clientRect.top);\n          var caret = DomQuery('<div class=\"mce-visual-caret\" data-mce-bogus=\"all\"></div>').css(clientRect).appendTo(root)[0];\n          lastVisualCaret.set(Option.some({\n            caret: caret,\n            element: element,\n            before: before\n          }));\n          lastVisualCaret.get().each(function (caretState) {\n            if (before) {\n              DomQuery(caretState.caret).addClass('mce-visual-caret-before');\n            }\n          });\n          startBlink();\n          rng = element.ownerDocument.createRange();\n          rng.setStart(caretContainerNode, 0);\n          rng.setEnd(caretContainerNode, 0);\n        } else {\n          caretContainerNode = insertInline(element, before);\n          rng = element.ownerDocument.createRange();\n          if (isContentEditableFalse$3(caretContainerNode.nextSibling)) {\n            rng.setStart(caretContainerNode, 0);\n            rng.setEnd(caretContainerNode, 0);\n          } else {\n            rng.setStart(caretContainerNode, 1);\n            rng.setEnd(caretContainerNode, 1);\n          }\n          return rng;\n        }\n        return rng;\n      };\n      var hide = function () {\n        trimInlineCaretContainers(root);\n        if (caretContainerNode) {\n          CaretContainerRemove.remove(caretContainerNode);\n          caretContainerNode = null;\n        }\n        lastVisualCaret.get().each(function (caretState) {\n          DomQuery(caretState.caret).remove();\n          lastVisualCaret.set(Option.none());\n        });\n        Delay.clearInterval(cursorInterval);\n      };\n      var startBlink = function () {\n        cursorInterval = Delay.setInterval(function () {\n          if (hasFocus()) {\n            DomQuery('div.mce-visual-caret', root).toggleClass('mce-visual-caret-hidden');\n          } else {\n            DomQuery('div.mce-visual-caret', root).addClass('mce-visual-caret-hidden');\n          }\n        }, 500);\n      };\n      var reposition = function () {\n        lastVisualCaret.get().each(function (caretState) {\n          var clientRect = getAbsoluteClientRect(root, caretState.element, caretState.before);\n          DomQuery(caretState.caret).css(__assign({}, clientRect));\n        });\n      };\n      var destroy = function () {\n        return Delay.clearInterval(cursorInterval);\n      };\n      var getCss = function () {\n        return '.mce-visual-caret {' + 'position: absolute;' + 'background-color: black;' + 'background-color: currentcolor;' + '}' + '.mce-visual-caret-hidden {' + 'display: none;' + '}' + '*[data-mce-caret] {' + 'position: absolute;' + 'left: -1000px;' + 'right: auto;' + 'top: 0;' + 'margin: 0;' + 'padding: 0;' + '}';\n      };\n      return {\n        show: show,\n        hide: hide,\n        getCss: getCss,\n        reposition: reposition,\n        destroy: destroy\n      };\n    };\n    var isFakeCaretTableBrowser = function () {\n      return browser$3.isIE() || browser$3.isEdge() || browser$3.isFirefox();\n    };\n    var isFakeCaretTarget = function (node) {\n      return isContentEditableFalse$3(node) || NodeType.isTable(node) && isFakeCaretTableBrowser();\n    };\n\n    var isContentEditableFalse$4 = NodeType.isContentEditableFalse;\n    var isBlockLike = NodeType.matchStyleValues('display', 'block table table-cell table-caption list-item');\n    var isCaretContainer$2 = isCaretContainer;\n    var isCaretContainerBlock$1 = isCaretContainerBlock;\n    var isElement$5 = NodeType.isElement;\n    var isCaretCandidate$2 = isCaretCandidate;\n    var isForwards = function (direction) {\n      return direction > 0;\n    };\n    var isBackwards = function (direction) {\n      return direction < 0;\n    };\n    var skipCaretContainers = function (walk, shallow) {\n      var node;\n      while (node = walk(shallow)) {\n        if (!isCaretContainerBlock$1(node)) {\n          return node;\n        }\n      }\n      return null;\n    };\n    var findNode = function (node, direction, predicateFn, rootNode, shallow) {\n      var walker = new TreeWalker(node, rootNode);\n      if (isBackwards(direction)) {\n        if (isContentEditableFalse$4(node) || isCaretContainerBlock$1(node)) {\n          node = skipCaretContainers(walker.prev, true);\n          if (predicateFn(node)) {\n            return node;\n          }\n        }\n        while (node = skipCaretContainers(walker.prev, shallow)) {\n          if (predicateFn(node)) {\n            return node;\n          }\n        }\n      }\n      if (isForwards(direction)) {\n        if (isContentEditableFalse$4(node) || isCaretContainerBlock$1(node)) {\n          node = skipCaretContainers(walker.next, true);\n          if (predicateFn(node)) {\n            return node;\n          }\n        }\n        while (node = skipCaretContainers(walker.next, shallow)) {\n          if (predicateFn(node)) {\n            return node;\n          }\n        }\n      }\n      return null;\n    };\n    var getParentBlock = function (node, rootNode) {\n      while (node && node !== rootNode) {\n        if (isBlockLike(node)) {\n          return node;\n        }\n        node = node.parentNode;\n      }\n      return null;\n    };\n    var isInSameBlock = function (caretPosition1, caretPosition2, rootNode) {\n      return getParentBlock(caretPosition1.container(), rootNode) === getParentBlock(caretPosition2.container(), rootNode);\n    };\n    var getChildNodeAtRelativeOffset = function (relativeOffset, caretPosition) {\n      var container, offset;\n      if (!caretPosition) {\n        return null;\n      }\n      container = caretPosition.container();\n      offset = caretPosition.offset();\n      if (!isElement$5(container)) {\n        return null;\n      }\n      return container.childNodes[offset + relativeOffset];\n    };\n    var beforeAfter = function (before, node) {\n      var range = node.ownerDocument.createRange();\n      if (before) {\n        range.setStartBefore(node);\n        range.setEndBefore(node);\n      } else {\n        range.setStartAfter(node);\n        range.setEndAfter(node);\n      }\n      return range;\n    };\n    var isNodesInSameBlock = function (root, node1, node2) {\n      return getParentBlock(node1, root) === getParentBlock(node2, root);\n    };\n    var lean = function (left, root, node) {\n      var sibling, siblingName;\n      if (left) {\n        siblingName = 'previousSibling';\n      } else {\n        siblingName = 'nextSibling';\n      }\n      while (node && node !== root) {\n        sibling = node[siblingName];\n        if (isCaretContainer$2(sibling)) {\n          sibling = sibling[siblingName];\n        }\n        if (isContentEditableFalse$4(sibling)) {\n          if (isNodesInSameBlock(root, sibling, node)) {\n            return sibling;\n          }\n          break;\n        }\n        if (isCaretCandidate$2(sibling)) {\n          break;\n        }\n        node = node.parentNode;\n      }\n      return null;\n    };\n    var before$2 = curry(beforeAfter, true);\n    var after$1 = curry(beforeAfter, false);\n    var normalizeRange = function (direction, root, range) {\n      var node, container, offset, location;\n      var leanLeft = curry(lean, true, root);\n      var leanRight = curry(lean, false, root);\n      container = range.startContainer;\n      offset = range.startOffset;\n      if (isCaretContainerBlock(container)) {\n        if (!isElement$5(container)) {\n          container = container.parentNode;\n        }\n        location = container.getAttribute('data-mce-caret');\n        if (location === 'before') {\n          node = container.nextSibling;\n          if (isFakeCaretTarget(node)) {\n            return before$2(node);\n          }\n        }\n        if (location === 'after') {\n          node = container.previousSibling;\n          if (isFakeCaretTarget(node)) {\n            return after$1(node);\n          }\n        }\n      }\n      if (!range.collapsed) {\n        return range;\n      }\n      if (NodeType.isText(container)) {\n        if (isCaretContainer$2(container)) {\n          if (direction === 1) {\n            node = leanRight(container);\n            if (node) {\n              return before$2(node);\n            }\n            node = leanLeft(container);\n            if (node) {\n              return after$1(node);\n            }\n          }\n          if (direction === -1) {\n            node = leanLeft(container);\n            if (node) {\n              return after$1(node);\n            }\n            node = leanRight(container);\n            if (node) {\n              return before$2(node);\n            }\n          }\n          return range;\n        }\n        if (endsWithCaretContainer(container) && offset >= container.data.length - 1) {\n          if (direction === 1) {\n            node = leanRight(container);\n            if (node) {\n              return before$2(node);\n            }\n          }\n          return range;\n        }\n        if (startsWithCaretContainer(container) && offset <= 1) {\n          if (direction === -1) {\n            node = leanLeft(container);\n            if (node) {\n              return after$1(node);\n            }\n          }\n          return range;\n        }\n        if (offset === container.data.length) {\n          node = leanRight(container);\n          if (node) {\n            return before$2(node);\n          }\n          return range;\n        }\n        if (offset === 0) {\n          node = leanLeft(container);\n          if (node) {\n            return after$1(node);\n          }\n          return range;\n        }\n      }\n      return range;\n    };\n    var getRelativeCefElm = function (forward, caretPosition) {\n      return Option.from(getChildNodeAtRelativeOffset(forward ? 0 : -1, caretPosition)).filter(isContentEditableFalse$4);\n    };\n    var getNormalizedRangeEndPoint = function (direction, root, range) {\n      var normalizedRange = normalizeRange(direction, root, range);\n      if (direction === -1) {\n        return CaretPosition.fromRangeStart(normalizedRange);\n      }\n      return CaretPosition.fromRangeEnd(normalizedRange);\n    };\n    var getElementFromPosition = function (pos) {\n      return Option.from(pos.getNode()).map(Element.fromDom);\n    };\n    var getElementFromPrevPosition = function (pos) {\n      return Option.from(pos.getNode(true)).map(Element.fromDom);\n    };\n    var getVisualCaretPosition = function (walkFn, caretPosition) {\n      while (caretPosition = walkFn(caretPosition)) {\n        if (caretPosition.isVisible()) {\n          return caretPosition;\n        }\n      }\n      return caretPosition;\n    };\n    var isMoveInsideSameBlock = function (from, to) {\n      var inSameBlock = isInSameBlock(from, to);\n      if (!inSameBlock && NodeType.isBr(from.getNode())) {\n        return true;\n      }\n      return inSameBlock;\n    };\n\n    var HDirection;\n    (function (HDirection) {\n      HDirection[HDirection['Backwards'] = -1] = 'Backwards';\n      HDirection[HDirection['Forwards'] = 1] = 'Forwards';\n    }(HDirection || (HDirection = {})));\n    var isContentEditableFalse$5 = NodeType.isContentEditableFalse;\n    var isText$7 = NodeType.isText;\n    var isElement$6 = NodeType.isElement;\n    var isBr$4 = NodeType.isBr;\n    var isCaretCandidate$3 = isCaretCandidate;\n    var isAtomic$1 = isAtomic;\n    var isEditableCaretCandidate$1 = isEditableCaretCandidate;\n    var getParents = function (node, root) {\n      var parents = [];\n      while (node && node !== root) {\n        parents.push(node);\n        node = node.parentNode;\n      }\n      return parents;\n    };\n    var nodeAtIndex = function (container, offset) {\n      if (container.hasChildNodes() && offset < container.childNodes.length) {\n        return container.childNodes[offset];\n      }\n      return null;\n    };\n    var getCaretCandidatePosition = function (direction, node) {\n      if (isForwards(direction)) {\n        if (isCaretCandidate$3(node.previousSibling) && !isText$7(node.previousSibling)) {\n          return CaretPosition$1.before(node);\n        }\n        if (isText$7(node)) {\n          return CaretPosition$1(node, 0);\n        }\n      }\n      if (isBackwards(direction)) {\n        if (isCaretCandidate$3(node.nextSibling) && !isText$7(node.nextSibling)) {\n          return CaretPosition$1.after(node);\n        }\n        if (isText$7(node)) {\n          return CaretPosition$1(node, node.data.length);\n        }\n      }\n      if (isBackwards(direction)) {\n        if (isBr$4(node)) {\n          return CaretPosition$1.before(node);\n        }\n        return CaretPosition$1.after(node);\n      }\n      return CaretPosition$1.before(node);\n    };\n    var moveForwardFromBr = function (root, nextNode) {\n      var nextSibling = nextNode.nextSibling;\n      if (nextSibling && isCaretCandidate$3(nextSibling)) {\n        if (isText$7(nextSibling)) {\n          return CaretPosition$1(nextSibling, 0);\n        } else {\n          return CaretPosition$1.before(nextSibling);\n        }\n      } else {\n        return findCaretPosition(HDirection.Forwards, CaretPosition$1.after(nextNode), root);\n      }\n    };\n    var findCaretPosition = function (direction, startPos, root) {\n      var node, nextNode, innerNode;\n      var rootContentEditableFalseElm, caretPosition;\n      if (!isElement$6(root) || !startPos) {\n        return null;\n      }\n      if (startPos.isEqual(CaretPosition$1.after(root)) && root.lastChild) {\n        caretPosition = CaretPosition$1.after(root.lastChild);\n        if (isBackwards(direction) && isCaretCandidate$3(root.lastChild) && isElement$6(root.lastChild)) {\n          return isBr$4(root.lastChild) ? CaretPosition$1.before(root.lastChild) : caretPosition;\n        }\n      } else {\n        caretPosition = startPos;\n      }\n      var container = caretPosition.container();\n      var offset = caretPosition.offset();\n      if (isText$7(container)) {\n        if (isBackwards(direction) && offset > 0) {\n          return CaretPosition$1(container, --offset);\n        }\n        if (isForwards(direction) && offset < container.length) {\n          return CaretPosition$1(container, ++offset);\n        }\n        node = container;\n      } else {\n        if (isBackwards(direction) && offset > 0) {\n          nextNode = nodeAtIndex(container, offset - 1);\n          if (isCaretCandidate$3(nextNode)) {\n            if (!isAtomic$1(nextNode)) {\n              innerNode = findNode(nextNode, direction, isEditableCaretCandidate$1, nextNode);\n              if (innerNode) {\n                if (isText$7(innerNode)) {\n                  return CaretPosition$1(innerNode, innerNode.data.length);\n                }\n                return CaretPosition$1.after(innerNode);\n              }\n            }\n            if (isText$7(nextNode)) {\n              return CaretPosition$1(nextNode, nextNode.data.length);\n            }\n            return CaretPosition$1.before(nextNode);\n          }\n        }\n        if (isForwards(direction) && offset < container.childNodes.length) {\n          nextNode = nodeAtIndex(container, offset);\n          if (isCaretCandidate$3(nextNode)) {\n            if (isBr$4(nextNode)) {\n              return moveForwardFromBr(root, nextNode);\n            }\n            if (!isAtomic$1(nextNode)) {\n              innerNode = findNode(nextNode, direction, isEditableCaretCandidate$1, nextNode);\n              if (innerNode) {\n                if (isText$7(innerNode)) {\n                  return CaretPosition$1(innerNode, 0);\n                }\n                return CaretPosition$1.before(innerNode);\n              }\n            }\n            if (isText$7(nextNode)) {\n              return CaretPosition$1(nextNode, 0);\n            }\n            return CaretPosition$1.after(nextNode);\n          }\n        }\n        node = nextNode ? nextNode : caretPosition.getNode();\n      }\n      if (isForwards(direction) && caretPosition.isAtEnd() || isBackwards(direction) && caretPosition.isAtStart()) {\n        node = findNode(node, direction, constant(true), root, true);\n        if (isEditableCaretCandidate$1(node, root)) {\n          return getCaretCandidatePosition(direction, node);\n        }\n      }\n      nextNode = findNode(node, direction, isEditableCaretCandidate$1, root);\n      rootContentEditableFalseElm = ArrUtils.last(filter(getParents(container, root), isContentEditableFalse$5));\n      if (rootContentEditableFalseElm && (!nextNode || !rootContentEditableFalseElm.contains(nextNode))) {\n        if (isForwards(direction)) {\n          caretPosition = CaretPosition$1.after(rootContentEditableFalseElm);\n        } else {\n          caretPosition = CaretPosition$1.before(rootContentEditableFalseElm);\n        }\n        return caretPosition;\n      }\n      if (nextNode) {\n        return getCaretCandidatePosition(direction, nextNode);\n      }\n      return null;\n    };\n    var CaretWalker = function (root) {\n      return {\n        next: function (caretPosition) {\n          return findCaretPosition(HDirection.Forwards, caretPosition, root);\n        },\n        prev: function (caretPosition) {\n          return findCaretPosition(HDirection.Backwards, caretPosition, root);\n        }\n      };\n    };\n\n    var walkToPositionIn = function (forward, root, start) {\n      var position = forward ? CaretPosition$1.before(start) : CaretPosition$1.after(start);\n      return fromPosition(forward, root, position);\n    };\n    var afterElement = function (node) {\n      return NodeType.isBr(node) ? CaretPosition$1.before(node) : CaretPosition$1.after(node);\n    };\n    var isBeforeOrStart = function (position) {\n      if (CaretPosition$1.isTextPosition(position)) {\n        return position.offset() === 0;\n      } else {\n        return isCaretCandidate(position.getNode());\n      }\n    };\n    var isAfterOrEnd = function (position) {\n      if (CaretPosition$1.isTextPosition(position)) {\n        var container = position.container();\n        return position.offset() === container.data.length;\n      } else {\n        return isCaretCandidate(position.getNode(true));\n      }\n    };\n    var isBeforeAfterSameElement = function (from, to) {\n      return !CaretPosition$1.isTextPosition(from) && !CaretPosition$1.isTextPosition(to) && from.getNode() === to.getNode(true);\n    };\n    var isAtBr = function (position) {\n      return !CaretPosition$1.isTextPosition(position) && NodeType.isBr(position.getNode());\n    };\n    var shouldSkipPosition = function (forward, from, to) {\n      if (forward) {\n        return !isBeforeAfterSameElement(from, to) && !isAtBr(from) && isAfterOrEnd(from) && isBeforeOrStart(to);\n      } else {\n        return !isBeforeAfterSameElement(to, from) && isBeforeOrStart(from) && isAfterOrEnd(to);\n      }\n    };\n    var fromPosition = function (forward, root, pos) {\n      var walker = CaretWalker(root);\n      return Option.from(forward ? walker.next(pos) : walker.prev(pos));\n    };\n    var navigate = function (forward, root, from) {\n      return fromPosition(forward, root, from).bind(function (to) {\n        if (isInSameBlock(from, to, root) && shouldSkipPosition(forward, from, to)) {\n          return fromPosition(forward, root, to);\n        } else {\n          return Option.some(to);\n        }\n      });\n    };\n    var navigateIgnore = function (forward, root, from, ignoreFilter) {\n      return navigate(forward, root, from).bind(function (pos) {\n        return ignoreFilter(pos) ? navigateIgnore(forward, root, pos, ignoreFilter) : Option.some(pos);\n      });\n    };\n    var positionIn = function (forward, element) {\n      var startNode = forward ? element.firstChild : element.lastChild;\n      if (NodeType.isText(startNode)) {\n        return Option.some(CaretPosition$1(startNode, forward ? 0 : startNode.data.length));\n      } else if (startNode) {\n        if (isCaretCandidate(startNode)) {\n          return Option.some(forward ? CaretPosition$1.before(startNode) : afterElement(startNode));\n        } else {\n          return walkToPositionIn(forward, element, startNode);\n        }\n      } else {\n        return Option.none();\n      }\n    };\n    var nextPosition = curry(fromPosition, true);\n    var prevPosition = curry(fromPosition, false);\n    var CaretFinder = {\n      fromPosition: fromPosition,\n      nextPosition: nextPosition,\n      prevPosition: prevPosition,\n      navigate: navigate,\n      navigateIgnore: navigateIgnore,\n      positionIn: positionIn,\n      firstPositionIn: curry(positionIn, true),\n      lastPositionIn: curry(positionIn, false)\n    };\n\n    var isStringPathBookmark = function (bookmark) {\n      return typeof bookmark.start === 'string';\n    };\n    var isRangeBookmark = function (bookmark) {\n      return bookmark.hasOwnProperty('rng');\n    };\n    var isIdBookmark = function (bookmark) {\n      return bookmark.hasOwnProperty('id');\n    };\n    var isIndexBookmark = function (bookmark) {\n      return bookmark.hasOwnProperty('name');\n    };\n    var isPathBookmark = function (bookmark) {\n      return Tools.isArray(bookmark.start);\n    };\n\n    var addBogus = function (dom, node) {\n      if (NodeType.isElement(node) && dom.isBlock(node) && !node.innerHTML && !Env.ie) {\n        node.innerHTML = '<br data-mce-bogus=\"1\" />';\n      }\n      return node;\n    };\n    var resolveCaretPositionBookmark = function (dom, bookmark) {\n      var rng, pos;\n      rng = dom.createRng();\n      pos = resolve$1(dom.getRoot(), bookmark.start);\n      rng.setStart(pos.container(), pos.offset());\n      pos = resolve$1(dom.getRoot(), bookmark.end);\n      rng.setEnd(pos.container(), pos.offset());\n      return rng;\n    };\n    var insertZwsp = function (node, rng) {\n      var textNode = node.ownerDocument.createTextNode(Zwsp.ZWSP);\n      node.appendChild(textNode);\n      rng.setStart(textNode, 0);\n      rng.setEnd(textNode, 0);\n    };\n    var isEmpty = function (node) {\n      return node.hasChildNodes() === false;\n    };\n    var tryFindRangePosition = function (node, rng) {\n      return CaretFinder.lastPositionIn(node).fold(function () {\n        return false;\n      }, function (pos) {\n        rng.setStart(pos.container(), pos.offset());\n        rng.setEnd(pos.container(), pos.offset());\n        return true;\n      });\n    };\n    var padEmptyCaretContainer = function (root, node, rng) {\n      if (isEmpty(node) && getParentCaretContainer(root, node)) {\n        insertZwsp(node, rng);\n        return true;\n      } else {\n        return false;\n      }\n    };\n    var setEndPoint = function (dom, start, bookmark, rng) {\n      var point = bookmark[start ? 'start' : 'end'];\n      var i, node, offset, children;\n      var root = dom.getRoot();\n      if (point) {\n        offset = point[0];\n        for (node = root, i = point.length - 1; i >= 1; i--) {\n          children = node.childNodes;\n          if (padEmptyCaretContainer(root, node, rng)) {\n            return true;\n          }\n          if (point[i] > children.length - 1) {\n            if (padEmptyCaretContainer(root, node, rng)) {\n              return true;\n            }\n            return tryFindRangePosition(node, rng);\n          }\n          node = children[point[i]];\n        }\n        if (node.nodeType === 3) {\n          offset = Math.min(point[0], node.nodeValue.length);\n        }\n        if (node.nodeType === 1) {\n          offset = Math.min(point[0], node.childNodes.length);\n        }\n        if (start) {\n          rng.setStart(node, offset);\n        } else {\n          rng.setEnd(node, offset);\n        }\n      }\n      return true;\n    };\n    var isValidTextNode = function (node) {\n      return NodeType.isText(node) && node.data.length > 0;\n    };\n    var restoreEndPoint = function (dom, suffix, bookmark) {\n      var marker = dom.get(bookmark.id + '_' + suffix), node, idx, next, prev;\n      var keep = bookmark.keep;\n      var container, offset;\n      if (marker) {\n        node = marker.parentNode;\n        if (suffix === 'start') {\n          if (!keep) {\n            idx = dom.nodeIndex(marker);\n          } else {\n            if (marker.hasChildNodes()) {\n              node = marker.firstChild;\n              idx = 1;\n            } else if (isValidTextNode(marker.nextSibling)) {\n              node = marker.nextSibling;\n              idx = 0;\n            } else if (isValidTextNode(marker.previousSibling)) {\n              node = marker.previousSibling;\n              idx = marker.previousSibling.data.length;\n            } else {\n              node = marker.parentNode;\n              idx = dom.nodeIndex(marker) + 1;\n            }\n          }\n          container = node;\n          offset = idx;\n        } else {\n          if (!keep) {\n            idx = dom.nodeIndex(marker);\n          } else {\n            if (marker.hasChildNodes()) {\n              node = marker.firstChild;\n              idx = 1;\n            } else if (isValidTextNode(marker.previousSibling)) {\n              node = marker.previousSibling;\n              idx = marker.previousSibling.data.length;\n            } else {\n              node = marker.parentNode;\n              idx = dom.nodeIndex(marker);\n            }\n          }\n          container = node;\n          offset = idx;\n        }\n        if (!keep) {\n          prev = marker.previousSibling;\n          next = marker.nextSibling;\n          Tools.each(Tools.grep(marker.childNodes), function (node) {\n            if (NodeType.isText(node)) {\n              node.nodeValue = node.nodeValue.replace(/\\uFEFF/g, '');\n            }\n          });\n          while (marker = dom.get(bookmark.id + '_' + suffix)) {\n            dom.remove(marker, true);\n          }\n          if (prev && next && prev.nodeType === next.nodeType && NodeType.isText(prev) && !Env.opera) {\n            idx = prev.nodeValue.length;\n            prev.appendData(next.nodeValue);\n            dom.remove(next);\n            if (suffix === 'start') {\n              container = prev;\n              offset = idx;\n            } else {\n              container = prev;\n              offset = idx;\n            }\n          }\n        }\n        return Option.some(CaretPosition$1(container, offset));\n      } else {\n        return Option.none();\n      }\n    };\n    var resolvePaths = function (dom, bookmark) {\n      var rng = dom.createRng();\n      if (setEndPoint(dom, true, bookmark, rng) && setEndPoint(dom, false, bookmark, rng)) {\n        return Option.some(rng);\n      } else {\n        return Option.none();\n      }\n    };\n    var resolveId = function (dom, bookmark) {\n      var startPos = restoreEndPoint(dom, 'start', bookmark);\n      var endPos = restoreEndPoint(dom, 'end', bookmark);\n      return lift2(startPos, endPos.or(startPos), function (spos, epos) {\n        var rng = dom.createRng();\n        rng.setStart(addBogus(dom, spos.container()), spos.offset());\n        rng.setEnd(addBogus(dom, epos.container()), epos.offset());\n        return rng;\n      });\n    };\n    var resolveIndex$1 = function (dom, bookmark) {\n      return Option.from(dom.select(bookmark.name)[bookmark.index]).map(function (elm) {\n        var rng = dom.createRng();\n        rng.selectNode(elm);\n        return rng;\n      });\n    };\n    var resolve$2 = function (selection, bookmark) {\n      var dom = selection.dom;\n      if (bookmark) {\n        if (isPathBookmark(bookmark)) {\n          return resolvePaths(dom, bookmark);\n        } else if (isStringPathBookmark(bookmark)) {\n          return Option.some(resolveCaretPositionBookmark(dom, bookmark));\n        } else if (isIdBookmark(bookmark)) {\n          return resolveId(dom, bookmark);\n        } else if (isIndexBookmark(bookmark)) {\n          return resolveIndex$1(dom, bookmark);\n        } else if (isRangeBookmark(bookmark)) {\n          return Option.some(bookmark.rng);\n        }\n      }\n      return Option.none();\n    };\n    var ResolveBookmark = { resolve: resolve$2 };\n\n    var getBookmark$1 = function (selection, type, normalized) {\n      return GetBookmark.getBookmark(selection, type, normalized);\n    };\n    var moveToBookmark = function (selection, bookmark) {\n      ResolveBookmark.resolve(selection, bookmark).each(function (rng) {\n        selection.setRng(rng);\n      });\n    };\n    var isBookmarkNode$1 = function (node) {\n      return NodeType.isElement(node) && node.tagName === 'SPAN' && node.getAttribute('data-mce-type') === 'bookmark';\n    };\n    var Bookmarks = {\n      getBookmark: getBookmark$1,\n      moveToBookmark: moveToBookmark,\n      isBookmarkNode: isBookmarkNode$1\n    };\n\n    var is$2 = function (expected) {\n      return function (actual) {\n        return expected === actual;\n      };\n    };\n    var isNbsp = is$2(nbsp);\n    var isWhiteSpace$1 = function (chr) {\n      return chr !== '' && ' \\f\\n\\r\\t\\x0B'.indexOf(chr) !== -1;\n    };\n    var isContent = function (chr) {\n      return !isWhiteSpace$1(chr) && !isNbsp(chr);\n    };\n\n    var isNode = function (node) {\n      return !!node.nodeType;\n    };\n    var isInlineBlock = function (node) {\n      return node && /^(IMG)$/.test(node.nodeName);\n    };\n    var moveStart = function (dom, selection, rng) {\n      var offset = rng.startOffset;\n      var container = rng.startContainer, walker, node, nodes;\n      if (rng.startContainer === rng.endContainer) {\n        if (isInlineBlock(rng.startContainer.childNodes[rng.startOffset])) {\n          return;\n        }\n      }\n      if (container.nodeType === 1) {\n        nodes = container.childNodes;\n        if (offset < nodes.length) {\n          container = nodes[offset];\n          walker = new TreeWalker(container, dom.getParent(container, dom.isBlock));\n        } else {\n          container = nodes[nodes.length - 1];\n          walker = new TreeWalker(container, dom.getParent(container, dom.isBlock));\n          walker.next(true);\n        }\n        for (node = walker.current(); node; node = walker.next()) {\n          if (node.nodeType === 3 && !isWhiteSpaceNode(node)) {\n            rng.setStart(node, 0);\n            selection.setRng(rng);\n            return;\n          }\n        }\n      }\n    };\n    var getNonWhiteSpaceSibling = function (node, next, inc) {\n      if (node) {\n        var nextName = next ? 'nextSibling' : 'previousSibling';\n        for (node = inc ? node : node[nextName]; node; node = node[nextName]) {\n          if (node.nodeType === 1 || !isWhiteSpaceNode(node)) {\n            return node;\n          }\n        }\n      }\n    };\n    var isTextBlock$1 = function (editor, name) {\n      if (isNode(name)) {\n        name = name.nodeName;\n      }\n      return !!editor.schema.getTextBlockElements()[name.toLowerCase()];\n    };\n    var isValid = function (ed, parent, child) {\n      return ed.schema.isValidChild(parent, child);\n    };\n    var isWhiteSpaceNode = function (node) {\n      return node && NodeType.isText(node) && /^([\\t \\r\\n]+|)$/.test(node.nodeValue);\n    };\n    var isEmptyTextNode = function (node) {\n      return node && NodeType.isText(node) && node.length === 0;\n    };\n    var replaceVars = function (value, vars) {\n      if (typeof value !== 'string') {\n        value = value(vars);\n      } else if (vars) {\n        value = value.replace(/%(\\w+)/g, function (str, name) {\n          return vars[name] || str;\n        });\n      }\n      return value;\n    };\n    var isEq = function (str1, str2) {\n      str1 = str1 || '';\n      str2 = str2 || '';\n      str1 = '' + (str1.nodeName || str1);\n      str2 = '' + (str2.nodeName || str2);\n      return str1.toLowerCase() === str2.toLowerCase();\n    };\n    var normalizeStyleValue = function (dom, value, name) {\n      if (name === 'color' || name === 'backgroundColor') {\n        value = dom.toHex(value);\n      }\n      if (name === 'fontWeight' && value === 700) {\n        value = 'bold';\n      }\n      if (name === 'fontFamily') {\n        value = value.replace(/[\\'\\\"]/g, '').replace(/,\\s+/g, ',');\n      }\n      return '' + value;\n    };\n    var getStyle = function (dom, node, name) {\n      return normalizeStyleValue(dom, dom.getStyle(node, name), name);\n    };\n    var getTextDecoration = function (dom, node) {\n      var decoration;\n      dom.getParent(node, function (n) {\n        decoration = dom.getStyle(n, 'text-decoration');\n        return decoration && decoration !== 'none';\n      });\n      return decoration;\n    };\n    var getParents$1 = function (dom, node, selector) {\n      return dom.getParents(node, selector, dom.getRoot());\n    };\n\n    var isBookmarkNode$2 = Bookmarks.isBookmarkNode;\n    var getParents$2 = getParents$1, isWhiteSpaceNode$1 = isWhiteSpaceNode, isTextBlock$2 = isTextBlock$1;\n    var isBogusBr = function (node) {\n      return node.nodeName === 'BR' && node.getAttribute('data-mce-bogus') && !node.nextSibling;\n    };\n    var findParentContentEditable = function (dom, node) {\n      var parent = node;\n      while (parent) {\n        if (NodeType.isElement(parent) && dom.getContentEditable(parent)) {\n          return dom.getContentEditable(parent) === 'false' ? parent : node;\n        }\n        parent = parent.parentNode;\n      }\n      return node;\n    };\n    var walkText = function (start, node, offset, predicate) {\n      var str = node.data;\n      for (var i = offset; start ? i >= 0 : i < str.length; start ? i-- : i++) {\n        if (predicate(str.charAt(i))) {\n          return start ? i + 1 : i;\n        }\n      }\n      return -1;\n    };\n    var findSpace = function (start, node, offset) {\n      return walkText(start, node, offset, function (c) {\n        return isNbsp(c) || isWhiteSpace$1(c);\n      });\n    };\n    var findContent = function (start, node, offset) {\n      return walkText(start, node, offset, isContent);\n    };\n    var findWordEndPoint = function (dom, body, container, offset, start, includeTrailingSpaces) {\n      var lastTextNode;\n      var rootNode = dom.getParent(container, dom.isBlock) || body;\n      var walk = function (container, offset, pred) {\n        var textSeeker = TextSeeker(dom);\n        var walker = start ? textSeeker.backwards : textSeeker.forwards;\n        return Option.from(walker(container, offset, function (text, textOffset) {\n          if (isBookmarkNode$2(text.parentNode)) {\n            return -1;\n          } else {\n            lastTextNode = text;\n            return pred(start, text, textOffset);\n          }\n        }, rootNode));\n      };\n      var spaceResult = walk(container, offset, findSpace);\n      return spaceResult.bind(function (result) {\n        return includeTrailingSpaces ? walk(result.container, result.offset + (start ? -1 : 0), findContent) : Option.some(result);\n      }).orThunk(function () {\n        return lastTextNode ? Option.some({\n          container: lastTextNode,\n          offset: start ? 0 : lastTextNode.length\n        }) : Option.none();\n      });\n    };\n    var findSelectorEndPoint = function (dom, format, rng, container, siblingName) {\n      if (NodeType.isText(container) && container.nodeValue.length === 0 && container[siblingName]) {\n        container = container[siblingName];\n      }\n      var parents = getParents$2(dom, container);\n      for (var i = 0; i < parents.length; i++) {\n        for (var y = 0; y < format.length; y++) {\n          var curFormat = format[y];\n          if ('collapsed' in curFormat && curFormat.collapsed !== rng.collapsed) {\n            continue;\n          }\n          if (dom.is(parents[i], curFormat.selector)) {\n            return parents[i];\n          }\n        }\n      }\n      return container;\n    };\n    var findBlockEndPoint = function (editor, format, container, siblingName) {\n      var node;\n      var dom = editor.dom;\n      var root = dom.getRoot();\n      if (!format[0].wrapper) {\n        node = dom.getParent(container, format[0].block, root);\n      }\n      if (!node) {\n        var scopeRoot = dom.getParent(container, 'LI,TD,TH');\n        node = dom.getParent(NodeType.isText(container) ? container.parentNode : container, function (node) {\n          return node !== root && isTextBlock$2(editor, node);\n        }, scopeRoot);\n      }\n      if (node && format[0].wrapper) {\n        node = getParents$2(dom, node, 'ul,ol').reverse()[0] || node;\n      }\n      if (!node) {\n        node = container;\n        while (node[siblingName] && !dom.isBlock(node[siblingName])) {\n          node = node[siblingName];\n          if (isEq(node, 'br')) {\n            break;\n          }\n        }\n      }\n      return node || container;\n    };\n    var findParentContainer = function (dom, format, startContainer, startOffset, endContainer, endOffset, start) {\n      var container, parent, sibling, siblingName, root;\n      container = parent = start ? startContainer : endContainer;\n      siblingName = start ? 'previousSibling' : 'nextSibling';\n      root = dom.getRoot();\n      if (NodeType.isText(container) && !isWhiteSpaceNode$1(container)) {\n        if (start ? startOffset > 0 : endOffset < container.nodeValue.length) {\n          return container;\n        }\n      }\n      while (true) {\n        if (!format[0].block_expand && dom.isBlock(parent)) {\n          return parent;\n        }\n        for (sibling = parent[siblingName]; sibling; sibling = sibling[siblingName]) {\n          if (!isBookmarkNode$2(sibling) && !isWhiteSpaceNode$1(sibling) && !isBogusBr(sibling)) {\n            return parent;\n          }\n        }\n        if (parent === root || parent.parentNode === root) {\n          container = parent;\n          break;\n        }\n        parent = parent.parentNode;\n      }\n      return container;\n    };\n    var expandRng = function (editor, rng, format, includeTrailingSpace) {\n      if (includeTrailingSpace === void 0) {\n        includeTrailingSpace = false;\n      }\n      var startContainer = rng.startContainer, startOffset = rng.startOffset, endContainer = rng.endContainer, endOffset = rng.endOffset;\n      var dom = editor.dom;\n      if (NodeType.isElement(startContainer) && startContainer.hasChildNodes()) {\n        startContainer = getNode(startContainer, startOffset);\n        if (NodeType.isText(startContainer)) {\n          startOffset = 0;\n        }\n      }\n      if (NodeType.isElement(endContainer) && endContainer.hasChildNodes()) {\n        endContainer = getNode(endContainer, rng.collapsed ? endOffset : endOffset - 1);\n        if (NodeType.isText(endContainer)) {\n          endOffset = endContainer.nodeValue.length;\n        }\n      }\n      startContainer = findParentContentEditable(dom, startContainer);\n      endContainer = findParentContentEditable(dom, endContainer);\n      if (isBookmarkNode$2(startContainer.parentNode) || isBookmarkNode$2(startContainer)) {\n        startContainer = isBookmarkNode$2(startContainer) ? startContainer : startContainer.parentNode;\n        if (rng.collapsed) {\n          startContainer = startContainer.previousSibling || startContainer;\n        } else {\n          startContainer = startContainer.nextSibling || startContainer;\n        }\n        if (NodeType.isText(startContainer)) {\n          startOffset = rng.collapsed ? startContainer.length : 0;\n        }\n      }\n      if (isBookmarkNode$2(endContainer.parentNode) || isBookmarkNode$2(endContainer)) {\n        endContainer = isBookmarkNode$2(endContainer) ? endContainer : endContainer.parentNode;\n        if (rng.collapsed) {\n          endContainer = endContainer.nextSibling || endContainer;\n        } else {\n          endContainer = endContainer.previousSibling || endContainer;\n        }\n        if (NodeType.isText(endContainer)) {\n          endOffset = rng.collapsed ? 0 : endContainer.length;\n        }\n      }\n      if (rng.collapsed) {\n        var startPoint = findWordEndPoint(dom, editor.getBody(), startContainer, startOffset, true, includeTrailingSpace);\n        startPoint.each(function (_a) {\n          var container = _a.container, offset = _a.offset;\n          startContainer = container;\n          startOffset = offset;\n        });\n        var endPoint = findWordEndPoint(dom, editor.getBody(), endContainer, endOffset, false, includeTrailingSpace);\n        endPoint.each(function (_a) {\n          var container = _a.container, offset = _a.offset;\n          endContainer = container;\n          endOffset = offset;\n        });\n      }\n      if (format[0].inline || format[0].block_expand) {\n        if (!format[0].inline || (!NodeType.isText(startContainer) || startOffset === 0)) {\n          startContainer = findParentContainer(dom, format, startContainer, startOffset, endContainer, endOffset, true);\n        }\n        if (!format[0].inline || (!NodeType.isText(endContainer) || endOffset === endContainer.nodeValue.length)) {\n          endContainer = findParentContainer(dom, format, startContainer, startOffset, endContainer, endOffset, false);\n        }\n      }\n      if (format[0].selector && format[0].expand !== false && !format[0].inline) {\n        startContainer = findSelectorEndPoint(dom, format, rng, startContainer, 'previousSibling');\n        endContainer = findSelectorEndPoint(dom, format, rng, endContainer, 'nextSibling');\n      }\n      if (format[0].block || format[0].selector) {\n        startContainer = findBlockEndPoint(editor, format, startContainer, 'previousSibling');\n        endContainer = findBlockEndPoint(editor, format, endContainer, 'nextSibling');\n        if (format[0].block) {\n          if (!dom.isBlock(startContainer)) {\n            startContainer = findParentContainer(dom, format, startContainer, startOffset, endContainer, endOffset, true);\n          }\n          if (!dom.isBlock(endContainer)) {\n            endContainer = findParentContainer(dom, format, startContainer, startOffset, endContainer, endOffset, false);\n          }\n        }\n      }\n      if (NodeType.isElement(startContainer)) {\n        startOffset = dom.nodeIndex(startContainer);\n        startContainer = startContainer.parentNode;\n      }\n      if (NodeType.isElement(endContainer)) {\n        endOffset = dom.nodeIndex(endContainer) + 1;\n        endContainer = endContainer.parentNode;\n      }\n      return {\n        startContainer: startContainer,\n        startOffset: startOffset,\n        endContainer: endContainer,\n        endOffset: endOffset\n      };\n    };\n\n    var each$7 = Tools.each;\n    var getEndChild = function (container, index) {\n      var childNodes = container.childNodes;\n      index--;\n      if (index > childNodes.length - 1) {\n        index = childNodes.length - 1;\n      } else if (index < 0) {\n        index = 0;\n      }\n      return childNodes[index] || container;\n    };\n    var walk$1 = function (dom, rng, callback) {\n      var startContainer = rng.startContainer;\n      var startOffset = rng.startOffset;\n      var endContainer = rng.endContainer;\n      var endOffset = rng.endOffset;\n      var nodes = dom.select('td[data-mce-selected],th[data-mce-selected]');\n      if (nodes.length > 0) {\n        each$7(nodes, function (node) {\n          callback([node]);\n        });\n        return;\n      }\n      var exclude = function (nodes) {\n        var node;\n        node = nodes[0];\n        if (node.nodeType === 3 && node === startContainer && startOffset >= node.nodeValue.length) {\n          nodes.splice(0, 1);\n        }\n        node = nodes[nodes.length - 1];\n        if (endOffset === 0 && nodes.length > 0 && node === endContainer && node.nodeType === 3) {\n          nodes.splice(nodes.length - 1, 1);\n        }\n        return nodes;\n      };\n      var collectSiblings = function (node, name, endNode) {\n        var siblings = [];\n        for (; node && node !== endNode; node = node[name]) {\n          siblings.push(node);\n        }\n        return siblings;\n      };\n      var findEndPoint = function (node, root) {\n        do {\n          if (node.parentNode === root) {\n            return node;\n          }\n          node = node.parentNode;\n        } while (node);\n      };\n      var walkBoundary = function (startNode, endNode, next) {\n        var siblingName = next ? 'nextSibling' : 'previousSibling';\n        for (var node = startNode, parent_1 = node.parentNode; node && node !== endNode; node = parent_1) {\n          parent_1 = node.parentNode;\n          var siblings_1 = collectSiblings(node === startNode ? node : node[siblingName], siblingName);\n          if (siblings_1.length) {\n            if (!next) {\n              siblings_1.reverse();\n            }\n            callback(exclude(siblings_1));\n          }\n        }\n      };\n      if (startContainer.nodeType === 1 && startContainer.hasChildNodes()) {\n        startContainer = startContainer.childNodes[startOffset];\n      }\n      if (endContainer.nodeType === 1 && endContainer.hasChildNodes()) {\n        endContainer = getEndChild(endContainer, endOffset);\n      }\n      if (startContainer === endContainer) {\n        return callback(exclude([startContainer]));\n      }\n      var ancestor = dom.findCommonAncestor(startContainer, endContainer);\n      for (var node = startContainer; node; node = node.parentNode) {\n        if (node === endContainer) {\n          return walkBoundary(startContainer, ancestor, true);\n        }\n        if (node === ancestor) {\n          break;\n        }\n      }\n      for (var node = endContainer; node; node = node.parentNode) {\n        if (node === startContainer) {\n          return walkBoundary(endContainer, ancestor);\n        }\n        if (node === ancestor) {\n          break;\n        }\n      }\n      var startPoint = findEndPoint(startContainer, ancestor) || startContainer;\n      var endPoint = findEndPoint(endContainer, ancestor) || endContainer;\n      walkBoundary(startContainer, startPoint, true);\n      var siblings = collectSiblings(startPoint === startContainer ? startPoint : startPoint.nextSibling, 'nextSibling', endPoint === endContainer ? endPoint.nextSibling : endPoint);\n      if (siblings.length) {\n        callback(exclude(siblings));\n      }\n      walkBoundary(endContainer, endPoint);\n    };\n    var RangeWalk = { walk: walk$1 };\n\n    function NodeValue (is, name) {\n      var get = function (element) {\n        if (!is(element)) {\n          throw new Error('Can only get ' + name + ' value of a ' + name + ' node');\n        }\n        return getOption(element).getOr('');\n      };\n      var getOption = function (element) {\n        return is(element) ? Option.from(element.dom().nodeValue) : Option.none();\n      };\n      var set = function (element, value) {\n        if (!is(element)) {\n          throw new Error('Can only set raw ' + name + ' value of a ' + name + ' node');\n        }\n        element.dom().nodeValue = value;\n      };\n      return {\n        get: get,\n        getOption: getOption,\n        set: set\n      };\n    }\n\n    var api = NodeValue(isText, 'text');\n    var get$7 = function (element) {\n      return api.get(element);\n    };\n\n    var isZeroWidth = function (elem) {\n      return isText(elem) && get$7(elem) === zeroWidth;\n    };\n    var context = function (editor, elem, wrapName, nodeName) {\n      return parent(elem).fold(function () {\n        return 'skipping';\n      }, function (parent) {\n        if (nodeName === 'br' || isZeroWidth(elem)) {\n          return 'valid';\n        } else if (isAnnotation(elem)) {\n          return 'existing';\n        } else if (isCaretNode(elem)) {\n          return 'caret';\n        } else if (!isValid(editor, wrapName, nodeName) || !isValid(editor, name(parent), wrapName)) {\n          return 'invalid-child';\n        } else {\n          return 'valid';\n        }\n      });\n    };\n\n    var applyWordGrab = function (editor, rng) {\n      var r = expandRng(editor, rng, [{ inline: true }]);\n      rng.setStart(r.startContainer, r.startOffset);\n      rng.setEnd(r.endContainer, r.endOffset);\n      editor.selection.setRng(rng);\n    };\n    var makeAnnotation = function (eDoc, _a, annotationName, decorate) {\n      var _b = _a.uid, uid = _b === void 0 ? generate('mce-annotation') : _b, data = __rest(_a, ['uid']);\n      var master = Element.fromTag('span', eDoc);\n      add$3(master, annotation());\n      set(master, '' + dataAnnotationId(), uid);\n      set(master, '' + dataAnnotation(), annotationName);\n      var _c = decorate(uid, data), _d = _c.attributes, attributes = _d === void 0 ? {} : _d, _e = _c.classes, classes = _e === void 0 ? [] : _e;\n      setAll(master, attributes);\n      add$4(master, classes);\n      return master;\n    };\n    var annotate = function (editor, rng, annotationName, decorate, data) {\n      var newWrappers = [];\n      var master = makeAnnotation(editor.getDoc(), data, annotationName, decorate);\n      var wrapper = Cell(Option.none());\n      var finishWrapper = function () {\n        wrapper.set(Option.none());\n      };\n      var getOrOpenWrapper = function () {\n        return wrapper.get().getOrThunk(function () {\n          var nu = shallow(master);\n          newWrappers.push(nu);\n          wrapper.set(Option.some(nu));\n          return nu;\n        });\n      };\n      var processElements = function (elems) {\n        each(elems, processElement);\n      };\n      var processElement = function (elem) {\n        var ctx = context(editor, elem, 'span', name(elem));\n        switch (ctx) {\n        case 'invalid-child': {\n            finishWrapper();\n            var children$1 = children(elem);\n            processElements(children$1);\n            finishWrapper();\n            break;\n          }\n        case 'valid': {\n            var w = getOrOpenWrapper();\n            wrap(elem, w);\n            break;\n          }\n        }\n      };\n      var processNodes = function (nodes) {\n        var elems = map(nodes, Element.fromDom);\n        processElements(elems);\n      };\n      RangeWalk.walk(editor.dom, rng, function (nodes) {\n        finishWrapper();\n        processNodes(nodes);\n      });\n      return newWrappers;\n    };\n    var annotateWithBookmark = function (editor, name, settings, data) {\n      editor.undoManager.transact(function () {\n        var initialRng = editor.selection.getRng();\n        if (initialRng.collapsed) {\n          applyWordGrab(editor, initialRng);\n        }\n        if (editor.selection.getRng().collapsed) {\n          var wrapper = makeAnnotation(editor.getDoc(), data, name, settings.decorate);\n          set$1(wrapper, nbsp);\n          editor.selection.getRng().insertNode(wrapper.dom());\n          editor.selection.select(wrapper.dom());\n        } else {\n          var bookmark = GetBookmark.getPersistentBookmark(editor.selection, false);\n          var rng = editor.selection.getRng();\n          annotate(editor, rng, name, settings.decorate, data);\n          editor.selection.moveToBookmark(bookmark);\n        }\n      });\n    };\n\n    var Annotator = function (editor) {\n      var registry = create$1();\n      setup$1(editor, registry);\n      var changes = setup(editor);\n      return {\n        register: function (name, settings) {\n          registry.register(name, settings);\n        },\n        annotate: function (name, data) {\n          registry.lookup(name).each(function (settings) {\n            annotateWithBookmark(editor, name, settings, data);\n          });\n        },\n        annotationChanged: function (name, callback) {\n          changes.addListener(name, callback);\n        },\n        remove: function (name) {\n          identify(editor, Option.some(name)).each(function (_a) {\n            var elements = _a.elements;\n            each(elements, unwrap);\n          });\n        },\n        getAll: function (name) {\n          var directory = findAll(editor, name);\n          return map$1(directory, function (elems) {\n            return map(elems, function (elem) {\n              return elem.dom();\n            });\n          });\n        }\n      };\n    };\n\n    var whiteSpaceRegExp$3 = /^[ \\t\\r\\n]*$/;\n    var typeLookup = {\n      '#text': 3,\n      '#comment': 8,\n      '#cdata': 4,\n      '#pi': 7,\n      '#doctype': 10,\n      '#document-fragment': 11\n    };\n    var walk$2 = function (node, root, prev) {\n      var startName = prev ? 'lastChild' : 'firstChild';\n      var siblingName = prev ? 'prev' : 'next';\n      if (node[startName]) {\n        return node[startName];\n      }\n      if (node !== root) {\n        var sibling = node[siblingName];\n        if (sibling) {\n          return sibling;\n        }\n        for (var parent_1 = node.parent; parent_1 && parent_1 !== root; parent_1 = parent_1.parent) {\n          sibling = parent_1[siblingName];\n          if (sibling) {\n            return sibling;\n          }\n        }\n      }\n    };\n    var isEmptyTextNode$1 = function (node) {\n      if (!whiteSpaceRegExp$3.test(node.value)) {\n        return false;\n      }\n      var parentNode = node.parent;\n      if (parentNode && (parentNode.name !== 'span' || parentNode.attr('style')) && /^[ ]+$/.test(node.value)) {\n        return false;\n      }\n      return true;\n    };\n    var Node$1 = function () {\n      function Node(name, type) {\n        this.name = name;\n        this.type = type;\n        if (type === 1) {\n          this.attributes = [];\n          this.attributes.map = {};\n        }\n      }\n      Node.create = function (name, attrs) {\n        var node = new Node(name, typeLookup[name] || 1);\n        if (attrs) {\n          for (var attrName in attrs) {\n            node.attr(attrName, attrs[attrName]);\n          }\n        }\n        return node;\n      };\n      Node.prototype.replace = function (node) {\n        var self = this;\n        if (node.parent) {\n          node.remove();\n        }\n        self.insert(node, self);\n        self.remove();\n        return self;\n      };\n      Node.prototype.attr = function (name, value) {\n        var self = this;\n        var attrs;\n        if (typeof name !== 'string') {\n          for (var key in name) {\n            self.attr(key, name[key]);\n          }\n          return self;\n        }\n        if (attrs = self.attributes) {\n          if (value !== undefined) {\n            if (value === null) {\n              if (name in attrs.map) {\n                delete attrs.map[name];\n                var i = attrs.length;\n                while (i--) {\n                  if (attrs[i].name === name) {\n                    attrs.splice(i, 1);\n                    return self;\n                  }\n                }\n              }\n              return self;\n            }\n            if (name in attrs.map) {\n              var i = attrs.length;\n              while (i--) {\n                if (attrs[i].name === name) {\n                  attrs[i].value = value;\n                  break;\n                }\n              }\n            } else {\n              attrs.push({\n                name: name,\n                value: value\n              });\n            }\n            attrs.map[name] = value;\n            return self;\n          }\n          return attrs.map[name];\n        }\n      };\n      Node.prototype.clone = function () {\n        var self = this;\n        var clone = new Node(self.name, self.type);\n        var selfAttrs;\n        if (selfAttrs = self.attributes) {\n          var cloneAttrs = [];\n          cloneAttrs.map = {};\n          for (var i = 0, l = selfAttrs.length; i < l; i++) {\n            var selfAttr = selfAttrs[i];\n            if (selfAttr.name !== 'id') {\n              cloneAttrs[cloneAttrs.length] = {\n                name: selfAttr.name,\n                value: selfAttr.value\n              };\n              cloneAttrs.map[selfAttr.name] = selfAttr.value;\n            }\n          }\n          clone.attributes = cloneAttrs;\n        }\n        clone.value = self.value;\n        clone.shortEnded = self.shortEnded;\n        return clone;\n      };\n      Node.prototype.wrap = function (wrapper) {\n        var self = this;\n        self.parent.insert(wrapper, self);\n        wrapper.append(self);\n        return self;\n      };\n      Node.prototype.unwrap = function () {\n        var self = this;\n        for (var node = self.firstChild; node;) {\n          var next = node.next;\n          self.insert(node, self, true);\n          node = next;\n        }\n        self.remove();\n      };\n      Node.prototype.remove = function () {\n        var self = this, parent = self.parent, next = self.next, prev = self.prev;\n        if (parent) {\n          if (parent.firstChild === self) {\n            parent.firstChild = next;\n            if (next) {\n              next.prev = null;\n            }\n          } else {\n            prev.next = next;\n          }\n          if (parent.lastChild === self) {\n            parent.lastChild = prev;\n            if (prev) {\n              prev.next = null;\n            }\n          } else {\n            next.prev = prev;\n          }\n          self.parent = self.next = self.prev = null;\n        }\n        return self;\n      };\n      Node.prototype.append = function (node) {\n        var self = this;\n        if (node.parent) {\n          node.remove();\n        }\n        var last = self.lastChild;\n        if (last) {\n          last.next = node;\n          node.prev = last;\n          self.lastChild = node;\n        } else {\n          self.lastChild = self.firstChild = node;\n        }\n        node.parent = self;\n        return node;\n      };\n      Node.prototype.insert = function (node, refNode, before) {\n        if (node.parent) {\n          node.remove();\n        }\n        var parent = refNode.parent || this;\n        if (before) {\n          if (refNode === parent.firstChild) {\n            parent.firstChild = node;\n          } else {\n            refNode.prev.next = node;\n          }\n          node.prev = refNode.prev;\n          node.next = refNode;\n          refNode.prev = node;\n        } else {\n          if (refNode === parent.lastChild) {\n            parent.lastChild = node;\n          } else {\n            refNode.next.prev = node;\n          }\n          node.next = refNode.next;\n          node.prev = refNode;\n          refNode.next = node;\n        }\n        node.parent = parent;\n        return node;\n      };\n      Node.prototype.getAll = function (name) {\n        var self = this;\n        var collection = [];\n        for (var node = self.firstChild; node; node = walk$2(node, self)) {\n          if (node.name === name) {\n            collection.push(node);\n          }\n        }\n        return collection;\n      };\n      Node.prototype.empty = function () {\n        var self = this;\n        if (self.firstChild) {\n          var nodes = [];\n          for (var node = self.firstChild; node; node = walk$2(node, self)) {\n            nodes.push(node);\n          }\n          var i = nodes.length;\n          while (i--) {\n            var node = nodes[i];\n            node.parent = node.firstChild = node.lastChild = node.next = node.prev = null;\n          }\n        }\n        self.firstChild = self.lastChild = null;\n        return self;\n      };\n      Node.prototype.isEmpty = function (elements, whitespace, predicate) {\n        if (whitespace === void 0) {\n          whitespace = {};\n        }\n        var self = this;\n        var node = self.firstChild;\n        if (node) {\n          do {\n            if (node.type === 1) {\n              if (node.attr('data-mce-bogus')) {\n                continue;\n              }\n              if (elements[node.name]) {\n                return false;\n              }\n              var i = node.attributes.length;\n              while (i--) {\n                var name_1 = node.attributes[i].name;\n                if (name_1 === 'name' || name_1.indexOf('data-mce-bookmark') === 0) {\n                  return false;\n                }\n              }\n            }\n            if (node.type === 8) {\n              return false;\n            }\n            if (node.type === 3 && !isEmptyTextNode$1(node)) {\n              return false;\n            }\n            if (node.type === 3 && node.parent && whitespace[node.parent.name] && whiteSpaceRegExp$3.test(node.value)) {\n              return false;\n            }\n            if (predicate && predicate(node)) {\n              return false;\n            }\n          } while (node = walk$2(node, self));\n        }\n        return true;\n      };\n      Node.prototype.walk = function (prev) {\n        return walk$2(this, null, prev);\n      };\n      return Node;\n    }();\n\n    var isValidPrefixAttrName = function (name) {\n      return name.indexOf('data-') === 0 || name.indexOf('aria-') === 0;\n    };\n    var isInvalidUri = function (settings, uri) {\n      if (settings.allow_html_data_urls) {\n        return false;\n      } else if (/^data:image\\//i.test(uri)) {\n        return settings.allow_svg_data_urls === false && /^data:image\\/svg\\+xml/i.test(uri);\n      } else {\n        return /^data:/i.test(uri);\n      }\n    };\n    var findEndTagIndex = function (schema, html, startIndex) {\n      var count = 1, index, matches, tokenRegExp, shortEndedElements;\n      shortEndedElements = schema.getShortEndedElements();\n      tokenRegExp = /<([!?\\/])?([A-Za-z0-9\\-_\\:\\.]+)((?:\\s+[^\"\\'>]+(?:(?:\"[^\"]*\")|(?:\\'[^\\']*\\')|[^>]*))*|\\/|\\s+)>/g;\n      tokenRegExp.lastIndex = index = startIndex;\n      while (matches = tokenRegExp.exec(html)) {\n        index = tokenRegExp.lastIndex;\n        if (matches[1] === '/') {\n          count--;\n        } else if (!matches[1]) {\n          if (matches[2] in shortEndedElements) {\n            continue;\n          }\n          count++;\n        }\n        if (count === 0) {\n          break;\n        }\n      }\n      return index;\n    };\n    var isConditionalComment = function (html, startIndex) {\n      return /^\\s*\\[if [\\w\\W]+\\]>.*<!\\[endif\\](--!?)?>/.test(html.substr(startIndex));\n    };\n    var findCommentEndIndex = function (html, isBogus, startIndex) {\n      if (startIndex === void 0) {\n        startIndex = 0;\n      }\n      var lcHtml = html.toLowerCase();\n      if (lcHtml.indexOf('[if ', startIndex) !== -1 && isConditionalComment(lcHtml, startIndex)) {\n        var endIfIndex = lcHtml.indexOf('[endif]', startIndex);\n        return lcHtml.indexOf('>', endIfIndex);\n      } else {\n        if (isBogus) {\n          var endIndex = lcHtml.indexOf('>', startIndex);\n          return endIndex !== -1 ? endIndex : lcHtml.length;\n        } else {\n          var endCommentRegexp = /--!?>/;\n          endCommentRegexp.lastIndex = startIndex;\n          var match = endCommentRegexp.exec(html);\n          return match ? match.index + match[0].length : lcHtml.length;\n        }\n      }\n    };\n    var checkBogusAttribute = function (regExp, attrString) {\n      var matches = regExp.exec(attrString);\n      if (matches) {\n        var name_1 = matches[1];\n        var value = matches[2];\n        return typeof name_1 === 'string' && name_1.toLowerCase() === 'data-mce-bogus' ? value : null;\n      } else {\n        return null;\n      }\n    };\n    function SaxParser(settings, schema) {\n      if (schema === void 0) {\n        schema = Schema();\n      }\n      var noop = function () {\n      };\n      settings = settings || {};\n      if (settings.fix_self_closing !== false) {\n        settings.fix_self_closing = true;\n      }\n      var comment = settings.comment ? settings.comment : noop;\n      var cdata = settings.cdata ? settings.cdata : noop;\n      var text = settings.text ? settings.text : noop;\n      var start = settings.start ? settings.start : noop;\n      var end = settings.end ? settings.end : noop;\n      var pi = settings.pi ? settings.pi : noop;\n      var doctype = settings.doctype ? settings.doctype : noop;\n      var parse = function (html, format) {\n        if (format === void 0) {\n          format = 'html';\n        }\n        var matches, index = 0, value, endRegExp;\n        var stack = [];\n        var attrList, i, textData, name;\n        var isInternalElement, removeInternalElements, shortEndedElements, fillAttrsMap, isShortEnded;\n        var validate, elementRule, isValidElement, attr, attribsValue, validAttributesMap, validAttributePatterns;\n        var attributesRequired, attributesDefault, attributesForced, processHtml;\n        var anyAttributesRequired, selfClosing, tokenRegExp, attrRegExp, specialElements, attrValue, idCount = 0;\n        var decode = Entities.decode;\n        var fixSelfClosing;\n        var filteredUrlAttrs = Tools.makeMap('src,href,data,background,formaction,poster,xlink:href');\n        var scriptUriRegExp = /((java|vb)script|mhtml):/i;\n        var parsingMode = format === 'html' ? 0 : 1;\n        var processEndTag = function (name) {\n          var pos, i;\n          pos = stack.length;\n          while (pos--) {\n            if (stack[pos].name === name) {\n              break;\n            }\n          }\n          if (pos >= 0) {\n            for (i = stack.length - 1; i >= pos; i--) {\n              name = stack[i];\n              if (name.valid) {\n                end(name.name);\n              }\n            }\n            stack.length = pos;\n          }\n        };\n        var processComment = function (value) {\n          if (value === '') {\n            return;\n          }\n          if (value.charAt(0) === '>') {\n            value = ' ' + value;\n          }\n          if (!settings.allow_conditional_comments && value.substr(0, 3).toLowerCase() === '[if') {\n            value = ' ' + value;\n          }\n          comment(value);\n        };\n        var processMalformedComment = function (value, startIndex) {\n          var startTag = value || '';\n          var isBogus = !startsWith(startTag, '--');\n          var endIndex = findCommentEndIndex(html, isBogus, startIndex);\n          value = html.substr(startIndex, endIndex - startIndex);\n          processComment(isBogus ? startTag + value : value);\n          return endIndex + 1;\n        };\n        var parseAttribute = function (match, name, value, val2, val3) {\n          var attrRule, i;\n          var trimRegExp = /[\\s\\u0000-\\u001F]+/g;\n          name = name.toLowerCase();\n          value = name in fillAttrsMap ? name : decode(value || val2 || val3 || '');\n          if (validate && !isInternalElement && isValidPrefixAttrName(name) === false) {\n            attrRule = validAttributesMap[name];\n            if (!attrRule && validAttributePatterns) {\n              i = validAttributePatterns.length;\n              while (i--) {\n                attrRule = validAttributePatterns[i];\n                if (attrRule.pattern.test(name)) {\n                  break;\n                }\n              }\n              if (i === -1) {\n                attrRule = null;\n              }\n            }\n            if (!attrRule) {\n              return;\n            }\n            if (attrRule.validValues && !(value in attrRule.validValues)) {\n              return;\n            }\n          }\n          if (filteredUrlAttrs[name] && !settings.allow_script_urls) {\n            var uri = value.replace(trimRegExp, '');\n            try {\n              uri = decodeURIComponent(uri);\n            } catch (ex) {\n              uri = unescape(uri);\n            }\n            if (scriptUriRegExp.test(uri)) {\n              return;\n            }\n            if (isInvalidUri(settings, uri)) {\n              return;\n            }\n          }\n          if (isInternalElement && (name in filteredUrlAttrs || name.indexOf('on') === 0)) {\n            return;\n          }\n          attrList.map[name] = value;\n          attrList.push({\n            name: name,\n            value: value\n          });\n        };\n        tokenRegExp = new RegExp('<(?:' + '(?:!--([\\\\w\\\\W]*?)--!?>)|' + '(?:!\\\\[CDATA\\\\[([\\\\w\\\\W]*?)\\\\]\\\\]>)|' + '(?:![Dd][Oo][Cc][Tt][Yy][Pp][Ee]([\\\\w\\\\W]*?)>)|' + '(?:!(--)?)|' + '(?:\\\\?([^\\\\s\\\\/<>]+) ?([\\\\w\\\\W]*?)[?/]>)|' + '(?:\\\\/([A-Za-z][A-Za-z0-9\\\\-_\\\\:\\\\.]*)>)|' + '(?:([A-Za-z][A-Za-z0-9\\\\-_\\\\:\\\\.]*)((?:\\\\s+[^\"\\'>]+(?:(?:\"[^\"]*\")|(?:\\'[^\\']*\\')|[^>]*))*|\\\\/|\\\\s+)>)' + ')', 'g');\n        attrRegExp = /([\\w:\\-]+)(?:\\s*=\\s*(?:(?:\\\"((?:[^\\\"])*)\\\")|(?:\\'((?:[^\\'])*)\\')|([^>\\s]+)))?/g;\n        shortEndedElements = schema.getShortEndedElements();\n        selfClosing = settings.self_closing_elements || schema.getSelfClosingElements();\n        fillAttrsMap = schema.getBoolAttrs();\n        validate = settings.validate;\n        removeInternalElements = settings.remove_internals;\n        fixSelfClosing = settings.fix_self_closing;\n        specialElements = schema.getSpecialElements();\n        processHtml = html + '>';\n        while (matches = tokenRegExp.exec(processHtml)) {\n          var matchText = matches[0];\n          if (index < matches.index) {\n            text(decode(html.substr(index, matches.index - index)));\n          }\n          if (value = matches[7]) {\n            value = value.toLowerCase();\n            if (value.charAt(0) === ':') {\n              value = value.substr(1);\n            }\n            processEndTag(value);\n          } else if (value = matches[8]) {\n            if (matches.index + matchText.length > html.length) {\n              text(decode(html.substr(matches.index)));\n              index = matches.index + matchText.length;\n              continue;\n            }\n            value = value.toLowerCase();\n            if (value.charAt(0) === ':') {\n              value = value.substr(1);\n            }\n            isShortEnded = value in shortEndedElements;\n            if (fixSelfClosing && selfClosing[value] && stack.length > 0 && stack[stack.length - 1].name === value) {\n              processEndTag(value);\n            }\n            var bogusValue = checkBogusAttribute(attrRegExp, matches[9]);\n            if (bogusValue !== null) {\n              if (bogusValue === 'all') {\n                index = findEndTagIndex(schema, html, tokenRegExp.lastIndex);\n                tokenRegExp.lastIndex = index;\n                continue;\n              }\n              isValidElement = false;\n            }\n            if (!validate || (elementRule = schema.getElementRule(value))) {\n              isValidElement = true;\n              if (validate) {\n                validAttributesMap = elementRule.attributes;\n                validAttributePatterns = elementRule.attributePatterns;\n              }\n              if (attribsValue = matches[9]) {\n                isInternalElement = attribsValue.indexOf('data-mce-type') !== -1;\n                if (isInternalElement && removeInternalElements) {\n                  isValidElement = false;\n                }\n                attrList = [];\n                attrList.map = {};\n                attribsValue.replace(attrRegExp, parseAttribute);\n              } else {\n                attrList = [];\n                attrList.map = {};\n              }\n              if (validate && !isInternalElement) {\n                attributesRequired = elementRule.attributesRequired;\n                attributesDefault = elementRule.attributesDefault;\n                attributesForced = elementRule.attributesForced;\n                anyAttributesRequired = elementRule.removeEmptyAttrs;\n                if (anyAttributesRequired && !attrList.length) {\n                  isValidElement = false;\n                }\n                if (attributesForced) {\n                  i = attributesForced.length;\n                  while (i--) {\n                    attr = attributesForced[i];\n                    name = attr.name;\n                    attrValue = attr.value;\n                    if (attrValue === '{$uid}') {\n                      attrValue = 'mce_' + idCount++;\n                    }\n                    attrList.map[name] = attrValue;\n                    attrList.push({\n                      name: name,\n                      value: attrValue\n                    });\n                  }\n                }\n                if (attributesDefault) {\n                  i = attributesDefault.length;\n                  while (i--) {\n                    attr = attributesDefault[i];\n                    name = attr.name;\n                    if (!(name in attrList.map)) {\n                      attrValue = attr.value;\n                      if (attrValue === '{$uid}') {\n                        attrValue = 'mce_' + idCount++;\n                      }\n                      attrList.map[name] = attrValue;\n                      attrList.push({\n                        name: name,\n                        value: attrValue\n                      });\n                    }\n                  }\n                }\n                if (attributesRequired) {\n                  i = attributesRequired.length;\n                  while (i--) {\n                    if (attributesRequired[i] in attrList.map) {\n                      break;\n                    }\n                  }\n                  if (i === -1) {\n                    isValidElement = false;\n                  }\n                }\n                if (attr = attrList.map['data-mce-bogus']) {\n                  if (attr === 'all') {\n                    index = findEndTagIndex(schema, html, tokenRegExp.lastIndex);\n                    tokenRegExp.lastIndex = index;\n                    continue;\n                  }\n                  isValidElement = false;\n                }\n              }\n              if (isValidElement) {\n                start(value, attrList, isShortEnded);\n              }\n            } else {\n              isValidElement = false;\n            }\n            if (endRegExp = specialElements[value]) {\n              endRegExp.lastIndex = index = matches.index + matchText.length;\n              if (matches = endRegExp.exec(html)) {\n                if (isValidElement) {\n                  textData = html.substr(index, matches.index - index);\n                }\n                index = matches.index + matches[0].length;\n              } else {\n                textData = html.substr(index);\n                index = html.length;\n              }\n              if (isValidElement) {\n                if (textData.length > 0) {\n                  text(textData, true);\n                }\n                end(value);\n              }\n              tokenRegExp.lastIndex = index;\n              continue;\n            }\n            if (!isShortEnded) {\n              if (!attribsValue || attribsValue.indexOf('/') !== attribsValue.length - 1) {\n                stack.push({\n                  name: value,\n                  valid: isValidElement\n                });\n              } else if (isValidElement) {\n                end(value);\n              }\n            }\n          } else if (value = matches[1]) {\n            processComment(value);\n          } else if (value = matches[2]) {\n            var isValidCdataSection = parsingMode === 1 || settings.preserve_cdata || stack.length > 0 && schema.isValidChild(stack[stack.length - 1].name, '#cdata');\n            if (isValidCdataSection) {\n              cdata(value);\n            } else {\n              index = processMalformedComment('', matches.index + 2);\n              tokenRegExp.lastIndex = index;\n              continue;\n            }\n          } else if (value = matches[3]) {\n            doctype(value);\n          } else if ((value = matches[4]) || matchText === '<!') {\n            index = processMalformedComment(value, matches.index + matchText.length);\n            tokenRegExp.lastIndex = index;\n            continue;\n          } else if (value = matches[5]) {\n            if (parsingMode === 1) {\n              pi(value, matches[6]);\n            } else {\n              index = processMalformedComment('?', matches.index + 2);\n              tokenRegExp.lastIndex = index;\n              continue;\n            }\n          }\n          index = matches.index + matchText.length;\n        }\n        if (index < html.length) {\n          text(decode(html.substr(index)));\n        }\n        for (i = stack.length - 1; i >= 0; i--) {\n          value = stack[i];\n          if (value.valid) {\n            end(value.name);\n          }\n        }\n      };\n      return { parse: parse };\n    }\n    (function (SaxParser) {\n      SaxParser.findEndTag = findEndTagIndex;\n    }(SaxParser || (SaxParser = {})));\n    var SaxParser$1 = SaxParser;\n\n    var trimHtml = function (tempAttrs, html) {\n      var trimContentRegExp = new RegExp(['\\\\s?(' + tempAttrs.join('|') + ')=\"[^\"]+\"'].join('|'), 'gi');\n      return html.replace(trimContentRegExp, '');\n    };\n    var trimInternal = function (serializer, html) {\n      var content = html;\n      var bogusAllRegExp = /<(\\w+) [^>]*data-mce-bogus=\"all\"[^>]*>/g;\n      var endTagIndex, index, matchLength, matches, shortEndedElements;\n      var schema = serializer.schema;\n      content = trimHtml(serializer.getTempAttrs(), content);\n      shortEndedElements = schema.getShortEndedElements();\n      while (matches = bogusAllRegExp.exec(content)) {\n        index = bogusAllRegExp.lastIndex;\n        matchLength = matches[0].length;\n        if (shortEndedElements[matches[1]]) {\n          endTagIndex = index;\n        } else {\n          endTagIndex = SaxParser$1.findEndTag(schema, content, index);\n        }\n        content = content.substring(0, index - matchLength) + content.substring(endTagIndex);\n        bogusAllRegExp.lastIndex = index - matchLength;\n      }\n      return Zwsp.trim(content);\n    };\n    var trimExternal = trimInternal;\n    var TrimHtml = {\n      trimExternal: trimExternal,\n      trimInternal: trimInternal\n    };\n\n    var defaultFormat = 'html';\n    var trimEmptyContents = function (editor, html) {\n      var blockName = Settings.getForcedRootBlock(editor);\n      var emptyRegExp = new RegExp('^(<' + blockName + '[^>]*>(&nbsp;|&#160;|\\\\s|\\xA0|<br \\\\/>|)<\\\\/' + blockName + '>[\\r\\n]*|<br \\\\/>[\\r\\n]*)$');\n      return html.replace(emptyRegExp, '');\n    };\n    var getContentFromBody = function (editor, args, body) {\n      var content;\n      args.format = args.format ? args.format : defaultFormat;\n      args.get = true;\n      args.getInner = true;\n      if (!args.no_events) {\n        editor.fire('BeforeGetContent', args);\n      }\n      if (args.format === 'raw') {\n        content = Tools.trim(TrimHtml.trimExternal(editor.serializer, body.innerHTML));\n      } else if (args.format === 'text') {\n        content = Zwsp.trim(body.innerText || body.textContent);\n      } else if (args.format === 'tree') {\n        return editor.serializer.serialize(body, args);\n      } else {\n        content = trimEmptyContents(editor, editor.serializer.serialize(body, args));\n      }\n      if (args.format !== 'text' && !isWsPreserveElement(Element.fromDom(body))) {\n        args.content = Tools.trim(content);\n      } else {\n        args.content = content;\n      }\n      if (!args.no_events) {\n        editor.fire('GetContent', args);\n      }\n      return args.content;\n    };\n    var getContent = function (editor, args) {\n      if (args === void 0) {\n        args = {};\n      }\n      return Option.from(editor.getBody()).fold(constant(args.format === 'tree' ? new Node$1('body', 11) : ''), function (body) {\n        return getContentFromBody(editor, args, body);\n      });\n    };\n\n    var makeMap$3 = Tools.makeMap;\n    var Writer = function (settings) {\n      var html = [];\n      var indent, indentBefore, indentAfter, encode, htmlOutput;\n      settings = settings || {};\n      indent = settings.indent;\n      indentBefore = makeMap$3(settings.indent_before || '');\n      indentAfter = makeMap$3(settings.indent_after || '');\n      encode = Entities.getEncodeFunc(settings.entity_encoding || 'raw', settings.entities);\n      htmlOutput = settings.element_format === 'html';\n      return {\n        start: function (name, attrs, empty) {\n          var i, l, attr, value;\n          if (indent && indentBefore[name] && html.length > 0) {\n            value = html[html.length - 1];\n            if (value.length > 0 && value !== '\\n') {\n              html.push('\\n');\n            }\n          }\n          html.push('<', name);\n          if (attrs) {\n            for (i = 0, l = attrs.length; i < l; i++) {\n              attr = attrs[i];\n              html.push(' ', attr.name, '=\"', encode(attr.value, true), '\"');\n            }\n          }\n          if (!empty || htmlOutput) {\n            html[html.length] = '>';\n          } else {\n            html[html.length] = ' />';\n          }\n          if (empty && indent && indentAfter[name] && html.length > 0) {\n            value = html[html.length - 1];\n            if (value.length > 0 && value !== '\\n') {\n              html.push('\\n');\n            }\n          }\n        },\n        end: function (name) {\n          var value;\n          html.push('</', name, '>');\n          if (indent && indentAfter[name] && html.length > 0) {\n            value = html[html.length - 1];\n            if (value.length > 0 && value !== '\\n') {\n              html.push('\\n');\n            }\n          }\n        },\n        text: function (text, raw) {\n          if (text.length > 0) {\n            html[html.length] = raw ? text : encode(text);\n          }\n        },\n        cdata: function (text) {\n          html.push('<![CDATA[', text, ']]>');\n        },\n        comment: function (text) {\n          html.push('<!--', text, '-->');\n        },\n        pi: function (name, text) {\n          if (text) {\n            html.push('<?', name, ' ', encode(text), '?>');\n          } else {\n            html.push('<?', name, '?>');\n          }\n          if (indent) {\n            html.push('\\n');\n          }\n        },\n        doctype: function (text) {\n          html.push('<!DOCTYPE', text, '>', indent ? '\\n' : '');\n        },\n        reset: function () {\n          html.length = 0;\n        },\n        getContent: function () {\n          return html.join('').replace(/\\n$/, '');\n        }\n      };\n    };\n\n    var Serializer = function (settings, schema) {\n      if (schema === void 0) {\n        schema = Schema();\n      }\n      var writer = Writer(settings);\n      settings = settings || {};\n      settings.validate = 'validate' in settings ? settings.validate : true;\n      var serialize = function (node) {\n        var handlers, validate;\n        validate = settings.validate;\n        handlers = {\n          3: function (node) {\n            writer.text(node.value, node.raw);\n          },\n          8: function (node) {\n            writer.comment(node.value);\n          },\n          7: function (node) {\n            writer.pi(node.name, node.value);\n          },\n          10: function (node) {\n            writer.doctype(node.value);\n          },\n          4: function (node) {\n            writer.cdata(node.value);\n          },\n          11: function (node) {\n            if (node = node.firstChild) {\n              do {\n                walk(node);\n              } while (node = node.next);\n            }\n          }\n        };\n        writer.reset();\n        var walk = function (node) {\n          var handler = handlers[node.type];\n          var name, isEmpty, attrs, attrName, attrValue, sortedAttrs, i, l, elementRule;\n          if (!handler) {\n            name = node.name;\n            isEmpty = node.shortEnded;\n            attrs = node.attributes;\n            if (validate && attrs && attrs.length > 1) {\n              sortedAttrs = [];\n              sortedAttrs.map = {};\n              elementRule = schema.getElementRule(node.name);\n              if (elementRule) {\n                for (i = 0, l = elementRule.attributesOrder.length; i < l; i++) {\n                  attrName = elementRule.attributesOrder[i];\n                  if (attrName in attrs.map) {\n                    attrValue = attrs.map[attrName];\n                    sortedAttrs.map[attrName] = attrValue;\n                    sortedAttrs.push({\n                      name: attrName,\n                      value: attrValue\n                    });\n                  }\n                }\n                for (i = 0, l = attrs.length; i < l; i++) {\n                  attrName = attrs[i].name;\n                  if (!(attrName in sortedAttrs.map)) {\n                    attrValue = attrs.map[attrName];\n                    sortedAttrs.map[attrName] = attrValue;\n                    sortedAttrs.push({\n                      name: attrName,\n                      value: attrValue\n                    });\n                  }\n                }\n                attrs = sortedAttrs;\n              }\n            }\n            writer.start(node.name, attrs, isEmpty);\n            if (!isEmpty) {\n              if (node = node.firstChild) {\n                do {\n                  walk(node);\n                } while (node = node.next);\n              }\n              writer.end(name);\n            }\n          } else {\n            handler(node);\n          }\n        };\n        if (node.type === 1 && !settings.inner) {\n          walk(node);\n        } else {\n          handlers[11](node);\n        }\n        return writer.getContent();\n      };\n      return { serialize: serialize };\n    };\n\n    var traverse = function (node, fn) {\n      fn(node);\n      if (node.firstChild) {\n        traverse(node.firstChild, fn);\n      }\n      if (node.next) {\n        traverse(node.next, fn);\n      }\n    };\n    var findMatchingNodes = function (nodeFilters, attributeFilters, node) {\n      var nodeMatches = {};\n      var attrMatches = {};\n      var matches = [];\n      if (node.firstChild) {\n        traverse(node.firstChild, function (node) {\n          each(nodeFilters, function (filter) {\n            if (filter.name === node.name) {\n              if (nodeMatches[filter.name]) {\n                nodeMatches[filter.name].nodes.push(node);\n              } else {\n                nodeMatches[filter.name] = {\n                  filter: filter,\n                  nodes: [node]\n                };\n              }\n            }\n          });\n          each(attributeFilters, function (filter) {\n            if (typeof node.attr(filter.name) === 'string') {\n              if (attrMatches[filter.name]) {\n                attrMatches[filter.name].nodes.push(node);\n              } else {\n                attrMatches[filter.name] = {\n                  filter: filter,\n                  nodes: [node]\n                };\n              }\n            }\n          });\n        });\n      }\n      for (var name_1 in nodeMatches) {\n        if (nodeMatches.hasOwnProperty(name_1)) {\n          matches.push(nodeMatches[name_1]);\n        }\n      }\n      for (var name_2 in attrMatches) {\n        if (attrMatches.hasOwnProperty(name_2)) {\n          matches.push(attrMatches[name_2]);\n        }\n      }\n      return matches;\n    };\n    var filter$2 = function (nodeFilters, attributeFilters, node) {\n      var matches = findMatchingNodes(nodeFilters, attributeFilters, node);\n      each(matches, function (match) {\n        each(match.filter.callbacks, function (callback) {\n          callback(match.nodes, match.filter.name, {});\n        });\n      });\n    };\n\n    var hasFocus = function (element) {\n      var doc = owner(element).dom();\n      return element.dom() === doc.activeElement;\n    };\n    var active = function (_doc) {\n      var doc = _doc !== undefined ? _doc.dom() : domGlobals.document;\n      return Option.from(doc.activeElement).map(Element.fromDom);\n    };\n    var search = function (element) {\n      return active(owner(element)).filter(function (e) {\n        return element.dom().contains(e.dom());\n      });\n    };\n\n    var generate$1 = function (cases) {\n      if (!isArray(cases)) {\n        throw new Error('cases must be an array');\n      }\n      if (cases.length === 0) {\n        throw new Error('there must be at least one case');\n      }\n      var constructors = [];\n      var adt = {};\n      each(cases, function (acase, count) {\n        var keys$1 = keys(acase);\n        if (keys$1.length !== 1) {\n          throw new Error('one and only one name per case');\n        }\n        var key = keys$1[0];\n        var value = acase[key];\n        if (adt[key] !== undefined) {\n          throw new Error('duplicate key detected:' + key);\n        } else if (key === 'cata') {\n          throw new Error('cannot have a case named cata (sorry)');\n        } else if (!isArray(value)) {\n          throw new Error('case arguments must be an array');\n        }\n        constructors.push(key);\n        adt[key] = function () {\n          var argLength = arguments.length;\n          if (argLength !== value.length) {\n            throw new Error('Wrong number of arguments to case ' + key + '. Expected ' + value.length + ' (' + value + '), got ' + argLength);\n          }\n          var args = new Array(argLength);\n          for (var i = 0; i < args.length; i++) {\n            args[i] = arguments[i];\n          }\n          var match = function (branches) {\n            var branchKeys = keys(branches);\n            if (constructors.length !== branchKeys.length) {\n              throw new Error('Wrong number of arguments to match. Expected: ' + constructors.join(',') + '\\nActual: ' + branchKeys.join(','));\n            }\n            var allReqd = forall(constructors, function (reqKey) {\n              return contains(branchKeys, reqKey);\n            });\n            if (!allReqd) {\n              throw new Error('Not all branches were specified when using match. Specified: ' + branchKeys.join(', ') + '\\nRequired: ' + constructors.join(', '));\n            }\n            return branches[key].apply(null, args);\n          };\n          return {\n            fold: function () {\n              if (arguments.length !== cases.length) {\n                throw new Error('Wrong number of arguments to fold. Expected ' + cases.length + ', got ' + arguments.length);\n              }\n              var target = arguments[count];\n              return target.apply(null, args);\n            },\n            match: match,\n            log: function (label) {\n              domGlobals.console.log(label, {\n                constructors: constructors,\n                constructor: key,\n                params: args\n              });\n            }\n          };\n        };\n      });\n      return adt;\n    };\n    var Adt = { generate: generate$1 };\n\n    var create$3 = Immutable('start', 'soffset', 'finish', 'foffset');\n    var SimRange = { create: create$3 };\n\n    var adt = Adt.generate([\n      { before: ['element'] },\n      {\n        on: [\n          'element',\n          'offset'\n        ]\n      },\n      { after: ['element'] }\n    ]);\n    var cata = function (subject, onBefore, onOn, onAfter) {\n      return subject.fold(onBefore, onOn, onAfter);\n    };\n    var getStart = function (situ) {\n      return situ.fold(identity, identity, identity);\n    };\n    var before$3 = adt.before;\n    var on = adt.on;\n    var after$2 = adt.after;\n    var Situ = {\n      before: before$3,\n      on: on,\n      after: after$2,\n      cata: cata,\n      getStart: getStart\n    };\n\n    var adt$1 = Adt.generate([\n      { domRange: ['rng'] },\n      {\n        relative: [\n          'startSitu',\n          'finishSitu'\n        ]\n      },\n      {\n        exact: [\n          'start',\n          'soffset',\n          'finish',\n          'foffset'\n        ]\n      }\n    ]);\n    var exactFromRange = function (simRange) {\n      return adt$1.exact(simRange.start(), simRange.soffset(), simRange.finish(), simRange.foffset());\n    };\n    var getStart$1 = function (selection) {\n      return selection.match({\n        domRange: function (rng) {\n          return Element.fromDom(rng.startContainer);\n        },\n        relative: function (startSitu, finishSitu) {\n          return Situ.getStart(startSitu);\n        },\n        exact: function (start, soffset, finish, foffset) {\n          return start;\n        }\n      });\n    };\n    var domRange = adt$1.domRange;\n    var relative = adt$1.relative;\n    var exact = adt$1.exact;\n    var getWin = function (selection) {\n      var start = getStart$1(selection);\n      return defaultView(start);\n    };\n    var range = SimRange.create;\n    var Selection = {\n      domRange: domRange,\n      relative: relative,\n      exact: exact,\n      exactFromRange: exactFromRange,\n      getWin: getWin,\n      range: range\n    };\n\n    var browser$4 = detect$3().browser;\n    var clamp = function (offset, element) {\n      var max = isText(element) ? get$7(element).length : children(element).length + 1;\n      if (offset > max) {\n        return max;\n      } else if (offset < 0) {\n        return 0;\n      }\n      return offset;\n    };\n    var normalizeRng = function (rng) {\n      return Selection.range(rng.start(), clamp(rng.soffset(), rng.start()), rng.finish(), clamp(rng.foffset(), rng.finish()));\n    };\n    var isOrContains = function (root, elm) {\n      return !NodeType.isRestrictedNode(elm.dom()) && (contains$2(root, elm) || eq(root, elm));\n    };\n    var isRngInRoot = function (root) {\n      return function (rng) {\n        return isOrContains(root, rng.start()) && isOrContains(root, rng.finish());\n      };\n    };\n    var shouldStore = function (editor) {\n      return editor.inline === true || browser$4.isIE();\n    };\n    var nativeRangeToSelectionRange = function (r) {\n      return Selection.range(Element.fromDom(r.startContainer), r.startOffset, Element.fromDom(r.endContainer), r.endOffset);\n    };\n    var readRange = function (win) {\n      var selection = win.getSelection();\n      var rng = !selection || selection.rangeCount === 0 ? Option.none() : Option.from(selection.getRangeAt(0));\n      return rng.map(nativeRangeToSelectionRange);\n    };\n    var getBookmark$2 = function (root) {\n      var win = defaultView(root);\n      return readRange(win.dom()).filter(isRngInRoot(root));\n    };\n    var validate = function (root, bookmark) {\n      return Option.from(bookmark).filter(isRngInRoot(root)).map(normalizeRng);\n    };\n    var bookmarkToNativeRng = function (bookmark) {\n      var rng = domGlobals.document.createRange();\n      try {\n        rng.setStart(bookmark.start().dom(), bookmark.soffset());\n        rng.setEnd(bookmark.finish().dom(), bookmark.foffset());\n        return Option.some(rng);\n      } catch (_) {\n        return Option.none();\n      }\n    };\n    var store = function (editor) {\n      var newBookmark = shouldStore(editor) ? getBookmark$2(Element.fromDom(editor.getBody())) : Option.none();\n      editor.bookmark = newBookmark.isSome() ? newBookmark : editor.bookmark;\n    };\n    var storeNative = function (editor, rng) {\n      var root = Element.fromDom(editor.getBody());\n      var range = shouldStore(editor) ? Option.from(rng) : Option.none();\n      var newBookmark = range.map(nativeRangeToSelectionRange).filter(isRngInRoot(root));\n      editor.bookmark = newBookmark.isSome() ? newBookmark : editor.bookmark;\n    };\n    var getRng = function (editor) {\n      var bookmark = editor.bookmark ? editor.bookmark : Option.none();\n      return bookmark.bind(function (x) {\n        return validate(Element.fromDom(editor.getBody()), x);\n      }).bind(bookmarkToNativeRng);\n    };\n    var restore = function (editor) {\n      getRng(editor).each(function (rng) {\n        editor.selection.setRng(rng);\n      });\n    };\n    var SelectionBookmark = {\n      store: store,\n      storeNative: storeNative,\n      readRange: readRange,\n      restore: restore,\n      getRng: getRng,\n      getBookmark: getBookmark$2,\n      validate: validate\n    };\n\n    var isEditorUIElement = function (elm) {\n      var className = elm.className.toString();\n      return className.indexOf('tox-') !== -1 || className.indexOf('mce-') !== -1;\n    };\n    var FocusManager = { isEditorUIElement: isEditorUIElement };\n\n    var isManualNodeChange = function (e) {\n      return e.type === 'nodechange' && e.selectionChange;\n    };\n    var registerPageMouseUp = function (editor, throttledStore) {\n      var mouseUpPage = function () {\n        throttledStore.throttle();\n      };\n      DOMUtils$1.DOM.bind(domGlobals.document, 'mouseup', mouseUpPage);\n      editor.on('remove', function () {\n        DOMUtils$1.DOM.unbind(domGlobals.document, 'mouseup', mouseUpPage);\n      });\n    };\n    var registerFocusOut = function (editor) {\n      editor.on('focusout', function () {\n        SelectionBookmark.store(editor);\n      });\n    };\n    var registerMouseUp = function (editor, throttledStore) {\n      editor.on('mouseup touchend', function (e) {\n        throttledStore.throttle();\n      });\n    };\n    var registerEditorEvents = function (editor, throttledStore) {\n      var browser = detect$3().browser;\n      if (browser.isIE()) {\n        registerFocusOut(editor);\n      } else {\n        registerMouseUp(editor, throttledStore);\n      }\n      editor.on('keyup NodeChange', function (e) {\n        if (!isManualNodeChange(e)) {\n          SelectionBookmark.store(editor);\n        }\n      });\n    };\n    var register = function (editor) {\n      var throttledStore = first(function () {\n        SelectionBookmark.store(editor);\n      }, 0);\n      editor.on('init', function () {\n        if (editor.inline) {\n          registerPageMouseUp(editor, throttledStore);\n        }\n        registerEditorEvents(editor, throttledStore);\n      });\n      editor.on('remove', function () {\n        throttledStore.cancel();\n      });\n    };\n    var SelectionRestore = { register: register };\n\n    var documentFocusInHandler;\n    var DOM$2 = DOMUtils$1.DOM;\n    var isEditorUIElement$1 = function (elm) {\n      return FocusManager.isEditorUIElement(elm);\n    };\n    var isEditorContentAreaElement = function (elm) {\n      var classList = elm.classList;\n      if (classList !== undefined) {\n        return classList.contains('tox-edit-area') || classList.contains('tox-edit-area__iframe') || classList.contains('mce-content-body');\n      } else {\n        return false;\n      }\n    };\n    var isUIElement = function (editor, elm) {\n      var customSelector = editor ? editor.settings.custom_ui_selector : '';\n      var parent = DOM$2.getParent(elm, function (elm) {\n        return isEditorUIElement$1(elm) || (customSelector ? editor.dom.is(elm, customSelector) : false);\n      });\n      return parent !== null;\n    };\n    var getActiveElement = function () {\n      try {\n        return domGlobals.document.activeElement;\n      } catch (ex) {\n        return domGlobals.document.body;\n      }\n    };\n    var registerEvents = function (editorManager, e) {\n      var editor = e.editor;\n      SelectionRestore.register(editor);\n      editor.on('focusin', function () {\n        var self = this;\n        var focusedEditor = editorManager.focusedEditor;\n        if (focusedEditor !== self) {\n          if (focusedEditor) {\n            focusedEditor.fire('blur', { focusedEditor: self });\n          }\n          editorManager.setActive(self);\n          editorManager.focusedEditor = self;\n          self.fire('focus', { blurredEditor: focusedEditor });\n          self.focus(true);\n        }\n      });\n      editor.on('focusout', function () {\n        var self = this;\n        Delay.setEditorTimeout(self, function () {\n          var focusedEditor = editorManager.focusedEditor;\n          if (!isUIElement(self, getActiveElement()) && focusedEditor === self) {\n            self.fire('blur', { focusedEditor: null });\n            editorManager.focusedEditor = null;\n          }\n        });\n      });\n      if (!documentFocusInHandler) {\n        documentFocusInHandler = function (e) {\n          var activeEditor = editorManager.activeEditor;\n          var target;\n          target = e.target;\n          if (activeEditor && target.ownerDocument === domGlobals.document) {\n            if (target !== domGlobals.document.body && !isUIElement(activeEditor, target) && editorManager.focusedEditor === activeEditor) {\n              activeEditor.fire('blur', { focusedEditor: null });\n              editorManager.focusedEditor = null;\n            }\n          }\n        };\n        DOM$2.bind(domGlobals.document, 'focusin', documentFocusInHandler);\n      }\n    };\n    var unregisterDocumentEvents = function (editorManager, e) {\n      if (editorManager.focusedEditor === e.editor) {\n        editorManager.focusedEditor = null;\n      }\n      if (!editorManager.activeEditor) {\n        DOM$2.unbind(domGlobals.document, 'focusin', documentFocusInHandler);\n        documentFocusInHandler = null;\n      }\n    };\n    var setup$2 = function (editorManager) {\n      editorManager.on('AddEditor', curry(registerEvents, editorManager));\n      editorManager.on('RemoveEditor', curry(unregisterDocumentEvents, editorManager));\n    };\n    var FocusController = {\n      setup: setup$2,\n      isEditorUIElement: isEditorUIElement$1,\n      isEditorContentAreaElement: isEditorContentAreaElement,\n      isUIElement: isUIElement\n    };\n\n    var getContentEditableHost = function (editor, node) {\n      return editor.dom.getParent(node, function (node) {\n        return editor.dom.getContentEditable(node) === 'true';\n      });\n    };\n    var getCollapsedNode = function (rng) {\n      return rng.collapsed ? Option.from(getNode(rng.startContainer, rng.startOffset)).map(Element.fromDom) : Option.none();\n    };\n    var getFocusInElement = function (root, rng) {\n      return getCollapsedNode(rng).bind(function (node) {\n        if (isTableSection(node)) {\n          return Option.some(node);\n        } else if (contains$2(root, node) === false) {\n          return Option.some(root);\n        } else {\n          return Option.none();\n        }\n      });\n    };\n    var normalizeSelection = function (editor, rng) {\n      getFocusInElement(Element.fromDom(editor.getBody()), rng).bind(function (elm) {\n        return CaretFinder.firstPositionIn(elm.dom());\n      }).fold(function () {\n        editor.selection.normalize();\n        return;\n      }, function (caretPos) {\n        return editor.selection.setRng(caretPos.toRange());\n      });\n    };\n    var focusBody = function (body) {\n      if (body.setActive) {\n        try {\n          body.setActive();\n        } catch (ex) {\n          body.focus();\n        }\n      } else {\n        body.focus();\n      }\n    };\n    var hasElementFocus = function (elm) {\n      return hasFocus(elm) || search(elm).isSome();\n    };\n    var hasIframeFocus = function (editor) {\n      return editor.iframeElement && hasFocus(Element.fromDom(editor.iframeElement));\n    };\n    var hasInlineFocus = function (editor) {\n      var rawBody = editor.getBody();\n      return rawBody && hasElementFocus(Element.fromDom(rawBody));\n    };\n    var hasUiFocus = function (editor) {\n      return active().filter(function (elem) {\n        return !FocusController.isEditorContentAreaElement(elem.dom()) && FocusController.isUIElement(editor, elem.dom());\n      }).isSome();\n    };\n    var hasFocus$1 = function (editor) {\n      return editor.inline ? hasInlineFocus(editor) : hasIframeFocus(editor);\n    };\n    var hasEditorOrUiFocus = function (editor) {\n      return hasFocus$1(editor) || hasUiFocus(editor);\n    };\n    var focusEditor = function (editor) {\n      var selection = editor.selection;\n      var body = editor.getBody();\n      var rng = selection.getRng();\n      editor.quirks.refreshContentEditable();\n      if (editor.bookmark !== undefined && hasFocus$1(editor) === false) {\n        SelectionBookmark.getRng(editor).each(function (bookmarkRng) {\n          editor.selection.setRng(bookmarkRng);\n          rng = bookmarkRng;\n        });\n      }\n      var contentEditableHost = getContentEditableHost(editor, selection.getNode());\n      if (editor.$.contains(body, contentEditableHost)) {\n        focusBody(contentEditableHost);\n        normalizeSelection(editor, rng);\n        activateEditor(editor);\n        return;\n      }\n      if (!editor.inline) {\n        if (!Env.opera) {\n          focusBody(body);\n        }\n        editor.getWin().focus();\n      }\n      if (Env.gecko || editor.inline) {\n        focusBody(body);\n        normalizeSelection(editor, rng);\n      }\n      activateEditor(editor);\n    };\n    var activateEditor = function (editor) {\n      return editor.editorManager.setActive(editor);\n    };\n    var focus = function (editor, skipFocus) {\n      if (editor.removed) {\n        return;\n      }\n      skipFocus ? activateEditor(editor) : focusEditor(editor);\n    };\n    var EditorFocus = {\n      focus: focus,\n      hasFocus: hasFocus$1,\n      hasEditorOrUiFocus: hasEditorOrUiFocus\n    };\n\n    var defaultFormat$1 = 'html';\n    var isTreeNode = function (content) {\n      return content instanceof Node$1;\n    };\n    var moveSelection = function (editor) {\n      if (EditorFocus.hasFocus(editor)) {\n        CaretFinder.firstPositionIn(editor.getBody()).each(function (pos) {\n          var node = pos.getNode();\n          var caretPos = NodeType.isTable(node) ? CaretFinder.firstPositionIn(node).getOr(pos) : pos;\n          editor.selection.setRng(caretPos.toRange());\n        });\n      }\n    };\n    var setEditorHtml = function (editor, html) {\n      editor.dom.setHTML(editor.getBody(), html);\n      moveSelection(editor);\n    };\n    var setContentString = function (editor, body, content, args) {\n      var forcedRootBlockName, padd;\n      if (content.length === 0 || /^\\s+$/.test(content)) {\n        padd = '<br data-mce-bogus=\"1\">';\n        if (body.nodeName === 'TABLE') {\n          content = '<tr><td>' + padd + '</td></tr>';\n        } else if (/^(UL|OL)$/.test(body.nodeName)) {\n          content = '<li>' + padd + '</li>';\n        }\n        forcedRootBlockName = Settings.getForcedRootBlock(editor);\n        if (forcedRootBlockName && editor.schema.isValidChild(body.nodeName.toLowerCase(), forcedRootBlockName.toLowerCase())) {\n          content = padd;\n          content = editor.dom.createHTML(forcedRootBlockName, editor.settings.forced_root_block_attrs, content);\n        } else if (!content) {\n          content = '<br data-mce-bogus=\"1\">';\n        }\n        setEditorHtml(editor, content);\n        editor.fire('SetContent', args);\n      } else {\n        if (args.format !== 'raw') {\n          content = Serializer({ validate: editor.validate }, editor.schema).serialize(editor.parser.parse(content, {\n            isRootContent: true,\n            insert: true\n          }));\n        }\n        args.content = isWsPreserveElement(Element.fromDom(body)) ? content : Tools.trim(content);\n        setEditorHtml(editor, args.content);\n        if (!args.no_events) {\n          editor.fire('SetContent', args);\n        }\n      }\n      return args.content;\n    };\n    var setContentTree = function (editor, body, content, args) {\n      filter$2(editor.parser.getNodeFilters(), editor.parser.getAttributeFilters(), content);\n      var html = Serializer({ validate: editor.validate }, editor.schema).serialize(content);\n      args.content = isWsPreserveElement(Element.fromDom(body)) ? html : Tools.trim(html);\n      setEditorHtml(editor, args.content);\n      if (!args.no_events) {\n        editor.fire('SetContent', args);\n      }\n      return content;\n    };\n    var setContent = function (editor, content, args) {\n      if (args === void 0) {\n        args = {};\n      }\n      args.format = args.format ? args.format : defaultFormat$1;\n      args.set = true;\n      args.content = isTreeNode(content) ? '' : content;\n      if (!isTreeNode(content) && !args.no_events) {\n        editor.fire('BeforeSetContent', args);\n        content = args.content;\n      }\n      return Option.from(editor.getBody()).fold(constant(content), function (body) {\n        return isTreeNode(content) ? setContentTree(editor, body, content, args) : setContentString(editor, body, content, args);\n      });\n    };\n\n    var firePreProcess = function (editor, args) {\n      return editor.fire('PreProcess', args);\n    };\n    var firePostProcess = function (editor, args) {\n      return editor.fire('PostProcess', args);\n    };\n    var fireRemove = function (editor) {\n      return editor.fire('remove');\n    };\n    var fireDetach = function (editor) {\n      return editor.fire('detach');\n    };\n    var fireSwitchMode = function (editor, mode) {\n      return editor.fire('SwitchMode', { mode: mode });\n    };\n    var fireObjectResizeStart = function (editor, target, width, height) {\n      editor.fire('ObjectResizeStart', {\n        target: target,\n        width: width,\n        height: height\n      });\n    };\n    var fireObjectResized = function (editor, target, width, height) {\n      editor.fire('ObjectResized', {\n        target: target,\n        width: width,\n        height: height\n      });\n    };\n    var firePreInit = function (editor) {\n      return editor.fire('PreInit');\n    };\n    var firePostRender = function (editor) {\n      return editor.fire('PostRender');\n    };\n    var fireInit = function (editor) {\n      return editor.fire('Init');\n    };\n    var firePlaceholderToggle = function (editor, state) {\n      return editor.fire('PlaceholderToggle', { state: state });\n    };\n    var fireError = function (editor, errorType, error) {\n      return editor.fire(errorType, error);\n    };\n\n    var DOM$3 = DOMUtils$1.DOM;\n    var restoreOriginalStyles = function (editor) {\n      DOM$3.setStyle(editor.id, 'display', editor.orgDisplay);\n    };\n    var safeDestroy = function (x) {\n      return Option.from(x).each(function (x) {\n        return x.destroy();\n      });\n    };\n    var clearDomReferences = function (editor) {\n      editor.contentAreaContainer = editor.formElement = editor.container = editor.editorContainer = null;\n      editor.bodyElement = editor.contentDocument = editor.contentWindow = null;\n      editor.iframeElement = editor.targetElm = null;\n      if (editor.selection) {\n        editor.selection = editor.selection.win = editor.selection.dom = editor.selection.dom.doc = null;\n      }\n    };\n    var restoreForm = function (editor) {\n      var form = editor.formElement;\n      if (form) {\n        if (form._mceOldSubmit) {\n          form.submit = form._mceOldSubmit;\n          form._mceOldSubmit = null;\n        }\n        DOM$3.unbind(form, 'submit reset', editor.formEventDelegate);\n      }\n    };\n    var remove$6 = function (editor) {\n      if (!editor.removed) {\n        var _selectionOverrides = editor._selectionOverrides, editorUpload = editor.editorUpload;\n        var body = editor.getBody();\n        var element = editor.getElement();\n        if (body) {\n          editor.save({ is_removing: true });\n        }\n        editor.removed = true;\n        editor.unbindAllNativeEvents();\n        if (editor.hasHiddenInput && element) {\n          DOM$3.remove(element.nextSibling);\n        }\n        fireRemove(editor);\n        editor.editorManager.remove(editor);\n        if (!editor.inline && body) {\n          restoreOriginalStyles(editor);\n        }\n        fireDetach(editor);\n        DOM$3.remove(editor.getContainer());\n        safeDestroy(_selectionOverrides);\n        safeDestroy(editorUpload);\n        editor.destroy();\n      }\n    };\n    var destroy = function (editor, automatic) {\n      var selection = editor.selection, dom = editor.dom;\n      if (editor.destroyed) {\n        return;\n      }\n      if (!automatic && !editor.removed) {\n        editor.remove();\n        return;\n      }\n      if (!automatic) {\n        editor.editorManager.off('beforeunload', editor._beforeUnload);\n        if (editor.theme && editor.theme.destroy) {\n          editor.theme.destroy();\n        }\n        safeDestroy(selection);\n        safeDestroy(dom);\n      }\n      restoreForm(editor);\n      clearDomReferences(editor);\n      editor.destroyed = true;\n    };\n\n    var hasOwnProperty$2 = Object.prototype.hasOwnProperty;\n    var deep$1 = function (old, nu) {\n      var bothObjects = isObject(old) && isObject(nu);\n      return bothObjects ? deepMerge(old, nu) : nu;\n    };\n    var baseMerge = function (merger) {\n      return function () {\n        var objects = new Array(arguments.length);\n        for (var i = 0; i < objects.length; i++) {\n          objects[i] = arguments[i];\n        }\n        if (objects.length === 0) {\n          throw new Error('Can\\'t merge zero objects');\n        }\n        var ret = {};\n        for (var j = 0; j < objects.length; j++) {\n          var curObject = objects[j];\n          for (var key in curObject) {\n            if (hasOwnProperty$2.call(curObject, key)) {\n              ret[key] = merger(ret[key], curObject[key]);\n            }\n          }\n        }\n        return ret;\n      };\n    };\n    var deepMerge = baseMerge(deep$1);\n\n    var sectionResult = Immutable('sections', 'settings');\n    var deviceDetection = detect$3().deviceType;\n    var isTouch = deviceDetection.isTouch();\n    var isPhone = deviceDetection.isPhone();\n    var isTablet = deviceDetection.isTablet();\n    var legacyMobilePlugins = [\n      'lists',\n      'autolink',\n      'autosave'\n    ];\n    var defaultTouchSettings = {\n      table_grid: false,\n      object_resizing: false,\n      resize: false\n    };\n    var normalizePlugins = function (plugins) {\n      var pluginNames = isArray(plugins) ? plugins.join(' ') : plugins;\n      var trimmedPlugins = map(isString(pluginNames) ? pluginNames.split(' ') : [], trim);\n      return filter(trimmedPlugins, function (item) {\n        return item.length > 0;\n      });\n    };\n    var filterLegacyMobilePlugins = function (plugins) {\n      return filter(plugins, curry(contains, legacyMobilePlugins));\n    };\n    var extractSections = function (keys, settings) {\n      var result = bifilter(settings, function (value, key) {\n        return contains(keys, key);\n      });\n      return sectionResult(result.t, result.f);\n    };\n    var getSection = function (sectionResult, name, defaults) {\n      if (defaults === void 0) {\n        defaults = {};\n      }\n      var sections = sectionResult.sections();\n      var sectionSettings = sections.hasOwnProperty(name) ? sections[name] : {};\n      return Tools.extend({}, defaults, sectionSettings);\n    };\n    var hasSection = function (sectionResult, name) {\n      return sectionResult.sections().hasOwnProperty(name);\n    };\n    var isSectionTheme = function (sectionResult, name, theme) {\n      var section = sectionResult.sections();\n      return hasSection(sectionResult, name) && section[name].theme === theme;\n    };\n    var getSectionConfig = function (sectionResult, name) {\n      return hasSection(sectionResult, name) ? sectionResult.sections()[name] : {};\n    };\n    var getToolbarMode = function (settings, defaultVal) {\n      return get(settings, 'toolbar_mode').orThunk(function () {\n        return get(settings, 'toolbar_drawer').map(function (val) {\n          return val === false ? 'wrap' : val;\n        });\n      }).getOr(defaultVal);\n    };\n    var getDefaultSettings = function (settings, id, documentBaseUrl, isTouch, editor) {\n      var baseDefaults = {\n        id: id,\n        theme: 'silver',\n        toolbar_mode: getToolbarMode(settings, 'floating'),\n        plugins: '',\n        document_base_url: documentBaseUrl,\n        add_form_submit_trigger: true,\n        submit_patch: true,\n        add_unload_trigger: true,\n        convert_urls: true,\n        relative_urls: true,\n        remove_script_host: true,\n        object_resizing: true,\n        doctype: '<!DOCTYPE html>',\n        visual: true,\n        font_size_legacy_values: 'xx-small,small,medium,large,x-large,xx-large,300%',\n        forced_root_block: 'p',\n        hidden_input: true,\n        inline_styles: true,\n        convert_fonts_to_spans: true,\n        indent: true,\n        indent_before: 'p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,' + 'tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist',\n        indent_after: 'p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,' + 'tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist',\n        entity_encoding: 'named',\n        url_converter: editor.convertURL,\n        url_converter_scope: editor\n      };\n      return __assign(__assign({}, baseDefaults), isTouch ? defaultTouchSettings : {});\n    };\n    var getDefaultMobileSettings = function (settings, isPhone) {\n      var defaultMobileSettings = {\n        resize: false,\n        toolbar_mode: getToolbarMode(settings, 'scrolling'),\n        toolbar_sticky: false\n      };\n      var defaultPhoneSettings = { menubar: false };\n      return __assign(__assign(__assign({}, defaultTouchSettings), defaultMobileSettings), isPhone ? defaultPhoneSettings : {});\n    };\n    var getExternalPlugins = function (overrideSettings, settings) {\n      var userDefinedExternalPlugins = settings.external_plugins ? settings.external_plugins : {};\n      if (overrideSettings && overrideSettings.external_plugins) {\n        return Tools.extend({}, overrideSettings.external_plugins, userDefinedExternalPlugins);\n      } else {\n        return userDefinedExternalPlugins;\n      }\n    };\n    var combinePlugins = function (forcedPlugins, plugins) {\n      return [].concat(normalizePlugins(forcedPlugins)).concat(normalizePlugins(plugins));\n    };\n    var processPlugins = function (isMobileDevice, sectionResult, defaultOverrideSettings, settings) {\n      var forcedPlugins = normalizePlugins(defaultOverrideSettings.forced_plugins);\n      var desktopPlugins = normalizePlugins(settings.plugins);\n      var mobileConfig = getSectionConfig(sectionResult, 'mobile');\n      var mobilePlugins = mobileConfig.plugins ? normalizePlugins(mobileConfig.plugins) : desktopPlugins;\n      var platformPlugins = isMobileDevice && isSectionTheme(sectionResult, 'mobile', 'mobile') ? filterLegacyMobilePlugins(mobilePlugins) : isMobileDevice && hasSection(sectionResult, 'mobile') ? mobilePlugins : desktopPlugins;\n      var combinedPlugins = combinePlugins(forcedPlugins, platformPlugins);\n      return Tools.extend(settings, { plugins: combinedPlugins.join(' ') });\n    };\n    var isOnMobile = function (isMobileDevice, sectionResult) {\n      return isMobileDevice && hasSection(sectionResult, 'mobile');\n    };\n    var combineSettings = function (isMobileDevice, isPhone, defaultSettings, defaultOverrideSettings, settings) {\n      var defaultDeviceSettings = isMobileDevice ? { mobile: getDefaultMobileSettings(settings, isPhone) } : {};\n      var sectionResult = extractSections(['mobile'], deepMerge(defaultDeviceSettings, settings));\n      var extendedSettings = Tools.extend(defaultSettings, defaultOverrideSettings, sectionResult.settings(), isOnMobile(isMobileDevice, sectionResult) ? getSection(sectionResult, 'mobile') : {}, {\n        validate: true,\n        external_plugins: getExternalPlugins(defaultOverrideSettings, sectionResult.settings())\n      });\n      return processPlugins(isMobileDevice, sectionResult, defaultOverrideSettings, extendedSettings);\n    };\n    var getEditorSettings = function (editor, id, documentBaseUrl, defaultOverrideSettings, settings) {\n      var defaultSettings = getDefaultSettings(settings, id, documentBaseUrl, isTouch, editor);\n      return combineSettings(isPhone || isTablet, isPhone, defaultSettings, defaultOverrideSettings, settings);\n    };\n    var getFiltered = function (predicate, editor, name) {\n      return Option.from(editor.settings[name]).filter(predicate);\n    };\n    var getParamObject = function (value) {\n      var output = {};\n      if (typeof value === 'string') {\n        each(value.indexOf('=') > 0 ? value.split(/[;,](?![^=;,]*(?:[;,]|$))/) : value.split(','), function (val) {\n          var arr = val.split('=');\n          if (arr.length > 1) {\n            output[Tools.trim(arr[0])] = Tools.trim(arr[1]);\n          } else {\n            output[Tools.trim(arr[0])] = Tools.trim(arr[0]);\n          }\n        });\n      } else {\n        output = value;\n      }\n      return output;\n    };\n    var isArrayOf = function (p) {\n      return function (a) {\n        return isArray(a) && forall(a, p);\n      };\n    };\n    var getParam = function (editor, name, defaultVal, type) {\n      var value = name in editor.settings ? editor.settings[name] : defaultVal;\n      if (type === 'hash') {\n        return getParamObject(value);\n      } else if (type === 'string') {\n        return getFiltered(isString, editor, name).getOr(defaultVal);\n      } else if (type === 'number') {\n        return getFiltered(isNumber, editor, name).getOr(defaultVal);\n      } else if (type === 'boolean') {\n        return getFiltered(isBoolean, editor, name).getOr(defaultVal);\n      } else if (type === 'object') {\n        return getFiltered(isObject, editor, name).getOr(defaultVal);\n      } else if (type === 'array') {\n        return getFiltered(isArray, editor, name).getOr(defaultVal);\n      } else if (type === 'string[]') {\n        return getFiltered(isArrayOf(isString), editor, name).getOr(defaultVal);\n      } else if (type === 'function') {\n        return getFiltered(isFunction, editor, name).getOr(defaultVal);\n      } else {\n        return value;\n      }\n    };\n\n    var CreateIconManager = function () {\n      var lookup = {};\n      var add = function (id, iconPack) {\n        lookup[id] = iconPack;\n      };\n      var get = function (id) {\n        if (lookup[id]) {\n          return lookup[id];\n        }\n        return { icons: {} };\n      };\n      var has$1 = function (id) {\n        return has(lookup, id);\n      };\n      return {\n        add: add,\n        get: get,\n        has: has$1\n      };\n    };\n    var IconManager = CreateIconManager();\n\n    var getProp = function (propName, elm) {\n      var rawElm = elm.dom();\n      return rawElm[propName];\n    };\n    var getComputedSizeProp = function (propName, elm) {\n      return parseInt(get$4(elm, propName), 10);\n    };\n    var getClientWidth = curry(getProp, 'clientWidth');\n    var getClientHeight = curry(getProp, 'clientHeight');\n    var getMarginTop = curry(getComputedSizeProp, 'margin-top');\n    var getMarginLeft = curry(getComputedSizeProp, 'margin-left');\n    var getBoundingClientRect$1 = function (elm) {\n      return elm.dom().getBoundingClientRect();\n    };\n    var isInsideElementContentArea = function (bodyElm, clientX, clientY) {\n      var clientWidth = getClientWidth(bodyElm);\n      var clientHeight = getClientHeight(bodyElm);\n      return clientX >= 0 && clientY >= 0 && clientX <= clientWidth && clientY <= clientHeight;\n    };\n    var transpose = function (inline, elm, clientX, clientY) {\n      var clientRect = getBoundingClientRect$1(elm);\n      var deltaX = inline ? clientRect.left + elm.dom().clientLeft + getMarginLeft(elm) : 0;\n      var deltaY = inline ? clientRect.top + elm.dom().clientTop + getMarginTop(elm) : 0;\n      var x = clientX - deltaX;\n      var y = clientY - deltaY;\n      return {\n        x: x,\n        y: y\n      };\n    };\n    var isXYInContentArea = function (editor, clientX, clientY) {\n      var bodyElm = Element.fromDom(editor.getBody());\n      var targetElm = editor.inline ? bodyElm : documentElement(bodyElm);\n      var transposedPoint = transpose(editor.inline, targetElm, clientX, clientY);\n      return isInsideElementContentArea(targetElm, transposedPoint.x, transposedPoint.y);\n    };\n    var fromDomSafe = function (node) {\n      return Option.from(node).map(Element.fromDom);\n    };\n    var isEditorAttachedToDom = function (editor) {\n      var rawContainer = editor.inline ? editor.getBody() : editor.getContentAreaContainer();\n      return fromDomSafe(rawContainer).map(function (container) {\n        return contains$2(owner(container), container);\n      }).getOr(false);\n    };\n    var EditorView = {\n      isXYInContentArea: isXYInContentArea,\n      isEditorAttachedToDom: isEditorAttachedToDom\n    };\n\n    function NotificationManagerImpl() {\n      var unimplemented = function () {\n        throw new Error('Theme did not provide a NotificationManager implementation.');\n      };\n      return {\n        open: unimplemented,\n        close: unimplemented,\n        reposition: unimplemented,\n        getArgs: unimplemented\n      };\n    }\n\n    function NotificationManager(editor) {\n      var notifications = [];\n      var getImplementation = function () {\n        var theme = editor.theme;\n        return theme && theme.getNotificationManagerImpl ? theme.getNotificationManagerImpl() : NotificationManagerImpl();\n      };\n      var getTopNotification = function () {\n        return Option.from(notifications[0]);\n      };\n      var isEqual = function (a, b) {\n        return a.type === b.type && a.text === b.text && !a.progressBar && !a.timeout && !b.progressBar && !b.timeout;\n      };\n      var reposition = function () {\n        if (notifications.length > 0) {\n          getImplementation().reposition(notifications);\n        }\n      };\n      var addNotification = function (notification) {\n        notifications.push(notification);\n      };\n      var closeNotification = function (notification) {\n        findIndex(notifications, function (otherNotification) {\n          return otherNotification === notification;\n        }).each(function (index) {\n          notifications.splice(index, 1);\n        });\n      };\n      var open = function (spec) {\n        if (editor.removed || !EditorView.isEditorAttachedToDom(editor)) {\n          return;\n        }\n        return find(notifications, function (notification) {\n          return isEqual(getImplementation().getArgs(notification), spec);\n        }).getOrThunk(function () {\n          editor.editorManager.setActive(editor);\n          var notification = getImplementation().open(spec, function () {\n            closeNotification(notification);\n            reposition();\n          });\n          addNotification(notification);\n          reposition();\n          return notification;\n        });\n      };\n      var close = function () {\n        getTopNotification().each(function (notification) {\n          getImplementation().close(notification);\n          closeNotification(notification);\n          reposition();\n        });\n      };\n      var getNotifications = function () {\n        return notifications;\n      };\n      var registerEvents = function (editor) {\n        editor.on('SkinLoaded', function () {\n          var serviceMessage = editor.settings.service_message;\n          if (serviceMessage) {\n            open({\n              text: serviceMessage,\n              type: 'warning',\n              timeout: 0\n            });\n          }\n        });\n        editor.on('ResizeEditor ResizeWindow NodeChange', function () {\n          Delay.requestAnimationFrame(reposition);\n        });\n        editor.on('remove', function () {\n          each(notifications.slice(), function (notification) {\n            getImplementation().close(notification);\n          });\n        });\n      };\n      registerEvents(editor);\n      return {\n        open: open,\n        close: close,\n        getNotifications: getNotifications\n      };\n    }\n\n    var PluginManager = AddOnManager$1.PluginManager;\n\n    var ThemeManager = AddOnManager$1.ThemeManager;\n\n    function WindowManagerImpl () {\n      var unimplemented = function () {\n        throw new Error('Theme did not provide a WindowManager implementation.');\n      };\n      return {\n        open: unimplemented,\n        openUrl: unimplemented,\n        alert: unimplemented,\n        confirm: unimplemented,\n        close: unimplemented,\n        getParams: unimplemented,\n        setParams: unimplemented\n      };\n    }\n\n    var WindowManager = function (editor) {\n      var dialogs = [];\n      var getImplementation = function () {\n        var theme = editor.theme;\n        return theme && theme.getWindowManagerImpl ? theme.getWindowManagerImpl() : WindowManagerImpl();\n      };\n      var funcBind = function (scope, f) {\n        return function () {\n          return f ? f.apply(scope, arguments) : undefined;\n        };\n      };\n      var fireOpenEvent = function (dialog) {\n        editor.fire('OpenWindow', { dialog: dialog });\n      };\n      var fireCloseEvent = function (dialog) {\n        editor.fire('CloseWindow', { dialog: dialog });\n      };\n      var addDialog = function (dialog) {\n        dialogs.push(dialog);\n        fireOpenEvent(dialog);\n      };\n      var closeDialog = function (dialog) {\n        fireCloseEvent(dialog);\n        dialogs = filter(dialogs, function (otherDialog) {\n          return otherDialog !== dialog;\n        });\n        if (dialogs.length === 0) {\n          editor.focus();\n        }\n      };\n      var getTopDialog = function () {\n        return Option.from(dialogs[dialogs.length - 1]);\n      };\n      var storeSelectionAndOpenDialog = function (openDialog) {\n        editor.editorManager.setActive(editor);\n        SelectionBookmark.store(editor);\n        var dialog = openDialog();\n        addDialog(dialog);\n        return dialog;\n      };\n      var open = function (args, params) {\n        return storeSelectionAndOpenDialog(function () {\n          return getImplementation().open(args, params, closeDialog);\n        });\n      };\n      var openUrl = function (args) {\n        return storeSelectionAndOpenDialog(function () {\n          return getImplementation().openUrl(args, closeDialog);\n        });\n      };\n      var alert = function (message, callback, scope) {\n        getImplementation().alert(message, funcBind(scope ? scope : this, callback));\n      };\n      var confirm = function (message, callback, scope) {\n        getImplementation().confirm(message, funcBind(scope ? scope : this, callback));\n      };\n      var close = function () {\n        getTopDialog().each(function (dialog) {\n          getImplementation().close(dialog);\n          closeDialog(dialog);\n        });\n      };\n      editor.on('remove', function () {\n        each(dialogs, function (dialog) {\n          getImplementation().close(dialog);\n        });\n      });\n      return {\n        open: open,\n        openUrl: openUrl,\n        alert: alert,\n        confirm: confirm,\n        close: close\n      };\n    };\n\n    var displayNotification = function (editor, message) {\n      editor.notificationManager.open({\n        type: 'error',\n        text: message\n      });\n    };\n    var displayError = function (editor, message) {\n      if (editor._skinLoaded) {\n        displayNotification(editor, message);\n      } else {\n        editor.on('SkinLoaded', function () {\n          displayNotification(editor, message);\n        });\n      }\n    };\n    var uploadError = function (editor, message) {\n      displayError(editor, I18n.translate([\n        'Failed to upload image: {0}',\n        message\n      ]));\n    };\n    var logError = function (editor, errorType, msg) {\n      fireError(editor, errorType, { message: msg });\n      domGlobals.console.error(msg);\n    };\n    var createLoadError = function (type, url, name) {\n      return name ? 'Failed to load ' + type + ': ' + name + ' from url ' + url : 'Failed to load ' + type + ' url: ' + url;\n    };\n    var pluginLoadError = function (editor, url, name) {\n      logError(editor, 'PluginLoadError', createLoadError('plugin', url, name));\n    };\n    var iconsLoadError = function (editor, url, name) {\n      logError(editor, 'IconsLoadError', createLoadError('icons', url, name));\n    };\n    var languageLoadError = function (editor, url, name) {\n      logError(editor, 'LanguageLoadError', createLoadError('language', url, name));\n    };\n    var pluginInitError = function (editor, name, err) {\n      var message = I18n.translate([\n        'Failed to initialize plugin: {0}',\n        name\n      ]);\n      initError(message, err);\n      displayError(editor, message);\n    };\n    var initError = function (message) {\n      var x = [];\n      for (var _i = 1; _i < arguments.length; _i++) {\n        x[_i - 1] = arguments[_i];\n      }\n      var console = domGlobals.window.console;\n      if (console) {\n        if (console.error) {\n          console.error.apply(console, arguments);\n        } else {\n          console.log.apply(console, arguments);\n        }\n      }\n    };\n    var ErrorReporter = {\n      pluginLoadError: pluginLoadError,\n      iconsLoadError: iconsLoadError,\n      languageLoadError: languageLoadError,\n      pluginInitError: pluginInitError,\n      uploadError: uploadError,\n      displayError: displayError,\n      initError: initError\n    };\n\n    var getAll = function () {\n      return {\n        'accessibility-check': '<svg width=\"24\" height=\"24\"><path d=\"M12 2a2 2 0 0 1 2 2 2 2 0 0 1-2 2 2 2 0 0 1-2-2c0-1.1.9-2 2-2zm8 7h-5v12c0 .6-.4 1-1 1a1 1 0 0 1-1-1v-5c0-.6-.4-1-1-1a1 1 0 0 0-1 1v5c0 .6-.4 1-1 1a1 1 0 0 1-1-1V9H4a1 1 0 1 1 0-2h16c.6 0 1 .4 1 1s-.4 1-1 1z\" fill-rule=\"nonzero\"/></svg>',\n        'action-next': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M5.7 7.3a1 1 0 0 0-1.4 1.4l7.7 7.7 7.7-7.7a1 1 0 1 0-1.4-1.4L12 13.6 5.7 7.3z\"/></svg>',\n        'action-prev': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M18.3 15.7a1 1 0 0 0 1.4-1.4L12 6.6l-7.7 7.7a1 1 0 0 0 1.4 1.4L12 9.4l6.3 6.3z\"/></svg>',\n        'align-center': '<svg width=\"24\" height=\"24\"><path d=\"M5 5h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 1 1 0-2zm3 4h8c.6 0 1 .4 1 1s-.4 1-1 1H8a1 1 0 1 1 0-2zm0 8h8c.6 0 1 .4 1 1s-.4 1-1 1H8a1 1 0 0 1 0-2zm-3-4h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 0 1 0-2z\" fill-rule=\"evenodd\"/></svg>',\n        'align-justify': '<svg width=\"24\" height=\"24\"><path d=\"M5 5h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 1 1 0-2zm0 4h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 1 1 0-2zm0 4h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 0 1 0-2zm0 4h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 0 1 0-2z\" fill-rule=\"evenodd\"/></svg>',\n        'align-left': '<svg width=\"24\" height=\"24\"><path d=\"M5 5h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 1 1 0-2zm0 4h8c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 1 1 0-2zm0 8h8c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 0 1 0-2zm0-4h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 0 1 0-2z\" fill-rule=\"evenodd\"/></svg>',\n        'align-none': '<svg width=\"24\" height=\"24\"><path d=\"M14.2 5L13 7H5a1 1 0 1 1 0-2h9.2zm4 0h.8a1 1 0 0 1 0 2h-2l1.2-2zm-6.4 4l-1.2 2H5a1 1 0 0 1 0-2h6.8zm4 0H19a1 1 0 0 1 0 2h-4.4l1.2-2zm-6.4 4l-1.2 2H5a1 1 0 0 1 0-2h4.4zm4 0H19a1 1 0 0 1 0 2h-6.8l1.2-2zM7 17l-1.2 2H5a1 1 0 0 1 0-2h2zm4 0h8a1 1 0 0 1 0 2H9.8l1.2-2zm5.2-13.5l1.3.7-9.7 16.3-1.3-.7 9.7-16.3z\" fill-rule=\"evenodd\"/></svg>',\n        'align-right': '<svg width=\"24\" height=\"24\"><path d=\"M5 5h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 1 1 0-2zm6 4h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zm0 8h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zm-6-4h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 0 1 0-2z\" fill-rule=\"evenodd\"/></svg>',\n        'arrow-left': '<svg width=\"24\" height=\"24\"><path d=\"M5.6 13l12 6a1 1 0 0 0 1.4-1V6a1 1 0 0 0-1.4-.9l-12 6a1 1 0 0 0 0 1.8z\" fill-rule=\"evenodd\"/></svg>',\n        'arrow-right': '<svg width=\"24\" height=\"24\"><path d=\"M18.5 13l-12 6A1 1 0 0 1 5 18V6a1 1 0 0 1 1.4-.9l12 6a1 1 0 0 1 0 1.8z\" fill-rule=\"evenodd\"/></svg>',\n        'bold': '<svg width=\"24\" height=\"24\"><path d=\"M7.8 19c-.3 0-.5 0-.6-.2l-.2-.5V5.7c0-.2 0-.4.2-.5l.6-.2h5c1.5 0 2.7.3 3.5 1 .7.6 1.1 1.4 1.1 2.5a3 3 0 0 1-.6 1.9c-.4.6-1 1-1.6 1.2.4.1.9.3 1.3.6s.8.7 1 1.2c.4.4.5 1 .5 1.6 0 1.3-.4 2.3-1.3 3-.8.7-2.1 1-3.8 1H7.8zm5-8.3c.6 0 1.2-.1 1.6-.5.4-.3.6-.7.6-1.3 0-1.1-.8-1.7-2.3-1.7H9.3v3.5h3.4zm.5 6c.7 0 1.3-.1 1.7-.4.4-.4.6-.9.6-1.5s-.2-1-.7-1.4c-.4-.3-1-.4-2-.4H9.4v3.8h4z\" fill-rule=\"evenodd\"/></svg>',\n        'bookmark': '<svg width=\"24\" height=\"24\"><path d=\"M6 4v17l6-4 6 4V4c0-.6-.4-1-1-1H7a1 1 0 0 0-1 1z\" fill-rule=\"nonzero\"/></svg>',\n        'border-width': '<svg width=\"24\" height=\"24\"><path d=\"M5 14.8h14a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2zm-.5 3.7h15c.3 0 .5.2.5.5s-.2.5-.5.5h-15a.5.5 0 1 1 0-1zm.5-8.3h14c.6 0 1 .4 1 1v1c0 .5-.4 1-1 1H5a1 1 0 0 1-1-1v-1c0-.6.4-1 1-1zm0-5.7h14c.6 0 1 .4 1 1v2c0 .6-.4 1-1 1H5a1 1 0 0 1-1-1v-2c0-.6.4-1 1-1z\" fill-rule=\"evenodd\"/></svg>',\n        'brightness': '<svg width=\"24\" height=\"24\"><path d=\"M12 17c.3 0 .5.1.7.3.2.2.3.4.3.7v1c0 .3-.1.5-.3.7a1 1 0 0 1-.7.3 1 1 0 0 1-.7-.3 1 1 0 0 1-.3-.7v-1c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3zm0-10a1 1 0 0 1-.7-.3A1 1 0 0 1 11 6V5c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3.3 0 .5.1.7.3.2.2.3.4.3.7v1c0 .3-.1.5-.3.7a1 1 0 0 1-.7.3zm7 4c.3 0 .5.1.7.3.2.2.3.4.3.7 0 .3-.1.5-.3.7a1 1 0 0 1-.7.3h-1a1 1 0 0 1-.7-.3 1 1 0 0 1-.3-.7c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3h1zM7 12c0 .3-.1.5-.3.7a1 1 0 0 1-.7.3H5a1 1 0 0 1-.7-.3A1 1 0 0 1 4 12c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3h1c.3 0 .5.1.7.3.2.2.3.4.3.7zm10 3.5l.7.8c.2.1.3.4.3.6 0 .3-.1.6-.3.8a1 1 0 0 1-.8.3 1 1 0 0 1-.6-.3l-.8-.7a1 1 0 0 1-.3-.8c0-.2.1-.5.3-.7a1 1 0 0 1 1.4 0zm-10-7l-.7-.8a1 1 0 0 1-.3-.6c0-.3.1-.6.3-.8.2-.2.5-.3.8-.3.2 0 .5.1.7.3l.7.7c.2.2.3.5.3.8 0 .2-.1.5-.3.7a1 1 0 0 1-.7.3 1 1 0 0 1-.8-.3zm10 0a1 1 0 0 1-.8.3 1 1 0 0 1-.7-.3 1 1 0 0 1-.3-.7c0-.3.1-.6.3-.8l.8-.7c.1-.2.4-.3.6-.3.3 0 .6.1.8.3.2.2.3.5.3.8 0 .2-.1.5-.3.7l-.7.7zm-10 7c.2-.2.5-.3.8-.3.2 0 .5.1.7.3a1 1 0 0 1 0 1.4l-.8.8a1 1 0 0 1-.6.3 1 1 0 0 1-.8-.3 1 1 0 0 1-.3-.8c0-.2.1-.5.3-.6l.7-.8zM12 8a4 4 0 0 1 3.7 2.4 4 4 0 0 1 0 3.2A4 4 0 0 1 12 16a4 4 0 0 1-3.7-2.4 4 4 0 0 1 0-3.2A4 4 0 0 1 12 8zm0 6.5c.7 0 1.3-.2 1.8-.7.5-.5.7-1.1.7-1.8s-.2-1.3-.7-1.8c-.5-.5-1.1-.7-1.8-.7s-1.3.2-1.8.7c-.5.5-.7 1.1-.7 1.8s.2 1.3.7 1.8c.5.5 1.1.7 1.8.7z\" fill-rule=\"evenodd\"/></svg>',\n        'browse': '<svg width=\"24\" height=\"24\"><path d=\"M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2h-4v-2h4V8H5v10h4v2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zm-8 9.4l-2.3 2.3a1 1 0 1 1-1.4-1.4l4-4a1 1 0 0 1 1.4 0l4 4a1 1 0 0 1-1.4 1.4L13 13.4V20a1 1 0 0 1-2 0v-6.6z\" fill-rule=\"nonzero\"/></svg>',\n        'cancel': '<svg width=\"24\" height=\"24\"><path d=\"M12 4.6a7.4 7.4 0 1 1 0 14.8 7.4 7.4 0 0 1 0-14.8zM12 3a9 9 0 1 0 0 18 9 9 0 0 0 0-18zm0 8L14.8 8l1 1.1-2.7 2.8 2.7 2.7-1.1 1.1-2.7-2.7-2.7 2.7-1-1.1 2.6-2.7-2.7-2.7 1-1.1 2.8 2.7z\" fill-rule=\"nonzero\"/></svg>',\n        'change-case': '<svg width=\"24\" height=\"24\"><path d=\"M18.4 18.2v-.6c-.5.8-1.3 1.2-2.4 1.2-2.2 0-3.3-1.6-3.3-4.8 0-3.1 1-4.7 3.3-4.7 1.1 0 1.8.3 2.4 1.1v-.6c0-.5.4-.8.8-.8s.8.3.8.8v8.4c0 .5-.4.8-.8.8a.8.8 0 0 1-.8-.8zm-2-7.4c-1.3 0-1.8.9-1.8 3.2 0 2.4.5 3.3 1.7 3.3 1.3 0 1.8-.9 1.8-3.2 0-2.4-.5-3.3-1.7-3.3zM10 15.7H5.5l-.8 2.6a1 1 0 0 1-1 .7h-.2a.7.7 0 0 1-.7-1l4-12a1 1 0 1 1 2 0l4 12a.7.7 0 0 1-.8 1h-.2a1 1 0 0 1-1-.7l-.8-2.6zm-.3-1.5l-2-6.5-1.9 6.5h3.9z\" fill-rule=\"evenodd\"/></svg>',\n        'character-count': '<svg width=\"24\" height=\"24\"><path d=\"M4 11.5h16v1H4v-1zm4.8-6.8V10H7.7V5.8h-1v-1h2zM11 8.3V9h2v1h-3V7.7l2-1v-.9h-2v-1h3v2.4l-2 1zm6.3-3.4V10h-3.1V9h2.1V8h-2.1V6.8h2.1v-1h-2.1v-1h3.1zM5.8 16.4c0-.5.2-.8.5-1 .2-.2.6-.3 1.2-.3l.8.1c.2 0 .4.2.5.3l.4.4v2.8l.2.3H8.2v-.1-.2l-.6.3H7c-.4 0-.7 0-1-.2a1 1 0 0 1-.3-.9c0-.3 0-.6.3-.8.3-.2.7-.4 1.2-.4l.6-.2h.3v-.2l-.1-.2a.8.8 0 0 0-.5-.1 1 1 0 0 0-.4 0l-.3.4h-1zm2.3.8h-.2l-.2.1-.4.1a1 1 0 0 0-.4.2l-.2.2.1.3.5.1h.4l.4-.4v-.6zm2-3.4h1.2v1.7l.5-.3h.5c.5 0 .9.1 1.2.5.3.4.5.8.5 1.4 0 .6-.2 1.1-.5 1.5-.3.4-.7.6-1.3.6l-.6-.1-.4-.4v.4h-1.1v-5.4zm1.1 3.3c0 .3 0 .6.2.8a.7.7 0 0 0 1.2 0l.2-.8c0-.4 0-.6-.2-.8a.7.7 0 0 0-.6-.3l-.6.3-.2.8zm6.1-.5c0-.2 0-.3-.2-.4a.8.8 0 0 0-.5-.2c-.3 0-.5.1-.6.3l-.2.9c0 .3 0 .6.2.8.1.2.3.3.6.3.2 0 .4 0 .5-.2l.2-.4h1.1c0 .5-.3.8-.6 1.1a2 2 0 0 1-1.3.4c-.5 0-1-.2-1.3-.6a2 2 0 0 1-.5-1.4c0-.6.1-1.1.5-1.5.3-.4.8-.5 1.4-.5.5 0 1 0 1.2.3.4.3.5.7.5 1.2h-1v-.1z\" fill-rule=\"evenodd\"/></svg>',\n        'checklist-rtl': '<svg width=\"24\" height=\"24\"><path d=\"M5 17h8c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 0 1 0-2zm0-6h8c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 0 1 0-2zm0-6h8c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 1 1 0-2zm14.2 11c.2-.4.6-.5.9-.3.3.2.4.6.2 1L18 20c-.2.3-.7.4-1 0l-1.3-1.3a.7.7 0 0 1 0-1c.3-.2.7-.2 1 0l.7.9 1.7-2.8zm0-6c.2-.4.6-.5.9-.3.3.2.4.6.2 1L18 14c-.2.3-.7.4-1 0l-1.3-1.3a.7.7 0 0 1 0-1c.3-.2.7-.2 1 0l.7.9 1.7-2.8zm0-6c.2-.4.6-.5.9-.3.3.2.4.6.2 1L18 8c-.2.3-.7.4-1 0l-1.3-1.3a.7.7 0 0 1 0-1c.3-.2.7-.2 1 0l.7.9 1.7-2.8z\" fill-rule=\"evenodd\"/></svg>',\n        'checklist': '<svg width=\"24\" height=\"24\"><path d=\"M11 17h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zm0-6h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zm0-6h8a1 1 0 0 1 0 2h-8a1 1 0 0 1 0-2zM7.2 16c.2-.4.6-.5.9-.3.3.2.4.6.2 1L6 20c-.2.3-.7.4-1 0l-1.3-1.3a.7.7 0 0 1 0-1c.3-.2.7-.2 1 0l.7.9 1.7-2.8zm0-6c.2-.4.6-.5.9-.3.3.2.4.6.2 1L6 14c-.2.3-.7.4-1 0l-1.3-1.3a.7.7 0 0 1 0-1c.3-.2.7-.2 1 0l.7.9 1.7-2.8zm0-6c.2-.4.6-.5.9-.3.3.2.4.6.2 1L6 8c-.2.3-.7.4-1 0L3.8 6.9a.7.7 0 0 1 0-1c.3-.2.7-.2 1 0l.7.9 1.7-2.8z\" fill-rule=\"evenodd\"/></svg>',\n        'checkmark': '<svg width=\"24\" height=\"24\"><path d=\"M18.2 5.4a1 1 0 0 1 1.6 1.2l-8 12a1 1 0 0 1-1.5.1l-5-5a1 1 0 1 1 1.4-1.4l4.1 4.1 7.4-11z\" fill-rule=\"nonzero\"/></svg>',\n        'chevron-down': '<svg width=\"10\" height=\"10\"><path d=\"M8.7 2.2c.3-.3.8-.3 1 0 .4.4.4.9 0 1.2L5.7 7.8c-.3.3-.9.3-1.2 0L.2 3.4a.8.8 0 0 1 0-1.2c.3-.3.8-.3 1.1 0L5 6l3.7-3.8z\" fill-rule=\"nonzero\"/></svg>',\n        'chevron-left': '<svg width=\"10\" height=\"10\"><path d=\"M7.8 1.3L4 5l3.8 3.7c.3.3.3.8 0 1-.4.4-.9.4-1.2 0L2.2 5.7a.8.8 0 0 1 0-1.2L6.6.2C7 0 7.4 0 7.8.2c.3.3.3.8 0 1.1z\" fill-rule=\"nonzero\"/></svg>',\n        'chevron-right': '<svg width=\"10\" height=\"10\"><path d=\"M2.2 1.3a.8.8 0 0 1 0-1c.4-.4.9-.4 1.2 0l4.4 4.1c.3.4.3.9 0 1.2L3.4 9.8c-.3.3-.8.3-1.2 0a.8.8 0 0 1 0-1.1L6 5 2.2 1.3z\" fill-rule=\"nonzero\"/></svg>',\n        'chevron-up': '<svg width=\"10\" height=\"10\"><path d=\"M8.7 7.8L5 4 1.3 7.8c-.3.3-.8.3-1 0a.8.8 0 0 1 0-1.2l4.1-4.4c.3-.3.9-.3 1.2 0l4.2 4.4c.3.3.3.9 0 1.2-.3.3-.8.3-1.1 0z\" fill-rule=\"nonzero\"/></svg>',\n        'close': '<svg width=\"24\" height=\"24\"><path d=\"M17.3 8.2L13.4 12l3.9 3.8a1 1 0 0 1-1.5 1.5L12 13.4l-3.8 3.9a1 1 0 0 1-1.5-1.5l3.9-3.8-3.9-3.8a1 1 0 0 1 1.5-1.5l3.8 3.9 3.8-3.9a1 1 0 0 1 1.5 1.5z\" fill-rule=\"evenodd\"/></svg>',\n        'code-sample': '<svg width=\"24\" height=\"26\"><path d=\"M7.1 11a2.8 2.8 0 0 1-.8 2 2.8 2.8 0 0 1 .8 2v1.7c0 .3.1.6.4.8.2.3.5.4.8.4.3 0 .4.2.4.4v.8c0 .2-.1.4-.4.4-.7 0-1.4-.3-2-.8-.5-.6-.8-1.3-.8-2V15c0-.3-.1-.6-.4-.8-.2-.3-.5-.4-.8-.4a.4.4 0 0 1-.4-.4v-.8c0-.2.2-.4.4-.4.3 0 .6-.1.8-.4.3-.2.4-.5.4-.8V9.3c0-.7.3-1.4.8-2 .6-.5 1.3-.8 2-.8.3 0 .4.2.4.4v.8c0 .2-.1.4-.4.4-.3 0-.6.1-.8.4-.3.2-.4.5-.4.8V11zm9.8 0V9.3c0-.3-.1-.6-.4-.8-.2-.3-.5-.4-.8-.4a.4.4 0 0 1-.4-.4V7c0-.2.1-.4.4-.4.7 0 1.4.3 2 .8.5.6.8 1.3.8 2V11c0 .3.1.6.4.8.2.3.5.4.8.4.2 0 .4.2.4.4v.8c0 .2-.2.4-.4.4-.3 0-.6.1-.8.4-.3.2-.4.5-.4.8v1.7c0 .7-.3 1.4-.8 2-.6.5-1.3.8-2 .8a.4.4 0 0 1-.4-.4v-.8c0-.2.1-.4.4-.4.3 0 .6-.1.8-.4.3-.2.4-.5.4-.8V15a2.8 2.8 0 0 1 .8-2 2.8 2.8 0 0 1-.8-2zm-3.3-.4c0 .4-.1.8-.5 1.1-.3.3-.7.5-1.1.5-.4 0-.8-.2-1.1-.5-.4-.3-.5-.7-.5-1.1 0-.5.1-.9.5-1.2.3-.3.7-.4 1.1-.4.4 0 .8.1 1.1.4.4.3.5.7.5 1.2zM12 13c.4 0 .8.1 1.1.5.4.3.5.7.5 1.1 0 1-.1 1.6-.5 2a3 3 0 0 1-1.1 1c-.4.3-.8.4-1.1.4a.5.5 0 0 1-.5-.5V17a3 3 0 0 0 1-.2l.6-.6c-.6 0-1-.2-1.3-.5-.2-.3-.3-.7-.3-1 0-.5.1-1 .5-1.2.3-.4.7-.5 1.1-.5z\" fill-rule=\"evenodd\"/></svg>',\n        'color-levels': '<svg width=\"24\" height=\"24\"><path d=\"M17.5 11.4A9 9 0 0 1 18 14c0 .5 0 1-.2 1.4 0 .4-.3.9-.5 1.3a6.2 6.2 0 0 1-3.7 3 5.7 5.7 0 0 1-3.2 0A5.9 5.9 0 0 1 7.6 18a6.2 6.2 0 0 1-1.4-2.6 6.7 6.7 0 0 1 0-2.8c0-.4.1-.9.3-1.3a13.6 13.6 0 0 1 2.3-4A20 20 0 0 1 12 4a26.4 26.4 0 0 1 3.2 3.4 18.2 18.2 0 0 1 2.3 4zm-2 4.5c.4-.7.5-1.4.5-2a7.3 7.3 0 0 0-1-3.2c.2.6.2 1.2.2 1.9a4.5 4.5 0 0 1-1.3 3 5.3 5.3 0 0 1-2.3 1.5 4.9 4.9 0 0 1-2 .1 4.3 4.3 0 0 0 2.4.8 4 4 0 0 0 2-.6 4 4 0 0 0 1.5-1.5z\" fill-rule=\"evenodd\"/></svg>',\n        'color-picker': '<svg width=\"24\" height=\"24\"><path d=\"M12 3a9 9 0 0 0 0 18 1.5 1.5 0 0 0 1.1-2.5c-.2-.3-.4-.6-.4-1 0-.8.7-1.5 1.5-1.5H16a5 5 0 0 0 5-5c0-4.4-4-8-9-8zm-5.5 9a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm3-4a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm3 4a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z\" fill-rule=\"nonzero\"/></svg>',\n        'color-swatch-remove-color': '<svg width=\"24\" height=\"24\"><path stroke=\"#000\" stroke-width=\"2\" d=\"M21 3L3 21\" fill-rule=\"evenodd\"/></svg>',\n        'color-swatch': '<svg width=\"24\" height=\"24\"><rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"1\" fill-rule=\"evenodd\"/></svg>',\n        'comment-add': '<svg width=\"24\" height=\"24\"><g fill-rule=\"nonzero\"><path d=\"M9 19l3-2h7c.6 0 1-.4 1-1V6c0-.6-.4-1-1-1H5a1 1 0 0 0-1 1v10c0 .6.4 1 1 1h4v2zm-2 4v-4H5a3 3 0 0 1-3-3V6a3 3 0 0 1 3-3h14a3 3 0 0 1 3 3v10a3 3 0 0 1-3 3h-6.4L7 23z\"/><path d=\"M13 10h2a1 1 0 0 1 0 2h-2v2a1 1 0 0 1-2 0v-2H9a1 1 0 0 1 0-2h2V8a1 1 0 0 1 2 0v2z\"/></g></svg>',\n        'comment': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M9 19l3-2h7c.6 0 1-.4 1-1V6c0-.6-.4-1-1-1H5a1 1 0 0 0-1 1v10c0 .6.4 1 1 1h4v2zm-2 4v-4H5a3 3 0 0 1-3-3V6a3 3 0 0 1 3-3h14a3 3 0 0 1 3 3v10a3 3 0 0 1-3 3h-6.4L7 23z\"/></svg>',\n        'contrast': '<svg width=\"24\" height=\"24\"><path d=\"M12 4a7.8 7.8 0 0 1 5.7 2.3A8 8 0 1 1 12 4zm-6 8a6 6 0 0 0 6 6V6a6 6 0 0 0-6 6z\" fill-rule=\"evenodd\"/></svg>',\n        'copy': '<svg width=\"24\" height=\"24\"><path d=\"M16 3H6a2 2 0 0 0-2 2v11h2V5h10V3zm1 4a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-7a2 2 0 0 1-2-2V9c0-1.2.9-2 2-2h7zm0 12V9h-7v10h7z\" fill-rule=\"nonzero\"/></svg>',\n        'crop': '<svg width=\"24\" height=\"24\"><path d=\"M17 8v7h2c.6 0 1 .4 1 1s-.4 1-1 1h-2v2c0 .6-.4 1-1 1a1 1 0 0 1-1-1v-2H7V9H5a1 1 0 1 1 0-2h2V5c0-.6.4-1 1-1s1 .4 1 1v2h7l3-3 1 1-3 3zM9 9v5l5-5H9zm1 6h5v-5l-5 5z\" fill-rule=\"evenodd\"/></svg>',\n        'cut': '<svg width=\"24\" height=\"24\"><path d=\"M18 15c.6.7 1 1.4 1 2.3 0 .8-.2 1.5-.7 2l-.8.5-1 .2c-.4 0-.8 0-1.2-.3a3.9 3.9 0 0 1-2.1-2.2c-.2-.5-.3-1-.2-1.5l-1-1-1 1c0 .5 0 1-.2 1.5-.1.5-.4 1-.9 1.4-.3.4-.7.6-1.2.8l-1.2.3c-.4 0-.7 0-1-.2-.3 0-.6-.3-.8-.5-.5-.5-.8-1.2-.7-2 0-.9.4-1.6 1-2.2A3.7 3.7 0 0 1 8.6 14H9l1-1-4-4-.5-1a3.3 3.3 0 0 1 0-2c0-.4.3-.7.5-1l6 6 6-6 .5 1a3.3 3.3 0 0 1 0 2c0 .4-.3.7-.5 1l-4 4 1 1h.5c.4 0 .8 0 1.2.3.5.2.9.4 1.2.8zm-8.5 2.2l.1-.4v-.3-.4a1 1 0 0 0-.2-.5 1 1 0 0 0-.4-.2 1.6 1.6 0 0 0-.8 0 2.6 2.6 0 0 0-.8.3 2.5 2.5 0 0 0-.9 1.1l-.1.4v.7l.2.5.5.2h.7a2.5 2.5 0 0 0 .8-.3 2.8 2.8 0 0 0 1-1zm2.5-2.8c.4 0 .7-.1 1-.4.3-.3.4-.6.4-1s-.1-.7-.4-1c-.3-.3-.6-.4-1-.4s-.7.1-1 .4c-.3.3-.4.6-.4 1s.1.7.4 1c.3.3.6.4 1 .4zm5.4 4l.2-.5v-.4-.3a2.6 2.6 0 0 0-.3-.8 2.4 2.4 0 0 0-.7-.7 2.5 2.5 0 0 0-.8-.3 1.5 1.5 0 0 0-.8 0 1 1 0 0 0-.4.2 1 1 0 0 0-.2.5 1.5 1.5 0 0 0 0 .7v.4l.3.4.3.4a2.8 2.8 0 0 0 .8.5l.4.1h.7l.5-.2z\" fill-rule=\"evenodd\"/></svg>',\n        'document-properties': '<svg width=\"24\" height=\"24\"><path d=\"M14.4 3H7a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h10a2 2 0 0 0 2-2V7.6L14.4 3zM17 19H7V5h6v4h4v10z\" fill-rule=\"nonzero\"/></svg>',\n        'drag': '<svg width=\"24\" height=\"24\"><path d=\"M13 5h2v2h-2V5zm0 4h2v2h-2V9zM9 9h2v2H9V9zm4 4h2v2h-2v-2zm-4 0h2v2H9v-2zm0 4h2v2H9v-2zm4 0h2v2h-2v-2zM9 5h2v2H9V5z\" fill-rule=\"evenodd\"/></svg>',\n        'duplicate': '<svg width=\"24\" height=\"24\"><g fill-rule=\"nonzero\"><path d=\"M16 3v2H6v11H4V5c0-1.1.9-2 2-2h10zm3 8h-2V9h-7v10h9a2 2 0 0 1-2 2h-7a2 2 0 0 1-2-2V9c0-1.2.9-2 2-2h7a2 2 0 0 1 2 2v2z\"/><path d=\"M17 14h1a1 1 0 0 1 0 2h-1v1a1 1 0 0 1-2 0v-1h-1a1 1 0 0 1 0-2h1v-1a1 1 0 0 1 2 0v1z\"/></g></svg>',\n        'edit-block': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M19.8 8.8l-9.4 9.4c-.2.2-.5.4-.9.4l-5.4 1.2 1.2-5.4.5-.8 9.4-9.4c.7-.7 1.8-.7 2.5 0l2.1 2.1c.7.7.7 1.8 0 2.5zm-2-.2l1-.9v-.3l-2.2-2.2a.3.3 0 0 0-.3 0l-1 1L18 8.5zm-1 1l-2.5-2.4-6 6 2.5 2.5 6-6zm-7 7.1l-2.6-2.4-.3.3-.1.2-.7 3 3.1-.6h.1l.4-.5z\"/></svg>',\n        'edit-image': '<svg width=\"24\" height=\"24\"><path d=\"M18 16h2V7a2 2 0 0 0-2-2H7v2h11v9zM6 17h15a1 1 0 0 1 0 2h-1v1a1 1 0 0 1-2 0v-1H6a2 2 0 0 1-2-2V7H3a1 1 0 1 1 0-2h1V4a1 1 0 1 1 2 0v13zm3-5.3l1.3 2 3-4.7 3.7 6H7l2-3.3z\" fill-rule=\"nonzero\"/></svg>',\n        'embed-page': '<svg width=\"24\" height=\"24\"><path d=\"M19 6V5H5v14h2A13 13 0 0 1 19 6zm0 1.4c-.8.8-1.6 2.4-2.2 4.6H19V7.4zm0 5.6h-2.4c-.4 1.8-.6 3.8-.6 6h3v-6zm-4 6c0-2.2.2-4.2.6-6H13c-.7 1.8-1.1 3.8-1.1 6h3zm-4 0c0-2.2.4-4.2 1-6H9.6A12 12 0 0 0 8 19h3zM4 3h16c.6 0 1 .4 1 1v16c0 .6-.4 1-1 1H4a1 1 0 0 1-1-1V4c0-.6.4-1 1-1zm11.8 9c.4-1.9 1-3.4 1.8-4.5a9.2 9.2 0 0 0-4 4.5h2.2zm-3.4 0a12 12 0 0 1 2.8-4 12 12 0 0 0-5 4h2.2z\" fill-rule=\"nonzero\"/></svg>',\n        'embed': '<svg width=\"24\" height=\"24\"><path d=\"M4 3h16c.6 0 1 .4 1 1v16c0 .6-.4 1-1 1H4a1 1 0 0 1-1-1V4c0-.6.4-1 1-1zm1 2v14h14V5H5zm4.8 2.6l5.6 4a.5.5 0 0 1 0 .8l-5.6 4A.5.5 0 0 1 9 16V8a.5.5 0 0 1 .8-.4z\" fill-rule=\"nonzero\"/></svg>',\n        'emoji': '<svg width=\"24\" height=\"24\"><path d=\"M9 11c.6 0 1-.4 1-1s-.4-1-1-1a1 1 0 0 0-1 1c0 .6.4 1 1 1zm6 0c.6 0 1-.4 1-1s-.4-1-1-1a1 1 0 0 0-1 1c0 .6.4 1 1 1zm-3 5.5c2.1 0 4-1.5 4.4-3.5H7.6c.5 2 2.3 3.5 4.4 3.5zM12 4a8 8 0 1 0 0 16 8 8 0 0 0 0-16zm0 14.5a6.5 6.5 0 1 1 0-13 6.5 6.5 0 0 1 0 13z\" fill-rule=\"nonzero\"/></svg>',\n        'fill': '<svg width=\"24\" height=\"26\"><path d=\"M16.6 12l-9-9-1.4 1.4 2.4 2.4-5.2 5.1c-.5.6-.5 1.6 0 2.2L9 19.6a1.5 1.5 0 0 0 2.2 0l5.5-5.5c.5-.6.5-1.6 0-2.2zM5.2 13L10 8.2l4.8 4.8H5.2zM19 14.5s-2 2.2-2 3.5c0 1.1.9 2 2 2a2 2 0 0 0 2-2c0-1.3-2-3.5-2-3.5z\" fill-rule=\"nonzero\"/></svg>',\n        'flip-horizontally': '<svg width=\"24\" height=\"24\"><path d=\"M14 19h2v-2h-2v2zm4-8h2V9h-2v2zM4 7v10c0 1.1.9 2 2 2h3v-2H6V7h3V5H6a2 2 0 0 0-2 2zm14-2v2h2a2 2 0 0 0-2-2zm-7 16h2V3h-2v18zm7-6h2v-2h-2v2zm-4-8h2V5h-2v2zm4 12a2 2 0 0 0 2-2h-2v2z\" fill-rule=\"nonzero\"/></svg>',\n        'flip-vertically': '<svg width=\"24\" height=\"24\"><path d=\"M5 14v2h2v-2H5zm8 4v2h2v-2h-2zm4-14H7a2 2 0 0 0-2 2v3h2V6h10v3h2V6a2 2 0 0 0-2-2zm2 14h-2v2a2 2 0 0 0 2-2zM3 11v2h18v-2H3zm6 7v2h2v-2H9zm8-4v2h2v-2h-2zM5 18c0 1.1.9 2 2 2v-2H5z\" fill-rule=\"nonzero\"/></svg>',\n        'format-painter': '<svg width=\"24\" height=\"24\"><path d=\"M18 5V4c0-.5-.4-1-1-1H5a1 1 0 0 0-1 1v4c0 .6.5 1 1 1h12c.6 0 1-.4 1-1V7h1v4H9v9c0 .6.4 1 1 1h2c.6 0 1-.4 1-1v-7h8V5h-3z\" fill-rule=\"nonzero\"/></svg>',\n        'format': '<svg width=\"24\" height=\"24\"><path fill-rule=\"evenodd\" d=\"M17 5a1 1 0 0 1 0 2h-4v11a1 1 0 0 1-2 0V7H7a1 1 0 1 1 0-2h10z\"/></svg>',\n        'fullscreen': '<svg width=\"24\" height=\"24\"><path d=\"M15.3 10l-1.2-1.3 2.9-3h-2.3a.9.9 0 1 1 0-1.7H19c.5 0 .9.4.9.9v4.4a.9.9 0 1 1-1.8 0V7l-2.9 3zm0 4l3 3v-2.3a.9.9 0 1 1 1.7 0V19c0 .5-.4.9-.9.9h-4.4a.9.9 0 1 1 0-1.8H17l-3-2.9 1.3-1.2zM10 15.4l-2.9 3h2.3a.9.9 0 1 1 0 1.7H5a.9.9 0 0 1-.9-.9v-4.4a.9.9 0 1 1 1.8 0V17l2.9-3 1.2 1.3zM8.7 10L5.7 7v2.3a.9.9 0 0 1-1.7 0V5c0-.5.4-.9.9-.9h4.4a.9.9 0 0 1 0 1.8H7l3 2.9-1.3 1.2z\" fill-rule=\"nonzero\"/></svg>',\n        'gallery': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M5 15.7l2.3-2.2c.3-.3.7-.3 1 0L11 16l5.1-5c.3-.4.8-.4 1 0l2 1.9V8H5v7.7zM5 18V19h3l1.8-1.9-2-2L5 17.9zm14-3l-2.5-2.4-6.4 6.5H19v-4zM4 6h16c.6 0 1 .4 1 1v13c0 .6-.4 1-1 1H4a1 1 0 0 1-1-1V7c0-.6.4-1 1-1zm6 7a2 2 0 1 1 0-4 2 2 0 0 1 0 4zM4.5 4h15a.5.5 0 1 1 0 1h-15a.5.5 0 0 1 0-1zm2-2h11a.5.5 0 1 1 0 1h-11a.5.5 0 0 1 0-1z\"/></svg>',\n        'gamma': '<svg width=\"24\" height=\"24\"><path d=\"M4 3h16c.6 0 1 .4 1 1v16c0 .6-.4 1-1 1H4a1 1 0 0 1-1-1V4c0-.6.4-1 1-1zm1 2v14h14V5H5zm6.5 11.8V14L9.2 8.7a5.1 5.1 0 0 0-.4-.8l-.1-.2H8 8v-1l.3-.1.3-.1h.7a1 1 0 0 1 .6.5l.1.3a8.5 8.5 0 0 1 .3.6l1.9 4.6 2-5.2a1 1 0 0 1 1-.6.5.5 0 0 1 .5.6L13 14v2.8a.7.7 0 0 1-1.4 0z\" fill-rule=\"nonzero\"/></svg>',\n        'help': '<svg width=\"24\" height=\"24\"><g fill-rule=\"evenodd\"><path d=\"M12 5.5a6.5 6.5 0 0 0-6 9 6.3 6.3 0 0 0 1.4 2l1 1a6.3 6.3 0 0 0 3.6 1 6.5 6.5 0 0 0 6-9 6.3 6.3 0 0 0-1.4-2l-1-1a6.3 6.3 0 0 0-3.6-1zM12 4a7.8 7.8 0 0 1 5.7 2.3A8 8 0 1 1 12 4z\"/><path d=\"M9.6 9.7a.7.7 0 0 1-.7-.8c0-1.1 1.5-1.8 3.2-1.8 1.8 0 3.2.8 3.2 2.4 0 1.4-.4 2.1-1.5 2.8-.2 0-.3.1-.3.2a2 2 0 0 0-.8.8.8.8 0 0 1-1.4-.6c.3-.7.8-1 1.3-1.5l.4-.2c.7-.4.8-.6.8-1.5 0-.5-.6-.9-1.7-.9-.5 0-1 .1-1.4.3-.2 0-.3.1-.3.2v-.2c0 .4-.4.8-.8.8z\" fill-rule=\"nonzero\"/><circle cx=\"12\" cy=\"16\" r=\"1\"/></g></svg>',\n        'highlight-bg-color': '<svg width=\"24\" height=\"24\"><g fill-rule=\"evenodd\"><path id=\"tox-icon-highlight-bg-color__color\" d=\"M3 18h18v3H3z\"/><path fill-rule=\"nonzero\" d=\"M7.7 16.7H3l3.3-3.3-.7-.8L10.2 8l4 4.1-4 4.2c-.2.2-.6.2-.8 0l-.6-.7-1.1 1.1zm5-7.5L11 7.4l3-2.9a2 2 0 0 1 2.6 0L18 6c.7.7.7 2 0 2.7l-2.9 2.9-1.8-1.8-.5-.6\"/></g></svg>',\n        'home': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z\"/></svg>',\n        'horizontal-rule': '<svg width=\"24\" height=\"24\"><path d=\"M4 11h16v2H4z\" fill-rule=\"evenodd\"/></svg>',\n        'image-options': '<svg width=\"24\" height=\"24\"><path d=\"M6 10a2 2 0 0 0-2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2 2 2 0 0 0-2-2zm12 0a2 2 0 0 0-2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2 2 2 0 0 0-2-2zm-6 0a2 2 0 0 0-2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2 2 2 0 0 0-2-2z\" fill-rule=\"nonzero\"/></svg>',\n        'image': '<svg width=\"24\" height=\"24\"><path d=\"M5 15.7l3.3-3.2c.3-.3.7-.3 1 0L12 15l4.1-4c.3-.4.8-.4 1 0l2 1.9V5H5v10.7zM5 18V19h3l2.8-2.9-2-2L5 17.9zm14-3l-2.5-2.4-6.4 6.5H19v-4zM4 3h16c.6 0 1 .4 1 1v16c0 .6-.4 1-1 1H4a1 1 0 0 1-1-1V4c0-.6.4-1 1-1zm6 8a2 2 0 1 0 0-4 2 2 0 0 0 0 4z\" fill-rule=\"nonzero\"/></svg>',\n        'indent': '<svg width=\"24\" height=\"24\"><path d=\"M7 5h12c.6 0 1 .4 1 1s-.4 1-1 1H7a1 1 0 1 1 0-2zm5 4h7c.6 0 1 .4 1 1s-.4 1-1 1h-7a1 1 0 0 1 0-2zm0 4h7c.6 0 1 .4 1 1s-.4 1-1 1h-7a1 1 0 0 1 0-2zm-5 4h12a1 1 0 0 1 0 2H7a1 1 0 0 1 0-2zm-2.6-3.8L6.2 12l-1.8-1.2a1 1 0 0 1 1.2-1.6l3 2a1 1 0 0 1 0 1.6l-3 2a1 1 0 1 1-1.2-1.6z\" fill-rule=\"evenodd\"/></svg>',\n        'info': '<svg width=\"24\" height=\"24\"><path d=\"M12 4a7.8 7.8 0 0 1 5.7 2.3A8 8 0 1 1 12 4zm-1 3v2h2V7h-2zm3 10v-1h-1v-5h-3v1h1v4h-1v1h4z\" fill-rule=\"evenodd\"/></svg>',\n        'insert-character': '<svg width=\"24\" height=\"24\"><path d=\"M15 18h4l1-2v4h-6v-3.3l1.4-1a6 6 0 0 0 1.8-2.9 6.3 6.3 0 0 0-.1-4.1 5.8 5.8 0 0 0-3-3.2c-.6-.3-1.3-.5-2.1-.5a5.1 5.1 0 0 0-3.9 1.8 6.3 6.3 0 0 0-1.3 6 6.2 6.2 0 0 0 1.8 3l1.4.9V20H4v-4l1 2h4v-.5l-2-1L5.4 15A6.5 6.5 0 0 1 4 11c0-1 .2-1.9.6-2.7A7 7 0 0 1 6.3 6C7.1 5.4 8 5 9 4.5c1-.3 2-.5 3.1-.5a8.8 8.8 0 0 1 5.7 2 7 7 0 0 1 1.7 2.3 6 6 0 0 1 .2 4.8c-.2.7-.6 1.3-1 1.9a7.6 7.6 0 0 1-3.6 2.5v.5z\" fill-rule=\"evenodd\"/></svg>',\n        'insert-time': '<svg width=\"24\" height=\"24\"><g fill-rule=\"nonzero\"><path d=\"M12 19a7 7 0 1 0 0-14 7 7 0 0 0 0 14zm0 2a9 9 0 1 1 0-18 9 9 0 0 1 0 18z\"/><path d=\"M16 12h-3V7c0-.6-.4-1-1-1a1 1 0 0 0-1 1v7h5c.6 0 1-.4 1-1s-.4-1-1-1z\"/></g></svg>',\n        'invert': '<svg width=\"24\" height=\"24\"><path d=\"M18 19.3L16.5 18a5.8 5.8 0 0 1-3.1 1.9 6.1 6.1 0 0 1-5.5-1.6A5.8 5.8 0 0 1 6 14v-.3l.1-1.2A13.9 13.9 0 0 1 7.7 9l-3-3 .7-.8 2.8 2.9 9 8.9 1.5 1.6-.7.6zm0-5.5v.3l-.1 1.1-.4 1-1.2-1.2a4.3 4.3 0 0 0 .2-1v-.2c0-.4 0-.8-.2-1.3l-.5-1.4a14.8 14.8 0 0 0-3-4.2L12 6a26.1 26.1 0 0 0-2.2 2.5l-1-1a20.9 20.9 0 0 1 2.9-3.3L12 4l1 .8a22.2 22.2 0 0 1 4 5.4c.6 1.2 1 2.4 1 3.6z\" fill-rule=\"evenodd\"/></svg>',\n        'italic': '<svg width=\"24\" height=\"24\"><path d=\"M16.7 4.7l-.1.9h-.3c-.6 0-1 0-1.4.3-.3.3-.4.6-.5 1.1l-2.1 9.8v.6c0 .5.4.8 1.4.8h.2l-.2.8H8l.2-.8h.2c1.1 0 1.8-.5 2-1.5l2-9.8.1-.5c0-.6-.4-.8-1.4-.8h-.3l.2-.9h5.8z\" fill-rule=\"evenodd\"/></svg>',\n        'line': '<svg width=\"24\" height=\"24\"><path d=\"M15 9l-8 8H4v-3l8-8 3 3zm1-1l-3-3 1-1h1c-.2 0 0 0 0 0l2 2s0 .2 0 0v1l-1 1zM4 18h16v2H4v-2z\" fill-rule=\"evenodd\"/></svg>',\n        'link': '<svg width=\"24\" height=\"24\"><path d=\"M6.2 12.3a1 1 0 0 1 1.4 1.4l-2.1 2a2 2 0 1 0 2.7 2.8l4.8-4.8a1 1 0 0 0 0-1.4 1 1 0 1 1 1.4-1.3 2.9 2.9 0 0 1 0 4L9.6 20a3.9 3.9 0 0 1-5.5-5.5l2-2zm11.6-.6a1 1 0 0 1-1.4-1.4l2-2a2 2 0 1 0-2.6-2.8L11 10.3a1 1 0 0 0 0 1.4A1 1 0 1 1 9.6 13a2.9 2.9 0 0 1 0-4L14.4 4a3.9 3.9 0 0 1 5.5 5.5l-2 2z\" fill-rule=\"nonzero\"/></svg>',\n        'list-bull-circle': '<svg width=\"48\" height=\"48\"><g fill-rule=\"evenodd\"><path d=\"M11 16a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm0 1a3 3 0 1 1 0-6 3 3 0 0 1 0 6zM11 26a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm0 1a3 3 0 1 1 0-6 3 3 0 0 1 0 6zM11 36a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm0 1a3 3 0 1 1 0-6 3 3 0 0 1 0 6z\" fill-rule=\"nonzero\"/><path opacity=\".2\" d=\"M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z\"/></g></svg>',\n        'list-bull-default': '<svg width=\"48\" height=\"48\"><g fill-rule=\"evenodd\"><circle cx=\"11\" cy=\"14\" r=\"3\"/><circle cx=\"11\" cy=\"24\" r=\"3\"/><circle cx=\"11\" cy=\"34\" r=\"3\"/><path opacity=\".2\" d=\"M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z\"/></g></svg>',\n        'list-bull-square': '<svg width=\"48\" height=\"48\"><g fill-rule=\"evenodd\"><path d=\"M8 11h6v6H8zM8 21h6v6H8zM8 31h6v6H8z\"/><path opacity=\".2\" d=\"M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z\"/></g></svg>',\n        'list-num-default-rtl': '<svg width=\"48\" height=\"48\"><g fill-rule=\"evenodd\"><path opacity=\".2\" d=\"M8 12h22v4H8zM8 22h22v4H8zM8 32h22v4H8z\"/><path d=\"M37.4 17v-4.8l-1.6 1v-1.1l1.6-1h1.2V17zM33.3 17.1c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zm1.7 5.7c0-1.2 1-2 2.2-2 1.3 0 2.1.8 2.1 1.8 0 .7-.3 1.2-1.3 2.2l-1.2 1v.2h2.6v1h-4.3v-.9l2-1.9c.8-.8 1-1.1 1-1.5 0-.5-.4-.8-1-.8-.5 0-.9.3-.9.9H35zm-1.7 4.3c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zm3.2 7.3v-1h.7c.6 0 1-.3 1-.8 0-.4-.4-.7-1-.7s-1 .3-1 .8H35c0-1.1 1-1.8 2.2-1.8 1.2 0 2.1.6 2.1 1.6 0 .7-.4 1.2-1 1.3v.1c.7.1 1.3.7 1.3 1.4 0 1-1 1.9-2.4 1.9-1.3 0-2.2-.8-2.3-2h1.2c0 .6.5 1 1.1 1 .6 0 1-.4 1-1 0-.5-.3-.8-1-.8h-.7zm-3.3 2.7c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .8.3.8.7 0 .4-.3.7-.8.7z\"/></g></svg>',\n        'list-num-default': '<svg width=\"48\" height=\"48\"><g fill-rule=\"evenodd\"><path opacity=\".2\" d=\"M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z\"/><path d=\"M10 17v-4.8l-1.5 1v-1.1l1.6-1h1.2V17h-1.2zm3.6.1c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .7.3.7.7 0 .4-.2.7-.7.7zm-5 5.7c0-1.2.8-2 2.1-2s2.1.8 2.1 1.8c0 .7-.3 1.2-1.4 2.2l-1.1 1v.2h2.6v1H8.6v-.9l2-1.9c.8-.8 1-1.1 1-1.5 0-.5-.4-.8-1-.8-.5 0-.9.3-.9.9H8.5zm6.3 4.3c-.5 0-.7-.3-.7-.7 0-.4.2-.7.7-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zM10 34.4v-1h.7c.6 0 1-.3 1-.8 0-.4-.4-.7-1-.7s-1 .3-1 .8H8.6c0-1.1 1-1.8 2.2-1.8 1.3 0 2.1.6 2.1 1.6 0 .7-.4 1.2-1 1.3v.1c.8.1 1.3.7 1.3 1.4 0 1-1 1.9-2.4 1.9-1.3 0-2.2-.8-2.3-2h1.2c0 .6.5 1 1.1 1 .7 0 1-.4 1-1 0-.5-.3-.8-1-.8h-.7zm4.7 2.7c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .8.3.8.7 0 .4-.3.7-.8.7z\"/></g></svg>',\n        'list-num-lower-alpha-rtl': '<svg width=\"48\" height=\"48\"><g fill-rule=\"evenodd\"><path opacity=\".2\" d=\"M8 12h22v4H8zM8 22h22v4H8zM8 32h22v4H8z\"/><path d=\"M36.5 16c-.9 0-1.5-.5-1.5-1.3s.6-1.3 1.8-1.4h1v-.4c0-.4-.2-.6-.7-.6-.4 0-.7.1-.8.4h-1.1c0-.8.8-1.4 2-1.4S39 12 39 13V16h-1.2v-.6c-.3.4-.8.7-1.4.7zm.4-.8c.6 0 1-.4 1-.9V14h-1c-.5.1-.7.3-.7.6 0 .4.3.6.7.6zM33.1 16.1c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .8.3.8.7 0 .4-.3.7-.8.7zM37.7 26c-.7 0-1.2-.2-1.5-.7v.7H35v-6.3h1.2v2.5c.3-.5.8-.9 1.5-.9 1.1 0 1.8 1 1.8 2.4 0 1.5-.7 2.4-1.8 2.4zm-.5-3.6c-.6 0-1 .5-1 1.3s.4 1.4 1 1.4c.7 0 1-.6 1-1.4 0-.8-.3-1.3-1-1.3zM33.2 26.1c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .8.3.8.7 0 .4-.3.7-.8.7zm6 7h-1c-.1-.5-.4-.8-1-.8s-1 .5-1 1.4c0 1 .4 1.4 1 1.4.5 0 .9-.2 1-.7h1c0 1-.8 1.7-2 1.7-1.4 0-2.2-.9-2.2-2.4s.8-2.4 2.2-2.4c1.2 0 2 .7 2 1.7zm-6.1 3c-.5 0-.7-.3-.7-.7 0-.4.2-.7.7-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7z\"/></g></svg>',\n        'list-num-lower-alpha': '<svg width=\"48\" height=\"48\"><g fill-rule=\"evenodd\"><path opacity=\".2\" d=\"M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z\"/><path d=\"M10.3 15.2c.5 0 1-.4 1-.9V14h-1c-.5.1-.8.3-.8.6 0 .4.3.6.8.6zm-.4.9c-1 0-1.5-.6-1.5-1.4 0-.8.6-1.3 1.7-1.4h1.1v-.4c0-.4-.2-.6-.7-.6-.5 0-.8.1-.9.4h-1c0-.8.8-1.4 2-1.4 1.1 0 1.8.6 1.8 1.6V16h-1.1v-.6h-.1c-.2.4-.7.7-1.3.7zm4.6 0c-.5 0-.7-.3-.7-.7 0-.4.2-.7.7-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zm-3.2 10c-.6 0-1.2-.3-1.4-.8v.7H8.5v-6.3H10v2.5c.3-.5.8-.9 1.4-.9 1.2 0 1.9 1 1.9 2.4 0 1.5-.7 2.4-1.9 2.4zm-.4-3.7c-.7 0-1 .5-1 1.3s.3 1.4 1 1.4c.6 0 1-.6 1-1.4 0-.8-.4-1.3-1-1.3zm4 3.7c-.5 0-.7-.3-.7-.7 0-.4.2-.7.7-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zm-2.2 7h-1.2c0-.5-.4-.8-.9-.8-.6 0-1 .5-1 1.4 0 1 .4 1.4 1 1.4.5 0 .8-.2 1-.7h1c0 1-.8 1.7-2 1.7-1.4 0-2.2-.9-2.2-2.4s.8-2.4 2.2-2.4c1.2 0 2 .7 2 1.7zm1.8 3c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7z\"/></g></svg>',\n        'list-num-lower-greek-rtl': '<svg width=\"48\" height=\"48\"><g fill-rule=\"evenodd\"><path opacity=\".2\" d=\"M8 12h22v4H8zM8 22h22v4H8zM8 32h22v4H8z\"/><path d=\"M37.4 16c-1.2 0-2-.8-2-2.3 0-1.5.8-2.4 2-2.4.6 0 1 .4 1.3 1v-.9H40v3.2c0 .4.1.5.4.5h.2v.9h-.6c-.6 0-1-.2-1-.7h-.2c-.2.4-.7.8-1.3.8zm.3-1c.6 0 1-.5 1-1.3s-.4-1.3-1-1.3-1 .5-1 1.3.4 1.4 1 1.4zM33.3 16.1c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zM36 21.9c0-1.5.8-2.3 2.1-2.3 1.2 0 2 .6 2 1.6 0 .6-.3 1-.9 1.3.9.3 1.3.8 1.3 1.7 0 1.2-.7 1.9-1.8 1.9-.6 0-1.1-.3-1.4-.8v2.2H36V22zm1.8 1.2v-1h.3c.5 0 .9-.2.9-.7 0-.5-.3-.8-.9-.8-.5 0-.8.3-.8 1v2.2c0 .8.4 1.3 1 1.3s1-.4 1-1-.4-1-1.2-1h-.3zM33.3 26.1c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zM37.1 34.6L34.8 30h1.4l1.7 3.5 1.7-3.5h1.1l-2.2 4.6v.1c.5.8.7 1.4.7 1.8 0 .4-.2.8-.4 1-.2.2-.6.3-1 .3-.9 0-1.3-.4-1.3-1.2 0-.5.2-1 .5-1.7l.1-.2zm.7 1a2 2 0 0 0-.4.9c0 .3.1.4.4.4.3 0 .4-.1.4-.4 0-.2-.1-.6-.4-1zM33.3 36.1c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7z\"/></g></svg>',\n        'list-num-lower-greek': '<svg width=\"48\" height=\"48\"><g fill-rule=\"evenodd\"><path opacity=\".2\" d=\"M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z\"/><path d=\"M10.5 15c.7 0 1-.5 1-1.3s-.3-1.3-1-1.3c-.5 0-.9.5-.9 1.3s.4 1.4 1 1.4zm-.3 1c-1.1 0-1.8-.8-1.8-2.3 0-1.5.7-2.4 1.8-2.4.7 0 1.1.4 1.3 1h.1v-.9h1.2v3.2c0 .4.1.5.4.5h.2v.9h-.6c-.6 0-1-.2-1.1-.7h-.1c-.2.4-.7.8-1.4.8zm5 .1c-.5 0-.8-.3-.8-.7 0-.4.3-.7.7-.7.5 0 .8.3.8.7 0 .4-.3.7-.8.7zm-4.9 7v-1h.3c.6 0 1-.2 1-.7 0-.5-.4-.8-1-.8-.5 0-.8.3-.8 1v2.2c0 .8.4 1.3 1.1 1.3.6 0 1-.4 1-1s-.5-1-1.3-1h-.3zM8.6 22c0-1.5.7-2.3 2-2.3 1.2 0 2 .6 2 1.6 0 .6-.3 1-.8 1.3.8.3 1.3.8 1.3 1.7 0 1.2-.8 1.9-1.9 1.9-.6 0-1.1-.3-1.3-.8v2.2H8.5V22zm6.2 4.2c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .7.3.7.7 0 .4-.2.7-.7.7zm-4.5 8.5L8 30h1.4l1.7 3.5 1.7-3.5h1.1l-2.2 4.6v.1c.5.8.7 1.4.7 1.8 0 .4-.1.8-.4 1-.2.2-.6.3-1 .3-.9 0-1.3-.4-1.3-1.2 0-.5.2-1 .5-1.7l.1-.2zm.7 1a2 2 0 0 0-.4.9c0 .3.1.4.4.4.3 0 .4-.1.4-.4 0-.2-.1-.6-.4-1zm4.5.5c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7z\"/></g></svg>',\n        'list-num-lower-roman-rtl': '<svg width=\"48\" height=\"48\"><g fill-rule=\"evenodd\"><path opacity=\".2\" d=\"M8 12h22v4H8zM8 22h22v4H8zM8 32h22v4H8z\"/><path d=\"M32.9 16v-1.2h-1.3V16H33zm0 10v-1.2h-1.3V26H33zm0 10v-1.2h-1.3V36H33z\"/><path fill-rule=\"nonzero\" d=\"M36 21h-1.5v5H36zM36 31h-1.5v5H36zM39 21h-1.5v5H39zM39 31h-1.5v5H39zM42 31h-1.5v5H42zM36 11h-1.5v5H36zM36 19h-1.5v1H36zM36 29h-1.5v1H36zM39 19h-1.5v1H39zM39 29h-1.5v1H39zM42 29h-1.5v1H42zM36 9h-1.5v1H36z\"/></g></svg>',\n        'list-num-lower-roman': '<svg width=\"48\" height=\"48\"><g fill-rule=\"evenodd\"><path opacity=\".2\" d=\"M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z\"/><path d=\"M15.1 16v-1.2h1.3V16H15zm0 10v-1.2h1.3V26H15zm0 10v-1.2h1.3V36H15z\"/><path fill-rule=\"nonzero\" d=\"M12 21h1.5v5H12zM12 31h1.5v5H12zM9 21h1.5v5H9zM9 31h1.5v5H9zM6 31h1.5v5H6zM12 11h1.5v5H12zM12 19h1.5v1H12zM12 29h1.5v1H12zM9 19h1.5v1H9zM9 29h1.5v1H9zM6 29h1.5v1H6zM12 9h1.5v1H12z\"/></g></svg>',\n        'list-num-upper-alpha-rtl': '<svg width=\"48\" height=\"48\"><g fill-rule=\"evenodd\"><path opacity=\".2\" d=\"M8 12h22v4H8zM8 22h22v4H8zM8 32h22v4H8z\"/><path d=\"M39.3 17l-.5-1.4h-2l-.5 1.4H35l2-6h1.6l2 6h-1.3zm-1.6-4.7l-.7 2.3h1.6l-.8-2.3zM33.4 17c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .7.3.7.7 0 .4-.2.7-.7.7zm4.7 9.9h-2.7v-6H38c1.2 0 1.9.6 1.9 1.5 0 .6-.5 1.2-1 1.3.7.1 1.3.7 1.3 1.5 0 1-.8 1.7-2 1.7zm-1.4-5v1.5h1c.6 0 1-.3 1-.8 0-.4-.4-.7-1-.7h-1zm0 4h1.1c.7 0 1.1-.3 1.1-.8 0-.6-.4-.9-1.1-.9h-1.1V26zM33 27.1c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zm4.9 10c-1.8 0-2.8-1.1-2.8-3.1s1-3.1 2.8-3.1c1.4 0 2.5.9 2.6 2.2h-1.3c0-.7-.6-1.1-1.3-1.1-1 0-1.6.7-1.6 2s.6 2 1.6 2c.7 0 1.2-.4 1.4-1h1.2c-.1 1.3-1.2 2.2-2.6 2.2zm-4.5 0c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7z\"/></g></svg>',\n        'list-num-upper-alpha': '<svg width=\"48\" height=\"48\"><g fill-rule=\"evenodd\"><path opacity=\".2\" d=\"M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z\"/><path d=\"M12.6 17l-.5-1.4h-2L9.5 17H8.3l2-6H12l2 6h-1.3zM11 12.3l-.7 2.3h1.6l-.8-2.3zm4.7 4.8c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .7.3.7.7 0 .4-.2.7-.7.7zM11.4 27H8.7v-6h2.6c1.2 0 1.9.6 1.9 1.5 0 .6-.5 1.2-1 1.3.7.1 1.3.7 1.3 1.5 0 1-.8 1.7-2 1.7zM10 22v1.5h1c.6 0 1-.3 1-.8 0-.4-.4-.7-1-.7h-1zm0 4H11c.7 0 1.1-.3 1.1-.8 0-.6-.4-.9-1.1-.9H10V26zm5.4 1.1c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zm-4.1 10c-1.8 0-2.8-1.1-2.8-3.1s1-3.1 2.8-3.1c1.4 0 2.5.9 2.6 2.2h-1.3c0-.7-.6-1.1-1.3-1.1-1 0-1.6.7-1.6 2s.6 2 1.6 2c.7 0 1.2-.4 1.4-1h1.2c-.1 1.3-1.2 2.2-2.6 2.2zm4.5 0c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7z\"/></g></svg>',\n        'list-num-upper-roman-rtl': '<svg width=\"48\" height=\"48\"><g fill-rule=\"evenodd\"><path opacity=\".2\" d=\"M8 12h22v4H8zM8 22h22v4H8zM8 32h22v4H8z\"/><path d=\"M31.6 17v-1.2H33V17h-1.3zm0 10v-1.2H33V27h-1.3zm0 10v-1.2H33V37h-1.3z\"/><path fill-rule=\"nonzero\" d=\"M34.5 20H36v7h-1.5zM34.5 30H36v7h-1.5zM37.5 20H39v7h-1.5zM37.5 30H39v7h-1.5zM40.5 30H42v7h-1.5zM34.5 10H36v7h-1.5z\"/></g></svg>',\n        'list-num-upper-roman': '<svg width=\"48\" height=\"48\"><g fill-rule=\"evenodd\"><path opacity=\".2\" d=\"M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z\"/><path d=\"M15.1 17v-1.2h1.3V17H15zm0 10v-1.2h1.3V27H15zm0 10v-1.2h1.3V37H15z\"/><path fill-rule=\"nonzero\" d=\"M12 20h1.5v7H12zM12 30h1.5v7H12zM9 20h1.5v7H9zM9 30h1.5v7H9zM6 30h1.5v7H6zM12 10h1.5v7H12z\"/></g></svg>',\n        'lock': '<svg width=\"24\" height=\"24\"><path d=\"M16.3 11c.2 0 .3 0 .5.2l.2.6v7.4c0 .3 0 .4-.2.6l-.6.2H7.8c-.3 0-.4 0-.6-.2a.7.7 0 0 1-.2-.6v-7.4c0-.3 0-.4.2-.6l.5-.2H8V8c0-.8.3-1.5.9-2.1.6-.6 1.3-.9 2.1-.9h2c.8 0 1.5.3 2.1.9.6.6.9 1.3.9 2.1v3h.3zM10 8v3h4V8a1 1 0 0 0-.3-.7A1 1 0 0 0 13 7h-2a1 1 0 0 0-.7.3 1 1 0 0 0-.3.7z\" fill-rule=\"evenodd\"/></svg>',\n        'ltr': '<svg width=\"24\" height=\"24\"><path d=\"M11 5h7a1 1 0 0 1 0 2h-1v11a1 1 0 0 1-2 0V7h-2v11a1 1 0 0 1-2 0v-6c-.5 0-1 0-1.4-.3A3.4 3.4 0 0 1 7.8 10a3.3 3.3 0 0 1 0-2.8 3.4 3.4 0 0 1 1.8-1.8L11 5zM4.4 16.2L6.2 15l-1.8-1.2a1 1 0 0 1 1.2-1.6l3 2a1 1 0 0 1 0 1.6l-3 2a1 1 0 1 1-1.2-1.6z\" fill-rule=\"evenodd\"/></svg>',\n        'more-drawer': '<svg width=\"24\" height=\"24\"><path d=\"M6 10a2 2 0 0 0-2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2 2 2 0 0 0-2-2zm12 0a2 2 0 0 0-2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2 2 2 0 0 0-2-2zm-6 0a2 2 0 0 0-2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2 2 2 0 0 0-2-2z\" fill-rule=\"nonzero\"/></svg>',\n        'new-document': '<svg width=\"24\" height=\"24\"><path d=\"M14.4 3H7a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h10a2 2 0 0 0 2-2V7.6L14.4 3zM17 19H7V5h6v4h4v10z\" fill-rule=\"nonzero\"/></svg>',\n        'new-tab': '<svg width=\"24\" height=\"24\"><path d=\"M15 13l2-2v8H5V7h8l-2 2H7v8h8v-4zm4-8v5.5l-2-2-5.6 5.5H10v-1.4L15.5 7l-2-2H19z\" fill-rule=\"evenodd\"/></svg>',\n        'non-breaking': '<svg width=\"24\" height=\"24\"><path d=\"M11 11H8a1 1 0 1 1 0-2h3V6c0-.6.4-1 1-1s1 .4 1 1v3h3c.6 0 1 .4 1 1s-.4 1-1 1h-3v3c0 .6-.4 1-1 1a1 1 0 0 1-1-1v-3zm10 4v5H3v-5c0-.6.4-1 1-1s1 .4 1 1v3h14v-3c0-.6.4-1 1-1s1 .4 1 1z\" fill-rule=\"evenodd\"/></svg>',\n        'notice': '<svg width=\"24\" height=\"24\"><path d=\"M17.8 9.8L15.4 4 20 8.5v7L15.5 20h-7L4 15.5v-7L8.5 4h7l2.3 5.8zm0 0l2.2 5.7-2.3-5.8zM13 17v-2h-2v2h2zm0-4V7h-2v6h2z\" fill-rule=\"evenodd\"/></svg>',\n        'ordered-list-rtl': '<svg width=\"24\" height=\"24\"><path d=\"M6 17h8a1 1 0 0 1 0 2H6a1 1 0 0 1 0-2zm0-6h8a1 1 0 0 1 0 2H6a1 1 0 0 1 0-2zm0-6h8a1 1 0 0 1 0 2H6a1 1 0 1 1 0-2zm13-1v3.5a.5.5 0 1 1-1 0V5h-.5a.5.5 0 1 1 0-1H19zm-1 8.8l.2.2h1.3a.5.5 0 1 1 0 1h-1.6a1 1 0 0 1-.9-1V13c0-.4.3-.8.6-1l1.2-.4.2-.3a.2.2 0 0 0-.2-.2h-1.3a.5.5 0 0 1-.5-.5c0-.3.2-.5.5-.5h1.6c.5 0 .9.4.9 1v.1c0 .4-.3.8-.6 1l-1.2.4-.2.3zm2 4.2v2c0 .6-.4 1-1 1h-1.5a.5.5 0 0 1 0-1h1.2a.3.3 0 1 0 0-.6h-1.3a.4.4 0 1 1 0-.8h1.3a.3.3 0 0 0 0-.6h-1.2a.5.5 0 1 1 0-1H19c.6 0 1 .4 1 1z\" fill-rule=\"evenodd\"/></svg>',\n        'ordered-list': '<svg width=\"24\" height=\"24\"><path d=\"M10 17h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zm0-6h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zm0-6h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 1 1 0-2zM6 4v3.5c0 .3-.2.5-.5.5a.5.5 0 0 1-.5-.5V5h-.5a.5.5 0 0 1 0-1H6zm-1 8.8l.2.2h1.3c.3 0 .5.2.5.5s-.2.5-.5.5H4.9a1 1 0 0 1-.9-1V13c0-.4.3-.8.6-1l1.2-.4.2-.3a.2.2 0 0 0-.2-.2H4.5a.5.5 0 0 1-.5-.5c0-.3.2-.5.5-.5h1.6c.5 0 .9.4.9 1v.1c0 .4-.3.8-.6 1l-1.2.4-.2.3zM7 17v2c0 .6-.4 1-1 1H4.5a.5.5 0 0 1 0-1h1.2c.2 0 .3-.1.3-.3 0-.2-.1-.3-.3-.3H4.4a.4.4 0 1 1 0-.8h1.3c.2 0 .3-.1.3-.3 0-.2-.1-.3-.3-.3H4.5a.5.5 0 1 1 0-1H6c.6 0 1 .4 1 1z\" fill-rule=\"evenodd\"/></svg>',\n        'orientation': '<svg width=\"24\" height=\"24\"><path d=\"M7.3 6.4L1 13l6.4 6.5 6.5-6.5-6.5-6.5zM3.7 13l3.6-3.7L11 13l-3.7 3.7-3.6-3.7zM12 6l2.8 2.7c.3.3.3.8 0 1-.3.4-.9.4-1.2 0L9.2 5.7a.8.8 0 0 1 0-1.2L13.6.2c.3-.3.9-.3 1.2 0 .3.3.3.8 0 1.1L12 4h1a9 9 0 1 1-4.3 16.9l1.5-1.5A7 7 0 1 0 13 6h-1z\" fill-rule=\"nonzero\"/></svg>',\n        'outdent': '<svg width=\"24\" height=\"24\"><path d=\"M7 5h12c.6 0 1 .4 1 1s-.4 1-1 1H7a1 1 0 1 1 0-2zm5 4h7c.6 0 1 .4 1 1s-.4 1-1 1h-7a1 1 0 0 1 0-2zm0 4h7c.6 0 1 .4 1 1s-.4 1-1 1h-7a1 1 0 0 1 0-2zm-5 4h12a1 1 0 0 1 0 2H7a1 1 0 0 1 0-2zm1.6-3.8a1 1 0 0 1-1.2 1.6l-3-2a1 1 0 0 1 0-1.6l3-2a1 1 0 0 1 1.2 1.6L6.8 12l1.8 1.2z\" fill-rule=\"evenodd\"/></svg>',\n        'page-break': '<svg width=\"24\" height=\"24\"><g fill-rule=\"evenodd\"><path d=\"M5 11c.6 0 1 .4 1 1s-.4 1-1 1a1 1 0 0 1 0-2zm3 0h1c.6 0 1 .4 1 1s-.4 1-1 1H8a1 1 0 0 1 0-2zm4 0c.6 0 1 .4 1 1s-.4 1-1 1a1 1 0 0 1 0-2zm3 0h1c.6 0 1 .4 1 1s-.4 1-1 1h-1a1 1 0 0 1 0-2zm4 0c.6 0 1 .4 1 1s-.4 1-1 1a1 1 0 0 1 0-2zM7 3v5h10V3c0-.6.4-1 1-1s1 .4 1 1v7H5V3c0-.6.4-1 1-1s1 .4 1 1zM6 22a1 1 0 0 1-1-1v-7h14v7c0 .6-.4 1-1 1a1 1 0 0 1-1-1v-5H7v5c0 .6-.4 1-1 1z\"/></g></svg>',\n        'paragraph': '<svg width=\"24\" height=\"24\"><path fill-rule=\"evenodd\" d=\"M10 5h7a1 1 0 0 1 0 2h-1v11a1 1 0 0 1-2 0V7h-2v11a1 1 0 0 1-2 0v-6c-.5 0-1 0-1.4-.3A3.4 3.4 0 0 1 6.8 10a3.3 3.3 0 0 1 0-2.8 3.4 3.4 0 0 1 1.8-1.8L10 5z\"/></svg>',\n        'paste-text': '<svg width=\"24\" height=\"24\"><path d=\"M18 9V5h-2v1c0 .6-.4 1-1 1H9a1 1 0 0 1-1-1V5H6v13h3V9h9zM9 20H6a2 2 0 0 1-2-2V5c0-1.1.9-2 2-2h3.2A3 3 0 0 1 12 1a3 3 0 0 1 2.8 2H18a2 2 0 0 1 2 2v4h1v12H9v-1zm1.5-9.5v9h9v-9h-9zM12 3a1 1 0 0 0-1 1c0 .5.4 1 1 1s1-.5 1-1-.4-1-1-1zm0 9h6v2h-.5l-.5-1h-1v4h.8v1h-3.6v-1h.8v-4h-1l-.5 1H12v-2z\" fill-rule=\"nonzero\"/></svg>',\n        'paste': '<svg width=\"24\" height=\"24\"><path d=\"M18 9V5h-2v1c0 .6-.4 1-1 1H9a1 1 0 0 1-1-1V5H6v13h3V9h9zM9 20H6a2 2 0 0 1-2-2V5c0-1.1.9-2 2-2h3.2A3 3 0 0 1 12 1a3 3 0 0 1 2.8 2H18a2 2 0 0 1 2 2v4h1v12H9v-1zm1.5-9.5v9h9v-9h-9zM12 3a1 1 0 0 0-1 1c0 .5.4 1 1 1s1-.5 1-1-.4-1-1-1z\" fill-rule=\"nonzero\"/></svg>',\n        'permanent-pen': '<svg width=\"24\" height=\"24\"><path d=\"M10.5 17.5L8 20H3v-3l3.5-3.5a2 2 0 0 1 0-3L14 3l1 1-7.3 7.3a1 1 0 0 0 0 1.4l3.6 3.6c.4.4 1 .4 1.4 0L20 9l1 1-7.6 7.6a2 2 0 0 1-2.8 0l-.1-.1z\" fill-rule=\"nonzero\"/></svg>',\n        'plus': '<svg width=\"24\" height=\"24\"><path d=\"M12 4c.5 0 1 .4 1 .9V11h6a1 1 0 0 1 .1 2H13v6a1 1 0 0 1-2 .1V13H5a1 1 0 0 1-.1-2H11V5c0-.6.4-1 1-1z\"/></svg>',\n        'preferences': '<svg width=\"24\" height=\"24\"><path d=\"M20.1 13.5l-1.9.2a5.8 5.8 0 0 1-.6 1.5l1.2 1.5c.4.4.3 1 0 1.4l-.7.7a1 1 0 0 1-1.4 0l-1.5-1.2a6.2 6.2 0 0 1-1.5.6l-.2 1.9c0 .5-.5.9-1 .9h-1a1 1 0 0 1-1-.9l-.2-1.9a5.8 5.8 0 0 1-1.5-.6l-1.5 1.2a1 1 0 0 1-1.4 0l-.7-.7a1 1 0 0 1 0-1.4l1.2-1.5a6.2 6.2 0 0 1-.6-1.5l-1.9-.2a1 1 0 0 1-.9-1v-1c0-.5.4-1 .9-1l1.9-.2a5.8 5.8 0 0 1 .6-1.5L5.2 7.3a1 1 0 0 1 0-1.4l.7-.7a1 1 0 0 1 1.4 0l1.5 1.2a6.2 6.2 0 0 1 1.5-.6l.2-1.9c0-.5.5-.9 1-.9h1c.5 0 1 .4 1 .9l.2 1.9a5.8 5.8 0 0 1 1.5.6l1.5-1.2a1 1 0 0 1 1.4 0l.7.7c.3.4.4 1 0 1.4l-1.2 1.5a6.2 6.2 0 0 1 .6 1.5l1.9.2c.5 0 .9.5.9 1v1c0 .5-.4 1-.9 1zM12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6z\" fill-rule=\"evenodd\"/></svg>',\n        'preview': '<svg width=\"24\" height=\"24\"><path d=\"M3.5 12.5c.5.8 1.1 1.6 1.8 2.3 2 2 4.2 3.2 6.7 3.2s4.7-1.2 6.7-3.2a16.2 16.2 0 0 0 2.1-2.8 15.7 15.7 0 0 0-2.1-2.8c-2-2-4.2-3.2-6.7-3.2a9.3 9.3 0 0 0-6.7 3.2A16.2 16.2 0 0 0 3.2 12c0 .2.2.3.3.5zm-2.4-1l.7-1.2L4 7.8C6.2 5.4 8.9 4 12 4c3 0 5.8 1.4 8.1 3.8a18.2 18.2 0 0 1 2.8 3.7v1l-.7 1.2-2.1 2.5c-2.3 2.4-5 3.8-8.1 3.8-3 0-5.8-1.4-8.1-3.8a18.2 18.2 0 0 1-2.8-3.7 1 1 0 0 1 0-1zm12-3.3a2 2 0 1 0 2.7 2.6 4 4 0 1 1-2.6-2.6z\" fill-rule=\"nonzero\"/></svg>',\n        'print': '<svg width=\"24\" height=\"24\"><path d=\"M18 8H6a3 3 0 0 0-3 3v6h2v3h14v-3h2v-6a3 3 0 0 0-3-3zm-1 10H7v-4h10v4zm.5-5c-.8 0-1.5-.7-1.5-1.5s.7-1.5 1.5-1.5 1.5.7 1.5 1.5-.7 1.5-1.5 1.5zm.5-8H6v2h12V5z\" fill-rule=\"nonzero\"/></svg>',\n        'quote': '<svg width=\"24\" height=\"24\"><path d=\"M7.5 17h.9c.4 0 .7-.2.9-.6L11 13V8c0-.6-.4-1-1-1H6a1 1 0 0 0-1 1v4c0 .6.4 1 1 1h2l-1.3 2.7a1 1 0 0 0 .8 1.3zm8 0h.9c.4 0 .7-.2.9-.6L19 13V8c0-.6-.4-1-1-1h-4a1 1 0 0 0-1 1v4c0 .6.4 1 1 1h2l-1.3 2.7a1 1 0 0 0 .8 1.3z\" fill-rule=\"nonzero\"/></svg>',\n        'redo': '<svg width=\"24\" height=\"24\"><path d=\"M17.6 10H12c-2.8 0-4.4 1.4-4.9 3.5-.4 2 .3 4 1.4 4.6a1 1 0 1 1-1 1.8c-2-1.2-2.9-4.1-2.3-6.8.6-3 3-5.1 6.8-5.1h5.6l-3.3-3.3a1 1 0 1 1 1.4-1.4l5 5a1 1 0 0 1 0 1.4l-5 5a1 1 0 0 1-1.4-1.4l3.3-3.3z\" fill-rule=\"nonzero\"/></svg>',\n        'reload': '<svg width=\"24\" height=\"24\"><g fill-rule=\"nonzero\"><path d=\"M5 22.1l-1.2-4.7v-.2a1 1 0 0 1 1-1l5 .4a1 1 0 1 1-.2 2l-2.2-.2a7.8 7.8 0 0 0 8.4.2 7.5 7.5 0 0 0 3.5-6.4 1 1 0 1 1 2 0 9.5 9.5 0 0 1-4.5 8 9.9 9.9 0 0 1-10.2 0l.4 1.4a1 1 0 1 1-2 .5zM13.6 7.4c0-.5.5-1 1-.9l2.8.2a8 8 0 0 0-9.5-1 7.5 7.5 0 0 0-3.6 7 1 1 0 0 1-2 0 9.5 9.5 0 0 1 4.5-8.6 10 10 0 0 1 10.9.3l-.3-1a1 1 0 0 1 2-.5l1.1 4.8a1 1 0 0 1-1 1.2l-5-.4a1 1 0 0 1-.9-1z\"/></g></svg>',\n        'remove-formatting': '<svg width=\"24\" height=\"24\"><path d=\"M13.2 6a1 1 0 0 1 0 .2l-2.6 10a1 1 0 0 1-1 .8h-.2a.8.8 0 0 1-.8-1l2.6-10H8a1 1 0 1 1 0-2h9a1 1 0 0 1 0 2h-3.8zM5 18h7a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2zm13 1.5L16.5 18 15 19.5a.7.7 0 0 1-1-1l1.5-1.5-1.5-1.5a.7.7 0 0 1 1-1l1.5 1.5 1.5-1.5a.7.7 0 0 1 1 1L17.5 17l1.5 1.5a.7.7 0 0 1-1 1z\" fill-rule=\"evenodd\"/></svg>',\n        'remove': '<svg width=\"24\" height=\"24\"><path d=\"M16 7h3a1 1 0 0 1 0 2h-1v9a3 3 0 0 1-3 3H9a3 3 0 0 1-3-3V9H5a1 1 0 1 1 0-2h3V6a3 3 0 0 1 3-3h2a3 3 0 0 1 3 3v1zm-2 0V6c0-.6-.4-1-1-1h-2a1 1 0 0 0-1 1v1h4zm2 2H8v9c0 .6.4 1 1 1h6c.6 0 1-.4 1-1V9zm-7 3a1 1 0 0 1 2 0v4a1 1 0 0 1-2 0v-4zm4 0a1 1 0 0 1 2 0v4a1 1 0 0 1-2 0v-4z\" fill-rule=\"nonzero\"/></svg>',\n        'resize-handle': '<svg width=\"10\" height=\"10\"><g fill-rule=\"nonzero\"><path d=\"M8.1 1.1A.5.5 0 1 1 9 2l-7 7A.5.5 0 1 1 1 8l7-7zM8.1 5.1A.5.5 0 1 1 9 6l-3 3A.5.5 0 1 1 5 8l3-3z\"/></g></svg>',\n        'resize': '<svg width=\"24\" height=\"24\"><path d=\"M4 5c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3h6c.3 0 .5.1.7.3.2.2.3.4.3.7 0 .3-.1.5-.3.7a1 1 0 0 1-.7.3H7.4L18 16.6V13c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3.3 0 .5.1.7.3.2.2.3.4.3.7v6c0 .3-.1.5-.3.7a1 1 0 0 1-.7.3h-6a1 1 0 0 1-.7-.3 1 1 0 0 1-.3-.7c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3h3.6L6 7.4V11c0 .3-.1.5-.3.7a1 1 0 0 1-.7.3 1 1 0 0 1-.7-.3A1 1 0 0 1 4 11V5z\" fill-rule=\"evenodd\"/></svg>',\n        'restore-draft': '<svg width=\"24\" height=\"24\"><g fill-rule=\"evenodd\"><path d=\"M17 13c0 .6-.4 1-1 1h-4V8c0-.6.4-1 1-1s1 .4 1 1v4h2c.6 0 1 .4 1 1z\"/><path d=\"M4.7 10H9a1 1 0 0 1 0 2H3a1 1 0 0 1-1-1V5a1 1 0 1 1 2 0v3l2.5-2.4a9.2 9.2 0 0 1 10.8-1.5A9 9 0 0 1 13.4 21c-2.4.1-4.7-.7-6.5-2.2a1 1 0 1 1 1.3-1.5 7.2 7.2 0 0 0 11.6-3.7 7 7 0 0 0-3.5-7.7A7.2 7.2 0 0 0 8 7L4.7 10z\" fill-rule=\"nonzero\"/></g></svg>',\n        'rotate-left': '<svg width=\"24\" height=\"24\"><path d=\"M4.7 10H9a1 1 0 0 1 0 2H3a1 1 0 0 1-1-1V5a1 1 0 1 1 2 0v3l2.5-2.4a9.2 9.2 0 0 1 10.8-1.5A9 9 0 0 1 13.4 21c-2.4.1-4.7-.7-6.5-2.2a1 1 0 1 1 1.3-1.5 7.2 7.2 0 0 0 11.6-3.7 7 7 0 0 0-3.5-7.7A7.2 7.2 0 0 0 8 7L4.7 10z\" fill-rule=\"nonzero\"/></svg>',\n        'rotate-right': '<svg width=\"24\" height=\"24\"><path d=\"M20 8V5a1 1 0 0 1 2 0v6c0 .6-.4 1-1 1h-6a1 1 0 0 1 0-2h4.3L16 7A7.2 7.2 0 0 0 7.7 6a7 7 0 0 0 3 13.1c1.9.1 3.7-.5 5-1.7a1 1 0 0 1 1.4 1.5A9.2 9.2 0 0 1 2.2 14c-.9-3.9 1-8 4.5-9.9 3.5-1.9 8-1.3 10.8 1.5L20 8z\" fill-rule=\"nonzero\"/></svg>',\n        'rtl': '<svg width=\"24\" height=\"24\"><path d=\"M8 5h8v2h-2v12h-2V7h-2v12H8v-7c-.5 0-1 0-1.4-.3A3.4 3.4 0 0 1 4.8 10a3.3 3.3 0 0 1 0-2.8 3.4 3.4 0 0 1 1.8-1.8L8 5zm12 11.2a1 1 0 1 1-1 1.6l-3-2a1 1 0 0 1 0-1.6l3-2a1 1 0 1 1 1 1.6L18.4 15l1.8 1.2z\" fill-rule=\"evenodd\"/></svg>',\n        'save': '<svg width=\"24\" height=\"24\"><path d=\"M5 16h14a2 2 0 0 1 2 2v2a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-2c0-1.1.9-2 2-2zm0 2v2h14v-2H5zm10 0h2v2h-2v-2zm-4-6.4L8.7 9.3a1 1 0 1 0-1.4 1.4l4 4c.4.4 1 .4 1.4 0l4-4a1 1 0 1 0-1.4-1.4L13 11.6V4a1 1 0 0 0-2 0v7.6z\" fill-rule=\"nonzero\"/></svg>',\n        'search': '<svg width=\"24\" height=\"24\"><path d=\"M16 17.3a8 8 0 1 1 1.4-1.4l4.3 4.4a1 1 0 0 1-1.4 1.4l-4.4-4.3zm-5-.3a6 6 0 1 0 0-12 6 6 0 0 0 0 12z\" fill-rule=\"nonzero\"/></svg>',\n        'select-all': '<svg width=\"24\" height=\"24\"><path d=\"M3 5h2V3a2 2 0 0 0-2 2zm0 8h2v-2H3v2zm4 8h2v-2H7v2zM3 9h2V7H3v2zm10-6h-2v2h2V3zm6 0v2h2a2 2 0 0 0-2-2zM5 21v-2H3c0 1.1.9 2 2 2zm-2-4h2v-2H3v2zM9 3H7v2h2V3zm2 18h2v-2h-2v2zm8-8h2v-2h-2v2zm0 8a2 2 0 0 0 2-2h-2v2zm0-12h2V7h-2v2zm0 8h2v-2h-2v2zm-4 4h2v-2h-2v2zm0-16h2V3h-2v2zM7 17h10V7H7v10zm2-8h6v6H9V9z\" fill-rule=\"nonzero\"/></svg>',\n        'selected': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M6 4h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2zm3.6 10.9L7 12.3a.7.7 0 0 0-1 1L9.6 17 18 8.6a.7.7 0 0 0 0-1 .7.7 0 0 0-1 0l-7.4 7.3z\"/></svg>',\n        'settings': '<svg width=\"24\" height=\"24\"><path d=\"M11 6h8c.6 0 1 .4 1 1s-.4 1-1 1h-8v.3c0 .2 0 .3-.2.5l-.6.2H7.8c-.3 0-.4 0-.6-.2a.7.7 0 0 1-.2-.6V8H5a1 1 0 1 1 0-2h2v-.3c0-.2 0-.3.2-.5l.5-.2h2.5c.3 0 .4 0 .6.2l.2.5V6zM8 8h2V6H8v2zm9 2.8v.2h2c.6 0 1 .4 1 1s-.4 1-1 1h-2v.3c0 .2 0 .3-.2.5l-.6.2h-2.4c-.3 0-.4 0-.6-.2a.7.7 0 0 1-.2-.6V13H5a1 1 0 0 1 0-2h8v-.3c0-.2 0-.3.2-.5l.6-.2h2.4c.3 0 .4 0 .6.2l.2.6zM14 13h2v-2h-2v2zm-3 2.8v.2h8c.6 0 1 .4 1 1s-.4 1-1 1h-8v.3c0 .2 0 .3-.2.5l-.6.2H7.8c-.3 0-.4 0-.6-.2a.7.7 0 0 1-.2-.6V18H5a1 1 0 0 1 0-2h2v-.3c0-.2 0-.3.2-.5l.5-.2h2.5c.3 0 .4 0 .6.2l.2.6zM8 18h2v-2H8v2z\" fill-rule=\"evenodd\"/></svg>',\n        'sharpen': '<svg width=\"24\" height=\"24\"><path d=\"M16 6l4 4-8 9-8-9 4-4h8zm-4 10.2l5.5-6.2-.1-.1H12v-.3h5.1l-.2-.2H12V9h4.6l-.2-.2H12v-.3h4.1l-.2-.2H12V8h3.6l-.2-.2H8.7L6.5 10l.1.1H12v.3H6.9l.2.2H12v.3H7.3l.2.2H12v.3H7.7l.3.2h4v.3H8.2l.2.2H12v.3H8.6l.3.2H12v.3H9l.3.2H12v.3H9.5l.2.2H12v.3h-2l.2.2H12v.3h-1.6l.2.2H12v.3h-1.1l.2.2h.9v.3h-.7l.2.2h.5v.3h-.3l.3.2z\" fill-rule=\"evenodd\"/></svg>',\n        'sort-asc': '<svg width=\"24\" height=\"24\"><g fill-rule=\"evenodd\"><path d=\"M4 8h5a1 1 0 1 1 0 2H4a1 1 0 1 1 0-2zm0 8h8a1 1 0 0 1 0 2H4a1 1 0 0 1 0-2zm0-4h7a1 1 0 0 1 0 2H4a1 1 0 0 1 0-2z\"/><path fill-rule=\"nonzero\" d=\"M16 8.4l-2.3 2.3a1 1 0 0 1-1.4-1.4l4-4a1 1 0 0 1 1.4 0l4 4a1 1 0 1 1-1.4 1.4L18 8.4V18a1 1 0 0 1-2 0V8.4z\"/></g></svg>',\n        'sort-dsc': '<svg width=\"24\" height=\"24\"><g fill-rule=\"evenodd\"><path d=\"M4 16h5a1 1 0 0 0 0-2H4a1 1 0 0 0 0 2zm0-8h8a1 1 0 0 0 0-2H4a1 1 0 1 0 0 2zm0 4h7a1 1 0 0 0 0-2H4a1 1 0 0 0 0 2z\"/><path fill-rule=\"nonzero\" d=\"M16 15.6l-2.3-2.3a1 1 0 0 0-1.4 1.4l4 4c.4.4 1 .4 1.4 0l4-4a1 1 0 0 0-1.4-1.4L18 15.6V6a1 1 0 0 0-2 0v9.6z\"/></g></svg>',\n        'sourcecode': '<svg width=\"24\" height=\"24\"><g fill-rule=\"nonzero\"><path d=\"M9.8 15.7c.3.3.3.8 0 1-.3.4-.9.4-1.2 0l-4.4-4.1a.8.8 0 0 1 0-1.2l4.4-4.2c.3-.3.9-.3 1.2 0 .3.3.3.8 0 1.1L6 12l3.8 3.7zM14.2 15.7c-.3.3-.3.8 0 1 .4.4.9.4 1.2 0l4.4-4.1c.3-.3.3-.9 0-1.2l-4.4-4.2a.8.8 0 0 0-1.2 0c-.3.3-.3.8 0 1.1L18 12l-3.8 3.7z\"/></g></svg>',\n        'spell-check': '<svg width=\"24\" height=\"24\"><path d=\"M6 8v3H5V5c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3h2c.3 0 .5.1.7.3.2.2.3.4.3.7v6H8V8H6zm0-3v2h2V5H6zm13 0h-3v5h3v1h-3a1 1 0 0 1-.7-.3 1 1 0 0 1-.3-.7V5c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3h3v1zm-5 1.5l-.1.7c-.1.2-.3.3-.6.3.3 0 .5.1.6.3l.1.7V10c0 .3-.1.5-.3.7a1 1 0 0 1-.7.3h-3V4h3c.3 0 .5.1.7.3.2.2.3.4.3.7v1.5zM13 10V8h-2v2h2zm0-3V5h-2v2h2zm3 5l1 1-6.5 7L7 15.5l1.3-1 2.2 2.2L16 12z\" fill-rule=\"evenodd\"/></svg>',\n        'strike-through': '<svg width=\"24\" height=\"24\"><g fill-rule=\"evenodd\"><path d=\"M15.6 8.5c-.5-.7-1-1.1-1.3-1.3-.6-.4-1.3-.6-2-.6-2.7 0-2.8 1.7-2.8 2.1 0 1.6 1.8 2 3.2 2.3 4.4.9 4.6 2.8 4.6 3.9 0 1.4-.7 4.1-5 4.1A6.2 6.2 0 0 1 7 16.4l1.5-1.1c.4.6 1.6 2 3.7 2 1.6 0 2.5-.4 3-1.2.4-.8.3-2-.8-2.6-.7-.4-1.6-.7-2.9-1-1-.2-3.9-.8-3.9-3.6C7.6 6 10.3 5 12.4 5c2.9 0 4.2 1.6 4.7 2.4l-1.5 1.1z\"/><path d=\"M5 11h14a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2z\" fill-rule=\"nonzero\"/></g></svg>',\n        'subscript': '<svg width=\"24\" height=\"24\"><path d=\"M10.4 10l4.6 4.6-1.4 1.4L9 11.4 4.4 16 3 14.6 7.6 10 3 5.4 4.4 4 9 8.6 13.6 4 15 5.4 10.4 10zM21 19h-5v-1l1-.8 1.7-1.6c.3-.4.5-.8.5-1.2 0-.3 0-.6-.2-.7-.2-.2-.5-.3-.9-.3a2 2 0 0 0-.8.2l-.7.3-.4-1.1 1-.6 1.2-.2c.8 0 1.4.3 1.8.7.4.4.6.9.6 1.5s-.2 1.1-.5 1.6a8 8 0 0 1-1.3 1.3l-.6.6h2.6V19z\" fill-rule=\"nonzero\"/></svg>',\n        'superscript': '<svg width=\"24\" height=\"24\"><path d=\"M15 9.4L10.4 14l4.6 4.6-1.4 1.4L9 15.4 4.4 20 3 18.6 7.6 14 3 9.4 4.4 8 9 12.6 13.6 8 15 9.4zm5.9 1.6h-5v-1l1-.8 1.7-1.6c.3-.5.5-.9.5-1.3 0-.3 0-.5-.2-.7-.2-.2-.5-.3-.9-.3l-.8.2-.7.4-.4-1.2c.2-.2.5-.4 1-.5.3-.2.8-.2 1.2-.2.8 0 1.4.2 1.8.6.4.4.6 1 .6 1.6 0 .5-.2 1-.5 1.5l-1.3 1.4-.6.5h2.6V11z\" fill-rule=\"nonzero\"/></svg>',\n        'table-cell-properties': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zm-8 9H5v5h6v-5zm8 0h-6v5h6v-5zm-8-7H5v5h6V6z\"/></svg>',\n        'table-cell-select-all': '<svg width=\"24\" height=\"24\"><g fill-rule=\"evenodd\"><path fill-rule=\"nonzero\" d=\"M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zm0 2H5v12h14V6z\"/><path d=\"M13 6v5h6v2h-6v5h-2v-5H5v-2h6V6h2z\" opacity=\".2\"/></g></svg>',\n        'table-cell-select-inner': '<svg width=\"24\" height=\"24\"><g fill-rule=\"evenodd\"><path fill-rule=\"nonzero\" d=\"M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zm0 2H5v12h14V6z\" opacity=\".2\"/><path d=\"M13 6v5h6v2h-6v5h-2v-5H5v-2h6V6h2z\"/></g></svg>',\n        'table-delete-column': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zm-4 4h-2V6h-2v2H9V6H5v12h4v-2h2v2h2v-2h2v2h4V6h-4v2zm.3.5l1 1.2-3 2.3 3 2.3-1 1.2L12 13l-3.3 2.6-1-1.2 3-2.3-3-2.3 1-1.2L12 11l3.3-2.5z\"/></svg>',\n        'table-delete-row': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zm0 2H5v3h2.5v2H5v2h2.5v2H5v3h14v-3h-2.5v-2H19v-2h-2.5V9H19V6zm-4.7 1.8l1.2 1L13 12l2.6 3.3-1.2 1-2.3-3-2.3 3-1.2-1L11 12 8.5 8.7l1.2-1 2.3 3 2.3-3z\"/></svg>',\n        'table-delete-table': '<svg width=\"24\" height=\"24\"><g fill-rule=\"nonzero\"><path d=\"M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zM5 6v12h14V6H5z\"/><path d=\"M14.4 8.6l1 1-2.3 2.4 2.3 2.4-1 1-2.4-2.3-2.4 2.3-1-1 2.3-2.4-2.3-2.4 1-1 2.4 2.3z\"/></g></svg>',\n        'table-insert-column-after': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M20 4c.6 0 1 .4 1 1v2a1 1 0 0 1-2 0V6h-8v12h8v-1a1 1 0 0 1 2 0v2c0 .5-.4 1-.9 1H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h15zM9 13H5v5h4v-5zm7-5c.5 0 1 .4 1 .9V11h2a1 1 0 0 1 .1 2H17v2a1 1 0 0 1-2 .1V13h-2a1 1 0 0 1-.1-2H15V9c0-.6.4-1 1-1zM9 6H5v5h4V6z\"/></svg>',\n        'table-insert-column-before': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a1 1 0 0 1-1-1v-2a1 1 0 0 1 2 0v1h8V6H5v1a1 1 0 1 1-2 0V5c0-.6.4-1 1-1h15zm0 9h-4v5h4v-5zM8 8c.5 0 1 .4 1 .9V11h2a1 1 0 0 1 .1 2H9v2a1 1 0 0 1-2 .1V13H5a1 1 0 0 1-.1-2H7V9c0-.6.4-1 1-1zm11-2h-4v5h4V6z\"/></svg>',\n        'table-insert-row-above': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M6 4a1 1 0 1 1 0 2H5v6h14V6h-1a1 1 0 0 1 0-2h2c.6 0 1 .4 1 1v13a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5c0-.6.4-1 1-1h2zm5 10H5v4h6v-4zm8 0h-6v4h6v-4zM12 3c.5 0 1 .4 1 .9V6h2a1 1 0 0 1 0 2h-2v2a1 1 0 0 1-2 .1V8H9a1 1 0 0 1 0-2h2V4c0-.6.4-1 1-1z\"/></svg>',\n        'table-insert-row-after': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M12 13c.5 0 1 .4 1 .9V16h2a1 1 0 0 1 .1 2H13v2a1 1 0 0 1-2 .1V18H9a1 1 0 0 1-.1-2H11v-2c0-.6.4-1 1-1zm6 7a1 1 0 0 1 0-2h1v-6H5v6h1a1 1 0 0 1 0 2H4a1 1 0 0 1-1-1V6c0-1.1.9-2 2-2h14a2 2 0 0 1 2 2v13c0 .5-.4 1-.9 1H18zM11 6H5v4h6V6zm8 0h-6v4h6V6z\"/></svg>',\n        'table-left-header': '<svg width=\"24\" height=\"24\"><path d=\"M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zm0 9h-4v5h4v-5zm-6 0H9v5h4v-5zm0-7H9v5h4V6zm6 0h-4v5h4V6z\"/></svg>',\n        'table-merge-cells': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zM5 15.5V18h3v-2.5H5zm14-5h-9V18h9v-7.5zM19 6h-4v2.5h4V6zM8 6H5v2.5h3V6zm5 0h-3v2.5h3V6zm-8 7.5h3v-3H5v3z\"/></svg>',\n        'table-row-properties': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zM5 15v3h6v-3H5zm14 0h-6v3h6v-3zm0-9h-6v3h6V6zM5 9h6V6H5v3z\"/></svg>',\n        'table-split-cells': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zM8 15.5H5V18h3v-2.5zm11-5h-9V18h9v-7.5zm-2.5 1l1 1-2 2 2 2-1 1-2-2-2 2-1-1 2-2-2-2 1-1 2 2 2-2zm-8.5-1H5v3h3v-3zM19 6h-4v2.5h4V6zM8 6H5v2.5h3V6zm5 0h-3v2.5h3V6z\"/></svg>',\n        'table-top-header': '<svg width=\"24\" height=\"24\"><path d=\"M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zm-8 11H5v3h6v-3zm8 0h-6v3h6v-3zm0-5h-6v3h6v-3zM5 13h6v-3H5v3z\"/></svg>',\n        'table': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zM5 14v4h6v-4H5zm14 0h-6v4h6v-4zm0-6h-6v4h6V8zM5 12h6V8H5v4z\"/></svg>',\n        'template': '<svg width=\"24\" height=\"24\"><path d=\"M19 19v-1H5v1h14zM9 16v-4a5 5 0 1 1 6 0v4h4a2 2 0 0 1 2 2v3H3v-3c0-1.1.9-2 2-2h4zm4 0v-5l.8-.6a3 3 0 1 0-3.6 0l.8.6v5h2z\" fill-rule=\"nonzero\"/></svg>',\n        'temporary-placeholder': '<svg width=\"24\" height=\"24\"><g fill-rule=\"evenodd\"><path d=\"M9 7.6V6h2.5V4.5a.5.5 0 1 1 1 0V6H15v1.6a8 8 0 1 1-6 0zm-2.6 5.3a.5.5 0 0 0 .3.6c.3 0 .6 0 .6-.3l.1-.2a5 5 0 0 1 3.3-2.8c.3-.1.4-.4.4-.6-.1-.3-.4-.5-.6-.4a6 6 0 0 0-4.1 3.7z\"/><circle cx=\"14\" cy=\"4\" r=\"1\"/><circle cx=\"12\" cy=\"2\" r=\"1\"/><circle cx=\"10\" cy=\"4\" r=\"1\"/></g></svg>',\n        'text-color': '<svg width=\"24\" height=\"24\"><g fill-rule=\"evenodd\"><path id=\"tox-icon-text-color__color\" d=\"M3 18h18v3H3z\"/><path d=\"M8.7 16h-.8a.5.5 0 0 1-.5-.6l2.7-9c.1-.3.3-.4.5-.4h2.8c.2 0 .4.1.5.4l2.7 9a.5.5 0 0 1-.5.6h-.8a.5.5 0 0 1-.4-.4l-.7-2.2c0-.3-.3-.4-.5-.4h-3.4c-.2 0-.4.1-.5.4l-.7 2.2c0 .3-.2.4-.4.4zm2.6-7.6l-.6 2a.5.5 0 0 0 .5.6h1.6a.5.5 0 0 0 .5-.6l-.6-2c0-.3-.3-.4-.5-.4h-.4c-.2 0-.4.1-.5.4z\"/></g></svg>',\n        'toc': '<svg width=\"24\" height=\"24\"><path d=\"M5 5c.6 0 1 .4 1 1s-.4 1-1 1a1 1 0 1 1 0-2zm3 0h11c.6 0 1 .4 1 1s-.4 1-1 1H8a1 1 0 1 1 0-2zm-3 8c.6 0 1 .4 1 1s-.4 1-1 1a1 1 0 0 1 0-2zm3 0h11c.6 0 1 .4 1 1s-.4 1-1 1H8a1 1 0 0 1 0-2zm0-4c.6 0 1 .4 1 1s-.4 1-1 1a1 1 0 1 1 0-2zm3 0h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zm-3 8c.6 0 1 .4 1 1s-.4 1-1 1a1 1 0 0 1 0-2zm3 0h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2z\" fill-rule=\"evenodd\"/></svg>',\n        'translate': '<svg width=\"24\" height=\"24\"><path d=\"M12.7 14.3l-.3.7-.4.7-2.2-2.2-3.1 3c-.3.4-.8.4-1 0a.7.7 0 0 1 0-1l3.1-3A12.4 12.4 0 0 1 6.7 9H8a10.1 10.1 0 0 0 1.7 2.4c.5-.5 1-1.1 1.4-1.8l.9-2H4.7a.7.7 0 1 1 0-1.5h4.4v-.7c0-.4.3-.8.7-.8.4 0 .7.4.7.8v.7H15c.4 0 .8.3.8.7 0 .4-.4.8-.8.8h-1.4a12.3 12.3 0 0 1-1 2.4 13.5 13.5 0 0 1-1.7 2.3l1.9 1.8zm4.3-3l2.7 7.3a.5.5 0 0 1-.4.7 1 1 0 0 1-1-.7l-.6-1.5h-3.4l-.6 1.5a1 1 0 0 1-1 .7.5.5 0 0 1-.4-.7l2.7-7.4a1 1 0 1 1 2 0zm-2.2 4.4h2.4L16 12.5l-1.2 3.2z\" fill-rule=\"evenodd\"/></svg>',\n        'underline': '<svg width=\"24\" height=\"24\"><path d=\"M16 5c.6 0 1 .4 1 1v5.5a4 4 0 0 1-.4 1.8l-1 1.4a5.3 5.3 0 0 1-5.5 1 5 5 0 0 1-1.6-1c-.5-.4-.8-.9-1.1-1.4a4 4 0 0 1-.4-1.8V6c0-.6.4-1 1-1s1 .4 1 1v5.5c0 .3 0 .6.2 1l.6.7a3.3 3.3 0 0 0 2.2.8 3.4 3.4 0 0 0 2.2-.8c.3-.2.4-.5.6-.8l.2-.9V6c0-.6.4-1 1-1zM8 17h8c.6 0 1 .4 1 1s-.4 1-1 1H8a1 1 0 0 1 0-2z\" fill-rule=\"evenodd\"/></svg>',\n        'undo': '<svg width=\"24\" height=\"24\"><path d=\"M6.4 8H12c3.7 0 6.2 2 6.8 5.1.6 2.7-.4 5.6-2.3 6.8a1 1 0 0 1-1-1.8c1.1-.6 1.8-2.7 1.4-4.6-.5-2.1-2.1-3.5-4.9-3.5H6.4l3.3 3.3a1 1 0 1 1-1.4 1.4l-5-5a1 1 0 0 1 0-1.4l5-5a1 1 0 0 1 1.4 1.4L6.4 8z\" fill-rule=\"nonzero\"/></svg>',\n        'unlink': '<svg width=\"24\" height=\"24\"><path d=\"M6.2 12.3a1 1 0 0 1 1.4 1.4l-2 2a2 2 0 1 0 2.6 2.8l4.8-4.8a1 1 0 0 0 0-1.4 1 1 0 1 1 1.4-1.3 2.9 2.9 0 0 1 0 4L9.6 20a3.9 3.9 0 0 1-5.5-5.5l2-2zm11.6-.6a1 1 0 0 1-1.4-1.4l2.1-2a2 2 0 1 0-2.7-2.8L11 10.3a1 1 0 0 0 0 1.4A1 1 0 1 1 9.6 13a2.9 2.9 0 0 1 0-4L14.4 4a3.9 3.9 0 0 1 5.5 5.5l-2 2zM7.6 6.3a.8.8 0 0 1-1 1.1L3.3 4.2a.7.7 0 1 1 1-1l3.2 3.1zM5.1 8.6a.8.8 0 0 1 0 1.5H3a.8.8 0 0 1 0-1.5H5zm5-3.5a.8.8 0 0 1-1.5 0V3a.8.8 0 0 1 1.5 0V5zm6 11.8a.8.8 0 0 1 1-1l3.2 3.2a.8.8 0 0 1-1 1L16 17zm-2.2 2a.8.8 0 0 1 1.5 0V21a.8.8 0 0 1-1.5 0V19zm5-3.5a.7.7 0 1 1 0-1.5H21a.8.8 0 0 1 0 1.5H19z\" fill-rule=\"nonzero\"/></svg>',\n        'unlock': '<svg width=\"24\" height=\"24\"><path d=\"M16 5c.8 0 1.5.3 2.1.9.6.6.9 1.3.9 2.1v3h-2V8a1 1 0 0 0-.3-.7A1 1 0 0 0 16 7h-2a1 1 0 0 0-.7.3 1 1 0 0 0-.3.7v3h.3c.2 0 .3 0 .5.2l.2.6v7.4c0 .3 0 .4-.2.6l-.6.2H4.8c-.3 0-.4 0-.6-.2a.7.7 0 0 1-.2-.6v-7.4c0-.3 0-.4.2-.6l.5-.2H11V8c0-.8.3-1.5.9-2.1.6-.6 1.3-.9 2.1-.9h2z\" fill-rule=\"evenodd\"/></svg>',\n        'unordered-list': '<svg width=\"24\" height=\"24\"><path d=\"M11 5h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zm0 6h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zm0 6h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zM4.5 6c0-.4.1-.8.4-1 .3-.4.7-.5 1.1-.5.4 0 .8.1 1 .4.4.3.5.7.5 1.1 0 .4-.1.8-.4 1-.3.4-.7.5-1.1.5-.4 0-.8-.1-1-.4-.4-.3-.5-.7-.5-1.1zm0 6c0-.4.1-.8.4-1 .3-.4.7-.5 1.1-.5.4 0 .8.1 1 .4.4.3.5.7.5 1.1 0 .4-.1.8-.4 1-.3.4-.7.5-1.1.5-.4 0-.8-.1-1-.4-.4-.3-.5-.7-.5-1.1zm0 6c0-.4.1-.8.4-1 .3-.4.7-.5 1.1-.5.4 0 .8.1 1 .4.4.3.5.7.5 1.1 0 .4-.1.8-.4 1-.3.4-.7.5-1.1.5-.4 0-.8-.1-1-.4-.4-.3-.5-.7-.5-1.1z\" fill-rule=\"evenodd\"/></svg>',\n        'unselected': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M6 4h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2zm0 1a1 1 0 0 0-1 1v12c0 .6.4 1 1 1h12c.6 0 1-.4 1-1V6c0-.6-.4-1-1-1H6z\"/></svg>',\n        'upload': '<svg width=\"24\" height=\"24\"><path d=\"M18 19v-2a1 1 0 0 1 2 0v3c0 .6-.4 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 2 0v2h12zM11 6.4L8.7 8.7a1 1 0 0 1-1.4-1.4l4-4a1 1 0 0 1 1.4 0l4 4a1 1 0 1 1-1.4 1.4L13 6.4V16a1 1 0 0 1-2 0V6.4z\" fill-rule=\"nonzero\"/></svg>',\n        'user': '<svg width=\"24\" height=\"24\"><path d=\"M12 24a12 12 0 1 1 0-24 12 12 0 0 1 0 24zm-8.7-5.3a11 11 0 0 0 17.4 0C19.4 16.3 14.6 15 12 15c-2.6 0-7.4 1.3-8.7 3.7zM12 13c2.2 0 4-2 4-4.5S14.2 4 12 4 8 6 8 8.5 9.8 13 12 13z\" fill-rule=\"nonzero\"/></svg>',\n        'visualblocks': '<svg width=\"24\" height=\"24\"><path d=\"M9 19v2H7v-2h2zm-4 0v2a2 2 0 0 1-2-2h2zm8 0v2h-2v-2h2zm8 0a2 2 0 0 1-2 2v-2h2zm-4 0v2h-2v-2h2zM15 7a1 1 0 0 1 0 2v7a1 1 0 0 1-2 0V9h-1v7a1 1 0 0 1-2 0v-4a2.5 2.5 0 0 1-.2-5H15zM5 15v2H3v-2h2zm16 0v2h-2v-2h2zM5 11v2H3v-2h2zm16 0v2h-2v-2h2zM5 7v2H3V7h2zm16 0v2h-2V7h2zM5 3v2H3c0-1.1.9-2 2-2zm8 0v2h-2V3h2zm6 0a2 2 0 0 1 2 2h-2V3zM9 3v2H7V3h2zm8 0v2h-2V3h2z\" fill-rule=\"evenodd\"/></svg>',\n        'visualchars': '<svg width=\"24\" height=\"24\"><path d=\"M10 5h7a1 1 0 0 1 0 2h-1v11a1 1 0 0 1-2 0V7h-2v11a1 1 0 0 1-2 0v-6c-.5 0-1 0-1.4-.3A3.4 3.4 0 0 1 6.8 10a3.3 3.3 0 0 1 0-2.8 3.4 3.4 0 0 1 1.8-1.8L10 5z\" fill-rule=\"evenodd\"/></svg>',\n        'warning': '<svg width=\"24\" height=\"24\"><path d=\"M19.8 18.3c.2.5.3.9 0 1.2-.1.3-.5.5-1 .5H5.2c-.5 0-.9-.2-1-.5-.3-.3-.2-.7 0-1.2L11 4.7l.5-.5.5-.2c.2 0 .3 0 .5.2.2 0 .3.3.5.5l6.8 13.6zM12 18c.3 0 .5-.1.7-.3.2-.2.3-.4.3-.7a1 1 0 0 0-.3-.7 1 1 0 0 0-.7-.3 1 1 0 0 0-.7.3 1 1 0 0 0-.3.7c0 .3.1.5.3.7.2.2.4.3.7.3zm.7-3l.3-4a1 1 0 0 0-.3-.7 1 1 0 0 0-.7-.3 1 1 0 0 0-.7.3 1 1 0 0 0-.3.7l.3 4h1.4z\" fill-rule=\"evenodd\"/></svg>',\n        'zoom-in': '<svg width=\"24\" height=\"24\"><path d=\"M16 17.3a8 8 0 1 1 1.4-1.4l4.3 4.4a1 1 0 0 1-1.4 1.4l-4.4-4.3zm-5-.3a6 6 0 1 0 0-12 6 6 0 0 0 0 12zm-1-9a1 1 0 0 1 2 0v6a1 1 0 0 1-2 0V8zm-2 4a1 1 0 0 1 0-2h6a1 1 0 0 1 0 2H8z\" fill-rule=\"nonzero\"/></svg>',\n        'zoom-out': '<svg width=\"24\" height=\"24\"><path d=\"M16 17.3a8 8 0 1 1 1.4-1.4l4.3 4.4a1 1 0 0 1-1.4 1.4l-4.4-4.3zm-5-.3a6 6 0 1 0 0-12 6 6 0 0 0 0 12zm-3-5a1 1 0 0 1 0-2h6a1 1 0 0 1 0 2H8z\" fill-rule=\"nonzero\"/></svg>'\n      };\n    };\n\n    var isContentCssSkinName = function (url) {\n      return /^[a-z0-9\\-]+$/i.test(url);\n    };\n    var getContentCssUrls = function (editor) {\n      var contentCss = Settings.getContentCss(editor);\n      var skinUrl = editor.editorManager.baseURL + '/skins/content';\n      var suffix = editor.editorManager.suffix;\n      var contentCssFile = 'content' + suffix + '.css';\n      var inline = editor.inline === true;\n      return map(contentCss, function (url) {\n        if (isContentCssSkinName(url) && !inline) {\n          return skinUrl + '/' + url + '/' + contentCssFile;\n        } else {\n          return editor.documentBaseURI.toAbsolute(url);\n        }\n      });\n    };\n    var appendContentCssFromSettings = function (editor) {\n      editor.contentCSS = editor.contentCSS.concat(getContentCssUrls(editor));\n    };\n\n    function BookmarkManager(selection) {\n      return {\n        getBookmark: curry(Bookmarks.getBookmark, selection),\n        moveToBookmark: curry(Bookmarks.moveToBookmark, selection)\n      };\n    }\n    (function (BookmarkManager) {\n      BookmarkManager.isBookmarkNode = Bookmarks.isBookmarkNode;\n    }(BookmarkManager || (BookmarkManager = {})));\n    var BookmarkManager$1 = BookmarkManager;\n\n    var isXYWithinRange = function (clientX, clientY, range) {\n      if (range.collapsed) {\n        return false;\n      }\n      if (Env.browser.isIE() && range.startOffset === range.endOffset - 1 && range.startContainer === range.endContainer) {\n        var elm = range.startContainer.childNodes[range.startOffset];\n        if (NodeType.isElement(elm)) {\n          return exists(elm.getClientRects(), function (rect) {\n            return containsXY(rect, clientX, clientY);\n          });\n        }\n      }\n      return exists(range.getClientRects(), function (rect) {\n        return containsXY(rect, clientX, clientY);\n      });\n    };\n    var RangePoint = { isXYWithinRange: isXYWithinRange };\n\n    var VK = {\n      BACKSPACE: 8,\n      DELETE: 46,\n      DOWN: 40,\n      ENTER: 13,\n      LEFT: 37,\n      RIGHT: 39,\n      SPACEBAR: 32,\n      TAB: 9,\n      UP: 38,\n      END: 35,\n      HOME: 36,\n      modifierPressed: function (e) {\n        return e.shiftKey || e.ctrlKey || e.altKey || this.metaKeyPressed(e);\n      },\n      metaKeyPressed: function (e) {\n        return Env.mac ? e.metaKey : e.ctrlKey && !e.altKey;\n      }\n    };\n\n    var isContentEditableFalse$6 = NodeType.isContentEditableFalse;\n    var isContentEditableTrue$2 = NodeType.isContentEditableTrue;\n    var getContentEditableRoot = function (root, node) {\n      while (node && node !== root) {\n        if (isContentEditableTrue$2(node) || isContentEditableFalse$6(node)) {\n          return node;\n        }\n        node = node.parentNode;\n      }\n      return null;\n    };\n    var ControlSelection = function (selection, editor) {\n      var dom = editor.dom, each = Tools.each;\n      var selectedElm, selectedElmGhost, resizeHelper, resizeHandles, selectedHandle;\n      var startX, startY, selectedElmX, selectedElmY, startW, startH, ratio, resizeStarted;\n      var width, height;\n      var editableDoc = editor.getDoc(), rootDocument = domGlobals.document;\n      var abs = Math.abs, round = Math.round, rootElement = editor.getBody();\n      var startScrollWidth, startScrollHeight;\n      resizeHandles = {\n        nw: [\n          0,\n          0,\n          -1,\n          -1\n        ],\n        ne: [\n          1,\n          0,\n          1,\n          -1\n        ],\n        se: [\n          1,\n          1,\n          1,\n          1\n        ],\n        sw: [\n          0,\n          1,\n          -1,\n          1\n        ]\n      };\n      var isImage = function (elm) {\n        return elm && (elm.nodeName === 'IMG' || editor.dom.is(elm, 'figure.image'));\n      };\n      var isEventOnImageOutsideRange = function (evt, range) {\n        if (evt.type === 'longpress' || evt.type.indexOf('touch') === 0) {\n          var touch = evt.touches[0];\n          return isImage(evt.target) && !RangePoint.isXYWithinRange(touch.clientX, touch.clientY, range);\n        } else {\n          return isImage(evt.target) && !RangePoint.isXYWithinRange(evt.clientX, evt.clientY, range);\n        }\n      };\n      var contextMenuSelectImage = function (evt) {\n        var target = evt.target;\n        if (isEventOnImageOutsideRange(evt, editor.selection.getRng()) && !evt.isDefaultPrevented()) {\n          editor.selection.select(target);\n        }\n      };\n      var getResizeTarget = function (elm) {\n        return editor.dom.is(elm, 'figure.image') ? elm.querySelector('img') : elm;\n      };\n      var isResizable = function (elm) {\n        var selector = Settings.getObjectResizing(editor);\n        if (selector === false || Env.iOS) {\n          return false;\n        }\n        if (typeof selector !== 'string') {\n          selector = 'table,img,figure.image,div';\n        }\n        if (elm.getAttribute('data-mce-resize') === 'false') {\n          return false;\n        }\n        if (elm === editor.getBody()) {\n          return false;\n        }\n        return is(Element.fromDom(elm), selector);\n      };\n      var resizeGhostElement = function (e) {\n        var deltaX, deltaY, proportional;\n        var resizeHelperX, resizeHelperY;\n        deltaX = e.screenX - startX;\n        deltaY = e.screenY - startY;\n        width = deltaX * selectedHandle[2] + startW;\n        height = deltaY * selectedHandle[3] + startH;\n        width = width < 5 ? 5 : width;\n        height = height < 5 ? 5 : height;\n        if (isImage(selectedElm) && Settings.getResizeImgProportional(editor) !== false) {\n          proportional = !VK.modifierPressed(e);\n        } else {\n          proportional = VK.modifierPressed(e);\n        }\n        if (proportional) {\n          if (abs(deltaX) > abs(deltaY)) {\n            height = round(width * ratio);\n            width = round(height / ratio);\n          } else {\n            width = round(height / ratio);\n            height = round(width * ratio);\n          }\n        }\n        dom.setStyles(getResizeTarget(selectedElmGhost), {\n          width: width,\n          height: height\n        });\n        resizeHelperX = selectedHandle.startPos.x + deltaX;\n        resizeHelperY = selectedHandle.startPos.y + deltaY;\n        resizeHelperX = resizeHelperX > 0 ? resizeHelperX : 0;\n        resizeHelperY = resizeHelperY > 0 ? resizeHelperY : 0;\n        dom.setStyles(resizeHelper, {\n          left: resizeHelperX,\n          top: resizeHelperY,\n          display: 'block'\n        });\n        resizeHelper.innerHTML = width + ' &times; ' + height;\n        if (selectedHandle[2] < 0 && selectedElmGhost.clientWidth <= width) {\n          dom.setStyle(selectedElmGhost, 'left', selectedElmX + (startW - width));\n        }\n        if (selectedHandle[3] < 0 && selectedElmGhost.clientHeight <= height) {\n          dom.setStyle(selectedElmGhost, 'top', selectedElmY + (startH - height));\n        }\n        deltaX = rootElement.scrollWidth - startScrollWidth;\n        deltaY = rootElement.scrollHeight - startScrollHeight;\n        if (deltaX + deltaY !== 0) {\n          dom.setStyles(resizeHelper, {\n            left: resizeHelperX - deltaX,\n            top: resizeHelperY - deltaY\n          });\n        }\n        if (!resizeStarted) {\n          fireObjectResizeStart(editor, selectedElm, startW, startH);\n          resizeStarted = true;\n        }\n      };\n      var endGhostResize = function () {\n        resizeStarted = false;\n        var setSizeProp = function (name, value) {\n          if (value) {\n            if (selectedElm.style[name] || !editor.schema.isValid(selectedElm.nodeName.toLowerCase(), name)) {\n              dom.setStyle(getResizeTarget(selectedElm), name, value);\n            } else {\n              dom.setAttrib(getResizeTarget(selectedElm), name, value);\n            }\n          }\n        };\n        setSizeProp('width', width);\n        setSizeProp('height', height);\n        dom.unbind(editableDoc, 'mousemove', resizeGhostElement);\n        dom.unbind(editableDoc, 'mouseup', endGhostResize);\n        if (rootDocument !== editableDoc) {\n          dom.unbind(rootDocument, 'mousemove', resizeGhostElement);\n          dom.unbind(rootDocument, 'mouseup', endGhostResize);\n        }\n        dom.remove(selectedElmGhost);\n        dom.remove(resizeHelper);\n        showResizeRect(selectedElm);\n        fireObjectResized(editor, selectedElm, width, height);\n        dom.setAttrib(selectedElm, 'style', dom.getAttrib(selectedElm, 'style'));\n        editor.nodeChanged();\n      };\n      var showResizeRect = function (targetElm) {\n        var position, targetWidth, targetHeight, e, rect;\n        hideResizeRect();\n        unbindResizeHandleEvents();\n        position = dom.getPos(targetElm, rootElement);\n        selectedElmX = position.x;\n        selectedElmY = position.y;\n        rect = targetElm.getBoundingClientRect();\n        targetWidth = rect.width || rect.right - rect.left;\n        targetHeight = rect.height || rect.bottom - rect.top;\n        if (selectedElm !== targetElm) {\n          selectedElm = targetElm;\n          width = height = 0;\n        }\n        e = editor.fire('ObjectSelected', { target: targetElm });\n        if (isResizable(targetElm) && !e.isDefaultPrevented()) {\n          each(resizeHandles, function (handle, name) {\n            var handleElm;\n            var startDrag = function (e) {\n              startX = e.screenX;\n              startY = e.screenY;\n              startW = getResizeTarget(selectedElm).clientWidth;\n              startH = getResizeTarget(selectedElm).clientHeight;\n              ratio = startH / startW;\n              selectedHandle = handle;\n              handle.startPos = {\n                x: targetWidth * handle[0] + selectedElmX,\n                y: targetHeight * handle[1] + selectedElmY\n              };\n              startScrollWidth = rootElement.scrollWidth;\n              startScrollHeight = rootElement.scrollHeight;\n              selectedElmGhost = selectedElm.cloneNode(true);\n              dom.addClass(selectedElmGhost, 'mce-clonedresizable');\n              dom.setAttrib(selectedElmGhost, 'data-mce-bogus', 'all');\n              selectedElmGhost.contentEditable = false;\n              selectedElmGhost.unSelectabe = true;\n              dom.setStyles(selectedElmGhost, {\n                left: selectedElmX,\n                top: selectedElmY,\n                margin: 0\n              });\n              selectedElmGhost.removeAttribute('data-mce-selected');\n              rootElement.appendChild(selectedElmGhost);\n              dom.bind(editableDoc, 'mousemove', resizeGhostElement);\n              dom.bind(editableDoc, 'mouseup', endGhostResize);\n              if (rootDocument !== editableDoc) {\n                dom.bind(rootDocument, 'mousemove', resizeGhostElement);\n                dom.bind(rootDocument, 'mouseup', endGhostResize);\n              }\n              resizeHelper = dom.add(rootElement, 'div', {\n                'class': 'mce-resize-helper',\n                'data-mce-bogus': 'all'\n              }, startW + ' &times; ' + startH);\n            };\n            handleElm = dom.get('mceResizeHandle' + name);\n            if (handleElm) {\n              dom.remove(handleElm);\n            }\n            handleElm = dom.add(rootElement, 'div', {\n              'id': 'mceResizeHandle' + name,\n              'data-mce-bogus': 'all',\n              'class': 'mce-resizehandle',\n              'unselectable': true,\n              'style': 'cursor:' + name + '-resize; margin:0; padding:0'\n            });\n            if (Env.ie === 11) {\n              handleElm.contentEditable = false;\n            }\n            dom.bind(handleElm, 'mousedown', function (e) {\n              e.stopImmediatePropagation();\n              e.preventDefault();\n              startDrag(e);\n            });\n            handle.elm = handleElm;\n            dom.setStyles(handleElm, {\n              left: targetWidth * handle[0] + selectedElmX - handleElm.offsetWidth / 2,\n              top: targetHeight * handle[1] + selectedElmY - handleElm.offsetHeight / 2\n            });\n          });\n        } else {\n          hideResizeRect();\n        }\n        selectedElm.setAttribute('data-mce-selected', '1');\n      };\n      var hideResizeRect = function () {\n        var name, handleElm;\n        unbindResizeHandleEvents();\n        if (selectedElm) {\n          selectedElm.removeAttribute('data-mce-selected');\n        }\n        for (name in resizeHandles) {\n          handleElm = dom.get('mceResizeHandle' + name);\n          if (handleElm) {\n            dom.unbind(handleElm);\n            dom.remove(handleElm);\n          }\n        }\n      };\n      var updateResizeRect = function (e) {\n        var startElm, controlElm;\n        var isChildOrEqual = function (node, parent) {\n          if (node) {\n            do {\n              if (node === parent) {\n                return true;\n              }\n            } while (node = node.parentNode);\n          }\n        };\n        if (resizeStarted || editor.removed) {\n          return;\n        }\n        each(dom.select('img[data-mce-selected],hr[data-mce-selected]'), function (img) {\n          img.removeAttribute('data-mce-selected');\n        });\n        controlElm = e.type === 'mousedown' ? e.target : selection.getNode();\n        controlElm = dom.$(controlElm).closest('table,img,figure.image,hr')[0];\n        if (isChildOrEqual(controlElm, rootElement)) {\n          disableGeckoResize();\n          startElm = selection.getStart(true);\n          if (isChildOrEqual(startElm, controlElm) && isChildOrEqual(selection.getEnd(true), controlElm)) {\n            showResizeRect(controlElm);\n            return;\n          }\n        }\n        hideResizeRect();\n      };\n      var isWithinContentEditableFalse = function (elm) {\n        return isContentEditableFalse$6(getContentEditableRoot(editor.getBody(), elm));\n      };\n      var unbindResizeHandleEvents = function () {\n        for (var name_1 in resizeHandles) {\n          var handle = resizeHandles[name_1];\n          if (handle.elm) {\n            dom.unbind(handle.elm);\n            delete handle.elm;\n          }\n        }\n      };\n      var disableGeckoResize = function () {\n        try {\n          editor.getDoc().execCommand('enableObjectResizing', false, false);\n        } catch (ex) {\n        }\n      };\n      editor.on('init', function () {\n        disableGeckoResize();\n        if (Env.browser.isIE() || Env.browser.isEdge()) {\n          editor.on('mousedown click', function (e) {\n            var target = e.target, nodeName = target.nodeName;\n            if (!resizeStarted && /^(TABLE|IMG|HR)$/.test(nodeName) && !isWithinContentEditableFalse(target)) {\n              if (e.button !== 2) {\n                editor.selection.select(target, nodeName === 'TABLE');\n              }\n              if (e.type === 'mousedown') {\n                editor.nodeChanged();\n              }\n            }\n          });\n          var handleMSControlSelect_1 = function (e) {\n            var delayedSelect = function (node) {\n              Delay.setEditorTimeout(editor, function () {\n                return editor.selection.select(node);\n              });\n            };\n            if (isWithinContentEditableFalse(e.target)) {\n              e.preventDefault();\n              delayedSelect(e.target);\n              return;\n            }\n            if (/^(TABLE|IMG|HR)$/.test(e.target.nodeName)) {\n              e.preventDefault();\n              if (e.target.tagName === 'IMG') {\n                delayedSelect(e.target);\n              }\n            }\n          };\n          dom.bind(rootElement, 'mscontrolselect', handleMSControlSelect_1);\n          editor.on('remove', function () {\n            return dom.unbind(rootElement, 'mscontrolselect', handleMSControlSelect_1);\n          });\n        }\n        var throttledUpdateResizeRect = Delay.throttle(function (e) {\n          if (!editor.composing) {\n            updateResizeRect(e);\n          }\n        });\n        editor.on('nodechange ResizeEditor ResizeWindow drop FullscreenStateChanged', throttledUpdateResizeRect);\n        editor.on('keyup compositionend', function (e) {\n          if (selectedElm && selectedElm.nodeName === 'TABLE') {\n            throttledUpdateResizeRect(e);\n          }\n        });\n        editor.on('hide blur', hideResizeRect);\n        editor.on('contextmenu longpress', contextMenuSelectImage, true);\n      });\n      editor.on('remove', unbindResizeHandleEvents);\n      var destroy = function () {\n        selectedElm = selectedElmGhost = null;\n      };\n      return {\n        isResizable: isResizable,\n        showResizeRect: showResizeRect,\n        hideResizeRect: hideResizeRect,\n        updateResizeRect: updateResizeRect,\n        destroy: destroy\n      };\n    };\n\n    function Dimension (name, getOffset) {\n      var set = function (element, h) {\n        if (!isNumber(h) && !h.match(/^[0-9]+$/)) {\n          throw new Error(name + '.set accepts only positive integer values. Value was ' + h);\n        }\n        var dom = element.dom();\n        if (isSupported(dom)) {\n          dom.style[name] = h + 'px';\n        }\n      };\n      var get = function (element) {\n        var r = getOffset(element);\n        if (r <= 0 || r === null) {\n          var css = get$4(element, name);\n          return parseFloat(css) || 0;\n        }\n        return r;\n      };\n      var getOuter = get;\n      var aggregate = function (element, properties) {\n        return foldl(properties, function (acc, property) {\n          var val = get$4(element, property);\n          var value = val === undefined ? 0 : parseInt(val, 10);\n          return isNaN(value) ? acc : acc + value;\n        }, 0);\n      };\n      var max = function (element, value, properties) {\n        var cumulativeInclusions = aggregate(element, properties);\n        var absoluteMax = value > cumulativeInclusions ? value - cumulativeInclusions : 0;\n        return absoluteMax;\n      };\n      return {\n        set: set,\n        get: get,\n        getOuter: getOuter,\n        aggregate: aggregate,\n        max: max\n      };\n    }\n\n    var api$1 = Dimension('height', function (element) {\n      var dom = element.dom();\n      return inBody(element) ? dom.getBoundingClientRect().height : dom.offsetHeight;\n    });\n    var get$8 = function (element) {\n      return api$1.get(element);\n    };\n\n    var walkUp = function (navigation, doc) {\n      var frame = navigation.view(doc);\n      return frame.fold(constant([]), function (f) {\n        var parent = navigation.owner(f);\n        var rest = walkUp(navigation, parent);\n        return [f].concat(rest);\n      });\n    };\n    var pathTo = function (element, navigation) {\n      var d = navigation.owner(element);\n      return walkUp(navigation, d);\n    };\n\n    var view = function (doc) {\n      var element = doc.dom() === domGlobals.document ? Option.none() : Option.from(doc.dom().defaultView.frameElement);\n      return element.map(Element.fromDom);\n    };\n    var owner$1 = function (element) {\n      return owner(element);\n    };\n\n    var Navigation = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        view: view,\n        owner: owner$1\n    });\n\n    var find$3 = function (element) {\n      var doc = Element.fromDom(domGlobals.document);\n      var scroll = get$1(doc);\n      var frames = pathTo(element, Navigation);\n      var offset = viewport(element);\n      var r = foldr(frames, function (b, a) {\n        var loc = viewport(a);\n        return {\n          left: b.left + loc.left(),\n          top: b.top + loc.top()\n        };\n      }, {\n        left: 0,\n        top: 0\n      });\n      return Position(r.left + offset.left() + scroll.left(), r.top + offset.top() + scroll.top());\n    };\n\n    var excludeFromDescend = function (element) {\n      return name(element) === 'textarea';\n    };\n    var fireScrollIntoViewEvent = function (editor, data) {\n      var scrollEvent = editor.fire('ScrollIntoView', data);\n      return scrollEvent.isDefaultPrevented();\n    };\n    var fireAfterScrollIntoViewEvent = function (editor, data) {\n      editor.fire('AfterScrollIntoView', data);\n    };\n    var descend = function (element, offset) {\n      var children$1 = children(element);\n      if (children$1.length === 0 || excludeFromDescend(element)) {\n        return {\n          element: element,\n          offset: offset\n        };\n      } else if (offset < children$1.length && !excludeFromDescend(children$1[offset])) {\n        return {\n          element: children$1[offset],\n          offset: 0\n        };\n      } else {\n        var last = children$1[children$1.length - 1];\n        if (excludeFromDescend(last)) {\n          return {\n            element: element,\n            offset: offset\n          };\n        } else {\n          if (name(last) === 'img') {\n            return {\n              element: last,\n              offset: 1\n            };\n          } else if (isText(last)) {\n            return {\n              element: last,\n              offset: get$7(last).length\n            };\n          } else {\n            return {\n              element: last,\n              offset: children(last).length\n            };\n          }\n        }\n      }\n    };\n    var markerInfo = function (element, cleanupFun) {\n      var pos = absolute(element);\n      var height = get$8(element);\n      return {\n        element: element,\n        bottom: pos.top() + height,\n        height: height,\n        pos: pos,\n        cleanup: cleanupFun\n      };\n    };\n    var createMarker = function (element, offset) {\n      var startPoint = descend(element, offset);\n      var span = Element.fromHtml('<span data-mce-bogus=\"all\">' + Zwsp.ZWSP + '</span>');\n      before(startPoint.element, span);\n      return markerInfo(span, function () {\n        return remove(span);\n      });\n    };\n    var elementMarker = function (element) {\n      return markerInfo(Element.fromDom(element), noop);\n    };\n    var withMarker = function (editor, f, rng, alignToTop) {\n      preserveWith(editor, function (_s, _e) {\n        return applyWithMarker(editor, f, rng, alignToTop);\n      }, rng);\n    };\n    var withScrollEvents = function (editor, doc, f, marker, alignToTop) {\n      var data = {\n        elm: marker.element.dom(),\n        alignToTop: alignToTop\n      };\n      if (fireScrollIntoViewEvent(editor, data)) {\n        return;\n      }\n      var scrollTop = get$1(doc).top();\n      f(doc, scrollTop, marker, alignToTop);\n      fireAfterScrollIntoViewEvent(editor, data);\n    };\n    var applyWithMarker = function (editor, f, rng, alignToTop) {\n      var body = Element.fromDom(editor.getBody());\n      var doc = Element.fromDom(editor.getDoc());\n      reflow(body);\n      var marker = createMarker(Element.fromDom(rng.startContainer), rng.startOffset);\n      withScrollEvents(editor, doc, f, marker, alignToTop);\n      marker.cleanup();\n    };\n    var withElement = function (editor, element, f, alignToTop) {\n      var doc = Element.fromDom(editor.getDoc());\n      withScrollEvents(editor, doc, f, elementMarker(element), alignToTop);\n    };\n    var preserveWith = function (editor, f, rng) {\n      var startElement = rng.startContainer;\n      var startOffset = rng.startOffset;\n      var endElement = rng.endContainer;\n      var endOffset = rng.endOffset;\n      f(Element.fromDom(startElement), Element.fromDom(endElement));\n      var newRng = editor.dom.createRng();\n      newRng.setStart(startElement, startOffset);\n      newRng.setEnd(endElement, endOffset);\n      editor.selection.setRng(rng);\n    };\n    var scrollToMarker = function (marker, viewHeight, alignToTop, doc) {\n      var pos = marker.pos;\n      if (alignToTop) {\n        to(pos.left(), pos.top(), doc);\n      } else {\n        var y = pos.top() - viewHeight + marker.height;\n        to(pos.left(), y, doc);\n      }\n    };\n    var intoWindowIfNeeded = function (doc, scrollTop, viewHeight, marker, alignToTop) {\n      var viewportBottom = viewHeight + scrollTop;\n      var markerTop = marker.pos.top();\n      var markerBottom = marker.bottom;\n      var largerThanViewport = markerBottom - markerTop >= viewHeight;\n      if (markerTop < scrollTop) {\n        scrollToMarker(marker, viewHeight, alignToTop !== false, doc);\n      } else if (markerTop > viewportBottom) {\n        var align = largerThanViewport ? alignToTop !== false : alignToTop === true;\n        scrollToMarker(marker, viewHeight, align, doc);\n      } else if (markerBottom > viewportBottom && !largerThanViewport) {\n        scrollToMarker(marker, viewHeight, alignToTop === true, doc);\n      }\n    };\n    var intoWindow = function (doc, scrollTop, marker, alignToTop) {\n      var viewHeight = doc.dom().defaultView.innerHeight;\n      intoWindowIfNeeded(doc, scrollTop, viewHeight, marker, alignToTop);\n    };\n    var intoFrame = function (doc, scrollTop, marker, alignToTop) {\n      var frameViewHeight = doc.dom().defaultView.innerHeight;\n      intoWindowIfNeeded(doc, scrollTop, frameViewHeight, marker, alignToTop);\n      var op = find$3(marker.element);\n      var viewportBounds = getBounds(domGlobals.window);\n      if (op.top() < viewportBounds.y()) {\n        intoView(marker.element, alignToTop !== false);\n      } else if (op.top() > viewportBounds.bottom()) {\n        intoView(marker.element, alignToTop === true);\n      }\n    };\n    var rangeIntoWindow = function (editor, rng, alignToTop) {\n      return withMarker(editor, intoWindow, rng, alignToTop);\n    };\n    var elementIntoWindow = function (editor, element, alignToTop) {\n      return withElement(editor, element, intoWindow, alignToTop);\n    };\n    var rangeIntoFrame = function (editor, rng, alignToTop) {\n      return withMarker(editor, intoFrame, rng, alignToTop);\n    };\n    var elementIntoFrame = function (editor, element, alignToTop) {\n      return withElement(editor, element, intoFrame, alignToTop);\n    };\n    var elementIntoView = function (editor, element, alignToTop) {\n      var scroller = editor.inline ? elementIntoWindow : elementIntoFrame;\n      scroller(editor, element, alignToTop);\n    };\n    var rangeIntoView = function (editor, rng, alignToTop) {\n      var scroller = editor.inline ? rangeIntoWindow : rangeIntoFrame;\n      scroller(editor, rng, alignToTop);\n    };\n    var ScrollIntoView = {\n      scrollElementIntoView: elementIntoView,\n      scrollRangeIntoView: rangeIntoView\n    };\n\n    var hasCeProperty = function (node) {\n      return NodeType.isContentEditableTrue(node) || NodeType.isContentEditableFalse(node);\n    };\n    var findParent = function (node, rootNode, predicate) {\n      while (node && node !== rootNode) {\n        if (predicate(node)) {\n          return node;\n        }\n        node = node.parentNode;\n      }\n      return null;\n    };\n    var findClosestIeRange = function (clientX, clientY, doc) {\n      var element, rng, rects;\n      element = doc.elementFromPoint(clientX, clientY);\n      rng = doc.body.createTextRange();\n      if (!element || element.tagName === 'HTML') {\n        element = doc.body;\n      }\n      rng.moveToElementText(element);\n      rects = Tools.toArray(rng.getClientRects());\n      rects = rects.sort(function (a, b) {\n        a = Math.abs(Math.max(a.top - clientY, a.bottom - clientY));\n        b = Math.abs(Math.max(b.top - clientY, b.bottom - clientY));\n        return a - b;\n      });\n      if (rects.length > 0) {\n        clientY = (rects[0].bottom + rects[0].top) / 2;\n        try {\n          rng.moveToPoint(clientX, clientY);\n          rng.collapse(true);\n          return rng;\n        } catch (ex) {\n        }\n      }\n      return null;\n    };\n    var moveOutOfContentEditableFalse = function (rng, rootNode) {\n      var parentElement = rng && rng.parentElement ? rng.parentElement() : null;\n      return NodeType.isContentEditableFalse(findParent(parentElement, rootNode, hasCeProperty)) ? null : rng;\n    };\n    var fromPoint$1 = function (clientX, clientY, doc) {\n      var rng, point;\n      var pointDoc = doc;\n      if (pointDoc.caretPositionFromPoint) {\n        point = pointDoc.caretPositionFromPoint(clientX, clientY);\n        if (point) {\n          rng = doc.createRange();\n          rng.setStart(point.offsetNode, point.offset);\n          rng.collapse(true);\n        }\n      } else if (doc.caretRangeFromPoint) {\n        rng = doc.caretRangeFromPoint(clientX, clientY);\n      } else if (pointDoc.body.createTextRange) {\n        rng = pointDoc.body.createTextRange();\n        try {\n          rng.moveToPoint(clientX, clientY);\n          rng.collapse(true);\n        } catch (ex) {\n          rng = findClosestIeRange(clientX, clientY, doc);\n        }\n        return moveOutOfContentEditableFalse(rng, doc.body);\n      }\n      return rng;\n    };\n    var CaretRangeFromPoint = { fromPoint: fromPoint$1 };\n\n    var processRanges = function (editor, ranges) {\n      return map(ranges, function (range) {\n        var evt = editor.fire('GetSelectionRange', { range: range });\n        return evt.range !== range ? evt.range : range;\n      });\n    };\n    var EventProcessRanges = { processRanges: processRanges };\n\n    var fromElements = function (elements, scope) {\n      var doc = scope || domGlobals.document;\n      var fragment = doc.createDocumentFragment();\n      each(elements, function (element) {\n        fragment.appendChild(element.dom());\n      });\n      return Element.fromDom(fragment);\n    };\n\n    var dropLast = function (xs) {\n      return xs.slice(0, -1);\n    };\n    var parentsUntil$1 = function (start, root, predicate) {\n      if (contains$2(root, start)) {\n        return dropLast(parents(start, function (elm) {\n          return predicate(elm) || eq(elm, root);\n        }));\n      } else {\n        return [];\n      }\n    };\n    var parents$1 = function (start, root) {\n      return parentsUntil$1(start, root, constant(false));\n    };\n    var parentsAndSelf = function (start, root) {\n      return [start].concat(parents$1(start, root));\n    };\n    var Parents = {\n      parentsUntil: parentsUntil$1,\n      parents: parents$1,\n      parentsAndSelf: parentsAndSelf\n    };\n\n    var getStartNode = function (rng) {\n      var sc = rng.startContainer, so = rng.startOffset;\n      if (NodeType.isText(sc)) {\n        return so === 0 ? Option.some(Element.fromDom(sc)) : Option.none();\n      } else {\n        return Option.from(sc.childNodes[so]).map(Element.fromDom);\n      }\n    };\n    var getEndNode = function (rng) {\n      var ec = rng.endContainer, eo = rng.endOffset;\n      if (NodeType.isText(ec)) {\n        return eo === ec.data.length ? Option.some(Element.fromDom(ec)) : Option.none();\n      } else {\n        return Option.from(ec.childNodes[eo - 1]).map(Element.fromDom);\n      }\n    };\n    var getFirstChildren = function (node) {\n      return firstChild(node).fold(constant([node]), function (child) {\n        return [node].concat(getFirstChildren(child));\n      });\n    };\n    var getLastChildren = function (node) {\n      return lastChild(node).fold(constant([node]), function (child) {\n        if (name(child) === 'br') {\n          return prevSibling(child).map(function (sibling) {\n            return [node].concat(getLastChildren(sibling));\n          }).getOr([]);\n        } else {\n          return [node].concat(getLastChildren(child));\n        }\n      });\n    };\n    var hasAllContentsSelected = function (elm, rng) {\n      return lift2(getStartNode(rng), getEndNode(rng), function (startNode, endNode) {\n        var start = find(getFirstChildren(elm), curry(eq, startNode));\n        var end = find(getLastChildren(elm), curry(eq, endNode));\n        return start.isSome() && end.isSome();\n      }).getOr(false);\n    };\n    var moveEndPoint$1 = function (dom, rng, node, start) {\n      var root = node, walker = new TreeWalker(node, root);\n      var nonEmptyElementsMap = dom.schema.getNonEmptyElements();\n      do {\n        if (node.nodeType === 3 && Tools.trim(node.nodeValue).length !== 0) {\n          if (start) {\n            rng.setStart(node, 0);\n          } else {\n            rng.setEnd(node, node.nodeValue.length);\n          }\n          return;\n        }\n        if (nonEmptyElementsMap[node.nodeName] && !/^(TD|TH)$/.test(node.nodeName)) {\n          if (start) {\n            rng.setStartBefore(node);\n          } else {\n            if (node.nodeName === 'BR') {\n              rng.setEndBefore(node);\n            } else {\n              rng.setEndAfter(node);\n            }\n          }\n          return;\n        }\n      } while (node = start ? walker.next() : walker.prev());\n      if (root.nodeName === 'BODY') {\n        if (start) {\n          rng.setStart(root, 0);\n        } else {\n          rng.setEnd(root, root.childNodes.length);\n        }\n      }\n    };\n    var hasAnyRanges = function (editor) {\n      var sel = editor.selection.getSel();\n      return sel && sel.rangeCount > 0;\n    };\n\n    var tableModel = Immutable('element', 'width', 'rows');\n    var tableRow = Immutable('element', 'cells');\n    var cellPosition = Immutable('x', 'y');\n    var getSpan = function (td, key) {\n      var value = parseInt(get$3(td, key), 10);\n      return isNaN(value) ? 1 : value;\n    };\n    var fillout = function (table, x, y, tr, td) {\n      var rowspan = getSpan(td, 'rowspan');\n      var colspan = getSpan(td, 'colspan');\n      var rows = table.rows();\n      for (var y2 = y; y2 < y + rowspan; y2++) {\n        if (!rows[y2]) {\n          rows[y2] = tableRow(deep(tr), []);\n        }\n        for (var x2 = x; x2 < x + colspan; x2++) {\n          var cells = rows[y2].cells();\n          cells[x2] = y2 === y && x2 === x ? td : shallow(td);\n        }\n      }\n    };\n    var cellExists = function (table, x, y) {\n      var rows = table.rows();\n      var cells = rows[y] ? rows[y].cells() : [];\n      return !!cells[x];\n    };\n    var skipCellsX = function (table, x, y) {\n      while (cellExists(table, x, y)) {\n        x++;\n      }\n      return x;\n    };\n    var getWidth = function (rows) {\n      return foldl(rows, function (acc, row) {\n        return row.cells().length > acc ? row.cells().length : acc;\n      }, 0);\n    };\n    var findElementPos = function (table, element) {\n      var rows = table.rows();\n      for (var y = 0; y < rows.length; y++) {\n        var cells = rows[y].cells();\n        for (var x = 0; x < cells.length; x++) {\n          if (eq(cells[x], element)) {\n            return Option.some(cellPosition(x, y));\n          }\n        }\n      }\n      return Option.none();\n    };\n    var extractRows = function (table, sx, sy, ex, ey) {\n      var newRows = [];\n      var rows = table.rows();\n      for (var y = sy; y <= ey; y++) {\n        var cells = rows[y].cells();\n        var slice = sx < ex ? cells.slice(sx, ex + 1) : cells.slice(ex, sx + 1);\n        newRows.push(tableRow(rows[y].element(), slice));\n      }\n      return newRows;\n    };\n    var subTable = function (table, startPos, endPos) {\n      var sx = startPos.x(), sy = startPos.y();\n      var ex = endPos.x(), ey = endPos.y();\n      var newRows = sy < ey ? extractRows(table, sx, sy, ex, ey) : extractRows(table, sx, ey, ex, sy);\n      return tableModel(table.element(), getWidth(newRows), newRows);\n    };\n    var createDomTable = function (table, rows) {\n      var tableElement = shallow(table.element());\n      var tableBody = Element.fromTag('tbody');\n      append$1(tableBody, rows);\n      append(tableElement, tableBody);\n      return tableElement;\n    };\n    var modelRowsToDomRows = function (table) {\n      return map(table.rows(), function (row) {\n        var cells = map(row.cells(), function (cell) {\n          var td = deep(cell);\n          remove$1(td, 'colspan');\n          remove$1(td, 'rowspan');\n          return td;\n        });\n        var tr = shallow(row.element());\n        append$1(tr, cells);\n        return tr;\n      });\n    };\n    var fromDom$1 = function (tableElm) {\n      var table = tableModel(shallow(tableElm), 0, []);\n      each(descendants$1(tableElm, 'tr'), function (tr, y) {\n        each(descendants$1(tr, 'td,th'), function (td, x) {\n          fillout(table, skipCellsX(table, x, y), y, tr, td);\n        });\n      });\n      return tableModel(table.element(), getWidth(table.rows()), table.rows());\n    };\n    var toDom = function (table) {\n      return createDomTable(table, modelRowsToDomRows(table));\n    };\n    var subsection = function (table, startElement, endElement) {\n      return findElementPos(table, startElement).bind(function (startPos) {\n        return findElementPos(table, endElement).map(function (endPos) {\n          return subTable(table, startPos, endPos);\n        });\n      });\n    };\n    var SimpleTableModel = {\n      fromDom: fromDom$1,\n      toDom: toDom,\n      subsection: subsection\n    };\n\n    var getRanges = function (selection) {\n      var ranges = [];\n      if (selection) {\n        for (var i = 0; i < selection.rangeCount; i++) {\n          ranges.push(selection.getRangeAt(i));\n        }\n      }\n      return ranges;\n    };\n    var getSelectedNodes = function (ranges) {\n      return bind(ranges, function (range) {\n        var node = getSelectedNode(range);\n        return node ? [Element.fromDom(node)] : [];\n      });\n    };\n    var hasMultipleRanges = function (selection) {\n      return getRanges(selection).length > 1;\n    };\n    var MultiRange = {\n      getRanges: getRanges,\n      getSelectedNodes: getSelectedNodes,\n      hasMultipleRanges: hasMultipleRanges\n    };\n\n    var getCellsFromRanges = function (ranges) {\n      return filter(MultiRange.getSelectedNodes(ranges), isTableCell);\n    };\n    var getCellsFromElement = function (elm) {\n      return descendants$1(elm, 'td[data-mce-selected],th[data-mce-selected]');\n    };\n    var getCellsFromElementOrRanges = function (ranges, element) {\n      var selectedCells = getCellsFromElement(element);\n      var rangeCells = getCellsFromRanges(ranges);\n      return selectedCells.length > 0 ? selectedCells : rangeCells;\n    };\n    var getCellsFromEditor = function (editor) {\n      return getCellsFromElementOrRanges(MultiRange.getRanges(editor.selection.getSel()), Element.fromDom(editor.getBody()));\n    };\n    var TableCellSelection = {\n      getCellsFromRanges: getCellsFromRanges,\n      getCellsFromElement: getCellsFromElement,\n      getCellsFromElementOrRanges: getCellsFromElementOrRanges,\n      getCellsFromEditor: getCellsFromEditor\n    };\n\n    var findParentListContainer = function (parents) {\n      return find(parents, function (elm) {\n        return name(elm) === 'ul' || name(elm) === 'ol';\n      });\n    };\n    var getFullySelectedListWrappers = function (parents, rng) {\n      return find(parents, function (elm) {\n        return name(elm) === 'li' && hasAllContentsSelected(elm, rng);\n      }).fold(constant([]), function (li) {\n        return findParentListContainer(parents).map(function (listCont) {\n          return [\n            Element.fromTag('li'),\n            Element.fromTag(name(listCont))\n          ];\n        }).getOr([]);\n      });\n    };\n    var wrap$2 = function (innerElm, elms) {\n      var wrapped = foldl(elms, function (acc, elm) {\n        append(elm, acc);\n        return elm;\n      }, innerElm);\n      return elms.length > 0 ? fromElements([wrapped]) : wrapped;\n    };\n    var directListWrappers = function (commonAnchorContainer) {\n      if (isListItem(commonAnchorContainer)) {\n        return parent(commonAnchorContainer).filter(isList).fold(constant([]), function (listElm) {\n          return [\n            commonAnchorContainer,\n            listElm\n          ];\n        });\n      } else {\n        return isList(commonAnchorContainer) ? [commonAnchorContainer] : [];\n      }\n    };\n    var getWrapElements = function (rootNode, rng) {\n      var commonAnchorContainer = Element.fromDom(rng.commonAncestorContainer);\n      var parents = Parents.parentsAndSelf(commonAnchorContainer, rootNode);\n      var wrapElements = filter(parents, function (elm) {\n        return isInline(elm) || isHeading(elm);\n      });\n      var listWrappers = getFullySelectedListWrappers(parents, rng);\n      var allWrappers = wrapElements.concat(listWrappers.length ? listWrappers : directListWrappers(commonAnchorContainer));\n      return map(allWrappers, shallow);\n    };\n    var emptyFragment = function () {\n      return fromElements([]);\n    };\n    var getFragmentFromRange = function (rootNode, rng) {\n      return wrap$2(Element.fromDom(rng.cloneContents()), getWrapElements(rootNode, rng));\n    };\n    var getParentTable = function (rootElm, cell) {\n      return ancestor$1(cell, 'table', curry(eq, rootElm));\n    };\n    var getTableFragment = function (rootNode, selectedTableCells) {\n      return getParentTable(rootNode, selectedTableCells[0]).bind(function (tableElm) {\n        var firstCell = selectedTableCells[0];\n        var lastCell = selectedTableCells[selectedTableCells.length - 1];\n        var fullTableModel = SimpleTableModel.fromDom(tableElm);\n        return SimpleTableModel.subsection(fullTableModel, firstCell, lastCell).map(function (sectionedTableModel) {\n          return fromElements([SimpleTableModel.toDom(sectionedTableModel)]);\n        });\n      }).getOrThunk(emptyFragment);\n    };\n    var getSelectionFragment = function (rootNode, ranges) {\n      return ranges.length > 0 && ranges[0].collapsed ? emptyFragment() : getFragmentFromRange(rootNode, ranges[0]);\n    };\n    var read$1 = function (rootNode, ranges) {\n      var selectedCells = TableCellSelection.getCellsFromElementOrRanges(ranges, rootNode);\n      return selectedCells.length > 0 ? getTableFragment(rootNode, selectedCells) : getSelectionFragment(rootNode, ranges);\n    };\n    var FragmentReader = { read: read$1 };\n\n    var getTextContent = function (editor) {\n      return Option.from(editor.selection.getRng()).map(function (rng) {\n        var bin = editor.dom.add(editor.getBody(), 'div', {\n          'data-mce-bogus': 'all',\n          'style': 'overflow: hidden; opacity: 0;'\n        }, rng.cloneContents());\n        var text = Zwsp.trim(bin.innerText);\n        editor.dom.remove(bin);\n        return text;\n      }).getOr('');\n    };\n    var getHtmlContent = function (editor, args) {\n      var rng = editor.selection.getRng(), tmpElm = editor.dom.create('body');\n      var sel = editor.selection.getSel();\n      var fragment;\n      var ranges = EventProcessRanges.processRanges(editor, MultiRange.getRanges(sel));\n      fragment = args.contextual ? FragmentReader.read(Element.fromDom(editor.getBody()), ranges).dom() : rng.cloneContents();\n      if (fragment) {\n        tmpElm.appendChild(fragment);\n      }\n      return editor.selection.serializer.serialize(tmpElm, args);\n    };\n    var getContent$1 = function (editor, args) {\n      if (args === void 0) {\n        args = {};\n      }\n      args.get = true;\n      args.format = args.format || 'html';\n      args.selection = true;\n      args = editor.fire('BeforeGetContent', args);\n      if (args.isDefaultPrevented()) {\n        editor.fire('GetContent', args);\n        return args.content;\n      }\n      if (args.format === 'text') {\n        return getTextContent(editor);\n      } else {\n        args.getInner = true;\n        var content = getHtmlContent(editor, args);\n        if (args.format === 'tree') {\n          return content;\n        } else {\n          args.content = editor.selection.isCollapsed() ? '' : content;\n          editor.fire('GetContent', args);\n          return args.content;\n        }\n      }\n    };\n    var GetSelectionContent = { getContent: getContent$1 };\n\n    var isEq$1 = function (rng1, rng2) {\n      return rng1 && rng2 && (rng1.startContainer === rng2.startContainer && rng1.startOffset === rng2.startOffset) && (rng1.endContainer === rng2.endContainer && rng1.endOffset === rng2.endOffset);\n    };\n    var RangeCompare = { isEq: isEq$1 };\n\n    var findParent$1 = function (node, rootNode, predicate) {\n      while (node && node !== rootNode) {\n        if (predicate(node)) {\n          return node;\n        }\n        node = node.parentNode;\n      }\n      return null;\n    };\n    var hasParent = function (node, rootNode, predicate) {\n      return findParent$1(node, rootNode, predicate) !== null;\n    };\n    var hasParentWithName = function (node, rootNode, name) {\n      return hasParent(node, rootNode, function (node) {\n        return node.nodeName === name;\n      });\n    };\n    var isTable$3 = function (node) {\n      return node && node.nodeName === 'TABLE';\n    };\n    var isTableCell$2 = function (node) {\n      return node && /^(TD|TH|CAPTION)$/.test(node.nodeName);\n    };\n    var isCeFalseCaretContainer = function (node, rootNode) {\n      return isCaretContainer(node) && hasParent(node, rootNode, isCaretNode) === false;\n    };\n    var hasBrBeforeAfter = function (dom, node, left) {\n      var walker = new TreeWalker(node, dom.getParent(node.parentNode, dom.isBlock) || dom.getRoot());\n      while (node = walker[left ? 'prev' : 'next']()) {\n        if (NodeType.isBr(node)) {\n          return true;\n        }\n      }\n    };\n    var isPrevNode = function (node, name) {\n      return node.previousSibling && node.previousSibling.nodeName === name;\n    };\n    var hasContentEditableFalseParent = function (body, node) {\n      while (node && node !== body) {\n        if (NodeType.isContentEditableFalse(node)) {\n          return true;\n        }\n        node = node.parentNode;\n      }\n      return false;\n    };\n    var findTextNodeRelative = function (dom, isAfterNode, collapsed, left, startNode) {\n      var lastInlineElement;\n      var body = dom.getRoot();\n      var node;\n      var nonEmptyElementsMap = dom.schema.getNonEmptyElements();\n      var parentBlockContainer = dom.getParent(startNode.parentNode, dom.isBlock) || body;\n      if (left && NodeType.isBr(startNode) && isAfterNode && dom.isEmpty(parentBlockContainer)) {\n        return Option.some(CaretPosition(startNode.parentNode, dom.nodeIndex(startNode)));\n      }\n      var walker = new TreeWalker(startNode, parentBlockContainer);\n      while (node = walker[left ? 'prev' : 'next']()) {\n        if (dom.getContentEditableParent(node) === 'false' || isCeFalseCaretContainer(node, body)) {\n          return Option.none();\n        }\n        if (NodeType.isText(node) && node.nodeValue.length > 0) {\n          if (hasParentWithName(node, body, 'A') === false) {\n            return Option.some(CaretPosition(node, left ? node.nodeValue.length : 0));\n          }\n          return Option.none();\n        }\n        if (dom.isBlock(node) || nonEmptyElementsMap[node.nodeName.toLowerCase()]) {\n          return Option.none();\n        }\n        lastInlineElement = node;\n      }\n      if (collapsed && lastInlineElement) {\n        return Option.some(CaretPosition(lastInlineElement, 0));\n      }\n      return Option.none();\n    };\n    var normalizeEndPoint = function (dom, collapsed, start, rng) {\n      var container, offset;\n      var body = dom.getRoot();\n      var node, nonEmptyElementsMap;\n      var directionLeft, isAfterNode, normalized = false;\n      container = rng[(start ? 'start' : 'end') + 'Container'];\n      offset = rng[(start ? 'start' : 'end') + 'Offset'];\n      isAfterNode = NodeType.isElement(container) && offset === container.childNodes.length;\n      nonEmptyElementsMap = dom.schema.getNonEmptyElements();\n      directionLeft = start;\n      if (isCaretContainer(container)) {\n        return Option.none();\n      }\n      if (NodeType.isElement(container) && offset > container.childNodes.length - 1) {\n        directionLeft = false;\n      }\n      if (NodeType.isDocument(container)) {\n        container = body;\n        offset = 0;\n      }\n      if (container === body) {\n        if (directionLeft) {\n          node = container.childNodes[offset > 0 ? offset - 1 : 0];\n          if (node) {\n            if (isCaretContainer(node)) {\n              return Option.none();\n            }\n            if (nonEmptyElementsMap[node.nodeName] || isTable$3(node)) {\n              return Option.none();\n            }\n          }\n        }\n        if (container.hasChildNodes()) {\n          offset = Math.min(!directionLeft && offset > 0 ? offset - 1 : offset, container.childNodes.length - 1);\n          container = container.childNodes[offset];\n          offset = NodeType.isText(container) && isAfterNode ? container.data.length : 0;\n          if (!collapsed && container === body.lastChild && isTable$3(container)) {\n            return Option.none();\n          }\n          if (hasContentEditableFalseParent(body, container) || isCaretContainer(container)) {\n            return Option.none();\n          }\n          if (container.hasChildNodes() && isTable$3(container) === false) {\n            node = container;\n            var walker = new TreeWalker(container, body);\n            do {\n              if (NodeType.isContentEditableFalse(node) || isCaretContainer(node)) {\n                normalized = false;\n                break;\n              }\n              if (NodeType.isText(node) && node.nodeValue.length > 0) {\n                offset = directionLeft ? 0 : node.nodeValue.length;\n                container = node;\n                normalized = true;\n                break;\n              }\n              if (nonEmptyElementsMap[node.nodeName.toLowerCase()] && !isTableCell$2(node)) {\n                offset = dom.nodeIndex(node);\n                container = node.parentNode;\n                if (!directionLeft) {\n                  offset++;\n                }\n                normalized = true;\n                break;\n              }\n            } while (node = directionLeft ? walker.next() : walker.prev());\n          }\n        }\n      }\n      if (collapsed) {\n        if (NodeType.isText(container) && offset === 0) {\n          findTextNodeRelative(dom, isAfterNode, collapsed, true, container).each(function (pos) {\n            container = pos.container();\n            offset = pos.offset();\n            normalized = true;\n          });\n        }\n        if (NodeType.isElement(container)) {\n          node = container.childNodes[offset];\n          if (!node) {\n            node = container.childNodes[offset - 1];\n          }\n          if (node && NodeType.isBr(node) && !isPrevNode(node, 'A') && !hasBrBeforeAfter(dom, node, false) && !hasBrBeforeAfter(dom, node, true)) {\n            findTextNodeRelative(dom, isAfterNode, collapsed, true, node).each(function (pos) {\n              container = pos.container();\n              offset = pos.offset();\n              normalized = true;\n            });\n          }\n        }\n      }\n      if (directionLeft && !collapsed && NodeType.isText(container) && offset === container.nodeValue.length) {\n        findTextNodeRelative(dom, isAfterNode, collapsed, false, container).each(function (pos) {\n          container = pos.container();\n          offset = pos.offset();\n          normalized = true;\n        });\n      }\n      return normalized ? Option.some(CaretPosition(container, offset)) : Option.none();\n    };\n    var normalize = function (dom, rng) {\n      var collapsed = rng.collapsed, normRng = rng.cloneRange();\n      var startPos = CaretPosition.fromRangeStart(rng);\n      normalizeEndPoint(dom, collapsed, true, normRng).each(function (pos) {\n        if (!collapsed || !CaretPosition.isAbove(startPos, pos)) {\n          normRng.setStart(pos.container(), pos.offset());\n        }\n      });\n      if (!collapsed) {\n        normalizeEndPoint(dom, collapsed, false, normRng).each(function (pos) {\n          normRng.setEnd(pos.container(), pos.offset());\n        });\n      }\n      if (collapsed) {\n        normRng.collapse(true);\n      }\n      return RangeCompare.isEq(rng, normRng) ? Option.none() : Option.some(normRng);\n    };\n    var NormalizeRange = { normalize: normalize };\n\n    var prependData = function (target, data) {\n      target.insertData(0, data);\n    };\n    var removeEmpty = function (text) {\n      if (text.dom().length === 0) {\n        remove(text);\n        return Option.none();\n      }\n      return Option.some(text);\n    };\n    var rngSetContent = function (rng, fragment) {\n      var firstChild = Option.from(fragment.firstChild).map(Element.fromDom);\n      var lastChild = Option.from(fragment.lastChild).map(Element.fromDom);\n      rng.deleteContents();\n      rng.insertNode(fragment);\n      var prevText = firstChild.bind(prevSibling).filter(isText).bind(removeEmpty);\n      var nextText = lastChild.bind(nextSibling).filter(isText).bind(removeEmpty);\n      lift2(prevText, firstChild.filter(isText), function (prev, start) {\n        prependData(start.dom(), prev.dom().data);\n        remove(prev);\n      });\n      lift2(nextText, lastChild.filter(isText), function (next, end) {\n        var oldLength = end.dom().length;\n        end.dom().appendData(next.dom().data);\n        rng.setEnd(end.dom(), oldLength);\n        remove(next);\n      });\n      rng.collapse(false);\n    };\n    var setupArgs = function (args, content) {\n      args = args || { format: 'html' };\n      args.set = true;\n      args.selection = true;\n      args.content = content;\n      return args;\n    };\n    var setContent$1 = function (editor, content, args) {\n      args = setupArgs(args, content);\n      if (!args.no_events) {\n        args = editor.fire('BeforeSetContent', args);\n        if (args.isDefaultPrevented()) {\n          editor.fire('SetContent', args);\n          return;\n        }\n      }\n      var rng = editor.selection.getRng();\n      rngSetContent(rng, rng.createContextualFragment(args.content));\n      editor.selection.setRng(rng);\n      ScrollIntoView.scrollRangeIntoView(editor, rng);\n      if (!args.no_events) {\n        editor.fire('SetContent', args);\n      }\n    };\n    var SetSelectionContent = { setContent: setContent$1 };\n\n    var getEndpointElement = function (root, rng, start, real, resolve) {\n      var container = start ? rng.startContainer : rng.endContainer;\n      var offset = start ? rng.startOffset : rng.endOffset;\n      return Option.from(container).map(Element.fromDom).map(function (elm) {\n        return !real || !rng.collapsed ? child(elm, resolve(elm, offset)).getOr(elm) : elm;\n      }).bind(function (elm) {\n        return isElement(elm) ? Option.some(elm) : parent(elm);\n      }).map(function (elm) {\n        return elm.dom();\n      }).getOr(root);\n    };\n    var getStart$2 = function (root, rng, real) {\n      return getEndpointElement(root, rng, true, real, function (elm, offset) {\n        return Math.min(childNodesCount(elm), offset);\n      });\n    };\n    var getEnd = function (root, rng, real) {\n      return getEndpointElement(root, rng, false, real, function (elm, offset) {\n        return offset > 0 ? offset - 1 : offset;\n      });\n    };\n    var skipEmptyTextNodes = function (node, forwards) {\n      var orig = node;\n      while (node && NodeType.isText(node) && node.length === 0) {\n        node = forwards ? node.nextSibling : node.previousSibling;\n      }\n      return node || orig;\n    };\n    var getNode$1 = function (root, rng) {\n      var elm, startContainer, endContainer, startOffset, endOffset;\n      if (!rng) {\n        return root;\n      }\n      startContainer = rng.startContainer;\n      endContainer = rng.endContainer;\n      startOffset = rng.startOffset;\n      endOffset = rng.endOffset;\n      elm = rng.commonAncestorContainer;\n      if (!rng.collapsed) {\n        if (startContainer === endContainer) {\n          if (endOffset - startOffset < 2) {\n            if (startContainer.hasChildNodes()) {\n              elm = startContainer.childNodes[startOffset];\n            }\n          }\n        }\n        if (startContainer.nodeType === 3 && endContainer.nodeType === 3) {\n          if (startContainer.length === startOffset) {\n            startContainer = skipEmptyTextNodes(startContainer.nextSibling, true);\n          } else {\n            startContainer = startContainer.parentNode;\n          }\n          if (endOffset === 0) {\n            endContainer = skipEmptyTextNodes(endContainer.previousSibling, false);\n          } else {\n            endContainer = endContainer.parentNode;\n          }\n          if (startContainer && startContainer === endContainer) {\n            return startContainer;\n          }\n        }\n      }\n      if (elm && elm.nodeType === 3) {\n        return elm.parentNode;\n      }\n      return elm;\n    };\n    var getSelectedBlocks = function (dom, rng, startElm, endElm) {\n      var node, root;\n      var selectedBlocks = [];\n      root = dom.getRoot();\n      startElm = dom.getParent(startElm || getStart$2(root, rng, rng.collapsed), dom.isBlock);\n      endElm = dom.getParent(endElm || getEnd(root, rng, rng.collapsed), dom.isBlock);\n      if (startElm && startElm !== root) {\n        selectedBlocks.push(startElm);\n      }\n      if (startElm && endElm && startElm !== endElm) {\n        node = startElm;\n        var walker = new TreeWalker(startElm, root);\n        while ((node = walker.next()) && node !== endElm) {\n          if (dom.isBlock(node)) {\n            selectedBlocks.push(node);\n          }\n        }\n      }\n      if (endElm && startElm !== endElm && endElm !== root) {\n        selectedBlocks.push(endElm);\n      }\n      return selectedBlocks;\n    };\n    var select$1 = function (dom, node, content) {\n      return Option.from(node).map(function (node) {\n        var idx = dom.nodeIndex(node);\n        var rng = dom.createRng();\n        rng.setStart(node.parentNode, idx);\n        rng.setEnd(node.parentNode, idx + 1);\n        if (content) {\n          moveEndPoint$1(dom, rng, node, true);\n          moveEndPoint$1(dom, rng, node, false);\n        }\n        return rng;\n      });\n    };\n\n    var deleteFromCallbackMap = function (callbackMap, selector, callback) {\n      if (callbackMap && callbackMap.hasOwnProperty(selector)) {\n        var newCallbacks = filter(callbackMap[selector], function (cb) {\n          return cb !== callback;\n        });\n        if (newCallbacks.length === 0) {\n          delete callbackMap[selector];\n        } else {\n          callbackMap[selector] = newCallbacks;\n        }\n      }\n    };\n    function SelectorChanged (dom, editor) {\n      var selectorChangedData;\n      var currentSelectors;\n      return {\n        selectorChangedWithUnbind: function (selector, callback) {\n          if (!selectorChangedData) {\n            selectorChangedData = {};\n            currentSelectors = {};\n            editor.on('NodeChange', function (e) {\n              var node = e.element, parents = dom.getParents(node, null, dom.getRoot()), matchedSelectors = {};\n              Tools.each(selectorChangedData, function (callbacks, selector) {\n                Tools.each(parents, function (node) {\n                  if (dom.is(node, selector)) {\n                    if (!currentSelectors[selector]) {\n                      Tools.each(callbacks, function (callback) {\n                        callback(true, {\n                          node: node,\n                          selector: selector,\n                          parents: parents\n                        });\n                      });\n                      currentSelectors[selector] = callbacks;\n                    }\n                    matchedSelectors[selector] = callbacks;\n                    return false;\n                  }\n                });\n              });\n              Tools.each(currentSelectors, function (callbacks, selector) {\n                if (!matchedSelectors[selector]) {\n                  delete currentSelectors[selector];\n                  Tools.each(callbacks, function (callback) {\n                    callback(false, {\n                      node: node,\n                      selector: selector,\n                      parents: parents\n                    });\n                  });\n                }\n              });\n            });\n          }\n          if (!selectorChangedData[selector]) {\n            selectorChangedData[selector] = [];\n          }\n          selectorChangedData[selector].push(callback);\n          return {\n            unbind: function () {\n              deleteFromCallbackMap(selectorChangedData, selector, callback);\n              deleteFromCallbackMap(currentSelectors, selector, callback);\n            }\n          };\n        }\n      };\n    }\n\n    var isNativeIeSelection = function (rng) {\n      return !!rng.select;\n    };\n    var isAttachedToDom = function (node) {\n      return !!(node && node.ownerDocument) && contains$2(Element.fromDom(node.ownerDocument), Element.fromDom(node));\n    };\n    var isValidRange = function (rng) {\n      if (!rng) {\n        return false;\n      } else if (isNativeIeSelection(rng)) {\n        return true;\n      } else {\n        return isAttachedToDom(rng.startContainer) && isAttachedToDom(rng.endContainer);\n      }\n    };\n    var Selection$1 = function (dom, win, serializer, editor) {\n      var bookmarkManager;\n      var controlSelection;\n      var selectedRange;\n      var explicitRange;\n      var selectorChangedWithUnbind = SelectorChanged(dom, editor).selectorChangedWithUnbind;\n      var setCursorLocation = function (node, offset) {\n        var rng = dom.createRng();\n        if (!node) {\n          moveEndPoint$1(dom, rng, editor.getBody(), true);\n          setRng(rng);\n        } else {\n          rng.setStart(node, offset);\n          rng.setEnd(node, offset);\n          setRng(rng);\n          collapse(false);\n        }\n      };\n      var getContent = function (args) {\n        return GetSelectionContent.getContent(editor, args);\n      };\n      var setContent = function (content, args) {\n        return SetSelectionContent.setContent(editor, content, args);\n      };\n      var getStart = function (real) {\n        return getStart$2(editor.getBody(), getRng(), real);\n      };\n      var getEnd$1 = function (real) {\n        return getEnd(editor.getBody(), getRng(), real);\n      };\n      var getBookmark = function (type, normalized) {\n        return bookmarkManager.getBookmark(type, normalized);\n      };\n      var moveToBookmark = function (bookmark) {\n        return bookmarkManager.moveToBookmark(bookmark);\n      };\n      var select = function (node, content) {\n        select$1(dom, node, content).each(setRng);\n        return node;\n      };\n      var isCollapsed = function () {\n        var rng = getRng(), sel = getSel();\n        if (!rng || rng.item) {\n          return false;\n        }\n        if (rng.compareEndPoints) {\n          return rng.compareEndPoints('StartToEnd', rng) === 0;\n        }\n        return !sel || rng.collapsed;\n      };\n      var collapse = function (toStart) {\n        var rng = getRng();\n        rng.collapse(!!toStart);\n        setRng(rng);\n      };\n      var getSel = function () {\n        return win.getSelection ? win.getSelection() : win.document.selection;\n      };\n      var getRng = function () {\n        var selection, rng, elm, doc;\n        var tryCompareBoundaryPoints = function (how, sourceRange, destinationRange) {\n          try {\n            return sourceRange.compareBoundaryPoints(how, destinationRange);\n          } catch (ex) {\n            return -1;\n          }\n        };\n        if (!win) {\n          return null;\n        }\n        doc = win.document;\n        if (typeof doc === 'undefined' || doc === null) {\n          return null;\n        }\n        if (editor.bookmark !== undefined && EditorFocus.hasFocus(editor) === false) {\n          var bookmark = SelectionBookmark.getRng(editor);\n          if (bookmark.isSome()) {\n            return bookmark.map(function (r) {\n              return EventProcessRanges.processRanges(editor, [r])[0];\n            }).getOr(doc.createRange());\n          }\n        }\n        try {\n          if ((selection = getSel()) && !NodeType.isRestrictedNode(selection.anchorNode)) {\n            if (selection.rangeCount > 0) {\n              rng = selection.getRangeAt(0);\n            } else {\n              rng = selection.createRange ? selection.createRange() : doc.createRange();\n            }\n          }\n        } catch (ex) {\n        }\n        rng = EventProcessRanges.processRanges(editor, [rng])[0];\n        if (!rng) {\n          rng = doc.createRange ? doc.createRange() : doc.body.createTextRange();\n        }\n        if (rng.setStart && rng.startContainer.nodeType === 9 && rng.collapsed) {\n          elm = dom.getRoot();\n          rng.setStart(elm, 0);\n          rng.setEnd(elm, 0);\n        }\n        if (selectedRange && explicitRange) {\n          if (tryCompareBoundaryPoints(rng.START_TO_START, rng, selectedRange) === 0 && tryCompareBoundaryPoints(rng.END_TO_END, rng, selectedRange) === 0) {\n            rng = explicitRange;\n          } else {\n            selectedRange = null;\n            explicitRange = null;\n          }\n        }\n        return rng;\n      };\n      var setRng = function (rng, forward) {\n        var sel, node, evt;\n        if (!isValidRange(rng)) {\n          return;\n        }\n        var ieRange = isNativeIeSelection(rng) ? rng : null;\n        if (ieRange) {\n          explicitRange = null;\n          try {\n            ieRange.select();\n          } catch (ex) {\n          }\n          return;\n        }\n        sel = getSel();\n        evt = editor.fire('SetSelectionRange', {\n          range: rng,\n          forward: forward\n        });\n        rng = evt.range;\n        if (sel) {\n          explicitRange = rng;\n          try {\n            sel.removeAllRanges();\n            sel.addRange(rng);\n          } catch (ex) {\n          }\n          if (forward === false && sel.extend) {\n            sel.collapse(rng.endContainer, rng.endOffset);\n            sel.extend(rng.startContainer, rng.startOffset);\n          }\n          selectedRange = sel.rangeCount > 0 ? sel.getRangeAt(0) : null;\n        }\n        if (!rng.collapsed && rng.startContainer === rng.endContainer && sel.setBaseAndExtent && !Env.ie) {\n          if (rng.endOffset - rng.startOffset < 2) {\n            if (rng.startContainer.hasChildNodes()) {\n              node = rng.startContainer.childNodes[rng.startOffset];\n              if (node && node.tagName === 'IMG') {\n                sel.setBaseAndExtent(rng.startContainer, rng.startOffset, rng.endContainer, rng.endOffset);\n                if (sel.anchorNode !== rng.startContainer || sel.focusNode !== rng.endContainer) {\n                  sel.setBaseAndExtent(node, 0, node, 1);\n                }\n              }\n            }\n          }\n        }\n        editor.fire('AfterSetSelectionRange', {\n          range: rng,\n          forward: forward\n        });\n      };\n      var setNode = function (elm) {\n        setContent(dom.getOuterHTML(elm));\n        return elm;\n      };\n      var getNode = function () {\n        return getNode$1(editor.getBody(), getRng());\n      };\n      var getSelectedBlocks$1 = function (startElm, endElm) {\n        return getSelectedBlocks(dom, getRng(), startElm, endElm);\n      };\n      var isForward = function () {\n        var sel = getSel();\n        var anchorRange, focusRange;\n        if (!sel || !sel.anchorNode || !sel.focusNode) {\n          return true;\n        }\n        anchorRange = dom.createRng();\n        anchorRange.setStart(sel.anchorNode, sel.anchorOffset);\n        anchorRange.collapse(true);\n        focusRange = dom.createRng();\n        focusRange.setStart(sel.focusNode, sel.focusOffset);\n        focusRange.collapse(true);\n        return anchorRange.compareBoundaryPoints(anchorRange.START_TO_START, focusRange) <= 0;\n      };\n      var normalize = function () {\n        var rng = getRng();\n        var sel = getSel();\n        if (!MultiRange.hasMultipleRanges(sel) && hasAnyRanges(editor)) {\n          var normRng = NormalizeRange.normalize(dom, rng);\n          normRng.each(function (normRng) {\n            setRng(normRng, isForward());\n          });\n          return normRng.getOr(rng);\n        }\n        return rng;\n      };\n      var selectorChanged = function (selector, callback) {\n        selectorChangedWithUnbind(selector, callback);\n        return exports;\n      };\n      var getScrollContainer = function () {\n        var scrollContainer;\n        var node = dom.getRoot();\n        while (node && node.nodeName !== 'BODY') {\n          if (node.scrollHeight > node.clientHeight) {\n            scrollContainer = node;\n            break;\n          }\n          node = node.parentNode;\n        }\n        return scrollContainer;\n      };\n      var scrollIntoView = function (elm, alignToTop) {\n        return ScrollIntoView.scrollElementIntoView(editor, elm, alignToTop);\n      };\n      var placeCaretAt = function (clientX, clientY) {\n        return setRng(CaretRangeFromPoint.fromPoint(clientX, clientY, editor.getDoc()));\n      };\n      var getBoundingClientRect = function () {\n        var rng = getRng();\n        return rng.collapsed ? CaretPosition$1.fromRangeStart(rng).getClientRects()[0] : rng.getBoundingClientRect();\n      };\n      var destroy = function () {\n        win = selectedRange = explicitRange = null;\n        controlSelection.destroy();\n      };\n      var exports = {\n        bookmarkManager: null,\n        controlSelection: null,\n        dom: dom,\n        win: win,\n        serializer: serializer,\n        editor: editor,\n        collapse: collapse,\n        setCursorLocation: setCursorLocation,\n        getContent: getContent,\n        setContent: setContent,\n        getBookmark: getBookmark,\n        moveToBookmark: moveToBookmark,\n        select: select,\n        isCollapsed: isCollapsed,\n        isForward: isForward,\n        setNode: setNode,\n        getNode: getNode,\n        getSel: getSel,\n        setRng: setRng,\n        getRng: getRng,\n        getStart: getStart,\n        getEnd: getEnd$1,\n        getSelectedBlocks: getSelectedBlocks$1,\n        normalize: normalize,\n        selectorChanged: selectorChanged,\n        selectorChangedWithUnbind: selectorChangedWithUnbind,\n        getScrollContainer: getScrollContainer,\n        scrollIntoView: scrollIntoView,\n        placeCaretAt: placeCaretAt,\n        getBoundingClientRect: getBoundingClientRect,\n        destroy: destroy\n      };\n      bookmarkManager = BookmarkManager$1(exports);\n      controlSelection = ControlSelection(exports, editor);\n      exports.bookmarkManager = bookmarkManager;\n      exports.controlSelection = controlSelection;\n      return exports;\n    };\n\n    var removeAttrs = function (node, names) {\n      each(names, function (name) {\n        node.attr(name, null);\n      });\n    };\n    var addFontToSpansFilter = function (domParser, styles, fontSizes) {\n      domParser.addNodeFilter('font', function (nodes) {\n        each(nodes, function (node) {\n          var props = styles.parse(node.attr('style'));\n          var color = node.attr('color');\n          var face = node.attr('face');\n          var size = node.attr('size');\n          if (color) {\n            props.color = color;\n          }\n          if (face) {\n            props['font-family'] = face;\n          }\n          if (size) {\n            props['font-size'] = fontSizes[parseInt(node.attr('size'), 10) - 1];\n          }\n          node.name = 'span';\n          node.attr('style', styles.serialize(props));\n          removeAttrs(node, [\n            'color',\n            'face',\n            'size'\n          ]);\n        });\n      });\n    };\n    var addStrikeToSpanFilter = function (domParser, styles) {\n      domParser.addNodeFilter('strike', function (nodes) {\n        each(nodes, function (node) {\n          var props = styles.parse(node.attr('style'));\n          props['text-decoration'] = 'line-through';\n          node.name = 'span';\n          node.attr('style', styles.serialize(props));\n        });\n      });\n    };\n    var addFilters = function (domParser, settings) {\n      var styles = Styles();\n      if (settings.convert_fonts_to_spans) {\n        addFontToSpansFilter(domParser, styles, Tools.explode(settings.font_size_legacy_values));\n      }\n      addStrikeToSpanFilter(domParser, styles);\n    };\n    var register$1 = function (domParser, settings) {\n      if (settings.inline_styles) {\n        addFilters(domParser, settings);\n      }\n    };\n    var LegacyFilter = { register: register$1 };\n\n    var paddEmptyNode = function (settings, args, blockElements, node) {\n      var brPreferred = settings.padd_empty_with_br || args.insert;\n      if (brPreferred && blockElements[node.name]) {\n        node.empty().append(new Node$1('br', 1)).shortEnded = true;\n      } else {\n        node.empty().append(new Node$1('#text', 3)).value = nbsp;\n      }\n    };\n    var isPaddedWithNbsp = function (node) {\n      return hasOnlyChild(node, '#text') && node.firstChild.value === nbsp;\n    };\n    var hasOnlyChild = function (node, name) {\n      return node && node.firstChild && node.firstChild === node.lastChild && node.firstChild.name === name;\n    };\n    var isPadded = function (schema, node) {\n      var rule = schema.getElementRule(node.name);\n      return rule && rule.paddEmpty;\n    };\n    var isEmpty$1 = function (schema, nonEmptyElements, whitespaceElements, node) {\n      return node.isEmpty(nonEmptyElements, whitespaceElements, function (node) {\n        return isPadded(schema, node);\n      });\n    };\n    var isLineBreakNode = function (node, blockElements) {\n      return node && (blockElements[node.name] || node.name === 'br');\n    };\n\n    var register$2 = function (parser, settings) {\n      var schema = parser.schema;\n      if (settings.remove_trailing_brs) {\n        parser.addNodeFilter('br', function (nodes, _, args) {\n          var i;\n          var l = nodes.length;\n          var node;\n          var blockElements = Tools.extend({}, schema.getBlockElements());\n          var nonEmptyElements = schema.getNonEmptyElements();\n          var parent, lastParent, prev, prevName;\n          var whiteSpaceElements = schema.getNonEmptyElements();\n          var elementRule, textNode;\n          blockElements.body = 1;\n          for (i = 0; i < l; i++) {\n            node = nodes[i];\n            parent = node.parent;\n            if (blockElements[node.parent.name] && node === parent.lastChild) {\n              prev = node.prev;\n              while (prev) {\n                prevName = prev.name;\n                if (prevName !== 'span' || prev.attr('data-mce-type') !== 'bookmark') {\n                  if (prevName !== 'br') {\n                    break;\n                  }\n                  if (prevName === 'br') {\n                    node = null;\n                    break;\n                  }\n                }\n                prev = prev.prev;\n              }\n              if (node) {\n                node.remove();\n                if (isEmpty$1(schema, nonEmptyElements, whiteSpaceElements, parent)) {\n                  elementRule = schema.getElementRule(parent.name);\n                  if (elementRule) {\n                    if (elementRule.removeEmpty) {\n                      parent.remove();\n                    } else if (elementRule.paddEmpty) {\n                      paddEmptyNode(settings, args, blockElements, parent);\n                    }\n                  }\n                }\n              }\n            } else {\n              lastParent = node;\n              while (parent && parent.firstChild === lastParent && parent.lastChild === lastParent) {\n                lastParent = parent;\n                if (blockElements[parent.name]) {\n                  break;\n                }\n                parent = parent.parent;\n              }\n              if (lastParent === parent && settings.padd_empty_with_br !== true) {\n                textNode = new Node$1('#text', 3);\n                textNode.value = nbsp;\n                node.replace(textNode);\n              }\n            }\n          }\n        });\n      }\n      parser.addAttributeFilter('href', function (nodes) {\n        var i = nodes.length, node;\n        var appendRel = function (rel) {\n          var parts = rel.split(' ').filter(function (p) {\n            return p.length > 0;\n          });\n          return parts.concat(['noopener']).sort().join(' ');\n        };\n        var addNoOpener = function (rel) {\n          var newRel = rel ? Tools.trim(rel) : '';\n          if (!/\\b(noopener)\\b/g.test(newRel)) {\n            return appendRel(newRel);\n          } else {\n            return newRel;\n          }\n        };\n        if (!settings.allow_unsafe_link_target) {\n          while (i--) {\n            node = nodes[i];\n            if (node.name === 'a' && node.attr('target') === '_blank') {\n              node.attr('rel', addNoOpener(node.attr('rel')));\n            }\n          }\n        }\n      });\n      if (!settings.allow_html_in_named_anchor) {\n        parser.addAttributeFilter('id,name', function (nodes) {\n          var i = nodes.length, sibling, prevSibling, parent, node;\n          while (i--) {\n            node = nodes[i];\n            if (node.name === 'a' && node.firstChild && !node.attr('href')) {\n              parent = node.parent;\n              sibling = node.lastChild;\n              do {\n                prevSibling = sibling.prev;\n                parent.insert(sibling, node);\n                sibling = prevSibling;\n              } while (sibling);\n            }\n          }\n        });\n      }\n      if (settings.fix_list_elements) {\n        parser.addNodeFilter('ul,ol', function (nodes) {\n          var i = nodes.length, node, parentNode;\n          while (i--) {\n            node = nodes[i];\n            parentNode = node.parent;\n            if (parentNode.name === 'ul' || parentNode.name === 'ol') {\n              if (node.prev && node.prev.name === 'li') {\n                node.prev.append(node);\n              } else {\n                var li = new Node$1('li', 1);\n                li.attr('style', 'list-style-type: none');\n                node.wrap(li);\n              }\n            }\n          }\n        });\n      }\n      if (settings.validate && schema.getValidClasses()) {\n        parser.addAttributeFilter('class', function (nodes) {\n          var i = nodes.length, node, classList, ci, className, classValue;\n          var validClasses = schema.getValidClasses();\n          var validClassesMap, valid;\n          while (i--) {\n            node = nodes[i];\n            classList = node.attr('class').split(' ');\n            classValue = '';\n            for (ci = 0; ci < classList.length; ci++) {\n              className = classList[ci];\n              valid = false;\n              validClassesMap = validClasses['*'];\n              if (validClassesMap && validClassesMap[className]) {\n                valid = true;\n              }\n              validClassesMap = validClasses[node.name];\n              if (!valid && validClassesMap && validClassesMap[className]) {\n                valid = true;\n              }\n              if (valid) {\n                if (classValue) {\n                  classValue += ' ';\n                }\n                classValue += className;\n              }\n            }\n            if (!classValue.length) {\n              classValue = null;\n            }\n            node.attr('class', classValue);\n          }\n        });\n      }\n    };\n\n    var makeMap$4 = Tools.makeMap, each$8 = Tools.each, explode$2 = Tools.explode, extend$2 = Tools.extend;\n    var DomParser = function (settings, schema) {\n      if (schema === void 0) {\n        schema = Schema();\n      }\n      var nodeFilters = {};\n      var attributeFilters = [];\n      var matchedNodes = {};\n      var matchedAttributes = {};\n      settings = settings || {};\n      settings.validate = 'validate' in settings ? settings.validate : true;\n      settings.root_name = settings.root_name || 'body';\n      var fixInvalidChildren = function (nodes) {\n        var ni, node, parent, parents, newParent, currentNode, tempNode, childNode, i;\n        var nonEmptyElements, whitespaceElements, nonSplitableElements, textBlockElements, specialElements, sibling, nextNode;\n        nonSplitableElements = makeMap$4('tr,td,th,tbody,thead,tfoot,table');\n        nonEmptyElements = schema.getNonEmptyElements();\n        whitespaceElements = schema.getWhiteSpaceElements();\n        textBlockElements = schema.getTextBlockElements();\n        specialElements = schema.getSpecialElements();\n        for (ni = 0; ni < nodes.length; ni++) {\n          node = nodes[ni];\n          if (!node.parent || node.fixed) {\n            continue;\n          }\n          if (textBlockElements[node.name] && node.parent.name === 'li') {\n            sibling = node.next;\n            while (sibling) {\n              if (textBlockElements[sibling.name]) {\n                sibling.name = 'li';\n                sibling.fixed = true;\n                node.parent.insert(sibling, node.parent);\n              } else {\n                break;\n              }\n              sibling = sibling.next;\n            }\n            node.unwrap(node);\n            continue;\n          }\n          parents = [node];\n          for (parent = node.parent; parent && !schema.isValidChild(parent.name, node.name) && !nonSplitableElements[parent.name]; parent = parent.parent) {\n            parents.push(parent);\n          }\n          if (parent && parents.length > 1) {\n            parents.reverse();\n            newParent = currentNode = filterNode(parents[0].clone());\n            for (i = 0; i < parents.length - 1; i++) {\n              if (schema.isValidChild(currentNode.name, parents[i].name)) {\n                tempNode = filterNode(parents[i].clone());\n                currentNode.append(tempNode);\n              } else {\n                tempNode = currentNode;\n              }\n              for (childNode = parents[i].firstChild; childNode && childNode !== parents[i + 1];) {\n                nextNode = childNode.next;\n                tempNode.append(childNode);\n                childNode = nextNode;\n              }\n              currentNode = tempNode;\n            }\n            if (!isEmpty$1(schema, nonEmptyElements, whitespaceElements, newParent)) {\n              parent.insert(newParent, parents[0], true);\n              parent.insert(node, newParent);\n            } else {\n              parent.insert(node, parents[0], true);\n            }\n            parent = parents[0];\n            if (isEmpty$1(schema, nonEmptyElements, whitespaceElements, parent) || hasOnlyChild(parent, 'br')) {\n              parent.empty().remove();\n            }\n          } else if (node.parent) {\n            if (node.name === 'li') {\n              sibling = node.prev;\n              if (sibling && (sibling.name === 'ul' || sibling.name === 'ul')) {\n                sibling.append(node);\n                continue;\n              }\n              sibling = node.next;\n              if (sibling && (sibling.name === 'ul' || sibling.name === 'ul')) {\n                sibling.insert(node, sibling.firstChild, true);\n                continue;\n              }\n              node.wrap(filterNode(new Node$1('ul', 1)));\n              continue;\n            }\n            if (schema.isValidChild(node.parent.name, 'div') && schema.isValidChild('div', node.name)) {\n              node.wrap(filterNode(new Node$1('div', 1)));\n            } else {\n              if (specialElements[node.name]) {\n                node.empty().remove();\n              } else {\n                node.unwrap();\n              }\n            }\n          }\n        }\n      };\n      var filterNode = function (node) {\n        var i, name, list;\n        name = node.name;\n        if (name in nodeFilters) {\n          list = matchedNodes[name];\n          if (list) {\n            list.push(node);\n          } else {\n            matchedNodes[name] = [node];\n          }\n        }\n        i = attributeFilters.length;\n        while (i--) {\n          name = attributeFilters[i].name;\n          if (name in node.attributes.map) {\n            list = matchedAttributes[name];\n            if (list) {\n              list.push(node);\n            } else {\n              matchedAttributes[name] = [node];\n            }\n          }\n        }\n        return node;\n      };\n      var addNodeFilter = function (name, callback) {\n        each$8(explode$2(name), function (name) {\n          var list = nodeFilters[name];\n          if (!list) {\n            nodeFilters[name] = list = [];\n          }\n          list.push(callback);\n        });\n      };\n      var getNodeFilters = function () {\n        var out = [];\n        for (var name_1 in nodeFilters) {\n          if (nodeFilters.hasOwnProperty(name_1)) {\n            out.push({\n              name: name_1,\n              callbacks: nodeFilters[name_1]\n            });\n          }\n        }\n        return out;\n      };\n      var addAttributeFilter = function (name, callback) {\n        each$8(explode$2(name), function (name) {\n          var i;\n          for (i = 0; i < attributeFilters.length; i++) {\n            if (attributeFilters[i].name === name) {\n              attributeFilters[i].callbacks.push(callback);\n              return;\n            }\n          }\n          attributeFilters.push({\n            name: name,\n            callbacks: [callback]\n          });\n        });\n      };\n      var getAttributeFilters = function () {\n        return [].concat(attributeFilters);\n      };\n      var parse = function (html, args) {\n        var parser, nodes, i, l, fi, fl, list, name;\n        var blockElements;\n        var invalidChildren = [];\n        var isInWhiteSpacePreservedElement;\n        var node;\n        var getRootBlockName = function (name) {\n          if (name === false) {\n            return '';\n          } else if (name === true) {\n            return 'p';\n          } else {\n            return name;\n          }\n        };\n        args = args || {};\n        matchedNodes = {};\n        matchedAttributes = {};\n        blockElements = extend$2(makeMap$4('script,style,head,html,body,title,meta,param'), schema.getBlockElements());\n        var nonEmptyElements = schema.getNonEmptyElements();\n        var children = schema.children;\n        var validate = settings.validate;\n        var forcedRootBlockName = 'forced_root_block' in args ? args.forced_root_block : settings.forced_root_block;\n        var rootBlockName = getRootBlockName(forcedRootBlockName);\n        var whiteSpaceElements = schema.getWhiteSpaceElements();\n        var startWhiteSpaceRegExp = /^[ \\t\\r\\n]+/;\n        var endWhiteSpaceRegExp = /[ \\t\\r\\n]+$/;\n        var allWhiteSpaceRegExp = /[ \\t\\r\\n]+/g;\n        var isAllWhiteSpaceRegExp = /^[ \\t\\r\\n]+$/;\n        isInWhiteSpacePreservedElement = whiteSpaceElements.hasOwnProperty(args.context) || whiteSpaceElements.hasOwnProperty(settings.root_name);\n        var addRootBlocks = function () {\n          var node = rootNode.firstChild, next, rootBlockNode;\n          var trim = function (rootBlockNode) {\n            if (rootBlockNode) {\n              node = rootBlockNode.firstChild;\n              if (node && node.type === 3) {\n                node.value = node.value.replace(startWhiteSpaceRegExp, '');\n              }\n              node = rootBlockNode.lastChild;\n              if (node && node.type === 3) {\n                node.value = node.value.replace(endWhiteSpaceRegExp, '');\n              }\n            }\n          };\n          if (!schema.isValidChild(rootNode.name, rootBlockName.toLowerCase())) {\n            return;\n          }\n          while (node) {\n            next = node.next;\n            if (node.type === 3 || node.type === 1 && node.name !== 'p' && !blockElements[node.name] && !node.attr('data-mce-type')) {\n              if (!rootBlockNode) {\n                rootBlockNode = createNode(rootBlockName, 1);\n                rootBlockNode.attr(settings.forced_root_block_attrs);\n                rootNode.insert(rootBlockNode, node);\n                rootBlockNode.append(node);\n              } else {\n                rootBlockNode.append(node);\n              }\n            } else {\n              trim(rootBlockNode);\n              rootBlockNode = null;\n            }\n            node = next;\n          }\n          trim(rootBlockNode);\n        };\n        var createNode = function (name, type) {\n          var node = new Node$1(name, type);\n          var list;\n          if (name in nodeFilters) {\n            list = matchedNodes[name];\n            if (list) {\n              list.push(node);\n            } else {\n              matchedNodes[name] = [node];\n            }\n          }\n          return node;\n        };\n        var removeWhitespaceBefore = function (node) {\n          var textNode, textNodeNext, textVal, sibling;\n          var blockElements = schema.getBlockElements();\n          for (textNode = node.prev; textNode && textNode.type === 3;) {\n            textVal = textNode.value.replace(endWhiteSpaceRegExp, '');\n            if (textVal.length > 0) {\n              textNode.value = textVal;\n              return;\n            }\n            textNodeNext = textNode.next;\n            if (textNodeNext) {\n              if (textNodeNext.type === 3 && textNodeNext.value.length) {\n                textNode = textNode.prev;\n                continue;\n              }\n              if (!blockElements[textNodeNext.name] && textNodeNext.name !== 'script' && textNodeNext.name !== 'style') {\n                textNode = textNode.prev;\n                continue;\n              }\n            }\n            sibling = textNode.prev;\n            textNode.remove();\n            textNode = sibling;\n          }\n        };\n        var cloneAndExcludeBlocks = function (input) {\n          var name;\n          var output = {};\n          for (name in input) {\n            if (name !== 'li' && name !== 'p') {\n              output[name] = input[name];\n            }\n          }\n          return output;\n        };\n        parser = SaxParser$1({\n          validate: validate,\n          allow_script_urls: settings.allow_script_urls,\n          allow_conditional_comments: settings.allow_conditional_comments,\n          preserve_cdata: settings.preserve_cdata,\n          self_closing_elements: cloneAndExcludeBlocks(schema.getSelfClosingElements()),\n          cdata: function (text) {\n            node.append(createNode('#cdata', 4)).value = text;\n          },\n          text: function (text, raw) {\n            var textNode;\n            if (!isInWhiteSpacePreservedElement) {\n              text = text.replace(allWhiteSpaceRegExp, ' ');\n              if (isLineBreakNode(node.lastChild, blockElements)) {\n                text = text.replace(startWhiteSpaceRegExp, '');\n              }\n            }\n            if (text.length !== 0) {\n              textNode = createNode('#text', 3);\n              textNode.raw = !!raw;\n              node.append(textNode).value = text;\n            }\n          },\n          comment: function (text) {\n            node.append(createNode('#comment', 8)).value = text;\n          },\n          pi: function (name, text) {\n            node.append(createNode(name, 7)).value = text;\n            removeWhitespaceBefore(node);\n          },\n          doctype: function (text) {\n            var newNode;\n            newNode = node.append(createNode('#doctype', 10));\n            newNode.value = text;\n            removeWhitespaceBefore(node);\n          },\n          start: function (name, attrs, empty) {\n            var newNode, attrFiltersLen, elementRule, attrName, parent;\n            elementRule = validate ? schema.getElementRule(name) : {};\n            if (elementRule) {\n              newNode = createNode(elementRule.outputName || name, 1);\n              newNode.attributes = attrs;\n              newNode.shortEnded = empty;\n              node.append(newNode);\n              parent = children[node.name];\n              if (parent && children[newNode.name] && !parent[newNode.name]) {\n                invalidChildren.push(newNode);\n              }\n              attrFiltersLen = attributeFilters.length;\n              while (attrFiltersLen--) {\n                attrName = attributeFilters[attrFiltersLen].name;\n                if (attrName in attrs.map) {\n                  list = matchedAttributes[attrName];\n                  if (list) {\n                    list.push(newNode);\n                  } else {\n                    matchedAttributes[attrName] = [newNode];\n                  }\n                }\n              }\n              if (blockElements[name]) {\n                removeWhitespaceBefore(newNode);\n              }\n              if (!empty) {\n                node = newNode;\n              }\n              if (!isInWhiteSpacePreservedElement && whiteSpaceElements[name]) {\n                isInWhiteSpacePreservedElement = true;\n              }\n            }\n          },\n          end: function (name) {\n            var textNode, elementRule, text, sibling, tempNode;\n            elementRule = validate ? schema.getElementRule(name) : {};\n            if (elementRule) {\n              if (blockElements[name]) {\n                if (!isInWhiteSpacePreservedElement) {\n                  textNode = node.firstChild;\n                  if (textNode && textNode.type === 3) {\n                    text = textNode.value.replace(startWhiteSpaceRegExp, '');\n                    if (text.length > 0) {\n                      textNode.value = text;\n                      textNode = textNode.next;\n                    } else {\n                      sibling = textNode.next;\n                      textNode.remove();\n                      textNode = sibling;\n                      while (textNode && textNode.type === 3) {\n                        text = textNode.value;\n                        sibling = textNode.next;\n                        if (text.length === 0 || isAllWhiteSpaceRegExp.test(text)) {\n                          textNode.remove();\n                          textNode = sibling;\n                        }\n                        textNode = sibling;\n                      }\n                    }\n                  }\n                  textNode = node.lastChild;\n                  if (textNode && textNode.type === 3) {\n                    text = textNode.value.replace(endWhiteSpaceRegExp, '');\n                    if (text.length > 0) {\n                      textNode.value = text;\n                      textNode = textNode.prev;\n                    } else {\n                      sibling = textNode.prev;\n                      textNode.remove();\n                      textNode = sibling;\n                      while (textNode && textNode.type === 3) {\n                        text = textNode.value;\n                        sibling = textNode.prev;\n                        if (text.length === 0 || isAllWhiteSpaceRegExp.test(text)) {\n                          textNode.remove();\n                          textNode = sibling;\n                        }\n                        textNode = sibling;\n                      }\n                    }\n                  }\n                }\n              }\n              if (isInWhiteSpacePreservedElement && whiteSpaceElements[name]) {\n                isInWhiteSpacePreservedElement = false;\n              }\n              if (elementRule.removeEmpty && isEmpty$1(schema, nonEmptyElements, whiteSpaceElements, node)) {\n                if (!node.attr('name') && !node.attr('id')) {\n                  tempNode = node.parent;\n                  if (blockElements[node.name]) {\n                    node.empty().remove();\n                  } else {\n                    node.unwrap();\n                  }\n                  node = tempNode;\n                  return;\n                }\n              }\n              if (elementRule.paddEmpty && (isPaddedWithNbsp(node) || isEmpty$1(schema, nonEmptyElements, whiteSpaceElements, node))) {\n                paddEmptyNode(settings, args, blockElements, node);\n              }\n              node = node.parent;\n            }\n          }\n        }, schema);\n        var rootNode = node = new Node$1(args.context || settings.root_name, 11);\n        parser.parse(html, args.format);\n        if (validate && invalidChildren.length) {\n          if (!args.context) {\n            fixInvalidChildren(invalidChildren);\n          } else {\n            args.invalid = true;\n          }\n        }\n        if (rootBlockName && (rootNode.name === 'body' || args.isRootContent)) {\n          addRootBlocks();\n        }\n        if (!args.invalid) {\n          for (name in matchedNodes) {\n            if (!matchedNodes.hasOwnProperty(name)) {\n              continue;\n            }\n            list = nodeFilters[name];\n            nodes = matchedNodes[name];\n            fi = nodes.length;\n            while (fi--) {\n              if (!nodes[fi].parent) {\n                nodes.splice(fi, 1);\n              }\n            }\n            for (i = 0, l = list.length; i < l; i++) {\n              list[i](nodes, name, args);\n            }\n          }\n          for (i = 0, l = attributeFilters.length; i < l; i++) {\n            list = attributeFilters[i];\n            if (list.name in matchedAttributes) {\n              nodes = matchedAttributes[list.name];\n              fi = nodes.length;\n              while (fi--) {\n                if (!nodes[fi].parent) {\n                  nodes.splice(fi, 1);\n                }\n              }\n              for (fi = 0, fl = list.callbacks.length; fi < fl; fi++) {\n                list.callbacks[fi](nodes, list.name, args);\n              }\n            }\n          }\n        }\n        return rootNode;\n      };\n      var exports = {\n        schema: schema,\n        addAttributeFilter: addAttributeFilter,\n        getAttributeFilters: getAttributeFilters,\n        addNodeFilter: addNodeFilter,\n        getNodeFilters: getNodeFilters,\n        filterNode: filterNode,\n        parse: parse\n      };\n      register$2(exports, settings);\n      LegacyFilter.register(exports, settings);\n      return exports;\n    };\n\n    var register$3 = function (htmlParser, settings, dom) {\n      htmlParser.addAttributeFilter('data-mce-tabindex', function (nodes, name) {\n        var i = nodes.length, node;\n        while (i--) {\n          node = nodes[i];\n          node.attr('tabindex', node.attr('data-mce-tabindex'));\n          node.attr(name, null);\n        }\n      });\n      htmlParser.addAttributeFilter('src,href,style', function (nodes, name) {\n        var i = nodes.length, node, value;\n        var internalName = 'data-mce-' + name;\n        var urlConverter = settings.url_converter;\n        var urlConverterScope = settings.url_converter_scope;\n        while (i--) {\n          node = nodes[i];\n          value = node.attr(internalName);\n          if (value !== undefined) {\n            node.attr(name, value.length > 0 ? value : null);\n            node.attr(internalName, null);\n          } else {\n            value = node.attr(name);\n            if (name === 'style') {\n              value = dom.serializeStyle(dom.parseStyle(value), node.name);\n            } else if (urlConverter) {\n              value = urlConverter.call(urlConverterScope, value, name, node.name);\n            }\n            node.attr(name, value.length > 0 ? value : null);\n          }\n        }\n      });\n      htmlParser.addAttributeFilter('class', function (nodes) {\n        var i = nodes.length, node, value;\n        while (i--) {\n          node = nodes[i];\n          value = node.attr('class');\n          if (value) {\n            value = node.attr('class').replace(/(?:^|\\s)mce-item-\\w+(?!\\S)/g, '');\n            node.attr('class', value.length > 0 ? value : null);\n          }\n        }\n      });\n      htmlParser.addAttributeFilter('data-mce-type', function (nodes, name, args) {\n        var i = nodes.length, node;\n        while (i--) {\n          node = nodes[i];\n          if (node.attr('data-mce-type') === 'bookmark' && !args.cleanup) {\n            var hasChildren = Option.from(node.firstChild).exists(function (firstChild) {\n              return !Zwsp.isZwsp(firstChild.value);\n            });\n            if (hasChildren) {\n              node.unwrap();\n            } else {\n              node.remove();\n            }\n          }\n        }\n      });\n      htmlParser.addNodeFilter('noscript', function (nodes) {\n        var i = nodes.length, node;\n        while (i--) {\n          node = nodes[i].firstChild;\n          if (node) {\n            node.value = Entities.decode(node.value);\n          }\n        }\n      });\n      htmlParser.addNodeFilter('script,style', function (nodes, name) {\n        var i = nodes.length, node, value, type;\n        var trim = function (value) {\n          return value.replace(/(<!--\\[CDATA\\[|\\]\\]-->)/g, '\\n').replace(/^[\\r\\n]*|[\\r\\n]*$/g, '').replace(/^\\s*((<!--)?(\\s*\\/\\/)?\\s*<!\\[CDATA\\[|(<!--\\s*)?\\/\\*\\s*<!\\[CDATA\\[\\s*\\*\\/|(\\/\\/)?\\s*<!--|\\/\\*\\s*<!--\\s*\\*\\/)\\s*[\\r\\n]*/gi, '').replace(/\\s*(\\/\\*\\s*\\]\\]>\\s*\\*\\/(-->)?|\\s*\\/\\/\\s*\\]\\]>(-->)?|\\/\\/\\s*(-->)?|\\]\\]>|\\/\\*\\s*-->\\s*\\*\\/|\\s*-->\\s*)\\s*$/g, '');\n        };\n        while (i--) {\n          node = nodes[i];\n          value = node.firstChild ? node.firstChild.value : '';\n          if (name === 'script') {\n            type = node.attr('type');\n            if (type) {\n              node.attr('type', type === 'mce-no/type' ? null : type.replace(/^mce\\-/, ''));\n            }\n            if (settings.element_format === 'xhtml' && value.length > 0) {\n              node.firstChild.value = '// <![CDATA[\\n' + trim(value) + '\\n// ]]>';\n            }\n          } else {\n            if (settings.element_format === 'xhtml' && value.length > 0) {\n              node.firstChild.value = '<!--\\n' + trim(value) + '\\n-->';\n            }\n          }\n        }\n      });\n      htmlParser.addNodeFilter('#comment', function (nodes) {\n        var i = nodes.length, node;\n        while (i--) {\n          node = nodes[i];\n          if (settings.preserve_cdata && node.value.indexOf('[CDATA[') === 0) {\n            node.name = '#cdata';\n            node.type = 4;\n            node.value = dom.decode(node.value.replace(/^\\[CDATA\\[|\\]\\]$/g, ''));\n          } else if (node.value.indexOf('mce:protected ') === 0) {\n            node.name = '#text';\n            node.type = 3;\n            node.raw = true;\n            node.value = unescape(node.value).substr(14);\n          }\n        }\n      });\n      htmlParser.addNodeFilter('xml:namespace,input', function (nodes, name) {\n        var i = nodes.length, node;\n        while (i--) {\n          node = nodes[i];\n          if (node.type === 7) {\n            node.remove();\n          } else if (node.type === 1) {\n            if (name === 'input' && !node.attr('type')) {\n              node.attr('type', 'text');\n            }\n          }\n        }\n      });\n      htmlParser.addAttributeFilter('data-mce-type', function (nodes) {\n        each(nodes, function (node) {\n          if (node.attr('data-mce-type') === 'format-caret') {\n            if (node.isEmpty(htmlParser.schema.getNonEmptyElements())) {\n              node.remove();\n            } else {\n              node.unwrap();\n            }\n          }\n        });\n      });\n      htmlParser.addAttributeFilter('data-mce-src,data-mce-href,data-mce-style,' + 'data-mce-selected,data-mce-expando,' + 'data-mce-type,data-mce-resize,data-mce-placeholder', function (nodes, name) {\n        var i = nodes.length;\n        while (i--) {\n          nodes[i].attr(name, null);\n        }\n      });\n    };\n    var trimTrailingBr = function (rootNode) {\n      var brNode1, brNode2;\n      var isBr = function (node) {\n        return node && node.name === 'br';\n      };\n      brNode1 = rootNode.lastChild;\n      if (isBr(brNode1)) {\n        brNode2 = brNode1.prev;\n        if (isBr(brNode2)) {\n          brNode1.remove();\n          brNode2.remove();\n        }\n      }\n    };\n    var DomSerializerFilters = {\n      register: register$3,\n      trimTrailingBr: trimTrailingBr\n    };\n\n    var preProcess = function (editor, node, args) {\n      var impl, doc, oldDoc;\n      var dom = editor.dom;\n      node = node.cloneNode(true);\n      impl = domGlobals.document.implementation;\n      if (impl.createHTMLDocument) {\n        doc = impl.createHTMLDocument('');\n        Tools.each(node.nodeName === 'BODY' ? node.childNodes : [node], function (node) {\n          doc.body.appendChild(doc.importNode(node, true));\n        });\n        if (node.nodeName !== 'BODY') {\n          node = doc.body.firstChild;\n        } else {\n          node = doc.body;\n        }\n        oldDoc = dom.doc;\n        dom.doc = doc;\n      }\n      firePreProcess(editor, __assign(__assign({}, args), { node: node }));\n      if (oldDoc) {\n        dom.doc = oldDoc;\n      }\n      return node;\n    };\n    var shouldFireEvent = function (editor, args) {\n      return editor && editor.hasEventListeners('PreProcess') && !args.no_events;\n    };\n    var process = function (editor, node, args) {\n      return shouldFireEvent(editor, args) ? preProcess(editor, node, args) : node;\n    };\n    var DomSerializerPreProcess = { process: process };\n\n    var addTempAttr = function (htmlParser, tempAttrs, name) {\n      if (Tools.inArray(tempAttrs, name) === -1) {\n        htmlParser.addAttributeFilter(name, function (nodes, name) {\n          var i = nodes.length;\n          while (i--) {\n            nodes[i].attr(name, null);\n          }\n        });\n        tempAttrs.push(name);\n      }\n    };\n    var postProcess = function (editor, args, content) {\n      if (!args.no_events && editor) {\n        var outArgs = firePostProcess(editor, __assign(__assign({}, args), { content: content }));\n        return outArgs.content;\n      } else {\n        return content;\n      }\n    };\n    var getHtmlFromNode = function (dom, node, args) {\n      var html = Zwsp.trim(args.getInner ? node.innerHTML : dom.getOuterHTML(node));\n      return args.selection || isWsPreserveElement(Element.fromDom(node)) ? html : Tools.trim(html);\n    };\n    var parseHtml = function (htmlParser, html, args) {\n      var parserArgs = args.selection ? __assign({ forced_root_block: false }, args) : args;\n      var rootNode = htmlParser.parse(html, parserArgs);\n      DomSerializerFilters.trimTrailingBr(rootNode);\n      return rootNode;\n    };\n    var serializeNode = function (settings, schema, node) {\n      var htmlSerializer = Serializer(settings, schema);\n      return htmlSerializer.serialize(node);\n    };\n    var toHtml = function (editor, settings, schema, rootNode, args) {\n      var content = serializeNode(settings, schema, rootNode);\n      return postProcess(editor, args, content);\n    };\n    var DomSerializer = function (settings, editor) {\n      var tempAttrs = ['data-mce-selected'];\n      var dom = editor && editor.dom ? editor.dom : DOMUtils$1.DOM;\n      var schema = editor && editor.schema ? editor.schema : Schema(settings);\n      settings.entity_encoding = settings.entity_encoding || 'named';\n      settings.remove_trailing_brs = 'remove_trailing_brs' in settings ? settings.remove_trailing_brs : true;\n      var htmlParser = DomParser(settings, schema);\n      DomSerializerFilters.register(htmlParser, settings, dom);\n      var serialize = function (node, parserArgs) {\n        if (parserArgs === void 0) {\n          parserArgs = {};\n        }\n        var args = __assign({ format: 'html' }, parserArgs);\n        var targetNode = DomSerializerPreProcess.process(editor, node, args);\n        var html = getHtmlFromNode(dom, targetNode, args);\n        var rootNode = parseHtml(htmlParser, html, args);\n        return args.format === 'tree' ? rootNode : toHtml(editor, settings, schema, rootNode, args);\n      };\n      return {\n        schema: schema,\n        addNodeFilter: htmlParser.addNodeFilter,\n        addAttributeFilter: htmlParser.addAttributeFilter,\n        serialize: serialize,\n        addRules: function (rules) {\n          schema.addValidElements(rules);\n        },\n        setRules: function (rules) {\n          schema.setValidElements(rules);\n        },\n        addTempAttr: curry(addTempAttr, htmlParser, tempAttrs),\n        getTempAttrs: function () {\n          return tempAttrs;\n        },\n        getNodeFilters: htmlParser.getNodeFilters,\n        getAttributeFilters: htmlParser.getAttributeFilters\n      };\n    };\n\n    var Serializer$1 = function (settings, editor) {\n      var domSerializer = DomSerializer(settings, editor);\n      return {\n        schema: domSerializer.schema,\n        addNodeFilter: domSerializer.addNodeFilter,\n        addAttributeFilter: domSerializer.addAttributeFilter,\n        serialize: domSerializer.serialize,\n        addRules: domSerializer.addRules,\n        setRules: domSerializer.setRules,\n        addTempAttr: domSerializer.addTempAttr,\n        getTempAttrs: domSerializer.getTempAttrs,\n        getNodeFilters: domSerializer.getNodeFilters,\n        getAttributeFilters: domSerializer.getAttributeFilters\n      };\n    };\n\n    var blobUriToBlob = function (url) {\n      return new promiseObj(function (resolve, reject) {\n        var rejectWithError = function () {\n          reject('Cannot convert ' + url + ' to Blob. Resource might not exist or is inaccessible.');\n        };\n        try {\n          var xhr = new domGlobals.XMLHttpRequest();\n          xhr.open('GET', url, true);\n          xhr.responseType = 'blob';\n          xhr.onload = function () {\n            if (this.status === 200) {\n              resolve(this.response);\n            } else {\n              rejectWithError();\n            }\n          };\n          xhr.onerror = rejectWithError;\n          xhr.send();\n        } catch (ex) {\n          rejectWithError();\n        }\n      });\n    };\n    var parseDataUri = function (uri) {\n      var type, matches;\n      var uriParts = decodeURIComponent(uri).split(',');\n      matches = /data:([^;]+)/.exec(uriParts[0]);\n      if (matches) {\n        type = matches[1];\n      }\n      return {\n        type: type,\n        data: uriParts[1]\n      };\n    };\n    var dataUriToBlob = function (uri) {\n      return new promiseObj(function (resolve) {\n        var str, arr, i;\n        var uriParts = parseDataUri(uri);\n        try {\n          str = domGlobals.atob(uriParts.data);\n        } catch (e) {\n          resolve(new domGlobals.Blob([]));\n          return;\n        }\n        arr = new Uint8Array(str.length);\n        for (i = 0; i < arr.length; i++) {\n          arr[i] = str.charCodeAt(i);\n        }\n        resolve(new domGlobals.Blob([arr], { type: uriParts.type }));\n      });\n    };\n    var uriToBlob = function (url) {\n      if (url.indexOf('blob:') === 0) {\n        return blobUriToBlob(url);\n      }\n      if (url.indexOf('data:') === 0) {\n        return dataUriToBlob(url);\n      }\n      return null;\n    };\n    var blobToDataUri = function (blob) {\n      return new promiseObj(function (resolve) {\n        var reader = new domGlobals.FileReader();\n        reader.onloadend = function () {\n          resolve(reader.result);\n        };\n        reader.readAsDataURL(blob);\n      });\n    };\n    var Conversions = {\n      uriToBlob: uriToBlob,\n      blobToDataUri: blobToDataUri,\n      parseDataUri: parseDataUri\n    };\n\n    var count = 0;\n    var uniqueId = function (prefix) {\n      return (prefix || 'blobid') + count++;\n    };\n    var imageToBlobInfo = function (blobCache, img, resolve, reject) {\n      var base64, blobInfo;\n      if (img.src.indexOf('blob:') === 0) {\n        blobInfo = blobCache.getByUri(img.src);\n        if (blobInfo) {\n          resolve({\n            image: img,\n            blobInfo: blobInfo\n          });\n        } else {\n          Conversions.uriToBlob(img.src).then(function (blob) {\n            Conversions.blobToDataUri(blob).then(function (dataUri) {\n              base64 = Conversions.parseDataUri(dataUri).data;\n              blobInfo = blobCache.create(uniqueId(), blob, base64);\n              blobCache.add(blobInfo);\n              resolve({\n                image: img,\n                blobInfo: blobInfo\n              });\n            });\n          }, function (err) {\n            reject(err);\n          });\n        }\n        return;\n      }\n      base64 = Conversions.parseDataUri(img.src).data;\n      blobInfo = blobCache.findFirst(function (cachedBlobInfo) {\n        return cachedBlobInfo.base64() === base64;\n      });\n      if (blobInfo) {\n        resolve({\n          image: img,\n          blobInfo: blobInfo\n        });\n      } else {\n        Conversions.uriToBlob(img.src).then(function (blob) {\n          blobInfo = blobCache.create(uniqueId(), blob, base64);\n          blobCache.add(blobInfo);\n          resolve({\n            image: img,\n            blobInfo: blobInfo\n          });\n        }, function (err) {\n          reject(err);\n        });\n      }\n    };\n    var getAllImages = function (elm) {\n      return elm ? from$1(elm.getElementsByTagName('img')) : [];\n    };\n    function ImageScanner(uploadStatus, blobCache) {\n      var cachedPromises = {};\n      var findAll = function (elm, predicate) {\n        var images;\n        if (!predicate) {\n          predicate = constant(true);\n        }\n        images = filter(getAllImages(elm), function (img) {\n          var src = img.src;\n          if (!Env.fileApi) {\n            return false;\n          }\n          if (img.hasAttribute('data-mce-bogus')) {\n            return false;\n          }\n          if (img.hasAttribute('data-mce-placeholder')) {\n            return false;\n          }\n          if (!src || src === Env.transparentSrc) {\n            return false;\n          }\n          if (src.indexOf('blob:') === 0) {\n            return !uploadStatus.isUploaded(src) && predicate(img);\n          }\n          if (src.indexOf('data:') === 0) {\n            return predicate(img);\n          }\n          return false;\n        });\n        var promises = map(images, function (img) {\n          if (cachedPromises[img.src]) {\n            return new promiseObj(function (resolve) {\n              cachedPromises[img.src].then(function (imageInfo) {\n                if (typeof imageInfo === 'string') {\n                  return imageInfo;\n                }\n                resolve({\n                  image: img,\n                  blobInfo: imageInfo.blobInfo\n                });\n              });\n            });\n          }\n          var newPromise = new promiseObj(function (resolve, reject) {\n            imageToBlobInfo(blobCache, img, resolve, reject);\n          }).then(function (result) {\n            delete cachedPromises[result.image.src];\n            return result;\n          }).catch(function (error) {\n            delete cachedPromises[img.src];\n            return error;\n          });\n          cachedPromises[img.src] = newPromise;\n          return newPromise;\n        });\n        return promiseObj.all(promises);\n      };\n      return { findAll: findAll };\n    }\n\n    function Uploader(uploadStatus, settings) {\n      var pendingPromises = {};\n      var pathJoin = function (path1, path2) {\n        if (path1) {\n          return path1.replace(/\\/$/, '') + '/' + path2.replace(/^\\//, '');\n        }\n        return path2;\n      };\n      var defaultHandler = function (blobInfo, success, failure, progress) {\n        var xhr, formData;\n        xhr = new domGlobals.XMLHttpRequest();\n        xhr.open('POST', settings.url);\n        xhr.withCredentials = settings.credentials;\n        xhr.upload.onprogress = function (e) {\n          progress(e.loaded / e.total * 100);\n        };\n        xhr.onerror = function () {\n          failure('Image upload failed due to a XHR Transport error. Code: ' + xhr.status);\n        };\n        xhr.onload = function () {\n          var json;\n          if (xhr.status < 200 || xhr.status >= 300) {\n            failure('HTTP Error: ' + xhr.status);\n            return;\n          }\n          json = JSON.parse(xhr.responseText);\n          if (!json || typeof json.location !== 'string') {\n            failure('Invalid JSON: ' + xhr.responseText);\n            return;\n          }\n          success(pathJoin(settings.basePath, json.location));\n        };\n        formData = new domGlobals.FormData();\n        formData.append('file', blobInfo.blob(), blobInfo.filename());\n        xhr.send(formData);\n      };\n      var noUpload = function () {\n        return new promiseObj(function (resolve) {\n          resolve([]);\n        });\n      };\n      var handlerSuccess = function (blobInfo, url) {\n        return {\n          url: url,\n          blobInfo: blobInfo,\n          status: true\n        };\n      };\n      var handlerFailure = function (blobInfo, error) {\n        return {\n          url: '',\n          blobInfo: blobInfo,\n          status: false,\n          error: error\n        };\n      };\n      var resolvePending = function (blobUri, result) {\n        Tools.each(pendingPromises[blobUri], function (resolve) {\n          resolve(result);\n        });\n        delete pendingPromises[blobUri];\n      };\n      var uploadBlobInfo = function (blobInfo, handler, openNotification) {\n        uploadStatus.markPending(blobInfo.blobUri());\n        return new promiseObj(function (resolve) {\n          var notification, progress;\n          var noop = function () {\n          };\n          try {\n            var closeNotification_1 = function () {\n              if (notification) {\n                notification.close();\n                progress = noop;\n              }\n            };\n            var success = function (url) {\n              closeNotification_1();\n              uploadStatus.markUploaded(blobInfo.blobUri(), url);\n              resolvePending(blobInfo.blobUri(), handlerSuccess(blobInfo, url));\n              resolve(handlerSuccess(blobInfo, url));\n            };\n            var failure = function (error) {\n              closeNotification_1();\n              uploadStatus.removeFailed(blobInfo.blobUri());\n              resolvePending(blobInfo.blobUri(), handlerFailure(blobInfo, error));\n              resolve(handlerFailure(blobInfo, error));\n            };\n            progress = function (percent) {\n              if (percent < 0 || percent > 100) {\n                return;\n              }\n              if (!notification) {\n                notification = openNotification();\n              }\n              notification.progressBar.value(percent);\n            };\n            handler(blobInfo, success, failure, progress);\n          } catch (ex) {\n            resolve(handlerFailure(blobInfo, ex.message));\n          }\n        });\n      };\n      var isDefaultHandler = function (handler) {\n        return handler === defaultHandler;\n      };\n      var pendingUploadBlobInfo = function (blobInfo) {\n        var blobUri = blobInfo.blobUri();\n        return new promiseObj(function (resolve) {\n          pendingPromises[blobUri] = pendingPromises[blobUri] || [];\n          pendingPromises[blobUri].push(resolve);\n        });\n      };\n      var uploadBlobs = function (blobInfos, openNotification) {\n        blobInfos = Tools.grep(blobInfos, function (blobInfo) {\n          return !uploadStatus.isUploaded(blobInfo.blobUri());\n        });\n        return promiseObj.all(Tools.map(blobInfos, function (blobInfo) {\n          return uploadStatus.isPending(blobInfo.blobUri()) ? pendingUploadBlobInfo(blobInfo) : uploadBlobInfo(blobInfo, settings.handler, openNotification);\n        }));\n      };\n      var upload = function (blobInfos, openNotification) {\n        return !settings.url && isDefaultHandler(settings.handler) ? noUpload() : uploadBlobs(blobInfos, openNotification);\n      };\n      if (isFunction(settings.handler) === false) {\n        settings.handler = defaultHandler;\n      }\n      return { upload: upload };\n    }\n\n    function UploadStatus () {\n      var PENDING = 1, UPLOADED = 2;\n      var blobUriStatuses = {};\n      var createStatus = function (status, resultUri) {\n        return {\n          status: status,\n          resultUri: resultUri\n        };\n      };\n      var hasBlobUri = function (blobUri) {\n        return blobUri in blobUriStatuses;\n      };\n      var getResultUri = function (blobUri) {\n        var result = blobUriStatuses[blobUri];\n        return result ? result.resultUri : null;\n      };\n      var isPending = function (blobUri) {\n        return hasBlobUri(blobUri) ? blobUriStatuses[blobUri].status === PENDING : false;\n      };\n      var isUploaded = function (blobUri) {\n        return hasBlobUri(blobUri) ? blobUriStatuses[blobUri].status === UPLOADED : false;\n      };\n      var markPending = function (blobUri) {\n        blobUriStatuses[blobUri] = createStatus(PENDING, null);\n      };\n      var markUploaded = function (blobUri, resultUri) {\n        blobUriStatuses[blobUri] = createStatus(UPLOADED, resultUri);\n      };\n      var removeFailed = function (blobUri) {\n        delete blobUriStatuses[blobUri];\n      };\n      var destroy = function () {\n        blobUriStatuses = {};\n      };\n      return {\n        hasBlobUri: hasBlobUri,\n        getResultUri: getResultUri,\n        isPending: isPending,\n        isUploaded: isUploaded,\n        markPending: markPending,\n        markUploaded: markUploaded,\n        removeFailed: removeFailed,\n        destroy: destroy\n      };\n    }\n\n    var count$1 = 0;\n    var seed = function () {\n      var rnd = function () {\n        return Math.round(Math.random() * 4294967295).toString(36);\n      };\n      var now = new Date().getTime();\n      return 's' + now.toString(36) + rnd() + rnd() + rnd();\n    };\n    var uuid = function (prefix) {\n      return prefix + count$1++ + seed();\n    };\n    var Uuid = { uuid: uuid };\n\n    var BlobCache = function () {\n      var cache = [];\n      var mimeToExt = function (mime) {\n        var mimes = {\n          'image/jpeg': 'jpg',\n          'image/jpg': 'jpg',\n          'image/gif': 'gif',\n          'image/png': 'png'\n        };\n        return mimes[mime.toLowerCase()] || 'dat';\n      };\n      var create = function (o, blob, base64, filename) {\n        if (isString(o)) {\n          var id = o;\n          return toBlobInfo({\n            id: id,\n            name: filename,\n            blob: blob,\n            base64: base64\n          });\n        } else if (isObject(o)) {\n          return toBlobInfo(o);\n        } else {\n          throw new Error('Unknown input type');\n        }\n      };\n      var toBlobInfo = function (o) {\n        var id, name;\n        if (!o.blob || !o.base64) {\n          throw new Error('blob and base64 representations of the image are required for BlobInfo to be created');\n        }\n        id = o.id || Uuid.uuid('blobid');\n        name = o.name || id;\n        return {\n          id: constant(id),\n          name: constant(name),\n          filename: constant(name + '.' + mimeToExt(o.blob.type)),\n          blob: constant(o.blob),\n          base64: constant(o.base64),\n          blobUri: constant(o.blobUri || domGlobals.URL.createObjectURL(o.blob)),\n          uri: constant(o.uri)\n        };\n      };\n      var add = function (blobInfo) {\n        if (!get(blobInfo.id())) {\n          cache.push(blobInfo);\n        }\n      };\n      var get = function (id) {\n        return findFirst(function (cachedBlobInfo) {\n          return cachedBlobInfo.id() === id;\n        });\n      };\n      var findFirst = function (predicate) {\n        return filter(cache, predicate)[0];\n      };\n      var getByUri = function (blobUri) {\n        return findFirst(function (blobInfo) {\n          return blobInfo.blobUri() === blobUri;\n        });\n      };\n      var removeByUri = function (blobUri) {\n        cache = filter(cache, function (blobInfo) {\n          if (blobInfo.blobUri() === blobUri) {\n            domGlobals.URL.revokeObjectURL(blobInfo.blobUri());\n            return false;\n          }\n          return true;\n        });\n      };\n      var destroy = function () {\n        each(cache, function (cachedBlobInfo) {\n          domGlobals.URL.revokeObjectURL(cachedBlobInfo.blobUri());\n        });\n        cache = [];\n      };\n      return {\n        create: create,\n        add: add,\n        get: get,\n        getByUri: getByUri,\n        findFirst: findFirst,\n        removeByUri: removeByUri,\n        destroy: destroy\n      };\n    };\n\n    var EditorUpload = function (editor) {\n      var blobCache = BlobCache();\n      var uploader, imageScanner;\n      var uploadStatus = UploadStatus();\n      var urlFilters = [];\n      var aliveGuard = function (callback) {\n        return function (result) {\n          if (editor.selection) {\n            return callback(result);\n          }\n          return [];\n        };\n      };\n      var cacheInvalidator = function (url) {\n        return url + (url.indexOf('?') === -1 ? '?' : '&') + new Date().getTime();\n      };\n      var replaceString = function (content, search, replace) {\n        var index = 0;\n        do {\n          index = content.indexOf(search, index);\n          if (index !== -1) {\n            content = content.substring(0, index) + replace + content.substr(index + search.length);\n            index += replace.length - search.length + 1;\n          }\n        } while (index !== -1);\n        return content;\n      };\n      var replaceImageUrl = function (content, targetUrl, replacementUrl) {\n        content = replaceString(content, 'src=\"' + targetUrl + '\"', 'src=\"' + replacementUrl + '\"');\n        content = replaceString(content, 'data-mce-src=\"' + targetUrl + '\"', 'data-mce-src=\"' + replacementUrl + '\"');\n        return content;\n      };\n      var replaceUrlInUndoStack = function (targetUrl, replacementUrl) {\n        each(editor.undoManager.data, function (level) {\n          if (level.type === 'fragmented') {\n            level.fragments = map(level.fragments, function (fragment) {\n              return replaceImageUrl(fragment, targetUrl, replacementUrl);\n            });\n          } else {\n            level.content = replaceImageUrl(level.content, targetUrl, replacementUrl);\n          }\n        });\n      };\n      var openNotification = function () {\n        return editor.notificationManager.open({\n          text: editor.translate('Image uploading...'),\n          type: 'info',\n          timeout: -1,\n          progressBar: true\n        });\n      };\n      var replaceImageUri = function (image, resultUri) {\n        blobCache.removeByUri(image.src);\n        replaceUrlInUndoStack(image.src, resultUri);\n        editor.$(image).attr({\n          'src': Settings.shouldReuseFileName(editor) ? cacheInvalidator(resultUri) : resultUri,\n          'data-mce-src': editor.convertURL(resultUri, 'src')\n        });\n      };\n      var uploadImages = function (callback) {\n        if (!uploader) {\n          uploader = Uploader(uploadStatus, {\n            url: Settings.getImageUploadUrl(editor),\n            basePath: Settings.getImageUploadBasePath(editor),\n            credentials: Settings.getImagesUploadCredentials(editor),\n            handler: Settings.getImagesUploadHandler(editor)\n          });\n        }\n        return scanForImages().then(aliveGuard(function (imageInfos) {\n          var blobInfos = map(imageInfos, function (imageInfo) {\n            return imageInfo.blobInfo;\n          });\n          return uploader.upload(blobInfos, openNotification).then(aliveGuard(function (result) {\n            var filteredResult = map(result, function (uploadInfo, index) {\n              var image = imageInfos[index].image;\n              if (uploadInfo.status && Settings.shouldReplaceBlobUris(editor)) {\n                replaceImageUri(image, uploadInfo.url);\n              } else if (uploadInfo.error) {\n                ErrorReporter.uploadError(editor, uploadInfo.error);\n              }\n              return {\n                element: image,\n                status: uploadInfo.status\n              };\n            });\n            if (callback) {\n              callback(filteredResult);\n            }\n            return filteredResult;\n          }));\n        }));\n      };\n      var uploadImagesAuto = function (callback) {\n        if (Settings.isAutomaticUploadsEnabled(editor)) {\n          return uploadImages(callback);\n        }\n      };\n      var isValidDataUriImage = function (imgElm) {\n        if (forall(urlFilters, function (filter) {\n            return filter(imgElm);\n          }) === false) {\n          return false;\n        }\n        if (imgElm.getAttribute('src').indexOf('data:') === 0) {\n          var dataImgFilter = Settings.getImagesDataImgFilter(editor);\n          return dataImgFilter(imgElm);\n        }\n        return true;\n      };\n      var addFilter = function (filter) {\n        urlFilters.push(filter);\n      };\n      var scanForImages = function () {\n        if (!imageScanner) {\n          imageScanner = ImageScanner(uploadStatus, blobCache);\n        }\n        return imageScanner.findAll(editor.getBody(), isValidDataUriImage).then(aliveGuard(function (result) {\n          result = filter(result, function (resultItem) {\n            if (typeof resultItem === 'string') {\n              ErrorReporter.displayError(editor, resultItem);\n              return false;\n            }\n            return true;\n          });\n          each(result, function (resultItem) {\n            replaceUrlInUndoStack(resultItem.image.src, resultItem.blobInfo.blobUri());\n            resultItem.image.src = resultItem.blobInfo.blobUri();\n            resultItem.image.removeAttribute('data-mce-src');\n          });\n          return result;\n        }));\n      };\n      var destroy = function () {\n        blobCache.destroy();\n        uploadStatus.destroy();\n        imageScanner = uploader = null;\n      };\n      var replaceBlobUris = function (content) {\n        return content.replace(/src=\"(blob:[^\"]+)\"/g, function (match, blobUri) {\n          var resultUri = uploadStatus.getResultUri(blobUri);\n          if (resultUri) {\n            return 'src=\"' + resultUri + '\"';\n          }\n          var blobInfo = blobCache.getByUri(blobUri);\n          if (!blobInfo) {\n            blobInfo = foldl(editor.editorManager.get(), function (result, editor) {\n              return result || editor.editorUpload && editor.editorUpload.blobCache.getByUri(blobUri);\n            }, null);\n          }\n          if (blobInfo) {\n            var blob = blobInfo.blob();\n            return 'src=\"data:' + blob.type + ';base64,' + blobInfo.base64() + '\"';\n          }\n          return match;\n        });\n      };\n      editor.on('SetContent', function () {\n        if (Settings.isAutomaticUploadsEnabled(editor)) {\n          uploadImagesAuto();\n        } else {\n          scanForImages();\n        }\n      });\n      editor.on('RawSaveContent', function (e) {\n        e.content = replaceBlobUris(e.content);\n      });\n      editor.on('GetContent', function (e) {\n        if (e.source_view || e.format === 'raw') {\n          return;\n        }\n        e.content = replaceBlobUris(e.content);\n      });\n      editor.on('PostRender', function () {\n        editor.parser.addNodeFilter('img', function (images) {\n          each(images, function (img) {\n            var src = img.attr('src');\n            if (blobCache.getByUri(src)) {\n              return;\n            }\n            var resultUri = uploadStatus.getResultUri(src);\n            if (resultUri) {\n              img.attr('src', resultUri);\n            }\n          });\n        });\n      });\n      return {\n        blobCache: blobCache,\n        addFilter: addFilter,\n        uploadImages: uploadImages,\n        uploadImagesAuto: uploadImagesAuto,\n        scanForImages: scanForImages,\n        destroy: destroy\n      };\n    };\n\n    var getLastChildren$1 = function (elm) {\n      var children = [];\n      var rawNode = elm.dom();\n      while (rawNode) {\n        children.push(Element.fromDom(rawNode));\n        rawNode = rawNode.lastChild;\n      }\n      return children;\n    };\n    var removeTrailingBr = function (elm) {\n      var allBrs = descendants$1(elm, 'br');\n      var brs = filter(getLastChildren$1(elm).slice(-1), isBr$1);\n      if (allBrs.length === brs.length) {\n        each(brs, remove);\n      }\n    };\n    var fillWithPaddingBr = function (elm) {\n      empty(elm);\n      append(elm, Element.fromHtml('<br data-mce-bogus=\"1\">'));\n    };\n    var isPaddingContents = function (elm) {\n      return isText(elm) ? get$7(elm) === nbsp : isBr$1(elm);\n    };\n    var isPaddedElement = function (elm) {\n      return filter(children(elm), isPaddingContents).length === 1;\n    };\n    var trimBlockTrailingBr = function (elm) {\n      lastChild(elm).each(function (lastChild) {\n        prevSibling(lastChild).each(function (lastChildPrevSibling) {\n          if (isBlock(elm) && isBr$1(lastChild) && isBlock(lastChildPrevSibling)) {\n            remove(lastChild);\n          }\n        });\n      });\n    };\n    var PaddingBr = {\n      removeTrailingBr: removeTrailingBr,\n      fillWithPaddingBr: fillWithPaddingBr,\n      isPaddedElement: isPaddedElement,\n      trimBlockTrailingBr: trimBlockTrailingBr\n    };\n\n    var isEq$2 = isEq;\n    var matchesUnInheritedFormatSelector = function (ed, node, name) {\n      var formatList = ed.formatter.get(name);\n      if (formatList) {\n        for (var i = 0; i < formatList.length; i++) {\n          if (formatList[i].inherit === false && ed.dom.is(node, formatList[i].selector)) {\n            return true;\n          }\n        }\n      }\n      return false;\n    };\n    var matchParents = function (editor, node, name, vars) {\n      var root = editor.dom.getRoot();\n      if (node === root) {\n        return false;\n      }\n      node = editor.dom.getParent(node, function (node) {\n        if (matchesUnInheritedFormatSelector(editor, node, name)) {\n          return true;\n        }\n        return node.parentNode === root || !!matchNode(editor, node, name, vars, true);\n      });\n      return matchNode(editor, node, name, vars);\n    };\n    var matchName = function (dom, node, format) {\n      if (isEq$2(node, format.inline)) {\n        return true;\n      }\n      if (isEq$2(node, format.block)) {\n        return true;\n      }\n      if (format.selector) {\n        return node.nodeType === 1 && dom.is(node, format.selector);\n      }\n    };\n    var matchItems = function (dom, node, format, itemName, similar, vars) {\n      var key, value;\n      var items = format[itemName];\n      var i;\n      if (format.onmatch) {\n        return format.onmatch(node, format, itemName);\n      }\n      if (items) {\n        if (typeof items.length === 'undefined') {\n          for (key in items) {\n            if (items.hasOwnProperty(key)) {\n              if (itemName === 'attributes') {\n                value = dom.getAttrib(node, key);\n              } else {\n                value = getStyle(dom, node, key);\n              }\n              if (similar && !value && !format.exact) {\n                return;\n              }\n              if ((!similar || format.exact) && !isEq$2(value, normalizeStyleValue(dom, replaceVars(items[key], vars), key))) {\n                return;\n              }\n            }\n          }\n        } else {\n          for (i = 0; i < items.length; i++) {\n            if (itemName === 'attributes' ? dom.getAttrib(node, items[i]) : getStyle(dom, node, items[i])) {\n              return format;\n            }\n          }\n        }\n      }\n      return format;\n    };\n    var matchNode = function (ed, node, name, vars, similar) {\n      var formatList = ed.formatter.get(name);\n      var format, i, x, classes;\n      var dom = ed.dom;\n      if (formatList && node) {\n        for (i = 0; i < formatList.length; i++) {\n          format = formatList[i];\n          if (matchName(ed.dom, node, format) && matchItems(dom, node, format, 'attributes', similar, vars) && matchItems(dom, node, format, 'styles', similar, vars)) {\n            if (classes = format.classes) {\n              for (x = 0; x < classes.length; x++) {\n                if (!ed.dom.hasClass(node, classes[x])) {\n                  return;\n                }\n              }\n            }\n            return format;\n          }\n        }\n      }\n    };\n    var match = function (editor, name, vars, node) {\n      var startNode;\n      if (node) {\n        return matchParents(editor, node, name, vars);\n      }\n      node = editor.selection.getNode();\n      if (matchParents(editor, node, name, vars)) {\n        return true;\n      }\n      startNode = editor.selection.getStart();\n      if (startNode !== node) {\n        if (matchParents(editor, startNode, name, vars)) {\n          return true;\n        }\n      }\n      return false;\n    };\n    var matchAll = function (editor, names, vars) {\n      var startElement;\n      var matchedFormatNames = [];\n      var checkedMap = {};\n      startElement = editor.selection.getStart();\n      editor.dom.getParent(startElement, function (node) {\n        var i, name;\n        for (i = 0; i < names.length; i++) {\n          name = names[i];\n          if (!checkedMap[name] && matchNode(editor, node, name, vars)) {\n            checkedMap[name] = true;\n            matchedFormatNames.push(name);\n          }\n        }\n      }, editor.dom.getRoot());\n      return matchedFormatNames;\n    };\n    var canApply = function (editor, name) {\n      var formatList = editor.formatter.get(name);\n      var startNode, parents, i, x, selector;\n      var dom = editor.dom;\n      if (formatList) {\n        startNode = editor.selection.getStart();\n        parents = getParents$1(dom, startNode);\n        for (x = formatList.length - 1; x >= 0; x--) {\n          selector = formatList[x].selector;\n          if (!selector || formatList[x].defaultBlock) {\n            return true;\n          }\n          for (i = parents.length - 1; i >= 0; i--) {\n            if (dom.is(parents[i], selector)) {\n              return true;\n            }\n          }\n        }\n      }\n      return false;\n    };\n\n    var splitText = function (node, offset) {\n      return node.splitText(offset);\n    };\n    var split$1 = function (rng) {\n      var startContainer = rng.startContainer, startOffset = rng.startOffset, endContainer = rng.endContainer, endOffset = rng.endOffset;\n      if (startContainer === endContainer && NodeType.isText(startContainer)) {\n        if (startOffset > 0 && startOffset < startContainer.nodeValue.length) {\n          endContainer = splitText(startContainer, startOffset);\n          startContainer = endContainer.previousSibling;\n          if (endOffset > startOffset) {\n            endOffset = endOffset - startOffset;\n            startContainer = endContainer = splitText(endContainer, endOffset).previousSibling;\n            endOffset = endContainer.nodeValue.length;\n            startOffset = 0;\n          } else {\n            endOffset = 0;\n          }\n        }\n      } else {\n        if (NodeType.isText(startContainer) && startOffset > 0 && startOffset < startContainer.nodeValue.length) {\n          startContainer = splitText(startContainer, startOffset);\n          startOffset = 0;\n        }\n        if (NodeType.isText(endContainer) && endOffset > 0 && endOffset < endContainer.nodeValue.length) {\n          endContainer = splitText(endContainer, endOffset).previousSibling;\n          endOffset = endContainer.nodeValue.length;\n        }\n      }\n      return {\n        startContainer: startContainer,\n        startOffset: startOffset,\n        endContainer: endContainer,\n        endOffset: endOffset\n      };\n    };\n\n    var normalizeContent = function (content, isStartOfContent, isEndOfContent) {\n      var result = foldl(content, function (acc, c) {\n        if (isWhiteSpace$1(c) || isNbsp(c)) {\n          if (acc.previousCharIsSpace || acc.str === '' && isStartOfContent || acc.str.length === content.length - 1 && isEndOfContent) {\n            return {\n              previousCharIsSpace: false,\n              str: acc.str + nbsp\n            };\n          } else {\n            return {\n              previousCharIsSpace: true,\n              str: acc.str + ' '\n            };\n          }\n        } else {\n          return {\n            previousCharIsSpace: false,\n            str: acc.str + c\n          };\n        }\n      }, {\n        previousCharIsSpace: false,\n        str: ''\n      });\n      return result.str;\n    };\n    var normalize$1 = function (node, offset, count) {\n      if (count === 0) {\n        return;\n      }\n      var whitespace = node.data.slice(offset, offset + count);\n      var isEndOfContent = offset + count >= node.data.length;\n      var isStartOfContent = offset === 0;\n      node.replaceData(offset, count, normalizeContent(whitespace, isStartOfContent, isEndOfContent));\n    };\n    var normalizeWhitespaceAfter = function (node, offset) {\n      var content = node.data.slice(offset);\n      var whitespaceCount = content.length - lTrim(content).length;\n      return normalize$1(node, offset, whitespaceCount);\n    };\n    var normalizeWhitespaceBefore = function (node, offset) {\n      var content = node.data.slice(0, offset);\n      var whitespaceCount = content.length - rTrim(content).length;\n      return normalize$1(node, offset - whitespaceCount, whitespaceCount);\n    };\n    var mergeTextNodes = function (prevNode, nextNode, normalizeWhitespace) {\n      var whitespaceOffset = rTrim(prevNode.data).length;\n      prevNode.appendData(nextNode.data);\n      remove(Element.fromDom(nextNode));\n      if (normalizeWhitespace) {\n        normalizeWhitespaceAfter(prevNode, whitespaceOffset);\n      }\n      return prevNode;\n    };\n\n    var ancestor$2 = function (scope, selector, isRoot) {\n      return ancestor$1(scope, selector, isRoot).isSome();\n    };\n\n    var hasWhitespacePreserveParent = function (rootNode, node) {\n      var rootElement = Element.fromDom(rootNode);\n      var startNode = Element.fromDom(node);\n      return ancestor$2(startNode, 'pre,code', curry(eq, rootElement));\n    };\n    var isWhitespace = function (rootNode, node) {\n      return NodeType.isText(node) && /^[ \\t\\r\\n]*$/.test(node.data) && hasWhitespacePreserveParent(rootNode, node) === false;\n    };\n    var isNamedAnchor = function (node) {\n      return NodeType.isElement(node) && node.nodeName === 'A' && node.hasAttribute('name');\n    };\n    var isContent$1 = function (rootNode, node) {\n      return isCaretCandidate(node) && isWhitespace(rootNode, node) === false || isNamedAnchor(node) || isBookmark(node);\n    };\n    var isBookmark = NodeType.hasAttribute('data-mce-bookmark');\n    var isBogus$2 = NodeType.hasAttribute('data-mce-bogus');\n    var isBogusAll$1 = NodeType.hasAttributeValue('data-mce-bogus', 'all');\n    var isEmptyNode = function (targetNode, skipBogus) {\n      var node, brCount = 0;\n      if (isContent$1(targetNode, targetNode)) {\n        return false;\n      } else {\n        node = targetNode.firstChild;\n        if (!node) {\n          return true;\n        }\n        var walker = new TreeWalker(node, targetNode);\n        do {\n          if (skipBogus) {\n            if (isBogusAll$1(node)) {\n              node = walker.next(true);\n              continue;\n            }\n            if (isBogus$2(node)) {\n              node = walker.next();\n              continue;\n            }\n          }\n          if (NodeType.isBr(node)) {\n            brCount++;\n            node = walker.next();\n            continue;\n          }\n          if (isContent$1(targetNode, node)) {\n            return false;\n          }\n          node = walker.next();\n        } while (node);\n        return brCount <= 1;\n      }\n    };\n    var isEmpty$2 = function (elm, skipBogus) {\n      if (skipBogus === void 0) {\n        skipBogus = true;\n      }\n      return isEmptyNode(elm.dom(), skipBogus);\n    };\n    var Empty = { isEmpty: isEmpty$2 };\n\n    var needsReposition = function (pos, elm) {\n      var container = pos.container();\n      var offset = pos.offset();\n      return CaretPosition$1.isTextPosition(pos) === false && container === elm.parentNode && offset > CaretPosition$1.before(elm).offset();\n    };\n    var reposition = function (elm, pos) {\n      return needsReposition(pos, elm) ? CaretPosition$1(pos.container(), pos.offset() - 1) : pos;\n    };\n    var beforeOrStartOf = function (node) {\n      return NodeType.isText(node) ? CaretPosition$1(node, 0) : CaretPosition$1.before(node);\n    };\n    var afterOrEndOf = function (node) {\n      return NodeType.isText(node) ? CaretPosition$1(node, node.data.length) : CaretPosition$1.after(node);\n    };\n    var getPreviousSiblingCaretPosition = function (elm) {\n      if (isCaretCandidate(elm.previousSibling)) {\n        return Option.some(afterOrEndOf(elm.previousSibling));\n      } else {\n        return elm.previousSibling ? CaretFinder.lastPositionIn(elm.previousSibling) : Option.none();\n      }\n    };\n    var getNextSiblingCaretPosition = function (elm) {\n      if (isCaretCandidate(elm.nextSibling)) {\n        return Option.some(beforeOrStartOf(elm.nextSibling));\n      } else {\n        return elm.nextSibling ? CaretFinder.firstPositionIn(elm.nextSibling) : Option.none();\n      }\n    };\n    var findCaretPositionBackwardsFromElm = function (rootElement, elm) {\n      var startPosition = CaretPosition$1.before(elm.previousSibling ? elm.previousSibling : elm.parentNode);\n      return CaretFinder.prevPosition(rootElement, startPosition).fold(function () {\n        return CaretFinder.nextPosition(rootElement, CaretPosition$1.after(elm));\n      }, Option.some);\n    };\n    var findCaretPositionForwardsFromElm = function (rootElement, elm) {\n      return CaretFinder.nextPosition(rootElement, CaretPosition$1.after(elm)).fold(function () {\n        return CaretFinder.prevPosition(rootElement, CaretPosition$1.before(elm));\n      }, Option.some);\n    };\n    var findCaretPositionBackwards = function (rootElement, elm) {\n      return getPreviousSiblingCaretPosition(elm).orThunk(function () {\n        return getNextSiblingCaretPosition(elm);\n      }).orThunk(function () {\n        return findCaretPositionBackwardsFromElm(rootElement, elm);\n      });\n    };\n    var findCaretPositionForward = function (rootElement, elm) {\n      return getNextSiblingCaretPosition(elm).orThunk(function () {\n        return getPreviousSiblingCaretPosition(elm);\n      }).orThunk(function () {\n        return findCaretPositionForwardsFromElm(rootElement, elm);\n      });\n    };\n    var findCaretPosition$1 = function (forward, rootElement, elm) {\n      return forward ? findCaretPositionForward(rootElement, elm) : findCaretPositionBackwards(rootElement, elm);\n    };\n    var findCaretPosOutsideElmAfterDelete = function (forward, rootElement, elm) {\n      return findCaretPosition$1(forward, rootElement, elm).map(curry(reposition, elm));\n    };\n    var setSelection = function (editor, forward, pos) {\n      pos.fold(function () {\n        editor.focus();\n      }, function (pos) {\n        editor.selection.setRng(pos.toRange(), forward);\n      });\n    };\n    var eqRawNode = function (rawNode) {\n      return function (elm) {\n        return elm.dom() === rawNode;\n      };\n    };\n    var isBlock$2 = function (editor, elm) {\n      return elm && editor.schema.getBlockElements().hasOwnProperty(name(elm));\n    };\n    var paddEmptyBlock = function (elm) {\n      if (Empty.isEmpty(elm)) {\n        var br = Element.fromHtml('<br data-mce-bogus=\"1\">');\n        empty(elm);\n        append(elm, br);\n        return Option.some(CaretPosition$1.before(br.dom()));\n      } else {\n        return Option.none();\n      }\n    };\n    var deleteNormalized = function (elm, afterDeletePosOpt, normalizeWhitespace) {\n      var prevTextOpt = prevSibling(elm).filter(isText);\n      var nextTextOpt = nextSibling(elm).filter(isText);\n      remove(elm);\n      return lift3(prevTextOpt, nextTextOpt, afterDeletePosOpt, function (prev, next, pos) {\n        var prevNode = prev.dom(), nextNode = next.dom();\n        var offset = prevNode.data.length;\n        mergeTextNodes(prevNode, nextNode, normalizeWhitespace);\n        return pos.container() === nextNode ? CaretPosition$1(prevNode, offset) : pos;\n      }).orThunk(function () {\n        if (normalizeWhitespace) {\n          prevTextOpt.each(function (elm) {\n            return normalizeWhitespaceBefore(elm.dom(), elm.dom().length);\n          });\n          nextTextOpt.each(function (elm) {\n            return normalizeWhitespaceAfter(elm.dom(), 0);\n          });\n        }\n        return afterDeletePosOpt;\n      });\n    };\n    var isInlineElement = function (editor, element) {\n      return has(editor.schema.getTextInlineElements(), name(element));\n    };\n    var deleteElement = function (editor, forward, elm, moveCaret) {\n      if (moveCaret === void 0) {\n        moveCaret = true;\n      }\n      var afterDeletePos = findCaretPosOutsideElmAfterDelete(forward, editor.getBody(), elm.dom());\n      var parentBlock = ancestor(elm, curry(isBlock$2, editor), eqRawNode(editor.getBody()));\n      var normalizedAfterDeletePos = deleteNormalized(elm, afterDeletePos, isInlineElement(editor, elm));\n      if (editor.dom.isEmpty(editor.getBody())) {\n        editor.setContent('');\n        editor.selection.setCursorLocation();\n      } else {\n        parentBlock.bind(paddEmptyBlock).fold(function () {\n          if (moveCaret) {\n            setSelection(editor, forward, normalizedAfterDeletePos);\n          }\n        }, function (paddPos) {\n          if (moveCaret) {\n            setSelection(editor, forward, Option.some(paddPos));\n          }\n        });\n      }\n    };\n    var DeleteElement = { deleteElement: deleteElement };\n\n    var ZWSP$1 = Zwsp.ZWSP, CARET_ID$1 = '_mce_caret';\n    var importNode = function (ownerDocument, node) {\n      return ownerDocument.importNode(node, true);\n    };\n    var getEmptyCaretContainers = function (node) {\n      var nodes = [];\n      while (node) {\n        if (node.nodeType === 3 && node.nodeValue !== ZWSP$1 || node.childNodes.length > 1) {\n          return [];\n        }\n        if (node.nodeType === 1) {\n          nodes.push(node);\n        }\n        node = node.firstChild;\n      }\n      return nodes;\n    };\n    var isCaretContainerEmpty = function (node) {\n      return getEmptyCaretContainers(node).length > 0;\n    };\n    var findFirstTextNode = function (node) {\n      if (node) {\n        var walker = new TreeWalker(node, node);\n        for (node = walker.current(); node; node = walker.next()) {\n          if (NodeType.isText(node)) {\n            return node;\n          }\n        }\n      }\n      return null;\n    };\n    var createCaretContainer = function (fill) {\n      var caretContainer = Element.fromTag('span');\n      setAll(caretContainer, {\n        'id': CARET_ID$1,\n        'data-mce-bogus': '1',\n        'data-mce-type': 'format-caret'\n      });\n      if (fill) {\n        append(caretContainer, Element.fromText(ZWSP$1));\n      }\n      return caretContainer;\n    };\n    var trimZwspFromCaretContainer = function (caretContainerNode) {\n      var textNode = findFirstTextNode(caretContainerNode);\n      if (textNode && textNode.nodeValue.charAt(0) === ZWSP$1) {\n        textNode.deleteData(0, 1);\n      }\n      return textNode;\n    };\n    var removeCaretContainerNode = function (editor, node, moveCaret) {\n      if (moveCaret === void 0) {\n        moveCaret = true;\n      }\n      var dom = editor.dom, selection = editor.selection;\n      if (isCaretContainerEmpty(node)) {\n        DeleteElement.deleteElement(editor, false, Element.fromDom(node), moveCaret);\n      } else {\n        var rng = selection.getRng();\n        var block = dom.getParent(node, dom.isBlock);\n        var textNode = trimZwspFromCaretContainer(node);\n        if (rng.startContainer === textNode && rng.startOffset > 0) {\n          rng.setStart(textNode, rng.startOffset - 1);\n        }\n        if (rng.endContainer === textNode && rng.endOffset > 0) {\n          rng.setEnd(textNode, rng.endOffset - 1);\n        }\n        dom.remove(node, true);\n        if (block && dom.isEmpty(block)) {\n          PaddingBr.fillWithPaddingBr(Element.fromDom(block));\n        }\n        selection.setRng(rng);\n      }\n    };\n    var removeCaretContainer = function (editor, node, moveCaret) {\n      if (moveCaret === void 0) {\n        moveCaret = true;\n      }\n      var dom = editor.dom, selection = editor.selection;\n      if (!node) {\n        node = getParentCaretContainer(editor.getBody(), selection.getStart());\n        if (!node) {\n          while (node = dom.get(CARET_ID$1)) {\n            removeCaretContainerNode(editor, node, false);\n          }\n        }\n      } else {\n        removeCaretContainerNode(editor, node, moveCaret);\n      }\n    };\n    var insertCaretContainerNode = function (editor, caretContainer, formatNode) {\n      var dom = editor.dom, block = dom.getParent(formatNode, curry(isTextBlock$1, editor));\n      if (block && dom.isEmpty(block)) {\n        formatNode.parentNode.replaceChild(caretContainer, formatNode);\n      } else {\n        PaddingBr.removeTrailingBr(Element.fromDom(formatNode));\n        if (dom.isEmpty(formatNode)) {\n          formatNode.parentNode.replaceChild(caretContainer, formatNode);\n        } else {\n          dom.insertAfter(caretContainer, formatNode);\n        }\n      }\n    };\n    var appendNode = function (parentNode, node) {\n      parentNode.appendChild(node);\n      return node;\n    };\n    var insertFormatNodesIntoCaretContainer = function (formatNodes, caretContainer) {\n      var innerMostFormatNode = foldr(formatNodes, function (parentNode, formatNode) {\n        return appendNode(parentNode, formatNode.cloneNode(false));\n      }, caretContainer);\n      return appendNode(innerMostFormatNode, innerMostFormatNode.ownerDocument.createTextNode(ZWSP$1));\n    };\n    var applyCaretFormat = function (editor, name, vars) {\n      var rng, caretContainer, textNode, offset, bookmark, container, text;\n      var selection = editor.selection;\n      rng = selection.getRng();\n      offset = rng.startOffset;\n      container = rng.startContainer;\n      text = container.nodeValue;\n      caretContainer = getParentCaretContainer(editor.getBody(), selection.getStart());\n      if (caretContainer) {\n        textNode = findFirstTextNode(caretContainer);\n      }\n      var wordcharRegex = /[^\\s\\u00a0\\u00ad\\u200b\\ufeff]/;\n      if (text && offset > 0 && offset < text.length && wordcharRegex.test(text.charAt(offset)) && wordcharRegex.test(text.charAt(offset - 1))) {\n        bookmark = selection.getBookmark();\n        rng.collapse(true);\n        rng = expandRng(editor, rng, editor.formatter.get(name));\n        rng = split$1(rng);\n        editor.formatter.apply(name, vars, rng);\n        selection.moveToBookmark(bookmark);\n      } else {\n        if (!caretContainer || textNode.nodeValue !== ZWSP$1) {\n          caretContainer = importNode(editor.getDoc(), createCaretContainer(true).dom());\n          textNode = caretContainer.firstChild;\n          rng.insertNode(caretContainer);\n          offset = 1;\n          editor.formatter.apply(name, vars, caretContainer);\n        } else {\n          editor.formatter.apply(name, vars, caretContainer);\n        }\n        selection.setCursorLocation(textNode, offset);\n      }\n    };\n    var removeCaretFormat = function (editor, name, vars, similar) {\n      var dom = editor.dom, selection = editor.selection;\n      var container, offset, bookmark;\n      var hasContentAfter, node, formatNode;\n      var parents = [], rng = selection.getRng();\n      var caretContainer;\n      container = rng.startContainer;\n      offset = rng.startOffset;\n      node = container;\n      if (container.nodeType === 3) {\n        if (offset !== container.nodeValue.length) {\n          hasContentAfter = true;\n        }\n        node = node.parentNode;\n      }\n      while (node) {\n        if (matchNode(editor, node, name, vars, similar)) {\n          formatNode = node;\n          break;\n        }\n        if (node.nextSibling) {\n          hasContentAfter = true;\n        }\n        parents.push(node);\n        node = node.parentNode;\n      }\n      if (!formatNode) {\n        return;\n      }\n      if (hasContentAfter) {\n        bookmark = selection.getBookmark();\n        rng.collapse(true);\n        var expandedRng = expandRng(editor, rng, editor.formatter.get(name), true);\n        expandedRng = split$1(expandedRng);\n        editor.formatter.remove(name, vars, expandedRng);\n        selection.moveToBookmark(bookmark);\n      } else {\n        caretContainer = getParentCaretContainer(editor.getBody(), formatNode);\n        var newCaretContainer = createCaretContainer(false).dom();\n        var caretNode = insertFormatNodesIntoCaretContainer(parents, newCaretContainer);\n        if (caretContainer) {\n          insertCaretContainerNode(editor, newCaretContainer, caretContainer);\n        } else {\n          insertCaretContainerNode(editor, newCaretContainer, formatNode);\n        }\n        removeCaretContainerNode(editor, caretContainer, false);\n        selection.setCursorLocation(caretNode, 1);\n        if (dom.isEmpty(formatNode)) {\n          dom.remove(formatNode);\n        }\n      }\n    };\n    var disableCaretContainer = function (editor, keyCode) {\n      var selection = editor.selection, body = editor.getBody();\n      removeCaretContainer(editor, null, false);\n      if ((keyCode === 8 || keyCode === 46) && selection.isCollapsed() && selection.getStart().innerHTML === ZWSP$1) {\n        removeCaretContainer(editor, getParentCaretContainer(body, selection.getStart()));\n      }\n      if (keyCode === 37 || keyCode === 39) {\n        removeCaretContainer(editor, getParentCaretContainer(body, selection.getStart()));\n      }\n    };\n    var setup$3 = function (editor) {\n      editor.on('mouseup keydown', function (e) {\n        disableCaretContainer(editor, e.keyCode);\n      });\n    };\n    var replaceWithCaretFormat = function (targetNode, formatNodes) {\n      var caretContainer = createCaretContainer(false);\n      var innerMost = insertFormatNodesIntoCaretContainer(formatNodes, caretContainer.dom());\n      before(Element.fromDom(targetNode), caretContainer);\n      remove(Element.fromDom(targetNode));\n      return CaretPosition$1(innerMost, 0);\n    };\n    var isFormatElement = function (editor, element) {\n      var inlineElements = editor.schema.getTextInlineElements();\n      return inlineElements.hasOwnProperty(name(element)) && !isCaretNode(element.dom()) && !NodeType.isBogus(element.dom());\n    };\n    var isEmptyCaretFormatElement = function (element) {\n      return isCaretNode(element.dom()) && isCaretContainerEmpty(element.dom());\n    };\n\n    var postProcessHooks = {}, filter$3 = ArrUtils.filter, each$9 = ArrUtils.each;\n    var addPostProcessHook = function (name, hook) {\n      var hooks = postProcessHooks[name];\n      if (!hooks) {\n        postProcessHooks[name] = hooks = [];\n      }\n      postProcessHooks[name].push(hook);\n    };\n    var postProcess$1 = function (name, editor) {\n      each$9(postProcessHooks[name], function (hook) {\n        hook(editor);\n      });\n    };\n    addPostProcessHook('pre', function (editor) {\n      var rng = editor.selection.getRng();\n      var isPre, blocks;\n      var hasPreSibling = function (pre) {\n        return isPre(pre.previousSibling) && ArrUtils.indexOf(blocks, pre.previousSibling) !== -1;\n      };\n      var joinPre = function (pre1, pre2) {\n        DomQuery(pre2).remove();\n        DomQuery(pre1).append('<br><br>').append(pre2.childNodes);\n      };\n      isPre = NodeType.matchNodeNames(['pre']);\n      if (!rng.collapsed) {\n        blocks = editor.selection.getSelectedBlocks();\n        each$9(filter$3(filter$3(blocks, isPre), hasPreSibling), function (pre) {\n          joinPre(pre.previousSibling, pre);\n        });\n      }\n    });\n\n    var each$a = Tools.each;\n    var ElementUtils = function (dom) {\n      this.compare = function (node1, node2) {\n        if (node1.nodeName !== node2.nodeName) {\n          return false;\n        }\n        var getAttribs = function (node) {\n          var attribs = {};\n          each$a(dom.getAttribs(node), function (attr) {\n            var name = attr.nodeName.toLowerCase();\n            if (name.indexOf('_') !== 0 && name !== 'style' && name.indexOf('data-') !== 0) {\n              attribs[name] = dom.getAttrib(node, name);\n            }\n          });\n          return attribs;\n        };\n        var compareObjects = function (obj1, obj2) {\n          var value, name;\n          for (name in obj1) {\n            if (obj1.hasOwnProperty(name)) {\n              value = obj2[name];\n              if (typeof value === 'undefined') {\n                return false;\n              }\n              if (obj1[name] !== value) {\n                return false;\n              }\n              delete obj2[name];\n            }\n          }\n          for (name in obj2) {\n            if (obj2.hasOwnProperty(name)) {\n              return false;\n            }\n          }\n          return true;\n        };\n        if (!compareObjects(getAttribs(node1), getAttribs(node2))) {\n          return false;\n        }\n        if (!compareObjects(dom.parseStyle(dom.getAttrib(node1, 'style')), dom.parseStyle(dom.getAttrib(node2, 'style')))) {\n          return false;\n        }\n        return !Bookmarks.isBookmarkNode(node1) && !Bookmarks.isBookmarkNode(node2);\n      };\n    };\n\n    var MCE_ATTR_RE = /^(src|href|style)$/;\n    var each$b = Tools.each;\n    var isEq$3 = isEq;\n    var isTableCell$3 = function (node) {\n      return /^(TH|TD)$/.test(node.nodeName);\n    };\n    var isChildOfInlineParent = function (dom, node, parent) {\n      return dom.isChildOf(node, parent) && node !== parent && !dom.isBlock(parent);\n    };\n    var getContainer = function (ed, rng, start) {\n      var container, offset;\n      container = rng[start ? 'startContainer' : 'endContainer'];\n      offset = rng[start ? 'startOffset' : 'endOffset'];\n      if (NodeType.isElement(container)) {\n        var lastIdx = container.childNodes.length - 1;\n        if (!start && offset) {\n          offset--;\n        }\n        container = container.childNodes[offset > lastIdx ? lastIdx : offset];\n      }\n      if (NodeType.isText(container) && start && offset >= container.nodeValue.length) {\n        container = new TreeWalker(container, ed.getBody()).next() || container;\n      }\n      if (NodeType.isText(container) && !start && offset === 0) {\n        container = new TreeWalker(container, ed.getBody()).prev() || container;\n      }\n      return container;\n    };\n    var wrap$3 = function (dom, node, name, attrs) {\n      var wrapper = dom.create(name, attrs);\n      node.parentNode.insertBefore(wrapper, node);\n      wrapper.appendChild(node);\n      return wrapper;\n    };\n    var wrapWithSiblings = function (dom, node, next, name, attrs) {\n      var start = Element.fromDom(node);\n      var wrapper = Element.fromDom(dom.create(name, attrs));\n      var siblings = next ? nextSiblings(start) : prevSiblings(start);\n      append$1(wrapper, siblings);\n      if (next) {\n        before(start, wrapper);\n        prepend(wrapper, start);\n      } else {\n        after(start, wrapper);\n        append(wrapper, start);\n      }\n      return wrapper.dom();\n    };\n    var matchName$1 = function (dom, node, format) {\n      if (isEq$3(node, format.inline)) {\n        return true;\n      }\n      if (isEq$3(node, format.block)) {\n        return true;\n      }\n      if (format.selector) {\n        return NodeType.isElement(node) && dom.is(node, format.selector);\n      }\n    };\n    var isColorFormatAndAnchor = function (node, format) {\n      return format.links && node.nodeName === 'A';\n    };\n    var find$4 = function (dom, node, next, inc) {\n      node = getNonWhiteSpaceSibling(node, next, inc);\n      return !node || (node.nodeName === 'BR' || dom.isBlock(node));\n    };\n    var removeNode$1 = function (ed, node, format) {\n      var parentNode = node.parentNode;\n      var rootBlockElm;\n      var dom = ed.dom, forcedRootBlock = Settings.getForcedRootBlock(ed);\n      if (format.block) {\n        if (!forcedRootBlock) {\n          if (dom.isBlock(node) && !dom.isBlock(parentNode)) {\n            if (!find$4(dom, node, false) && !find$4(dom, node.firstChild, true, true)) {\n              node.insertBefore(dom.create('br'), node.firstChild);\n            }\n            if (!find$4(dom, node, true) && !find$4(dom, node.lastChild, false, true)) {\n              node.appendChild(dom.create('br'));\n            }\n          }\n        } else {\n          if (parentNode === dom.getRoot()) {\n            if (!format.list_block || !isEq$3(node, format.list_block)) {\n              each$b(Tools.grep(node.childNodes), function (node) {\n                if (isValid(ed, forcedRootBlock, node.nodeName.toLowerCase())) {\n                  if (!rootBlockElm) {\n                    rootBlockElm = wrap$3(dom, node, forcedRootBlock);\n                    dom.setAttribs(rootBlockElm, ed.settings.forced_root_block_attrs);\n                  } else {\n                    rootBlockElm.appendChild(node);\n                  }\n                } else {\n                  rootBlockElm = 0;\n                }\n              });\n            }\n          }\n        }\n      }\n      if (format.selector && format.inline && !isEq$3(format.inline, node)) {\n        return;\n      }\n      dom.remove(node, true);\n    };\n    var removeFormat = function (ed, format, vars, node, compareNode) {\n      var stylesModified;\n      var dom = ed.dom;\n      if (!matchName$1(dom, node, format) && !isColorFormatAndAnchor(node, format)) {\n        return false;\n      }\n      var elm = node;\n      if (format.remove !== 'all') {\n        each$b(format.styles, function (value, name) {\n          value = normalizeStyleValue(dom, replaceVars(value, vars), name);\n          if (typeof name === 'number') {\n            name = value;\n            compareNode = null;\n          }\n          if (format.remove_similar || (!compareNode || isEq$3(getStyle(dom, compareNode, name), value))) {\n            dom.setStyle(elm, name, '');\n          }\n          stylesModified = true;\n        });\n        if (stylesModified && dom.getAttrib(elm, 'style') === '') {\n          elm.removeAttribute('style');\n          elm.removeAttribute('data-mce-style');\n        }\n        each$b(format.attributes, function (value, name) {\n          var valueOut;\n          value = replaceVars(value, vars);\n          if (typeof name === 'number') {\n            name = value;\n            compareNode = null;\n          }\n          if (format.remove_similar || (!compareNode || isEq$3(dom.getAttrib(compareNode, name), value))) {\n            if (name === 'class') {\n              value = dom.getAttrib(elm, name);\n              if (value) {\n                valueOut = '';\n                each$b(value.split(/\\s+/), function (cls) {\n                  if (/mce\\-\\w+/.test(cls)) {\n                    valueOut += (valueOut ? ' ' : '') + cls;\n                  }\n                });\n                if (valueOut) {\n                  dom.setAttrib(elm, name, valueOut);\n                  return;\n                }\n              }\n            }\n            if (name === 'class') {\n              elm.removeAttribute('className');\n            }\n            if (MCE_ATTR_RE.test(name)) {\n              elm.removeAttribute('data-mce-' + name);\n            }\n            elm.removeAttribute(name);\n          }\n        });\n        each$b(format.classes, function (value) {\n          value = replaceVars(value, vars);\n          if (!compareNode || dom.hasClass(compareNode, value)) {\n            dom.removeClass(elm, value);\n          }\n        });\n        var attrs = dom.getAttribs(elm);\n        for (var i = 0; i < attrs.length; i++) {\n          var attrName = attrs[i].nodeName;\n          if (attrName.indexOf('_') !== 0 && attrName.indexOf('data-') !== 0) {\n            return false;\n          }\n        }\n      }\n      if (format.remove !== 'none') {\n        removeNode$1(ed, elm, format);\n        return true;\n      }\n    };\n    var findFormatRoot = function (editor, container, name, vars, similar) {\n      var formatRoot;\n      each$b(getParents$1(editor.dom, container.parentNode).reverse(), function (parent) {\n        var format;\n        if (!formatRoot && parent.id !== '_start' && parent.id !== '_end') {\n          format = matchNode(editor, parent, name, vars, similar);\n          if (format && format.split !== false) {\n            formatRoot = parent;\n          }\n        }\n      });\n      return formatRoot;\n    };\n    var wrapAndSplit = function (editor, formatList, formatRoot, container, target, split, format, vars) {\n      var parent, clone, lastClone, firstClone, i, formatRootParent;\n      var dom = editor.dom;\n      if (formatRoot) {\n        formatRootParent = formatRoot.parentNode;\n        for (parent = container.parentNode; parent && parent !== formatRootParent; parent = parent.parentNode) {\n          clone = dom.clone(parent, false);\n          for (i = 0; i < formatList.length; i++) {\n            if (removeFormat(editor, formatList[i], vars, clone, clone)) {\n              clone = 0;\n              break;\n            }\n          }\n          if (clone) {\n            if (lastClone) {\n              clone.appendChild(lastClone);\n            }\n            if (!firstClone) {\n              firstClone = clone;\n            }\n            lastClone = clone;\n          }\n        }\n        if (split && (!format.mixed || !dom.isBlock(formatRoot))) {\n          container = dom.split(formatRoot, container);\n        }\n        if (lastClone) {\n          target.parentNode.insertBefore(lastClone, target);\n          firstClone.appendChild(target);\n        }\n      }\n      return container;\n    };\n    var remove$7 = function (ed, name, vars, node, similar) {\n      var formatList = ed.formatter.get(name), format = formatList[0];\n      var bookmark, rng, contentEditable = true;\n      var dom = ed.dom;\n      var selection = ed.selection;\n      var splitToFormatRoot = function (container) {\n        var formatRoot = findFormatRoot(ed, container, name, vars, similar);\n        return wrapAndSplit(ed, formatList, formatRoot, container, container, true, format, vars);\n      };\n      var isRemoveBookmarkNode = function (node) {\n        return Bookmarks.isBookmarkNode(node) && NodeType.isElement(node) && (node.id === '_start' || node.id === '_end');\n      };\n      var process = function (node) {\n        var children, i, l, lastContentEditable, hasContentEditableState;\n        if (NodeType.isElement(node) && dom.getContentEditable(node)) {\n          lastContentEditable = contentEditable;\n          contentEditable = dom.getContentEditable(node) === 'true';\n          hasContentEditableState = true;\n        }\n        children = Tools.grep(node.childNodes);\n        if (contentEditable && !hasContentEditableState) {\n          for (i = 0, l = formatList.length; i < l; i++) {\n            if (removeFormat(ed, formatList[i], vars, node, node)) {\n              break;\n            }\n          }\n        }\n        if (format.deep) {\n          if (children.length) {\n            for (i = 0, l = children.length; i < l; i++) {\n              process(children[i]);\n            }\n            if (hasContentEditableState) {\n              contentEditable = lastContentEditable;\n            }\n          }\n        }\n      };\n      var unwrap = function (start) {\n        var node = dom.get(start ? '_start' : '_end');\n        var out = node[start ? 'firstChild' : 'lastChild'];\n        if (isRemoveBookmarkNode(out)) {\n          out = out[start ? 'firstChild' : 'lastChild'];\n        }\n        if (NodeType.isText(out) && out.data.length === 0) {\n          out = start ? node.previousSibling || node.nextSibling : node.nextSibling || node.previousSibling;\n        }\n        dom.remove(node, true);\n        return out;\n      };\n      var removeRngStyle = function (rng) {\n        var startContainer, endContainer;\n        var commonAncestorContainer = rng.commonAncestorContainer;\n        var expandedRng = expandRng(ed, rng, formatList, true);\n        if (format.split) {\n          expandedRng = split$1(expandedRng);\n          startContainer = getContainer(ed, expandedRng, true);\n          endContainer = getContainer(ed, expandedRng);\n          if (startContainer !== endContainer) {\n            if (/^(TR|TH|TD)$/.test(startContainer.nodeName) && startContainer.firstChild) {\n              if (startContainer.nodeName === 'TR') {\n                startContainer = startContainer.firstChild.firstChild || startContainer;\n              } else {\n                startContainer = startContainer.firstChild || startContainer;\n              }\n            }\n            if (commonAncestorContainer && /^T(HEAD|BODY|FOOT|R)$/.test(commonAncestorContainer.nodeName) && isTableCell$3(endContainer) && endContainer.firstChild) {\n              endContainer = endContainer.firstChild || endContainer;\n            }\n            if (isChildOfInlineParent(dom, startContainer, endContainer)) {\n              var marker = Option.from(startContainer.firstChild).getOr(startContainer);\n              splitToFormatRoot(wrapWithSiblings(dom, marker, true, 'span', {\n                'id': '_start',\n                'data-mce-type': 'bookmark'\n              }));\n              unwrap(true);\n              return;\n            }\n            if (isChildOfInlineParent(dom, endContainer, startContainer)) {\n              var marker = Option.from(endContainer.lastChild).getOr(endContainer);\n              splitToFormatRoot(wrapWithSiblings(dom, marker, false, 'span', {\n                'id': '_end',\n                'data-mce-type': 'bookmark'\n              }));\n              unwrap(false);\n              return;\n            }\n            startContainer = wrap$3(dom, startContainer, 'span', {\n              'id': '_start',\n              'data-mce-type': 'bookmark'\n            });\n            endContainer = wrap$3(dom, endContainer, 'span', {\n              'id': '_end',\n              'data-mce-type': 'bookmark'\n            });\n            var newRng = dom.createRng();\n            newRng.setStartAfter(startContainer);\n            newRng.setEndBefore(endContainer);\n            RangeWalk.walk(dom, newRng, function (nodes) {\n              each(nodes, function (n) {\n                if (!Bookmarks.isBookmarkNode(n) && !Bookmarks.isBookmarkNode(n.parentNode)) {\n                  splitToFormatRoot(n);\n                }\n              });\n            });\n            splitToFormatRoot(startContainer);\n            splitToFormatRoot(endContainer);\n            startContainer = unwrap(true);\n            endContainer = unwrap();\n          } else {\n            startContainer = endContainer = splitToFormatRoot(startContainer);\n          }\n          expandedRng.startContainer = startContainer.parentNode ? startContainer.parentNode : startContainer;\n          expandedRng.startOffset = dom.nodeIndex(startContainer);\n          expandedRng.endContainer = endContainer.parentNode ? endContainer.parentNode : endContainer;\n          expandedRng.endOffset = dom.nodeIndex(endContainer) + 1;\n        }\n        RangeWalk.walk(dom, expandedRng, function (nodes) {\n          each$b(nodes, function (node) {\n            process(node);\n            if (NodeType.isElement(node) && ed.dom.getStyle(node, 'text-decoration') === 'underline' && node.parentNode && getTextDecoration(dom, node.parentNode) === 'underline') {\n              removeFormat(ed, {\n                deep: false,\n                exact: true,\n                inline: 'span',\n                styles: { textDecoration: 'underline' }\n              }, null, node);\n            }\n          });\n        });\n      };\n      if (node) {\n        if (isNode(node)) {\n          rng = dom.createRng();\n          rng.setStartBefore(node);\n          rng.setEndAfter(node);\n          removeRngStyle(rng);\n        } else {\n          removeRngStyle(node);\n        }\n        return;\n      }\n      if (dom.getContentEditable(selection.getNode()) === 'false') {\n        node = selection.getNode();\n        for (var i = 0, l = formatList.length; i < l; i++) {\n          if (formatList[i].ceFalseOverride) {\n            if (removeFormat(ed, formatList[i], vars, node, node)) {\n              break;\n            }\n          }\n        }\n        return;\n      }\n      if (!selection.isCollapsed() || !format.inline || dom.select('td[data-mce-selected],th[data-mce-selected]').length) {\n        bookmark = GetBookmark.getPersistentBookmark(ed.selection, true);\n        removeRngStyle(selection.getRng());\n        selection.moveToBookmark(bookmark);\n        if (format.inline && match(ed, name, vars, selection.getStart())) {\n          moveStart(dom, selection, selection.getRng());\n        }\n        ed.nodeChanged();\n      } else {\n        removeCaretFormat(ed, name, vars, similar);\n      }\n    };\n\n    var each$c = Tools.each;\n    var isElementNode = function (node) {\n      return NodeType.isElement(node) && !Bookmarks.isBookmarkNode(node) && !isCaretNode(node) && !NodeType.isBogus(node);\n    };\n    var findElementSibling = function (node, siblingName) {\n      var sibling;\n      for (sibling = node; sibling; sibling = sibling[siblingName]) {\n        if (NodeType.isText(sibling) && sibling.nodeValue.length !== 0) {\n          return node;\n        }\n        if (NodeType.isElement(sibling) && !Bookmarks.isBookmarkNode(sibling)) {\n          return sibling;\n        }\n      }\n      return node;\n    };\n    var mergeSiblingsNodes = function (dom, prev, next) {\n      var sibling, tmpSibling;\n      var elementUtils = new ElementUtils(dom);\n      if (prev && next) {\n        prev = findElementSibling(prev, 'previousSibling');\n        next = findElementSibling(next, 'nextSibling');\n        if (elementUtils.compare(prev, next)) {\n          for (sibling = prev.nextSibling; sibling && sibling !== next;) {\n            tmpSibling = sibling;\n            sibling = sibling.nextSibling;\n            prev.appendChild(tmpSibling);\n          }\n          dom.remove(next);\n          Tools.each(Tools.grep(next.childNodes), function (node) {\n            prev.appendChild(node);\n          });\n          return prev;\n        }\n      }\n      return next;\n    };\n    var processChildElements = function (node, filter, process) {\n      each$c(node.childNodes, function (node) {\n        if (isElementNode(node)) {\n          if (filter(node)) {\n            process(node);\n          }\n          if (node.hasChildNodes()) {\n            processChildElements(node, filter, process);\n          }\n        }\n      });\n    };\n    var hasStyle = function (dom, name) {\n      return curry(function (name, node) {\n        return !!(node && getStyle(dom, node, name));\n      }, name);\n    };\n    var applyStyle = function (dom, name, value) {\n      return curry(function (name, value, node) {\n        dom.setStyle(node, name, value);\n        if (node.getAttribute('style') === '') {\n          node.removeAttribute('style');\n        }\n        unwrapEmptySpan(dom, node);\n      }, name, value);\n    };\n    var unwrapEmptySpan = function (dom, node) {\n      if (node.nodeName === 'SPAN' && dom.getAttribs(node).length === 0) {\n        dom.remove(node, true);\n      }\n    };\n    var processUnderlineAndColor = function (dom, node) {\n      var textDecoration;\n      if (node.nodeType === 1 && node.parentNode && node.parentNode.nodeType === 1) {\n        textDecoration = getTextDecoration(dom, node.parentNode);\n        if (dom.getStyle(node, 'color') && textDecoration) {\n          dom.setStyle(node, 'text-decoration', textDecoration);\n        } else if (dom.getStyle(node, 'text-decoration') === textDecoration) {\n          dom.setStyle(node, 'text-decoration', null);\n        }\n      }\n    };\n    var mergeUnderlineAndColor = function (dom, format, vars, node) {\n      if (format.styles.color || format.styles.textDecoration) {\n        Tools.walk(node, curry(processUnderlineAndColor, dom), 'childNodes');\n        processUnderlineAndColor(dom, node);\n      }\n    };\n    var mergeBackgroundColorAndFontSize = function (dom, format, vars, node) {\n      if (format.styles && format.styles.backgroundColor) {\n        processChildElements(node, hasStyle(dom, 'fontSize'), applyStyle(dom, 'backgroundColor', replaceVars(format.styles.backgroundColor, vars)));\n      }\n    };\n    var mergeSubSup = function (dom, format, vars, node) {\n      if (format.inline === 'sub' || format.inline === 'sup') {\n        processChildElements(node, hasStyle(dom, 'fontSize'), applyStyle(dom, 'fontSize', ''));\n        dom.remove(dom.select(format.inline === 'sup' ? 'sub' : 'sup', node), true);\n      }\n    };\n    var mergeSiblings = function (dom, format, vars, node) {\n      if (node && format.merge_siblings !== false) {\n        node = mergeSiblingsNodes(dom, getNonWhiteSpaceSibling(node), node);\n        node = mergeSiblingsNodes(dom, node, getNonWhiteSpaceSibling(node, true));\n      }\n    };\n    var clearChildStyles = function (dom, format, node) {\n      if (format.clear_child_styles) {\n        var selector = format.links ? '*:not(a)' : '*';\n        each$c(dom.select(selector, node), function (node) {\n          if (isElementNode(node)) {\n            each$c(format.styles, function (value, name) {\n              dom.setStyle(node, name, '');\n            });\n          }\n        });\n      }\n    };\n    var mergeWithChildren = function (editor, formatList, vars, node) {\n      each$c(formatList, function (format) {\n        each$c(editor.dom.select(format.inline, node), function (child) {\n          if (!isElementNode(child)) {\n            return;\n          }\n          removeFormat(editor, format, vars, child, format.exact ? child : null);\n        });\n        clearChildStyles(editor.dom, format, node);\n      });\n    };\n    var mergeWithParents = function (editor, format, name, vars, node) {\n      if (matchNode(editor, node.parentNode, name, vars)) {\n        if (removeFormat(editor, format, vars, node)) {\n          return;\n        }\n      }\n      if (format.merge_with_parents) {\n        editor.dom.getParent(node.parentNode, function (parent) {\n          if (matchNode(editor, parent, name, vars)) {\n            removeFormat(editor, format, vars, node);\n            return true;\n          }\n        });\n      }\n    };\n\n    var createRange$1 = function (sc, so, ec, eo) {\n      var rng = domGlobals.document.createRange();\n      rng.setStart(sc, so);\n      rng.setEnd(ec, eo);\n      return rng;\n    };\n    var normalizeBlockSelectionRange = function (rng) {\n      var startPos = CaretPosition$1.fromRangeStart(rng);\n      var endPos = CaretPosition$1.fromRangeEnd(rng);\n      var rootNode = rng.commonAncestorContainer;\n      return CaretFinder.fromPosition(false, rootNode, endPos).map(function (newEndPos) {\n        if (!isInSameBlock(startPos, endPos, rootNode) && isInSameBlock(startPos, newEndPos, rootNode)) {\n          return createRange$1(startPos.container(), startPos.offset(), newEndPos.container(), newEndPos.offset());\n        } else {\n          return rng;\n        }\n      }).getOr(rng);\n    };\n    var normalize$2 = function (rng) {\n      return rng.collapsed ? rng : normalizeBlockSelectionRange(rng);\n    };\n    var RangeNormalizer = { normalize: normalize$2 };\n\n    var each$d = Tools.each;\n    var isElementNode$1 = function (node) {\n      return node && node.nodeType === 1 && !Bookmarks.isBookmarkNode(node) && !isCaretNode(node) && !NodeType.isBogus(node);\n    };\n    var applyFormat = function (ed, name, vars, node) {\n      var formatList = ed.formatter.get(name);\n      var format = formatList[0];\n      var bookmark, rng;\n      var isCollapsed = !node && ed.selection.isCollapsed();\n      var dom = ed.dom, selection = ed.selection;\n      var setElementFormat = function (elm, fmt) {\n        fmt = fmt || format;\n        if (elm) {\n          if (fmt.onformat) {\n            fmt.onformat(elm, fmt, vars, node);\n          }\n          each$d(fmt.styles, function (value, name) {\n            dom.setStyle(elm, name, replaceVars(value, vars));\n          });\n          if (fmt.styles) {\n            var styleVal = dom.getAttrib(elm, 'style');\n            if (styleVal) {\n              dom.setAttrib(elm, 'data-mce-style', styleVal);\n            }\n          }\n          each$d(fmt.attributes, function (value, name) {\n            dom.setAttrib(elm, name, replaceVars(value, vars));\n          });\n          each$d(fmt.classes, function (value) {\n            value = replaceVars(value, vars);\n            if (!dom.hasClass(elm, value)) {\n              dom.addClass(elm, value);\n            }\n          });\n        }\n      };\n      var applyNodeStyle = function (formatList, node) {\n        var found = false;\n        if (!format.selector) {\n          return false;\n        }\n        each$d(formatList, function (format) {\n          if ('collapsed' in format && format.collapsed !== isCollapsed) {\n            return;\n          }\n          if (dom.is(node, format.selector) && !isCaretNode(node)) {\n            setElementFormat(node, format);\n            found = true;\n            return false;\n          }\n        });\n        return found;\n      };\n      var applyRngStyle = function (dom, rng, bookmark, nodeSpecific) {\n        var newWrappers = [];\n        var wrapName, wrapElm, contentEditable = true;\n        wrapName = format.inline || format.block;\n        wrapElm = dom.create(wrapName);\n        setElementFormat(wrapElm);\n        RangeWalk.walk(dom, rng, function (nodes) {\n          var currentWrapElm;\n          var process = function (node) {\n            var hasContentEditableState = false;\n            var lastContentEditable = contentEditable;\n            var nodeName = node.nodeName.toLowerCase();\n            var parentName = node.parentNode.nodeName.toLowerCase();\n            if (NodeType.isElement(node) && dom.getContentEditable(node)) {\n              lastContentEditable = contentEditable;\n              contentEditable = dom.getContentEditable(node) === 'true';\n              hasContentEditableState = true;\n            }\n            if (isEq(nodeName, 'br')) {\n              currentWrapElm = 0;\n              if (format.block) {\n                dom.remove(node);\n              }\n              return;\n            }\n            if (format.wrapper && matchNode(ed, node, name, vars)) {\n              currentWrapElm = 0;\n              return;\n            }\n            if (contentEditable && !hasContentEditableState && format.block && !format.wrapper && isTextBlock$1(ed, nodeName) && isValid(ed, parentName, wrapName)) {\n              node = dom.rename(node, wrapName);\n              setElementFormat(node);\n              newWrappers.push(node);\n              currentWrapElm = 0;\n              return;\n            }\n            if (format.selector) {\n              var found = applyNodeStyle(formatList, node);\n              if (!format.inline || found) {\n                currentWrapElm = 0;\n                return;\n              }\n            }\n            if (contentEditable && !hasContentEditableState && isValid(ed, wrapName, nodeName) && isValid(ed, parentName, wrapName) && !(!nodeSpecific && node.nodeType === 3 && node.nodeValue.length === 1 && node.nodeValue.charCodeAt(0) === 65279) && !isCaretNode(node) && (!format.inline || !dom.isBlock(node))) {\n              if (!currentWrapElm) {\n                currentWrapElm = dom.clone(wrapElm, false);\n                node.parentNode.insertBefore(currentWrapElm, node);\n                newWrappers.push(currentWrapElm);\n              }\n              currentWrapElm.appendChild(node);\n            } else {\n              currentWrapElm = 0;\n              each$d(Tools.grep(node.childNodes), process);\n              if (hasContentEditableState) {\n                contentEditable = lastContentEditable;\n              }\n              currentWrapElm = 0;\n            }\n          };\n          each$d(nodes, process);\n        });\n        if (format.links === true) {\n          each$d(newWrappers, function (node) {\n            var process = function (node) {\n              if (node.nodeName === 'A') {\n                setElementFormat(node, format);\n              }\n              each$d(Tools.grep(node.childNodes), process);\n            };\n            process(node);\n          });\n        }\n        each$d(newWrappers, function (node) {\n          var childCount;\n          var getChildCount = function (node) {\n            var count = 0;\n            each$d(node.childNodes, function (node) {\n              if (!isEmptyTextNode(node) && !Bookmarks.isBookmarkNode(node)) {\n                count++;\n              }\n            });\n            return count;\n          };\n          var getChildElementNode = function (root) {\n            var child = false;\n            each$d(root.childNodes, function (node) {\n              if (isElementNode$1(node)) {\n                child = node;\n                return false;\n              }\n            });\n            return child;\n          };\n          var mergeStyles = function (node) {\n            var child, clone;\n            child = getChildElementNode(node);\n            if (child && !Bookmarks.isBookmarkNode(child) && matchName(dom, child, format)) {\n              clone = dom.clone(child, false);\n              setElementFormat(clone);\n              dom.replace(clone, node, true);\n              dom.remove(child, true);\n            }\n            return clone || node;\n          };\n          childCount = getChildCount(node);\n          if ((newWrappers.length > 1 || !dom.isBlock(node)) && childCount === 0) {\n            dom.remove(node, true);\n            return;\n          }\n          if (format.inline || format.wrapper) {\n            if (!format.exact && childCount === 1) {\n              node = mergeStyles(node);\n            }\n            mergeWithChildren(ed, formatList, vars, node);\n            mergeWithParents(ed, format, name, vars, node);\n            mergeBackgroundColorAndFontSize(dom, format, vars, node);\n            mergeSubSup(dom, format, vars, node);\n            mergeSiblings(dom, format, vars, node);\n          }\n        });\n      };\n      if (dom.getContentEditable(selection.getNode()) === 'false') {\n        node = selection.getNode();\n        for (var i = 0, l = formatList.length; i < l; i++) {\n          if (formatList[i].ceFalseOverride && dom.is(node, formatList[i].selector)) {\n            setElementFormat(node, formatList[i]);\n            return;\n          }\n        }\n        return;\n      }\n      if (format) {\n        if (node) {\n          if (isNode(node)) {\n            if (!applyNodeStyle(formatList, node)) {\n              rng = dom.createRng();\n              rng.setStartBefore(node);\n              rng.setEndAfter(node);\n              applyRngStyle(dom, expandRng(ed, rng, formatList), null, true);\n            }\n          } else {\n            applyRngStyle(dom, node, null, true);\n          }\n        } else {\n          if (!isCollapsed || !format.inline || dom.select('td[data-mce-selected],th[data-mce-selected]').length) {\n            var curSelNode = ed.selection.getNode();\n            if (!ed.settings.forced_root_block && formatList[0].defaultBlock && !dom.getParent(curSelNode, dom.isBlock)) {\n              applyFormat(ed, formatList[0].defaultBlock);\n            }\n            ed.selection.setRng(RangeNormalizer.normalize(ed.selection.getRng()));\n            bookmark = GetBookmark.getPersistentBookmark(ed.selection, true);\n            applyRngStyle(dom, expandRng(ed, selection.getRng(), formatList));\n            if (format.styles) {\n              mergeUnderlineAndColor(dom, format, vars, curSelNode);\n            }\n            selection.moveToBookmark(bookmark);\n            moveStart(dom, selection, selection.getRng());\n            ed.nodeChanged();\n          } else {\n            applyCaretFormat(ed, name, vars);\n          }\n        }\n        postProcess$1(name, ed);\n      }\n    };\n\n    var setup$4 = function (registeredFormatListeners, editor) {\n      var currentFormats = Cell({});\n      registeredFormatListeners.set({});\n      editor.on('NodeChange', function (e) {\n        updateAndFireChangeCallbacks(editor, e.element, currentFormats, registeredFormatListeners.get());\n      });\n    };\n    var updateAndFireChangeCallbacks = function (editor, elm, currentFormats, formatChangeData) {\n      var formatsList = keys(currentFormats.get());\n      var newFormats = {};\n      var matchedFormats = {};\n      var parents = filter(getParents$1(editor.dom, elm), function (node) {\n        return node.nodeType === 1 && !node.getAttribute('data-mce-bogus');\n      });\n      each$1(formatChangeData, function (data, format) {\n        Tools.each(parents, function (node) {\n          if (editor.formatter.matchNode(node, format, {}, data.similar)) {\n            if (formatsList.indexOf(format) === -1) {\n              each(data.callbacks, function (callback) {\n                callback(true, {\n                  node: node,\n                  format: format,\n                  parents: parents\n                });\n              });\n              newFormats[format] = data.callbacks;\n            }\n            matchedFormats[format] = data.callbacks;\n            return false;\n          }\n          if (matchesUnInheritedFormatSelector(editor, node, format)) {\n            return false;\n          }\n        });\n      });\n      var remainingFormats = filterRemainingFormats(currentFormats.get(), matchedFormats, elm, parents);\n      currentFormats.set(__assign(__assign({}, newFormats), remainingFormats));\n    };\n    var filterRemainingFormats = function (currentFormats, matchedFormats, elm, parents) {\n      return bifilter(currentFormats, function (callbacks, format) {\n        if (!has(matchedFormats, format)) {\n          each(callbacks, function (callback) {\n            callback(false, {\n              node: elm,\n              format: format,\n              parents: parents\n            });\n          });\n          return false;\n        } else {\n          return true;\n        }\n      }).t;\n    };\n    var addListeners = function (registeredFormatListeners, formats, callback, similar) {\n      var formatChangeItems = registeredFormatListeners.get();\n      each(formats.split(','), function (format) {\n        if (!formatChangeItems[format]) {\n          formatChangeItems[format] = {\n            similar: similar,\n            callbacks: []\n          };\n        }\n        formatChangeItems[format].callbacks.push(callback);\n      });\n      registeredFormatListeners.set(formatChangeItems);\n    };\n    var removeListeners = function (registeredFormatListeners, formats, callback) {\n      var formatChangeItems = registeredFormatListeners.get();\n      each(formats.split(','), function (format) {\n        formatChangeItems[format].callbacks = filter(formatChangeItems[format].callbacks, function (c) {\n          return c !== callback;\n        });\n        if (formatChangeItems[format].callbacks.length === 0) {\n          delete formatChangeItems[format];\n        }\n      });\n      registeredFormatListeners.set(formatChangeItems);\n    };\n    var formatChanged = function (editor, registeredFormatListeners, formats, callback, similar) {\n      if (registeredFormatListeners.get() === null) {\n        setup$4(registeredFormatListeners, editor);\n      }\n      addListeners(registeredFormatListeners, formats, callback, similar);\n      return {\n        unbind: function () {\n          return removeListeners(registeredFormatListeners, formats, callback);\n        }\n      };\n    };\n\n    var get$9 = function (dom) {\n      var formats = {\n        valigntop: [{\n            selector: 'td,th',\n            styles: { verticalAlign: 'top' }\n          }],\n        valignmiddle: [{\n            selector: 'td,th',\n            styles: { verticalAlign: 'middle' }\n          }],\n        valignbottom: [{\n            selector: 'td,th',\n            styles: { verticalAlign: 'bottom' }\n          }],\n        alignleft: [\n          {\n            selector: 'figure.image',\n            collapsed: false,\n            classes: 'align-left',\n            ceFalseOverride: true,\n            preview: 'font-family font-size'\n          },\n          {\n            selector: 'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',\n            styles: { textAlign: 'left' },\n            inherit: false,\n            preview: false,\n            defaultBlock: 'div'\n          },\n          {\n            selector: 'img,table',\n            collapsed: false,\n            styles: { float: 'left' },\n            preview: 'font-family font-size'\n          }\n        ],\n        aligncenter: [\n          {\n            selector: 'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',\n            styles: { textAlign: 'center' },\n            inherit: false,\n            preview: 'font-family font-size',\n            defaultBlock: 'div'\n          },\n          {\n            selector: 'figure.image',\n            collapsed: false,\n            classes: 'align-center',\n            ceFalseOverride: true,\n            preview: 'font-family font-size'\n          },\n          {\n            selector: 'img',\n            collapsed: false,\n            styles: {\n              display: 'block',\n              marginLeft: 'auto',\n              marginRight: 'auto'\n            },\n            preview: false\n          },\n          {\n            selector: 'table',\n            collapsed: false,\n            styles: {\n              marginLeft: 'auto',\n              marginRight: 'auto'\n            },\n            preview: 'font-family font-size'\n          }\n        ],\n        alignright: [\n          {\n            selector: 'figure.image',\n            collapsed: false,\n            classes: 'align-right',\n            ceFalseOverride: true,\n            preview: 'font-family font-size'\n          },\n          {\n            selector: 'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',\n            styles: { textAlign: 'right' },\n            inherit: false,\n            preview: 'font-family font-size',\n            defaultBlock: 'div'\n          },\n          {\n            selector: 'img,table',\n            collapsed: false,\n            styles: { float: 'right' },\n            preview: 'font-family font-size'\n          }\n        ],\n        alignjustify: [{\n            selector: 'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',\n            styles: { textAlign: 'justify' },\n            inherit: false,\n            defaultBlock: 'div',\n            preview: 'font-family font-size'\n          }],\n        bold: [\n          {\n            inline: 'strong',\n            remove: 'all'\n          },\n          {\n            inline: 'span',\n            styles: { fontWeight: 'bold' }\n          },\n          {\n            inline: 'b',\n            remove: 'all'\n          }\n        ],\n        italic: [\n          {\n            inline: 'em',\n            remove: 'all'\n          },\n          {\n            inline: 'span',\n            styles: { fontStyle: 'italic' }\n          },\n          {\n            inline: 'i',\n            remove: 'all'\n          }\n        ],\n        underline: [\n          {\n            inline: 'span',\n            styles: { textDecoration: 'underline' },\n            exact: true\n          },\n          {\n            inline: 'u',\n            remove: 'all'\n          }\n        ],\n        strikethrough: [\n          {\n            inline: 'span',\n            styles: { textDecoration: 'line-through' },\n            exact: true\n          },\n          {\n            inline: 'strike',\n            remove: 'all'\n          }\n        ],\n        forecolor: {\n          inline: 'span',\n          styles: { color: '%value' },\n          links: true,\n          remove_similar: true,\n          clear_child_styles: true\n        },\n        hilitecolor: {\n          inline: 'span',\n          styles: { backgroundColor: '%value' },\n          links: true,\n          remove_similar: true,\n          clear_child_styles: true\n        },\n        fontname: {\n          inline: 'span',\n          toggle: false,\n          styles: { fontFamily: '%value' },\n          clear_child_styles: true\n        },\n        fontsize: {\n          inline: 'span',\n          toggle: false,\n          styles: { fontSize: '%value' },\n          clear_child_styles: true\n        },\n        fontsize_class: {\n          inline: 'span',\n          attributes: { class: '%value' }\n        },\n        blockquote: {\n          block: 'blockquote',\n          wrapper: true,\n          remove: 'all'\n        },\n        subscript: { inline: 'sub' },\n        superscript: { inline: 'sup' },\n        code: { inline: 'code' },\n        link: {\n          inline: 'a',\n          selector: 'a',\n          remove: 'all',\n          split: true,\n          deep: true,\n          onmatch: function () {\n            return true;\n          },\n          onformat: function (elm, fmt, vars) {\n            Tools.each(vars, function (value, key) {\n              dom.setAttrib(elm, key, value);\n            });\n          }\n        },\n        removeformat: [\n          {\n            selector: 'b,strong,em,i,font,u,strike,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins',\n            remove: 'all',\n            split: true,\n            expand: false,\n            block_expand: true,\n            deep: true\n          },\n          {\n            selector: 'span',\n            attributes: [\n              'style',\n              'class'\n            ],\n            remove: 'empty',\n            split: true,\n            expand: false,\n            deep: true\n          },\n          {\n            selector: '*',\n            attributes: [\n              'style',\n              'class'\n            ],\n            split: false,\n            expand: false,\n            deep: true\n          }\n        ]\n      };\n      Tools.each('p h1 h2 h3 h4 h5 h6 div address pre div dt dd samp'.split(/\\s/), function (name) {\n        formats[name] = {\n          block: name,\n          remove: 'all'\n        };\n      });\n      return formats;\n    };\n    var DefaultFormats = { get: get$9 };\n\n    function FormatRegistry(editor) {\n      var formats = {};\n      var get = function (name) {\n        return name ? formats[name] : formats;\n      };\n      var has$1 = function (name) {\n        return has(formats, name);\n      };\n      var register = function (name, format) {\n        if (name) {\n          if (typeof name !== 'string') {\n            Tools.each(name, function (format, name) {\n              register(name, format);\n            });\n          } else {\n            if (!isArray(format)) {\n              format = [format];\n            }\n            Tools.each(format, function (format) {\n              if (typeof format.deep === 'undefined') {\n                format.deep = !format.selector;\n              }\n              if (typeof format.split === 'undefined') {\n                format.split = !format.selector || format.inline;\n              }\n              if (typeof format.remove === 'undefined' && format.selector && !format.inline) {\n                format.remove = 'none';\n              }\n              if (format.selector && format.inline) {\n                format.mixed = true;\n                format.block_expand = true;\n              }\n              if (typeof format.classes === 'string') {\n                format.classes = format.classes.split(/\\s+/);\n              }\n            });\n            formats[name] = format;\n          }\n        }\n      };\n      var unregister = function (name) {\n        if (name && formats[name]) {\n          delete formats[name];\n        }\n        return formats;\n      };\n      register(DefaultFormats.get(editor.dom));\n      register(editor.settings.formats);\n      return {\n        get: get,\n        has: has$1,\n        register: register,\n        unregister: unregister\n      };\n    }\n\n    var each$e = Tools.each;\n    var dom = DOMUtils$1.DOM;\n    var parsedSelectorToHtml = function (ancestry, editor) {\n      var elm, item, fragment;\n      var schema = editor && editor.schema || Schema({});\n      var decorate = function (elm, item) {\n        if (item.classes.length) {\n          dom.addClass(elm, item.classes.join(' '));\n        }\n        dom.setAttribs(elm, item.attrs);\n      };\n      var createElement = function (sItem) {\n        var elm;\n        item = typeof sItem === 'string' ? {\n          name: sItem,\n          classes: [],\n          attrs: {}\n        } : sItem;\n        elm = dom.create(item.name);\n        decorate(elm, item);\n        return elm;\n      };\n      var getRequiredParent = function (elm, candidate) {\n        var name = typeof elm !== 'string' ? elm.nodeName.toLowerCase() : elm;\n        var elmRule = schema.getElementRule(name);\n        var parentsRequired = elmRule && elmRule.parentsRequired;\n        if (parentsRequired && parentsRequired.length) {\n          return candidate && Tools.inArray(parentsRequired, candidate) !== -1 ? candidate : parentsRequired[0];\n        } else {\n          return false;\n        }\n      };\n      var wrapInHtml = function (elm, ancestry, siblings) {\n        var parent, parentCandidate, parentRequired;\n        var ancestor = ancestry.length > 0 && ancestry[0];\n        var ancestorName = ancestor && ancestor.name;\n        parentRequired = getRequiredParent(elm, ancestorName);\n        if (parentRequired) {\n          if (ancestorName === parentRequired) {\n            parentCandidate = ancestry[0];\n            ancestry = ancestry.slice(1);\n          } else {\n            parentCandidate = parentRequired;\n          }\n        } else if (ancestor) {\n          parentCandidate = ancestry[0];\n          ancestry = ancestry.slice(1);\n        } else if (!siblings) {\n          return elm;\n        }\n        if (parentCandidate) {\n          parent = createElement(parentCandidate);\n          parent.appendChild(elm);\n        }\n        if (siblings) {\n          if (!parent) {\n            parent = dom.create('div');\n            parent.appendChild(elm);\n          }\n          Tools.each(siblings, function (sibling) {\n            var siblingElm = createElement(sibling);\n            parent.insertBefore(siblingElm, elm);\n          });\n        }\n        return wrapInHtml(parent, ancestry, parentCandidate && parentCandidate.siblings);\n      };\n      if (ancestry && ancestry.length) {\n        item = ancestry[0];\n        elm = createElement(item);\n        fragment = dom.create('div');\n        fragment.appendChild(wrapInHtml(elm, ancestry.slice(1), item.siblings));\n        return fragment;\n      } else {\n        return '';\n      }\n    };\n    var parseSelectorItem = function (item) {\n      var tagName;\n      var obj = {\n        classes: [],\n        attrs: {}\n      };\n      item = obj.selector = Tools.trim(item);\n      if (item !== '*') {\n        tagName = item.replace(/(?:([#\\.]|::?)([\\w\\-]+)|(\\[)([^\\]]+)\\]?)/g, function ($0, $1, $2, $3, $4) {\n          switch ($1) {\n          case '#':\n            obj.attrs.id = $2;\n            break;\n          case '.':\n            obj.classes.push($2);\n            break;\n          case ':':\n            if (Tools.inArray('checked disabled enabled read-only required'.split(' '), $2) !== -1) {\n              obj.attrs[$2] = $2;\n            }\n            break;\n          }\n          if ($3 === '[') {\n            var m = $4.match(/([\\w\\-]+)(?:\\=\\\"([^\\\"]+))?/);\n            if (m) {\n              obj.attrs[m[1]] = m[2];\n            }\n          }\n          return '';\n        });\n      }\n      obj.name = tagName || 'div';\n      return obj;\n    };\n    var parseSelector = function (selector) {\n      if (!selector || typeof selector !== 'string') {\n        return [];\n      }\n      selector = selector.split(/\\s*,\\s*/)[0];\n      selector = selector.replace(/\\s*(~\\+|~|\\+|>)\\s*/g, '$1');\n      return Tools.map(selector.split(/(?:>|\\s+(?![^\\[\\]]+\\]))/), function (item) {\n        var siblings = Tools.map(item.split(/(?:~\\+|~|\\+)/), parseSelectorItem);\n        var obj = siblings.pop();\n        if (siblings.length) {\n          obj.siblings = siblings;\n        }\n        return obj;\n      }).reverse();\n    };\n    var getCssText = function (editor, format) {\n      var name, previewFrag, previewElm, items;\n      var previewCss = '', parentFontSize, previewStyles;\n      previewStyles = editor.settings.preview_styles;\n      if (previewStyles === false) {\n        return '';\n      }\n      if (typeof previewStyles !== 'string') {\n        previewStyles = 'font-family font-size font-weight font-style text-decoration ' + 'text-transform color background-color border border-radius outline text-shadow';\n      }\n      var removeVars = function (val) {\n        return val.replace(/%(\\w+)/g, '');\n      };\n      if (typeof format === 'string') {\n        format = editor.formatter.get(format);\n        if (!format) {\n          return;\n        }\n        format = format[0];\n      }\n      if ('preview' in format) {\n        previewStyles = format.preview;\n        if (previewStyles === false) {\n          return '';\n        }\n      }\n      name = format.block || format.inline || 'span';\n      items = parseSelector(format.selector);\n      if (items.length) {\n        if (!items[0].name) {\n          items[0].name = name;\n        }\n        name = format.selector;\n        previewFrag = parsedSelectorToHtml(items, editor);\n      } else {\n        previewFrag = parsedSelectorToHtml([name], editor);\n      }\n      previewElm = dom.select(name, previewFrag)[0] || previewFrag.firstChild;\n      each$e(format.styles, function (value, name) {\n        value = removeVars(value);\n        if (value) {\n          dom.setStyle(previewElm, name, value);\n        }\n      });\n      each$e(format.attributes, function (value, name) {\n        value = removeVars(value);\n        if (value) {\n          dom.setAttrib(previewElm, name, value);\n        }\n      });\n      each$e(format.classes, function (value) {\n        value = removeVars(value);\n        if (!dom.hasClass(previewElm, value)) {\n          dom.addClass(previewElm, value);\n        }\n      });\n      editor.fire('PreviewFormats');\n      dom.setStyles(previewFrag, {\n        position: 'absolute',\n        left: -65535\n      });\n      editor.getBody().appendChild(previewFrag);\n      parentFontSize = dom.getStyle(editor.getBody(), 'fontSize', true);\n      parentFontSize = /px$/.test(parentFontSize) ? parseInt(parentFontSize, 10) : 0;\n      each$e(previewStyles.split(' '), function (name) {\n        var value = dom.getStyle(previewElm, name, true);\n        if (name === 'background-color' && /transparent|rgba\\s*\\([^)]+,\\s*0\\)/.test(value)) {\n          value = dom.getStyle(editor.getBody(), name, true);\n          if (dom.toHex(value).toLowerCase() === '#ffffff') {\n            return;\n          }\n        }\n        if (name === 'color') {\n          if (dom.toHex(value).toLowerCase() === '#000000') {\n            return;\n          }\n        }\n        if (name === 'font-size') {\n          if (/em|%$/.test(value)) {\n            if (parentFontSize === 0) {\n              return;\n            }\n            var numValue = parseFloat(value) / (/%$/.test(value) ? 100 : 1);\n            value = numValue * parentFontSize + 'px';\n          }\n        }\n        if (name === 'border' && value) {\n          previewCss += 'padding:0 2px;';\n        }\n        previewCss += name + ':' + value + ';';\n      });\n      editor.fire('AfterPreviewFormats');\n      dom.remove(previewFrag);\n      return previewCss;\n    };\n\n    var toggle = function (editor, formats, name, vars, node) {\n      var fmt = formats.get(name);\n      if (match(editor, name, vars, node) && (!('toggle' in fmt[0]) || fmt[0].toggle)) {\n        remove$7(editor, name, vars, node);\n      } else {\n        applyFormat(editor, name, vars, node);\n      }\n    };\n\n    var setup$5 = function (editor) {\n      editor.addShortcut('meta+b', '', 'Bold');\n      editor.addShortcut('meta+i', '', 'Italic');\n      editor.addShortcut('meta+u', '', 'Underline');\n      for (var i = 1; i <= 6; i++) {\n        editor.addShortcut('access+' + i, '', [\n          'FormatBlock',\n          false,\n          'h' + i\n        ]);\n      }\n      editor.addShortcut('access+7', '', [\n        'FormatBlock',\n        false,\n        'p'\n      ]);\n      editor.addShortcut('access+8', '', [\n        'FormatBlock',\n        false,\n        'div'\n      ]);\n      editor.addShortcut('access+9', '', [\n        'FormatBlock',\n        false,\n        'address'\n      ]);\n    };\n    var FormatShortcuts = { setup: setup$5 };\n\n    var Formatter = function (editor) {\n      var formats = FormatRegistry(editor);\n      var formatChangeState = Cell(null);\n      FormatShortcuts.setup(editor);\n      setup$3(editor);\n      return {\n        get: formats.get,\n        has: formats.has,\n        register: formats.register,\n        unregister: formats.unregister,\n        apply: curry(applyFormat, editor),\n        remove: curry(remove$7, editor),\n        toggle: curry(toggle, editor, formats),\n        match: curry(match, editor),\n        matchAll: curry(matchAll, editor),\n        matchNode: curry(matchNode, editor),\n        canApply: curry(canApply, editor),\n        formatChanged: curry(formatChanged, editor, formatChangeState),\n        getCssText: curry(getCssText, editor)\n      };\n    };\n\n    var KEEP = 0, INSERT = 1, DELETE = 2;\n    var diff = function (left, right) {\n      var size = left.length + right.length + 2;\n      var vDown = new Array(size);\n      var vUp = new Array(size);\n      var snake = function (start, end, diag) {\n        return {\n          start: start,\n          end: end,\n          diag: diag\n        };\n      };\n      var buildScript = function (start1, end1, start2, end2, script) {\n        var middle = getMiddleSnake(start1, end1, start2, end2);\n        if (middle === null || middle.start === end1 && middle.diag === end1 - end2 || middle.end === start1 && middle.diag === start1 - start2) {\n          var i = start1;\n          var j = start2;\n          while (i < end1 || j < end2) {\n            if (i < end1 && j < end2 && left[i] === right[j]) {\n              script.push([\n                KEEP,\n                left[i]\n              ]);\n              ++i;\n              ++j;\n            } else {\n              if (end1 - start1 > end2 - start2) {\n                script.push([\n                  DELETE,\n                  left[i]\n                ]);\n                ++i;\n              } else {\n                script.push([\n                  INSERT,\n                  right[j]\n                ]);\n                ++j;\n              }\n            }\n          }\n        } else {\n          buildScript(start1, middle.start, start2, middle.start - middle.diag, script);\n          for (var i2 = middle.start; i2 < middle.end; ++i2) {\n            script.push([\n              KEEP,\n              left[i2]\n            ]);\n          }\n          buildScript(middle.end, end1, middle.end - middle.diag, end2, script);\n        }\n      };\n      var buildSnake = function (start, diag, end1, end2) {\n        var end = start;\n        while (end - diag < end2 && end < end1 && left[end] === right[end - diag]) {\n          ++end;\n        }\n        return snake(start, end, diag);\n      };\n      var getMiddleSnake = function (start1, end1, start2, end2) {\n        var m = end1 - start1;\n        var n = end2 - start2;\n        if (m === 0 || n === 0) {\n          return null;\n        }\n        var delta = m - n;\n        var sum = n + m;\n        var offset = (sum % 2 === 0 ? sum : sum + 1) / 2;\n        vDown[1 + offset] = start1;\n        vUp[1 + offset] = end1 + 1;\n        var d, k, i, x, y;\n        for (d = 0; d <= offset; ++d) {\n          for (k = -d; k <= d; k += 2) {\n            i = k + offset;\n            if (k === -d || k !== d && vDown[i - 1] < vDown[i + 1]) {\n              vDown[i] = vDown[i + 1];\n            } else {\n              vDown[i] = vDown[i - 1] + 1;\n            }\n            x = vDown[i];\n            y = x - start1 + start2 - k;\n            while (x < end1 && y < end2 && left[x] === right[y]) {\n              vDown[i] = ++x;\n              ++y;\n            }\n            if (delta % 2 !== 0 && delta - d <= k && k <= delta + d) {\n              if (vUp[i - delta] <= vDown[i]) {\n                return buildSnake(vUp[i - delta], k + start1 - start2, end1, end2);\n              }\n            }\n          }\n          for (k = delta - d; k <= delta + d; k += 2) {\n            i = k + offset - delta;\n            if (k === delta - d || k !== delta + d && vUp[i + 1] <= vUp[i - 1]) {\n              vUp[i] = vUp[i + 1] - 1;\n            } else {\n              vUp[i] = vUp[i - 1];\n            }\n            x = vUp[i] - 1;\n            y = x - start1 + start2 - k;\n            while (x >= start1 && y >= start2 && left[x] === right[y]) {\n              vUp[i] = x--;\n              y--;\n            }\n            if (delta % 2 === 0 && -d <= k && k <= d) {\n              if (vUp[i] <= vDown[i + delta]) {\n                return buildSnake(vUp[i], k + start1 - start2, end1, end2);\n              }\n            }\n          }\n        }\n      };\n      var script = [];\n      buildScript(0, left.length, 0, right.length, script);\n      return script;\n    };\n    var Diff = {\n      KEEP: KEEP,\n      DELETE: DELETE,\n      INSERT: INSERT,\n      diff: diff\n    };\n\n    var getOuterHtml = function (elm) {\n      if (NodeType.isElement(elm)) {\n        return elm.outerHTML;\n      } else if (NodeType.isText(elm)) {\n        return Entities.encodeRaw(elm.data, false);\n      } else if (NodeType.isComment(elm)) {\n        return '<!--' + elm.data + '-->';\n      }\n      return '';\n    };\n    var createFragment$1 = function (html) {\n      var frag, node, container;\n      container = domGlobals.document.createElement('div');\n      frag = domGlobals.document.createDocumentFragment();\n      if (html) {\n        container.innerHTML = html;\n      }\n      while (node = container.firstChild) {\n        frag.appendChild(node);\n      }\n      return frag;\n    };\n    var insertAt = function (elm, html, index) {\n      var fragment = createFragment$1(html);\n      if (elm.hasChildNodes() && index < elm.childNodes.length) {\n        var target = elm.childNodes[index];\n        target.parentNode.insertBefore(fragment, target);\n      } else {\n        elm.appendChild(fragment);\n      }\n    };\n    var removeAt = function (elm, index) {\n      if (elm.hasChildNodes() && index < elm.childNodes.length) {\n        var target = elm.childNodes[index];\n        target.parentNode.removeChild(target);\n      }\n    };\n    var applyDiff = function (diff, elm) {\n      var index = 0;\n      each(diff, function (action) {\n        if (action[0] === Diff.KEEP) {\n          index++;\n        } else if (action[0] === Diff.INSERT) {\n          insertAt(elm, action[1], index);\n          index++;\n        } else if (action[0] === Diff.DELETE) {\n          removeAt(elm, index);\n        }\n      });\n    };\n    var read$2 = function (elm) {\n      return filter(map(from$1(elm.childNodes), getOuterHtml), function (item) {\n        return item.length > 0;\n      });\n    };\n    var write = function (fragments, elm) {\n      var currentFragments = map(from$1(elm.childNodes), getOuterHtml);\n      applyDiff(Diff.diff(currentFragments, fragments), elm);\n      return elm;\n    };\n    var Fragments = {\n      read: read$2,\n      write: write\n    };\n\n    var undoLevelDocument = Cell(Option.none());\n    var lazyTempDocument = function () {\n      return undoLevelDocument.get().getOrThunk(function () {\n        var doc = domGlobals.document.implementation.createHTMLDocument('undo');\n        undoLevelDocument.set(Option.some(doc));\n        return doc;\n      });\n    };\n    var hasIframes = function (html) {\n      return html.indexOf('</iframe>') !== -1;\n    };\n    var createFragmentedLevel = function (fragments) {\n      return {\n        type: 'fragmented',\n        fragments: fragments,\n        content: '',\n        bookmark: null,\n        beforeBookmark: null\n      };\n    };\n    var createCompleteLevel = function (content) {\n      return {\n        type: 'complete',\n        fragments: null,\n        content: content,\n        bookmark: null,\n        beforeBookmark: null\n      };\n    };\n    var createFromEditor = function (editor) {\n      var fragments, content, trimmedFragments;\n      fragments = Fragments.read(editor.getBody());\n      trimmedFragments = bind(fragments, function (html) {\n        var trimmed = TrimHtml.trimInternal(editor.serializer, html);\n        return trimmed.length > 0 ? [trimmed] : [];\n      });\n      content = trimmedFragments.join('');\n      return hasIframes(content) ? createFragmentedLevel(trimmedFragments) : createCompleteLevel(content);\n    };\n    var applyToEditor = function (editor, level, before) {\n      if (level.type === 'fragmented') {\n        Fragments.write(level.fragments, editor.getBody());\n      } else {\n        editor.setContent(level.content, { format: 'raw' });\n      }\n      editor.selection.moveToBookmark(before ? level.beforeBookmark : level.bookmark);\n    };\n    var getLevelContent = function (level) {\n      return level.type === 'fragmented' ? level.fragments.join('') : level.content;\n    };\n    var getCleanLevelContent = function (level) {\n      var elm = Element.fromTag('body', lazyTempDocument());\n      set$1(elm, getLevelContent(level));\n      each(descendants$1(elm, '*[data-mce-bogus]'), unwrap);\n      return get$6(elm);\n    };\n    var hasEqualContent = function (level1, level2) {\n      return getLevelContent(level1) === getLevelContent(level2);\n    };\n    var hasEqualCleanedContent = function (level1, level2) {\n      return getCleanLevelContent(level1) === getCleanLevelContent(level2);\n    };\n    var isEq$4 = function (level1, level2) {\n      if (!level1 || !level2) {\n        return false;\n      } else if (hasEqualContent(level1, level2)) {\n        return true;\n      } else {\n        return hasEqualCleanedContent(level1, level2);\n      }\n    };\n    var Levels = {\n      createFragmentedLevel: createFragmentedLevel,\n      createCompleteLevel: createCompleteLevel,\n      createFromEditor: createFromEditor,\n      applyToEditor: applyToEditor,\n      isEq: isEq$4\n    };\n\n    var isUnlocked = function (locks) {\n      return locks.get() === 0;\n    };\n\n    var setTyping = function (undoManager, typing, locks) {\n      if (isUnlocked(locks)) {\n        undoManager.typing = typing;\n      }\n    };\n    var endTyping = function (undoManager, locks) {\n      if (undoManager.typing) {\n        setTyping(undoManager, false, locks);\n        undoManager.add();\n      }\n    };\n    var endTypingLevelIgnoreLocks = function (undoManager) {\n      if (undoManager.typing) {\n        undoManager.typing = false;\n        undoManager.add();\n      }\n    };\n\n    var beforeChange = function (editor, locks, beforeBookmark) {\n      if (isUnlocked(locks)) {\n        beforeBookmark.set(Option.some(GetBookmark.getUndoBookmark(editor.selection)));\n      }\n    };\n    var addUndoLevel = function (editor, undoManager, index, locks, beforeBookmark, level, event) {\n      var settings = editor.settings;\n      var currentLevel = Levels.createFromEditor(editor);\n      level = level || {};\n      level = Tools.extend(level, currentLevel);\n      if (isUnlocked(locks) === false || editor.removed) {\n        return null;\n      }\n      var lastLevel = undoManager.data[index.get()];\n      if (editor.fire('BeforeAddUndo', {\n          level: level,\n          lastLevel: lastLevel,\n          originalEvent: event\n        }).isDefaultPrevented()) {\n        return null;\n      }\n      if (lastLevel && Levels.isEq(lastLevel, level)) {\n        return null;\n      }\n      if (undoManager.data[index.get()]) {\n        beforeBookmark.get().each(function (bm) {\n          undoManager.data[index.get()].beforeBookmark = bm;\n        });\n      }\n      if (settings.custom_undo_redo_levels) {\n        if (undoManager.data.length > settings.custom_undo_redo_levels) {\n          for (var i = 0; i < undoManager.data.length - 1; i++) {\n            undoManager.data[i] = undoManager.data[i + 1];\n          }\n          undoManager.data.length--;\n          index.set(undoManager.data.length);\n        }\n      }\n      level.bookmark = GetBookmark.getUndoBookmark(editor.selection);\n      if (index.get() < undoManager.data.length - 1) {\n        undoManager.data.length = index.get() + 1;\n      }\n      undoManager.data.push(level);\n      index.set(undoManager.data.length - 1);\n      var args = {\n        level: level,\n        lastLevel: lastLevel,\n        originalEvent: event\n      };\n      editor.fire('AddUndo', args);\n      if (index.get() > 0) {\n        editor.setDirty(true);\n        editor.fire('change', args);\n      }\n      return level;\n    };\n    var clear = function (editor, undoManager, index) {\n      undoManager.data = [];\n      index.set(0);\n      undoManager.typing = false;\n      editor.fire('ClearUndos');\n    };\n    var extra = function (editor, undoManager, index, callback1, callback2) {\n      if (undoManager.transact(callback1)) {\n        var bookmark = undoManager.data[index.get()].bookmark;\n        var lastLevel = undoManager.data[index.get() - 1];\n        Levels.applyToEditor(editor, lastLevel, true);\n        if (undoManager.transact(callback2)) {\n          undoManager.data[index.get() - 1].beforeBookmark = bookmark;\n        }\n      }\n    };\n    var redo = function (editor, index, data) {\n      var level;\n      if (index.get() < data.length - 1) {\n        index.set(index.get() + 1);\n        level = data[index.get()];\n        Levels.applyToEditor(editor, level, false);\n        editor.setDirty(true);\n        editor.fire('Redo', { level: level });\n      }\n      return level;\n    };\n    var undo = function (editor, undoManager, locks, index) {\n      var level;\n      if (undoManager.typing) {\n        undoManager.add();\n        undoManager.typing = false;\n        setTyping(undoManager, false, locks);\n      }\n      if (index.get() > 0) {\n        index.set(index.get() - 1);\n        level = undoManager.data[index.get()];\n        Levels.applyToEditor(editor, level, true);\n        editor.setDirty(true);\n        editor.fire('Undo', { level: level });\n      }\n      return level;\n    };\n    var reset = function (undoManager) {\n      undoManager.clear();\n      undoManager.add();\n    };\n    var hasUndo = function (editor, undoManager, index) {\n      return index.get() > 0 || undoManager.typing && undoManager.data[0] && !Levels.isEq(Levels.createFromEditor(editor), undoManager.data[0]);\n    };\n    var hasRedo = function (undoManager, index) {\n      return index.get() < undoManager.data.length - 1 && !undoManager.typing;\n    };\n    var transact = function (undoManager, locks, callback) {\n      endTyping(undoManager, locks);\n      undoManager.beforeChange();\n      undoManager.ignore(callback);\n      return undoManager.add();\n    };\n    var ignore = function (locks, callback) {\n      try {\n        locks.set(locks.get() + 1);\n        callback();\n      } finally {\n        locks.set(locks.get() - 1);\n      }\n    };\n\n    var registerEvents$1 = function (editor, undoManager, locks) {\n      var isFirstTypedCharacter = Cell(false);\n      var addNonTypingUndoLevel = function (e) {\n        setTyping(undoManager, false, locks);\n        undoManager.add({}, e);\n      };\n      editor.on('init', function () {\n        undoManager.add();\n      });\n      editor.on('BeforeExecCommand', function (e) {\n        var cmd = e.command;\n        if (cmd !== 'Undo' && cmd !== 'Redo' && cmd !== 'mceRepaint') {\n          endTyping(undoManager, locks);\n          undoManager.beforeChange();\n        }\n      });\n      editor.on('ExecCommand', function (e) {\n        var cmd = e.command;\n        if (cmd !== 'Undo' && cmd !== 'Redo' && cmd !== 'mceRepaint') {\n          addNonTypingUndoLevel(e);\n        }\n      });\n      editor.on('ObjectResizeStart cut', function () {\n        undoManager.beforeChange();\n      });\n      editor.on('SaveContent ObjectResized blur', addNonTypingUndoLevel);\n      editor.on('dragend', addNonTypingUndoLevel);\n      editor.on('keyup', function (e) {\n        var keyCode = e.keyCode;\n        if (e.isDefaultPrevented()) {\n          return;\n        }\n        if (keyCode >= 33 && keyCode <= 36 || keyCode >= 37 && keyCode <= 40 || keyCode === 45 || e.ctrlKey) {\n          addNonTypingUndoLevel();\n          editor.nodeChanged();\n        }\n        if (keyCode === 46 || keyCode === 8) {\n          editor.nodeChanged();\n        }\n        if (isFirstTypedCharacter.get() && undoManager.typing && Levels.isEq(Levels.createFromEditor(editor), undoManager.data[0]) === false) {\n          if (editor.isDirty() === false) {\n            editor.setDirty(true);\n            editor.fire('change', {\n              level: undoManager.data[0],\n              lastLevel: null\n            });\n          }\n          editor.fire('TypingUndo');\n          isFirstTypedCharacter.set(false);\n          editor.nodeChanged();\n        }\n      });\n      editor.on('keydown', function (e) {\n        var keyCode = e.keyCode;\n        if (e.isDefaultPrevented()) {\n          return;\n        }\n        if (keyCode >= 33 && keyCode <= 36 || keyCode >= 37 && keyCode <= 40 || keyCode === 45) {\n          if (undoManager.typing) {\n            addNonTypingUndoLevel(e);\n          }\n          return;\n        }\n        var modKey = e.ctrlKey && !e.altKey || e.metaKey;\n        if ((keyCode < 16 || keyCode > 20) && keyCode !== 224 && keyCode !== 91 && !undoManager.typing && !modKey) {\n          undoManager.beforeChange();\n          setTyping(undoManager, true, locks);\n          undoManager.add({}, e);\n          isFirstTypedCharacter.set(true);\n        }\n      });\n      editor.on('mousedown', function (e) {\n        if (undoManager.typing) {\n          addNonTypingUndoLevel(e);\n        }\n      });\n      var isInsertReplacementText = function (event) {\n        return event.inputType === 'insertReplacementText';\n      };\n      var isInsertTextDataNull = function (event) {\n        return event.inputType === 'insertText' && event.data === null;\n      };\n      editor.on('input', function (e) {\n        if (e.inputType && (isInsertReplacementText(e) || isInsertTextDataNull(e))) {\n          addNonTypingUndoLevel(e);\n        }\n      });\n      editor.on('AddUndo Undo Redo ClearUndos', function (e) {\n        if (!e.isDefaultPrevented()) {\n          editor.nodeChanged();\n        }\n      });\n    };\n    var addKeyboardShortcuts = function (editor) {\n      editor.addShortcut('meta+z', '', 'Undo');\n      editor.addShortcut('meta+y,meta+shift+z', '', 'Redo');\n    };\n\n    var UndoManager = function (editor) {\n      var beforeBookmark = Cell(Option.none());\n      var locks = Cell(0);\n      var index = Cell(0);\n      var undoManager = {\n        data: [],\n        typing: false,\n        beforeChange: function () {\n          beforeChange(editor, locks, beforeBookmark);\n        },\n        add: function (level, event) {\n          return addUndoLevel(editor, undoManager, index, locks, beforeBookmark, level, event);\n        },\n        undo: function () {\n          return undo(editor, undoManager, locks, index);\n        },\n        redo: function () {\n          return redo(editor, index, undoManager.data);\n        },\n        clear: function () {\n          clear(editor, undoManager, index);\n        },\n        reset: function () {\n          reset(undoManager);\n        },\n        hasUndo: function () {\n          return hasUndo(editor, undoManager, index);\n        },\n        hasRedo: function () {\n          return hasRedo(undoManager, index);\n        },\n        transact: function (callback) {\n          return transact(undoManager, locks, callback);\n        },\n        ignore: function (callback) {\n          ignore(locks, callback);\n        },\n        extra: function (callback1, callback2) {\n          extra(editor, undoManager, index, callback1, callback2);\n        }\n      };\n      registerEvents$1(editor, undoManager, locks);\n      addKeyboardShortcuts(editor);\n      return undoManager;\n    };\n\n    var nonTypingKeycodes = [\n      9,\n      27,\n      VK.HOME,\n      VK.END,\n      19,\n      20,\n      44,\n      144,\n      145,\n      33,\n      34,\n      45,\n      16,\n      17,\n      18,\n      91,\n      92,\n      93,\n      VK.DOWN,\n      VK.UP,\n      VK.LEFT,\n      VK.RIGHT\n    ].concat(Env.browser.isFirefox() ? [224] : []);\n    var placeholderAttr = 'data-mce-placeholder';\n    var isKeyboardEvent = function (e) {\n      return e.type === 'keydown' || e.type === 'keyup';\n    };\n    var isDeleteEvent = function (e) {\n      var keyCode = e.keyCode;\n      return keyCode === VK.BACKSPACE || keyCode === VK.DELETE;\n    };\n    var isNonTypingKeyboardEvent = function (e) {\n      if (isKeyboardEvent(e)) {\n        var keyCode = e.keyCode;\n        return !isDeleteEvent(e) && (VK.metaKeyPressed(e) || e.altKey || keyCode >= 112 && keyCode <= 123 || contains(nonTypingKeycodes, keyCode));\n      } else {\n        return false;\n      }\n    };\n    var isTypingKeyboardEvent = function (e) {\n      return isKeyboardEvent(e) && !(isDeleteEvent(e) || e.type === 'keyup' && e.keyCode === 229);\n    };\n    var isVisuallyEmpty = function (dom, rootElm, forcedRootBlock) {\n      if (Empty.isEmpty(Element.fromDom(rootElm), false)) {\n        var isForcedRootBlockFalse = forcedRootBlock === '';\n        var firstElement = rootElm.firstElementChild;\n        if (!firstElement) {\n          return true;\n        } else if (dom.getStyle(rootElm.firstElementChild, 'padding-left') || dom.getStyle(rootElm.firstElementChild, 'padding-right')) {\n          return false;\n        } else {\n          return isForcedRootBlockFalse ? !dom.isBlock(firstElement) : forcedRootBlock === firstElement.nodeName.toLowerCase();\n        }\n      } else {\n        return false;\n      }\n    };\n    var setup$6 = function (editor) {\n      var dom = editor.dom;\n      var rootBlock = Settings.getForcedRootBlock(editor);\n      var placeholder = Settings.getPlaceholder(editor);\n      var updatePlaceholder = function (e, initial) {\n        if (isNonTypingKeyboardEvent(e)) {\n          return;\n        }\n        var body = editor.getBody();\n        var showPlaceholder = isTypingKeyboardEvent(e) ? false : isVisuallyEmpty(dom, body, rootBlock);\n        var isPlaceholderShown = dom.getAttrib(body, placeholderAttr) !== '';\n        if (isPlaceholderShown !== showPlaceholder || initial) {\n          dom.setAttrib(body, placeholderAttr, showPlaceholder ? placeholder : null);\n          dom.setAttrib(body, 'aria-placeholder', showPlaceholder ? placeholder : null);\n          firePlaceholderToggle(editor, showPlaceholder);\n          editor.on(showPlaceholder ? 'keydown' : 'keyup', updatePlaceholder);\n          editor.off(showPlaceholder ? 'keyup' : 'keydown', updatePlaceholder);\n        }\n      };\n      if (placeholder) {\n        editor.on('init', function (e) {\n          updatePlaceholder(e, true);\n          editor.on('change SetContent ExecCommand', updatePlaceholder);\n          editor.on('remove', function () {\n            var body = editor.getBody();\n            dom.setAttrib(body, placeholderAttr, null);\n            dom.setAttrib(body, 'aria-placeholder', null);\n          });\n        });\n      }\n    };\n\n    var SIGNIFICANT_MOVE = 5;\n    var LONGPRESS_DELAY = 400;\n    var getTouch = function (event) {\n      if (event.touches === undefined || event.touches.length !== 1) {\n        return Option.none();\n      }\n      return Option.some(event.touches[0]);\n    };\n    var isFarEnough = function (touch, data) {\n      var distX = Math.abs(touch.clientX - data.x());\n      var distY = Math.abs(touch.clientY - data.y());\n      return distX > SIGNIFICANT_MOVE || distY > SIGNIFICANT_MOVE;\n    };\n    var setup$7 = function (editor) {\n      var startData = Cell(Option.none());\n      var longpressFired = Cell(false);\n      var debounceLongpress = last$2(function (e) {\n        editor.fire('longpress', __assign(__assign({}, e), { type: 'longpress' }));\n        longpressFired.set(true);\n      }, LONGPRESS_DELAY);\n      editor.on('touchstart', function (e) {\n        getTouch(e).each(function (touch) {\n          debounceLongpress.cancel();\n          var data = {\n            x: constant(touch.clientX),\n            y: constant(touch.clientY),\n            target: constant(e.target)\n          };\n          debounceLongpress.throttle(e);\n          longpressFired.set(false);\n          startData.set(Option.some(data));\n        });\n      }, true);\n      editor.on('touchmove', function (e) {\n        debounceLongpress.cancel();\n        getTouch(e).each(function (touch) {\n          startData.get().each(function (data) {\n            if (isFarEnough(touch, data)) {\n              startData.set(Option.none());\n              longpressFired.set(false);\n              editor.fire('longpresscancel');\n            }\n          });\n        });\n      }, true);\n      editor.on('touchend touchcancel', function (e) {\n        debounceLongpress.cancel();\n        if (e.type === 'touchcancel') {\n          return;\n        }\n        startData.get().filter(function (data) {\n          return data.target().isEqualNode(e.target);\n        }).each(function () {\n          if (longpressFired.get()) {\n            e.preventDefault();\n          } else {\n            editor.fire('tap', __assign(__assign({}, e), { type: 'tap' }));\n          }\n        });\n      }, true);\n    };\n    var TouchEvents = { setup: setup$7 };\n\n    var isBlockElement = function (blockElements, node) {\n      return blockElements.hasOwnProperty(node.nodeName);\n    };\n    var isValidTarget = function (blockElements, node) {\n      if (NodeType.isText(node)) {\n        return true;\n      } else if (NodeType.isElement(node)) {\n        return !isBlockElement(blockElements, node) && !Bookmarks.isBookmarkNode(node);\n      } else {\n        return false;\n      }\n    };\n    var hasBlockParent = function (blockElements, root, node) {\n      return exists(Parents.parents(Element.fromDom(node), Element.fromDom(root)), function (elm) {\n        return isBlockElement(blockElements, elm.dom());\n      });\n    };\n    var shouldRemoveTextNode = function (blockElements, node) {\n      if (NodeType.isText(node)) {\n        if (node.nodeValue.length === 0) {\n          return true;\n        } else if (/^\\s+$/.test(node.nodeValue) && (!node.nextSibling || isBlockElement(blockElements, node.nextSibling))) {\n          return true;\n        }\n      }\n      return false;\n    };\n    var addRootBlocks = function (editor) {\n      var dom = editor.dom, selection = editor.selection;\n      var schema = editor.schema, blockElements = schema.getBlockElements();\n      var node = selection.getStart();\n      var rootNode = editor.getBody();\n      var rng;\n      var startContainer, startOffset, endContainer, endOffset, rootBlockNode;\n      var tempNode, wrapped, restoreSelection;\n      var rootNodeName;\n      var forcedRootBlock = Settings.getForcedRootBlock(editor);\n      if (!node || !NodeType.isElement(node) || !forcedRootBlock) {\n        return;\n      }\n      rootNodeName = rootNode.nodeName.toLowerCase();\n      if (!schema.isValidChild(rootNodeName, forcedRootBlock.toLowerCase()) || hasBlockParent(blockElements, rootNode, node)) {\n        return;\n      }\n      rng = selection.getRng();\n      startContainer = rng.startContainer;\n      startOffset = rng.startOffset;\n      endContainer = rng.endContainer;\n      endOffset = rng.endOffset;\n      restoreSelection = EditorFocus.hasFocus(editor);\n      node = rootNode.firstChild;\n      while (node) {\n        if (isValidTarget(blockElements, node)) {\n          if (shouldRemoveTextNode(blockElements, node)) {\n            tempNode = node;\n            node = node.nextSibling;\n            dom.remove(tempNode);\n            continue;\n          }\n          if (!rootBlockNode) {\n            rootBlockNode = dom.create(forcedRootBlock, Settings.getForcedRootBlockAttrs(editor));\n            node.parentNode.insertBefore(rootBlockNode, node);\n            wrapped = true;\n          }\n          tempNode = node;\n          node = node.nextSibling;\n          rootBlockNode.appendChild(tempNode);\n        } else {\n          rootBlockNode = null;\n          node = node.nextSibling;\n        }\n      }\n      if (wrapped && restoreSelection) {\n        rng.setStart(startContainer, startOffset);\n        rng.setEnd(endContainer, endOffset);\n        selection.setRng(rng);\n        editor.nodeChanged();\n      }\n    };\n    var setup$8 = function (editor) {\n      if (Settings.getForcedRootBlock(editor)) {\n        editor.on('NodeChange', curry(addRootBlocks, editor));\n      }\n    };\n    var ForceBlocks = { setup: setup$8 };\n\n    var isText$8 = NodeType.isText;\n    var startsWithCaretContainer$1 = function (node) {\n      return isText$8(node) && node.data[0] === Zwsp.ZWSP;\n    };\n    var endsWithCaretContainer$1 = function (node) {\n      return isText$8(node) && node.data[node.data.length - 1] === Zwsp.ZWSP;\n    };\n    var createZwsp = function (node) {\n      return node.ownerDocument.createTextNode(Zwsp.ZWSP);\n    };\n    var insertBefore = function (node) {\n      if (isText$8(node.previousSibling)) {\n        if (endsWithCaretContainer$1(node.previousSibling)) {\n          return node.previousSibling;\n        } else {\n          node.previousSibling.appendData(Zwsp.ZWSP);\n          return node.previousSibling;\n        }\n      } else if (isText$8(node)) {\n        if (startsWithCaretContainer$1(node)) {\n          return node;\n        } else {\n          node.insertData(0, Zwsp.ZWSP);\n          return node;\n        }\n      } else {\n        var newNode = createZwsp(node);\n        node.parentNode.insertBefore(newNode, node);\n        return newNode;\n      }\n    };\n    var insertAfter = function (node) {\n      if (isText$8(node.nextSibling)) {\n        if (startsWithCaretContainer$1(node.nextSibling)) {\n          return node.nextSibling;\n        } else {\n          node.nextSibling.insertData(0, Zwsp.ZWSP);\n          return node.nextSibling;\n        }\n      } else if (isText$8(node)) {\n        if (endsWithCaretContainer$1(node)) {\n          return node;\n        } else {\n          node.appendData(Zwsp.ZWSP);\n          return node;\n        }\n      } else {\n        var newNode = createZwsp(node);\n        if (node.nextSibling) {\n          node.parentNode.insertBefore(newNode, node.nextSibling);\n        } else {\n          node.parentNode.appendChild(newNode);\n        }\n        return newNode;\n      }\n    };\n    var insertInline$1 = function (before, node) {\n      return before ? insertBefore(node) : insertAfter(node);\n    };\n    var insertInlineBefore = curry(insertInline$1, true);\n    var insertInlineAfter = curry(insertInline$1, false);\n\n    var insertInlinePos = function (pos, before) {\n      if (NodeType.isText(pos.container())) {\n        return insertInline$1(before, pos.container());\n      } else {\n        return insertInline$1(before, pos.getNode());\n      }\n    };\n    var isPosCaretContainer = function (pos, caret) {\n      var caretNode = caret.get();\n      return caretNode && pos.container() === caretNode && isCaretContainerInline(caretNode);\n    };\n    var renderCaret = function (caret, location) {\n      return location.fold(function (element) {\n        CaretContainerRemove.remove(caret.get());\n        var text = insertInlineBefore(element);\n        caret.set(text);\n        return Option.some(CaretPosition$1(text, text.length - 1));\n      }, function (element) {\n        return CaretFinder.firstPositionIn(element).map(function (pos) {\n          if (!isPosCaretContainer(pos, caret)) {\n            CaretContainerRemove.remove(caret.get());\n            var text = insertInlinePos(pos, true);\n            caret.set(text);\n            return CaretPosition$1(text, 1);\n          } else {\n            return CaretPosition$1(caret.get(), 1);\n          }\n        });\n      }, function (element) {\n        return CaretFinder.lastPositionIn(element).map(function (pos) {\n          if (!isPosCaretContainer(pos, caret)) {\n            CaretContainerRemove.remove(caret.get());\n            var text = insertInlinePos(pos, false);\n            caret.set(text);\n            return CaretPosition$1(text, text.length - 1);\n          } else {\n            return CaretPosition$1(caret.get(), caret.get().length - 1);\n          }\n        });\n      }, function (element) {\n        CaretContainerRemove.remove(caret.get());\n        var text = insertInlineAfter(element);\n        caret.set(text);\n        return Option.some(CaretPosition$1(text, 1));\n      });\n    };\n    var BoundaryCaret = { renderCaret: renderCaret };\n\n    var strongRtl = /[\\u0591-\\u07FF\\uFB1D-\\uFDFF\\uFE70-\\uFEFC]/;\n    var hasStrongRtl = function (text) {\n      return strongRtl.test(text);\n    };\n\n    var isInlineTarget = function (editor, elm) {\n      return is(Element.fromDom(elm), Settings.getInlineBoundarySelector(editor));\n    };\n    var isRtl$1 = function (element) {\n      return DOMUtils$1.DOM.getStyle(element, 'direction', true) === 'rtl' || hasStrongRtl(element.textContent);\n    };\n    var findInlineParents = function (isInlineTarget, rootNode, pos) {\n      return filter(DOMUtils$1.DOM.getParents(pos.container(), '*', rootNode), isInlineTarget);\n    };\n    var findRootInline = function (isInlineTarget, rootNode, pos) {\n      var parents = findInlineParents(isInlineTarget, rootNode, pos);\n      return Option.from(parents[parents.length - 1]);\n    };\n    var hasSameParentBlock = function (rootNode, node1, node2) {\n      var block1 = getParentBlock(node1, rootNode);\n      var block2 = getParentBlock(node2, rootNode);\n      return block1 && block1 === block2;\n    };\n    var isAtZwsp = function (pos) {\n      return isBeforeInline(pos) || isAfterInline(pos);\n    };\n    var normalizePosition = function (forward, pos) {\n      if (!pos) {\n        return pos;\n      }\n      var container = pos.container(), offset = pos.offset();\n      if (forward) {\n        if (isCaretContainerInline(container)) {\n          if (NodeType.isText(container.nextSibling)) {\n            return CaretPosition$1(container.nextSibling, 0);\n          } else {\n            return CaretPosition$1.after(container);\n          }\n        } else {\n          return isBeforeInline(pos) ? CaretPosition$1(container, offset + 1) : pos;\n        }\n      } else {\n        if (isCaretContainerInline(container)) {\n          if (NodeType.isText(container.previousSibling)) {\n            return CaretPosition$1(container.previousSibling, container.previousSibling.data.length);\n          } else {\n            return CaretPosition$1.before(container);\n          }\n        } else {\n          return isAfterInline(pos) ? CaretPosition$1(container, offset - 1) : pos;\n        }\n      }\n    };\n    var normalizeForwards = curry(normalizePosition, true);\n    var normalizeBackwards = curry(normalizePosition, false);\n    var InlineUtils = {\n      isInlineTarget: isInlineTarget,\n      findRootInline: findRootInline,\n      isRtl: isRtl$1,\n      isAtZwsp: isAtZwsp,\n      normalizePosition: normalizePosition,\n      normalizeForwards: normalizeForwards,\n      normalizeBackwards: normalizeBackwards,\n      hasSameParentBlock: hasSameParentBlock\n    };\n\n    var evaluateUntil = function (fns, args) {\n      for (var i = 0; i < fns.length; i++) {\n        var result = fns[i].apply(null, args);\n        if (result.isSome()) {\n          return result;\n        }\n      }\n      return Option.none();\n    };\n    var LazyEvaluator = { evaluateUntil: evaluateUntil };\n\n    var Location = Adt.generate([\n      { before: ['element'] },\n      { start: ['element'] },\n      { end: ['element'] },\n      { after: ['element'] }\n    ]);\n    var rescope = function (rootNode, node) {\n      var parentBlock = getParentBlock(node, rootNode);\n      return parentBlock ? parentBlock : rootNode;\n    };\n    var before$4 = function (isInlineTarget, rootNode, pos) {\n      var nPos = InlineUtils.normalizeForwards(pos);\n      var scope = rescope(rootNode, nPos.container());\n      return InlineUtils.findRootInline(isInlineTarget, scope, nPos).fold(function () {\n        return CaretFinder.nextPosition(scope, nPos).bind(curry(InlineUtils.findRootInline, isInlineTarget, scope)).map(function (inline) {\n          return Location.before(inline);\n        });\n      }, Option.none);\n    };\n    var isNotInsideFormatCaretContainer = function (rootNode, elm) {\n      return getParentCaretContainer(rootNode, elm) === null;\n    };\n    var findInsideRootInline = function (isInlineTarget, rootNode, pos) {\n      return InlineUtils.findRootInline(isInlineTarget, rootNode, pos).filter(curry(isNotInsideFormatCaretContainer, rootNode));\n    };\n    var start = function (isInlineTarget, rootNode, pos) {\n      var nPos = InlineUtils.normalizeBackwards(pos);\n      return findInsideRootInline(isInlineTarget, rootNode, nPos).bind(function (inline) {\n        var prevPos = CaretFinder.prevPosition(inline, nPos);\n        return prevPos.isNone() ? Option.some(Location.start(inline)) : Option.none();\n      });\n    };\n    var end = function (isInlineTarget, rootNode, pos) {\n      var nPos = InlineUtils.normalizeForwards(pos);\n      return findInsideRootInline(isInlineTarget, rootNode, nPos).bind(function (inline) {\n        var nextPos = CaretFinder.nextPosition(inline, nPos);\n        return nextPos.isNone() ? Option.some(Location.end(inline)) : Option.none();\n      });\n    };\n    var after$3 = function (isInlineTarget, rootNode, pos) {\n      var nPos = InlineUtils.normalizeBackwards(pos);\n      var scope = rescope(rootNode, nPos.container());\n      return InlineUtils.findRootInline(isInlineTarget, scope, nPos).fold(function () {\n        return CaretFinder.prevPosition(scope, nPos).bind(curry(InlineUtils.findRootInline, isInlineTarget, scope)).map(function (inline) {\n          return Location.after(inline);\n        });\n      }, Option.none);\n    };\n    var isValidLocation = function (location) {\n      return InlineUtils.isRtl(getElement(location)) === false;\n    };\n    var readLocation = function (isInlineTarget, rootNode, pos) {\n      var location = LazyEvaluator.evaluateUntil([\n        before$4,\n        start,\n        end,\n        after$3\n      ], [\n        isInlineTarget,\n        rootNode,\n        pos\n      ]);\n      return location.filter(isValidLocation);\n    };\n    var getElement = function (location) {\n      return location.fold(identity, identity, identity, identity);\n    };\n    var getName = function (location) {\n      return location.fold(constant('before'), constant('start'), constant('end'), constant('after'));\n    };\n    var outside = function (location) {\n      return location.fold(Location.before, Location.before, Location.after, Location.after);\n    };\n    var inside = function (location) {\n      return location.fold(Location.start, Location.start, Location.end, Location.end);\n    };\n    var isEq$5 = function (location1, location2) {\n      return getName(location1) === getName(location2) && getElement(location1) === getElement(location2);\n    };\n    var betweenInlines = function (forward, isInlineTarget, rootNode, from, to, location) {\n      return lift2(InlineUtils.findRootInline(isInlineTarget, rootNode, from), InlineUtils.findRootInline(isInlineTarget, rootNode, to), function (fromInline, toInline) {\n        if (fromInline !== toInline && InlineUtils.hasSameParentBlock(rootNode, fromInline, toInline)) {\n          return Location.after(forward ? fromInline : toInline);\n        } else {\n          return location;\n        }\n      }).getOr(location);\n    };\n    var skipNoMovement = function (fromLocation, toLocation) {\n      return fromLocation.fold(constant(true), function (fromLocation) {\n        return !isEq$5(fromLocation, toLocation);\n      });\n    };\n    var findLocationTraverse = function (forward, isInlineTarget, rootNode, fromLocation, pos) {\n      var from = InlineUtils.normalizePosition(forward, pos);\n      var to = CaretFinder.fromPosition(forward, rootNode, from).map(curry(InlineUtils.normalizePosition, forward));\n      var location = to.fold(function () {\n        return fromLocation.map(outside);\n      }, function (to) {\n        return readLocation(isInlineTarget, rootNode, to).map(curry(betweenInlines, forward, isInlineTarget, rootNode, from, to)).filter(curry(skipNoMovement, fromLocation));\n      });\n      return location.filter(isValidLocation);\n    };\n    var findLocationSimple = function (forward, location) {\n      if (forward) {\n        return location.fold(compose(Option.some, Location.start), Option.none, compose(Option.some, Location.after), Option.none);\n      } else {\n        return location.fold(Option.none, compose(Option.some, Location.before), Option.none, compose(Option.some, Location.end));\n      }\n    };\n    var findLocation = function (forward, isInlineTarget, rootNode, pos) {\n      var from = InlineUtils.normalizePosition(forward, pos);\n      var fromLocation = readLocation(isInlineTarget, rootNode, from);\n      return readLocation(isInlineTarget, rootNode, from).bind(curry(findLocationSimple, forward)).orThunk(function () {\n        return findLocationTraverse(forward, isInlineTarget, rootNode, fromLocation, pos);\n      });\n    };\n    var BoundaryLocation = {\n      readLocation: readLocation,\n      findLocation: findLocation,\n      prevLocation: curry(findLocation, false),\n      nextLocation: curry(findLocation, true),\n      getElement: getElement,\n      outside: outside,\n      inside: inside\n    };\n\n    var hasSelectionModifyApi = function (editor) {\n      return isFunction(editor.selection.getSel().modify);\n    };\n    var moveRel = function (forward, selection, pos) {\n      var delta = forward ? 1 : -1;\n      selection.setRng(CaretPosition$1(pos.container(), pos.offset() + delta).toRange());\n      selection.getSel().modify('move', forward ? 'forward' : 'backward', 'word');\n      return true;\n    };\n    var moveByWord = function (forward, editor) {\n      var rng = editor.selection.getRng();\n      var pos = forward ? CaretPosition$1.fromRangeEnd(rng) : CaretPosition$1.fromRangeStart(rng);\n      if (!hasSelectionModifyApi(editor)) {\n        return false;\n      } else if (forward && isBeforeInline(pos)) {\n        return moveRel(true, editor.selection, pos);\n      } else if (!forward && isAfterInline(pos)) {\n        return moveRel(false, editor.selection, pos);\n      } else {\n        return false;\n      }\n    };\n    var WordSelection = {\n      hasSelectionModifyApi: hasSelectionModifyApi,\n      moveByWord: moveByWord\n    };\n\n    var setCaretPosition = function (editor, pos) {\n      var rng = editor.dom.createRng();\n      rng.setStart(pos.container(), pos.offset());\n      rng.setEnd(pos.container(), pos.offset());\n      editor.selection.setRng(rng);\n    };\n    var isFeatureEnabled = function (editor) {\n      return editor.settings.inline_boundaries !== false;\n    };\n    var setSelected = function (state, elm) {\n      if (state) {\n        elm.setAttribute('data-mce-selected', 'inline-boundary');\n      } else {\n        elm.removeAttribute('data-mce-selected');\n      }\n    };\n    var renderCaretLocation = function (editor, caret, location) {\n      return BoundaryCaret.renderCaret(caret, location).map(function (pos) {\n        setCaretPosition(editor, pos);\n        return location;\n      });\n    };\n    var findLocation$1 = function (editor, caret, forward) {\n      var rootNode = editor.getBody();\n      var from = CaretPosition$1.fromRangeStart(editor.selection.getRng());\n      var isInlineTarget = curry(InlineUtils.isInlineTarget, editor);\n      var location = BoundaryLocation.findLocation(forward, isInlineTarget, rootNode, from);\n      return location.bind(function (location) {\n        return renderCaretLocation(editor, caret, location);\n      });\n    };\n    var toggleInlines = function (isInlineTarget, dom, elms) {\n      var selectedInlines = filter(dom.select('*[data-mce-selected=\"inline-boundary\"]'), isInlineTarget);\n      var targetInlines = filter(elms, isInlineTarget);\n      each(difference(selectedInlines, targetInlines), curry(setSelected, false));\n      each(difference(targetInlines, selectedInlines), curry(setSelected, true));\n    };\n    var safeRemoveCaretContainer = function (editor, caret) {\n      if (editor.selection.isCollapsed() && editor.composing !== true && caret.get()) {\n        var pos = CaretPosition$1.fromRangeStart(editor.selection.getRng());\n        if (CaretPosition$1.isTextPosition(pos) && InlineUtils.isAtZwsp(pos) === false) {\n          setCaretPosition(editor, CaretContainerRemove.removeAndReposition(caret.get(), pos));\n          caret.set(null);\n        }\n      }\n    };\n    var renderInsideInlineCaret = function (isInlineTarget, editor, caret, elms) {\n      if (editor.selection.isCollapsed()) {\n        var inlines = filter(elms, isInlineTarget);\n        each(inlines, function (inline) {\n          var pos = CaretPosition$1.fromRangeStart(editor.selection.getRng());\n          BoundaryLocation.readLocation(isInlineTarget, editor.getBody(), pos).bind(function (location) {\n            return renderCaretLocation(editor, caret, location);\n          });\n        });\n      }\n    };\n    var move = function (editor, caret, forward) {\n      return function () {\n        return isFeatureEnabled(editor) ? findLocation$1(editor, caret, forward).isSome() : false;\n      };\n    };\n    var moveWord = function (forward, editor, caret) {\n      return function () {\n        return isFeatureEnabled(editor) ? WordSelection.moveByWord(forward, editor) : false;\n      };\n    };\n    var setupSelectedState = function (editor) {\n      var caret = Cell(null);\n      var isInlineTarget = curry(InlineUtils.isInlineTarget, editor);\n      editor.on('NodeChange', function (e) {\n        if (isFeatureEnabled(editor)) {\n          toggleInlines(isInlineTarget, editor.dom, e.parents);\n          safeRemoveCaretContainer(editor, caret);\n          renderInsideInlineCaret(isInlineTarget, editor, caret, e.parents);\n        }\n      });\n      return caret;\n    };\n    var moveNextWord = curry(moveWord, true);\n    var movePrevWord = curry(moveWord, false);\n    var BoundarySelection = {\n      move: move,\n      moveNextWord: moveNextWord,\n      movePrevWord: movePrevWord,\n      setupSelectedState: setupSelectedState,\n      setCaretPosition: setCaretPosition\n    };\n\n    var getNodeClientRects = function (node) {\n      var toArrayWithNode = function (clientRects) {\n        return map(clientRects, function (clientRect) {\n          clientRect = clone$1(clientRect);\n          clientRect.node = node;\n          return clientRect;\n        });\n      };\n      if (NodeType.isElement(node)) {\n        return toArrayWithNode(node.getClientRects());\n      }\n      if (NodeType.isText(node)) {\n        var rng = node.ownerDocument.createRange();\n        rng.setStart(node, 0);\n        rng.setEnd(node, node.data.length);\n        return toArrayWithNode(rng.getClientRects());\n      }\n    };\n    var getClientRects = function (node) {\n      return foldl(node, function (result, node) {\n        return result.concat(getNodeClientRects(node));\n      }, []);\n    };\n\n    var VDirection;\n    (function (VDirection) {\n      VDirection[VDirection['Up'] = -1] = 'Up';\n      VDirection[VDirection['Down'] = 1] = 'Down';\n    }(VDirection || (VDirection = {})));\n    var findUntil = function (direction, root, predicateFn, node) {\n      while (node = findNode(node, direction, isEditableCaretCandidate, root)) {\n        if (predicateFn(node)) {\n          return;\n        }\n      }\n    };\n    var walkUntil = function (direction, isAboveFn, isBeflowFn, root, predicateFn, caretPosition) {\n      var line = 0, node;\n      var result = [];\n      var targetClientRect;\n      var add = function (node) {\n        var i, clientRect, clientRects;\n        clientRects = getClientRects([node]);\n        if (direction === -1) {\n          clientRects = clientRects.reverse();\n        }\n        for (i = 0; i < clientRects.length; i++) {\n          clientRect = clientRects[i];\n          if (isBeflowFn(clientRect, targetClientRect)) {\n            continue;\n          }\n          if (result.length > 0 && isAboveFn(clientRect, ArrUtils.last(result))) {\n            line++;\n          }\n          clientRect.line = line;\n          if (predicateFn(clientRect)) {\n            return true;\n          }\n          result.push(clientRect);\n        }\n      };\n      targetClientRect = ArrUtils.last(caretPosition.getClientRects());\n      if (!targetClientRect) {\n        return result;\n      }\n      node = caretPosition.getNode();\n      add(node);\n      findUntil(direction, root, add, node);\n      return result;\n    };\n    var aboveLineNumber = function (lineNumber, clientRect) {\n      return clientRect.line > lineNumber;\n    };\n    var isLineNumber = function (lineNumber, clientRect) {\n      return clientRect.line === lineNumber;\n    };\n    var upUntil = curry(walkUntil, VDirection.Up, isAbove, isBelow);\n    var downUntil = curry(walkUntil, VDirection.Down, isBelow, isAbove);\n    var positionsUntil = function (direction, root, predicateFn, node) {\n      var caretWalker = CaretWalker(root);\n      var walkFn, isBelowFn, isAboveFn, caretPosition;\n      var result = [];\n      var line = 0, clientRect, targetClientRect;\n      var getClientRect = function (caretPosition) {\n        if (direction === 1) {\n          return ArrUtils.last(caretPosition.getClientRects());\n        }\n        return ArrUtils.last(caretPosition.getClientRects());\n      };\n      if (direction === 1) {\n        walkFn = caretWalker.next;\n        isBelowFn = isBelow;\n        isAboveFn = isAbove;\n        caretPosition = CaretPosition$1.after(node);\n      } else {\n        walkFn = caretWalker.prev;\n        isBelowFn = isAbove;\n        isAboveFn = isBelow;\n        caretPosition = CaretPosition$1.before(node);\n      }\n      targetClientRect = getClientRect(caretPosition);\n      do {\n        if (!caretPosition.isVisible()) {\n          continue;\n        }\n        clientRect = getClientRect(caretPosition);\n        if (isAboveFn(clientRect, targetClientRect)) {\n          continue;\n        }\n        if (result.length > 0 && isBelowFn(clientRect, ArrUtils.last(result))) {\n          line++;\n        }\n        clientRect = clone$1(clientRect);\n        clientRect.position = caretPosition;\n        clientRect.line = line;\n        if (predicateFn(clientRect)) {\n          return result;\n        }\n        result.push(clientRect);\n      } while (caretPosition = walkFn(caretPosition));\n      return result;\n    };\n    var isAboveLine = function (lineNumber) {\n      return function (clientRect) {\n        return aboveLineNumber(lineNumber, clientRect);\n      };\n    };\n    var isLine = function (lineNumber) {\n      return function (clientRect) {\n        return isLineNumber(lineNumber, clientRect);\n      };\n    };\n\n    var isContentEditableFalse$7 = NodeType.isContentEditableFalse;\n    var findNode$1 = findNode;\n    var distanceToRectLeft = function (clientRect, clientX) {\n      return Math.abs(clientRect.left - clientX);\n    };\n    var distanceToRectRight = function (clientRect, clientX) {\n      return Math.abs(clientRect.right - clientX);\n    };\n    var isInside = function (clientX, clientRect) {\n      return clientX >= clientRect.left && clientX <= clientRect.right;\n    };\n    var findClosestClientRect = function (clientRects, clientX) {\n      return ArrUtils.reduce(clientRects, function (oldClientRect, clientRect) {\n        var oldDistance, newDistance;\n        oldDistance = Math.min(distanceToRectLeft(oldClientRect, clientX), distanceToRectRight(oldClientRect, clientX));\n        newDistance = Math.min(distanceToRectLeft(clientRect, clientX), distanceToRectRight(clientRect, clientX));\n        if (isInside(clientX, clientRect)) {\n          return clientRect;\n        }\n        if (isInside(clientX, oldClientRect)) {\n          return oldClientRect;\n        }\n        if (newDistance === oldDistance && isContentEditableFalse$7(clientRect.node)) {\n          return clientRect;\n        }\n        if (newDistance < oldDistance) {\n          return clientRect;\n        }\n        return oldClientRect;\n      });\n    };\n    var walkUntil$1 = function (direction, root, predicateFn, node) {\n      while (node = findNode$1(node, direction, isEditableCaretCandidate, root)) {\n        if (predicateFn(node)) {\n          return;\n        }\n      }\n    };\n    var findLineNodeRects = function (root, targetNodeRect) {\n      var clientRects = [];\n      var collect = function (checkPosFn, node) {\n        var lineRects;\n        lineRects = filter(getClientRects([node]), function (clientRect) {\n          return !checkPosFn(clientRect, targetNodeRect);\n        });\n        clientRects = clientRects.concat(lineRects);\n        return lineRects.length === 0;\n      };\n      clientRects.push(targetNodeRect);\n      walkUntil$1(VDirection.Up, root, curry(collect, isAbove), targetNodeRect.node);\n      walkUntil$1(VDirection.Down, root, curry(collect, isBelow), targetNodeRect.node);\n      return clientRects;\n    };\n    var getFakeCaretTargets = function (root) {\n      return filter(from$1(root.getElementsByTagName('*')), isFakeCaretTarget);\n    };\n    var caretInfo = function (clientRect, clientX) {\n      return {\n        node: clientRect.node,\n        before: distanceToRectLeft(clientRect, clientX) < distanceToRectRight(clientRect, clientX)\n      };\n    };\n    var closestCaret = function (root, clientX, clientY) {\n      var closestNodeRect;\n      var contentEditableFalseNodeRects = getClientRects(getFakeCaretTargets(root));\n      var targetNodeRects = filter(contentEditableFalseNodeRects, function (rect) {\n        return clientY >= rect.top && clientY <= rect.bottom;\n      });\n      closestNodeRect = findClosestClientRect(targetNodeRects, clientX);\n      if (closestNodeRect) {\n        closestNodeRect = findClosestClientRect(findLineNodeRects(root, closestNodeRect), clientX);\n        if (closestNodeRect && isFakeCaretTarget(closestNodeRect.node)) {\n          return caretInfo(closestNodeRect, clientX);\n        }\n      }\n      return null;\n    };\n\n    var isContentEditableTrue$3 = NodeType.isContentEditableTrue;\n    var isContentEditableFalse$8 = NodeType.isContentEditableFalse;\n    var showCaret = function (direction, editor, node, before, scrollIntoView) {\n      return editor._selectionOverrides.showCaret(direction, node, before, scrollIntoView);\n    };\n    var getNodeRange = function (node) {\n      var rng = node.ownerDocument.createRange();\n      rng.selectNode(node);\n      return rng;\n    };\n    var selectNode = function (editor, node) {\n      var e = editor.fire('BeforeObjectSelected', { target: node });\n      if (e.isDefaultPrevented()) {\n        return null;\n      }\n      return getNodeRange(node);\n    };\n    var renderCaretAtRange = function (editor, range, scrollIntoView) {\n      var normalizedRange = normalizeRange(1, editor.getBody(), range);\n      var caretPosition = CaretPosition$1.fromRangeStart(normalizedRange);\n      var caretPositionNode = caretPosition.getNode();\n      if (isContentEditableFalse$8(caretPositionNode)) {\n        return showCaret(1, editor, caretPositionNode, !caretPosition.isAtEnd(), false);\n      }\n      var caretPositionBeforeNode = caretPosition.getNode(true);\n      if (isContentEditableFalse$8(caretPositionBeforeNode)) {\n        return showCaret(1, editor, caretPositionBeforeNode, false, false);\n      }\n      var ceRoot = editor.dom.getParent(caretPosition.getNode(), function (node) {\n        return isContentEditableFalse$8(node) || isContentEditableTrue$3(node);\n      });\n      if (isContentEditableFalse$8(ceRoot)) {\n        return showCaret(1, editor, ceRoot, false, scrollIntoView);\n      }\n      return null;\n    };\n    var renderRangeCaret = function (editor, range, scrollIntoView) {\n      if (!range || !range.collapsed) {\n        return range;\n      }\n      var caretRange = renderCaretAtRange(editor, range, scrollIntoView);\n      if (caretRange) {\n        return caretRange;\n      }\n      return range;\n    };\n\n    var isChar = function (forward, predicate, pos) {\n      return Option.from(pos.container()).filter(NodeType.isText).exists(function (text) {\n        var delta = forward ? 0 : -1;\n        return predicate(text.data.charAt(pos.offset() + delta));\n      });\n    };\n    var isBeforeSpace = curry(isChar, true, isWhiteSpace$1);\n    var isAfterSpace = curry(isChar, false, isWhiteSpace$1);\n    var isEmptyText = function (pos) {\n      var container = pos.container();\n      return NodeType.isText(container) && container.data.length === 0;\n    };\n    var matchesElementPosition = function (before, predicate) {\n      return function (pos) {\n        return Option.from(getChildNodeAtRelativeOffset(before ? 0 : -1, pos)).filter(predicate).isSome();\n      };\n    };\n    var isImageBlock = function (node) {\n      return node.nodeName === 'IMG' && get$4(Element.fromDom(node), 'display') === 'block';\n    };\n    var isCefNode = function (node) {\n      return NodeType.isContentEditableFalse(node) && !NodeType.isBogusAll(node);\n    };\n    var isBeforeImageBlock = matchesElementPosition(true, isImageBlock);\n    var isAfterImageBlock = matchesElementPosition(false, isImageBlock);\n    var isBeforeTable = matchesElementPosition(true, NodeType.isTable);\n    var isAfterTable = matchesElementPosition(false, NodeType.isTable);\n    var isBeforeContentEditableFalse = matchesElementPosition(true, isCefNode);\n    var isAfterContentEditableFalse = matchesElementPosition(false, isCefNode);\n\n    var BreakType;\n    (function (BreakType) {\n      BreakType[BreakType['Br'] = 0] = 'Br';\n      BreakType[BreakType['Block'] = 1] = 'Block';\n      BreakType[BreakType['Wrap'] = 2] = 'Wrap';\n      BreakType[BreakType['Eol'] = 3] = 'Eol';\n    }(BreakType || (BreakType = {})));\n    var flip = function (direction, positions) {\n      return direction === HDirection.Backwards ? reverse(positions) : positions;\n    };\n    var walk$3 = function (direction, caretWalker, pos) {\n      return direction === HDirection.Forwards ? caretWalker.next(pos) : caretWalker.prev(pos);\n    };\n    var getBreakType = function (scope, direction, currentPos, nextPos) {\n      if (NodeType.isBr(nextPos.getNode(direction === HDirection.Forwards))) {\n        return BreakType.Br;\n      } else if (isInSameBlock(currentPos, nextPos) === false) {\n        return BreakType.Block;\n      } else {\n        return BreakType.Wrap;\n      }\n    };\n    var getPositionsUntil = function (predicate, direction, scope, start) {\n      var caretWalker = CaretWalker(scope);\n      var currentPos = start, nextPos;\n      var positions = [];\n      while (currentPos) {\n        nextPos = walk$3(direction, caretWalker, currentPos);\n        if (!nextPos) {\n          break;\n        }\n        if (NodeType.isBr(nextPos.getNode(false))) {\n          if (direction === HDirection.Forwards) {\n            return {\n              positions: flip(direction, positions).concat([nextPos]),\n              breakType: BreakType.Br,\n              breakAt: Option.some(nextPos)\n            };\n          } else {\n            return {\n              positions: flip(direction, positions),\n              breakType: BreakType.Br,\n              breakAt: Option.some(nextPos)\n            };\n          }\n        }\n        if (!nextPos.isVisible()) {\n          currentPos = nextPos;\n          continue;\n        }\n        if (predicate(currentPos, nextPos)) {\n          var breakType = getBreakType(scope, direction, currentPos, nextPos);\n          return {\n            positions: flip(direction, positions),\n            breakType: breakType,\n            breakAt: Option.some(nextPos)\n          };\n        }\n        positions.push(nextPos);\n        currentPos = nextPos;\n      }\n      return {\n        positions: flip(direction, positions),\n        breakType: BreakType.Eol,\n        breakAt: Option.none()\n      };\n    };\n    var getAdjacentLinePositions = function (direction, getPositionsUntilBreak, scope, start) {\n      return getPositionsUntilBreak(scope, start).breakAt.map(function (pos) {\n        var positions = getPositionsUntilBreak(scope, pos).positions;\n        return direction === HDirection.Backwards ? positions.concat(pos) : [pos].concat(positions);\n      }).getOr([]);\n    };\n    var findClosestHorizontalPositionFromPoint = function (positions, x) {\n      return foldl(positions, function (acc, newPos) {\n        return acc.fold(function () {\n          return Option.some(newPos);\n        }, function (lastPos) {\n          return lift2(head(lastPos.getClientRects()), head(newPos.getClientRects()), function (lastRect, newRect) {\n            var lastDist = Math.abs(x - lastRect.left);\n            var newDist = Math.abs(x - newRect.left);\n            return newDist <= lastDist ? newPos : lastPos;\n          }).or(acc);\n        });\n      }, Option.none());\n    };\n    var findClosestHorizontalPosition = function (positions, pos) {\n      return head(pos.getClientRects()).bind(function (targetRect) {\n        return findClosestHorizontalPositionFromPoint(positions, targetRect.left);\n      });\n    };\n    var getPositionsUntilPreviousLine = curry(getPositionsUntil, CaretPosition.isAbove, -1);\n    var getPositionsUntilNextLine = curry(getPositionsUntil, CaretPosition.isBelow, 1);\n    var isAtFirstLine = function (scope, pos) {\n      return getPositionsUntilPreviousLine(scope, pos).breakAt.isNone();\n    };\n    var isAtLastLine = function (scope, pos) {\n      return getPositionsUntilNextLine(scope, pos).breakAt.isNone();\n    };\n    var getPositionsAbove = curry(getAdjacentLinePositions, -1, getPositionsUntilPreviousLine);\n    var getPositionsBelow = curry(getAdjacentLinePositions, 1, getPositionsUntilNextLine);\n    var getFirstLinePositions = function (scope) {\n      return CaretFinder.firstPositionIn(scope).map(function (pos) {\n        return [pos].concat(getPositionsUntilNextLine(scope, pos).positions);\n      }).getOr([]);\n    };\n    var getLastLinePositions = function (scope) {\n      return CaretFinder.lastPositionIn(scope).map(function (pos) {\n        return getPositionsUntilPreviousLine(scope, pos).positions.concat(pos);\n      }).getOr([]);\n    };\n\n    var isContentEditableFalse$9 = NodeType.isContentEditableFalse;\n    var getSelectedNode$1 = getSelectedNode;\n    var moveToCeFalseHorizontally = function (direction, editor, getNextPosFn, range) {\n      var forwards = direction === HDirection.Forwards;\n      var isBeforeContentEditableFalseFn = forwards ? isBeforeContentEditableFalse : isAfterContentEditableFalse;\n      if (!range.collapsed) {\n        var node = getSelectedNode$1(range);\n        if (isContentEditableFalse$9(node)) {\n          return showCaret(direction, editor, node, direction === HDirection.Backwards, true);\n        }\n      }\n      var rangeIsInContainerBlock = isRangeInCaretContainerBlock(range);\n      var caretPosition = getNormalizedRangeEndPoint(direction, editor.getBody(), range);\n      if (isBeforeContentEditableFalseFn(caretPosition)) {\n        return selectNode(editor, caretPosition.getNode(!forwards));\n      }\n      var nextCaretPosition = InlineUtils.normalizePosition(forwards, getNextPosFn(caretPosition));\n      if (!nextCaretPosition) {\n        if (rangeIsInContainerBlock) {\n          return range;\n        }\n        return null;\n      }\n      if (isBeforeContentEditableFalseFn(nextCaretPosition)) {\n        return showCaret(direction, editor, nextCaretPosition.getNode(!forwards), forwards, true);\n      }\n      var peekCaretPosition = getNextPosFn(nextCaretPosition);\n      if (peekCaretPosition && isBeforeContentEditableFalseFn(peekCaretPosition)) {\n        if (isMoveInsideSameBlock(nextCaretPosition, peekCaretPosition)) {\n          return showCaret(direction, editor, peekCaretPosition.getNode(!forwards), forwards, true);\n        }\n      }\n      if (rangeIsInContainerBlock) {\n        return renderRangeCaret(editor, nextCaretPosition.toRange(), true);\n      }\n      return null;\n    };\n    var moveToCeFalseVertically = function (direction, editor, walkerFn, range) {\n      var caretPosition, linePositions, nextLinePositions;\n      var closestNextLineRect, caretClientRect, clientX;\n      var dist1, dist2, contentEditableFalseNode;\n      contentEditableFalseNode = getSelectedNode$1(range);\n      caretPosition = getNormalizedRangeEndPoint(direction, editor.getBody(), range);\n      linePositions = walkerFn(editor.getBody(), isAboveLine(1), caretPosition);\n      nextLinePositions = filter(linePositions, isLine(1));\n      caretClientRect = ArrUtils.last(caretPosition.getClientRects());\n      if (isBeforeContentEditableFalse(caretPosition) || isBeforeTable(caretPosition)) {\n        contentEditableFalseNode = caretPosition.getNode();\n      }\n      if (isAfterContentEditableFalse(caretPosition) || isAfterTable(caretPosition)) {\n        contentEditableFalseNode = caretPosition.getNode(true);\n      }\n      if (!caretClientRect) {\n        return null;\n      }\n      clientX = caretClientRect.left;\n      closestNextLineRect = findClosestClientRect(nextLinePositions, clientX);\n      if (closestNextLineRect) {\n        if (isContentEditableFalse$9(closestNextLineRect.node)) {\n          dist1 = Math.abs(clientX - closestNextLineRect.left);\n          dist2 = Math.abs(clientX - closestNextLineRect.right);\n          return showCaret(direction, editor, closestNextLineRect.node, dist1 < dist2, true);\n        }\n      }\n      if (contentEditableFalseNode) {\n        var caretPositions = positionsUntil(direction, editor.getBody(), isAboveLine(1), contentEditableFalseNode);\n        closestNextLineRect = findClosestClientRect(filter(caretPositions, isLine(1)), clientX);\n        if (closestNextLineRect) {\n          return renderRangeCaret(editor, closestNextLineRect.position.toRange(), true);\n        }\n        closestNextLineRect = ArrUtils.last(filter(caretPositions, isLine(0)));\n        if (closestNextLineRect) {\n          return renderRangeCaret(editor, closestNextLineRect.position.toRange(), true);\n        }\n      }\n    };\n    var createTextBlock = function (editor) {\n      var textBlock = editor.dom.create(Settings.getForcedRootBlock(editor));\n      if (!Env.ie || Env.ie >= 11) {\n        textBlock.innerHTML = '<br data-mce-bogus=\"1\">';\n      }\n      return textBlock;\n    };\n    var exitPreBlock = function (editor, direction, range) {\n      var pre, caretPos, newBlock;\n      var caretWalker = CaretWalker(editor.getBody());\n      var getNextVisualCaretPosition = curry(getVisualCaretPosition, caretWalker.next);\n      var getPrevVisualCaretPosition = curry(getVisualCaretPosition, caretWalker.prev);\n      if (range.collapsed && editor.settings.forced_root_block) {\n        pre = editor.dom.getParent(range.startContainer, 'PRE');\n        if (!pre) {\n          return;\n        }\n        if (direction === 1) {\n          caretPos = getNextVisualCaretPosition(CaretPosition$1.fromRangeStart(range));\n        } else {\n          caretPos = getPrevVisualCaretPosition(CaretPosition$1.fromRangeStart(range));\n        }\n        if (!caretPos) {\n          newBlock = createTextBlock(editor);\n          if (direction === 1) {\n            editor.$(pre).after(newBlock);\n          } else {\n            editor.$(pre).before(newBlock);\n          }\n          editor.selection.select(newBlock, true);\n          editor.selection.collapse();\n        }\n      }\n    };\n    var getHorizontalRange = function (editor, forward) {\n      var caretWalker = CaretWalker(editor.getBody());\n      var getNextVisualCaretPosition = curry(getVisualCaretPosition, caretWalker.next);\n      var getPrevVisualCaretPosition = curry(getVisualCaretPosition, caretWalker.prev);\n      var newRange;\n      var direction = forward ? HDirection.Forwards : HDirection.Backwards;\n      var getNextPosFn = forward ? getNextVisualCaretPosition : getPrevVisualCaretPosition;\n      var range = editor.selection.getRng();\n      newRange = moveToCeFalseHorizontally(direction, editor, getNextPosFn, range);\n      if (newRange) {\n        return newRange;\n      }\n      newRange = exitPreBlock(editor, direction, range);\n      if (newRange) {\n        return newRange;\n      }\n      return null;\n    };\n    var getVerticalRange = function (editor, down) {\n      var newRange;\n      var direction = down ? 1 : -1;\n      var walkerFn = down ? downUntil : upUntil;\n      var range = editor.selection.getRng();\n      newRange = moveToCeFalseVertically(direction, editor, walkerFn, range);\n      if (newRange) {\n        return newRange;\n      }\n      newRange = exitPreBlock(editor, direction, range);\n      if (newRange) {\n        return newRange;\n      }\n      return null;\n    };\n    var moveH = function (editor, forward) {\n      return function () {\n        var newRng = getHorizontalRange(editor, forward);\n        if (newRng) {\n          editor.selection.setRng(newRng);\n          return true;\n        } else {\n          return false;\n        }\n      };\n    };\n    var moveV = function (editor, down) {\n      return function () {\n        var newRng = getVerticalRange(editor, down);\n        if (newRng) {\n          editor.selection.setRng(newRng);\n          return true;\n        } else {\n          return false;\n        }\n      };\n    };\n    var isCefPosition = function (forward) {\n      return function (pos) {\n        return forward ? isAfterContentEditableFalse(pos) : isBeforeContentEditableFalse(pos);\n      };\n    };\n    var moveToLineEndPoint = function (editor, forward) {\n      return function () {\n        var from = forward ? CaretPosition$1.fromRangeEnd(editor.selection.getRng()) : CaretPosition$1.fromRangeStart(editor.selection.getRng());\n        var result = forward ? getPositionsUntilNextLine(editor.getBody(), from) : getPositionsUntilPreviousLine(editor.getBody(), from);\n        var to = forward ? last(result.positions) : head(result.positions);\n        return to.filter(isCefPosition(forward)).fold(constant(false), function (pos) {\n          editor.selection.setRng(pos.toRange());\n          return true;\n        });\n      };\n    };\n\n    var deflate = function (rect, delta) {\n      return {\n        left: rect.left - delta,\n        top: rect.top - delta,\n        right: rect.right + delta * 2,\n        bottom: rect.bottom + delta * 2,\n        width: rect.width + delta,\n        height: rect.height + delta\n      };\n    };\n    var getCorners = function (getYAxisValue, tds) {\n      return bind(tds, function (td) {\n        var rect = deflate(clone$1(td.getBoundingClientRect()), -1);\n        return [\n          {\n            x: rect.left,\n            y: getYAxisValue(rect),\n            cell: td\n          },\n          {\n            x: rect.right,\n            y: getYAxisValue(rect),\n            cell: td\n          }\n        ];\n      });\n    };\n    var findClosestCorner = function (corners, x, y) {\n      return foldl(corners, function (acc, newCorner) {\n        return acc.fold(function () {\n          return Option.some(newCorner);\n        }, function (oldCorner) {\n          var oldDist = Math.sqrt(Math.abs(oldCorner.x - x) + Math.abs(oldCorner.y - y));\n          var newDist = Math.sqrt(Math.abs(newCorner.x - x) + Math.abs(newCorner.y - y));\n          return Option.some(newDist < oldDist ? newCorner : oldCorner);\n        });\n      }, Option.none());\n    };\n    var getClosestCell = function (getYAxisValue, isTargetCorner, table, x, y) {\n      var cells = descendants$1(Element.fromDom(table), 'td,th,caption').map(function (e) {\n        return e.dom();\n      });\n      var corners = filter(getCorners(getYAxisValue, cells), function (corner) {\n        return isTargetCorner(corner, y);\n      });\n      return findClosestCorner(corners, x, y).map(function (corner) {\n        return corner.cell;\n      });\n    };\n    var getBottomValue = function (rect) {\n      return rect.bottom;\n    };\n    var getTopValue = function (rect) {\n      return rect.top;\n    };\n    var isAbove$1 = function (corner, y) {\n      return corner.y < y;\n    };\n    var isBelow$1 = function (corner, y) {\n      return corner.y > y;\n    };\n    var getClosestCellAbove = curry(getClosestCell, getBottomValue, isAbove$1);\n    var getClosestCellBelow = curry(getClosestCell, getTopValue, isBelow$1);\n    var findClosestPositionInAboveCell = function (table, pos) {\n      return head(pos.getClientRects()).bind(function (rect) {\n        return getClosestCellAbove(table, rect.left, rect.top);\n      }).bind(function (cell) {\n        return findClosestHorizontalPosition(getLastLinePositions(cell), pos);\n      });\n    };\n    var findClosestPositionInBelowCell = function (table, pos) {\n      return last(pos.getClientRects()).bind(function (rect) {\n        return getClosestCellBelow(table, rect.left, rect.top);\n      }).bind(function (cell) {\n        return findClosestHorizontalPosition(getFirstLinePositions(cell), pos);\n      });\n    };\n\n    var moveToRange = function (editor, rng) {\n      editor.selection.setRng(rng);\n      ScrollIntoView.scrollRangeIntoView(editor, rng);\n    };\n    var hasNextBreak = function (getPositionsUntil, scope, lineInfo) {\n      return lineInfo.breakAt.map(function (breakPos) {\n        return getPositionsUntil(scope, breakPos).breakAt.isSome();\n      }).getOr(false);\n    };\n    var startsWithWrapBreak = function (lineInfo) {\n      return lineInfo.breakType === BreakType.Wrap && lineInfo.positions.length === 0;\n    };\n    var startsWithBrBreak = function (lineInfo) {\n      return lineInfo.breakType === BreakType.Br && lineInfo.positions.length === 1;\n    };\n    var isAtTableCellLine = function (getPositionsUntil, scope, pos) {\n      var lineInfo = getPositionsUntil(scope, pos);\n      if (startsWithWrapBreak(lineInfo) || !NodeType.isBr(pos.getNode()) && startsWithBrBreak(lineInfo)) {\n        return !hasNextBreak(getPositionsUntil, scope, lineInfo);\n      } else {\n        return lineInfo.breakAt.isNone();\n      }\n    };\n    var isAtFirstTableCellLine = curry(isAtTableCellLine, getPositionsUntilPreviousLine);\n    var isAtLastTableCellLine = curry(isAtTableCellLine, getPositionsUntilNextLine);\n    var isCaretAtStartOrEndOfTable = function (forward, rng, table) {\n      var caretPos = CaretPosition$1.fromRangeStart(rng);\n      return CaretFinder.positionIn(!forward, table).map(function (pos) {\n        return pos.isEqual(caretPos);\n      }).getOr(false);\n    };\n    var navigateHorizontally = function (editor, forward, table, td) {\n      var rng = editor.selection.getRng();\n      var direction = forward ? 1 : -1;\n      if (isFakeCaretTableBrowser() && isCaretAtStartOrEndOfTable(forward, rng, table)) {\n        var newRng = showCaret(direction, editor, table, !forward, true);\n        moveToRange(editor, newRng);\n        return true;\n      }\n      return false;\n    };\n    var getClosestAbovePosition = function (root, table, start) {\n      return findClosestPositionInAboveCell(table, start).orThunk(function () {\n        return head(start.getClientRects()).bind(function (rect) {\n          return findClosestHorizontalPositionFromPoint(getPositionsAbove(root, CaretPosition$1.before(table)), rect.left);\n        });\n      }).getOr(CaretPosition$1.before(table));\n    };\n    var getClosestBelowPosition = function (root, table, start) {\n      return findClosestPositionInBelowCell(table, start).orThunk(function () {\n        return head(start.getClientRects()).bind(function (rect) {\n          return findClosestHorizontalPositionFromPoint(getPositionsBelow(root, CaretPosition$1.after(table)), rect.left);\n        });\n      }).getOr(CaretPosition$1.after(table));\n    };\n    var getTable = function (previous, pos) {\n      var node = pos.getNode(previous);\n      return NodeType.isElement(node) && node.nodeName === 'TABLE' ? Option.some(node) : Option.none();\n    };\n    var renderBlock = function (down, editor, table, pos) {\n      var forcedRootBlock = Settings.getForcedRootBlock(editor);\n      if (forcedRootBlock) {\n        editor.undoManager.transact(function () {\n          var element = Element.fromTag(forcedRootBlock);\n          setAll(element, Settings.getForcedRootBlockAttrs(editor));\n          append(element, Element.fromTag('br'));\n          if (down) {\n            after(Element.fromDom(table), element);\n          } else {\n            before(Element.fromDom(table), element);\n          }\n          var rng = editor.dom.createRng();\n          rng.setStart(element.dom(), 0);\n          rng.setEnd(element.dom(), 0);\n          moveToRange(editor, rng);\n        });\n      } else {\n        moveToRange(editor, pos.toRange());\n      }\n    };\n    var moveCaret = function (editor, down, pos) {\n      var table = down ? getTable(true, pos) : getTable(false, pos);\n      var last = down === false;\n      table.fold(function () {\n        return moveToRange(editor, pos.toRange());\n      }, function (table) {\n        return CaretFinder.positionIn(last, editor.getBody()).filter(function (lastPos) {\n          return lastPos.isEqual(pos);\n        }).fold(function () {\n          return moveToRange(editor, pos.toRange());\n        }, function (_) {\n          return renderBlock(down, editor, table, pos);\n        });\n      });\n    };\n    var navigateVertically = function (editor, down, table, td) {\n      var rng = editor.selection.getRng();\n      var pos = CaretPosition$1.fromRangeStart(rng);\n      var root = editor.getBody();\n      if (!down && isAtFirstTableCellLine(td, pos)) {\n        var newPos = getClosestAbovePosition(root, table, pos);\n        moveCaret(editor, down, newPos);\n        return true;\n      } else if (down && isAtLastTableCellLine(td, pos)) {\n        var newPos = getClosestBelowPosition(root, table, pos);\n        moveCaret(editor, down, newPos);\n        return true;\n      } else {\n        return false;\n      }\n    };\n    var moveH$1 = function (editor, forward) {\n      return function () {\n        return Option.from(editor.dom.getParent(editor.selection.getNode(), 'td,th')).bind(function (td) {\n          return Option.from(editor.dom.getParent(td, 'table')).map(function (table) {\n            return navigateHorizontally(editor, forward, table);\n          });\n        }).getOr(false);\n      };\n    };\n    var moveV$1 = function (editor, forward) {\n      return function () {\n        return Option.from(editor.dom.getParent(editor.selection.getNode(), 'td,th')).bind(function (td) {\n          return Option.from(editor.dom.getParent(td, 'table')).map(function (table) {\n            return navigateVertically(editor, forward, table, td);\n          });\n        }).getOr(false);\n      };\n    };\n\n    var isTarget = function (node) {\n      return contains(['figcaption'], name(node));\n    };\n    var rangeBefore = function (target) {\n      var rng = domGlobals.document.createRange();\n      rng.setStartBefore(target.dom());\n      rng.setEndBefore(target.dom());\n      return rng;\n    };\n    var insertElement = function (root, elm, forward) {\n      if (forward) {\n        append(root, elm);\n      } else {\n        prepend(root, elm);\n      }\n    };\n    var insertBr = function (root, forward) {\n      var br = Element.fromTag('br');\n      insertElement(root, br, forward);\n      return rangeBefore(br);\n    };\n    var insertBlock$1 = function (root, forward, blockName, attrs) {\n      var block = Element.fromTag(blockName);\n      var br = Element.fromTag('br');\n      setAll(block, attrs);\n      append(block, br);\n      insertElement(root, block, forward);\n      return rangeBefore(br);\n    };\n    var insertEmptyLine = function (root, rootBlockName, attrs, forward) {\n      if (rootBlockName === '') {\n        return insertBr(root, forward);\n      } else {\n        return insertBlock$1(root, forward, rootBlockName, attrs);\n      }\n    };\n    var getClosestTargetBlock = function (pos, root) {\n      var isRoot = curry(eq, root);\n      return closest(Element.fromDom(pos.container()), isBlock, isRoot).filter(isTarget);\n    };\n    var isAtFirstOrLastLine = function (root, forward, pos) {\n      return forward ? isAtLastLine(root.dom(), pos) : isAtFirstLine(root.dom(), pos);\n    };\n    var moveCaretToNewEmptyLine = function (editor, forward) {\n      var root = Element.fromDom(editor.getBody());\n      var pos = CaretPosition$1.fromRangeStart(editor.selection.getRng());\n      var rootBlock = Settings.getForcedRootBlock(editor);\n      var rootBlockAttrs = Settings.getForcedRootBlockAttrs(editor);\n      return getClosestTargetBlock(pos, root).exists(function () {\n        if (isAtFirstOrLastLine(root, forward, pos)) {\n          var rng = insertEmptyLine(root, rootBlock, rootBlockAttrs, forward);\n          editor.selection.setRng(rng);\n          return true;\n        } else {\n          return false;\n        }\n      });\n    };\n    var moveV$2 = function (editor, forward) {\n      return function () {\n        if (editor.selection.isCollapsed()) {\n          return moveCaretToNewEmptyLine(editor, forward);\n        } else {\n          return false;\n        }\n      };\n    };\n\n    var defaultPatterns = function (patterns) {\n      return map(patterns, function (pattern) {\n        return __assign({\n          shiftKey: false,\n          altKey: false,\n          ctrlKey: false,\n          metaKey: false,\n          keyCode: 0,\n          action: noop\n        }, pattern);\n      });\n    };\n    var matchesEvent = function (pattern, evt) {\n      return evt.keyCode === pattern.keyCode && evt.shiftKey === pattern.shiftKey && evt.altKey === pattern.altKey && evt.ctrlKey === pattern.ctrlKey && evt.metaKey === pattern.metaKey;\n    };\n    var match$1 = function (patterns, evt) {\n      return bind(defaultPatterns(patterns), function (pattern) {\n        return matchesEvent(pattern, evt) ? [pattern] : [];\n      });\n    };\n    var action = function (f) {\n      var x = [];\n      for (var _i = 1; _i < arguments.length; _i++) {\n        x[_i - 1] = arguments[_i];\n      }\n      var args = Array.prototype.slice.call(arguments, 1);\n      return function () {\n        return f.apply(null, args);\n      };\n    };\n    var execute = function (patterns, evt) {\n      return find(match$1(patterns, evt), function (pattern) {\n        return pattern.action();\n      });\n    };\n    var MatchKeys = {\n      match: match$1,\n      action: action,\n      execute: execute\n    };\n\n    var executeKeydownOverride = function (editor, caret, evt) {\n      var os = detect$3().os;\n      MatchKeys.execute([\n        {\n          keyCode: VK.RIGHT,\n          action: moveH(editor, true)\n        },\n        {\n          keyCode: VK.LEFT,\n          action: moveH(editor, false)\n        },\n        {\n          keyCode: VK.UP,\n          action: moveV(editor, false)\n        },\n        {\n          keyCode: VK.DOWN,\n          action: moveV(editor, true)\n        },\n        {\n          keyCode: VK.RIGHT,\n          action: moveH$1(editor, true)\n        },\n        {\n          keyCode: VK.LEFT,\n          action: moveH$1(editor, false)\n        },\n        {\n          keyCode: VK.UP,\n          action: moveV$1(editor, false)\n        },\n        {\n          keyCode: VK.DOWN,\n          action: moveV$1(editor, true)\n        },\n        {\n          keyCode: VK.RIGHT,\n          action: BoundarySelection.move(editor, caret, true)\n        },\n        {\n          keyCode: VK.LEFT,\n          action: BoundarySelection.move(editor, caret, false)\n        },\n        {\n          keyCode: VK.RIGHT,\n          ctrlKey: !os.isOSX(),\n          altKey: os.isOSX(),\n          action: BoundarySelection.moveNextWord(editor, caret)\n        },\n        {\n          keyCode: VK.LEFT,\n          ctrlKey: !os.isOSX(),\n          altKey: os.isOSX(),\n          action: BoundarySelection.movePrevWord(editor, caret)\n        },\n        {\n          keyCode: VK.UP,\n          action: moveV$2(editor, false)\n        },\n        {\n          keyCode: VK.DOWN,\n          action: moveV$2(editor, true)\n        }\n      ], evt).each(function (_) {\n        evt.preventDefault();\n      });\n    };\n    var setup$9 = function (editor, caret) {\n      editor.on('keydown', function (evt) {\n        if (evt.isDefaultPrevented() === false) {\n          executeKeydownOverride(editor, caret, evt);\n        }\n      });\n    };\n    var ArrowKeys = { setup: setup$9 };\n\n    var isBeforeRoot = function (rootNode) {\n      return function (elm) {\n        return eq(rootNode, Element.fromDom(elm.dom().parentNode));\n      };\n    };\n    var getParentBlock$1 = function (rootNode, elm) {\n      return contains$2(rootNode, elm) ? closest(elm, function (element) {\n        return isTextBlock(element) || isListItem(element);\n      }, isBeforeRoot(rootNode)) : Option.none();\n    };\n    var placeCaretInEmptyBody = function (editor) {\n      var body = editor.getBody();\n      var node = body.firstChild && editor.dom.isBlock(body.firstChild) ? body.firstChild : body;\n      editor.selection.setCursorLocation(node, 0);\n    };\n    var paddEmptyBody = function (editor) {\n      if (editor.dom.isEmpty(editor.getBody())) {\n        editor.setContent('');\n        placeCaretInEmptyBody(editor);\n      }\n    };\n    var willDeleteLastPositionInElement = function (forward, fromPos, elm) {\n      return lift2(CaretFinder.firstPositionIn(elm), CaretFinder.lastPositionIn(elm), function (firstPos, lastPos) {\n        var normalizedFirstPos = InlineUtils.normalizePosition(true, firstPos);\n        var normalizedLastPos = InlineUtils.normalizePosition(false, lastPos);\n        var normalizedFromPos = InlineUtils.normalizePosition(false, fromPos);\n        if (forward) {\n          return CaretFinder.nextPosition(elm, normalizedFromPos).map(function (nextPos) {\n            return nextPos.isEqual(normalizedLastPos) && fromPos.isEqual(normalizedFirstPos);\n          }).getOr(false);\n        } else {\n          return CaretFinder.prevPosition(elm, normalizedFromPos).map(function (prevPos) {\n            return prevPos.isEqual(normalizedFirstPos) && fromPos.isEqual(normalizedLastPos);\n          }).getOr(false);\n        }\n      }).getOr(true);\n    };\n    var DeleteUtils = {\n      getParentBlock: getParentBlock$1,\n      paddEmptyBody: paddEmptyBody,\n      willDeleteLastPositionInElement: willDeleteLastPositionInElement\n    };\n\n    var blockPosition = function (block, position) {\n      return {\n        block: constant(block),\n        position: constant(position)\n      };\n    };\n    var blockBoundary = function (from, to) {\n      return {\n        from: constant(from),\n        to: constant(to)\n      };\n    };\n    var getBlockPosition = function (rootNode, pos) {\n      var rootElm = Element.fromDom(rootNode);\n      var containerElm = Element.fromDom(pos.container());\n      return DeleteUtils.getParentBlock(rootElm, containerElm).map(function (block) {\n        return blockPosition(block, pos);\n      });\n    };\n    var isDifferentBlocks = function (blockBoundary) {\n      return eq(blockBoundary.from().block(), blockBoundary.to().block()) === false;\n    };\n    var hasSameParent = function (blockBoundary) {\n      return parent(blockBoundary.from().block()).bind(function (parent1) {\n        return parent(blockBoundary.to().block()).filter(function (parent2) {\n          return eq(parent1, parent2);\n        });\n      }).isSome();\n    };\n    var isEditable = function (blockBoundary) {\n      return NodeType.isContentEditableFalse(blockBoundary.from().block().dom()) === false && NodeType.isContentEditableFalse(blockBoundary.to().block().dom()) === false;\n    };\n    var skipLastBr = function (rootNode, forward, blockPosition) {\n      if (NodeType.isBr(blockPosition.position().getNode()) && Empty.isEmpty(blockPosition.block()) === false) {\n        return CaretFinder.positionIn(false, blockPosition.block().dom()).bind(function (lastPositionInBlock) {\n          if (lastPositionInBlock.isEqual(blockPosition.position())) {\n            return CaretFinder.fromPosition(forward, rootNode, lastPositionInBlock).bind(function (to) {\n              return getBlockPosition(rootNode, to);\n            });\n          } else {\n            return Option.some(blockPosition);\n          }\n        }).getOr(blockPosition);\n      } else {\n        return blockPosition;\n      }\n    };\n    var readFromRange = function (rootNode, forward, rng) {\n      var fromBlockPos = getBlockPosition(rootNode, CaretPosition$1.fromRangeStart(rng));\n      var toBlockPos = fromBlockPos.bind(function (blockPos) {\n        return CaretFinder.fromPosition(forward, rootNode, blockPos.position()).bind(function (to) {\n          return getBlockPosition(rootNode, to).map(function (blockPos) {\n            return skipLastBr(rootNode, forward, blockPos);\n          });\n        });\n      });\n      return lift2(fromBlockPos, toBlockPos, blockBoundary).filter(function (blockBoundary) {\n        return isDifferentBlocks(blockBoundary) && hasSameParent(blockBoundary) && isEditable(blockBoundary);\n      });\n    };\n    var read$3 = function (rootNode, forward, rng) {\n      return rng.collapsed ? readFromRange(rootNode, forward, rng) : Option.none();\n    };\n    var BlockMergeBoundary = { read: read$3 };\n\n    var getChildrenUntilBlockBoundary = function (block) {\n      var children$1 = children(block);\n      return findIndex(children$1, isBlock).fold(function () {\n        return children$1;\n      }, function (index) {\n        return children$1.slice(0, index);\n      });\n    };\n    var extractChildren = function (block) {\n      var children = getChildrenUntilBlockBoundary(block);\n      each(children, remove);\n      return children;\n    };\n    var removeEmptyRoot = function (rootNode, block) {\n      var parents = Parents.parentsAndSelf(block, rootNode);\n      return find(parents.reverse(), function (element) {\n        return Empty.isEmpty(element);\n      }).each(remove);\n    };\n    var isEmptyBefore = function (el) {\n      return filter(prevSiblings(el), function (el) {\n        return !Empty.isEmpty(el);\n      }).length === 0;\n    };\n    var nestedBlockMerge = function (rootNode, fromBlock, toBlock, insertionPoint) {\n      if (Empty.isEmpty(toBlock)) {\n        PaddingBr.fillWithPaddingBr(toBlock);\n        return CaretFinder.firstPositionIn(toBlock.dom());\n      }\n      if (isEmptyBefore(insertionPoint) && Empty.isEmpty(fromBlock)) {\n        before(insertionPoint, Element.fromTag('br'));\n      }\n      var position = CaretFinder.prevPosition(toBlock.dom(), CaretPosition$1.before(insertionPoint.dom()));\n      each(extractChildren(fromBlock), function (child) {\n        before(insertionPoint, child);\n      });\n      removeEmptyRoot(rootNode, fromBlock);\n      return position;\n    };\n    var sidelongBlockMerge = function (rootNode, fromBlock, toBlock) {\n      if (Empty.isEmpty(toBlock)) {\n        remove(toBlock);\n        if (Empty.isEmpty(fromBlock)) {\n          PaddingBr.fillWithPaddingBr(fromBlock);\n        }\n        return CaretFinder.firstPositionIn(fromBlock.dom());\n      }\n      var position = CaretFinder.lastPositionIn(toBlock.dom());\n      each(extractChildren(fromBlock), function (child) {\n        append(toBlock, child);\n      });\n      removeEmptyRoot(rootNode, fromBlock);\n      return position;\n    };\n    var findInsertionPoint = function (toBlock, block) {\n      var parentsAndSelf = Parents.parentsAndSelf(block, toBlock);\n      return Option.from(parentsAndSelf[parentsAndSelf.length - 1]);\n    };\n    var getInsertionPoint = function (fromBlock, toBlock) {\n      return contains$2(toBlock, fromBlock) ? findInsertionPoint(toBlock, fromBlock) : Option.none();\n    };\n    var trimBr = function (first, block) {\n      CaretFinder.positionIn(first, block.dom()).map(function (position) {\n        return position.getNode();\n      }).map(Element.fromDom).filter(isBr$1).each(remove);\n    };\n    var mergeBlockInto = function (rootNode, fromBlock, toBlock) {\n      trimBr(true, fromBlock);\n      trimBr(false, toBlock);\n      return getInsertionPoint(fromBlock, toBlock).fold(curry(sidelongBlockMerge, rootNode, fromBlock, toBlock), curry(nestedBlockMerge, rootNode, fromBlock, toBlock));\n    };\n    var mergeBlocks = function (rootNode, forward, block1, block2) {\n      return forward ? mergeBlockInto(rootNode, block2, block1) : mergeBlockInto(rootNode, block1, block2);\n    };\n    var MergeBlocks = { mergeBlocks: mergeBlocks };\n\n    var backspaceDelete = function (editor, forward) {\n      var rootNode = Element.fromDom(editor.getBody());\n      var position = BlockMergeBoundary.read(rootNode.dom(), forward, editor.selection.getRng()).bind(function (blockBoundary) {\n        return MergeBlocks.mergeBlocks(rootNode, forward, blockBoundary.from().block(), blockBoundary.to().block());\n      });\n      position.each(function (pos) {\n        editor.selection.setRng(pos.toRange());\n      });\n      return position.isSome();\n    };\n    var BlockBoundaryDelete = { backspaceDelete: backspaceDelete };\n\n    var deleteRangeMergeBlocks = function (rootNode, selection) {\n      var rng = selection.getRng();\n      return lift2(DeleteUtils.getParentBlock(rootNode, Element.fromDom(rng.startContainer)), DeleteUtils.getParentBlock(rootNode, Element.fromDom(rng.endContainer)), function (block1, block2) {\n        if (eq(block1, block2) === false) {\n          rng.deleteContents();\n          MergeBlocks.mergeBlocks(rootNode, true, block1, block2).each(function (pos) {\n            selection.setRng(pos.toRange());\n          });\n          return true;\n        } else {\n          return false;\n        }\n      }).getOr(false);\n    };\n    var isRawNodeInTable = function (root, rawNode) {\n      var node = Element.fromDom(rawNode);\n      var isRoot = curry(eq, root);\n      return ancestor(node, isTableCell, isRoot).isSome();\n    };\n    var isSelectionInTable = function (root, rng) {\n      return isRawNodeInTable(root, rng.startContainer) || isRawNodeInTable(root, rng.endContainer);\n    };\n    var isEverythingSelected = function (root, rng) {\n      var noPrevious = CaretFinder.prevPosition(root.dom(), CaretPosition$1.fromRangeStart(rng)).isNone();\n      var noNext = CaretFinder.nextPosition(root.dom(), CaretPosition$1.fromRangeEnd(rng)).isNone();\n      return !isSelectionInTable(root, rng) && noPrevious && noNext;\n    };\n    var emptyEditor = function (editor) {\n      editor.setContent('');\n      editor.selection.setCursorLocation();\n      return true;\n    };\n    var deleteRange = function (editor) {\n      var rootNode = Element.fromDom(editor.getBody());\n      var rng = editor.selection.getRng();\n      return isEverythingSelected(rootNode, rng) ? emptyEditor(editor) : deleteRangeMergeBlocks(rootNode, editor.selection);\n    };\n    var backspaceDelete$1 = function (editor, forward) {\n      return editor.selection.isCollapsed() ? false : deleteRange(editor);\n    };\n    var BlockRangeDelete = { backspaceDelete: backspaceDelete$1 };\n\n    var isBr$5 = function (pos) {\n      return getElementFromPosition(pos).exists(isBr$1);\n    };\n    var findBr = function (forward, root, pos) {\n      var parentBlocks = filter(Parents.parentsAndSelf(Element.fromDom(pos.container()), root), isBlock);\n      var scope = head(parentBlocks).getOr(root);\n      return CaretFinder.fromPosition(forward, scope.dom(), pos).filter(isBr$5);\n    };\n    var isBeforeBr = function (root, pos) {\n      return getElementFromPosition(pos).exists(isBr$1) || findBr(true, root, pos).isSome();\n    };\n    var isAfterBr = function (root, pos) {\n      return getElementFromPrevPosition(pos).exists(isBr$1) || findBr(false, root, pos).isSome();\n    };\n    var findPreviousBr = curry(findBr, false);\n    var findNextBr = curry(findBr, true);\n\n    var isCompoundElement = function (node) {\n      return isTableCell(Element.fromDom(node)) || isListItem(Element.fromDom(node));\n    };\n    var DeleteAction = Adt.generate([\n      { remove: ['element'] },\n      { moveToElement: ['element'] },\n      { moveToPosition: ['position'] }\n    ]);\n    var isAtContentEditableBlockCaret = function (forward, from) {\n      var elm = from.getNode(forward === false);\n      var caretLocation = forward ? 'after' : 'before';\n      return NodeType.isElement(elm) && elm.getAttribute('data-mce-caret') === caretLocation;\n    };\n    var isDeleteFromCefDifferentBlocks = function (root, forward, from, to) {\n      var inSameBlock = function (elm) {\n        return isInline(Element.fromDom(elm)) && !isInSameBlock(from, to, root);\n      };\n      return getRelativeCefElm(!forward, from).fold(function () {\n        return getRelativeCefElm(forward, to).fold(constant(false), inSameBlock);\n      }, inSameBlock);\n    };\n    var deleteEmptyBlockOrMoveToCef = function (root, forward, from, to) {\n      var toCefElm = to.getNode(forward === false);\n      return DeleteUtils.getParentBlock(Element.fromDom(root), Element.fromDom(from.getNode())).map(function (blockElm) {\n        return Empty.isEmpty(blockElm) ? DeleteAction.remove(blockElm.dom()) : DeleteAction.moveToElement(toCefElm);\n      }).orThunk(function () {\n        return Option.some(DeleteAction.moveToElement(toCefElm));\n      });\n    };\n    var findCefPosition = function (root, forward, from) {\n      return CaretFinder.fromPosition(forward, root, from).bind(function (to) {\n        if (isCompoundElement(to.getNode())) {\n          return Option.none();\n        } else if (isDeleteFromCefDifferentBlocks(root, forward, from, to)) {\n          return Option.none();\n        } else if (forward && NodeType.isContentEditableFalse(to.getNode())) {\n          return deleteEmptyBlockOrMoveToCef(root, forward, from, to);\n        } else if (forward === false && NodeType.isContentEditableFalse(to.getNode(true))) {\n          return deleteEmptyBlockOrMoveToCef(root, forward, from, to);\n        } else if (forward && isAfterContentEditableFalse(from)) {\n          return Option.some(DeleteAction.moveToPosition(to));\n        } else if (forward === false && isBeforeContentEditableFalse(from)) {\n          return Option.some(DeleteAction.moveToPosition(to));\n        } else {\n          return Option.none();\n        }\n      });\n    };\n    var getContentEditableBlockAction = function (forward, elm) {\n      if (forward && NodeType.isContentEditableFalse(elm.nextSibling)) {\n        return Option.some(DeleteAction.moveToElement(elm.nextSibling));\n      } else if (forward === false && NodeType.isContentEditableFalse(elm.previousSibling)) {\n        return Option.some(DeleteAction.moveToElement(elm.previousSibling));\n      } else {\n        return Option.none();\n      }\n    };\n    var skipMoveToActionFromInlineCefToContent = function (root, from, deleteAction) {\n      return deleteAction.fold(function (elm) {\n        return Option.some(DeleteAction.remove(elm));\n      }, function (elm) {\n        return Option.some(DeleteAction.moveToElement(elm));\n      }, function (to) {\n        if (isInSameBlock(from, to, root)) {\n          return Option.none();\n        } else {\n          return Option.some(DeleteAction.moveToPosition(to));\n        }\n      });\n    };\n    var getContentEditableAction = function (root, forward, from) {\n      if (isAtContentEditableBlockCaret(forward, from)) {\n        return getContentEditableBlockAction(forward, from.getNode(forward === false)).fold(function () {\n          return findCefPosition(root, forward, from);\n        }, Option.some);\n      } else {\n        return findCefPosition(root, forward, from).bind(function (deleteAction) {\n          return skipMoveToActionFromInlineCefToContent(root, from, deleteAction);\n        });\n      }\n    };\n    var read$4 = function (root, forward, rng) {\n      var normalizedRange = normalizeRange(forward ? 1 : -1, root, rng);\n      var from = CaretPosition$1.fromRangeStart(normalizedRange);\n      var rootElement = Element.fromDom(root);\n      if (forward === false && isAfterContentEditableFalse(from)) {\n        return Option.some(DeleteAction.remove(from.getNode(true)));\n      } else if (forward && isBeforeContentEditableFalse(from)) {\n        return Option.some(DeleteAction.remove(from.getNode()));\n      } else if (forward === false && isBeforeContentEditableFalse(from) && isAfterBr(rootElement, from)) {\n        return findPreviousBr(rootElement, from).map(function (br) {\n          return DeleteAction.remove(br.getNode());\n        });\n      } else if (forward && isAfterContentEditableFalse(from) && isBeforeBr(rootElement, from)) {\n        return findNextBr(rootElement, from).map(function (br) {\n          return DeleteAction.remove(br.getNode());\n        });\n      } else {\n        return getContentEditableAction(root, forward, from);\n      }\n    };\n\n    var deleteElement$1 = function (editor, forward) {\n      return function (element) {\n        editor._selectionOverrides.hideFakeCaret();\n        DeleteElement.deleteElement(editor, forward, Element.fromDom(element));\n        return true;\n      };\n    };\n    var moveToElement = function (editor, forward) {\n      return function (element) {\n        var pos = forward ? CaretPosition$1.before(element) : CaretPosition$1.after(element);\n        editor.selection.setRng(pos.toRange());\n        return true;\n      };\n    };\n    var moveToPosition = function (editor) {\n      return function (pos) {\n        editor.selection.setRng(pos.toRange());\n        return true;\n      };\n    };\n    var getAncestorCe = function (editor, node) {\n      return Option.from(getContentEditableRoot$1(editor.getBody(), node));\n    };\n    var backspaceDeleteCaret = function (editor, forward) {\n      var selectedNode = editor.selection.getNode();\n      return getAncestorCe(editor, selectedNode).filter(NodeType.isContentEditableFalse).fold(function () {\n        var result = read$4(editor.getBody(), forward, editor.selection.getRng()).map(function (deleteAction) {\n          return deleteAction.fold(deleteElement$1(editor, forward), moveToElement(editor, forward), moveToPosition(editor));\n        });\n        return result.getOr(false);\n      }, function () {\n        return true;\n      });\n    };\n    var deleteOffscreenSelection = function (rootElement) {\n      each(descendants$1(rootElement, '.mce-offscreen-selection'), remove);\n    };\n    var backspaceDeleteRange = function (editor, forward) {\n      var selectedNode = editor.selection.getNode();\n      if (NodeType.isContentEditableFalse(selectedNode)) {\n        var hasCefAncestor = getAncestorCe(editor, selectedNode.parentNode).filter(NodeType.isContentEditableFalse);\n        return hasCefAncestor.fold(function () {\n          deleteOffscreenSelection(Element.fromDom(editor.getBody()));\n          DeleteElement.deleteElement(editor, forward, Element.fromDom(editor.selection.getNode()));\n          DeleteUtils.paddEmptyBody(editor);\n          return true;\n        }, function () {\n          return true;\n        });\n      }\n      return false;\n    };\n    var getContentEditableRoot$1 = function (root, node) {\n      while (node && node !== root) {\n        if (NodeType.isContentEditableTrue(node) || NodeType.isContentEditableFalse(node)) {\n          return node;\n        }\n        node = node.parentNode;\n      }\n      return null;\n    };\n    var paddEmptyElement = function (editor) {\n      var br;\n      var ceRoot = getContentEditableRoot$1(editor.getBody(), editor.selection.getNode());\n      if (NodeType.isContentEditableTrue(ceRoot) && editor.dom.isBlock(ceRoot) && editor.dom.isEmpty(ceRoot)) {\n        br = editor.dom.create('br', { 'data-mce-bogus': '1' });\n        editor.dom.setHTML(ceRoot, '');\n        ceRoot.appendChild(br);\n        editor.selection.setRng(CaretPosition$1.before(br).toRange());\n      }\n      return true;\n    };\n    var backspaceDelete$2 = function (editor, forward) {\n      if (editor.selection.isCollapsed()) {\n        return backspaceDeleteCaret(editor, forward);\n      } else {\n        return backspaceDeleteRange(editor, forward);\n      }\n    };\n    var CefDelete = {\n      backspaceDelete: backspaceDelete$2,\n      paddEmptyElement: paddEmptyElement\n    };\n\n    var trimEmptyTextNode$1 = function (dom, node) {\n      if (NodeType.isText(node) && node.data.length === 0) {\n        dom.remove(node);\n      }\n    };\n    var deleteContentAndShowCaret = function (editor, range, node, direction, forward, peekCaretPosition) {\n      var caretRange = showCaret(direction, editor, peekCaretPosition.getNode(!forward), forward, true);\n      if (range.collapsed) {\n        var deleteRange = range.cloneRange();\n        if (forward) {\n          deleteRange.setEnd(caretRange.startContainer, caretRange.startOffset);\n        } else {\n          deleteRange.setStart(caretRange.endContainer, caretRange.endOffset);\n        }\n        deleteRange.deleteContents();\n      } else {\n        range.deleteContents();\n      }\n      editor.selection.setRng(caretRange);\n      trimEmptyTextNode$1(editor.dom, node);\n      return true;\n    };\n    var deleteCefBoundaryText = function (editor, forward) {\n      var range = editor.selection.getRng();\n      if (!NodeType.isText(range.commonAncestorContainer)) {\n        return false;\n      }\n      var direction = forward ? HDirection.Forwards : HDirection.Backwards;\n      var caretWalker = CaretWalker(editor.getBody());\n      var getNextVisualCaretPosition = curry(getVisualCaretPosition, caretWalker.next);\n      var getPrevVisualCaretPosition = curry(getVisualCaretPosition, caretWalker.prev);\n      var getNextPosFn = forward ? getNextVisualCaretPosition : getPrevVisualCaretPosition;\n      var isBeforeContentEditableFalseFn = forward ? isBeforeContentEditableFalse : isAfterContentEditableFalse;\n      var caretPosition = getNormalizedRangeEndPoint(direction, editor.getBody(), range);\n      var nextCaretPosition = InlineUtils.normalizePosition(forward, getNextPosFn(caretPosition));\n      if (!nextCaretPosition || !isMoveInsideSameBlock(caretPosition, nextCaretPosition)) {\n        return false;\n      } else if (isBeforeContentEditableFalseFn(nextCaretPosition)) {\n        return deleteContentAndShowCaret(editor, range, caretPosition.getNode(), direction, forward, nextCaretPosition);\n      }\n      var peekCaretPosition = getNextPosFn(nextCaretPosition);\n      if (peekCaretPosition && isBeforeContentEditableFalseFn(peekCaretPosition)) {\n        if (isMoveInsideSameBlock(nextCaretPosition, peekCaretPosition)) {\n          return deleteContentAndShowCaret(editor, range, caretPosition.getNode(), direction, forward, peekCaretPosition);\n        }\n      }\n      return false;\n    };\n    var backspaceDelete$3 = function (editor, forward) {\n      return deleteCefBoundaryText(editor, forward);\n    };\n    var CefBoundaryDelete = { backspaceDelete: backspaceDelete$3 };\n\n    var isFeatureEnabled$1 = function (editor) {\n      return editor.settings.inline_boundaries !== false;\n    };\n    var rangeFromPositions = function (from, to) {\n      var range = domGlobals.document.createRange();\n      range.setStart(from.container(), from.offset());\n      range.setEnd(to.container(), to.offset());\n      return range;\n    };\n    var hasOnlyTwoOrLessPositionsLeft = function (elm) {\n      return lift2(CaretFinder.firstPositionIn(elm), CaretFinder.lastPositionIn(elm), function (firstPos, lastPos) {\n        var normalizedFirstPos = InlineUtils.normalizePosition(true, firstPos);\n        var normalizedLastPos = InlineUtils.normalizePosition(false, lastPos);\n        return CaretFinder.nextPosition(elm, normalizedFirstPos).map(function (pos) {\n          return pos.isEqual(normalizedLastPos);\n        }).getOr(true);\n      }).getOr(true);\n    };\n    var setCaretLocation = function (editor, caret) {\n      return function (location) {\n        return BoundaryCaret.renderCaret(caret, location).map(function (pos) {\n          BoundarySelection.setCaretPosition(editor, pos);\n          return true;\n        }).getOr(false);\n      };\n    };\n    var deleteFromTo = function (editor, caret, from, to) {\n      var rootNode = editor.getBody();\n      var isInlineTarget = curry(InlineUtils.isInlineTarget, editor);\n      editor.undoManager.ignore(function () {\n        editor.selection.setRng(rangeFromPositions(from, to));\n        editor.execCommand('Delete');\n        BoundaryLocation.readLocation(isInlineTarget, rootNode, CaretPosition$1.fromRangeStart(editor.selection.getRng())).map(BoundaryLocation.inside).map(setCaretLocation(editor, caret));\n      });\n      editor.nodeChanged();\n    };\n    var rescope$1 = function (rootNode, node) {\n      var parentBlock = getParentBlock(node, rootNode);\n      return parentBlock ? parentBlock : rootNode;\n    };\n    var backspaceDeleteCollapsed = function (editor, caret, forward, from) {\n      var rootNode = rescope$1(editor.getBody(), from.container());\n      var isInlineTarget = curry(InlineUtils.isInlineTarget, editor);\n      var fromLocation = BoundaryLocation.readLocation(isInlineTarget, rootNode, from);\n      return fromLocation.bind(function (location) {\n        if (forward) {\n          return location.fold(constant(Option.some(BoundaryLocation.inside(location))), Option.none, constant(Option.some(BoundaryLocation.outside(location))), Option.none);\n        } else {\n          return location.fold(Option.none, constant(Option.some(BoundaryLocation.outside(location))), Option.none, constant(Option.some(BoundaryLocation.inside(location))));\n        }\n      }).map(setCaretLocation(editor, caret)).getOrThunk(function () {\n        var toPosition = CaretFinder.navigate(forward, rootNode, from);\n        var toLocation = toPosition.bind(function (pos) {\n          return BoundaryLocation.readLocation(isInlineTarget, rootNode, pos);\n        });\n        if (fromLocation.isSome() && toLocation.isSome()) {\n          return InlineUtils.findRootInline(isInlineTarget, rootNode, from).map(function (elm) {\n            if (hasOnlyTwoOrLessPositionsLeft(elm)) {\n              DeleteElement.deleteElement(editor, forward, Element.fromDom(elm));\n              return true;\n            } else {\n              return false;\n            }\n          }).getOr(false);\n        } else {\n          return toLocation.bind(function (_) {\n            return toPosition.map(function (to) {\n              if (forward) {\n                deleteFromTo(editor, caret, from, to);\n              } else {\n                deleteFromTo(editor, caret, to, from);\n              }\n              return true;\n            });\n          }).getOr(false);\n        }\n      });\n    };\n    var backspaceDelete$4 = function (editor, caret, forward) {\n      if (editor.selection.isCollapsed() && isFeatureEnabled$1(editor)) {\n        var from = CaretPosition$1.fromRangeStart(editor.selection.getRng());\n        return backspaceDeleteCollapsed(editor, caret, forward, from);\n      }\n      return false;\n    };\n    var BoundaryDelete = { backspaceDelete: backspaceDelete$4 };\n\n    var getParentInlines = function (rootElm, startElm) {\n      var parents = Parents.parentsAndSelf(startElm, rootElm);\n      return findIndex(parents, isBlock).fold(constant(parents), function (index) {\n        return parents.slice(0, index);\n      });\n    };\n    var hasOnlyOneChild = function (elm) {\n      return children(elm).length === 1;\n    };\n    var deleteLastPosition = function (forward, editor, target, parentInlines) {\n      var isFormatElement$1 = curry(isFormatElement, editor);\n      var formatNodes = map(filter(parentInlines, isFormatElement$1), function (elm) {\n        return elm.dom();\n      });\n      if (formatNodes.length === 0) {\n        DeleteElement.deleteElement(editor, forward, target);\n      } else {\n        var pos = replaceWithCaretFormat(target.dom(), formatNodes);\n        editor.selection.setRng(pos.toRange());\n      }\n    };\n    var deleteCaret = function (editor, forward) {\n      var rootElm = Element.fromDom(editor.getBody());\n      var startElm = Element.fromDom(editor.selection.getStart());\n      var parentInlines = filter(getParentInlines(rootElm, startElm), hasOnlyOneChild);\n      return last(parentInlines).map(function (target) {\n        var fromPos = CaretPosition$1.fromRangeStart(editor.selection.getRng());\n        if (DeleteUtils.willDeleteLastPositionInElement(forward, fromPos, target.dom()) && !isEmptyCaretFormatElement(target)) {\n          deleteLastPosition(forward, editor, target, parentInlines);\n          return true;\n        } else {\n          return false;\n        }\n      }).getOr(false);\n    };\n    var backspaceDelete$5 = function (editor, forward) {\n      return editor.selection.isCollapsed() ? deleteCaret(editor, forward) : false;\n    };\n    var InlineFormatDelete = { backspaceDelete: backspaceDelete$5 };\n\n    var tableCellRng = function (start, end) {\n      return {\n        start: constant(start),\n        end: constant(end)\n      };\n    };\n    var tableSelection = function (rng, table, cells) {\n      return {\n        rng: constant(rng),\n        table: constant(table),\n        cells: constant(cells)\n      };\n    };\n    var deleteAction = Adt.generate([\n      { removeTable: ['element'] },\n      { emptyCells: ['cells'] }\n    ]);\n    var isRootFromElement = function (root) {\n      return function (cur) {\n        return eq(root, cur);\n      };\n    };\n    var getClosestCell$1 = function (container, isRoot) {\n      return closest$1(Element.fromDom(container), 'td,th', isRoot);\n    };\n    var getClosestTable = function (cell, isRoot) {\n      return ancestor$1(cell, 'table', isRoot);\n    };\n    var isExpandedCellRng = function (cellRng) {\n      return eq(cellRng.start(), cellRng.end()) === false;\n    };\n    var getTableFromCellRng = function (cellRng, isRoot) {\n      return getClosestTable(cellRng.start(), isRoot).bind(function (startParentTable) {\n        return getClosestTable(cellRng.end(), isRoot).bind(function (endParentTable) {\n          return someIf(eq(startParentTable, endParentTable), startParentTable);\n        });\n      });\n    };\n    var getTableCells = function (table) {\n      return descendants$1(table, 'td,th');\n    };\n    var getCellRangeFromStartTable = function (cellRng, isRoot) {\n      return getClosestTable(cellRng.start(), isRoot).bind(function (table) {\n        return last(getTableCells(table)).map(function (endCell) {\n          return tableCellRng(cellRng.start(), endCell);\n        });\n      });\n    };\n    var partialSelection = function (isRoot, rng) {\n      var startCell = getClosestCell$1(rng.startContainer, isRoot);\n      var endCell = getClosestCell$1(rng.endContainer, isRoot);\n      return rng.collapsed ? Option.none() : lift2(startCell, endCell, tableCellRng).fold(function () {\n        return startCell.fold(function () {\n          return endCell.bind(function (endCell) {\n            return getClosestTable(endCell, isRoot).bind(function (table) {\n              return head(getTableCells(table)).map(function (startCell) {\n                return tableCellRng(startCell, endCell);\n              });\n            });\n          });\n        }, function (startCell) {\n          return getClosestTable(startCell, isRoot).bind(function (table) {\n            return last(getTableCells(table)).map(function (endCell) {\n              return tableCellRng(startCell, endCell);\n            });\n          });\n        });\n      }, function (cellRng) {\n        return isWithinSameTable(isRoot, cellRng) ? Option.none() : getCellRangeFromStartTable(cellRng, isRoot);\n      });\n    };\n    var isWithinSameTable = function (isRoot, cellRng) {\n      return getTableFromCellRng(cellRng, isRoot).isSome();\n    };\n    var getCellRng = function (rng, isRoot) {\n      var startCell = getClosestCell$1(rng.startContainer, isRoot);\n      var endCell = getClosestCell$1(rng.endContainer, isRoot);\n      return lift2(startCell, endCell, tableCellRng).filter(isExpandedCellRng).filter(function (cellRng) {\n        return isWithinSameTable(isRoot, cellRng);\n      }).orThunk(function () {\n        return partialSelection(isRoot, rng);\n      });\n    };\n    var getTableSelectionFromCellRng = function (cellRng, isRoot) {\n      return getTableFromCellRng(cellRng, isRoot).map(function (table) {\n        return tableSelection(cellRng, table, getTableCells(table));\n      });\n    };\n    var getTableSelectionFromRng = function (root, rng) {\n      var isRoot = isRootFromElement(root);\n      return getCellRng(rng, isRoot).bind(function (cellRng) {\n        return getTableSelectionFromCellRng(cellRng, isRoot);\n      });\n    };\n    var getCellIndex = function (cells, cell) {\n      return findIndex(cells, function (x) {\n        return eq(x, cell);\n      });\n    };\n    var getSelectedCells = function (tableSelection) {\n      return lift2(getCellIndex(tableSelection.cells(), tableSelection.rng().start()), getCellIndex(tableSelection.cells(), tableSelection.rng().end()), function (startIndex, endIndex) {\n        return tableSelection.cells().slice(startIndex, endIndex + 1);\n      });\n    };\n    var getAction = function (tableSelection) {\n      return getSelectedCells(tableSelection).map(function (selected) {\n        var cells = tableSelection.cells();\n        return selected.length === cells.length ? deleteAction.removeTable(tableSelection.table()) : deleteAction.emptyCells(selected);\n      });\n    };\n    var getActionFromRange = function (root, rng) {\n      return getTableSelectionFromRng(root, rng).bind(getAction);\n    };\n\n    var emptyCells = function (editor, cells) {\n      each(cells, PaddingBr.fillWithPaddingBr);\n      editor.selection.setCursorLocation(cells[0].dom(), 0);\n      return true;\n    };\n    var deleteTableElement = function (editor, table) {\n      DeleteElement.deleteElement(editor, false, table);\n      return true;\n    };\n    var deleteCellRange = function (editor, rootElm, rng) {\n      return getActionFromRange(rootElm, rng).map(function (action) {\n        return action.fold(curry(deleteTableElement, editor), curry(emptyCells, editor));\n      });\n    };\n    var deleteCaptionRange = function (editor, caption) {\n      return emptyElement(editor, caption);\n    };\n    var deleteTableRange = function (editor, rootElm, rng, startElm) {\n      return getParentCaption(rootElm, startElm).fold(function () {\n        return deleteCellRange(editor, rootElm, rng);\n      }, function (caption) {\n        return deleteCaptionRange(editor, caption);\n      }).getOr(false);\n    };\n    var deleteRange$1 = function (editor, startElm) {\n      var rootNode = Element.fromDom(editor.getBody());\n      var rng = editor.selection.getRng();\n      var selectedCells = TableCellSelection.getCellsFromEditor(editor);\n      return selectedCells.length !== 0 ? emptyCells(editor, selectedCells) : deleteTableRange(editor, rootNode, rng, startElm);\n    };\n    var getParentCell = function (rootElm, elm) {\n      return find(Parents.parentsAndSelf(elm, rootElm), isTableCell);\n    };\n    var getParentCaption = function (rootElm, elm) {\n      return find(Parents.parentsAndSelf(elm, rootElm), function (elm) {\n        return name(elm) === 'caption';\n      });\n    };\n    var deleteBetweenCells = function (editor, rootElm, forward, fromCell, from) {\n      return CaretFinder.navigate(forward, editor.getBody(), from).bind(function (to) {\n        return getParentCell(rootElm, Element.fromDom(to.getNode())).map(function (toCell) {\n          return eq(toCell, fromCell) === false;\n        });\n      });\n    };\n    var emptyElement = function (editor, elm) {\n      PaddingBr.fillWithPaddingBr(elm);\n      editor.selection.setCursorLocation(elm.dom(), 0);\n      return Option.some(true);\n    };\n    var isDeleteOfLastCharPos = function (fromCaption, forward, from, to) {\n      return CaretFinder.firstPositionIn(fromCaption.dom()).bind(function (first) {\n        return CaretFinder.lastPositionIn(fromCaption.dom()).map(function (last) {\n          return forward ? from.isEqual(first) && to.isEqual(last) : from.isEqual(last) && to.isEqual(first);\n        });\n      }).getOr(true);\n    };\n    var emptyCaretCaption = function (editor, elm) {\n      return emptyElement(editor, elm);\n    };\n    var validateCaretCaption = function (rootElm, fromCaption, to) {\n      return getParentCaption(rootElm, Element.fromDom(to.getNode())).map(function (toCaption) {\n        return eq(toCaption, fromCaption) === false;\n      });\n    };\n    var deleteCaretInsideCaption = function (editor, rootElm, forward, fromCaption, from) {\n      return CaretFinder.navigate(forward, editor.getBody(), from).bind(function (to) {\n        return isDeleteOfLastCharPos(fromCaption, forward, from, to) ? emptyCaretCaption(editor, fromCaption) : validateCaretCaption(rootElm, fromCaption, to);\n      }).or(Option.some(true));\n    };\n    var deleteCaretCells = function (editor, forward, rootElm, startElm) {\n      var from = CaretPosition$1.fromRangeStart(editor.selection.getRng());\n      return getParentCell(rootElm, startElm).bind(function (fromCell) {\n        return Empty.isEmpty(fromCell) ? emptyElement(editor, fromCell) : deleteBetweenCells(editor, rootElm, forward, fromCell, from);\n      }).getOr(false);\n    };\n    var deleteCaretCaption = function (editor, forward, rootElm, fromCaption) {\n      var from = CaretPosition$1.fromRangeStart(editor.selection.getRng());\n      return Empty.isEmpty(fromCaption) ? emptyElement(editor, fromCaption) : deleteCaretInsideCaption(editor, rootElm, forward, fromCaption, from);\n    };\n    var isNearTable = function (forward, pos) {\n      return forward ? isBeforeTable(pos) : isAfterTable(pos);\n    };\n    var isBeforeOrAfterTable = function (editor, forward) {\n      var fromPos = CaretPosition$1.fromRangeStart(editor.selection.getRng());\n      return isNearTable(forward, fromPos) || CaretFinder.fromPosition(forward, editor.getBody(), fromPos).map(function (pos) {\n        return isNearTable(forward, pos);\n      }).getOr(false);\n    };\n    var deleteCaret$1 = function (editor, forward, startElm) {\n      var rootElm = Element.fromDom(editor.getBody());\n      return getParentCaption(rootElm, startElm).fold(function () {\n        return deleteCaretCells(editor, forward, rootElm, startElm) || isBeforeOrAfterTable(editor, forward);\n      }, function (fromCaption) {\n        return deleteCaretCaption(editor, forward, rootElm, fromCaption).getOr(false);\n      });\n    };\n    var backspaceDelete$6 = function (editor, forward) {\n      var startElm = Element.fromDom(editor.selection.getStart(true));\n      var cells = TableCellSelection.getCellsFromEditor(editor);\n      return editor.selection.isCollapsed() && cells.length === 0 ? deleteCaret$1(editor, forward, startElm) : deleteRange$1(editor, startElm);\n    };\n    var TableDelete = { backspaceDelete: backspaceDelete$6 };\n\n    var deleteCaret$2 = function (editor, forward) {\n      var fromPos = CaretPosition$1.fromRangeStart(editor.selection.getRng());\n      return CaretFinder.fromPosition(forward, editor.getBody(), fromPos).filter(function (pos) {\n        return forward ? isBeforeImageBlock(pos) : isAfterImageBlock(pos);\n      }).bind(function (pos) {\n        return Option.from(getChildNodeAtRelativeOffset(forward ? 0 : -1, pos));\n      }).map(function (elm) {\n        editor.selection.select(elm);\n        return true;\n      }).getOr(false);\n    };\n    var backspaceDelete$7 = function (editor, forward) {\n      return editor.selection.isCollapsed() ? deleteCaret$2(editor, forward) : false;\n    };\n    var PageBreakDelete = { backspaceDelete: backspaceDelete$7 };\n\n    var isEditable$1 = function (target) {\n      return closest(target, function (elm) {\n        return NodeType.isContentEditableTrue(elm.dom()) || NodeType.isContentEditableFalse(elm.dom());\n      }).exists(function (elm) {\n        return NodeType.isContentEditableTrue(elm.dom());\n      });\n    };\n    var parseIndentValue = function (value) {\n      var number = parseInt(value, 10);\n      return isNaN(number) ? 0 : number;\n    };\n    var getIndentStyleName = function (useMargin, element) {\n      var indentStyleName = useMargin || isTable$1(element) ? 'margin' : 'padding';\n      var suffix = get$4(element, 'direction') === 'rtl' ? '-right' : '-left';\n      return indentStyleName + suffix;\n    };\n    var indentElement = function (dom, command, useMargin, value, unit, element) {\n      var indentStyleName = getIndentStyleName(useMargin, Element.fromDom(element));\n      if (command === 'outdent') {\n        var styleValue = Math.max(0, parseIndentValue(element.style[indentStyleName]) - value);\n        dom.setStyle(element, indentStyleName, styleValue ? styleValue + unit : '');\n      } else {\n        var styleValue = parseIndentValue(element.style[indentStyleName]) + value + unit;\n        dom.setStyle(element, indentStyleName, styleValue);\n      }\n    };\n    var validateBlocks = function (editor, blocks) {\n      return forall(blocks, function (block) {\n        var indentStyleName = getIndentStyleName(Settings.shouldIndentUseMargin(editor), block);\n        var intentValue = getRaw(block, indentStyleName).map(parseIndentValue).getOr(0);\n        var contentEditable = editor.dom.getContentEditable(block.dom());\n        return contentEditable !== 'false' && intentValue > 0;\n      });\n    };\n    var canOutdent = function (editor) {\n      var blocks = getBlocksToIndent(editor);\n      return editor.readonly !== true && (blocks.length > 1 || validateBlocks(editor, blocks));\n    };\n    var isListComponent = function (el) {\n      return isList(el) || isListItem(el);\n    };\n    var parentIsListComponent = function (el) {\n      return parent(el).map(isListComponent).getOr(false);\n    };\n    var getBlocksToIndent = function (editor) {\n      return filter(map(editor.selection.getSelectedBlocks(), Element.fromDom), function (el) {\n        return !isListComponent(el) && !parentIsListComponent(el) && isEditable$1(el);\n      });\n    };\n    var handle = function (editor, command) {\n      var dom = editor.dom, selection = editor.selection, formatter = editor.formatter;\n      var indentation = Settings.getIndentation(editor);\n      var indentUnit = /[a-z%]+$/i.exec(indentation)[0];\n      var indentValue = parseInt(indentation, 10);\n      var useMargin = Settings.shouldIndentUseMargin(editor);\n      var forcedRootBlock = Settings.getForcedRootBlock(editor);\n      if (!editor.queryCommandState('InsertUnorderedList') && !editor.queryCommandState('InsertOrderedList')) {\n        if (forcedRootBlock === '' && !dom.getParent(selection.getNode(), dom.isBlock)) {\n          formatter.apply('div');\n        }\n      }\n      each(getBlocksToIndent(editor), function (block) {\n        indentElement(dom, command, useMargin, indentValue, indentUnit, block.dom());\n      });\n    };\n\n    var navigateIgnoreEmptyTextNodes = function (forward, root, from) {\n      return CaretFinder.navigateIgnore(forward, root, from, isEmptyText);\n    };\n    var getClosestBlock = function (root, pos) {\n      return find(Parents.parentsAndSelf(Element.fromDom(pos.container()), root), isBlock);\n    };\n    var isAtBeforeAfterBlockBoundary = function (forward, root, pos) {\n      return navigateIgnoreEmptyTextNodes(forward, root.dom(), pos).forall(function (newPos) {\n        return getClosestBlock(root, pos).fold(function () {\n          return isInSameBlock(newPos, pos, root.dom()) === false;\n        }, function (fromBlock) {\n          return isInSameBlock(newPos, pos, root.dom()) === false && contains$2(fromBlock, Element.fromDom(newPos.container()));\n        });\n      });\n    };\n    var isAtBlockBoundary = function (forward, root, pos) {\n      return getClosestBlock(root, pos).fold(function () {\n        return navigateIgnoreEmptyTextNodes(forward, root.dom(), pos).forall(function (newPos) {\n          return isInSameBlock(newPos, pos, root.dom()) === false;\n        });\n      }, function (parent) {\n        return navigateIgnoreEmptyTextNodes(forward, parent.dom(), pos).isNone();\n      });\n    };\n    var isAtStartOfBlock = curry(isAtBlockBoundary, false);\n    var isAtEndOfBlock = curry(isAtBlockBoundary, true);\n    var isBeforeBlock = curry(isAtBeforeAfterBlockBoundary, false);\n    var isAfterBlock = curry(isAtBeforeAfterBlockBoundary, true);\n\n    var backspaceDelete$8 = function (editor, _caret, _forward) {\n      if (editor.selection.isCollapsed() && canOutdent(editor)) {\n        var dom = editor.dom;\n        var rng = editor.selection.getRng();\n        var pos = CaretPosition$1.fromRangeStart(rng);\n        var block = dom.getParent(rng.startContainer, dom.isBlock);\n        if (block !== null && isAtStartOfBlock(Element.fromDom(block), pos)) {\n          handle(editor, 'outdent');\n          return true;\n        }\n      }\n      return false;\n    };\n    var Outdent = { backspaceDelete: backspaceDelete$8 };\n\n    var executeKeydownOverride$1 = function (editor, caret, evt) {\n      MatchKeys.execute([\n        {\n          keyCode: VK.BACKSPACE,\n          action: MatchKeys.action(Outdent.backspaceDelete, editor, false)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: MatchKeys.action(CefDelete.backspaceDelete, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: MatchKeys.action(CefDelete.backspaceDelete, editor, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: MatchKeys.action(CefBoundaryDelete.backspaceDelete, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: MatchKeys.action(CefBoundaryDelete.backspaceDelete, editor, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: MatchKeys.action(BoundaryDelete.backspaceDelete, editor, caret, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: MatchKeys.action(BoundaryDelete.backspaceDelete, editor, caret, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: MatchKeys.action(TableDelete.backspaceDelete, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: MatchKeys.action(TableDelete.backspaceDelete, editor, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: MatchKeys.action(PageBreakDelete.backspaceDelete, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: MatchKeys.action(PageBreakDelete.backspaceDelete, editor, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: MatchKeys.action(BlockRangeDelete.backspaceDelete, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: MatchKeys.action(BlockRangeDelete.backspaceDelete, editor, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: MatchKeys.action(BlockBoundaryDelete.backspaceDelete, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: MatchKeys.action(BlockBoundaryDelete.backspaceDelete, editor, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: MatchKeys.action(InlineFormatDelete.backspaceDelete, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: MatchKeys.action(InlineFormatDelete.backspaceDelete, editor, true)\n        }\n      ], evt).each(function (_) {\n        evt.preventDefault();\n      });\n    };\n    var executeKeyupOverride = function (editor, evt) {\n      MatchKeys.execute([\n        {\n          keyCode: VK.BACKSPACE,\n          action: MatchKeys.action(CefDelete.paddEmptyElement, editor)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: MatchKeys.action(CefDelete.paddEmptyElement, editor)\n        }\n      ], evt);\n    };\n    var setup$a = function (editor, caret) {\n      editor.on('keydown', function (evt) {\n        if (evt.isDefaultPrevented() === false) {\n          executeKeydownOverride$1(editor, caret, evt);\n        }\n      });\n      editor.on('keyup', function (evt) {\n        if (evt.isDefaultPrevented() === false) {\n          executeKeyupOverride(editor, evt);\n        }\n      });\n    };\n    var DeleteBackspaceKeys = { setup: setup$a };\n\n    var firstNonWhiteSpaceNodeSibling = function (node) {\n      while (node) {\n        if (node.nodeType === 1 || node.nodeType === 3 && node.data && /[\\r\\n\\s]/.test(node.data)) {\n          return node;\n        }\n        node = node.nextSibling;\n      }\n    };\n    var moveToCaretPosition = function (editor, root) {\n      var node, rng, lastNode = root;\n      var dom = editor.dom;\n      var moveCaretBeforeOnEnterElementsMap = editor.schema.getMoveCaretBeforeOnEnterElements();\n      if (!root) {\n        return;\n      }\n      if (/^(LI|DT|DD)$/.test(root.nodeName)) {\n        var firstChild = firstNonWhiteSpaceNodeSibling(root.firstChild);\n        if (firstChild && /^(UL|OL|DL)$/.test(firstChild.nodeName)) {\n          root.insertBefore(dom.doc.createTextNode(nbsp), root.firstChild);\n        }\n      }\n      rng = dom.createRng();\n      root.normalize();\n      if (root.hasChildNodes()) {\n        var walker = new TreeWalker(root, root);\n        while (node = walker.current()) {\n          if (NodeType.isText(node)) {\n            rng.setStart(node, 0);\n            rng.setEnd(node, 0);\n            break;\n          }\n          if (moveCaretBeforeOnEnterElementsMap[node.nodeName.toLowerCase()]) {\n            rng.setStartBefore(node);\n            rng.setEndBefore(node);\n            break;\n          }\n          lastNode = node;\n          node = walker.next();\n        }\n        if (!node) {\n          rng.setStart(lastNode, 0);\n          rng.setEnd(lastNode, 0);\n        }\n      } else {\n        if (NodeType.isBr(root)) {\n          if (root.nextSibling && dom.isBlock(root.nextSibling)) {\n            rng.setStartBefore(root);\n            rng.setEndBefore(root);\n          } else {\n            rng.setStartAfter(root);\n            rng.setEndAfter(root);\n          }\n        } else {\n          rng.setStart(root, 0);\n          rng.setEnd(root, 0);\n        }\n      }\n      editor.selection.setRng(rng);\n      ScrollIntoView.scrollRangeIntoView(editor, rng);\n    };\n    var getEditableRoot = function (dom, node) {\n      var root = dom.getRoot();\n      var parent, editableRoot;\n      parent = node;\n      while (parent !== root && dom.getContentEditable(parent) !== 'false') {\n        if (dom.getContentEditable(parent) === 'true') {\n          editableRoot = parent;\n        }\n        parent = parent.parentNode;\n      }\n      return parent !== root ? editableRoot : root;\n    };\n    var getParentBlock$2 = function (editor) {\n      return Option.from(editor.dom.getParent(editor.selection.getStart(true), editor.dom.isBlock));\n    };\n    var getParentBlockName = function (editor) {\n      return getParentBlock$2(editor).fold(constant(''), function (parentBlock) {\n        return parentBlock.nodeName.toUpperCase();\n      });\n    };\n    var isListItemParentBlock = function (editor) {\n      return getParentBlock$2(editor).filter(function (elm) {\n        return isListItem(Element.fromDom(elm));\n      }).isSome();\n    };\n    var NewLineUtils = {\n      moveToCaretPosition: moveToCaretPosition,\n      getEditableRoot: getEditableRoot,\n      getParentBlock: getParentBlock$2,\n      getParentBlockName: getParentBlockName,\n      isListItemParentBlock: isListItemParentBlock\n    };\n\n    var hasFirstChild = function (elm, name) {\n      return elm.firstChild && elm.firstChild.nodeName === name;\n    };\n    var hasParent$1 = function (elm, parentName) {\n      return elm && elm.parentNode && elm.parentNode.nodeName === parentName;\n    };\n    var isListBlock = function (elm) {\n      return elm && /^(OL|UL|LI)$/.test(elm.nodeName);\n    };\n    var isNestedList = function (elm) {\n      return isListBlock(elm) && isListBlock(elm.parentNode);\n    };\n    var getContainerBlock = function (containerBlock) {\n      var containerBlockParent = containerBlock.parentNode;\n      if (/^(LI|DT|DD)$/.test(containerBlockParent.nodeName)) {\n        return containerBlockParent;\n      }\n      return containerBlock;\n    };\n    var isFirstOrLastLi = function (containerBlock, parentBlock, first) {\n      var node = containerBlock[first ? 'firstChild' : 'lastChild'];\n      while (node) {\n        if (NodeType.isElement(node)) {\n          break;\n        }\n        node = node[first ? 'nextSibling' : 'previousSibling'];\n      }\n      return node === parentBlock;\n    };\n    var insert = function (editor, createNewBlock, containerBlock, parentBlock, newBlockName) {\n      var dom = editor.dom;\n      var rng = editor.selection.getRng();\n      if (containerBlock === editor.getBody()) {\n        return;\n      }\n      if (isNestedList(containerBlock)) {\n        newBlockName = 'LI';\n      }\n      var newBlock = newBlockName ? createNewBlock(newBlockName) : dom.create('BR');\n      if (isFirstOrLastLi(containerBlock, parentBlock, true) && isFirstOrLastLi(containerBlock, parentBlock, false)) {\n        if (hasParent$1(containerBlock, 'LI')) {\n          dom.insertAfter(newBlock, getContainerBlock(containerBlock));\n        } else {\n          dom.replace(newBlock, containerBlock);\n        }\n      } else if (isFirstOrLastLi(containerBlock, parentBlock, true)) {\n        if (hasParent$1(containerBlock, 'LI')) {\n          dom.insertAfter(newBlock, getContainerBlock(containerBlock));\n          newBlock.appendChild(dom.doc.createTextNode(' '));\n          newBlock.appendChild(containerBlock);\n        } else {\n          containerBlock.parentNode.insertBefore(newBlock, containerBlock);\n        }\n      } else if (isFirstOrLastLi(containerBlock, parentBlock, false)) {\n        dom.insertAfter(newBlock, getContainerBlock(containerBlock));\n      } else {\n        containerBlock = getContainerBlock(containerBlock);\n        var tmpRng = rng.cloneRange();\n        tmpRng.setStartAfter(parentBlock);\n        tmpRng.setEndAfter(containerBlock);\n        var fragment = tmpRng.extractContents();\n        if (newBlockName === 'LI' && hasFirstChild(fragment, 'LI')) {\n          newBlock = fragment.firstChild;\n          dom.insertAfter(fragment, containerBlock);\n        } else {\n          dom.insertAfter(fragment, containerBlock);\n          dom.insertAfter(newBlock, containerBlock);\n        }\n      }\n      dom.remove(parentBlock);\n      NewLineUtils.moveToCaretPosition(editor, newBlock);\n    };\n    var InsertLi = { insert: insert };\n\n    var trimZwsp = function (fragment) {\n      each(descendants(Element.fromDom(fragment), isText), function (text) {\n        var rawNode = text.dom();\n        rawNode.nodeValue = Zwsp.trim(rawNode.nodeValue);\n      });\n    };\n    var isEmptyAnchor = function (dom, elm) {\n      return elm && elm.nodeName === 'A' && dom.isEmpty(elm);\n    };\n    var isTableCell$4 = function (node) {\n      return node && /^(TD|TH|CAPTION)$/.test(node.nodeName);\n    };\n    var emptyBlock = function (elm) {\n      elm.innerHTML = '<br data-mce-bogus=\"1\">';\n    };\n    var containerAndSiblingName = function (container, nodeName) {\n      return container.nodeName === nodeName || container.previousSibling && container.previousSibling.nodeName === nodeName;\n    };\n    var canSplitBlock = function (dom, node) {\n      return node && dom.isBlock(node) && !/^(TD|TH|CAPTION|FORM)$/.test(node.nodeName) && !/^(fixed|absolute)/i.test(node.style.position) && dom.getContentEditable(node) !== 'true';\n    };\n    var trimInlineElementsOnLeftSideOfBlock = function (dom, nonEmptyElementsMap, block) {\n      var node = block;\n      var firstChilds = [];\n      var i;\n      if (!node) {\n        return;\n      }\n      while (node = node.firstChild) {\n        if (dom.isBlock(node)) {\n          return;\n        }\n        if (NodeType.isElement(node) && !nonEmptyElementsMap[node.nodeName.toLowerCase()]) {\n          firstChilds.push(node);\n        }\n      }\n      i = firstChilds.length;\n      while (i--) {\n        node = firstChilds[i];\n        if (!node.hasChildNodes() || node.firstChild === node.lastChild && node.firstChild.nodeValue === '') {\n          dom.remove(node);\n        } else {\n          if (isEmptyAnchor(dom, node)) {\n            dom.remove(node);\n          }\n        }\n      }\n    };\n    var normalizeZwspOffset = function (start, container, offset) {\n      if (NodeType.isText(container) === false) {\n        return offset;\n      } else if (start) {\n        return offset === 1 && container.data.charAt(offset - 1) === Zwsp.ZWSP ? 0 : offset;\n      } else {\n        return offset === container.data.length - 1 && container.data.charAt(offset) === Zwsp.ZWSP ? container.data.length : offset;\n      }\n    };\n    var includeZwspInRange = function (rng) {\n      var newRng = rng.cloneRange();\n      newRng.setStart(rng.startContainer, normalizeZwspOffset(true, rng.startContainer, rng.startOffset));\n      newRng.setEnd(rng.endContainer, normalizeZwspOffset(false, rng.endContainer, rng.endOffset));\n      return newRng;\n    };\n    var trimLeadingLineBreaks = function (node) {\n      do {\n        if (NodeType.isText(node)) {\n          node.nodeValue = node.nodeValue.replace(/^[\\r\\n]+/, '');\n        }\n        node = node.firstChild;\n      } while (node);\n    };\n    var getEditableRoot$1 = function (dom, node) {\n      var root = dom.getRoot();\n      var parent, editableRoot;\n      parent = node;\n      while (parent !== root && dom.getContentEditable(parent) !== 'false') {\n        if (dom.getContentEditable(parent) === 'true') {\n          editableRoot = parent;\n        }\n        parent = parent.parentNode;\n      }\n      return parent !== root ? editableRoot : root;\n    };\n    var setForcedBlockAttrs = function (editor, node) {\n      var forcedRootBlockName = Settings.getForcedRootBlock(editor);\n      if (forcedRootBlockName && forcedRootBlockName.toLowerCase() === node.tagName.toLowerCase()) {\n        editor.dom.setAttribs(node, Settings.getForcedRootBlockAttrs(editor));\n      }\n    };\n    var wrapSelfAndSiblingsInDefaultBlock = function (editor, newBlockName, rng, container, offset) {\n      var newBlock, parentBlock, startNode, node, next, rootBlockName;\n      var blockName = newBlockName || 'P';\n      var dom = editor.dom, editableRoot = getEditableRoot$1(dom, container);\n      parentBlock = dom.getParent(container, dom.isBlock);\n      if (!parentBlock || !canSplitBlock(dom, parentBlock)) {\n        parentBlock = parentBlock || editableRoot;\n        if (parentBlock === editor.getBody() || isTableCell$4(parentBlock)) {\n          rootBlockName = parentBlock.nodeName.toLowerCase();\n        } else {\n          rootBlockName = parentBlock.parentNode.nodeName.toLowerCase();\n        }\n        if (!parentBlock.hasChildNodes()) {\n          newBlock = dom.create(blockName);\n          setForcedBlockAttrs(editor, newBlock);\n          parentBlock.appendChild(newBlock);\n          rng.setStart(newBlock, 0);\n          rng.setEnd(newBlock, 0);\n          return newBlock;\n        }\n        node = container;\n        while (node.parentNode !== parentBlock) {\n          node = node.parentNode;\n        }\n        while (node && !dom.isBlock(node)) {\n          startNode = node;\n          node = node.previousSibling;\n        }\n        if (startNode && editor.schema.isValidChild(rootBlockName, blockName.toLowerCase())) {\n          newBlock = dom.create(blockName);\n          setForcedBlockAttrs(editor, newBlock);\n          startNode.parentNode.insertBefore(newBlock, startNode);\n          node = startNode;\n          while (node && !dom.isBlock(node)) {\n            next = node.nextSibling;\n            newBlock.appendChild(node);\n            node = next;\n          }\n          rng.setStart(container, offset);\n          rng.setEnd(container, offset);\n        }\n      }\n      return container;\n    };\n    var addBrToBlockIfNeeded = function (dom, block) {\n      var lastChild;\n      block.normalize();\n      lastChild = block.lastChild;\n      if (!lastChild || /^(left|right)$/gi.test(dom.getStyle(lastChild, 'float', true))) {\n        dom.add(block, 'br');\n      }\n    };\n    var insert$1 = function (editor, evt) {\n      var tmpRng, editableRoot, container, offset, parentBlock, shiftKey;\n      var newBlock, fragment, containerBlock, parentBlockName, containerBlockName, newBlockName, isAfterLastNodeInContainer;\n      var dom = editor.dom;\n      var schema = editor.schema, nonEmptyElementsMap = schema.getNonEmptyElements();\n      var rng = editor.selection.getRng();\n      var createNewBlock = function (name) {\n        var node = container, block, clonedNode, caretNode;\n        var textInlineElements = schema.getTextInlineElements();\n        if (name || parentBlockName === 'TABLE' || parentBlockName === 'HR') {\n          block = dom.create(name || newBlockName);\n          setForcedBlockAttrs(editor, block);\n        } else {\n          block = parentBlock.cloneNode(false);\n        }\n        caretNode = block;\n        if (Settings.shouldKeepStyles(editor) === false) {\n          dom.setAttrib(block, 'style', null);\n          dom.setAttrib(block, 'class', null);\n        } else {\n          do {\n            if (textInlineElements[node.nodeName]) {\n              if (isCaretNode(node) || Bookmarks.isBookmarkNode(node)) {\n                continue;\n              }\n              clonedNode = node.cloneNode(false);\n              dom.setAttrib(clonedNode, 'id', '');\n              if (block.hasChildNodes()) {\n                clonedNode.appendChild(block.firstChild);\n                block.appendChild(clonedNode);\n              } else {\n                caretNode = clonedNode;\n                block.appendChild(clonedNode);\n              }\n            }\n          } while ((node = node.parentNode) && node !== editableRoot);\n        }\n        emptyBlock(caretNode);\n        return block;\n      };\n      var isCaretAtStartOrEndOfBlock = function (start) {\n        var node, name;\n        var normalizedOffset = normalizeZwspOffset(start, container, offset);\n        if (NodeType.isText(container) && (start ? normalizedOffset > 0 : normalizedOffset < container.nodeValue.length)) {\n          return false;\n        }\n        if (container.parentNode === parentBlock && isAfterLastNodeInContainer && !start) {\n          return true;\n        }\n        if (start && NodeType.isElement(container) && container === parentBlock.firstChild) {\n          return true;\n        }\n        if (containerAndSiblingName(container, 'TABLE') || containerAndSiblingName(container, 'HR')) {\n          return isAfterLastNodeInContainer && !start || !isAfterLastNodeInContainer && start;\n        }\n        var walker = new TreeWalker(container, parentBlock);\n        if (NodeType.isText(container)) {\n          if (start && normalizedOffset === 0) {\n            walker.prev();\n          } else if (!start && normalizedOffset === container.nodeValue.length) {\n            walker.next();\n          }\n        }\n        while (node = walker.current()) {\n          if (NodeType.isElement(node)) {\n            if (!node.getAttribute('data-mce-bogus')) {\n              name = node.nodeName.toLowerCase();\n              if (nonEmptyElementsMap[name] && name !== 'br') {\n                return false;\n              }\n            }\n          } else if (NodeType.isText(node) && !/^[ \\t\\r\\n]*$/.test(node.nodeValue)) {\n            return false;\n          }\n          if (start) {\n            walker.prev();\n          } else {\n            walker.next();\n          }\n        }\n        return true;\n      };\n      var insertNewBlockAfter = function () {\n        if (/^(H[1-6]|PRE|FIGURE)$/.test(parentBlockName) && containerBlockName !== 'HGROUP') {\n          newBlock = createNewBlock(newBlockName);\n        } else {\n          newBlock = createNewBlock();\n        }\n        if (Settings.shouldEndContainerOnEmptyBlock(editor) && canSplitBlock(dom, containerBlock) && dom.isEmpty(parentBlock)) {\n          newBlock = dom.split(containerBlock, parentBlock);\n        } else {\n          dom.insertAfter(newBlock, parentBlock);\n        }\n        NewLineUtils.moveToCaretPosition(editor, newBlock);\n      };\n      NormalizeRange.normalize(dom, rng).each(function (normRng) {\n        rng.setStart(normRng.startContainer, normRng.startOffset);\n        rng.setEnd(normRng.endContainer, normRng.endOffset);\n      });\n      container = rng.startContainer;\n      offset = rng.startOffset;\n      newBlockName = Settings.getForcedRootBlock(editor);\n      shiftKey = !!(evt && evt.shiftKey);\n      var ctrlKey = !!(evt && evt.ctrlKey);\n      if (NodeType.isElement(container) && container.hasChildNodes()) {\n        isAfterLastNodeInContainer = offset > container.childNodes.length - 1;\n        container = container.childNodes[Math.min(offset, container.childNodes.length - 1)] || container;\n        if (isAfterLastNodeInContainer && NodeType.isText(container)) {\n          offset = container.nodeValue.length;\n        } else {\n          offset = 0;\n        }\n      }\n      editableRoot = getEditableRoot$1(dom, container);\n      if (!editableRoot) {\n        return;\n      }\n      if (newBlockName && !shiftKey || !newBlockName && shiftKey) {\n        container = wrapSelfAndSiblingsInDefaultBlock(editor, newBlockName, rng, container, offset);\n      }\n      parentBlock = dom.getParent(container, dom.isBlock);\n      containerBlock = parentBlock ? dom.getParent(parentBlock.parentNode, dom.isBlock) : null;\n      parentBlockName = parentBlock ? parentBlock.nodeName.toUpperCase() : '';\n      containerBlockName = containerBlock ? containerBlock.nodeName.toUpperCase() : '';\n      if (containerBlockName === 'LI' && !ctrlKey) {\n        parentBlock = containerBlock;\n        containerBlock = containerBlock.parentNode;\n        parentBlockName = containerBlockName;\n      }\n      if (/^(LI|DT|DD)$/.test(parentBlockName)) {\n        if (dom.isEmpty(parentBlock)) {\n          InsertLi.insert(editor, createNewBlock, containerBlock, parentBlock, newBlockName);\n          return;\n        }\n      }\n      if (newBlockName && parentBlock === editor.getBody()) {\n        return;\n      }\n      newBlockName = newBlockName || 'P';\n      if (isCaretContainerBlock(parentBlock)) {\n        newBlock = showCaretContainerBlock(parentBlock);\n        if (dom.isEmpty(parentBlock)) {\n          emptyBlock(parentBlock);\n        }\n        NewLineUtils.moveToCaretPosition(editor, newBlock);\n      } else if (isCaretAtStartOrEndOfBlock()) {\n        insertNewBlockAfter();\n      } else if (isCaretAtStartOrEndOfBlock(true)) {\n        newBlock = parentBlock.parentNode.insertBefore(createNewBlock(), parentBlock);\n        NewLineUtils.moveToCaretPosition(editor, containerAndSiblingName(parentBlock, 'HR') ? newBlock : parentBlock);\n      } else {\n        tmpRng = includeZwspInRange(rng).cloneRange();\n        tmpRng.setEndAfter(parentBlock);\n        fragment = tmpRng.extractContents();\n        trimZwsp(fragment);\n        trimLeadingLineBreaks(fragment);\n        newBlock = fragment.firstChild;\n        dom.insertAfter(fragment, parentBlock);\n        trimInlineElementsOnLeftSideOfBlock(dom, nonEmptyElementsMap, newBlock);\n        addBrToBlockIfNeeded(dom, parentBlock);\n        if (dom.isEmpty(parentBlock)) {\n          emptyBlock(parentBlock);\n        }\n        newBlock.normalize();\n        if (dom.isEmpty(newBlock)) {\n          dom.remove(newBlock);\n          insertNewBlockAfter();\n        } else {\n          NewLineUtils.moveToCaretPosition(editor, newBlock);\n        }\n      }\n      dom.setAttrib(newBlock, 'id', '');\n      editor.fire('NewBlock', { newBlock: newBlock });\n    };\n    var InsertBlock = { insert: insert$1 };\n\n    var hasRightSideContent = function (schema, container, parentBlock) {\n      var walker = new TreeWalker(container, parentBlock);\n      var node;\n      var nonEmptyElementsMap = schema.getNonEmptyElements();\n      while (node = walker.next()) {\n        if (nonEmptyElementsMap[node.nodeName.toLowerCase()] || node.length > 0) {\n          return true;\n        }\n      }\n    };\n    var scrollToBr = function (dom, selection, brElm) {\n      var marker = dom.create('span', {}, '&nbsp;');\n      brElm.parentNode.insertBefore(marker, brElm);\n      selection.scrollIntoView(marker);\n      dom.remove(marker);\n    };\n    var moveSelectionToBr = function (dom, selection, brElm, extraBr) {\n      var rng = dom.createRng();\n      if (!extraBr) {\n        rng.setStartAfter(brElm);\n        rng.setEndAfter(brElm);\n      } else {\n        rng.setStartBefore(brElm);\n        rng.setEndBefore(brElm);\n      }\n      selection.setRng(rng);\n    };\n    var insertBrAtCaret = function (editor, evt) {\n      var selection = editor.selection;\n      var dom = editor.dom;\n      var rng = selection.getRng();\n      var brElm;\n      var extraBr;\n      NormalizeRange.normalize(dom, rng).each(function (normRng) {\n        rng.setStart(normRng.startContainer, normRng.startOffset);\n        rng.setEnd(normRng.endContainer, normRng.endOffset);\n      });\n      var offset = rng.startOffset;\n      var container = rng.startContainer;\n      if (container.nodeType === 1 && container.hasChildNodes()) {\n        var isAfterLastNodeInContainer = offset > container.childNodes.length - 1;\n        container = container.childNodes[Math.min(offset, container.childNodes.length - 1)] || container;\n        if (isAfterLastNodeInContainer && container.nodeType === 3) {\n          offset = container.nodeValue.length;\n        } else {\n          offset = 0;\n        }\n      }\n      var parentBlock = dom.getParent(container, dom.isBlock);\n      var containerBlock = parentBlock ? dom.getParent(parentBlock.parentNode, dom.isBlock) : null;\n      var containerBlockName = containerBlock ? containerBlock.nodeName.toUpperCase() : '';\n      var isControlKey = !!(evt && evt.ctrlKey);\n      if (containerBlockName === 'LI' && !isControlKey) {\n        parentBlock = containerBlock;\n      }\n      if (container && container.nodeType === 3 && offset >= container.nodeValue.length) {\n        if (!hasRightSideContent(editor.schema, container, parentBlock)) {\n          brElm = dom.create('br');\n          rng.insertNode(brElm);\n          rng.setStartAfter(brElm);\n          rng.setEndAfter(brElm);\n          extraBr = true;\n        }\n      }\n      brElm = dom.create('br');\n      rangeInsertNode(dom, rng, brElm);\n      scrollToBr(dom, selection, brElm);\n      moveSelectionToBr(dom, selection, brElm, extraBr);\n      editor.undoManager.add();\n    };\n    var insertBrBefore = function (editor, inline) {\n      var br = Element.fromTag('br');\n      before(Element.fromDom(inline), br);\n      editor.undoManager.add();\n    };\n    var insertBrAfter = function (editor, inline) {\n      if (!hasBrAfter(editor.getBody(), inline)) {\n        after(Element.fromDom(inline), Element.fromTag('br'));\n      }\n      var br = Element.fromTag('br');\n      after(Element.fromDom(inline), br);\n      scrollToBr(editor.dom, editor.selection, br.dom());\n      moveSelectionToBr(editor.dom, editor.selection, br.dom(), false);\n      editor.undoManager.add();\n    };\n    var isBeforeBr$1 = function (pos) {\n      return NodeType.isBr(pos.getNode());\n    };\n    var hasBrAfter = function (rootNode, startNode) {\n      if (isBeforeBr$1(CaretPosition$1.after(startNode))) {\n        return true;\n      } else {\n        return CaretFinder.nextPosition(rootNode, CaretPosition$1.after(startNode)).map(function (pos) {\n          return NodeType.isBr(pos.getNode());\n        }).getOr(false);\n      }\n    };\n    var isAnchorLink = function (elm) {\n      return elm && elm.nodeName === 'A' && 'href' in elm;\n    };\n    var isInsideAnchor = function (location) {\n      return location.fold(constant(false), isAnchorLink, isAnchorLink, constant(false));\n    };\n    var readInlineAnchorLocation = function (editor) {\n      var isInlineTarget = curry(InlineUtils.isInlineTarget, editor);\n      var position = CaretPosition$1.fromRangeStart(editor.selection.getRng());\n      return BoundaryLocation.readLocation(isInlineTarget, editor.getBody(), position).filter(isInsideAnchor);\n    };\n    var insertBrOutsideAnchor = function (editor, location) {\n      location.fold(noop, curry(insertBrBefore, editor), curry(insertBrAfter, editor), noop);\n    };\n    var insert$2 = function (editor, evt) {\n      var anchorLocation = readInlineAnchorLocation(editor);\n      if (anchorLocation.isSome()) {\n        anchorLocation.each(curry(insertBrOutsideAnchor, editor));\n      } else {\n        insertBrAtCaret(editor, evt);\n      }\n    };\n    var InsertBr = { insert: insert$2 };\n\n    var matchesSelector = function (editor, selector) {\n      return NewLineUtils.getParentBlock(editor).filter(function (parentBlock) {\n        return selector.length > 0 && is(Element.fromDom(parentBlock), selector);\n      }).isSome();\n    };\n    var shouldInsertBr = function (editor) {\n      return matchesSelector(editor, Settings.getBrNewLineSelector(editor));\n    };\n    var shouldBlockNewLine = function (editor) {\n      return matchesSelector(editor, Settings.getNoNewLineSelector(editor));\n    };\n    var ContextSelectors = {\n      shouldInsertBr: shouldInsertBr,\n      shouldBlockNewLine: shouldBlockNewLine\n    };\n\n    var newLineAction = Adt.generate([\n      { br: [] },\n      { block: [] },\n      { none: [] }\n    ]);\n    var shouldBlockNewLine$1 = function (editor, shiftKey) {\n      return ContextSelectors.shouldBlockNewLine(editor);\n    };\n    var isBrMode = function (requiredState) {\n      return function (editor, shiftKey) {\n        var brMode = Settings.getForcedRootBlock(editor) === '';\n        return brMode === requiredState;\n      };\n    };\n    var inListBlock = function (requiredState) {\n      return function (editor, shiftKey) {\n        return NewLineUtils.isListItemParentBlock(editor) === requiredState;\n      };\n    };\n    var inBlock = function (blockName, requiredState) {\n      return function (editor, shiftKey) {\n        var state = NewLineUtils.getParentBlockName(editor) === blockName.toUpperCase();\n        return state === requiredState;\n      };\n    };\n    var inPreBlock = function (requiredState) {\n      return inBlock('pre', requiredState);\n    };\n    var inSummaryBlock = function () {\n      return inBlock('summary', true);\n    };\n    var shouldPutBrInPre$1 = function (requiredState) {\n      return function (editor, shiftKey) {\n        return Settings.shouldPutBrInPre(editor) === requiredState;\n      };\n    };\n    var inBrContext = function (editor, shiftKey) {\n      return ContextSelectors.shouldInsertBr(editor);\n    };\n    var hasShiftKey = function (editor, shiftKey) {\n      return shiftKey;\n    };\n    var canInsertIntoEditableRoot = function (editor) {\n      var forcedRootBlock = Settings.getForcedRootBlock(editor);\n      var rootEditable = NewLineUtils.getEditableRoot(editor.dom, editor.selection.getStart());\n      return rootEditable && editor.schema.isValidChild(rootEditable.nodeName, forcedRootBlock ? forcedRootBlock : 'P');\n    };\n    var match$2 = function (predicates, action) {\n      return function (editor, shiftKey) {\n        var isMatch = foldl(predicates, function (res, p) {\n          return res && p(editor, shiftKey);\n        }, true);\n        return isMatch ? Option.some(action) : Option.none();\n      };\n    };\n    var getAction$1 = function (editor, evt) {\n      return LazyEvaluator.evaluateUntil([\n        match$2([shouldBlockNewLine$1], newLineAction.none()),\n        match$2([inSummaryBlock()], newLineAction.br()),\n        match$2([\n          inPreBlock(true),\n          shouldPutBrInPre$1(false),\n          hasShiftKey\n        ], newLineAction.br()),\n        match$2([\n          inPreBlock(true),\n          shouldPutBrInPre$1(false)\n        ], newLineAction.block()),\n        match$2([\n          inPreBlock(true),\n          shouldPutBrInPre$1(true),\n          hasShiftKey\n        ], newLineAction.block()),\n        match$2([\n          inPreBlock(true),\n          shouldPutBrInPre$1(true)\n        ], newLineAction.br()),\n        match$2([\n          inListBlock(true),\n          hasShiftKey\n        ], newLineAction.br()),\n        match$2([inListBlock(true)], newLineAction.block()),\n        match$2([\n          isBrMode(true),\n          hasShiftKey,\n          canInsertIntoEditableRoot\n        ], newLineAction.block()),\n        match$2([isBrMode(true)], newLineAction.br()),\n        match$2([inBrContext], newLineAction.br()),\n        match$2([\n          isBrMode(false),\n          hasShiftKey\n        ], newLineAction.br()),\n        match$2([canInsertIntoEditableRoot], newLineAction.block())\n      ], [\n        editor,\n        !!(evt && evt.shiftKey)\n      ]).getOr(newLineAction.none());\n    };\n    var NewLineAction = { getAction: getAction$1 };\n\n    var insert$3 = function (editor, evt) {\n      NewLineAction.getAction(editor, evt).fold(function () {\n        InsertBr.insert(editor, evt);\n      }, function () {\n        InsertBlock.insert(editor, evt);\n      }, noop);\n    };\n    var InsertNewLine = { insert: insert$3 };\n\n    var handleEnterKeyEvent = function (editor, event) {\n      if (event.isDefaultPrevented()) {\n        return;\n      }\n      event.preventDefault();\n      endTypingLevelIgnoreLocks(editor.undoManager);\n      editor.undoManager.transact(function () {\n        if (editor.selection.isCollapsed() === false) {\n          editor.execCommand('Delete');\n        }\n        InsertNewLine.insert(editor, event);\n      });\n    };\n    var setup$b = function (editor) {\n      editor.on('keydown', function (event) {\n        if (event.keyCode === VK.ENTER) {\n          handleEnterKeyEvent(editor, event);\n        }\n      });\n    };\n    var EnterKey = { setup: setup$b };\n\n    var insertTextAtPosition = function (text, pos) {\n      var container = pos.container();\n      var offset = pos.offset();\n      if (NodeType.isText(container)) {\n        container.insertData(offset, text);\n        return Option.some(CaretPosition(container, offset + text.length));\n      } else {\n        return getElementFromPosition(pos).map(function (elm) {\n          var textNode = Element.fromText(text);\n          if (pos.isAtEnd()) {\n            after(elm, textNode);\n          } else {\n            before(elm, textNode);\n          }\n          return CaretPosition(textNode.dom(), text.length);\n        });\n      }\n    };\n    var insertNbspAtPosition = curry(insertTextAtPosition, nbsp);\n    var insertSpaceAtPosition = curry(insertTextAtPosition, ' ');\n\n    var isInMiddleOfText = function (pos) {\n      return CaretPosition.isTextPosition(pos) && !pos.isAtStart() && !pos.isAtEnd();\n    };\n    var getClosestBlock$1 = function (root, pos) {\n      var parentBlocks = filter(Parents.parentsAndSelf(Element.fromDom(pos.container()), root), isBlock);\n      return head(parentBlocks).getOr(root);\n    };\n    var hasSpaceBefore = function (root, pos) {\n      if (isInMiddleOfText(pos)) {\n        return isAfterSpace(pos);\n      } else {\n        return isAfterSpace(pos) || CaretFinder.prevPosition(getClosestBlock$1(root, pos).dom(), pos).exists(isAfterSpace);\n      }\n    };\n    var hasSpaceAfter = function (root, pos) {\n      if (isInMiddleOfText(pos)) {\n        return isBeforeSpace(pos);\n      } else {\n        return isBeforeSpace(pos) || CaretFinder.nextPosition(getClosestBlock$1(root, pos).dom(), pos).exists(isBeforeSpace);\n      }\n    };\n    var isPreValue = function (value) {\n      return contains([\n        'pre',\n        'pre-wrap'\n      ], value);\n    };\n    var isInPre = function (pos) {\n      return getElementFromPosition(pos).bind(function (elm) {\n        return closest(elm, isElement);\n      }).exists(function (elm) {\n        return isPreValue(get$4(elm, 'white-space'));\n      });\n    };\n    var isAtBeginningOfBody = function (root, pos) {\n      return CaretFinder.prevPosition(root.dom(), pos).isNone();\n    };\n    var isAtEndOfBody = function (root, pos) {\n      return CaretFinder.nextPosition(root.dom(), pos).isNone();\n    };\n    var isAtLineBoundary = function (root, pos) {\n      return isAtBeginningOfBody(root, pos) || isAtEndOfBody(root, pos) || isAtStartOfBlock(root, pos) || isAtEndOfBlock(root, pos) || isAfterBr(root, pos) || isBeforeBr(root, pos);\n    };\n    var needsToHaveNbsp = function (root, pos) {\n      if (isInPre(pos)) {\n        return false;\n      } else {\n        return isAtLineBoundary(root, pos) || hasSpaceBefore(root, pos) || hasSpaceAfter(root, pos);\n      }\n    };\n    var needsToBeNbspLeft = function (root, pos) {\n      if (isInPre(pos)) {\n        return false;\n      } else {\n        return isAtStartOfBlock(root, pos) || isBeforeBlock(root, pos) || isAfterBr(root, pos) || hasSpaceBefore(root, pos);\n      }\n    };\n    var leanRight = function (pos) {\n      var container = pos.container();\n      var offset = pos.offset();\n      if (NodeType.isText(container) && offset < container.data.length) {\n        return CaretPosition(container, offset + 1);\n      } else {\n        return pos;\n      }\n    };\n    var needsToBeNbspRight = function (root, pos) {\n      var afterPos = leanRight(pos);\n      if (isInPre(afterPos)) {\n        return false;\n      } else {\n        return isAtEndOfBlock(root, afterPos) || isAfterBlock(root, afterPos) || isBeforeBr(root, afterPos) || hasSpaceAfter(root, afterPos);\n      }\n    };\n    var needsToBeNbsp = function (root, pos) {\n      return needsToBeNbspLeft(root, pos) || needsToBeNbspRight(root, pos);\n    };\n    var isNbspAt = function (text, offset) {\n      return isNbsp(text.charAt(offset));\n    };\n    var hasNbsp = function (pos) {\n      var container = pos.container();\n      return NodeType.isText(container) && contains$1(container.data, nbsp);\n    };\n    var normalizeNbspMiddle = function (text) {\n      var chars = text.split('');\n      return map(chars, function (chr, i) {\n        if (isNbsp(chr) && i > 0 && i < chars.length - 1 && isContent(chars[i - 1]) && isContent(chars[i + 1])) {\n          return ' ';\n        } else {\n          return chr;\n        }\n      }).join('');\n    };\n    var normalizeNbspAtStart = function (root, node) {\n      var text = node.data;\n      var firstPos = CaretPosition(node, 0);\n      if (isNbspAt(text, 0) && !needsToBeNbsp(root, firstPos)) {\n        node.data = ' ' + text.slice(1);\n        return true;\n      } else {\n        return false;\n      }\n    };\n    var normalizeNbspInMiddleOfTextNode = function (node) {\n      var text = node.data;\n      var newText = normalizeNbspMiddle(text);\n      if (newText !== text) {\n        node.data = newText;\n        return true;\n      } else {\n        return false;\n      }\n    };\n    var normalizeNbspAtEnd = function (root, node) {\n      var text = node.data;\n      var lastPos = CaretPosition(node, text.length - 1);\n      if (isNbspAt(text, text.length - 1) && !needsToBeNbsp(root, lastPos)) {\n        node.data = text.slice(0, -1) + ' ';\n        return true;\n      } else {\n        return false;\n      }\n    };\n    var normalizeNbsps = function (root, pos) {\n      return Option.some(pos).filter(hasNbsp).bind(function (pos) {\n        var container = pos.container();\n        var normalized = normalizeNbspAtStart(root, container) || normalizeNbspInMiddleOfTextNode(container) || normalizeNbspAtEnd(root, container);\n        return normalized ? Option.some(pos) : Option.none();\n      });\n    };\n    var normalizeNbspsInEditor = function (editor) {\n      var root = Element.fromDom(editor.getBody());\n      if (editor.selection.isCollapsed()) {\n        normalizeNbsps(root, CaretPosition.fromRangeStart(editor.selection.getRng())).each(function (pos) {\n          editor.selection.setRng(pos.toRange());\n        });\n      }\n    };\n\n    var locationToCaretPosition = function (root) {\n      return function (location) {\n        return location.fold(function (element) {\n          return CaretFinder.prevPosition(root.dom(), CaretPosition$1.before(element));\n        }, function (element) {\n          return CaretFinder.firstPositionIn(element);\n        }, function (element) {\n          return CaretFinder.lastPositionIn(element);\n        }, function (element) {\n          return CaretFinder.nextPosition(root.dom(), CaretPosition$1.after(element));\n        });\n      };\n    };\n    var insertInlineBoundarySpaceOrNbsp = function (root, pos) {\n      return function (checkPos) {\n        return needsToHaveNbsp(root, checkPos) ? insertNbspAtPosition(pos) : insertSpaceAtPosition(pos);\n      };\n    };\n    var setSelection$1 = function (editor) {\n      return function (pos) {\n        editor.selection.setRng(pos.toRange());\n        editor.nodeChanged();\n        return true;\n      };\n    };\n    var insertSpaceOrNbspAtSelection = function (editor) {\n      var pos = CaretPosition$1.fromRangeStart(editor.selection.getRng());\n      var root = Element.fromDom(editor.getBody());\n      if (editor.selection.isCollapsed()) {\n        var isInlineTarget = curry(InlineUtils.isInlineTarget, editor);\n        var caretPosition = CaretPosition$1.fromRangeStart(editor.selection.getRng());\n        return BoundaryLocation.readLocation(isInlineTarget, editor.getBody(), caretPosition).bind(locationToCaretPosition(root)).bind(insertInlineBoundarySpaceOrNbsp(root, pos)).exists(setSelection$1(editor));\n      } else {\n        return false;\n      }\n    };\n\n    var executeKeydownOverride$2 = function (editor, evt) {\n      MatchKeys.execute([{\n          keyCode: VK.SPACEBAR,\n          action: MatchKeys.action(insertSpaceOrNbspAtSelection, editor)\n        }], evt).each(function (_) {\n        evt.preventDefault();\n      });\n    };\n    var setup$c = function (editor) {\n      editor.on('keydown', function (evt) {\n        if (evt.isDefaultPrevented() === false) {\n          executeKeydownOverride$2(editor, evt);\n        }\n      });\n    };\n    var SpaceKey = { setup: setup$c };\n\n    var findBlockCaretContainer = function (editor) {\n      return descendant(Element.fromDom(editor.getBody()), '*[data-mce-caret]').fold(constant(null), function (elm) {\n        return elm.dom();\n      });\n    };\n    var removeIeControlRect = function (editor) {\n      editor.selection.setRng(editor.selection.getRng());\n    };\n    var showBlockCaretContainer = function (editor, blockCaretContainer) {\n      if (blockCaretContainer.hasAttribute('data-mce-caret')) {\n        showCaretContainerBlock(blockCaretContainer);\n        removeIeControlRect(editor);\n        editor.selection.scrollIntoView(blockCaretContainer);\n      }\n    };\n    var handleBlockContainer = function (editor, e) {\n      var blockCaretContainer = findBlockCaretContainer(editor);\n      if (!blockCaretContainer) {\n        return;\n      }\n      if (e.type === 'compositionstart') {\n        e.preventDefault();\n        e.stopPropagation();\n        showBlockCaretContainer(editor, blockCaretContainer);\n        return;\n      }\n      if (hasContent(blockCaretContainer)) {\n        showBlockCaretContainer(editor, blockCaretContainer);\n        editor.undoManager.add();\n      }\n    };\n    var setup$d = function (editor) {\n      editor.on('keyup compositionstart', curry(handleBlockContainer, editor));\n    };\n    var CaretContainerInput = { setup: setup$d };\n\n    var browser$5 = detect$3().browser;\n    var setupIeInput = function (editor) {\n      var keypressThrotter = first(function () {\n        if (!editor.composing) {\n          normalizeNbspsInEditor(editor);\n        }\n      }, 0);\n      if (browser$5.isIE()) {\n        editor.on('keypress', function (e) {\n          keypressThrotter.throttle();\n        });\n        editor.on('remove', function (e) {\n          keypressThrotter.cancel();\n        });\n      }\n    };\n    var setup$e = function (editor) {\n      setupIeInput(editor);\n      editor.on('input', function (e) {\n        if (e.isComposing === false) {\n          normalizeNbspsInEditor(editor);\n        }\n      });\n    };\n\n    var executeKeydownOverride$3 = function (editor, evt) {\n      MatchKeys.execute([\n        {\n          keyCode: VK.END,\n          action: moveToLineEndPoint(editor, true)\n        },\n        {\n          keyCode: VK.HOME,\n          action: moveToLineEndPoint(editor, false)\n        }\n      ], evt).each(function (_) {\n        evt.preventDefault();\n      });\n    };\n    var setup$f = function (editor) {\n      editor.on('keydown', function (evt) {\n        if (evt.isDefaultPrevented() === false) {\n          executeKeydownOverride$3(editor, evt);\n        }\n      });\n    };\n    var HomeEndKeys = { setup: setup$f };\n\n    var setup$g = function (editor) {\n      var caret = BoundarySelection.setupSelectedState(editor);\n      CaretContainerInput.setup(editor);\n      ArrowKeys.setup(editor, caret);\n      DeleteBackspaceKeys.setup(editor, caret);\n      EnterKey.setup(editor);\n      SpaceKey.setup(editor);\n      setup$e(editor);\n      HomeEndKeys.setup(editor);\n    };\n    var KeyboardOverrides = { setup: setup$g };\n\n    var NodeChange = function () {\n      function NodeChange(editor) {\n        this.lastPath = [];\n        this.editor = editor;\n        var lastRng;\n        var self = this;\n        if (!('onselectionchange' in editor.getDoc())) {\n          editor.on('NodeChange click mouseup keyup focus', function (e) {\n            var nativeRng, fakeRng;\n            nativeRng = editor.selection.getRng();\n            fakeRng = {\n              startContainer: nativeRng.startContainer,\n              startOffset: nativeRng.startOffset,\n              endContainer: nativeRng.endContainer,\n              endOffset: nativeRng.endOffset\n            };\n            if (e.type === 'nodechange' || !RangeCompare.isEq(fakeRng, lastRng)) {\n              editor.fire('SelectionChange');\n            }\n            lastRng = fakeRng;\n          });\n        }\n        editor.on('contextmenu', function () {\n          editor.fire('SelectionChange');\n        });\n        editor.on('SelectionChange', function () {\n          var startElm = editor.selection.getStart(true);\n          if (!startElm || !Env.range && editor.selection.isCollapsed()) {\n            return;\n          }\n          if (hasAnyRanges(editor) && !self.isSameElementPath(startElm) && editor.dom.isChildOf(startElm, editor.getBody())) {\n            editor.nodeChanged({ selectionChange: true });\n          }\n        });\n        editor.on('mouseup', function (e) {\n          if (!e.isDefaultPrevented() && hasAnyRanges(editor)) {\n            if (editor.selection.getNode().nodeName === 'IMG') {\n              Delay.setEditorTimeout(editor, function () {\n                editor.nodeChanged();\n              });\n            } else {\n              editor.nodeChanged();\n            }\n          }\n        });\n      }\n      NodeChange.prototype.nodeChanged = function (args) {\n        var selection = this.editor.selection;\n        var node, parents, root;\n        if (this.editor.initialized && selection && !this.editor.settings.disable_nodechange && !this.editor.readonly) {\n          root = this.editor.getBody();\n          node = selection.getStart(true) || root;\n          if (node.ownerDocument !== this.editor.getDoc() || !this.editor.dom.isChildOf(node, root)) {\n            node = root;\n          }\n          parents = [];\n          this.editor.dom.getParent(node, function (node) {\n            if (node === root) {\n              return true;\n            }\n            parents.push(node);\n          });\n          args = args || {};\n          args.element = node;\n          args.parents = parents;\n          this.editor.fire('NodeChange', args);\n        }\n      };\n      NodeChange.prototype.isSameElementPath = function (startElm) {\n        var i, currentPath;\n        currentPath = this.editor.$(startElm).parentsUntil(this.editor.getBody()).add(startElm);\n        if (currentPath.length === this.lastPath.length) {\n          for (i = currentPath.length; i >= 0; i--) {\n            if (currentPath[i] !== this.lastPath[i]) {\n              break;\n            }\n          }\n          if (i === -1) {\n            this.lastPath = currentPath;\n            return true;\n          }\n        }\n        this.lastPath = currentPath;\n        return false;\n      };\n      return NodeChange;\n    }();\n\n    var preventSummaryToggle = function (editor) {\n      editor.on('click', function (e) {\n        if (editor.dom.getParent(e.target, 'details')) {\n          e.preventDefault();\n        }\n      });\n    };\n    var filterDetails = function (editor) {\n      editor.parser.addNodeFilter('details', function (elms) {\n        each(elms, function (details) {\n          details.attr('data-mce-open', details.attr('open'));\n          details.attr('open', 'open');\n        });\n      });\n      editor.serializer.addNodeFilter('details', function (elms) {\n        each(elms, function (details) {\n          var open = details.attr('data-mce-open');\n          details.attr('open', isString(open) ? open : null);\n          details.attr('data-mce-open', null);\n        });\n      });\n    };\n    var setup$h = function (editor) {\n      preventSummaryToggle(editor);\n      filterDetails(editor);\n    };\n\n    var isTextBlockNode = function (node) {\n      return NodeType.isElement(node) && isTextBlock(Element.fromDom(node));\n    };\n    var normalizeSelection$1 = function (editor) {\n      var rng = editor.selection.getRng();\n      var startPos = CaretPosition.fromRangeStart(rng);\n      var endPos = CaretPosition.fromRangeEnd(rng);\n      if (CaretPosition.isElementPosition(startPos)) {\n        var container = startPos.container();\n        if (isTextBlockNode(container)) {\n          CaretFinder.firstPositionIn(container).each(function (pos) {\n            return rng.setStart(pos.container(), pos.offset());\n          });\n        }\n      }\n      if (CaretPosition.isElementPosition(endPos)) {\n        var container = startPos.container();\n        if (isTextBlockNode(container)) {\n          CaretFinder.lastPositionIn(container).each(function (pos) {\n            return rng.setEnd(pos.container(), pos.offset());\n          });\n        }\n      }\n      editor.selection.setRng(RangeNormalizer.normalize(rng));\n    };\n    var setup$i = function (editor) {\n      editor.on('click', function (e) {\n        if (e.detail >= 3) {\n          normalizeSelection$1(editor);\n        }\n      });\n    };\n\n    var getAbsolutePosition = function (elm) {\n      var doc, docElem, win, clientRect;\n      clientRect = elm.getBoundingClientRect();\n      doc = elm.ownerDocument;\n      docElem = doc.documentElement;\n      win = doc.defaultView;\n      return {\n        top: clientRect.top + win.pageYOffset - docElem.clientTop,\n        left: clientRect.left + win.pageXOffset - docElem.clientLeft\n      };\n    };\n    var getBodyPosition = function (editor) {\n      return editor.inline ? getAbsolutePosition(editor.getBody()) : {\n        left: 0,\n        top: 0\n      };\n    };\n    var getScrollPosition = function (editor) {\n      var body = editor.getBody();\n      return editor.inline ? {\n        left: body.scrollLeft,\n        top: body.scrollTop\n      } : {\n        left: 0,\n        top: 0\n      };\n    };\n    var getBodyScroll = function (editor) {\n      var body = editor.getBody(), docElm = editor.getDoc().documentElement;\n      var inlineScroll = {\n        left: body.scrollLeft,\n        top: body.scrollTop\n      };\n      var iframeScroll = {\n        left: body.scrollLeft || docElm.scrollLeft,\n        top: body.scrollTop || docElm.scrollTop\n      };\n      return editor.inline ? inlineScroll : iframeScroll;\n    };\n    var getMousePosition = function (editor, event) {\n      if (event.target.ownerDocument !== editor.getDoc()) {\n        var iframePosition = getAbsolutePosition(editor.getContentAreaContainer());\n        var scrollPosition = getBodyScroll(editor);\n        return {\n          left: event.pageX - iframePosition.left + scrollPosition.left,\n          top: event.pageY - iframePosition.top + scrollPosition.top\n        };\n      }\n      return {\n        left: event.pageX,\n        top: event.pageY\n      };\n    };\n    var calculatePosition = function (bodyPosition, scrollPosition, mousePosition) {\n      return {\n        pageX: mousePosition.left - bodyPosition.left + scrollPosition.left,\n        pageY: mousePosition.top - bodyPosition.top + scrollPosition.top\n      };\n    };\n    var calc = function (editor, event) {\n      return calculatePosition(getBodyPosition(editor), getScrollPosition(editor), getMousePosition(editor, event));\n    };\n    var MousePosition = { calc: calc };\n\n    var isContentEditableFalse$a = NodeType.isContentEditableFalse, isContentEditableTrue$4 = NodeType.isContentEditableTrue;\n    var isDraggable = function (rootElm, elm) {\n      return isContentEditableFalse$a(elm) && elm !== rootElm;\n    };\n    var isValidDropTarget = function (editor, targetElement, dragElement) {\n      if (targetElement === dragElement || editor.dom.isChildOf(targetElement, dragElement)) {\n        return false;\n      }\n      return !isContentEditableFalse$a(targetElement);\n    };\n    var cloneElement = function (elm) {\n      var cloneElm = elm.cloneNode(true);\n      cloneElm.removeAttribute('data-mce-selected');\n      return cloneElm;\n    };\n    var createGhost = function (editor, elm, width, height) {\n      var clonedElm = elm.cloneNode(true);\n      editor.dom.setStyles(clonedElm, {\n        width: width,\n        height: height\n      });\n      editor.dom.setAttrib(clonedElm, 'data-mce-selected', null);\n      var ghostElm = editor.dom.create('div', {\n        'class': 'mce-drag-container',\n        'data-mce-bogus': 'all',\n        'unselectable': 'on',\n        'contenteditable': 'false'\n      });\n      editor.dom.setStyles(ghostElm, {\n        position: 'absolute',\n        opacity: 0.5,\n        overflow: 'hidden',\n        border: 0,\n        padding: 0,\n        margin: 0,\n        width: width,\n        height: height\n      });\n      editor.dom.setStyles(clonedElm, {\n        margin: 0,\n        boxSizing: 'border-box'\n      });\n      ghostElm.appendChild(clonedElm);\n      return ghostElm;\n    };\n    var appendGhostToBody = function (ghostElm, bodyElm) {\n      if (ghostElm.parentNode !== bodyElm) {\n        bodyElm.appendChild(ghostElm);\n      }\n    };\n    var moveGhost = function (ghostElm, position, width, height, maxX, maxY) {\n      var overflowX = 0, overflowY = 0;\n      ghostElm.style.left = position.pageX + 'px';\n      ghostElm.style.top = position.pageY + 'px';\n      if (position.pageX + width > maxX) {\n        overflowX = position.pageX + width - maxX;\n      }\n      if (position.pageY + height > maxY) {\n        overflowY = position.pageY + height - maxY;\n      }\n      ghostElm.style.width = width - overflowX + 'px';\n      ghostElm.style.height = height - overflowY + 'px';\n    };\n    var removeElement = function (elm) {\n      if (elm && elm.parentNode) {\n        elm.parentNode.removeChild(elm);\n      }\n    };\n    var isLeftMouseButtonPressed = function (e) {\n      return e.button === 0;\n    };\n    var hasDraggableElement = function (state) {\n      return state.element;\n    };\n    var applyRelPos = function (state, position) {\n      return {\n        pageX: position.pageX - state.relX,\n        pageY: position.pageY + 5\n      };\n    };\n    var start$1 = function (state, editor) {\n      return function (e) {\n        if (isLeftMouseButtonPressed(e)) {\n          var ceElm = find(editor.dom.getParents(e.target), Predicate.or(isContentEditableFalse$a, isContentEditableTrue$4)).getOr(null);\n          if (isDraggable(editor.getBody(), ceElm)) {\n            var elmPos = editor.dom.getPos(ceElm);\n            var bodyElm = editor.getBody();\n            var docElm = editor.getDoc().documentElement;\n            state.element = ceElm;\n            state.screenX = e.screenX;\n            state.screenY = e.screenY;\n            state.maxX = (editor.inline ? bodyElm.scrollWidth : docElm.offsetWidth) - 2;\n            state.maxY = (editor.inline ? bodyElm.scrollHeight : docElm.offsetHeight) - 2;\n            state.relX = e.pageX - elmPos.x;\n            state.relY = e.pageY - elmPos.y;\n            state.width = ceElm.offsetWidth;\n            state.height = ceElm.offsetHeight;\n            state.ghost = createGhost(editor, ceElm, state.width, state.height);\n          }\n        }\n      };\n    };\n    var move$1 = function (state, editor) {\n      var throttledPlaceCaretAt = Delay.throttle(function (clientX, clientY) {\n        editor._selectionOverrides.hideFakeCaret();\n        editor.selection.placeCaretAt(clientX, clientY);\n      }, 0);\n      return function (e) {\n        var movement = Math.max(Math.abs(e.screenX - state.screenX), Math.abs(e.screenY - state.screenY));\n        if (hasDraggableElement(state) && !state.dragging && movement > 10) {\n          var args = editor.fire('dragstart', { target: state.element });\n          if (args.isDefaultPrevented()) {\n            return;\n          }\n          state.dragging = true;\n          editor.focus();\n        }\n        if (state.dragging) {\n          var targetPos = applyRelPos(state, MousePosition.calc(editor, e));\n          appendGhostToBody(state.ghost, editor.getBody());\n          moveGhost(state.ghost, targetPos, state.width, state.height, state.maxX, state.maxY);\n          throttledPlaceCaretAt(e.clientX, e.clientY);\n        }\n      };\n    };\n    var getRawTarget = function (selection) {\n      var rng = selection.getSel().getRangeAt(0);\n      var startContainer = rng.startContainer;\n      return startContainer.nodeType === 3 ? startContainer.parentNode : startContainer;\n    };\n    var drop = function (state, editor) {\n      return function (e) {\n        if (state.dragging) {\n          if (isValidDropTarget(editor, getRawTarget(editor.selection), state.element)) {\n            var targetClone_1 = cloneElement(state.element);\n            var args = editor.fire('drop', {\n              targetClone: targetClone_1,\n              clientX: e.clientX,\n              clientY: e.clientY\n            });\n            if (!args.isDefaultPrevented()) {\n              targetClone_1 = args.targetClone;\n              editor.undoManager.transact(function () {\n                removeElement(state.element);\n                editor.insertContent(editor.dom.getOuterHTML(targetClone_1));\n                editor._selectionOverrides.hideFakeCaret();\n              });\n            }\n          }\n        }\n        removeDragState(state);\n      };\n    };\n    var stop = function (state, editor) {\n      return function () {\n        if (state.dragging) {\n          editor.fire('dragend');\n        }\n        removeDragState(state);\n      };\n    };\n    var removeDragState = function (state) {\n      state.dragging = false;\n      state.element = null;\n      removeElement(state.ghost);\n    };\n    var bindFakeDragEvents = function (editor) {\n      var state = {};\n      var pageDom, dragStartHandler, dragHandler, dropHandler, dragEndHandler, rootDocument;\n      pageDom = DOMUtils$1.DOM;\n      rootDocument = domGlobals.document;\n      dragStartHandler = start$1(state, editor);\n      dragHandler = move$1(state, editor);\n      dropHandler = drop(state, editor);\n      dragEndHandler = stop(state, editor);\n      editor.on('mousedown', dragStartHandler);\n      editor.on('mousemove', dragHandler);\n      editor.on('mouseup', dropHandler);\n      pageDom.bind(rootDocument, 'mousemove', dragHandler);\n      pageDom.bind(rootDocument, 'mouseup', dragEndHandler);\n      editor.on('remove', function () {\n        pageDom.unbind(rootDocument, 'mousemove', dragHandler);\n        pageDom.unbind(rootDocument, 'mouseup', dragEndHandler);\n      });\n    };\n    var blockIeDrop = function (editor) {\n      editor.on('drop', function (e) {\n        var realTarget = typeof e.clientX !== 'undefined' ? editor.getDoc().elementFromPoint(e.clientX, e.clientY) : null;\n        if (isContentEditableFalse$a(realTarget) || isContentEditableFalse$a(editor.dom.getContentEditableParent(realTarget))) {\n          e.preventDefault();\n        }\n      });\n    };\n    var init = function (editor) {\n      bindFakeDragEvents(editor);\n      blockIeDrop(editor);\n    };\n    var DragDropOverrides = { init: init };\n\n    var setup$j = function (editor) {\n      var renderFocusCaret = first(function () {\n        if (!editor.removed && editor.getBody().contains(domGlobals.document.activeElement)) {\n          var rng = editor.selection.getRng();\n          if (rng.collapsed) {\n            var caretRange = renderRangeCaret(editor, editor.selection.getRng(), false);\n            editor.selection.setRng(caretRange);\n          }\n        }\n      }, 0);\n      editor.on('focus', function () {\n        renderFocusCaret.throttle();\n      });\n      editor.on('blur', function () {\n        renderFocusCaret.cancel();\n      });\n    };\n    var CefFocus = { setup: setup$j };\n\n    var isContentEditableTrue$5 = NodeType.isContentEditableTrue;\n    var isContentEditableFalse$b = NodeType.isContentEditableFalse;\n    var getContentEditableRoot$2 = function (editor, node) {\n      var root = editor.getBody();\n      while (node && node !== root) {\n        if (isContentEditableTrue$5(node) || isContentEditableFalse$b(node)) {\n          return node;\n        }\n        node = node.parentNode;\n      }\n      return null;\n    };\n    var SelectionOverrides = function (editor) {\n      var isBlock = function (node) {\n        return editor.dom.isBlock(node);\n      };\n      var rootNode = editor.getBody();\n      var fakeCaret = FakeCaret(editor, rootNode, isBlock, function () {\n        return EditorFocus.hasFocus(editor);\n      });\n      var realSelectionId = 'sel-' + editor.dom.uniqueId();\n      var selectedContentEditableNode;\n      var isFakeSelectionElement = function (elm) {\n        return editor.dom.hasClass(elm, 'mce-offscreen-selection');\n      };\n      var getRealSelectionElement = function () {\n        var container = editor.dom.get(realSelectionId);\n        return container ? container.getElementsByTagName('*')[0] : container;\n      };\n      var setRange = function (range) {\n        if (range) {\n          editor.selection.setRng(range);\n        }\n      };\n      var getRange = function () {\n        return editor.selection.getRng();\n      };\n      var showCaret = function (direction, node, before, scrollIntoView) {\n        if (scrollIntoView === void 0) {\n          scrollIntoView = true;\n        }\n        var e;\n        e = editor.fire('ShowCaret', {\n          target: node,\n          direction: direction,\n          before: before\n        });\n        if (e.isDefaultPrevented()) {\n          return null;\n        }\n        if (scrollIntoView) {\n          editor.selection.scrollIntoView(node, direction === -1);\n        }\n        return fakeCaret.show(before, node);\n      };\n      var showBlockCaretContainer = function (blockCaretContainer) {\n        if (blockCaretContainer.hasAttribute('data-mce-caret')) {\n          showCaretContainerBlock(blockCaretContainer);\n          setRange(getRange());\n          editor.selection.scrollIntoView(blockCaretContainer);\n        }\n      };\n      var registerEvents = function () {\n        editor.on('mouseup', function (e) {\n          var range = getRange();\n          if (range.collapsed && EditorView.isXYInContentArea(editor, e.clientX, e.clientY)) {\n            setRange(renderCaretAtRange(editor, range, false));\n          }\n        });\n        editor.on('click', function (e) {\n          var contentEditableRoot;\n          contentEditableRoot = getContentEditableRoot$2(editor, e.target);\n          if (contentEditableRoot) {\n            if (isContentEditableFalse$b(contentEditableRoot)) {\n              e.preventDefault();\n              editor.focus();\n            }\n            if (isContentEditableTrue$5(contentEditableRoot)) {\n              if (editor.dom.isChildOf(contentEditableRoot, editor.selection.getNode())) {\n                removeContentEditableSelection();\n              }\n            }\n          }\n        });\n        editor.on('blur NewBlock', function () {\n          removeContentEditableSelection();\n        });\n        editor.on('ResizeWindow FullscreenStateChanged', function () {\n          return fakeCaret.reposition();\n        });\n        var handleTouchSelect = function (editor) {\n          editor.on('tap', function (e) {\n            var contentEditableRoot = getContentEditableRoot$2(editor, e.target);\n            if (isContentEditableFalse$b(contentEditableRoot)) {\n              e.preventDefault();\n              setContentEditableSelection(selectNode(editor, contentEditableRoot));\n            }\n          }, true);\n        };\n        var hasNormalCaretPosition = function (elm) {\n          var caretWalker = CaretWalker(elm);\n          if (!elm.firstChild) {\n            return false;\n          }\n          var startPos = CaretPosition$1.before(elm.firstChild);\n          var newPos = caretWalker.next(startPos);\n          return newPos && !isBeforeContentEditableFalse(newPos) && !isAfterContentEditableFalse(newPos);\n        };\n        var isInSameBlock = function (node1, node2) {\n          var block1 = editor.dom.getParent(node1, editor.dom.isBlock);\n          var block2 = editor.dom.getParent(node2, editor.dom.isBlock);\n          return block1 === block2;\n        };\n        var hasBetterMouseTarget = function (targetNode, caretNode) {\n          var targetBlock = editor.dom.getParent(targetNode, editor.dom.isBlock);\n          var caretBlock = editor.dom.getParent(caretNode, editor.dom.isBlock);\n          if (targetBlock && editor.dom.isChildOf(targetBlock, caretBlock) && isContentEditableFalse$b(getContentEditableRoot$2(editor, targetBlock)) === false) {\n            return true;\n          }\n          return targetBlock && !isInSameBlock(targetBlock, caretBlock) && hasNormalCaretPosition(targetBlock);\n        };\n        handleTouchSelect(editor);\n        editor.on('mousedown', function (e) {\n          var contentEditableRoot;\n          var targetElm = e.target;\n          if (targetElm !== rootNode && targetElm.nodeName !== 'HTML' && !editor.dom.isChildOf(targetElm, rootNode)) {\n            return;\n          }\n          if (EditorView.isXYInContentArea(editor, e.clientX, e.clientY) === false) {\n            return;\n          }\n          contentEditableRoot = getContentEditableRoot$2(editor, targetElm);\n          if (contentEditableRoot) {\n            if (isContentEditableFalse$b(contentEditableRoot)) {\n              e.preventDefault();\n              setContentEditableSelection(selectNode(editor, contentEditableRoot));\n            } else {\n              removeContentEditableSelection();\n              if (!(isContentEditableTrue$5(contentEditableRoot) && e.shiftKey) && !RangePoint.isXYWithinRange(e.clientX, e.clientY, editor.selection.getRng())) {\n                hideFakeCaret();\n                editor.selection.placeCaretAt(e.clientX, e.clientY);\n              }\n            }\n          } else if (isFakeCaretTarget(targetElm) === false) {\n            removeContentEditableSelection();\n            hideFakeCaret();\n            var caretInfo = closestCaret(rootNode, e.clientX, e.clientY);\n            if (caretInfo) {\n              if (!hasBetterMouseTarget(e.target, caretInfo.node)) {\n                e.preventDefault();\n                var range = showCaret(1, caretInfo.node, caretInfo.before, false);\n                editor.getBody().focus();\n                setRange(range);\n              }\n            }\n          }\n        });\n        editor.on('keypress', function (e) {\n          if (VK.modifierPressed(e)) {\n            return;\n          }\n          switch (e.keyCode) {\n          default:\n            if (isContentEditableFalse$b(editor.selection.getNode())) {\n              e.preventDefault();\n            }\n            break;\n          }\n        });\n        editor.on('GetSelectionRange', function (e) {\n          var rng = e.range;\n          if (selectedContentEditableNode) {\n            if (!selectedContentEditableNode.parentNode) {\n              selectedContentEditableNode = null;\n              return;\n            }\n            rng = rng.cloneRange();\n            rng.selectNode(selectedContentEditableNode);\n            e.range = rng;\n          }\n        });\n        editor.on('SetSelectionRange', function (e) {\n          e.range = normalizeShortEndedElementSelection(e.range);\n          var rng = setContentEditableSelection(e.range, e.forward);\n          if (rng) {\n            e.range = rng;\n          }\n        });\n        var isPasteBin = function (node) {\n          return node.id === 'mcepastebin';\n        };\n        editor.on('AfterSetSelectionRange', function (e) {\n          var rng = e.range;\n          if (!isRangeInCaretContainer(rng) && !isPasteBin(rng.startContainer.parentNode)) {\n            hideFakeCaret();\n          }\n          if (!isFakeSelectionElement(rng.startContainer.parentNode)) {\n            removeContentEditableSelection();\n          }\n        });\n        editor.on('copy', function (e) {\n          var clipboardData = e.clipboardData;\n          if (!e.isDefaultPrevented() && e.clipboardData && !Env.ie) {\n            var realSelectionElement = getRealSelectionElement();\n            if (realSelectionElement) {\n              e.preventDefault();\n              clipboardData.clearData();\n              clipboardData.setData('text/html', realSelectionElement.outerHTML);\n              clipboardData.setData('text/plain', realSelectionElement.outerText);\n            }\n          }\n        });\n        DragDropOverrides.init(editor);\n        CefFocus.setup(editor);\n      };\n      var isWithinCaretContainer = function (node) {\n        return isCaretContainer(node) || startsWithCaretContainer(node) || endsWithCaretContainer(node);\n      };\n      var isRangeInCaretContainer = function (rng) {\n        return isWithinCaretContainer(rng.startContainer) || isWithinCaretContainer(rng.endContainer);\n      };\n      var normalizeShortEndedElementSelection = function (rng) {\n        var shortEndedElements = editor.schema.getShortEndedElements();\n        var newRng = editor.dom.createRng();\n        var startContainer = rng.startContainer;\n        var startOffset = rng.startOffset;\n        var endContainer = rng.endContainer;\n        var endOffset = rng.endOffset;\n        if (has(shortEndedElements, startContainer.nodeName.toLowerCase())) {\n          if (startOffset === 0) {\n            newRng.setStartBefore(startContainer);\n          } else {\n            newRng.setStartAfter(startContainer);\n          }\n        } else {\n          newRng.setStart(startContainer, startOffset);\n        }\n        if (has(shortEndedElements, endContainer.nodeName.toLowerCase())) {\n          if (endOffset === 0) {\n            newRng.setEndBefore(endContainer);\n          } else {\n            newRng.setEndAfter(endContainer);\n          }\n        } else {\n          newRng.setEnd(endContainer, endOffset);\n        }\n        return newRng;\n      };\n      var setContentEditableSelection = function (range, forward) {\n        var node;\n        var $ = editor.$;\n        var dom = editor.dom;\n        var $realSelectionContainer, sel, startContainer, startOffset, endOffset, e, caretPosition, targetClone, origTargetClone;\n        if (!range) {\n          return null;\n        }\n        if (range.collapsed) {\n          if (!isRangeInCaretContainer(range)) {\n            if (forward === false) {\n              caretPosition = getNormalizedRangeEndPoint(-1, rootNode, range);\n              if (isFakeCaretTarget(caretPosition.getNode(true))) {\n                return showCaret(-1, caretPosition.getNode(true), false, false);\n              }\n              if (isFakeCaretTarget(caretPosition.getNode())) {\n                return showCaret(-1, caretPosition.getNode(), !caretPosition.isAtEnd(), false);\n              }\n            } else {\n              caretPosition = getNormalizedRangeEndPoint(1, rootNode, range);\n              if (isFakeCaretTarget(caretPosition.getNode())) {\n                return showCaret(1, caretPosition.getNode(), !caretPosition.isAtEnd(), false);\n              }\n              if (isFakeCaretTarget(caretPosition.getNode(true))) {\n                return showCaret(1, caretPosition.getNode(true), false, false);\n              }\n            }\n          }\n          return null;\n        }\n        startContainer = range.startContainer;\n        startOffset = range.startOffset;\n        endOffset = range.endOffset;\n        if (startContainer.nodeType === 3 && startOffset === 0 && isContentEditableFalse$b(startContainer.parentNode)) {\n          startContainer = startContainer.parentNode;\n          startOffset = dom.nodeIndex(startContainer);\n          startContainer = startContainer.parentNode;\n        }\n        if (startContainer.nodeType !== 1) {\n          return null;\n        }\n        if (endOffset === startOffset + 1 && startContainer === range.endContainer) {\n          node = startContainer.childNodes[startOffset];\n        }\n        if (!isContentEditableFalse$b(node)) {\n          return null;\n        }\n        targetClone = origTargetClone = node.cloneNode(true);\n        e = editor.fire('ObjectSelected', {\n          target: node,\n          targetClone: targetClone\n        });\n        if (e.isDefaultPrevented()) {\n          return null;\n        }\n        $realSelectionContainer = descendant(Element.fromDom(editor.getBody()), '#' + realSelectionId).fold(function () {\n          return $([]);\n        }, function (elm) {\n          return $([elm.dom()]);\n        });\n        targetClone = e.targetClone;\n        if ($realSelectionContainer.length === 0) {\n          $realSelectionContainer = $('<div data-mce-bogus=\"all\" class=\"mce-offscreen-selection\"></div>').attr('id', realSelectionId);\n          $realSelectionContainer.appendTo(editor.getBody());\n        }\n        range = editor.dom.createRng();\n        if (targetClone === origTargetClone && Env.ie) {\n          $realSelectionContainer.empty().append('<p style=\"font-size: 0\" data-mce-bogus=\"all\">\\xA0</p>').append(targetClone);\n          range.setStartAfter($realSelectionContainer[0].firstChild.firstChild);\n          range.setEndAfter(targetClone);\n        } else {\n          $realSelectionContainer.empty().append(nbsp).append(targetClone).append(nbsp);\n          range.setStart($realSelectionContainer[0].firstChild, 1);\n          range.setEnd($realSelectionContainer[0].lastChild, 0);\n        }\n        $realSelectionContainer.css({ top: dom.getPos(node, editor.getBody()).y });\n        $realSelectionContainer[0].focus();\n        sel = editor.selection.getSel();\n        sel.removeAllRanges();\n        sel.addRange(range);\n        var nodeElm = Element.fromDom(node);\n        each(descendants$1(Element.fromDom(editor.getBody()), '*[data-mce-selected]'), function (elm) {\n          if (!eq(nodeElm, elm)) {\n            remove$1(elm, 'data-mce-selected');\n          }\n        });\n        if (!editor.dom.getAttrib(node, 'data-mce-selected')) {\n          node.setAttribute('data-mce-selected', '1');\n        }\n        selectedContentEditableNode = node;\n        hideFakeCaret();\n        return range;\n      };\n      var removeContentEditableSelection = function () {\n        if (selectedContentEditableNode) {\n          selectedContentEditableNode.removeAttribute('data-mce-selected');\n          descendant(Element.fromDom(editor.getBody()), '#' + realSelectionId).each(remove);\n          selectedContentEditableNode = null;\n        }\n        descendant(Element.fromDom(editor.getBody()), '#' + realSelectionId).each(remove);\n        selectedContentEditableNode = null;\n      };\n      var destroy = function () {\n        fakeCaret.destroy();\n        selectedContentEditableNode = null;\n      };\n      var hideFakeCaret = function () {\n        fakeCaret.hide();\n      };\n      if (Env.ceFalse) {\n        registerEvents();\n      }\n      return {\n        showCaret: showCaret,\n        showBlockCaretContainer: showBlockCaretContainer,\n        hideFakeCaret: hideFakeCaret,\n        destroy: destroy\n      };\n    };\n\n    var Quirks = function (editor) {\n      var each = Tools.each;\n      var BACKSPACE = VK.BACKSPACE, DELETE = VK.DELETE, dom = editor.dom, selection = editor.selection, settings = editor.settings, parser = editor.parser;\n      var isGecko = Env.gecko, isIE = Env.ie, isWebKit = Env.webkit;\n      var mceInternalUrlPrefix = 'data:text/mce-internal,';\n      var mceInternalDataType = isIE ? 'Text' : 'URL';\n      var setEditorCommandState = function (cmd, state) {\n        try {\n          editor.getDoc().execCommand(cmd, false, state);\n        } catch (ex) {\n        }\n      };\n      var isDefaultPrevented = function (e) {\n        return e.isDefaultPrevented();\n      };\n      var setMceInternalContent = function (e) {\n        var selectionHtml, internalContent;\n        if (e.dataTransfer) {\n          if (editor.selection.isCollapsed() && e.target.tagName === 'IMG') {\n            selection.select(e.target);\n          }\n          selectionHtml = editor.selection.getContent();\n          if (selectionHtml.length > 0) {\n            internalContent = mceInternalUrlPrefix + escape(editor.id) + ',' + escape(selectionHtml);\n            e.dataTransfer.setData(mceInternalDataType, internalContent);\n          }\n        }\n      };\n      var getMceInternalContent = function (e) {\n        var internalContent;\n        if (e.dataTransfer) {\n          internalContent = e.dataTransfer.getData(mceInternalDataType);\n          if (internalContent && internalContent.indexOf(mceInternalUrlPrefix) >= 0) {\n            internalContent = internalContent.substr(mceInternalUrlPrefix.length).split(',');\n            return {\n              id: unescape(internalContent[0]),\n              html: unescape(internalContent[1])\n            };\n          }\n        }\n        return null;\n      };\n      var insertClipboardContents = function (content, internal) {\n        if (editor.queryCommandSupported('mceInsertClipboardContent')) {\n          editor.execCommand('mceInsertClipboardContent', false, {\n            content: content,\n            internal: internal\n          });\n        } else {\n          editor.execCommand('mceInsertContent', false, content);\n        }\n      };\n      var emptyEditorWhenDeleting = function () {\n        var serializeRng = function (rng) {\n          var body = dom.create('body');\n          var contents = rng.cloneContents();\n          body.appendChild(contents);\n          return selection.serializer.serialize(body, { format: 'html' });\n        };\n        var allContentsSelected = function (rng) {\n          var selection = serializeRng(rng);\n          var allRng = dom.createRng();\n          allRng.selectNode(editor.getBody());\n          var allSelection = serializeRng(allRng);\n          return selection === allSelection;\n        };\n        editor.on('keydown', function (e) {\n          var keyCode = e.keyCode;\n          var isCollapsed, body;\n          if (!isDefaultPrevented(e) && (keyCode === DELETE || keyCode === BACKSPACE)) {\n            isCollapsed = editor.selection.isCollapsed();\n            body = editor.getBody();\n            if (isCollapsed && !dom.isEmpty(body)) {\n              return;\n            }\n            if (!isCollapsed && !allContentsSelected(editor.selection.getRng())) {\n              return;\n            }\n            e.preventDefault();\n            editor.setContent('');\n            if (body.firstChild && dom.isBlock(body.firstChild)) {\n              editor.selection.setCursorLocation(body.firstChild, 0);\n            } else {\n              editor.selection.setCursorLocation(body, 0);\n            }\n            editor.nodeChanged();\n          }\n        });\n      };\n      var selectAll = function () {\n        editor.shortcuts.add('meta+a', null, 'SelectAll');\n      };\n      var inputMethodFocus = function () {\n        if (!editor.inline) {\n          dom.bind(editor.getDoc(), 'mousedown mouseup', function (e) {\n            var rng;\n            if (e.target === editor.getDoc().documentElement) {\n              rng = selection.getRng();\n              editor.getBody().focus();\n              if (e.type === 'mousedown') {\n                if (isCaretContainer(rng.startContainer)) {\n                  return;\n                }\n                selection.placeCaretAt(e.clientX, e.clientY);\n              } else {\n                selection.setRng(rng);\n              }\n            }\n          });\n        }\n      };\n      var removeHrOnBackspace = function () {\n        editor.on('keydown', function (e) {\n          if (!isDefaultPrevented(e) && e.keyCode === BACKSPACE) {\n            if (!editor.getBody().getElementsByTagName('hr').length) {\n              return;\n            }\n            if (selection.isCollapsed() && selection.getRng().startOffset === 0) {\n              var node = selection.getNode();\n              var previousSibling = node.previousSibling;\n              if (node.nodeName === 'HR') {\n                dom.remove(node);\n                e.preventDefault();\n                return;\n              }\n              if (previousSibling && previousSibling.nodeName && previousSibling.nodeName.toLowerCase() === 'hr') {\n                dom.remove(previousSibling);\n                e.preventDefault();\n              }\n            }\n          }\n        });\n      };\n      var focusBody = function () {\n        if (!domGlobals.Range.prototype.getClientRects) {\n          editor.on('mousedown', function (e) {\n            if (!isDefaultPrevented(e) && e.target.nodeName === 'HTML') {\n              var body_1 = editor.getBody();\n              body_1.blur();\n              Delay.setEditorTimeout(editor, function () {\n                body_1.focus();\n              });\n            }\n          });\n        }\n      };\n      var selectControlElements = function () {\n        editor.on('click', function (e) {\n          var target = e.target;\n          if (/^(IMG|HR)$/.test(target.nodeName) && dom.getContentEditableParent(target) !== 'false') {\n            e.preventDefault();\n            editor.selection.select(target);\n            editor.nodeChanged();\n          }\n          if (target.nodeName === 'A' && dom.hasClass(target, 'mce-item-anchor')) {\n            e.preventDefault();\n            selection.select(target);\n          }\n        });\n      };\n      var removeStylesWhenDeletingAcrossBlockElements = function () {\n        var getAttributeApplyFunction = function () {\n          var template = dom.getAttribs(selection.getStart().cloneNode(false));\n          return function () {\n            var target = selection.getStart();\n            if (target !== editor.getBody()) {\n              dom.setAttrib(target, 'style', null);\n              each(template, function (attr) {\n                target.setAttributeNode(attr.cloneNode(true));\n              });\n            }\n          };\n        };\n        var isSelectionAcrossElements = function () {\n          return !selection.isCollapsed() && dom.getParent(selection.getStart(), dom.isBlock) !== dom.getParent(selection.getEnd(), dom.isBlock);\n        };\n        editor.on('keypress', function (e) {\n          var applyAttributes;\n          if (!isDefaultPrevented(e) && (e.keyCode === 8 || e.keyCode === 46) && isSelectionAcrossElements()) {\n            applyAttributes = getAttributeApplyFunction();\n            editor.getDoc().execCommand('delete', false, null);\n            applyAttributes();\n            e.preventDefault();\n            return false;\n          }\n        });\n        dom.bind(editor.getDoc(), 'cut', function (e) {\n          var applyAttributes;\n          if (!isDefaultPrevented(e) && isSelectionAcrossElements()) {\n            applyAttributes = getAttributeApplyFunction();\n            Delay.setEditorTimeout(editor, function () {\n              applyAttributes();\n            });\n          }\n        });\n      };\n      var disableBackspaceIntoATable = function () {\n        editor.on('keydown', function (e) {\n          if (!isDefaultPrevented(e) && e.keyCode === BACKSPACE) {\n            if (selection.isCollapsed() && selection.getRng().startOffset === 0) {\n              var previousSibling = selection.getNode().previousSibling;\n              if (previousSibling && previousSibling.nodeName && previousSibling.nodeName.toLowerCase() === 'table') {\n                e.preventDefault();\n                return false;\n              }\n            }\n          }\n        });\n      };\n      var removeBlockQuoteOnBackSpace = function () {\n        editor.on('keydown', function (e) {\n          var rng, container, offset, root, parent;\n          if (isDefaultPrevented(e) || e.keyCode !== VK.BACKSPACE) {\n            return;\n          }\n          rng = selection.getRng();\n          container = rng.startContainer;\n          offset = rng.startOffset;\n          root = dom.getRoot();\n          parent = container;\n          if (!rng.collapsed || offset !== 0) {\n            return;\n          }\n          while (parent && parent.parentNode && parent.parentNode.firstChild === parent && parent.parentNode !== root) {\n            parent = parent.parentNode;\n          }\n          if (parent.tagName === 'BLOCKQUOTE') {\n            editor.formatter.toggle('blockquote', null, parent);\n            rng = dom.createRng();\n            rng.setStart(container, 0);\n            rng.setEnd(container, 0);\n            selection.setRng(rng);\n          }\n        });\n      };\n      var setGeckoEditingOptions = function () {\n        var setOpts = function () {\n          setEditorCommandState('StyleWithCSS', false);\n          setEditorCommandState('enableInlineTableEditing', false);\n          if (!settings.object_resizing) {\n            setEditorCommandState('enableObjectResizing', false);\n          }\n        };\n        if (!settings.readonly) {\n          editor.on('BeforeExecCommand mousedown', setOpts);\n        }\n      };\n      var addBrAfterLastLinks = function () {\n        var fixLinks = function () {\n          each(dom.select('a'), function (node) {\n            var parentNode = node.parentNode;\n            var root = dom.getRoot();\n            if (parentNode.lastChild === node) {\n              while (parentNode && !dom.isBlock(parentNode)) {\n                if (parentNode.parentNode.lastChild !== parentNode || parentNode === root) {\n                  return;\n                }\n                parentNode = parentNode.parentNode;\n              }\n              dom.add(parentNode, 'br', { 'data-mce-bogus': 1 });\n            }\n          });\n        };\n        editor.on('SetContent ExecCommand', function (e) {\n          if (e.type === 'setcontent' || e.command === 'mceInsertLink') {\n            fixLinks();\n          }\n        });\n      };\n      var setDefaultBlockType = function () {\n        if (settings.forced_root_block) {\n          editor.on('init', function () {\n            setEditorCommandState('DefaultParagraphSeparator', Settings.getForcedRootBlock(editor));\n          });\n        }\n      };\n      var normalizeSelection = function () {\n        editor.on('keyup focusin mouseup', function (e) {\n          if (!VK.modifierPressed(e)) {\n            selection.normalize();\n          }\n        }, true);\n      };\n      var showBrokenImageIcon = function () {\n        editor.contentStyles.push('img:-moz-broken {' + '-moz-force-broken-image-icon:1;' + 'min-width:24px;' + 'min-height:24px' + '}');\n      };\n      var restoreFocusOnKeyDown = function () {\n        if (!editor.inline) {\n          editor.on('keydown', function () {\n            if (domGlobals.document.activeElement === domGlobals.document.body) {\n              editor.getWin().focus();\n            }\n          });\n        }\n      };\n      var bodyHeight = function () {\n        if (!editor.inline) {\n          editor.contentStyles.push('body {min-height: 150px}');\n          editor.on('click', function (e) {\n            var rng;\n            if (e.target.nodeName === 'HTML') {\n              if (Env.ie > 11) {\n                editor.getBody().focus();\n                return;\n              }\n              rng = editor.selection.getRng();\n              editor.getBody().focus();\n              editor.selection.setRng(rng);\n              editor.selection.normalize();\n              editor.nodeChanged();\n            }\n          });\n        }\n      };\n      var blockCmdArrowNavigation = function () {\n        if (Env.mac) {\n          editor.on('keydown', function (e) {\n            if (VK.metaKeyPressed(e) && !e.shiftKey && (e.keyCode === 37 || e.keyCode === 39)) {\n              e.preventDefault();\n              var selection_1 = editor.selection.getSel();\n              selection_1.modify('move', e.keyCode === 37 ? 'backward' : 'forward', 'lineboundary');\n            }\n          });\n        }\n      };\n      var disableAutoUrlDetect = function () {\n        setEditorCommandState('AutoUrlDetect', false);\n      };\n      var tapLinksAndImages = function () {\n        editor.on('click', function (e) {\n          var elm = e.target;\n          do {\n            if (elm.tagName === 'A') {\n              e.preventDefault();\n              return;\n            }\n          } while (elm = elm.parentNode);\n        });\n        editor.contentStyles.push('.mce-content-body {-webkit-touch-callout: none}');\n      };\n      var blockFormSubmitInsideEditor = function () {\n        editor.on('init', function () {\n          editor.dom.bind(editor.getBody(), 'submit', function (e) {\n            e.preventDefault();\n          });\n        });\n      };\n      var removeAppleInterchangeBrs = function () {\n        parser.addNodeFilter('br', function (nodes) {\n          var i = nodes.length;\n          while (i--) {\n            if (nodes[i].attr('class') === 'Apple-interchange-newline') {\n              nodes[i].remove();\n            }\n          }\n        });\n      };\n      var ieInternalDragAndDrop = function () {\n        editor.on('dragstart', function (e) {\n          setMceInternalContent(e);\n        });\n        editor.on('drop', function (e) {\n          if (!isDefaultPrevented(e)) {\n            var internalContent = getMceInternalContent(e);\n            if (internalContent && internalContent.id !== editor.id) {\n              e.preventDefault();\n              var rng = CaretRangeFromPoint.fromPoint(e.x, e.y, editor.getDoc());\n              selection.setRng(rng);\n              insertClipboardContents(internalContent.html, true);\n            }\n          }\n        });\n      };\n      var refreshContentEditable = function () {\n      };\n      var isHidden = function () {\n        var sel;\n        if (!isGecko || editor.removed) {\n          return false;\n        }\n        sel = editor.selection.getSel();\n        return !sel || !sel.rangeCount || sel.rangeCount === 0;\n      };\n      removeBlockQuoteOnBackSpace();\n      emptyEditorWhenDeleting();\n      if (!Env.windowsPhone) {\n        normalizeSelection();\n      }\n      if (isWebKit) {\n        inputMethodFocus();\n        selectControlElements();\n        setDefaultBlockType();\n        blockFormSubmitInsideEditor();\n        disableBackspaceIntoATable();\n        removeAppleInterchangeBrs();\n        if (Env.iOS) {\n          restoreFocusOnKeyDown();\n          bodyHeight();\n          tapLinksAndImages();\n        } else {\n          selectAll();\n        }\n      }\n      if (Env.ie >= 11) {\n        bodyHeight();\n        disableBackspaceIntoATable();\n      }\n      if (Env.ie) {\n        selectAll();\n        disableAutoUrlDetect();\n        ieInternalDragAndDrop();\n      }\n      if (isGecko) {\n        removeHrOnBackspace();\n        focusBody();\n        removeStylesWhenDeletingAcrossBlockElements();\n        setGeckoEditingOptions();\n        addBrAfterLastLinks();\n        showBrokenImageIcon();\n        blockCmdArrowNavigation();\n        disableBackspaceIntoATable();\n      }\n      return {\n        refreshContentEditable: refreshContentEditable,\n        isHidden: isHidden\n      };\n    };\n\n    var DOM$4 = DOMUtils$1.DOM;\n    var appendStyle = function (editor, text) {\n      var head = Element.fromDom(editor.getDoc().head);\n      var tag = Element.fromTag('style');\n      set(tag, 'type', 'text/css');\n      append(tag, Element.fromText(text));\n      append(head, tag);\n    };\n    var createParser = function (editor) {\n      var parser = DomParser(editor.settings, editor.schema);\n      parser.addAttributeFilter('src,href,style,tabindex', function (nodes, name) {\n        var i = nodes.length, node;\n        var dom = editor.dom;\n        var value, internalName;\n        while (i--) {\n          node = nodes[i];\n          value = node.attr(name);\n          internalName = 'data-mce-' + name;\n          if (!node.attr(internalName)) {\n            if (value.indexOf('data:') === 0 || value.indexOf('blob:') === 0) {\n              continue;\n            }\n            if (name === 'style') {\n              value = dom.serializeStyle(dom.parseStyle(value), node.name);\n              if (!value.length) {\n                value = null;\n              }\n              node.attr(internalName, value);\n              node.attr(name, value);\n            } else if (name === 'tabindex') {\n              node.attr(internalName, value);\n              node.attr(name, null);\n            } else {\n              node.attr(internalName, editor.convertURL(value, name, node.name));\n            }\n          }\n        }\n      });\n      parser.addNodeFilter('script', function (nodes) {\n        var i = nodes.length, node, type;\n        while (i--) {\n          node = nodes[i];\n          type = node.attr('type') || 'no/type';\n          if (type.indexOf('mce-') !== 0) {\n            node.attr('type', 'mce-' + type);\n          }\n        }\n      });\n      if (editor.settings.preserve_cdata) {\n        parser.addNodeFilter('#cdata', function (nodes) {\n          var i = nodes.length, node;\n          while (i--) {\n            node = nodes[i];\n            node.type = 8;\n            node.name = '#comment';\n            node.value = '[CDATA[' + editor.dom.encode(node.value) + ']]';\n          }\n        });\n      }\n      parser.addNodeFilter('p,h1,h2,h3,h4,h5,h6,div', function (nodes) {\n        var i = nodes.length, node;\n        var nonEmptyElements = editor.schema.getNonEmptyElements();\n        while (i--) {\n          node = nodes[i];\n          if (node.isEmpty(nonEmptyElements) && node.getAll('br').length === 0) {\n            node.append(new Node$1('br', 1)).shortEnded = true;\n          }\n        }\n      });\n      return parser;\n    };\n    var autoFocus = function (editor) {\n      if (editor.settings.auto_focus) {\n        Delay.setEditorTimeout(editor, function () {\n          var focusEditor;\n          if (editor.settings.auto_focus === true) {\n            focusEditor = editor;\n          } else {\n            focusEditor = editor.editorManager.get(editor.settings.auto_focus);\n          }\n          if (!focusEditor.destroyed) {\n            focusEditor.focus();\n          }\n        }, 100);\n      }\n    };\n    var moveSelectionToFirstCaretPosition = function (editor) {\n      var root = editor.dom.getRoot();\n      if (!editor.inline && (!hasAnyRanges(editor) || editor.selection.getStart(true) === root)) {\n        CaretFinder.firstPositionIn(root).each(function (pos) {\n          var node = pos.getNode();\n          var caretPos = NodeType.isTable(node) ? CaretFinder.firstPositionIn(node).getOr(pos) : pos;\n          editor.selection.setRng(caretPos.toRange());\n        });\n      }\n    };\n    var initEditor = function (editor) {\n      editor.bindPendingEventDelegates();\n      editor.initialized = true;\n      fireInit(editor);\n      editor.focus(true);\n      moveSelectionToFirstCaretPosition(editor);\n      editor.nodeChanged({ initial: true });\n      editor.execCallback('init_instance_callback', editor);\n      autoFocus(editor);\n    };\n    var getStyleSheetLoader = function (editor) {\n      return editor.inline ? DOM$4.styleSheetLoader : editor.dom.styleSheetLoader;\n    };\n    var initContentBody = function (editor, skipWrite) {\n      var settings = editor.settings;\n      var targetElm = editor.getElement();\n      var doc = editor.getDoc(), body, contentCssText;\n      if (!settings.inline) {\n        editor.getElement().style.visibility = editor.orgVisibility;\n      }\n      if (!skipWrite && !editor.inline) {\n        doc.open();\n        doc.write(editor.iframeHTML);\n        doc.close();\n      }\n      if (editor.inline) {\n        editor.on('remove', function () {\n          var bodyEl = this.getBody();\n          DOM$4.removeClass(bodyEl, 'mce-content-body');\n          DOM$4.removeClass(bodyEl, 'mce-edit-focus');\n          DOM$4.setAttrib(bodyEl, 'contentEditable', null);\n        });\n        DOM$4.addClass(targetElm, 'mce-content-body');\n        editor.contentDocument = doc = domGlobals.document;\n        editor.contentWindow = domGlobals.window;\n        editor.bodyElement = targetElm;\n        editor.contentAreaContainer = targetElm;\n        settings.root_name = targetElm.nodeName.toLowerCase();\n      }\n      body = editor.getBody();\n      body.disabled = true;\n      editor.readonly = settings.readonly;\n      if (!editor.readonly) {\n        if (editor.inline && DOM$4.getStyle(body, 'position', true) === 'static') {\n          body.style.position = 'relative';\n        }\n        body.contentEditable = editor.getParam('content_editable_state', true);\n      }\n      body.disabled = false;\n      editor.editorUpload = EditorUpload(editor);\n      editor.schema = Schema(settings);\n      editor.dom = DOMUtils$1(doc, {\n        keep_values: true,\n        url_converter: editor.convertURL,\n        url_converter_scope: editor,\n        hex_colors: settings.force_hex_style_colors,\n        update_styles: true,\n        root_element: editor.inline ? editor.getBody() : null,\n        collect: function () {\n          return editor.inline;\n        },\n        schema: editor.schema,\n        contentCssCors: Settings.shouldUseContentCssCors(editor),\n        referrerPolicy: Settings.getReferrerPolicy(editor),\n        onSetAttrib: function (e) {\n          editor.fire('SetAttrib', e);\n        }\n      });\n      editor.parser = createParser(editor);\n      editor.serializer = Serializer$1(settings, editor);\n      editor.selection = Selection$1(editor.dom, editor.getWin(), editor.serializer, editor);\n      editor.annotator = Annotator(editor);\n      editor.formatter = Formatter(editor);\n      editor.undoManager = UndoManager(editor);\n      editor._nodeChangeDispatcher = new NodeChange(editor);\n      editor._selectionOverrides = SelectionOverrides(editor);\n      TouchEvents.setup(editor);\n      setup$h(editor);\n      setup$i(editor);\n      KeyboardOverrides.setup(editor);\n      ForceBlocks.setup(editor);\n      setup$6(editor);\n      firePreInit(editor);\n      if (!settings.browser_spellcheck && !settings.gecko_spellcheck) {\n        doc.body.spellcheck = false;\n        DOM$4.setAttrib(body, 'spellcheck', 'false');\n      }\n      editor.quirks = Quirks(editor);\n      firePostRender(editor);\n      var directionality = Settings.getDirectionality(editor);\n      if (directionality !== undefined) {\n        body.dir = directionality;\n      }\n      if (settings.protect) {\n        editor.on('BeforeSetContent', function (e) {\n          Tools.each(settings.protect, function (pattern) {\n            e.content = e.content.replace(pattern, function (str) {\n              return '<!--mce:protected ' + escape(str) + '-->';\n            });\n          });\n        });\n      }\n      editor.on('SetContent', function () {\n        editor.addVisual(editor.getBody());\n      });\n      editor.load({\n        initial: true,\n        format: 'html'\n      });\n      editor.startContent = editor.getContent({ format: 'raw' });\n      editor.on('compositionstart compositionend', function (e) {\n        editor.composing = e.type === 'compositionstart';\n      });\n      if (editor.contentStyles.length > 0) {\n        contentCssText = '';\n        Tools.each(editor.contentStyles, function (style) {\n          contentCssText += style + '\\r\\n';\n        });\n        editor.dom.addStyle(contentCssText);\n      }\n      getStyleSheetLoader(editor).loadAll(editor.contentCSS, function (_) {\n        initEditor(editor);\n      }, function (urls) {\n        initEditor(editor);\n      });\n      if (settings.content_style) {\n        appendStyle(editor, settings.content_style);\n      }\n    };\n    var InitContentBody = { initContentBody: initContentBody };\n\n    var DOM$5 = DOMUtils$1.DOM;\n    var relaxDomain = function (editor, ifr) {\n      if (domGlobals.document.domain !== domGlobals.window.location.hostname && Env.browser.isIE()) {\n        var bodyUuid = Uuid.uuid('mce');\n        editor[bodyUuid] = function () {\n          InitContentBody.initContentBody(editor);\n        };\n        var domainRelaxUrl = 'javascript:(function(){' + 'document.open();document.domain=\"' + domGlobals.document.domain + '\";' + 'var ed = window.parent.tinymce.get(\"' + editor.id + '\");document.write(ed.iframeHTML);' + 'document.close();ed.' + bodyUuid + '(true);})()';\n        DOM$5.setAttrib(ifr, 'src', domainRelaxUrl);\n        return true;\n      }\n      return false;\n    };\n    var createIframeElement = function (id, title, height, customAttrs) {\n      var iframe = Element.fromTag('iframe');\n      setAll(iframe, customAttrs);\n      setAll(iframe, {\n        id: id + '_ifr',\n        frameBorder: '0',\n        allowTransparency: 'true',\n        title: title\n      });\n      add$3(iframe, 'tox-edit-area__iframe');\n      return iframe;\n    };\n    var getIframeHtml = function (editor) {\n      var bodyId, bodyClass, iframeHTML;\n      iframeHTML = Settings.getDocType(editor) + '<html><head>';\n      if (Settings.getDocumentBaseUrl(editor) !== editor.documentBaseUrl) {\n        iframeHTML += '<base href=\"' + editor.documentBaseURI.getURI() + '\" />';\n      }\n      iframeHTML += '<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />';\n      bodyId = Settings.getBodyId(editor);\n      bodyClass = Settings.getBodyClass(editor);\n      if (Settings.getContentSecurityPolicy(editor)) {\n        iframeHTML += '<meta http-equiv=\"Content-Security-Policy\" content=\"' + Settings.getContentSecurityPolicy(editor) + '\" />';\n      }\n      iframeHTML += '</head><body id=\"' + bodyId + '\" class=\"mce-content-body ' + bodyClass + '\" data-id=\"' + editor.id + '\"><br></body></html>';\n      return iframeHTML;\n    };\n    var createIframe = function (editor, o) {\n      var title = editor.editorManager.translate('Rich Text Area. Press ALT-0 for help.');\n      var ifr = createIframeElement(editor.id, title, o.height, Settings.getIframeAttrs(editor)).dom();\n      ifr.onload = function () {\n        ifr.onload = null;\n        editor.fire('load');\n      };\n      var isDomainRelaxed = relaxDomain(editor, ifr);\n      editor.contentAreaContainer = o.iframeContainer;\n      editor.iframeElement = ifr;\n      editor.iframeHTML = getIframeHtml(editor);\n      DOM$5.add(o.iframeContainer, ifr);\n      return isDomainRelaxed;\n    };\n    var init$1 = function (editor, boxInfo) {\n      var isDomainRelaxed = createIframe(editor, boxInfo);\n      if (boxInfo.editorContainer) {\n        DOM$5.get(boxInfo.editorContainer).style.display = editor.orgDisplay;\n        editor.hidden = DOM$5.isHidden(boxInfo.editorContainer);\n      }\n      editor.getElement().style.display = 'none';\n      DOM$5.setAttrib(editor.id, 'aria-hidden', 'true');\n      if (!isDomainRelaxed) {\n        InitContentBody.initContentBody(editor);\n      }\n    };\n    var InitIframe = { init: init$1 };\n\n    var DOM$6 = DOMUtils$1.DOM;\n    var initPlugin = function (editor, initializedPlugins, plugin) {\n      var Plugin = PluginManager.get(plugin);\n      var pluginUrl = PluginManager.urls[plugin] || editor.documentBaseUrl.replace(/\\/$/, '');\n      plugin = Tools.trim(plugin);\n      if (Plugin && Tools.inArray(initializedPlugins, plugin) === -1) {\n        Tools.each(PluginManager.dependencies(plugin), function (dep) {\n          initPlugin(editor, initializedPlugins, dep);\n        });\n        if (editor.plugins[plugin]) {\n          return;\n        }\n        try {\n          var pluginInstance = new Plugin(editor, pluginUrl, editor.$);\n          editor.plugins[plugin] = pluginInstance;\n          if (pluginInstance.init) {\n            pluginInstance.init(editor, pluginUrl);\n            initializedPlugins.push(plugin);\n          }\n        } catch (e) {\n          ErrorReporter.pluginInitError(editor, plugin, e);\n        }\n      }\n    };\n    var trimLegacyPrefix = function (name) {\n      return name.replace(/^\\-/, '');\n    };\n    var initPlugins = function (editor) {\n      var initializedPlugins = [];\n      Tools.each(editor.settings.plugins.split(/[ ,]/), function (name) {\n        initPlugin(editor, initializedPlugins, trimLegacyPrefix(name));\n      });\n    };\n    var initIcons = function (editor) {\n      var iconPackName = Tools.trim(editor.settings.icons);\n      var currentIcons = editor.ui.registry.getAll().icons;\n      var defaultIcons = getAll();\n      var loadIcons = __assign(__assign({}, defaultIcons), IconManager.get(iconPackName).icons);\n      each$1(loadIcons, function (svgData, icon) {\n        if (!has(currentIcons, icon)) {\n          editor.ui.registry.addIcon(icon, svgData);\n        }\n      });\n    };\n    var initTheme = function (editor) {\n      var theme = editor.settings.theme;\n      if (isString(theme)) {\n        editor.settings.theme = trimLegacyPrefix(theme);\n        var Theme = ThemeManager.get(theme);\n        editor.theme = new Theme(editor, ThemeManager.urls[theme]);\n        if (editor.theme.init) {\n          editor.theme.init(editor, ThemeManager.urls[theme] || editor.documentBaseUrl.replace(/\\/$/, ''), editor.$);\n        }\n      } else {\n        editor.theme = {};\n      }\n    };\n    var renderFromLoadedTheme = function (editor) {\n      return editor.theme.renderUI();\n    };\n    var renderFromThemeFunc = function (editor) {\n      var elm = editor.getElement();\n      var theme = editor.settings.theme;\n      var info = theme(editor, elm);\n      if (info.editorContainer.nodeType) {\n        info.editorContainer.id = info.editorContainer.id || editor.id + '_parent';\n      }\n      if (info.iframeContainer && info.iframeContainer.nodeType) {\n        info.iframeContainer.id = info.iframeContainer.id || editor.id + '_iframecontainer';\n      }\n      info.height = info.iframeHeight ? info.iframeHeight : elm.offsetHeight;\n      return info;\n    };\n    var createThemeFalseResult = function (element) {\n      return {\n        editorContainer: element,\n        iframeContainer: element\n      };\n    };\n    var renderThemeFalseIframe = function (targetElement) {\n      var iframeContainer = DOM$6.create('div');\n      DOM$6.insertAfter(iframeContainer, targetElement);\n      return createThemeFalseResult(iframeContainer);\n    };\n    var renderThemeFalse = function (editor) {\n      var targetElement = editor.getElement();\n      return editor.inline ? createThemeFalseResult(null) : renderThemeFalseIframe(targetElement);\n    };\n    var renderThemeUi = function (editor) {\n      var elm = editor.getElement();\n      editor.orgDisplay = elm.style.display;\n      if (isString(editor.settings.theme)) {\n        return renderFromLoadedTheme(editor);\n      } else if (isFunction(editor.settings.theme)) {\n        return renderFromThemeFunc(editor);\n      } else {\n        return renderThemeFalse(editor);\n      }\n    };\n    var init$2 = function (editor) {\n      editor.fire('ScriptsLoaded');\n      initIcons(editor);\n      initTheme(editor);\n      initPlugins(editor);\n      var boxInfo = renderThemeUi(editor);\n      editor.editorContainer = boxInfo.editorContainer ? boxInfo.editorContainer : null;\n      appendContentCssFromSettings(editor);\n      if (editor.inline) {\n        return InitContentBody.initContentBody(editor);\n      } else {\n        return InitIframe.init(editor, boxInfo);\n      }\n    };\n    var Init = { init: init$2 };\n\n    var DOM$7 = DOMUtils$1.DOM;\n    var hasSkipLoadPrefix = function (name) {\n      return name.charAt(0) === '-';\n    };\n    var loadLanguage = function (scriptLoader, editor) {\n      var languageCode = Settings.getLanguageCode(editor);\n      var languageUrl = Settings.getLanguageUrl(editor);\n      if (I18n.hasCode(languageCode) === false && languageCode !== 'en') {\n        var url_1 = languageUrl !== '' ? languageUrl : editor.editorManager.baseURL + '/langs/' + languageCode + '.js';\n        scriptLoader.add(url_1, noop, undefined, function () {\n          ErrorReporter.languageLoadError(editor, url_1, languageCode);\n        });\n      }\n    };\n    var loadTheme = function (scriptLoader, editor, suffix, callback) {\n      var settings = editor.settings, theme = settings.theme;\n      if (isString(theme)) {\n        if (!hasSkipLoadPrefix(theme) && !ThemeManager.urls.hasOwnProperty(theme)) {\n          var themeUrl = settings.theme_url;\n          if (themeUrl) {\n            ThemeManager.load(theme, editor.documentBaseURI.toAbsolute(themeUrl));\n          } else {\n            ThemeManager.load(theme, 'themes/' + theme + '/theme' + suffix + '.js');\n          }\n        }\n        scriptLoader.loadQueue(function () {\n          ThemeManager.waitFor(theme, callback);\n        });\n      } else {\n        callback();\n      }\n    };\n    var getIconsUrlMetaFromUrl = function (editor) {\n      return Option.from(Settings.getIconsUrl(editor)).filter(function (url) {\n        return url.length > 0;\n      }).map(function (url) {\n        return {\n          url: url,\n          name: Option.none()\n        };\n      });\n    };\n    var getIconsUrlMetaFromName = function (editor) {\n      return Option.from(Settings.getIconPackName(editor)).filter(function (name) {\n        return name.length > 0 && !IconManager.has(name);\n      }).map(function (name) {\n        return {\n          url: editor.editorManager.baseURL + '/icons/' + name + '/icons.js',\n          name: Option.some(name)\n        };\n      });\n    };\n    var loadIcons = function (scriptLoader, editor) {\n      getIconsUrlMetaFromUrl(editor).orThunk(function () {\n        return getIconsUrlMetaFromName(editor);\n      }).each(function (urlMeta) {\n        scriptLoader.add(urlMeta.url, noop, undefined, function () {\n          ErrorReporter.iconsLoadError(editor, urlMeta.url, urlMeta.name.getOrUndefined());\n        });\n      });\n    };\n    var loadPlugins = function (editor, settings, suffix) {\n      if (isArray(settings.plugins)) {\n        settings.plugins = settings.plugins.join(' ');\n      }\n      Tools.each(settings.external_plugins, function (url, name) {\n        PluginManager.load(name, url, noop, undefined, function () {\n          ErrorReporter.pluginLoadError(editor, url, name);\n        });\n        settings.plugins += ' ' + name;\n      });\n      Tools.each(settings.plugins.split(/[ ,]/), function (plugin) {\n        plugin = Tools.trim(plugin);\n        if (plugin && !PluginManager.urls[plugin]) {\n          if (hasSkipLoadPrefix(plugin)) {\n            plugin = plugin.substr(1, plugin.length);\n            var dependencies = PluginManager.dependencies(plugin);\n            Tools.each(dependencies, function (depPlugin) {\n              var defaultSettings = {\n                prefix: 'plugins/',\n                resource: depPlugin,\n                suffix: '/plugin' + suffix + '.js'\n              };\n              var dep = PluginManager.createUrl(defaultSettings, depPlugin);\n              PluginManager.load(dep.resource, dep, noop, undefined, function () {\n                ErrorReporter.pluginLoadError(editor, dep.prefix + dep.resource + dep.suffix, dep.resource);\n              });\n            });\n          } else {\n            var url_2 = {\n              prefix: 'plugins/',\n              resource: plugin,\n              suffix: '/plugin' + suffix + '.js'\n            };\n            PluginManager.load(plugin, url_2, noop, undefined, function () {\n              ErrorReporter.pluginLoadError(editor, url_2.prefix + url_2.resource + url_2.suffix, plugin);\n            });\n          }\n        }\n      });\n    };\n    var loadScripts = function (editor, suffix) {\n      var scriptLoader = ScriptLoader.ScriptLoader;\n      loadTheme(scriptLoader, editor, suffix, function () {\n        loadLanguage(scriptLoader, editor);\n        loadIcons(scriptLoader, editor);\n        loadPlugins(editor, editor.settings, suffix);\n        scriptLoader.loadQueue(function () {\n          if (!editor.removed) {\n            Init.init(editor);\n          }\n        }, editor, function () {\n          if (!editor.removed) {\n            Init.init(editor);\n          }\n        });\n      });\n    };\n    var render = function (editor) {\n      var settings = editor.settings, id = editor.id;\n      I18n.setCode(Settings.getLanguageCode(editor));\n      var readyHandler = function () {\n        DOM$7.unbind(domGlobals.window, 'ready', readyHandler);\n        editor.render();\n      };\n      if (!EventUtils.Event.domLoaded) {\n        DOM$7.bind(domGlobals.window, 'ready', readyHandler);\n        return;\n      }\n      if (!editor.getElement()) {\n        return;\n      }\n      if (!Env.contentEditable) {\n        return;\n      }\n      if (!settings.inline) {\n        editor.orgVisibility = editor.getElement().style.visibility;\n        editor.getElement().style.visibility = 'hidden';\n      } else {\n        editor.inline = true;\n      }\n      var form = editor.getElement().form || DOM$7.getParent(id, 'form');\n      if (form) {\n        editor.formElement = form;\n        if (settings.hidden_input && !NodeType.isTextareaOrInput(editor.getElement())) {\n          DOM$7.insertAfter(DOM$7.create('input', {\n            type: 'hidden',\n            name: id\n          }), id);\n          editor.hasHiddenInput = true;\n        }\n        editor.formEventDelegate = function (e) {\n          editor.fire(e.type, e);\n        };\n        DOM$7.bind(form, 'submit reset', editor.formEventDelegate);\n        editor.on('reset', function () {\n          editor.resetContent();\n        });\n        if (settings.submit_patch && !form.submit.nodeType && !form.submit.length && !form._mceOldSubmit) {\n          form._mceOldSubmit = form.submit;\n          form.submit = function () {\n            editor.editorManager.triggerSave();\n            editor.setDirty(false);\n            return form._mceOldSubmit(form);\n          };\n        }\n      }\n      editor.windowManager = WindowManager(editor);\n      editor.notificationManager = NotificationManager(editor);\n      if (settings.encoding === 'xml') {\n        editor.on('GetContent', function (e) {\n          if (e.save) {\n            e.content = DOM$7.encode(e.content);\n          }\n        });\n      }\n      if (settings.add_form_submit_trigger) {\n        editor.on('submit', function () {\n          if (editor.initialized) {\n            editor.save();\n          }\n        });\n      }\n      if (settings.add_unload_trigger) {\n        editor._beforeUnload = function () {\n          if (editor.initialized && !editor.destroyed && !editor.isHidden()) {\n            editor.save({\n              format: 'raw',\n              no_events: true,\n              set_dirty: false\n            });\n          }\n        };\n        editor.editorManager.on('BeforeUnload', editor._beforeUnload);\n      }\n      editor.editorManager.add(editor);\n      loadScripts(editor, editor.suffix);\n    };\n    var Render = { render: render };\n\n    var hasOnlyOneChild$1 = function (node) {\n      return node.firstChild && node.firstChild === node.lastChild;\n    };\n    var isPaddingNode = function (node) {\n      return node.name === 'br' || node.value === nbsp;\n    };\n    var isPaddedEmptyBlock = function (schema, node) {\n      var blockElements = schema.getBlockElements();\n      return blockElements[node.name] && hasOnlyOneChild$1(node) && isPaddingNode(node.firstChild);\n    };\n    var isEmptyFragmentElement = function (schema, node) {\n      var nonEmptyElements = schema.getNonEmptyElements();\n      return node && (node.isEmpty(nonEmptyElements) || isPaddedEmptyBlock(schema, node));\n    };\n    var isListFragment = function (schema, fragment) {\n      var firstChild = fragment.firstChild;\n      var lastChild = fragment.lastChild;\n      if (firstChild && firstChild.name === 'meta') {\n        firstChild = firstChild.next;\n      }\n      if (lastChild && lastChild.attr('id') === 'mce_marker') {\n        lastChild = lastChild.prev;\n      }\n      if (isEmptyFragmentElement(schema, lastChild)) {\n        lastChild = lastChild.prev;\n      }\n      if (!firstChild || firstChild !== lastChild) {\n        return false;\n      }\n      return firstChild.name === 'ul' || firstChild.name === 'ol';\n    };\n    var cleanupDomFragment = function (domFragment) {\n      var firstChild = domFragment.firstChild;\n      var lastChild = domFragment.lastChild;\n      if (firstChild && firstChild.nodeName === 'META') {\n        firstChild.parentNode.removeChild(firstChild);\n      }\n      if (lastChild && lastChild.id === 'mce_marker') {\n        lastChild.parentNode.removeChild(lastChild);\n      }\n      return domFragment;\n    };\n    var toDomFragment = function (dom, serializer, fragment) {\n      var html = serializer.serialize(fragment);\n      var domFragment = dom.createFragment(html);\n      return cleanupDomFragment(domFragment);\n    };\n    var listItems$1 = function (elm) {\n      return Tools.grep(elm.childNodes, function (child) {\n        return child.nodeName === 'LI';\n      });\n    };\n    var isPadding = function (node) {\n      return node.data === nbsp || NodeType.isBr(node);\n    };\n    var isListItemPadded = function (node) {\n      return node && node.firstChild && node.firstChild === node.lastChild && isPadding(node.firstChild);\n    };\n    var isEmptyOrPadded = function (elm) {\n      return !elm.firstChild || isListItemPadded(elm);\n    };\n    var trimListItems = function (elms) {\n      return elms.length > 0 && isEmptyOrPadded(elms[elms.length - 1]) ? elms.slice(0, -1) : elms;\n    };\n    var getParentLi = function (dom, node) {\n      var parentBlock = dom.getParent(node, dom.isBlock);\n      return parentBlock && parentBlock.nodeName === 'LI' ? parentBlock : null;\n    };\n    var isParentBlockLi = function (dom, node) {\n      return !!getParentLi(dom, node);\n    };\n    var getSplit = function (parentNode, rng) {\n      var beforeRng = rng.cloneRange();\n      var afterRng = rng.cloneRange();\n      beforeRng.setStartBefore(parentNode);\n      afterRng.setEndAfter(parentNode);\n      return [\n        beforeRng.cloneContents(),\n        afterRng.cloneContents()\n      ];\n    };\n    var findFirstIn = function (node, rootNode) {\n      var caretPos = CaretPosition$1.before(node);\n      var caretWalker = CaretWalker(rootNode);\n      var newCaretPos = caretWalker.next(caretPos);\n      return newCaretPos ? newCaretPos.toRange() : null;\n    };\n    var findLastOf = function (node, rootNode) {\n      var caretPos = CaretPosition$1.after(node);\n      var caretWalker = CaretWalker(rootNode);\n      var newCaretPos = caretWalker.prev(caretPos);\n      return newCaretPos ? newCaretPos.toRange() : null;\n    };\n    var insertMiddle = function (target, elms, rootNode, rng) {\n      var parts = getSplit(target, rng);\n      var parentElm = target.parentNode;\n      parentElm.insertBefore(parts[0], target);\n      Tools.each(elms, function (li) {\n        parentElm.insertBefore(li, target);\n      });\n      parentElm.insertBefore(parts[1], target);\n      parentElm.removeChild(target);\n      return findLastOf(elms[elms.length - 1], rootNode);\n    };\n    var insertBefore$1 = function (target, elms, rootNode) {\n      var parentElm = target.parentNode;\n      Tools.each(elms, function (elm) {\n        parentElm.insertBefore(elm, target);\n      });\n      return findFirstIn(target, rootNode);\n    };\n    var insertAfter$1 = function (target, elms, rootNode, dom) {\n      dom.insertAfter(elms.reverse(), target);\n      return findLastOf(elms[0], rootNode);\n    };\n    var insertAtCaret = function (serializer, dom, rng, fragment) {\n      var domFragment = toDomFragment(dom, serializer, fragment);\n      var liTarget = getParentLi(dom, rng.startContainer);\n      var liElms = trimListItems(listItems$1(domFragment.firstChild));\n      var BEGINNING = 1, END = 2;\n      var rootNode = dom.getRoot();\n      var isAt = function (location) {\n        var caretPos = CaretPosition$1.fromRangeStart(rng);\n        var caretWalker = CaretWalker(dom.getRoot());\n        var newPos = location === BEGINNING ? caretWalker.prev(caretPos) : caretWalker.next(caretPos);\n        return newPos ? getParentLi(dom, newPos.getNode()) !== liTarget : true;\n      };\n      if (isAt(BEGINNING)) {\n        return insertBefore$1(liTarget, liElms, rootNode);\n      } else if (isAt(END)) {\n        return insertAfter$1(liTarget, liElms, rootNode, dom);\n      }\n      return insertMiddle(liTarget, liElms, rootNode, rng);\n    };\n    var InsertList = {\n      isListFragment: isListFragment,\n      insertAtCaret: insertAtCaret,\n      isParentBlockLi: isParentBlockLi,\n      trimListItems: trimListItems,\n      listItems: listItems$1\n    };\n\n    var isAfterNbsp = function (container, offset) {\n      return NodeType.isText(container) && container.nodeValue[offset - 1] === nbsp;\n    };\n    var trimOrPadLeftRight = function (rng, html) {\n      var container, offset;\n      container = rng.startContainer;\n      offset = rng.startOffset;\n      var hasSiblingText = function (siblingName) {\n        return container[siblingName] && container[siblingName].nodeType === 3;\n      };\n      if (container.nodeType === 3) {\n        if (offset > 0) {\n          html = html.replace(/^&nbsp;/, ' ');\n        } else if (!hasSiblingText('previousSibling')) {\n          html = html.replace(/^ /, '&nbsp;');\n        }\n        if (offset < container.length) {\n          html = html.replace(/&nbsp;(<br>|)$/, ' ');\n        } else if (!hasSiblingText('nextSibling')) {\n          html = html.replace(/(&nbsp;| )(<br>|)$/, '&nbsp;');\n        }\n      }\n      return html;\n    };\n    var trimNbspAfterDeleteAndPadValue = function (rng, value) {\n      var container, offset;\n      container = rng.startContainer;\n      offset = rng.startOffset;\n      if (container.nodeType === 3 && rng.collapsed) {\n        if (container.data[offset] === nbsp) {\n          container.deleteData(offset, 1);\n          if (!/[\\u00a0| ]$/.test(value)) {\n            value += ' ';\n          }\n        } else if (container.data[offset - 1] === nbsp) {\n          container.deleteData(offset - 1, 1);\n          if (!/[\\u00a0| ]$/.test(value)) {\n            value = ' ' + value;\n          }\n        }\n      }\n      return value;\n    };\n\n    var isTableCell$5 = NodeType.matchNodeNames([\n      'td',\n      'th'\n    ]);\n    var selectionSetContent = function (editor, content) {\n      var rng = editor.selection.getRng();\n      var container = rng.startContainer;\n      var offset = rng.startOffset;\n      if (rng.collapsed && isAfterNbsp(container, offset) && NodeType.isText(container)) {\n        container.insertData(offset - 1, ' ');\n        container.deleteData(offset, 1);\n        rng.setStart(container, offset);\n        rng.setEnd(container, offset);\n        editor.selection.setRng(rng);\n      }\n      editor.selection.setContent(content);\n    };\n    var validInsertion = function (editor, value, parentNode) {\n      if (parentNode.getAttribute('data-mce-bogus') === 'all') {\n        parentNode.parentNode.insertBefore(editor.dom.createFragment(value), parentNode);\n      } else {\n        var node = parentNode.firstChild;\n        var node2 = parentNode.lastChild;\n        if (!node || node === node2 && node.nodeName === 'BR') {\n          editor.dom.setHTML(parentNode, value);\n        } else {\n          selectionSetContent(editor, value);\n        }\n      }\n    };\n    var trimBrsFromTableCell = function (dom, elm) {\n      Option.from(dom.getParent(elm, 'td,th')).map(Element.fromDom).each(PaddingBr.trimBlockTrailingBr);\n    };\n    var reduceInlineTextElements = function (editor, merge) {\n      var textInlineElements = editor.schema.getTextInlineElements();\n      var dom = editor.dom;\n      if (merge) {\n        var root_1 = editor.getBody(), elementUtils_1 = new ElementUtils(dom);\n        Tools.each(dom.select('*[data-mce-fragment]'), function (node) {\n          for (var testNode = node.parentNode; testNode && testNode !== root_1; testNode = testNode.parentNode) {\n            if (textInlineElements[node.nodeName.toLowerCase()] && elementUtils_1.compare(testNode, node)) {\n              dom.remove(node, true);\n            }\n          }\n        });\n      }\n    };\n    var markFragmentElements = function (fragment) {\n      var node = fragment;\n      while (node = node.walk()) {\n        if (node.type === 1) {\n          node.attr('data-mce-fragment', '1');\n        }\n      }\n    };\n    var umarkFragmentElements = function (elm) {\n      Tools.each(elm.getElementsByTagName('*'), function (elm) {\n        elm.removeAttribute('data-mce-fragment');\n      });\n    };\n    var isPartOfFragment = function (node) {\n      return !!node.getAttribute('data-mce-fragment');\n    };\n    var canHaveChildren = function (editor, node) {\n      return node && !editor.schema.getShortEndedElements()[node.nodeName];\n    };\n    var moveSelectionToMarker = function (editor, marker) {\n      var parentEditableFalseElm, parentBlock, nextRng;\n      var dom = editor.dom, selection = editor.selection;\n      var node, node2;\n      var getContentEditableFalseParent = function (node) {\n        var root = editor.getBody();\n        for (; node && node !== root; node = node.parentNode) {\n          if (editor.dom.getContentEditable(node) === 'false') {\n            return node;\n          }\n        }\n        return null;\n      };\n      if (!marker) {\n        return;\n      }\n      editor.selection.scrollIntoView(marker);\n      parentEditableFalseElm = getContentEditableFalseParent(marker);\n      if (parentEditableFalseElm) {\n        dom.remove(marker);\n        selection.select(parentEditableFalseElm);\n        return;\n      }\n      var rng = dom.createRng();\n      node = marker.previousSibling;\n      if (node && node.nodeType === 3) {\n        rng.setStart(node, node.nodeValue.length);\n        if (!Env.ie) {\n          node2 = marker.nextSibling;\n          if (node2 && node2.nodeType === 3) {\n            node.appendData(node2.data);\n            node2.parentNode.removeChild(node2);\n          }\n        }\n      } else {\n        rng.setStartBefore(marker);\n        rng.setEndBefore(marker);\n      }\n      var findNextCaretRng = function (rng) {\n        var caretPos = CaretPosition$1.fromRangeStart(rng);\n        var caretWalker = CaretWalker(editor.getBody());\n        caretPos = caretWalker.next(caretPos);\n        if (caretPos) {\n          return caretPos.toRange();\n        }\n      };\n      parentBlock = dom.getParent(marker, dom.isBlock);\n      dom.remove(marker);\n      if (parentBlock && dom.isEmpty(parentBlock)) {\n        editor.$(parentBlock).empty();\n        rng.setStart(parentBlock, 0);\n        rng.setEnd(parentBlock, 0);\n        if (!isTableCell$5(parentBlock) && !isPartOfFragment(parentBlock) && (nextRng = findNextCaretRng(rng))) {\n          rng = nextRng;\n          dom.remove(parentBlock);\n        } else {\n          dom.add(parentBlock, dom.create('br', { 'data-mce-bogus': '1' }));\n        }\n      }\n      selection.setRng(rng);\n    };\n    var insertHtmlAtCaret = function (editor, value, details) {\n      var parser, serializer, parentNode, rootNode, fragment, args;\n      var marker, rng, node, bookmarkHtml, merge;\n      var selection = editor.selection, dom = editor.dom;\n      if (/^ | $/.test(value)) {\n        value = trimOrPadLeftRight(selection.getRng(), value);\n      }\n      parser = editor.parser;\n      merge = details.merge;\n      serializer = Serializer({ validate: editor.settings.validate }, editor.schema);\n      bookmarkHtml = '<span id=\"mce_marker\" data-mce-type=\"bookmark\">&#xFEFF;&#x200B;</span>';\n      args = {\n        content: value,\n        format: 'html',\n        selection: true,\n        paste: details.paste\n      };\n      args = editor.fire('BeforeSetContent', args);\n      if (args.isDefaultPrevented()) {\n        editor.fire('SetContent', {\n          content: args.content,\n          format: 'html',\n          selection: true,\n          paste: details.paste\n        });\n        return;\n      }\n      value = args.content;\n      if (value.indexOf('{$caret}') === -1) {\n        value += '{$caret}';\n      }\n      value = value.replace(/\\{\\$caret\\}/, bookmarkHtml);\n      rng = selection.getRng();\n      var caretElement = rng.startContainer || (rng.parentElement ? rng.parentElement() : null);\n      var body = editor.getBody();\n      if (caretElement === body && selection.isCollapsed()) {\n        if (dom.isBlock(body.firstChild) && canHaveChildren(editor, body.firstChild) && dom.isEmpty(body.firstChild)) {\n          rng = dom.createRng();\n          rng.setStart(body.firstChild, 0);\n          rng.setEnd(body.firstChild, 0);\n          selection.setRng(rng);\n        }\n      }\n      if (!selection.isCollapsed()) {\n        editor.selection.setRng(RangeNormalizer.normalize(editor.selection.getRng()));\n        editor.getDoc().execCommand('Delete', false, null);\n        value = trimNbspAfterDeleteAndPadValue(editor.selection.getRng(), value);\n      }\n      parentNode = selection.getNode();\n      var parserArgs = {\n        context: parentNode.nodeName.toLowerCase(),\n        data: details.data,\n        insert: true\n      };\n      fragment = parser.parse(value, parserArgs);\n      if (details.paste === true && InsertList.isListFragment(editor.schema, fragment) && InsertList.isParentBlockLi(dom, parentNode)) {\n        rng = InsertList.insertAtCaret(serializer, dom, editor.selection.getRng(), fragment);\n        editor.selection.setRng(rng);\n        editor.fire('SetContent', args);\n        return;\n      }\n      markFragmentElements(fragment);\n      node = fragment.lastChild;\n      if (node.attr('id') === 'mce_marker') {\n        marker = node;\n        for (node = node.prev; node; node = node.walk(true)) {\n          if (node.type === 3 || !dom.isBlock(node.name)) {\n            if (editor.schema.isValidChild(node.parent.name, 'span')) {\n              node.parent.insert(marker, node, node.name === 'br');\n            }\n            break;\n          }\n        }\n      }\n      editor._selectionOverrides.showBlockCaretContainer(parentNode);\n      if (!parserArgs.invalid) {\n        value = serializer.serialize(fragment);\n        validInsertion(editor, value, parentNode);\n      } else {\n        selectionSetContent(editor, bookmarkHtml);\n        parentNode = selection.getNode();\n        rootNode = editor.getBody();\n        if (parentNode.nodeType === 9) {\n          parentNode = node = rootNode;\n        } else {\n          node = parentNode;\n        }\n        while (node !== rootNode) {\n          parentNode = node;\n          node = node.parentNode;\n        }\n        value = parentNode === rootNode ? rootNode.innerHTML : dom.getOuterHTML(parentNode);\n        value = serializer.serialize(parser.parse(value.replace(/<span (id=\"mce_marker\"|id=mce_marker).+?<\\/span>/i, function () {\n          return serializer.serialize(fragment);\n        })));\n        if (parentNode === rootNode) {\n          dom.setHTML(rootNode, value);\n        } else {\n          dom.setOuterHTML(parentNode, value);\n        }\n      }\n      reduceInlineTextElements(editor, merge);\n      moveSelectionToMarker(editor, dom.get('mce_marker'));\n      umarkFragmentElements(editor.getBody());\n      trimBrsFromTableCell(editor.dom, editor.selection.getStart());\n      editor.fire('SetContent', args);\n      editor.addVisual();\n    };\n    var processValue = function (value) {\n      var details;\n      if (typeof value !== 'string') {\n        details = Tools.extend({\n          paste: value.paste,\n          data: { paste: value.paste }\n        }, value);\n        return {\n          content: value.content,\n          details: details\n        };\n      }\n      return {\n        content: value,\n        details: {}\n      };\n    };\n    var insertAtCaret$1 = function (editor, value) {\n      var result = processValue(value);\n      insertHtmlAtCaret(editor, result.content, result.details);\n    };\n    var InsertContent = { insertAtCaret: insertAtCaret$1 };\n\n    var nativeCommand = function (editor, command) {\n      editor.getDoc().execCommand(command, false, null);\n    };\n    var deleteCommand = function (editor) {\n      if (Outdent.backspaceDelete(editor, false)) {\n        return;\n      } else if (CefDelete.backspaceDelete(editor, false)) {\n        return;\n      } else if (CefBoundaryDelete.backspaceDelete(editor, false)) {\n        return;\n      } else if (BoundaryDelete.backspaceDelete(editor, false)) {\n        return;\n      } else if (BlockBoundaryDelete.backspaceDelete(editor, false)) {\n        return;\n      } else if (TableDelete.backspaceDelete(editor)) {\n        return;\n      } else if (BlockRangeDelete.backspaceDelete(editor, false)) {\n        return;\n      } else if (InlineFormatDelete.backspaceDelete(editor, false)) {\n        return;\n      } else {\n        nativeCommand(editor, 'Delete');\n        DeleteUtils.paddEmptyBody(editor);\n      }\n    };\n    var forwardDeleteCommand = function (editor) {\n      if (CefDelete.backspaceDelete(editor, true)) {\n        return;\n      } else if (CefBoundaryDelete.backspaceDelete(editor, true)) {\n        return;\n      } else if (BoundaryDelete.backspaceDelete(editor, true)) {\n        return;\n      } else if (BlockBoundaryDelete.backspaceDelete(editor, true)) {\n        return;\n      } else if (TableDelete.backspaceDelete(editor)) {\n        return;\n      } else if (BlockRangeDelete.backspaceDelete(editor, true)) {\n        return;\n      } else if (InlineFormatDelete.backspaceDelete(editor, true)) {\n        return;\n      } else {\n        nativeCommand(editor, 'ForwardDelete');\n      }\n    };\n    var DeleteCommands = {\n      deleteCommand: deleteCommand,\n      forwardDeleteCommand: forwardDeleteCommand\n    };\n\n    var ancestor$3 = function (scope, transform, isRoot) {\n      var element = scope.dom();\n      var stop = isFunction(isRoot) ? isRoot : constant(false);\n      while (element.parentNode) {\n        element = element.parentNode;\n        var el = Element.fromDom(element);\n        var transformed = transform(el);\n        if (transformed.isSome()) {\n          return transformed;\n        } else if (stop(el)) {\n          break;\n        }\n      }\n      return Option.none();\n    };\n    var closest$2 = function (scope, transform, isRoot) {\n      var current = transform(scope);\n      return current.orThunk(function () {\n        return isRoot(scope) ? Option.none() : ancestor$3(scope, transform, isRoot);\n      });\n    };\n\n    var legacyPropNames = {\n      'font-size': 'size',\n      'font-family': 'face'\n    };\n    var getSpecifiedFontProp = function (propName, rootElm, elm) {\n      var getProperty = function (elm) {\n        return getRaw(elm, propName).orThunk(function () {\n          if (name(elm) === 'font') {\n            return get(legacyPropNames, propName).bind(function (legacyPropName) {\n              return getOpt(elm, legacyPropName);\n            });\n          } else {\n            return Option.none();\n          }\n        });\n      };\n      var isRoot = function (elm) {\n        return eq(Element.fromDom(rootElm), elm);\n      };\n      return closest$2(Element.fromDom(elm), function (elm) {\n        return getProperty(elm);\n      }, isRoot);\n    };\n    var round$1 = function (number, precision) {\n      var factor = Math.pow(10, precision);\n      return Math.round(number * factor) / factor;\n    };\n    var toPt = function (fontSize, precision) {\n      if (/[0-9.]+px$/.test(fontSize)) {\n        return round$1(parseInt(fontSize, 10) * 72 / 96, precision || 0) + 'pt';\n      }\n      return fontSize;\n    };\n    var normalizeFontFamily = function (fontFamily) {\n      return fontFamily.replace(/[\\'\\\"\\\\]/g, '').replace(/,\\s+/g, ',');\n    };\n    var getComputedFontProp = function (propName, elm) {\n      return Option.from(DOMUtils$1.DOM.getStyle(elm, propName, true));\n    };\n    var getFontProp = function (propName) {\n      return function (rootElm, elm) {\n        return Option.from(elm).map(Element.fromDom).filter(isElement).bind(function (element) {\n          return getSpecifiedFontProp(propName, rootElm, element.dom()).or(getComputedFontProp(propName, element.dom()));\n        }).getOr('');\n      };\n    };\n    var FontInfo = {\n      getFontSize: getFontProp('font-size'),\n      getFontFamily: compose(normalizeFontFamily, getFontProp('font-family')),\n      toPt: toPt\n    };\n\n    var findFirstCaretElement = function (editor) {\n      return CaretFinder.firstPositionIn(editor.getBody()).map(function (caret) {\n        var container = caret.container();\n        return NodeType.isText(container) ? container.parentNode : container;\n      });\n    };\n    var isRangeAtStartOfNode = function (rng, root) {\n      return rng.startContainer === root && rng.startOffset === 0;\n    };\n    var getCaretElement = function (editor) {\n      return Option.from(editor.selection.getRng()).bind(function (rng) {\n        var root = editor.getBody();\n        return isRangeAtStartOfNode(rng, root) ? Option.none() : Option.from(editor.selection.getStart(true));\n      });\n    };\n    var fromFontSizeNumber = function (editor, value) {\n      if (/^[0-9\\.]+$/.test(value)) {\n        var fontSizeNumber = parseInt(value, 10);\n        if (fontSizeNumber >= 1 && fontSizeNumber <= 7) {\n          var fontSizes = Settings.getFontStyleValues(editor);\n          var fontClasses = Settings.getFontSizeClasses(editor);\n          if (fontClasses) {\n            return fontClasses[fontSizeNumber - 1] || value;\n          } else {\n            return fontSizes[fontSizeNumber - 1] || value;\n          }\n        } else {\n          return value;\n        }\n      } else {\n        return value;\n      }\n    };\n    var normalizeFontNames = function (font) {\n      var fonts = font.split(/\\s*,\\s*/);\n      return map(fonts, function (font) {\n        if (font.indexOf(' ') !== -1 && !(startsWith(font, '\"') || startsWith(font, '\\''))) {\n          return '\\'' + font + '\\'';\n        } else {\n          return font;\n        }\n      }).join(',');\n    };\n    var fontNameAction = function (editor, value) {\n      var font = fromFontSizeNumber(editor, value);\n      editor.formatter.toggle('fontname', { value: normalizeFontNames(font) });\n      editor.nodeChanged();\n    };\n    var fontNameQuery = function (editor) {\n      return getCaretElement(editor).fold(function () {\n        return findFirstCaretElement(editor).map(function (caretElement) {\n          return FontInfo.getFontFamily(editor.getBody(), caretElement);\n        }).getOr('');\n      }, function (caretElement) {\n        return FontInfo.getFontFamily(editor.getBody(), caretElement);\n      });\n    };\n    var fontSizeAction = function (editor, value) {\n      editor.formatter.toggle('fontsize', { value: fromFontSizeNumber(editor, value) });\n      editor.nodeChanged();\n    };\n    var fontSizeQuery = function (editor) {\n      return getCaretElement(editor).fold(function () {\n        return findFirstCaretElement(editor).map(function (caretElement) {\n          return FontInfo.getFontSize(editor.getBody(), caretElement);\n        }).getOr('');\n      }, function (caretElement) {\n        return FontInfo.getFontSize(editor.getBody(), caretElement);\n      });\n    };\n\n    var each$f = Tools.each;\n    var map$3 = Tools.map, inArray$2 = Tools.inArray;\n    var EditorCommands = function () {\n      function EditorCommands(editor) {\n        this.commands = {\n          state: {},\n          exec: {},\n          value: {}\n        };\n        this.editor = editor;\n        this.setupCommands(editor);\n      }\n      EditorCommands.prototype.execCommand = function (command, ui, value, args) {\n        var func, customCommand, state = false;\n        var self = this;\n        if (self.editor.removed) {\n          return;\n        }\n        if (!/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(command) && (!args || !args.skip_focus)) {\n          self.editor.focus();\n        } else {\n          SelectionBookmark.restore(self.editor);\n        }\n        args = self.editor.fire('BeforeExecCommand', {\n          command: command,\n          ui: ui,\n          value: value\n        });\n        if (args.isDefaultPrevented()) {\n          return false;\n        }\n        customCommand = command.toLowerCase();\n        if (func = self.commands.exec[customCommand]) {\n          func(customCommand, ui, value);\n          self.editor.fire('ExecCommand', {\n            command: command,\n            ui: ui,\n            value: value\n          });\n          return true;\n        }\n        each$f(this.editor.plugins, function (p) {\n          if (p.execCommand && p.execCommand(command, ui, value)) {\n            self.editor.fire('ExecCommand', {\n              command: command,\n              ui: ui,\n              value: value\n            });\n            state = true;\n            return false;\n          }\n        });\n        if (state) {\n          return state;\n        }\n        if (self.editor.theme && self.editor.theme.execCommand && self.editor.theme.execCommand(command, ui, value)) {\n          self.editor.fire('ExecCommand', {\n            command: command,\n            ui: ui,\n            value: value\n          });\n          return true;\n        }\n        try {\n          state = self.editor.getDoc().execCommand(command, ui, value);\n        } catch (ex) {\n        }\n        if (state) {\n          self.editor.fire('ExecCommand', {\n            command: command,\n            ui: ui,\n            value: value\n          });\n          return true;\n        }\n        return false;\n      };\n      EditorCommands.prototype.queryCommandState = function (command) {\n        var func;\n        if (this.editor.quirks.isHidden() || this.editor.removed) {\n          return;\n        }\n        command = command.toLowerCase();\n        if (func = this.commands.state[command]) {\n          return func(command);\n        }\n        try {\n          return this.editor.getDoc().queryCommandState(command);\n        } catch (ex) {\n        }\n        return false;\n      };\n      EditorCommands.prototype.queryCommandValue = function (command) {\n        var func;\n        if (this.editor.quirks.isHidden() || this.editor.removed) {\n          return;\n        }\n        command = command.toLowerCase();\n        if (func = this.commands.value[command]) {\n          return func(command);\n        }\n        try {\n          return this.editor.getDoc().queryCommandValue(command);\n        } catch (ex) {\n        }\n      };\n      EditorCommands.prototype.addCommands = function (commandList, type) {\n        var self = this;\n        type = type || 'exec';\n        each$f(commandList, function (callback, command) {\n          each$f(command.toLowerCase().split(','), function (command) {\n            self.commands[type][command] = callback;\n          });\n        });\n      };\n      EditorCommands.prototype.addCommand = function (command, callback, scope) {\n        var _this = this;\n        command = command.toLowerCase();\n        this.commands.exec[command] = function (command, ui, value, args) {\n          return callback.call(scope || _this.editor, ui, value, args);\n        };\n      };\n      EditorCommands.prototype.queryCommandSupported = function (command) {\n        command = command.toLowerCase();\n        if (this.commands.exec[command]) {\n          return true;\n        }\n        try {\n          return this.editor.getDoc().queryCommandSupported(command);\n        } catch (ex) {\n        }\n        return false;\n      };\n      EditorCommands.prototype.addQueryStateHandler = function (command, callback, scope) {\n        var _this = this;\n        command = command.toLowerCase();\n        this.commands.state[command] = function () {\n          return callback.call(scope || _this.editor);\n        };\n      };\n      EditorCommands.prototype.addQueryValueHandler = function (command, callback, scope) {\n        var _this = this;\n        command = command.toLowerCase();\n        this.commands.value[command] = function () {\n          return callback.call(scope || _this.editor);\n        };\n      };\n      EditorCommands.prototype.hasCustomCommand = function (command) {\n        command = command.toLowerCase();\n        return !!this.commands.exec[command];\n      };\n      EditorCommands.prototype.execNativeCommand = function (command, ui, value) {\n        if (ui === undefined) {\n          ui = false;\n        }\n        if (value === undefined) {\n          value = null;\n        }\n        return this.editor.getDoc().execCommand(command, ui, value);\n      };\n      EditorCommands.prototype.isFormatMatch = function (name) {\n        return this.editor.formatter.match(name);\n      };\n      EditorCommands.prototype.toggleFormat = function (name, value) {\n        this.editor.formatter.toggle(name, value ? { value: value } : undefined);\n        this.editor.nodeChanged();\n      };\n      EditorCommands.prototype.storeSelection = function (type) {\n        this.selectionBookmark = this.editor.selection.getBookmark(type);\n      };\n      EditorCommands.prototype.restoreSelection = function () {\n        this.editor.selection.moveToBookmark(this.selectionBookmark);\n      };\n      EditorCommands.prototype.setupCommands = function (editor) {\n        var self = this;\n        this.addCommands({\n          'mceResetDesignMode,mceBeginUndoLevel': function () {\n          },\n          'mceEndUndoLevel,mceAddUndoLevel': function () {\n            editor.undoManager.add();\n          },\n          'Cut,Copy,Paste': function (command) {\n            var doc = editor.getDoc();\n            var failed;\n            try {\n              self.execNativeCommand(command);\n            } catch (ex) {\n              failed = true;\n            }\n            if (command === 'paste' && !doc.queryCommandEnabled(command)) {\n              failed = true;\n            }\n            if (failed || !doc.queryCommandSupported(command)) {\n              var msg = editor.translate('Your browser doesn\\'t support direct access to the clipboard. ' + 'Please use the Ctrl+X/C/V keyboard shortcuts instead.');\n              if (Env.mac) {\n                msg = msg.replace(/Ctrl\\+/g, '\\u2318+');\n              }\n              editor.notificationManager.open({\n                text: msg,\n                type: 'error'\n              });\n            }\n          },\n          'unlink': function () {\n            if (editor.selection.isCollapsed()) {\n              var elm = editor.dom.getParent(editor.selection.getStart(), 'a');\n              if (elm) {\n                editor.dom.remove(elm, true);\n              }\n              return;\n            }\n            editor.formatter.remove('link');\n          },\n          'JustifyLeft,JustifyCenter,JustifyRight,JustifyFull,JustifyNone': function (command) {\n            var align = command.substring(7);\n            if (align === 'full') {\n              align = 'justify';\n            }\n            each$f('left,center,right,justify'.split(','), function (name) {\n              if (align !== name) {\n                editor.formatter.remove('align' + name);\n              }\n            });\n            if (align !== 'none') {\n              self.toggleFormat('align' + align);\n            }\n          },\n          'InsertUnorderedList,InsertOrderedList': function (command) {\n            var listElm, listParent;\n            self.execNativeCommand(command);\n            listElm = editor.dom.getParent(editor.selection.getNode(), 'ol,ul');\n            if (listElm) {\n              listParent = listElm.parentNode;\n              if (/^(H[1-6]|P|ADDRESS|PRE)$/.test(listParent.nodeName)) {\n                self.storeSelection();\n                editor.dom.split(listParent, listElm);\n                self.restoreSelection();\n              }\n            }\n          },\n          'Bold,Italic,Underline,Strikethrough,Superscript,Subscript': function (command) {\n            self.toggleFormat(command);\n          },\n          'ForeColor,HiliteColor': function (command, ui, value) {\n            self.toggleFormat(command, value);\n          },\n          'FontName': function (command, ui, value) {\n            fontNameAction(editor, value);\n          },\n          'FontSize': function (command, ui, value) {\n            fontSizeAction(editor, value);\n          },\n          'RemoveFormat': function (command) {\n            editor.formatter.remove(command);\n          },\n          'mceBlockQuote': function () {\n            self.toggleFormat('blockquote');\n          },\n          'FormatBlock': function (command, ui, value) {\n            return self.toggleFormat(value || 'p');\n          },\n          'mceCleanup': function () {\n            var bookmark = editor.selection.getBookmark();\n            editor.setContent(editor.getContent());\n            editor.selection.moveToBookmark(bookmark);\n          },\n          'mceRemoveNode': function (command, ui, value) {\n            var node = value || editor.selection.getNode();\n            if (node !== editor.getBody()) {\n              self.storeSelection();\n              editor.dom.remove(node, true);\n              self.restoreSelection();\n            }\n          },\n          'mceSelectNodeDepth': function (command, ui, value) {\n            var counter = 0;\n            editor.dom.getParent(editor.selection.getNode(), function (node) {\n              if (node.nodeType === 1 && counter++ === value) {\n                editor.selection.select(node);\n                return false;\n              }\n            }, editor.getBody());\n          },\n          'mceSelectNode': function (command, ui, value) {\n            editor.selection.select(value);\n          },\n          'mceInsertContent': function (command, ui, value) {\n            InsertContent.insertAtCaret(editor, value);\n          },\n          'mceInsertRawHTML': function (command, ui, value) {\n            editor.selection.setContent('tiny_mce_marker');\n            var content = editor.getContent();\n            editor.setContent(content.replace(/tiny_mce_marker/g, function () {\n              return value;\n            }));\n          },\n          'mceInsertNewLine': function (command, ui, value) {\n            InsertNewLine.insert(editor, value);\n          },\n          'mceToggleFormat': function (command, ui, value) {\n            self.toggleFormat(value);\n          },\n          'mceSetContent': function (command, ui, value) {\n            editor.setContent(value);\n          },\n          'Indent,Outdent': function (command) {\n            handle(editor, command);\n          },\n          'mceRepaint': function () {\n          },\n          'InsertHorizontalRule': function () {\n            editor.execCommand('mceInsertContent', false, '<hr />');\n          },\n          'mceToggleVisualAid': function () {\n            editor.hasVisual = !editor.hasVisual;\n            editor.addVisual();\n          },\n          'mceReplaceContent': function (command, ui, value) {\n            editor.execCommand('mceInsertContent', false, value.replace(/\\{\\$selection\\}/g, editor.selection.getContent({ format: 'text' })));\n          },\n          'mceInsertLink': function (command, ui, value) {\n            var anchor;\n            if (typeof value === 'string') {\n              value = { href: value };\n            }\n            anchor = editor.dom.getParent(editor.selection.getNode(), 'a');\n            value.href = value.href.replace(/ /g, '%20');\n            if (!anchor || !value.href) {\n              editor.formatter.remove('link');\n            }\n            if (value.href) {\n              editor.formatter.apply('link', value, anchor);\n            }\n          },\n          'selectAll': function () {\n            var editingHost = editor.dom.getParent(editor.selection.getStart(), NodeType.isContentEditableTrue);\n            if (editingHost) {\n              var rng = editor.dom.createRng();\n              rng.selectNodeContents(editingHost);\n              editor.selection.setRng(rng);\n            }\n          },\n          'delete': function () {\n            DeleteCommands.deleteCommand(editor);\n          },\n          'forwardDelete': function () {\n            DeleteCommands.forwardDeleteCommand(editor);\n          },\n          'mceNewDocument': function () {\n            editor.setContent('');\n          },\n          'InsertLineBreak': function (command, ui, value) {\n            InsertBr.insert(editor, value);\n            return true;\n          }\n        });\n        var alignStates = function (name) {\n          return function () {\n            var nodes = editor.selection.isCollapsed() ? [editor.dom.getParent(editor.selection.getNode(), editor.dom.isBlock)] : editor.selection.getSelectedBlocks();\n            var matches = map$3(nodes, function (node) {\n              return !!editor.formatter.matchNode(node, name);\n            });\n            return inArray$2(matches, true) !== -1;\n          };\n        };\n        self.addCommands({\n          'JustifyLeft': alignStates('alignleft'),\n          'JustifyCenter': alignStates('aligncenter'),\n          'JustifyRight': alignStates('alignright'),\n          'JustifyFull': alignStates('alignjustify'),\n          'Bold,Italic,Underline,Strikethrough,Superscript,Subscript': function (command) {\n            return self.isFormatMatch(command);\n          },\n          'mceBlockQuote': function () {\n            return self.isFormatMatch('blockquote');\n          },\n          'Outdent': function () {\n            return canOutdent(editor);\n          },\n          'InsertUnorderedList,InsertOrderedList': function (command) {\n            var list = editor.dom.getParent(editor.selection.getNode(), 'ul,ol');\n            return list && (command === 'insertunorderedlist' && list.tagName === 'UL' || command === 'insertorderedlist' && list.tagName === 'OL');\n          }\n        }, 'state');\n        self.addCommands({\n          Undo: function () {\n            editor.undoManager.undo();\n          },\n          Redo: function () {\n            editor.undoManager.redo();\n          }\n        });\n        self.addQueryValueHandler('FontName', function () {\n          return fontNameQuery(editor);\n        }, this);\n        self.addQueryValueHandler('FontSize', function () {\n          return fontSizeQuery(editor);\n        }, this);\n      };\n      return EditorCommands;\n    }();\n\n    var nativeEvents = Tools.makeMap('focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange ' + 'mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover ' + 'draggesture dragdrop drop drag submit ' + 'compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel', ' ');\n    var EventDispatcher = function () {\n      function EventDispatcher(settings) {\n        this.bindings = {};\n        this.settings = settings || {};\n        this.scope = this.settings.scope || this;\n        this.toggleEvent = this.settings.toggleEvent || never;\n      }\n      EventDispatcher.isNative = function (name) {\n        return !!nativeEvents[name.toLowerCase()];\n      };\n      EventDispatcher.prototype.fire = function (name, args) {\n        var handlers, i, l, callback;\n        name = name.toLowerCase();\n        args = args || {};\n        args.type = name;\n        if (!args.target) {\n          args.target = this.scope;\n        }\n        if (!args.preventDefault) {\n          args.preventDefault = function () {\n            args.isDefaultPrevented = always;\n          };\n          args.stopPropagation = function () {\n            args.isPropagationStopped = always;\n          };\n          args.stopImmediatePropagation = function () {\n            args.isImmediatePropagationStopped = always;\n          };\n          args.isDefaultPrevented = never;\n          args.isPropagationStopped = never;\n          args.isImmediatePropagationStopped = never;\n        }\n        if (this.settings.beforeFire) {\n          this.settings.beforeFire(args);\n        }\n        handlers = this.bindings[name];\n        if (handlers) {\n          for (i = 0, l = handlers.length; i < l; i++) {\n            callback = handlers[i];\n            if (callback.once) {\n              this.off(name, callback.func);\n            }\n            if (args.isImmediatePropagationStopped()) {\n              args.stopPropagation();\n              return args;\n            }\n            if (callback.func.call(this.scope, args) === false) {\n              args.preventDefault();\n              return args;\n            }\n          }\n        }\n        return args;\n      };\n      EventDispatcher.prototype.on = function (name, callback, prepend, extra) {\n        var handlers, names, i;\n        if (callback === false) {\n          callback = never;\n        }\n        if (callback) {\n          var wrappedCallback = { func: callback };\n          if (extra) {\n            Tools.extend(wrappedCallback, extra);\n          }\n          names = name.toLowerCase().split(' ');\n          i = names.length;\n          while (i--) {\n            name = names[i];\n            handlers = this.bindings[name];\n            if (!handlers) {\n              handlers = this.bindings[name] = [];\n              this.toggleEvent(name, true);\n            }\n            if (prepend) {\n              handlers.unshift(wrappedCallback);\n            } else {\n              handlers.push(wrappedCallback);\n            }\n          }\n        }\n        return this;\n      };\n      EventDispatcher.prototype.off = function (name, callback) {\n        var i, handlers, bindingName, names, hi;\n        if (name) {\n          names = name.toLowerCase().split(' ');\n          i = names.length;\n          while (i--) {\n            name = names[i];\n            handlers = this.bindings[name];\n            if (!name) {\n              for (bindingName in this.bindings) {\n                this.toggleEvent(bindingName, false);\n                delete this.bindings[bindingName];\n              }\n              return this;\n            }\n            if (handlers) {\n              if (!callback) {\n                handlers.length = 0;\n              } else {\n                hi = handlers.length;\n                while (hi--) {\n                  if (handlers[hi].func === callback) {\n                    handlers = handlers.slice(0, hi).concat(handlers.slice(hi + 1));\n                    this.bindings[name] = handlers;\n                  }\n                }\n              }\n              if (!handlers.length) {\n                this.toggleEvent(name, false);\n                delete this.bindings[name];\n              }\n            }\n          }\n        } else {\n          for (name in this.bindings) {\n            this.toggleEvent(name, false);\n          }\n          this.bindings = {};\n        }\n        return this;\n      };\n      EventDispatcher.prototype.once = function (name, callback, prepend) {\n        return this.on(name, callback, prepend, { once: true });\n      };\n      EventDispatcher.prototype.has = function (name) {\n        name = name.toLowerCase();\n        return !(!this.bindings[name] || this.bindings[name].length === 0);\n      };\n      return EventDispatcher;\n    }();\n\n    var getEventDispatcher = function (obj) {\n      if (!obj._eventDispatcher) {\n        obj._eventDispatcher = new EventDispatcher({\n          scope: obj,\n          toggleEvent: function (name, state) {\n            if (EventDispatcher.isNative(name) && obj.toggleNativeEvent) {\n              obj.toggleNativeEvent(name, state);\n            }\n          }\n        });\n      }\n      return obj._eventDispatcher;\n    };\n    var Observable = {\n      fire: function (name, args, bubble) {\n        var self = this;\n        if (self.removed && name !== 'remove' && name !== 'detach') {\n          return args;\n        }\n        var dispatcherArgs = getEventDispatcher(self).fire(name, args);\n        if (bubble !== false && self.parent) {\n          var parent_1 = self.parent();\n          while (parent_1 && !dispatcherArgs.isPropagationStopped()) {\n            parent_1.fire(name, dispatcherArgs, false);\n            parent_1 = parent_1.parent();\n          }\n        }\n        return dispatcherArgs;\n      },\n      on: function (name, callback, prepend) {\n        return getEventDispatcher(this).on(name, callback, prepend);\n      },\n      off: function (name, callback) {\n        return getEventDispatcher(this).off(name, callback);\n      },\n      once: function (name, callback) {\n        return getEventDispatcher(this).once(name, callback);\n      },\n      hasEventListeners: function (name) {\n        return getEventDispatcher(this).has(name);\n      }\n    };\n\n    var internalContentEditableAttr = 'data-mce-contenteditable';\n    var toggleClass = function (elm, cls, state) {\n      if (has$2(elm, cls) && state === false) {\n        remove$4(elm, cls);\n      } else if (state) {\n        add$3(elm, cls);\n      }\n    };\n    var setEditorCommandState = function (editor, cmd, state) {\n      try {\n        editor.getDoc().execCommand(cmd, false, state);\n      } catch (ex) {\n      }\n    };\n    var setContentEditable = function (elm, state) {\n      elm.dom().contentEditable = state ? 'true' : 'false';\n    };\n    var switchOffContentEditableTrue = function (elm) {\n      each(descendants$1(elm, '*[contenteditable=\"true\"]'), function (elm) {\n        set(elm, internalContentEditableAttr, 'true');\n        setContentEditable(elm, false);\n      });\n    };\n    var switchOnContentEditableTrue = function (elm) {\n      each(descendants$1(elm, '*[' + internalContentEditableAttr + '=\"true\"]'), function (elm) {\n        remove$1(elm, internalContentEditableAttr);\n        setContentEditable(elm, true);\n      });\n    };\n    var removeFakeSelection = function (editor) {\n      Option.from(editor.selection.getNode()).each(function (elm) {\n        elm.removeAttribute('data-mce-selected');\n      });\n    };\n    var restoreFakeSelection = function (editor) {\n      editor.selection.setRng(editor.selection.getRng());\n    };\n    var toggleReadOnly = function (editor, state) {\n      var body = Element.fromDom(editor.getBody());\n      toggleClass(body, 'mce-content-readonly', state);\n      if (state) {\n        editor.selection.controlSelection.hideResizeRect();\n        editor._selectionOverrides.hideFakeCaret();\n        removeFakeSelection(editor);\n        editor.readonly = true;\n        setContentEditable(body, false);\n        switchOffContentEditableTrue(body);\n      } else {\n        editor.readonly = false;\n        setContentEditable(body, true);\n        switchOnContentEditableTrue(body);\n        setEditorCommandState(editor, 'StyleWithCSS', false);\n        setEditorCommandState(editor, 'enableInlineTableEditing', false);\n        setEditorCommandState(editor, 'enableObjectResizing', false);\n        if (EditorFocus.hasEditorOrUiFocus(editor)) {\n          editor.focus();\n        }\n        restoreFakeSelection(editor);\n        editor.nodeChanged();\n      }\n    };\n    var isReadOnly = function (editor) {\n      return editor.readonly === true;\n    };\n    var registerFilters = function (editor) {\n      editor.parser.addAttributeFilter('contenteditable', function (nodes) {\n        if (isReadOnly(editor)) {\n          each(nodes, function (node) {\n            node.attr(internalContentEditableAttr, node.attr('contenteditable'));\n            node.attr('contenteditable', 'false');\n          });\n        }\n      });\n      editor.serializer.addAttributeFilter(internalContentEditableAttr, function (nodes) {\n        if (isReadOnly(editor)) {\n          each(nodes, function (node) {\n            node.attr('contenteditable', node.attr(internalContentEditableAttr));\n          });\n        }\n      });\n      editor.serializer.addTempAttr(internalContentEditableAttr);\n    };\n    var registerReadOnlyContentFilters = function (editor) {\n      if (editor.serializer) {\n        registerFilters(editor);\n      } else {\n        editor.on('PreInit', function () {\n          registerFilters(editor);\n        });\n      }\n    };\n    var isClickEvent = function (e) {\n      return e.type === 'click';\n    };\n    var isInAnchor = function (editor, target) {\n      return editor.dom.getParent(target, 'a') !== null;\n    };\n    var preventReadOnlyEvents = function (editor, e) {\n      var target = e.target;\n      if (isClickEvent(e) && !VK.metaKeyPressed(e) && isInAnchor(editor, target)) {\n        e.preventDefault();\n      }\n    };\n    var registerReadOnlySelectionBlockers = function (editor) {\n      editor.on('ShowCaret', function (e) {\n        if (isReadOnly(editor)) {\n          e.preventDefault();\n        }\n      });\n      editor.on('ObjectSelected', function (e) {\n        if (isReadOnly(editor)) {\n          e.preventDefault();\n        }\n      });\n    };\n\n    var DOM$8 = DOMUtils$1.DOM;\n    var customEventRootDelegates;\n    var getEventTarget = function (editor, eventName) {\n      if (eventName === 'selectionchange') {\n        return editor.getDoc();\n      }\n      if (!editor.inline && /^mouse|touch|click|contextmenu|drop|dragover|dragend/.test(eventName)) {\n        return editor.getDoc().documentElement;\n      }\n      if (editor.settings.event_root) {\n        if (!editor.eventRoot) {\n          editor.eventRoot = DOM$8.select(editor.settings.event_root)[0];\n        }\n        return editor.eventRoot;\n      }\n      return editor.getBody();\n    };\n    var isListening = function (editor) {\n      return !editor.hidden && !isReadOnly(editor);\n    };\n    var fireEvent = function (editor, eventName, e) {\n      if (isListening(editor)) {\n        editor.fire(eventName, e);\n      } else if (isReadOnly(editor)) {\n        preventReadOnlyEvents(editor, e);\n      }\n    };\n    var bindEventDelegate = function (editor, eventName) {\n      var eventRootElm, delegate;\n      if (!editor.delegates) {\n        editor.delegates = {};\n      }\n      if (editor.delegates[eventName] || editor.removed) {\n        return;\n      }\n      eventRootElm = getEventTarget(editor, eventName);\n      if (editor.settings.event_root) {\n        if (!customEventRootDelegates) {\n          customEventRootDelegates = {};\n          editor.editorManager.on('removeEditor', function () {\n            var name;\n            if (!editor.editorManager.activeEditor) {\n              if (customEventRootDelegates) {\n                for (name in customEventRootDelegates) {\n                  editor.dom.unbind(getEventTarget(editor, name));\n                }\n                customEventRootDelegates = null;\n              }\n            }\n          });\n        }\n        if (customEventRootDelegates[eventName]) {\n          return;\n        }\n        delegate = function (e) {\n          var target = e.target;\n          var editors = editor.editorManager.get();\n          var i = editors.length;\n          while (i--) {\n            var body = editors[i].getBody();\n            if (body === target || DOM$8.isChildOf(target, body)) {\n              fireEvent(editors[i], eventName, e);\n            }\n          }\n        };\n        customEventRootDelegates[eventName] = delegate;\n        DOM$8.bind(eventRootElm, eventName, delegate);\n      } else {\n        delegate = function (e) {\n          fireEvent(editor, eventName, e);\n        };\n        DOM$8.bind(eventRootElm, eventName, delegate);\n        editor.delegates[eventName] = delegate;\n      }\n    };\n    var EditorObservable = __assign(__assign({}, Observable), {\n      bindPendingEventDelegates: function () {\n        var self = this;\n        Tools.each(self._pendingNativeEvents, function (name) {\n          bindEventDelegate(self, name);\n        });\n      },\n      toggleNativeEvent: function (name, state) {\n        var self = this;\n        if (name === 'focus' || name === 'blur') {\n          return;\n        }\n        if (state) {\n          if (self.initialized) {\n            bindEventDelegate(self, name);\n          } else {\n            if (!self._pendingNativeEvents) {\n              self._pendingNativeEvents = [name];\n            } else {\n              self._pendingNativeEvents.push(name);\n            }\n          }\n        } else if (self.initialized) {\n          self.dom.unbind(getEventTarget(self, name), name, self.delegates[name]);\n          delete self.delegates[name];\n        }\n      },\n      unbindAllNativeEvents: function () {\n        var self = this;\n        var body = self.getBody();\n        var dom = self.dom;\n        var name;\n        if (self.delegates) {\n          for (name in self.delegates) {\n            self.dom.unbind(getEventTarget(self, name), name, self.delegates[name]);\n          }\n          delete self.delegates;\n        }\n        if (!self.inline && body && dom) {\n          body.onload = null;\n          dom.unbind(self.getWin());\n          dom.unbind(self.getDoc());\n        }\n        if (dom) {\n          dom.unbind(body);\n          dom.unbind(self.getContainer());\n        }\n      }\n    });\n\n    var defaultModes = [\n      'design',\n      'readonly'\n    ];\n    var switchToMode = function (editor, activeMode, availableModes, mode) {\n      var oldMode = availableModes[activeMode.get()];\n      var newMode = availableModes[mode];\n      try {\n        newMode.activate();\n      } catch (e) {\n        domGlobals.console.error('problem while activating editor mode ' + mode + ':', e);\n        return;\n      }\n      oldMode.deactivate();\n      if (oldMode.editorReadOnly !== newMode.editorReadOnly) {\n        toggleReadOnly(editor, newMode.editorReadOnly);\n      }\n      activeMode.set(mode);\n      fireSwitchMode(editor, mode);\n    };\n    var setMode = function (editor, availableModes, activeMode, mode) {\n      if (mode === activeMode.get()) {\n        return;\n      } else if (!has(availableModes, mode)) {\n        throw new Error('Editor mode \\'' + mode + '\\' is invalid');\n      }\n      if (editor.initialized) {\n        switchToMode(editor, activeMode, availableModes, mode);\n      } else {\n        editor.on('init', function () {\n          return switchToMode(editor, activeMode, availableModes, mode);\n        });\n      }\n    };\n    var registerMode = function (availableModes, mode, api) {\n      var _a;\n      if (contains(defaultModes, mode)) {\n        throw new Error('Cannot override default mode ' + mode);\n      }\n      return __assign(__assign({}, availableModes), (_a = {}, _a[mode] = __assign(__assign({}, api), {\n        deactivate: function () {\n          try {\n            api.deactivate();\n          } catch (e) {\n            domGlobals.console.error('problem while deactivating editor mode ' + mode + ':', e);\n          }\n        }\n      }), _a));\n    };\n\n    var create$4 = function (editor) {\n      var activeMode = Cell('design');\n      var availableModes = Cell({\n        design: {\n          activate: noop,\n          deactivate: noop,\n          editorReadOnly: false\n        },\n        readonly: {\n          activate: noop,\n          deactivate: noop,\n          editorReadOnly: true\n        }\n      });\n      registerReadOnlyContentFilters(editor);\n      registerReadOnlySelectionBlockers(editor);\n      return {\n        isReadOnly: function () {\n          return isReadOnly(editor);\n        },\n        set: function (mode) {\n          return setMode(editor, availableModes.get(), activeMode, mode);\n        },\n        get: function () {\n          return activeMode.get();\n        },\n        register: function (mode, api) {\n          availableModes.set(registerMode(availableModes.get(), mode, api));\n        }\n      };\n    };\n\n    var each$g = Tools.each, explode$3 = Tools.explode;\n    var keyCodeLookup = {\n      f1: 112,\n      f2: 113,\n      f3: 114,\n      f4: 115,\n      f5: 116,\n      f6: 117,\n      f7: 118,\n      f8: 119,\n      f9: 120,\n      f10: 121,\n      f11: 122,\n      f12: 123\n    };\n    var modifierNames = Tools.makeMap('alt,ctrl,shift,meta,access');\n    var Shortcuts = function () {\n      function Shortcuts(editor) {\n        this.shortcuts = {};\n        this.pendingPatterns = [];\n        this.editor = editor;\n        var self = this;\n        editor.on('keyup keypress keydown', function (e) {\n          if ((self.hasModifier(e) || self.isFunctionKey(e)) && !e.isDefaultPrevented()) {\n            each$g(self.shortcuts, function (shortcut) {\n              if (self.matchShortcut(e, shortcut)) {\n                self.pendingPatterns = shortcut.subpatterns.slice(0);\n                if (e.type === 'keydown') {\n                  self.executeShortcutAction(shortcut);\n                }\n                return true;\n              }\n            });\n            if (self.matchShortcut(e, self.pendingPatterns[0])) {\n              if (self.pendingPatterns.length === 1) {\n                if (e.type === 'keydown') {\n                  self.executeShortcutAction(self.pendingPatterns[0]);\n                }\n              }\n              self.pendingPatterns.shift();\n            }\n          }\n        });\n      }\n      Shortcuts.prototype.add = function (pattern, desc, cmdFunc, scope) {\n        var self = this;\n        var cmd;\n        cmd = cmdFunc;\n        if (typeof cmdFunc === 'string') {\n          cmdFunc = function () {\n            self.editor.execCommand(cmd, false, null);\n          };\n        } else if (Tools.isArray(cmd)) {\n          cmdFunc = function () {\n            self.editor.execCommand(cmd[0], cmd[1], cmd[2]);\n          };\n        }\n        each$g(explode$3(Tools.trim(pattern)), function (pattern) {\n          var shortcut = self.createShortcut(pattern, desc, cmdFunc, scope);\n          self.shortcuts[shortcut.id] = shortcut;\n        });\n        return true;\n      };\n      Shortcuts.prototype.remove = function (pattern) {\n        var shortcut = this.createShortcut(pattern);\n        if (this.shortcuts[shortcut.id]) {\n          delete this.shortcuts[shortcut.id];\n          return true;\n        }\n        return false;\n      };\n      Shortcuts.prototype.parseShortcut = function (pattern) {\n        var id, key;\n        var shortcut = {};\n        each$g(explode$3(pattern.toLowerCase(), '+'), function (value) {\n          if (value in modifierNames) {\n            shortcut[value] = true;\n          } else {\n            if (/^[0-9]{2,}$/.test(value)) {\n              shortcut.keyCode = parseInt(value, 10);\n            } else {\n              shortcut.charCode = value.charCodeAt(0);\n              shortcut.keyCode = keyCodeLookup[value] || value.toUpperCase().charCodeAt(0);\n            }\n          }\n        });\n        id = [shortcut.keyCode];\n        for (key in modifierNames) {\n          if (shortcut[key]) {\n            id.push(key);\n          } else {\n            shortcut[key] = false;\n          }\n        }\n        shortcut.id = id.join(',');\n        if (shortcut.access) {\n          shortcut.alt = true;\n          if (Env.mac) {\n            shortcut.ctrl = true;\n          } else {\n            shortcut.shift = true;\n          }\n        }\n        if (shortcut.meta) {\n          if (Env.mac) {\n            shortcut.meta = true;\n          } else {\n            shortcut.ctrl = true;\n            shortcut.meta = false;\n          }\n        }\n        return shortcut;\n      };\n      Shortcuts.prototype.createShortcut = function (pattern, desc, cmdFunc, scope) {\n        var shortcuts;\n        shortcuts = Tools.map(explode$3(pattern, '>'), this.parseShortcut);\n        shortcuts[shortcuts.length - 1] = Tools.extend(shortcuts[shortcuts.length - 1], {\n          func: cmdFunc,\n          scope: scope || this.editor\n        });\n        return Tools.extend(shortcuts[0], {\n          desc: this.editor.translate(desc),\n          subpatterns: shortcuts.slice(1)\n        });\n      };\n      Shortcuts.prototype.hasModifier = function (e) {\n        return e.altKey || e.ctrlKey || e.metaKey;\n      };\n      Shortcuts.prototype.isFunctionKey = function (e) {\n        return e.type === 'keydown' && e.keyCode >= 112 && e.keyCode <= 123;\n      };\n      Shortcuts.prototype.matchShortcut = function (e, shortcut) {\n        if (!shortcut) {\n          return false;\n        }\n        if (shortcut.ctrl !== e.ctrlKey || shortcut.meta !== e.metaKey) {\n          return false;\n        }\n        if (shortcut.alt !== e.altKey || shortcut.shift !== e.shiftKey) {\n          return false;\n        }\n        if (e.keyCode === shortcut.keyCode || e.charCode && e.charCode === shortcut.charCode) {\n          e.preventDefault();\n          return true;\n        }\n        return false;\n      };\n      Shortcuts.prototype.executeShortcutAction = function (shortcut) {\n        return shortcut.func ? shortcut.func.call(shortcut.scope) : null;\n      };\n      return Shortcuts;\n    }();\n\n    var create$5 = function () {\n      var buttons = {};\n      var menuItems = {};\n      var popups = {};\n      var icons = {};\n      var contextMenus = {};\n      var contextToolbars = {};\n      var sidebars = {};\n      var add = function (collection, type) {\n        return function (name, spec) {\n          return collection[name.toLowerCase()] = __assign(__assign({}, spec), { type: type });\n        };\n      };\n      var addIcon = function (name, svgData) {\n        return icons[name.toLowerCase()] = svgData;\n      };\n      return {\n        addButton: add(buttons, 'button'),\n        addGroupToolbarButton: add(buttons, 'grouptoolbarbutton'),\n        addToggleButton: add(buttons, 'togglebutton'),\n        addMenuButton: add(buttons, 'menubutton'),\n        addSplitButton: add(buttons, 'splitbutton'),\n        addMenuItem: add(menuItems, 'menuitem'),\n        addNestedMenuItem: add(menuItems, 'nestedmenuitem'),\n        addToggleMenuItem: add(menuItems, 'togglemenuitem'),\n        addAutocompleter: add(popups, 'autocompleter'),\n        addContextMenu: add(contextMenus, 'contextmenu'),\n        addContextToolbar: add(contextToolbars, 'contexttoolbar'),\n        addContextForm: add(contextToolbars, 'contextform'),\n        addSidebar: add(sidebars, 'sidebar'),\n        addIcon: addIcon,\n        getAll: function () {\n          return {\n            buttons: buttons,\n            menuItems: menuItems,\n            icons: icons,\n            popups: popups,\n            contextMenus: contextMenus,\n            contextToolbars: contextToolbars,\n            sidebars: sidebars\n          };\n        }\n      };\n    };\n\n    var registry = function () {\n      var bridge = create$5();\n      return {\n        addAutocompleter: bridge.addAutocompleter,\n        addButton: bridge.addButton,\n        addContextForm: bridge.addContextForm,\n        addContextMenu: bridge.addContextMenu,\n        addContextToolbar: bridge.addContextToolbar,\n        addIcon: bridge.addIcon,\n        addMenuButton: bridge.addMenuButton,\n        addMenuItem: bridge.addMenuItem,\n        addNestedMenuItem: bridge.addNestedMenuItem,\n        addSidebar: bridge.addSidebar,\n        addSplitButton: bridge.addSplitButton,\n        addToggleButton: bridge.addToggleButton,\n        addGroupToolbarButton: bridge.addGroupToolbarButton,\n        addToggleMenuItem: bridge.addToggleMenuItem,\n        getAll: bridge.getAll\n      };\n    };\n\n    var each$h = Tools.each, trim$4 = Tools.trim;\n    var queryParts = 'source protocol authority userInfo user password host port relative path directory file query anchor'.split(' ');\n    var DEFAULT_PORTS = {\n      ftp: 21,\n      http: 80,\n      https: 443,\n      mailto: 25\n    };\n    var URI = function () {\n      function URI(url, settings) {\n        url = trim$4(url);\n        this.settings = settings || {};\n        var baseUri = this.settings.base_uri;\n        var self = this;\n        if (/^([\\w\\-]+):([^\\/]{2})/i.test(url) || /^\\s*#/.test(url)) {\n          self.source = url;\n          return;\n        }\n        var isProtocolRelative = url.indexOf('//') === 0;\n        if (url.indexOf('/') === 0 && !isProtocolRelative) {\n          url = (baseUri ? baseUri.protocol || 'http' : 'http') + '://mce_host' + url;\n        }\n        if (!/^[\\w\\-]*:?\\/\\//.test(url)) {\n          var baseUrl = this.settings.base_uri ? this.settings.base_uri.path : new URI(domGlobals.document.location.href).directory;\n          if (this.settings.base_uri && this.settings.base_uri.protocol == '') {\n            url = '//mce_host' + self.toAbsPath(baseUrl, url);\n          } else {\n            var match = /([^#?]*)([#?]?.*)/.exec(url);\n            url = (baseUri && baseUri.protocol || 'http') + '://mce_host' + self.toAbsPath(baseUrl, match[1]) + match[2];\n          }\n        }\n        url = url.replace(/@@/g, '(mce_at)');\n        var urlMatch = /^(?:(?![^:@]+:[^:@\\/]*@)([^:\\/?#.]+):)?(?:\\/\\/)?((?:(([^:@\\/]*):?([^:@\\/]*))?@)?([^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/.exec(url);\n        each$h(queryParts, function (v, i) {\n          var part = urlMatch[i];\n          if (part) {\n            part = part.replace(/\\(mce_at\\)/g, '@@');\n          }\n          self[v] = part;\n        });\n        if (baseUri) {\n          if (!self.protocol) {\n            self.protocol = baseUri.protocol;\n          }\n          if (!self.userInfo) {\n            self.userInfo = baseUri.userInfo;\n          }\n          if (!self.port && self.host === 'mce_host') {\n            self.port = baseUri.port;\n          }\n          if (!self.host || self.host === 'mce_host') {\n            self.host = baseUri.host;\n          }\n          self.source = '';\n        }\n        if (isProtocolRelative) {\n          self.protocol = '';\n        }\n      }\n      URI.parseDataUri = function (uri) {\n        var type;\n        var uriComponents = decodeURIComponent(uri).split(',');\n        var matches = /data:([^;]+)/.exec(uriComponents[0]);\n        if (matches) {\n          type = matches[1];\n        }\n        return {\n          type: type,\n          data: uriComponents[1]\n        };\n      };\n      URI.getDocumentBaseUrl = function (loc) {\n        var baseUrl;\n        if (loc.protocol.indexOf('http') !== 0 && loc.protocol !== 'file:') {\n          baseUrl = loc.href;\n        } else {\n          baseUrl = loc.protocol + '//' + loc.host + loc.pathname;\n        }\n        if (/^[^:]+:\\/\\/\\/?[^\\/]+\\//.test(baseUrl)) {\n          baseUrl = baseUrl.replace(/[\\?#].*$/, '').replace(/[\\/\\\\][^\\/]+$/, '');\n          if (!/[\\/\\\\]$/.test(baseUrl)) {\n            baseUrl += '/';\n          }\n        }\n        return baseUrl;\n      };\n      URI.prototype.setPath = function (path) {\n        var pathMatch = /^(.*?)\\/?(\\w+)?$/.exec(path);\n        this.path = pathMatch[0];\n        this.directory = pathMatch[1];\n        this.file = pathMatch[2];\n        this.source = '';\n        this.getURI();\n      };\n      URI.prototype.toRelative = function (uri) {\n        var output;\n        if (uri === './') {\n          return uri;\n        }\n        var relativeUri = new URI(uri, { base_uri: this });\n        if (relativeUri.host !== 'mce_host' && this.host !== relativeUri.host && relativeUri.host || this.port !== relativeUri.port || this.protocol !== relativeUri.protocol && relativeUri.protocol !== '') {\n          return relativeUri.getURI();\n        }\n        var tu = this.getURI(), uu = relativeUri.getURI();\n        if (tu === uu || tu.charAt(tu.length - 1) === '/' && tu.substr(0, tu.length - 1) === uu) {\n          return tu;\n        }\n        output = this.toRelPath(this.path, relativeUri.path);\n        if (relativeUri.query) {\n          output += '?' + relativeUri.query;\n        }\n        if (relativeUri.anchor) {\n          output += '#' + relativeUri.anchor;\n        }\n        return output;\n      };\n      URI.prototype.toAbsolute = function (uri, noHost) {\n        var absoluteUri = new URI(uri, { base_uri: this });\n        return absoluteUri.getURI(noHost && this.isSameOrigin(absoluteUri));\n      };\n      URI.prototype.isSameOrigin = function (uri) {\n        if (this.host == uri.host && this.protocol == uri.protocol) {\n          if (this.port == uri.port) {\n            return true;\n          }\n          var defaultPort = DEFAULT_PORTS[this.protocol];\n          if (defaultPort && (this.port || defaultPort) == (uri.port || defaultPort)) {\n            return true;\n          }\n        }\n        return false;\n      };\n      URI.prototype.toRelPath = function (base, path) {\n        var items, breakPoint = 0, out = '', i, l;\n        var normalizedBase = base.substring(0, base.lastIndexOf('/')).split('/');\n        items = path.split('/');\n        if (normalizedBase.length >= items.length) {\n          for (i = 0, l = normalizedBase.length; i < l; i++) {\n            if (i >= items.length || normalizedBase[i] !== items[i]) {\n              breakPoint = i + 1;\n              break;\n            }\n          }\n        }\n        if (normalizedBase.length < items.length) {\n          for (i = 0, l = items.length; i < l; i++) {\n            if (i >= normalizedBase.length || normalizedBase[i] !== items[i]) {\n              breakPoint = i + 1;\n              break;\n            }\n          }\n        }\n        if (breakPoint === 1) {\n          return path;\n        }\n        for (i = 0, l = normalizedBase.length - (breakPoint - 1); i < l; i++) {\n          out += '../';\n        }\n        for (i = breakPoint - 1, l = items.length; i < l; i++) {\n          if (i !== breakPoint - 1) {\n            out += '/' + items[i];\n          } else {\n            out += items[i];\n          }\n        }\n        return out;\n      };\n      URI.prototype.toAbsPath = function (base, path) {\n        var i, nb = 0, o = [], tr, outPath;\n        tr = /\\/$/.test(path) ? '/' : '';\n        var normalizedBase = base.split('/');\n        var normalizedPath = path.split('/');\n        each$h(normalizedBase, function (k) {\n          if (k) {\n            o.push(k);\n          }\n        });\n        normalizedBase = o;\n        for (i = normalizedPath.length - 1, o = []; i >= 0; i--) {\n          if (normalizedPath[i].length === 0 || normalizedPath[i] === '.') {\n            continue;\n          }\n          if (normalizedPath[i] === '..') {\n            nb++;\n            continue;\n          }\n          if (nb > 0) {\n            nb--;\n            continue;\n          }\n          o.push(normalizedPath[i]);\n        }\n        i = normalizedBase.length - nb;\n        if (i <= 0) {\n          outPath = reverse(o).join('/');\n        } else {\n          outPath = normalizedBase.slice(0, i).join('/') + '/' + reverse(o).join('/');\n        }\n        if (outPath.indexOf('/') !== 0) {\n          outPath = '/' + outPath;\n        }\n        if (tr && outPath.lastIndexOf('/') !== outPath.length - 1) {\n          outPath += tr;\n        }\n        return outPath;\n      };\n      URI.prototype.getURI = function (noProtoHost) {\n        if (noProtoHost === void 0) {\n          noProtoHost = false;\n        }\n        var s;\n        if (!this.source || noProtoHost) {\n          s = '';\n          if (!noProtoHost) {\n            if (this.protocol) {\n              s += this.protocol + '://';\n            } else {\n              s += '//';\n            }\n            if (this.userInfo) {\n              s += this.userInfo + '@';\n            }\n            if (this.host) {\n              s += this.host;\n            }\n            if (this.port) {\n              s += ':' + this.port;\n            }\n          }\n          if (this.path) {\n            s += this.path;\n          }\n          if (this.query) {\n            s += '?' + this.query;\n          }\n          if (this.anchor) {\n            s += '#' + this.anchor;\n          }\n          this.source = s;\n        }\n        return this.source;\n      };\n      return URI;\n    }();\n\n    var DOM$9 = DOMUtils$1.DOM;\n    var extend$3 = Tools.extend, each$i = Tools.each;\n    var resolve$3 = Tools.resolve;\n    var ie$1 = Env.ie;\n    var Editor = function () {\n      function Editor(id, settings, editorManager) {\n        var _this = this;\n        this.plugins = {};\n        this.contentCSS = [];\n        this.contentStyles = [];\n        this.loadedCSS = {};\n        this.isNotDirty = false;\n        this.editorManager = editorManager;\n        this.documentBaseUrl = editorManager.documentBaseURL;\n        extend$3(this, EditorObservable);\n        this.settings = getEditorSettings(this, id, this.documentBaseUrl, editorManager.defaultSettings, settings);\n        if (this.settings.suffix) {\n          editorManager.suffix = this.settings.suffix;\n        }\n        this.suffix = editorManager.suffix;\n        if (this.settings.base_url) {\n          editorManager._setBaseUrl(this.settings.base_url);\n        }\n        this.baseUri = editorManager.baseURI;\n        if (this.settings.referrer_policy) {\n          ScriptLoader.ScriptLoader._setReferrerPolicy(this.settings.referrer_policy);\n          DOMUtils$1.DOM.styleSheetLoader._setReferrerPolicy(this.settings.referrer_policy);\n        }\n        AddOnManager$1.languageLoad = this.settings.language_load;\n        AddOnManager$1.baseURL = editorManager.baseURL;\n        this.id = id;\n        this.setDirty(false);\n        this.documentBaseURI = new URI(this.settings.document_base_url, { base_uri: this.baseUri });\n        this.baseURI = this.baseUri;\n        this.inline = !!this.settings.inline;\n        this.shortcuts = new Shortcuts(this);\n        this.editorCommands = new EditorCommands(this);\n        if (this.settings.cache_suffix) {\n          Env.cacheSuffix = this.settings.cache_suffix.replace(/^[\\?\\&]+/, '');\n        }\n        this.ui = { registry: registry() };\n        var self = this;\n        var modeInstance = create$4(self);\n        this.mode = modeInstance;\n        this.setMode = modeInstance.set;\n        editorManager.fire('SetupEditor', { editor: this });\n        this.execCallback('setup', this);\n        this.$ = DomQuery.overrideDefaults(function () {\n          return {\n            context: _this.inline ? _this.getBody() : _this.getDoc(),\n            element: _this.getBody()\n          };\n        });\n      }\n      Editor.prototype.render = function () {\n        Render.render(this);\n      };\n      Editor.prototype.focus = function (skipFocus) {\n        EditorFocus.focus(this, skipFocus);\n      };\n      Editor.prototype.hasFocus = function () {\n        return EditorFocus.hasFocus(this);\n      };\n      Editor.prototype.execCallback = function (name) {\n        var x = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n          x[_i - 1] = arguments[_i];\n        }\n        var self = this;\n        var callback = self.settings[name], scope;\n        if (!callback) {\n          return;\n        }\n        if (self.callbackLookup && (scope = self.callbackLookup[name])) {\n          callback = scope.func;\n          scope = scope.scope;\n        }\n        if (typeof callback === 'string') {\n          scope = callback.replace(/\\.\\w+$/, '');\n          scope = scope ? resolve$3(scope) : 0;\n          callback = resolve$3(callback);\n          self.callbackLookup = self.callbackLookup || {};\n          self.callbackLookup[name] = {\n            func: callback,\n            scope: scope\n          };\n        }\n        return callback.apply(scope || self, Array.prototype.slice.call(arguments, 1));\n      };\n      Editor.prototype.translate = function (text) {\n        return I18n.translate(text);\n      };\n      Editor.prototype.getParam = function (name, defaultVal, type) {\n        return getParam(this, name, defaultVal, type);\n      };\n      Editor.prototype.nodeChanged = function (args) {\n        this._nodeChangeDispatcher.nodeChanged(args);\n      };\n      Editor.prototype.addCommand = function (name, callback, scope) {\n        this.editorCommands.addCommand(name, callback, scope);\n      };\n      Editor.prototype.addQueryStateHandler = function (name, callback, scope) {\n        this.editorCommands.addQueryStateHandler(name, callback, scope);\n      };\n      Editor.prototype.addQueryValueHandler = function (name, callback, scope) {\n        this.editorCommands.addQueryValueHandler(name, callback, scope);\n      };\n      Editor.prototype.addShortcut = function (pattern, desc, cmdFunc, scope) {\n        this.shortcuts.add(pattern, desc, cmdFunc, scope);\n      };\n      Editor.prototype.execCommand = function (cmd, ui, value, args) {\n        return this.editorCommands.execCommand(cmd, ui, value, args);\n      };\n      Editor.prototype.queryCommandState = function (cmd) {\n        return this.editorCommands.queryCommandState(cmd);\n      };\n      Editor.prototype.queryCommandValue = function (cmd) {\n        return this.editorCommands.queryCommandValue(cmd);\n      };\n      Editor.prototype.queryCommandSupported = function (cmd) {\n        return this.editorCommands.queryCommandSupported(cmd);\n      };\n      Editor.prototype.show = function () {\n        var self = this;\n        if (self.hidden) {\n          self.hidden = false;\n          if (self.inline) {\n            self.getBody().contentEditable = 'true';\n          } else {\n            DOM$9.show(self.getContainer());\n            DOM$9.hide(self.id);\n          }\n          self.load();\n          self.fire('show');\n        }\n      };\n      Editor.prototype.hide = function () {\n        var self = this, doc = self.getDoc();\n        if (!self.hidden) {\n          if (ie$1 && doc && !self.inline) {\n            doc.execCommand('SelectAll');\n          }\n          self.save();\n          if (self.inline) {\n            self.getBody().contentEditable = 'false';\n            if (self === self.editorManager.focusedEditor) {\n              self.editorManager.focusedEditor = null;\n            }\n          } else {\n            DOM$9.hide(self.getContainer());\n            DOM$9.setStyle(self.id, 'display', self.orgDisplay);\n          }\n          self.hidden = true;\n          self.fire('hide');\n        }\n      };\n      Editor.prototype.isHidden = function () {\n        return !!this.hidden;\n      };\n      Editor.prototype.setProgressState = function (state, time) {\n        this.fire('ProgressState', {\n          state: state,\n          time: time\n        });\n      };\n      Editor.prototype.load = function (args) {\n        var self = this;\n        var elm = self.getElement(), html;\n        if (self.removed) {\n          return '';\n        }\n        if (elm) {\n          args = args || {};\n          args.load = true;\n          var value = NodeType.isTextareaOrInput(elm) ? elm.value : elm.innerHTML;\n          html = self.setContent(value, args);\n          args.element = elm;\n          if (!args.no_events) {\n            self.fire('LoadContent', args);\n          }\n          args.element = elm = null;\n          return html;\n        }\n      };\n      Editor.prototype.save = function (args) {\n        var self = this;\n        var elm = self.getElement(), html, form;\n        if (!elm || !self.initialized || self.removed) {\n          return;\n        }\n        args = args || {};\n        args.save = true;\n        args.element = elm;\n        html = args.content = self.getContent(args);\n        if (!args.no_events) {\n          self.fire('SaveContent', args);\n        }\n        if (args.format === 'raw') {\n          self.fire('RawSaveContent', args);\n        }\n        html = args.content;\n        if (!NodeType.isTextareaOrInput(elm)) {\n          if (args.is_removing || !self.inline) {\n            elm.innerHTML = html;\n          }\n          if (form = DOM$9.getParent(self.id, 'form')) {\n            each$i(form.elements, function (elm) {\n              if (elm.name === self.id) {\n                elm.value = html;\n                return false;\n              }\n            });\n          }\n        } else {\n          elm.value = html;\n        }\n        args.element = elm = null;\n        if (args.set_dirty !== false) {\n          self.setDirty(false);\n        }\n        return html;\n      };\n      Editor.prototype.setContent = function (content, args) {\n        return setContent(this, content, args);\n      };\n      Editor.prototype.getContent = function (args) {\n        return getContent(this, args);\n      };\n      Editor.prototype.insertContent = function (content, args) {\n        if (args) {\n          content = extend$3({ content: content }, args);\n        }\n        this.execCommand('mceInsertContent', false, content);\n      };\n      Editor.prototype.resetContent = function (initialContent) {\n        if (initialContent === undefined) {\n          setContent(this, this.startContent, { format: 'raw' });\n        } else {\n          setContent(this, initialContent);\n        }\n        this.undoManager.reset();\n        this.setDirty(false);\n        this.nodeChanged();\n      };\n      Editor.prototype.isDirty = function () {\n        return !this.isNotDirty;\n      };\n      Editor.prototype.setDirty = function (state) {\n        var oldState = !this.isNotDirty;\n        this.isNotDirty = !state;\n        if (state && state !== oldState) {\n          this.fire('dirty');\n        }\n      };\n      Editor.prototype.getContainer = function () {\n        var self = this;\n        if (!self.container) {\n          self.container = DOM$9.get(self.editorContainer || self.id + '_parent');\n        }\n        return self.container;\n      };\n      Editor.prototype.getContentAreaContainer = function () {\n        return this.contentAreaContainer;\n      };\n      Editor.prototype.getElement = function () {\n        if (!this.targetElm) {\n          this.targetElm = DOM$9.get(this.id);\n        }\n        return this.targetElm;\n      };\n      Editor.prototype.getWin = function () {\n        var self = this;\n        var elm;\n        if (!self.contentWindow) {\n          elm = self.iframeElement;\n          if (elm) {\n            self.contentWindow = elm.contentWindow;\n          }\n        }\n        return self.contentWindow;\n      };\n      Editor.prototype.getDoc = function () {\n        var self = this;\n        var win;\n        if (!self.contentDocument) {\n          win = self.getWin();\n          if (win) {\n            self.contentDocument = win.document;\n          }\n        }\n        return self.contentDocument;\n      };\n      Editor.prototype.getBody = function () {\n        var doc = this.getDoc();\n        return this.bodyElement || (doc ? doc.body : null);\n      };\n      Editor.prototype.convertURL = function (url, name, elm) {\n        var self = this, settings = self.settings;\n        if (settings.urlconverter_callback) {\n          return self.execCallback('urlconverter_callback', url, elm, true, name);\n        }\n        if (!settings.convert_urls || elm && elm.nodeName === 'LINK' || url.indexOf('file:') === 0 || url.length === 0) {\n          return url;\n        }\n        if (settings.relative_urls) {\n          return self.documentBaseURI.toRelative(url);\n        }\n        url = self.documentBaseURI.toAbsolute(url, settings.remove_script_host);\n        return url;\n      };\n      Editor.prototype.addVisual = function (elm) {\n        var self = this;\n        var settings = self.settings;\n        var dom = self.dom;\n        var cls;\n        elm = elm || self.getBody();\n        if (self.hasVisual === undefined) {\n          self.hasVisual = settings.visual;\n        }\n        each$i(dom.select('table,a', elm), function (elm) {\n          var value;\n          switch (elm.nodeName) {\n          case 'TABLE':\n            cls = settings.visual_table_class || 'mce-item-table';\n            value = dom.getAttrib(elm, 'border');\n            if ((!value || value === '0') && self.hasVisual) {\n              dom.addClass(elm, cls);\n            } else {\n              dom.removeClass(elm, cls);\n            }\n            return;\n          case 'A':\n            if (!dom.getAttrib(elm, 'href')) {\n              value = dom.getAttrib(elm, 'name') || elm.id;\n              cls = settings.visual_anchor_class || 'mce-item-anchor';\n              if (value && self.hasVisual) {\n                dom.addClass(elm, cls);\n              } else {\n                dom.removeClass(elm, cls);\n              }\n            }\n            return;\n          }\n        });\n        self.fire('VisualAid', {\n          element: elm,\n          hasVisual: self.hasVisual\n        });\n      };\n      Editor.prototype.remove = function () {\n        remove$6(this);\n      };\n      Editor.prototype.destroy = function (automatic) {\n        destroy(this, automatic);\n      };\n      Editor.prototype.uploadImages = function (callback) {\n        return this.editorUpload.uploadImages(callback);\n      };\n      Editor.prototype._scanForImages = function () {\n        return this.editorUpload.scanForImages();\n      };\n      Editor.prototype.addButton = function () {\n        throw new Error('editor.addButton has been removed in tinymce 5x, use editor.ui.registry.addButton or editor.ui.registry.addToggleButton or editor.ui.registry.addSplitButton instead');\n      };\n      Editor.prototype.addSidebar = function () {\n        throw new Error('editor.addSidebar has been removed in tinymce 5x, use editor.ui.registry.addSidebar instead');\n      };\n      Editor.prototype.addMenuItem = function () {\n        throw new Error('editor.addMenuItem has been removed in tinymce 5x, use editor.ui.registry.addMenuItem instead');\n      };\n      Editor.prototype.addContextToolbar = function () {\n        throw new Error('editor.addContextToolbar has been removed in tinymce 5x, use editor.ui.registry.addContextToolbar instead');\n      };\n      return Editor;\n    }();\n\n    var DOM$a = DOMUtils$1.DOM;\n    var explode$4 = Tools.explode, each$j = Tools.each, extend$4 = Tools.extend;\n    var instanceCounter = 0, boundGlobalEvents = false;\n    var beforeUnloadDelegate;\n    var legacyEditors = [];\n    var editors = [];\n    var isValidLegacyKey = function (id) {\n      return id !== 'length';\n    };\n    var globalEventDelegate = function (e) {\n      var type = e.type;\n      each$j(EditorManager.get(), function (editor) {\n        switch (type) {\n        case 'scroll':\n          editor.fire('ScrollWindow', e);\n          break;\n        case 'resize':\n          editor.fire('ResizeWindow', e);\n          break;\n        }\n      });\n    };\n    var toggleGlobalEvents = function (state) {\n      if (state !== boundGlobalEvents) {\n        if (state) {\n          DomQuery(window).on('resize scroll', globalEventDelegate);\n        } else {\n          DomQuery(window).off('resize scroll', globalEventDelegate);\n        }\n        boundGlobalEvents = state;\n      }\n    };\n    var removeEditorFromList = function (targetEditor) {\n      var oldEditors = editors;\n      delete legacyEditors[targetEditor.id];\n      for (var i = 0; i < legacyEditors.length; i++) {\n        if (legacyEditors[i] === targetEditor) {\n          legacyEditors.splice(i, 1);\n          break;\n        }\n      }\n      editors = filter(editors, function (editor) {\n        return targetEditor !== editor;\n      });\n      if (EditorManager.activeEditor === targetEditor) {\n        EditorManager.activeEditor = editors.length > 0 ? editors[0] : null;\n      }\n      if (EditorManager.focusedEditor === targetEditor) {\n        EditorManager.focusedEditor = null;\n      }\n      return oldEditors.length !== editors.length;\n    };\n    var purgeDestroyedEditor = function (editor) {\n      if (editor && editor.initialized && !(editor.getContainer() || editor.getBody()).parentNode) {\n        removeEditorFromList(editor);\n        editor.unbindAllNativeEvents();\n        editor.destroy(true);\n        editor.removed = true;\n        editor = null;\n      }\n      return editor;\n    };\n    var isQuirksMode = domGlobals.document.compatMode !== 'CSS1Compat';\n    var EditorManager = __assign(__assign({}, Observable), {\n      baseURI: null,\n      baseURL: null,\n      defaultSettings: {},\n      documentBaseURL: null,\n      suffix: null,\n      $: DomQuery,\n      majorVersion: '5',\n      minorVersion: '2.0',\n      releaseDate: '2020-02-13',\n      editors: legacyEditors,\n      i18n: I18n,\n      activeEditor: null,\n      focusedEditor: null,\n      settings: {},\n      setup: function () {\n        var self = this;\n        var baseURL, documentBaseURL, suffix = '';\n        documentBaseURL = URI.getDocumentBaseUrl(domGlobals.document.location);\n        if (/^[^:]+:\\/\\/\\/?[^\\/]+\\//.test(documentBaseURL)) {\n          documentBaseURL = documentBaseURL.replace(/[\\?#].*$/, '').replace(/[\\/\\\\][^\\/]+$/, '');\n          if (!/[\\/\\\\]$/.test(documentBaseURL)) {\n            documentBaseURL += '/';\n          }\n        }\n        var preInit = window.tinymce || window.tinyMCEPreInit;\n        if (preInit) {\n          baseURL = preInit.base || preInit.baseURL;\n          suffix = preInit.suffix;\n        } else {\n          var scripts = domGlobals.document.getElementsByTagName('script');\n          for (var i = 0; i < scripts.length; i++) {\n            var src = scripts[i].src || '';\n            if (src === '') {\n              continue;\n            }\n            var srcScript = src.substring(src.lastIndexOf('/'));\n            if (/tinymce(\\.full|\\.jquery|)(\\.min|\\.dev|)\\.js/.test(src)) {\n              if (srcScript.indexOf('.min') !== -1) {\n                suffix = '.min';\n              }\n              baseURL = src.substring(0, src.lastIndexOf('/'));\n              break;\n            }\n          }\n          if (!baseURL && domGlobals.document.currentScript) {\n            var src = domGlobals.document.currentScript.src;\n            if (src.indexOf('.min') !== -1) {\n              suffix = '.min';\n            }\n            baseURL = src.substring(0, src.lastIndexOf('/'));\n          }\n        }\n        self.baseURL = new URI(documentBaseURL).toAbsolute(baseURL);\n        self.documentBaseURL = documentBaseURL;\n        self.baseURI = new URI(self.baseURL);\n        self.suffix = suffix;\n        FocusController.setup(self);\n      },\n      overrideDefaults: function (defaultSettings) {\n        var baseUrl, suffix;\n        baseUrl = defaultSettings.base_url;\n        if (baseUrl) {\n          this._setBaseUrl(baseUrl);\n        }\n        suffix = defaultSettings.suffix;\n        if (defaultSettings.suffix) {\n          this.suffix = suffix;\n        }\n        this.defaultSettings = defaultSettings;\n        var pluginBaseUrls = defaultSettings.plugin_base_urls;\n        for (var name_1 in pluginBaseUrls) {\n          AddOnManager$1.PluginManager.urls[name_1] = pluginBaseUrls[name_1];\n        }\n      },\n      init: function (settings) {\n        var self = this;\n        var result, invalidInlineTargets;\n        invalidInlineTargets = Tools.makeMap('area base basefont br col frame hr img input isindex link meta param embed source wbr track ' + 'colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu', ' ');\n        var isInvalidInlineTarget = function (settings, elm) {\n          return settings.inline && elm.tagName.toLowerCase() in invalidInlineTargets;\n        };\n        var createId = function (elm) {\n          var id = elm.id;\n          if (!id) {\n            id = elm.name;\n            if (id && !DOM$a.get(id)) {\n              id = elm.name;\n            } else {\n              id = DOM$a.uniqueId();\n            }\n            elm.setAttribute('id', id);\n          }\n          return id;\n        };\n        var execCallback = function (name) {\n          var callback = settings[name];\n          if (!callback) {\n            return;\n          }\n          return callback.apply(self, Array.prototype.slice.call(arguments, 2));\n        };\n        var hasClass = function (elm, className) {\n          return className.constructor === RegExp ? className.test(elm.className) : DOM$a.hasClass(elm, className);\n        };\n        var findTargets = function (settings) {\n          var l, targets = [];\n          if (Env.browser.isIE() && Env.browser.version.major < 11) {\n            ErrorReporter.initError('TinyMCE does not support the browser you are using. For a list of supported' + ' browsers please see: https://www.tinymce.com/docs/get-started/system-requirements/');\n            return [];\n          } else if (isQuirksMode) {\n            ErrorReporter.initError('Failed to initialize the editor as the document is not in standards mode. ' + 'TinyMCE requires standards mode.');\n            return [];\n          }\n          if (settings.types) {\n            each$j(settings.types, function (type) {\n              targets = targets.concat(DOM$a.select(type.selector));\n            });\n            return targets;\n          } else if (settings.selector) {\n            return DOM$a.select(settings.selector);\n          } else if (settings.target) {\n            return [settings.target];\n          }\n          switch (settings.mode) {\n          case 'exact':\n            l = settings.elements || '';\n            if (l.length > 0) {\n              each$j(explode$4(l), function (id) {\n                var elm;\n                if (elm = DOM$a.get(id)) {\n                  targets.push(elm);\n                } else {\n                  each$j(domGlobals.document.forms, function (f) {\n                    each$j(f.elements, function (e) {\n                      if (e.name === id) {\n                        id = 'mce_editor_' + instanceCounter++;\n                        DOM$a.setAttrib(e, 'id', id);\n                        targets.push(e);\n                      }\n                    });\n                  });\n                }\n              });\n            }\n            break;\n          case 'textareas':\n          case 'specific_textareas':\n            each$j(DOM$a.select('textarea'), function (elm) {\n              if (settings.editor_deselector && hasClass(elm, settings.editor_deselector)) {\n                return;\n              }\n              if (!settings.editor_selector || hasClass(elm, settings.editor_selector)) {\n                targets.push(elm);\n              }\n            });\n            break;\n          }\n          return targets;\n        };\n        var provideResults = function (editors) {\n          result = editors;\n        };\n        var initEditors = function () {\n          var initCount = 0;\n          var editors = [];\n          var targets;\n          var createEditor = function (id, settings, targetElm) {\n            var editor = new Editor(id, settings, self);\n            editors.push(editor);\n            editor.on('init', function () {\n              if (++initCount === targets.length) {\n                provideResults(editors);\n              }\n            });\n            editor.targetElm = editor.targetElm || targetElm;\n            editor.render();\n          };\n          DOM$a.unbind(window, 'ready', initEditors);\n          execCallback('onpageload');\n          targets = DomQuery.unique(findTargets(settings));\n          if (settings.types) {\n            each$j(settings.types, function (type) {\n              Tools.each(targets, function (elm) {\n                if (DOM$a.is(elm, type.selector)) {\n                  createEditor(createId(elm), extend$4({}, settings, type), elm);\n                  return false;\n                }\n                return true;\n              });\n            });\n            return;\n          }\n          Tools.each(targets, function (elm) {\n            purgeDestroyedEditor(self.get(elm.id));\n          });\n          targets = Tools.grep(targets, function (elm) {\n            return !self.get(elm.id);\n          });\n          if (targets.length === 0) {\n            provideResults([]);\n          } else {\n            each$j(targets, function (elm) {\n              if (isInvalidInlineTarget(settings, elm)) {\n                ErrorReporter.initError('Could not initialize inline editor on invalid inline target element', elm);\n              } else {\n                createEditor(createId(elm), settings, elm);\n              }\n            });\n          }\n        };\n        self.settings = settings;\n        DOM$a.bind(window, 'ready', initEditors);\n        return new promiseObj(function (resolve) {\n          if (result) {\n            resolve(result);\n          } else {\n            provideResults = function (editors) {\n              resolve(editors);\n            };\n          }\n        });\n      },\n      get: function (id) {\n        if (arguments.length === 0) {\n          return editors.slice(0);\n        } else if (isString(id)) {\n          return find(editors, function (editor) {\n            return editor.id === id;\n          }).getOr(null);\n        } else if (isNumber(id)) {\n          return editors[id] ? editors[id] : null;\n        } else {\n          return null;\n        }\n      },\n      add: function (editor) {\n        var self = this;\n        var existingEditor;\n        existingEditor = legacyEditors[editor.id];\n        if (existingEditor === editor) {\n          return editor;\n        }\n        if (self.get(editor.id) === null) {\n          if (isValidLegacyKey(editor.id)) {\n            legacyEditors[editor.id] = editor;\n          }\n          legacyEditors.push(editor);\n          editors.push(editor);\n        }\n        toggleGlobalEvents(true);\n        self.activeEditor = editor;\n        self.fire('AddEditor', { editor: editor });\n        if (!beforeUnloadDelegate) {\n          beforeUnloadDelegate = function (e) {\n            var event = self.fire('BeforeUnload');\n            if (event.returnValue) {\n              e.preventDefault();\n              e.returnValue = event.returnValue;\n              return event.returnValue;\n            }\n          };\n          window.addEventListener('beforeunload', beforeUnloadDelegate);\n        }\n        return editor;\n      },\n      createEditor: function (id, settings) {\n        return this.add(new Editor(id, settings, this));\n      },\n      remove: function (selector) {\n        var self = this;\n        var i, editor;\n        if (!selector) {\n          for (i = editors.length - 1; i >= 0; i--) {\n            self.remove(editors[i]);\n          }\n          return;\n        }\n        if (isString(selector)) {\n          each$j(DOM$a.select(selector), function (elm) {\n            editor = self.get(elm.id);\n            if (editor) {\n              self.remove(editor);\n            }\n          });\n          return;\n        }\n        editor = selector;\n        if (isNull(self.get(editor.id))) {\n          return null;\n        }\n        if (removeEditorFromList(editor)) {\n          self.fire('RemoveEditor', { editor: editor });\n        }\n        if (editors.length === 0) {\n          window.removeEventListener('beforeunload', beforeUnloadDelegate);\n        }\n        editor.remove();\n        toggleGlobalEvents(editors.length > 0);\n        return editor;\n      },\n      execCommand: function (cmd, ui, value) {\n        var self = this, editor = self.get(value);\n        switch (cmd) {\n        case 'mceAddEditor':\n          if (!self.get(value)) {\n            new Editor(value, self.settings, self).render();\n          }\n          return true;\n        case 'mceRemoveEditor':\n          if (editor) {\n            editor.remove();\n          }\n          return true;\n        case 'mceToggleEditor':\n          if (!editor) {\n            self.execCommand('mceAddEditor', 0, value);\n            return true;\n          }\n          if (editor.isHidden()) {\n            editor.show();\n          } else {\n            editor.hide();\n          }\n          return true;\n        }\n        if (self.activeEditor) {\n          return self.activeEditor.execCommand(cmd, ui, value);\n        }\n        return false;\n      },\n      triggerSave: function () {\n        each$j(editors, function (editor) {\n          editor.save();\n        });\n      },\n      addI18n: function (code, items) {\n        I18n.add(code, items);\n      },\n      translate: function (text) {\n        return I18n.translate(text);\n      },\n      setActive: function (editor) {\n        var activeEditor = this.activeEditor;\n        if (this.activeEditor !== editor) {\n          if (activeEditor) {\n            activeEditor.fire('deactivate', { relatedTarget: editor });\n          }\n          editor.fire('activate', { relatedTarget: activeEditor });\n        }\n        this.activeEditor = editor;\n      },\n      _setBaseUrl: function (baseUrl) {\n        this.baseURL = new URI(this.documentBaseURL).toAbsolute(baseUrl.replace(/\\/+$/, ''));\n        this.baseURI = new URI(this.baseURL);\n      }\n    });\n    EditorManager.setup();\n\n    function RangeUtils(dom) {\n      var walk = function (rng, callback) {\n        return RangeWalk.walk(dom, rng, callback);\n      };\n      var split = split$1;\n      var normalize = function (rng) {\n        return NormalizeRange.normalize(dom, rng).fold(constant(false), function (normalizedRng) {\n          rng.setStart(normalizedRng.startContainer, normalizedRng.startOffset);\n          rng.setEnd(normalizedRng.endContainer, normalizedRng.endOffset);\n          return true;\n        });\n      };\n      return {\n        walk: walk,\n        split: split,\n        normalize: normalize\n      };\n    }\n    (function (RangeUtils) {\n      RangeUtils.compareRanges = RangeCompare.isEq;\n      RangeUtils.getCaretRangeFromPoint = CaretRangeFromPoint.fromPoint;\n      RangeUtils.getSelectedNode = getSelectedNode;\n      RangeUtils.getNode = getNode;\n    }(RangeUtils || (RangeUtils = {})));\n    var RangeUtils$1 = RangeUtils;\n\n    var awaiter = function (resolveCb, rejectCb, timeout) {\n      if (timeout === void 0) {\n        timeout = 1000;\n      }\n      var done = false;\n      var timer = null;\n      var complete = function (completer) {\n        return function () {\n          var args = [];\n          for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n          }\n          if (!done) {\n            done = true;\n            if (timer !== null) {\n              domGlobals.clearTimeout(timer);\n              timer = null;\n            }\n            completer.apply(null, args);\n          }\n        };\n      };\n      var resolve = complete(resolveCb);\n      var reject = complete(rejectCb);\n      var start = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (!done && timer === null) {\n          timer = domGlobals.setTimeout(function () {\n            return reject.apply(null, args);\n          }, timeout);\n        }\n      };\n      return {\n        start: start,\n        resolve: resolve,\n        reject: reject\n      };\n    };\n    var create$6 = function () {\n      var tasks = {};\n      var resultFns = {};\n      var load = function (id, url) {\n        var loadErrMsg = 'Script at URL \"' + url + '\" failed to load';\n        var runErrMsg = 'Script at URL \"' + url + '\" did not call `tinymce.Resource.add(\\'' + id + '\\', data)` within 1 second';\n        if (tasks[id] !== undefined) {\n          return tasks[id];\n        } else {\n          var task = new promiseObj(function (resolve, reject) {\n            var waiter = awaiter(resolve, reject);\n            resultFns[id] = waiter.resolve;\n            ScriptLoader.ScriptLoader.loadScript(url, function () {\n              return waiter.start(runErrMsg);\n            }, function () {\n              return waiter.reject(loadErrMsg);\n            });\n          });\n          tasks[id] = task;\n          return task;\n        }\n      };\n      var add = function (id, data) {\n        if (resultFns[id] !== undefined) {\n          resultFns[id](data);\n          delete resultFns[id];\n        }\n        tasks[id] = promiseObj.resolve(data);\n      };\n      return {\n        load: load,\n        add: add\n      };\n    };\n    var Resource = create$6();\n\n    var min = Math.min, max = Math.max, round$2 = Math.round;\n    var relativePosition = function (rect, targetRect, rel) {\n      var x, y, w, h, targetW, targetH;\n      x = targetRect.x;\n      y = targetRect.y;\n      w = rect.w;\n      h = rect.h;\n      targetW = targetRect.w;\n      targetH = targetRect.h;\n      rel = (rel || '').split('');\n      if (rel[0] === 'b') {\n        y += targetH;\n      }\n      if (rel[1] === 'r') {\n        x += targetW;\n      }\n      if (rel[0] === 'c') {\n        y += round$2(targetH / 2);\n      }\n      if (rel[1] === 'c') {\n        x += round$2(targetW / 2);\n      }\n      if (rel[3] === 'b') {\n        y -= h;\n      }\n      if (rel[4] === 'r') {\n        x -= w;\n      }\n      if (rel[3] === 'c') {\n        y -= round$2(h / 2);\n      }\n      if (rel[4] === 'c') {\n        x -= round$2(w / 2);\n      }\n      return create$7(x, y, w, h);\n    };\n    var findBestRelativePosition = function (rect, targetRect, constrainRect, rels) {\n      var pos, i;\n      for (i = 0; i < rels.length; i++) {\n        pos = relativePosition(rect, targetRect, rels[i]);\n        if (pos.x >= constrainRect.x && pos.x + pos.w <= constrainRect.w + constrainRect.x && pos.y >= constrainRect.y && pos.y + pos.h <= constrainRect.h + constrainRect.y) {\n          return rels[i];\n        }\n      }\n      return null;\n    };\n    var inflate = function (rect, w, h) {\n      return create$7(rect.x - w, rect.y - h, rect.w + w * 2, rect.h + h * 2);\n    };\n    var intersect = function (rect, cropRect) {\n      var x1, y1, x2, y2;\n      x1 = max(rect.x, cropRect.x);\n      y1 = max(rect.y, cropRect.y);\n      x2 = min(rect.x + rect.w, cropRect.x + cropRect.w);\n      y2 = min(rect.y + rect.h, cropRect.y + cropRect.h);\n      if (x2 - x1 < 0 || y2 - y1 < 0) {\n        return null;\n      }\n      return create$7(x1, y1, x2 - x1, y2 - y1);\n    };\n    var clamp$1 = function (rect, clampRect, fixedSize) {\n      var underflowX1, underflowY1, overflowX2, overflowY2, x1, y1, x2, y2, cx2, cy2;\n      x1 = rect.x;\n      y1 = rect.y;\n      x2 = rect.x + rect.w;\n      y2 = rect.y + rect.h;\n      cx2 = clampRect.x + clampRect.w;\n      cy2 = clampRect.y + clampRect.h;\n      underflowX1 = max(0, clampRect.x - x1);\n      underflowY1 = max(0, clampRect.y - y1);\n      overflowX2 = max(0, x2 - cx2);\n      overflowY2 = max(0, y2 - cy2);\n      x1 += underflowX1;\n      y1 += underflowY1;\n      if (fixedSize) {\n        x2 += underflowX1;\n        y2 += underflowY1;\n        x1 -= overflowX2;\n        y1 -= overflowY2;\n      }\n      x2 -= overflowX2;\n      y2 -= overflowY2;\n      return create$7(x1, y1, x2 - x1, y2 - y1);\n    };\n    var create$7 = function (x, y, w, h) {\n      return {\n        x: x,\n        y: y,\n        w: w,\n        h: h\n      };\n    };\n    var fromClientRect = function (clientRect) {\n      return create$7(clientRect.left, clientRect.top, clientRect.width, clientRect.height);\n    };\n    var Rect = {\n      inflate: inflate,\n      relativePosition: relativePosition,\n      findBestRelativePosition: findBestRelativePosition,\n      intersect: intersect,\n      clamp: clamp$1,\n      create: create$7,\n      fromClientRect: fromClientRect\n    };\n\n    var each$k = Tools.each, extend$5 = Tools.extend;\n    var extendClass, initializing;\n    var Class = function () {\n    };\n    Class.extend = extendClass = function (prop) {\n      var self = this;\n      var _super = self.prototype;\n      var prototype, name, member;\n      var Class = function () {\n        var i, mixins, mixin;\n        var self = this;\n        if (!initializing) {\n          if (self.init) {\n            self.init.apply(self, arguments);\n          }\n          mixins = self.Mixins;\n          if (mixins) {\n            i = mixins.length;\n            while (i--) {\n              mixin = mixins[i];\n              if (mixin.init) {\n                mixin.init.apply(self, arguments);\n              }\n            }\n          }\n        }\n      };\n      var dummy = function () {\n        return this;\n      };\n      var createMethod = function (name, fn) {\n        return function () {\n          var self = this;\n          var tmp = self._super;\n          var ret;\n          self._super = _super[name];\n          ret = fn.apply(self, arguments);\n          self._super = tmp;\n          return ret;\n        };\n      };\n      initializing = true;\n      prototype = new self();\n      initializing = false;\n      if (prop.Mixins) {\n        each$k(prop.Mixins, function (mixin) {\n          for (var name_1 in mixin) {\n            if (name_1 !== 'init') {\n              prop[name_1] = mixin[name_1];\n            }\n          }\n        });\n        if (_super.Mixins) {\n          prop.Mixins = _super.Mixins.concat(prop.Mixins);\n        }\n      }\n      if (prop.Methods) {\n        each$k(prop.Methods.split(','), function (name) {\n          prop[name] = dummy;\n        });\n      }\n      if (prop.Properties) {\n        each$k(prop.Properties.split(','), function (name) {\n          var fieldName = '_' + name;\n          prop[name] = function (value) {\n            var self = this;\n            if (value !== undefined) {\n              self[fieldName] = value;\n              return self;\n            }\n            return self[fieldName];\n          };\n        });\n      }\n      if (prop.Statics) {\n        each$k(prop.Statics, function (func, name) {\n          Class[name] = func;\n        });\n      }\n      if (prop.Defaults && _super.Defaults) {\n        prop.Defaults = extend$5({}, _super.Defaults, prop.Defaults);\n      }\n      for (name in prop) {\n        member = prop[name];\n        if (typeof member === 'function' && _super[name]) {\n          prototype[name] = createMethod(name, member);\n        } else {\n          prototype[name] = member;\n        }\n      }\n      Class.prototype = prototype;\n      Class.constructor = Class;\n      Class.extend = extendClass;\n      return Class;\n    };\n\n    var min$1 = Math.min, max$1 = Math.max, round$3 = Math.round;\n    var Color = function (value) {\n      var self = {};\n      var r = 0, g = 0, b = 0;\n      var rgb2hsv = function (r, g, b) {\n        var h, s, v, d, minRGB, maxRGB;\n        h = 0;\n        s = 0;\n        v = 0;\n        r = r / 255;\n        g = g / 255;\n        b = b / 255;\n        minRGB = min$1(r, min$1(g, b));\n        maxRGB = max$1(r, max$1(g, b));\n        if (minRGB === maxRGB) {\n          v = minRGB;\n          return {\n            h: 0,\n            s: 0,\n            v: v * 100\n          };\n        }\n        d = r === minRGB ? g - b : b === minRGB ? r - g : b - r;\n        h = r === minRGB ? 3 : b === minRGB ? 1 : 5;\n        h = 60 * (h - d / (maxRGB - minRGB));\n        s = (maxRGB - minRGB) / maxRGB;\n        v = maxRGB;\n        return {\n          h: round$3(h),\n          s: round$3(s * 100),\n          v: round$3(v * 100)\n        };\n      };\n      var hsvToRgb = function (hue, saturation, brightness) {\n        var side, chroma, x, match;\n        hue = (parseInt(hue, 10) || 0) % 360;\n        saturation = parseInt(saturation, 10) / 100;\n        brightness = parseInt(brightness, 10) / 100;\n        saturation = max$1(0, min$1(saturation, 1));\n        brightness = max$1(0, min$1(brightness, 1));\n        if (saturation === 0) {\n          r = g = b = round$3(255 * brightness);\n          return;\n        }\n        side = hue / 60;\n        chroma = brightness * saturation;\n        x = chroma * (1 - Math.abs(side % 2 - 1));\n        match = brightness - chroma;\n        switch (Math.floor(side)) {\n        case 0:\n          r = chroma;\n          g = x;\n          b = 0;\n          break;\n        case 1:\n          r = x;\n          g = chroma;\n          b = 0;\n          break;\n        case 2:\n          r = 0;\n          g = chroma;\n          b = x;\n          break;\n        case 3:\n          r = 0;\n          g = x;\n          b = chroma;\n          break;\n        case 4:\n          r = x;\n          g = 0;\n          b = chroma;\n          break;\n        case 5:\n          r = chroma;\n          g = 0;\n          b = x;\n          break;\n        default:\n          r = g = b = 0;\n        }\n        r = round$3(255 * (r + match));\n        g = round$3(255 * (g + match));\n        b = round$3(255 * (b + match));\n      };\n      var toHex = function () {\n        var hex = function (val) {\n          val = parseInt(val, 10).toString(16);\n          return val.length > 1 ? val : '0' + val;\n        };\n        return '#' + hex(r) + hex(g) + hex(b);\n      };\n      var toRgb = function () {\n        return {\n          r: r,\n          g: g,\n          b: b\n        };\n      };\n      var toHsv = function () {\n        return rgb2hsv(r, g, b);\n      };\n      var parse = function (value) {\n        var matches;\n        if (typeof value === 'object') {\n          if ('r' in value) {\n            r = value.r;\n            g = value.g;\n            b = value.b;\n          } else if ('v' in value) {\n            hsvToRgb(value.h, value.s, value.v);\n          }\n        } else {\n          if (matches = /rgb\\s*\\(\\s*([0-9]+)\\s*,\\s*([0-9]+)\\s*,\\s*([0-9]+)[^\\)]*\\)/gi.exec(value)) {\n            r = parseInt(matches[1], 10);\n            g = parseInt(matches[2], 10);\n            b = parseInt(matches[3], 10);\n          } else if (matches = /#([0-F]{2})([0-F]{2})([0-F]{2})/gi.exec(value)) {\n            r = parseInt(matches[1], 16);\n            g = parseInt(matches[2], 16);\n            b = parseInt(matches[3], 16);\n          } else if (matches = /#([0-F])([0-F])([0-F])/gi.exec(value)) {\n            r = parseInt(matches[1] + matches[1], 16);\n            g = parseInt(matches[2] + matches[2], 16);\n            b = parseInt(matches[3] + matches[3], 16);\n          }\n        }\n        r = r < 0 ? 0 : r > 255 ? 255 : r;\n        g = g < 0 ? 0 : g > 255 ? 255 : g;\n        b = b < 0 ? 0 : b > 255 ? 255 : b;\n        return self;\n      };\n      if (value) {\n        parse(value);\n      }\n      self.toRgb = toRgb;\n      self.toHsv = toHsv;\n      self.toHex = toHex;\n      self.parse = parse;\n      return self;\n    };\n\n    var serialize = function (obj) {\n      var data = JSON.stringify(obj);\n      if (!isString(data)) {\n        return data;\n      }\n      return data.replace(/[\\u0080-\\uFFFF]/g, function (match) {\n        var hexCode = match.charCodeAt(0).toString(16);\n        return '\\\\u' + '0000'.substring(hexCode.length) + hexCode;\n      });\n    };\n    var JSONUtils = {\n      serialize: serialize,\n      parse: function (text) {\n        try {\n          return JSON.parse(text);\n        } catch (ex) {\n        }\n      }\n    };\n\n    var JSONP = {\n      callbacks: {},\n      count: 0,\n      send: function (settings) {\n        var self = this, dom = DOMUtils$1.DOM, count = settings.count !== undefined ? settings.count : self.count;\n        var id = 'tinymce_jsonp_' + count;\n        self.callbacks[count] = function (json) {\n          dom.remove(id);\n          delete self.callbacks[count];\n          settings.callback(json);\n        };\n        dom.add(dom.doc.body, 'script', {\n          id: id,\n          src: settings.url,\n          type: 'text/javascript'\n        });\n        self.count++;\n      }\n    };\n\n    var XHR = __assign(__assign({}, Observable), {\n      send: function (settings) {\n        var xhr, count = 0;\n        var ready = function () {\n          if (!settings.async || xhr.readyState === 4 || count++ > 10000) {\n            if (settings.success && count < 10000 && xhr.status === 200) {\n              settings.success.call(settings.success_scope, '' + xhr.responseText, xhr, settings);\n            } else if (settings.error) {\n              settings.error.call(settings.error_scope, count > 10000 ? 'TIMED_OUT' : 'GENERAL', xhr, settings);\n            }\n            xhr = null;\n          } else {\n            Delay.setTimeout(ready, 10);\n          }\n        };\n        settings.scope = settings.scope || this;\n        settings.success_scope = settings.success_scope || settings.scope;\n        settings.error_scope = settings.error_scope || settings.scope;\n        settings.async = settings.async !== false;\n        settings.data = settings.data || '';\n        XHR.fire('beforeInitialize', { settings: settings });\n        xhr = new domGlobals.XMLHttpRequest();\n        if (xhr) {\n          if (xhr.overrideMimeType) {\n            xhr.overrideMimeType(settings.content_type);\n          }\n          xhr.open(settings.type || (settings.data ? 'POST' : 'GET'), settings.url, settings.async);\n          if (settings.crossDomain) {\n            xhr.withCredentials = true;\n          }\n          if (settings.content_type) {\n            xhr.setRequestHeader('Content-Type', settings.content_type);\n          }\n          if (settings.requestheaders) {\n            Tools.each(settings.requestheaders, function (header) {\n              xhr.setRequestHeader(header.key, header.value);\n            });\n          }\n          xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n          xhr = XHR.fire('beforeSend', {\n            xhr: xhr,\n            settings: settings\n          }).xhr;\n          xhr.send(settings.data);\n          if (!settings.async) {\n            return ready();\n          }\n          Delay.setTimeout(ready, 10);\n        }\n      }\n    });\n\n    var extend$6 = Tools.extend;\n    var JSONRequest = function () {\n      function JSONRequest(settings) {\n        this.settings = extend$6({}, settings);\n        this.count = 0;\n      }\n      JSONRequest.sendRPC = function (o) {\n        return new JSONRequest().send(o);\n      };\n      JSONRequest.prototype.send = function (args) {\n        var ecb = args.error, scb = args.success;\n        var xhrArgs = extend$6(this.settings, args);\n        xhrArgs.success = function (c, x) {\n          c = JSONUtils.parse(c);\n          if (typeof c === 'undefined') {\n            c = { error: 'JSON Parse error.' };\n          }\n          if (c.error) {\n            ecb.call(xhrArgs.error_scope || xhrArgs.scope, c.error, x);\n          } else {\n            scb.call(xhrArgs.success_scope || xhrArgs.scope, c.result);\n          }\n        };\n        xhrArgs.error = function (ty, x) {\n          if (ecb) {\n            ecb.call(xhrArgs.error_scope || xhrArgs.scope, ty, x);\n          }\n        };\n        xhrArgs.data = JSONUtils.serialize({\n          id: args.id || 'c' + this.count++,\n          method: args.method,\n          params: args.params\n        });\n        xhrArgs.content_type = 'application/json';\n        XHR.send(xhrArgs);\n      };\n      return JSONRequest;\n    }();\n\n    var create$8 = function () {\n      return function () {\n        var data = {};\n        var keys = [];\n        var storage = {\n          getItem: function (key) {\n            var item = data[key];\n            return item ? item : null;\n          },\n          setItem: function (key, value) {\n            keys.push(key);\n            data[key] = String(value);\n          },\n          key: function (index) {\n            return keys[index];\n          },\n          removeItem: function (key) {\n            keys = keys.filter(function (k) {\n              return k === key;\n            });\n            delete data[key];\n          },\n          clear: function () {\n            keys = [];\n            data = {};\n          },\n          length: 0\n        };\n        Object.defineProperty(storage, 'length', {\n          get: function () {\n            return keys.length;\n          },\n          configurable: false,\n          enumerable: false\n        });\n        return storage;\n      }();\n    };\n\n    var localStorage;\n    try {\n      localStorage = domGlobals.window.localStorage;\n    } catch (e) {\n      localStorage = create$8();\n    }\n    var LocalStorage = localStorage;\n\n    var publicApi = {\n      geom: { Rect: Rect },\n      util: {\n        Promise: promiseObj,\n        Delay: Delay,\n        Tools: Tools,\n        VK: VK,\n        URI: URI,\n        Class: Class,\n        EventDispatcher: EventDispatcher,\n        Observable: Observable,\n        I18n: I18n,\n        XHR: XHR,\n        JSON: JSONUtils,\n        JSONRequest: JSONRequest,\n        JSONP: JSONP,\n        LocalStorage: LocalStorage,\n        Color: Color\n      },\n      dom: {\n        EventUtils: EventUtils,\n        Sizzle: Sizzle,\n        DomQuery: DomQuery,\n        TreeWalker: TreeWalker,\n        TextSeeker: TextSeeker,\n        DOMUtils: DOMUtils$1,\n        ScriptLoader: ScriptLoader,\n        RangeUtils: RangeUtils$1,\n        Serializer: Serializer$1,\n        ControlSelection: ControlSelection,\n        BookmarkManager: BookmarkManager$1,\n        Selection: Selection$1,\n        Event: EventUtils.Event\n      },\n      html: {\n        Styles: Styles,\n        Entities: Entities,\n        Node: Node$1,\n        Schema: Schema,\n        SaxParser: SaxParser$1,\n        DomParser: DomParser,\n        Writer: Writer,\n        Serializer: Serializer\n      },\n      Env: Env,\n      AddOnManager: AddOnManager$1,\n      Annotator: Annotator,\n      Formatter: Formatter,\n      UndoManager: UndoManager,\n      EditorCommands: EditorCommands,\n      WindowManager: WindowManager,\n      NotificationManager: NotificationManager,\n      EditorObservable: EditorObservable,\n      Shortcuts: Shortcuts,\n      Editor: Editor,\n      FocusManager: FocusManager,\n      EditorManager: EditorManager,\n      DOM: DOMUtils$1.DOM,\n      ScriptLoader: ScriptLoader.ScriptLoader,\n      PluginManager: AddOnManager$1.PluginManager,\n      ThemeManager: AddOnManager$1.ThemeManager,\n      IconManager: IconManager,\n      Resource: Resource,\n      trim: Tools.trim,\n      isArray: Tools.isArray,\n      is: Tools.is,\n      toArray: Tools.toArray,\n      makeMap: Tools.makeMap,\n      each: Tools.each,\n      map: Tools.map,\n      grep: Tools.grep,\n      inArray: Tools.inArray,\n      extend: Tools.extend,\n      create: Tools.create,\n      walk: Tools.walk,\n      createNS: Tools.createNS,\n      resolve: Tools.resolve,\n      explode: Tools.explode,\n      _addCacheSuffix: Tools._addCacheSuffix,\n      isOpera: Env.opera,\n      isWebKit: Env.webkit,\n      isIE: Env.ie,\n      isGecko: Env.gecko,\n      isMac: Env.mac\n    };\n    var tinymce = Tools.extend(EditorManager, publicApi);\n\n    var exportToModuleLoaders = function (tinymce) {\n      if (true) {\n        try {\n          module.exports = tinymce;\n        } catch (_) {\n        }\n      }\n    };\n    var exportToWindowGlobal = function (tinymce) {\n      window.tinymce = tinymce;\n      window.tinyMCE = tinymce;\n    };\n    exportToWindowGlobal(tinymce);\n    exportToModuleLoaders(tinymce);\n\n}(window));\n\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(95)))\n\n/***/ }),\n\n/***/ 7:\n/***/ (function(module, exports, __webpack_require__) {\n\n!function(globals) {\n'use strict'\n\nvar _imports = {}\n\nif (typeof module !== 'undefined' && module.exports) { //CommonJS\n  _imports.bytesToHex = __webpack_require__(98).bytesToHex\n  _imports.convertString = __webpack_require__(99)\n  module.exports = sha256\n} else {\n  _imports.bytesToHex = globals.convertHex.bytesToHex\n  _imports.convertString = globals.convertString\n  globals.sha256 = sha256\n}\n\n/*\nCryptoJS v3.1.2\ncode.google.com/p/crypto-js\n(c) 2009-2013 by Jeff Mott. All rights reserved.\ncode.google.com/p/crypto-js/wiki/License\n*/\n\n// Initialization round constants tables\nvar K = []\n\n// Compute constants\n!function () {\n  function isPrime(n) {\n    var sqrtN = Math.sqrt(n);\n    for (var factor = 2; factor <= sqrtN; factor++) {\n      if (!(n % factor)) return false\n    }\n\n    return true\n  }\n\n  function getFractionalBits(n) {\n    return ((n - (n | 0)) * 0x100000000) | 0\n  }\n\n  var n = 2\n  var nPrime = 0\n  while (nPrime < 64) {\n    if (isPrime(n)) {\n      K[nPrime] = getFractionalBits(Math.pow(n, 1 / 3))\n      nPrime++\n    }\n\n    n++\n  }\n}()\n\nvar bytesToWords = function (bytes) {\n  var words = []\n  for (var i = 0, b = 0; i < bytes.length; i++, b += 8) {\n    words[b >>> 5] |= bytes[i] << (24 - b % 32)\n  }\n  return words\n}\n\nvar wordsToBytes = function (words) {\n  var bytes = []\n  for (var b = 0; b < words.length * 32; b += 8) {\n    bytes.push((words[b >>> 5] >>> (24 - b % 32)) & 0xFF)\n  }\n  return bytes\n}\n\n// Reusable object\nvar W = []\n\nvar processBlock = function (H, M, offset) {\n  // Working variables\n  var a = H[0], b = H[1], c = H[2], d = H[3]\n  var e = H[4], f = H[5], g = H[6], h = H[7]\n\n    // Computation\n  for (var i = 0; i < 64; i++) {\n    if (i < 16) {\n      W[i] = M[offset + i] | 0\n    } else {\n      var gamma0x = W[i - 15]\n      var gamma0  = ((gamma0x << 25) | (gamma0x >>> 7))  ^\n                    ((gamma0x << 14) | (gamma0x >>> 18)) ^\n                    (gamma0x >>> 3)\n\n      var gamma1x = W[i - 2];\n      var gamma1  = ((gamma1x << 15) | (gamma1x >>> 17)) ^\n                    ((gamma1x << 13) | (gamma1x >>> 19)) ^\n                    (gamma1x >>> 10)\n\n      W[i] = gamma0 + W[i - 7] + gamma1 + W[i - 16];\n    }\n\n    var ch  = (e & f) ^ (~e & g);\n    var maj = (a & b) ^ (a & c) ^ (b & c);\n\n    var sigma0 = ((a << 30) | (a >>> 2)) ^ ((a << 19) | (a >>> 13)) ^ ((a << 10) | (a >>> 22));\n    var sigma1 = ((e << 26) | (e >>> 6)) ^ ((e << 21) | (e >>> 11)) ^ ((e << 7)  | (e >>> 25));\n\n    var t1 = h + sigma1 + ch + K[i] + W[i];\n    var t2 = sigma0 + maj;\n\n    h = g;\n    g = f;\n    f = e;\n    e = (d + t1) | 0;\n    d = c;\n    c = b;\n    b = a;\n    a = (t1 + t2) | 0;\n  }\n\n  // Intermediate hash value\n  H[0] = (H[0] + a) | 0;\n  H[1] = (H[1] + b) | 0;\n  H[2] = (H[2] + c) | 0;\n  H[3] = (H[3] + d) | 0;\n  H[4] = (H[4] + e) | 0;\n  H[5] = (H[5] + f) | 0;\n  H[6] = (H[6] + g) | 0;\n  H[7] = (H[7] + h) | 0;\n}\n\nfunction sha256(message, options) {;\n  if (message.constructor === String) {\n    message = _imports.convertString.UTF8.stringToBytes(message);\n  }\n\n  var H =[ 0x6A09E667, 0xBB67AE85, 0x3C6EF372, 0xA54FF53A,\n           0x510E527F, 0x9B05688C, 0x1F83D9AB, 0x5BE0CD19 ];\n\n  var m = bytesToWords(message);\n  var l = message.length * 8;\n\n  m[l >> 5] |= 0x80 << (24 - l % 32);\n  m[((l + 64 >> 9) << 4) + 15] = l;\n\n  for (var i=0 ; i<m.length; i += 16) {\n    processBlock(H, m, i);\n  }\n\n  var digestbytes = wordsToBytes(H);\n  return options && options.asBytes ? digestbytes :\n         options && options.asString ? _imports.convertString.bytesToString(digestbytes) :\n         _imports.bytesToHex(digestbytes)\n}\n\nsha256.x2 = function(message, options) {\n  return sha256(sha256(message, { asBytes:true }), options)\n}\n\n}(this);\n\n\n/***/ }),\n\n/***/ 98:\n/***/ (function(module, exports) {\n\n!function(globals) {\n'use strict'\n\nvar convertHex = {\n  bytesToHex: function(bytes) {\n    /*if (typeof bytes.byteLength != 'undefined') {\n      var newBytes = []\n\n      if (typeof bytes.buffer != 'undefined')\n        bytes = new DataView(bytes.buffer)\n      else\n        bytes = new DataView(bytes)\n\n      for (var i = 0; i < bytes.byteLength; ++i) {\n        newBytes.push(bytes.getUint8(i))\n      }\n      bytes = newBytes\n    }*/\n    return arrBytesToHex(bytes)\n  },\n  hexToBytes: function(hex) {\n    if (hex.length % 2 === 1) throw new Error(\"hexToBytes can't have a string with an odd number of characters.\")\n    if (hex.indexOf('0x') === 0) hex = hex.slice(2)\n    return hex.match(/../g).map(function(x) { return parseInt(x,16) })\n  }\n}\n\n\n// PRIVATE\n\nfunction arrBytesToHex(bytes) {\n  return bytes.map(function(x) { return padLeft(x.toString(16),2) }).join('')\n}\n\nfunction padLeft(orig, len) {\n  if (orig.length > len) return orig\n  return Array(len - orig.length + 1).join('0') + orig\n}\n\n\nif (typeof module !== 'undefined' && module.exports) { //CommonJS\n  module.exports = convertHex\n} else {\n  globals.convertHex = convertHex\n}\n\n}(this);\n\n/***/ }),\n\n/***/ 99:\n/***/ (function(module, exports) {\n\n!function(globals) {\n'use strict'\n\nvar convertString = {\n  bytesToString: function(bytes) {\n    return bytes.map(function(x){ return String.fromCharCode(x) }).join('')\n  },\n  stringToBytes: function(str) {\n    return str.split('').map(function(x) { return x.charCodeAt(0) })\n  }\n}\n\n//http://hossa.in/2012/07/20/utf-8-in-javascript.html\nconvertString.UTF8 = {\n   bytesToString: function(bytes) {\n    return decodeURIComponent(escape(convertString.bytesToString(bytes)))\n  },\n  stringToBytes: function(str) {\n   return convertString.stringToBytes(unescape(encodeURIComponent(str)))\n  }\n}\n\nif (typeof module !== 'undefined' && module.exports) { //CommonJS\n  module.exports = convertString\n} else {\n  globals.convertString = convertString\n}\n\n}(this);\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// vendor.b548d56514f7d4ba28de.js","/**\n * ngTableExcelExport 1.0.0\n * JavaScript export to Excel or CSV from HTML tables automatically in the browser and also compatible with all browsers.\n *\n * @author: Murugavel Ramachandran (blsrm@yahoo.com)\n * @url: https://github.com/blsrm/ngTableExcelExport\n *\n */\n/*jslint browser: true, bitwise: true, vars: true, white: true */\n/*global define, exports, module */\n\n(function (global) {\n    'use strict';\n\nvar ExcellentExport = (function() {\n\n    function b64toBlob(b64Data, contentType, sliceSize) {\n        // function taken from http://stackoverflow.com/a/16245768/2591950\n        // author Jeremy Banks http://stackoverflow.com/users/1114/jeremy-banks\n        contentType = contentType || '';\n        sliceSize = sliceSize || 512;\n\n        var byteCharacters = window.atob(b64Data);\n        var byteArrays = [];\n\n        var offset;\n        for (offset = 0; offset < byteCharacters.length; offset += sliceSize) {\n            var slice = byteCharacters.slice(offset, offset + sliceSize);\n\n            var byteNumbers = new Array(slice.length);\n            var i;\n            for (i = 0; i < slice.length; i = i + 1) {\n                byteNumbers[i] = slice.charCodeAt(i);\n            }\n\n            var byteArray = new window.Uint8Array(byteNumbers);\n\n            byteArrays.push(byteArray);\n        }\n\n        var blob = new window.Blob(byteArrays, {\n            type: contentType\n        });\n        return blob;\n    }\n\n    var version = \"1.5.0\";\n    var uri = {excel: 'data:application/vnd.ms-excel;base64,', csv: 'data:application/csv;base64,'};\n    var template = {excel: '<html xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:x=\"urn:schemas-microsoft-com:office:excel\" xmlns=\"http://www.w3.org/TR/REC-html40\"><head><meta name=ProgId content=Excel.Sheet> <meta name=Generator content=\"Microsoft Excel 11\"><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table border=\"1\">{table}</table></body></html>'};\n    var csvDelimiter = \",\";\n    var csvNewLine = \"\\r\\n\";\n    var base64 = function(s) {\n        return window.btoa(window.unescape(encodeURIComponent(s)));\n    };\n    var format = function(s, c) {\n        return s.replace(new RegExp(\"{(\\\\w+)}\", \"g\"), function(m, p) {\n            return c[p];\n        });\n    };\n\n    var get = function(element) {\n        if (!element.nodeType) {\n            return document.getElementById(element);\n        }\n        return element;\n    };\n\n    var fixCSVField = function(value) {\n        var fixedValue = value;\n        var addQuotes = (value.indexOf(csvDelimiter) !== -1) || (value.indexOf('\\r') !== -1) || (value.indexOf('\\n') !== -1);\n        var replaceDoubleQuotes = (value.indexOf('\"') !== -1);\n\n        if (replaceDoubleQuotes) {\n            fixedValue = fixedValue.replace(/\"/g, '\"\"');\n        }\n        if (addQuotes || replaceDoubleQuotes) {\n            fixedValue = '\"' + fixedValue + '\"';\n        }\n\n        return fixedValue;\n    };\n\n    var tableToCSV = function(table) {\n        var data = \"SEP=\"+csvDelimiter+csvNewLine;\n        var i, j, row, col;\n        var columnStart = 0;\n        for (i = 0; i < table.rows.length; i=i+1) {\n            row = table.rows[i];\n            var rowData = '';\n            \n            //Checking ng table style for filters\n            if(row.className.indexOf('ng-table-filters') !== -1) {\n\t\t\t\tcontinue;\n            }\n            \n            //remove first column having check box in angular JS, in future will provide option from UI to control\n            if(table.rows[0].cells[0].textContent.trim() === '') {\n            \tcolumnStart = 1;\n            }else {\n            \tcolumnStart = 0;\n            }\n\n            for (j = columnStart; j < row.cells.length; j=j+1) {\n                col = row.cells[j];\n                rowData = rowData + fixCSVField(col.textContent.trim()) + (j ? csvDelimiter : ' ');\n            }\n            rowData = rowData.slice(0, rowData.length - 1); //remove last semicolon\n            data += rowData + csvNewLine;\n        }\n        return data;\n    };\n\n    var tableToHTML = function(table) {\n        var data = \"\";\n        var i, j, row, col;\n        var columnStart = 0;\n        for (i = 0; i < table.rows.length; i=i+1) {\n            row = table.rows[i];\n            var rowData = '';\n            \n            //Checking ng table style for filters\n            if(row.className.indexOf('ng-table-filters') !== -1) {\n\t\t\t\tcontinue;\n            }\n            \n            //remove first column having check box in angular JS, in future will provide option from UI to control\n            if(table.rows[0].cells[0].textContent.trim() === '') {\n            \tcolumnStart = 1;\n            }else {\n            \tcolumnStart = 0;\n            }\n\n            for (j = columnStart; j < row.cells.length; j=j+1) {\n                col = row.cells[j];\n                if (i === 0) {\n                \trowData += '<th>' + col.textContent.trim() + '</th>';\n                } else {\n                \trowData += '<td>' + col.textContent.trim() + '</td>';\n                }\n            }\n            data += '<tr>' + rowData + '</tr>';\n        }\n        return data;\n    };\n\n    function createDownloadLink(anchor, base64data, exporttype, filename) {\n        var blob;\n        if (window.navigator.msSaveBlob) {\n            blob = b64toBlob(base64data, exporttype);\n            window.navigator.msSaveBlob(blob, filename);\n            return false;\n        } else if(window.URL.createObjectURL) {\n            blob = b64toBlob(base64data, exporttype);\n            var blobUrl = window.URL.createObjectURL(blob, exporttype, filename);\n            anchor.href = blobUrl;\n        } else {\n            var hrefvalue = \"data:\" + exporttype + \";base64,\" + base64data;\n            anchor.download = filename;\n            anchor.href = hrefvalue;\n        }\n\n        // Return true to allow the link to work\n        return true;\n    }\n\n    var ee = {\n        /** @export */\n        excel: function(anchor, table, name) {\n            table = get(table);\n\n            var htmlTableData = tableToHTML(table);\n            \n            var ctx = {worksheet: name || 'Worksheet', table: htmlTableData};\n            var b64 = base64(format(template.excel, ctx));\n            return createDownloadLink(anchor, b64, 'application/vnd.ms-excel','export.xls');\n        },\n        /** @export */\n        csv: function(anchor, table, delimiter, newLine) {\n            if (delimiter !== undefined && delimiter) {\n                csvDelimiter = delimiter;\n            }\n            if (newLine !== undefined && newLine) {\n                csvNewLine = newLine;\n            }\n\n            table = get(table);\n            var csvData = tableToCSV(table);\n            var b64 = base64(csvData);\n            return createDownloadLink(anchor,b64,'application/csv','export.csv');\n        }\n    };\n\n    return ee;\n}());\n\n    // AMD support\n    if (typeof define === 'function' && define.amd) {\n        define(function () { return ExcellentExport; });\n    // CommonJS and Node.js module support.\n    } else if (typeof exports !== 'undefined') {\n        // Support Node.js specific `module.exports` (which can be a function)\n        if (typeof module !== 'undefined' && module.exports) {\n            exports = module.exports = ExcellentExport;\n        }\n        // But always support CommonJS module 1.1.1 spec (`exports` cannot be a function)\n        exports.ExcellentExport = ExcellentExport;\n    } else {\n        global.ExcellentExport = ExcellentExport;\n    }\n})(this);\n\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/ng-table-excel-export/ng-table-excel-export.js\n// module id = 3\n// module chunks = 3","module.exports = \"/**\\n * ngTableExcelExport 1.0.0\\n * JavaScript export to Excel or CSV from HTML tables automatically in the browser and also compatible with all browsers.\\n *\\n * @author: Murugavel Ramachandran (blsrm@yahoo.com)\\n * @url: https://github.com/blsrm/ngTableExcelExport\\n *\\n */\\n/*jslint browser: true, bitwise: true, vars: true, white: true */\\n/*global define, exports, module */\\n\\n(function (global) {\\n    'use strict';\\n\\nvar ExcellentExport = (function() {\\n\\n    function b64toBlob(b64Data, contentType, sliceSize) {\\n        // function taken from http://stackoverflow.com/a/16245768/2591950\\n        // author Jeremy Banks http://stackoverflow.com/users/1114/jeremy-banks\\n        contentType = contentType || '';\\n        sliceSize = sliceSize || 512;\\n\\n        var byteCharacters = window.atob(b64Data);\\n        var byteArrays = [];\\n\\n        var offset;\\n        for (offset = 0; offset < byteCharacters.length; offset += sliceSize) {\\n            var slice = byteCharacters.slice(offset, offset + sliceSize);\\n\\n            var byteNumbers = new Array(slice.length);\\n            var i;\\n            for (i = 0; i < slice.length; i = i + 1) {\\n                byteNumbers[i] = slice.charCodeAt(i);\\n            }\\n\\n            var byteArray = new window.Uint8Array(byteNumbers);\\n\\n            byteArrays.push(byteArray);\\n        }\\n\\n        var blob = new window.Blob(byteArrays, {\\n            type: contentType\\n        });\\n        return blob;\\n    }\\n\\n    var version = \\\"1.5.0\\\";\\n    var uri = {excel: 'data:application/vnd.ms-excel;base64,', csv: 'data:application/csv;base64,'};\\n    var template = {excel: '<html xmlns:o=\\\"urn:schemas-microsoft-com:office:office\\\" xmlns:x=\\\"urn:schemas-microsoft-com:office:excel\\\" xmlns=\\\"http://www.w3.org/TR/REC-html40\\\"><head><meta name=ProgId content=Excel.Sheet> <meta name=Generator content=\\\"Microsoft Excel 11\\\"><meta http-equiv=\\\"Content-Type\\\" content=\\\"text/html; charset=UTF-8\\\"><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table border=\\\"1\\\">{table}</table></body></html>'};\\n    var csvDelimiter = \\\",\\\";\\n    var csvNewLine = \\\"\\\\r\\\\n\\\";\\n    var base64 = function(s) {\\n        return window.btoa(window.unescape(encodeURIComponent(s)));\\n    };\\n    var format = function(s, c) {\\n        return s.replace(new RegExp(\\\"{(\\\\\\\\w+)}\\\", \\\"g\\\"), function(m, p) {\\n            return c[p];\\n        });\\n    };\\n\\n    var get = function(element) {\\n        if (!element.nodeType) {\\n            return document.getElementById(element);\\n        }\\n        return element;\\n    };\\n\\n    var fixCSVField = function(value) {\\n        var fixedValue = value;\\n        var addQuotes = (value.indexOf(csvDelimiter) !== -1) || (value.indexOf('\\\\r') !== -1) || (value.indexOf('\\\\n') !== -1);\\n        var replaceDoubleQuotes = (value.indexOf('\\\"') !== -1);\\n\\n        if (replaceDoubleQuotes) {\\n            fixedValue = fixedValue.replace(/\\\"/g, '\\\"\\\"');\\n        }\\n        if (addQuotes || replaceDoubleQuotes) {\\n            fixedValue = '\\\"' + fixedValue + '\\\"';\\n        }\\n\\n        return fixedValue;\\n    };\\n\\n    var tableToCSV = function(table) {\\n        var data = \\\"SEP=\\\"+csvDelimiter+csvNewLine;\\n        var i, j, row, col;\\n        var columnStart = 0;\\n        for (i = 0; i < table.rows.length; i=i+1) {\\n            row = table.rows[i];\\n            var rowData = '';\\n            \\n            //Checking ng table style for filters\\n            if(row.className.indexOf('ng-table-filters') !== -1) {\\n\\t\\t\\t\\tcontinue;\\n            }\\n            \\n            //remove first column having check box in angular JS, in future will provide option from UI to control\\n            if(table.rows[0].cells[0].textContent.trim() === '') {\\n            \\tcolumnStart = 1;\\n            }else {\\n            \\tcolumnStart = 0;\\n            }\\n\\n            for (j = columnStart; j < row.cells.length; j=j+1) {\\n                col = row.cells[j];\\n                rowData = rowData + fixCSVField(col.textContent.trim()) + (j ? csvDelimiter : ' ');\\n            }\\n            rowData = rowData.slice(0, rowData.length - 1); //remove last semicolon\\n            data += rowData + csvNewLine;\\n        }\\n        return data;\\n    };\\n\\n    var tableToHTML = function(table) {\\n        var data = \\\"\\\";\\n        var i, j, row, col;\\n        var columnStart = 0;\\n        for (i = 0; i < table.rows.length; i=i+1) {\\n            row = table.rows[i];\\n            var rowData = '';\\n            \\n            //Checking ng table style for filters\\n            if(row.className.indexOf('ng-table-filters') !== -1) {\\n\\t\\t\\t\\tcontinue;\\n            }\\n            \\n            //remove first column having check box in angular JS, in future will provide option from UI to control\\n            if(table.rows[0].cells[0].textContent.trim() === '') {\\n            \\tcolumnStart = 1;\\n            }else {\\n            \\tcolumnStart = 0;\\n            }\\n\\n            for (j = columnStart; j < row.cells.length; j=j+1) {\\n                col = row.cells[j];\\n                if (i === 0) {\\n                \\trowData += '<th>' + col.textContent.trim() + '</th>';\\n                } else {\\n                \\trowData += '<td>' + col.textContent.trim() + '</td>';\\n                }\\n            }\\n            data += '<tr>' + rowData + '</tr>';\\n        }\\n        return data;\\n    };\\n\\n    function createDownloadLink(anchor, base64data, exporttype, filename) {\\n        var blob;\\n        if (window.navigator.msSaveBlob) {\\n            blob = b64toBlob(base64data, exporttype);\\n            window.navigator.msSaveBlob(blob, filename);\\n            return false;\\n        } else if(window.URL.createObjectURL) {\\n            blob = b64toBlob(base64data, exporttype);\\n            var blobUrl = window.URL.createObjectURL(blob, exporttype, filename);\\n            anchor.href = blobUrl;\\n        } else {\\n            var hrefvalue = \\\"data:\\\" + exporttype + \\\";base64,\\\" + base64data;\\n            anchor.download = filename;\\n            anchor.href = hrefvalue;\\n        }\\n\\n        // Return true to allow the link to work\\n        return true;\\n    }\\n\\n    var ee = {\\n        /** @export */\\n        excel: function(anchor, table, name) {\\n            table = get(table);\\n\\n            var htmlTableData = tableToHTML(table);\\n            \\n            var ctx = {worksheet: name || 'Worksheet', table: htmlTableData};\\n            var b64 = base64(format(template.excel, ctx));\\n            return createDownloadLink(anchor, b64, 'application/vnd.ms-excel','export.xls');\\n        },\\n        /** @export */\\n        csv: function(anchor, table, delimiter, newLine) {\\n            if (delimiter !== undefined && delimiter) {\\n                csvDelimiter = delimiter;\\n            }\\n            if (newLine !== undefined && newLine) {\\n                csvNewLine = newLine;\\n            }\\n\\n            table = get(table);\\n            var csvData = tableToCSV(table);\\n            var b64 = base64(csvData);\\n            return createDownloadLink(anchor,b64,'application/csv','export.csv');\\n        }\\n    };\\n\\n    return ee;\\n}());\\n\\n    // AMD support\\n    if (typeof define === 'function' && define.amd) {\\n        define(function () { return ExcellentExport; });\\n    // CommonJS and Node.js module support.\\n    } else if (typeof exports !== 'undefined') {\\n        // Support Node.js specific `module.exports` (which can be a function)\\n        if (typeof module !== 'undefined' && module.exports) {\\n            exports = module.exports = ExcellentExport;\\n        }\\n        // But always support CommonJS module 1.1.1 spec (`exports` cannot be a function)\\n        exports.ExcellentExport = ExcellentExport;\\n    } else {\\n        global.ExcellentExport = ExcellentExport;\\n    }\\n})(this);\\n\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/raw-loader!./~/ng-table-excel-export/ng-table-excel-export.js\n// module id = 309\n// module chunks = 3","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\nmodule.exports = function(src) {\n\tfunction log(error) {\n\t\t(typeof console !== \"undefined\")\n\t\t&& (console.error || console.log)(\"[Script Loader]\", error);\n\t}\n\n\t// Check for IE =< 8\n\tfunction isIE() {\n\t\treturn typeof attachEvent !== \"undefined\" && typeof addEventListener === \"undefined\";\n\t}\n\n\ttry {\n\t\tif (typeof execScript !== \"undefined\" && isIE()) {\n\t\t\texecScript(src);\n\t\t} else if (typeof eval !== \"undefined\") {\n\t\t\teval.call(null, src);\n\t\t} else {\n\t\t\tlog(\"EvalError: No eval function available\");\n\t\t}\n\t} catch (error) {\n\t\tlog(error);\n\t}\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/script-loader/addScript.js\n// module id = 310\n// module chunks = 3","require(\"!!E:\\\\JENKINS_HOME\\\\workspace\\\\YJ-FSP-h5-ifsunify-manage-new\\\\codes\\\\h5-ifsunify-manage-new\\\\node_modules\\\\script-loader\\\\addScript.js\")(require(\"!!E:\\\\JENKINS_HOME\\\\workspace\\\\YJ-FSP-h5-ifsunify-manage-new\\\\codes\\\\h5-ifsunify-manage-new\\\\node_modules\\\\raw-loader\\\\index.js!E:\\\\JENKINS_HOME\\\\workspace\\\\YJ-FSP-h5-ifsunify-manage-new\\\\codes\\\\h5-ifsunify-manage-new\\\\node_modules\\\\ng-table-excel-export\\\\ng-table-excel-export.js\"))\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/script-loader!./~/ng-table-excel-export/ng-table-excel-export.js\n// module id = 311\n// module chunks = 3","/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.2.0 (2020-02-13)\n */\n(function (domGlobals) {\n    'use strict';\n\n    var noop = function () {\n    };\n    var compose = function (fa, fb) {\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        return fa(fb.apply(null, args));\n      };\n    };\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    var identity = function (x) {\n      return x;\n    };\n    function curry(fn) {\n      var initialArgs = [];\n      for (var _i = 1; _i < arguments.length; _i++) {\n        initialArgs[_i - 1] = arguments[_i];\n      }\n      return function () {\n        var restArgs = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          restArgs[_i] = arguments[_i];\n        }\n        var all = initialArgs.concat(restArgs);\n        return fn.apply(null, all);\n      };\n    }\n    var not = function (f) {\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        return !f.apply(null, args);\n      };\n    };\n    var die = function (msg) {\n      return function () {\n        throw new Error(msg);\n      };\n    };\n    var never = constant(false);\n    var always = constant(true);\n\n    var none = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var eq = function (o) {\n        return o.isNone();\n      };\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = function (n) {\n        return n;\n      };\n      var me = {\n        fold: function (n, s) {\n          return n();\n        },\n        is: never,\n        isSome: never,\n        isNone: always,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: constant(null),\n        getOrUndefined: constant(undefined),\n        or: id,\n        orThunk: call,\n        map: none,\n        each: noop,\n        bind: none,\n        exists: never,\n        forall: always,\n        filter: none,\n        equals: eq,\n        equals_: eq,\n        toArray: function () {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      if (Object.freeze) {\n        Object.freeze(me);\n      }\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = constant(a);\n      var self = function () {\n        return me;\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        is: function (v) {\n          return a === v;\n        },\n        isSome: always,\n        isNone: never,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: function (f) {\n          return some(f(a));\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        },\n        equals: function (o) {\n          return o.is(a);\n        },\n        equals_: function (o, elementEq) {\n          return o.fold(never, function (b) {\n            return elementEq(a, b);\n          });\n        }\n      };\n      return me;\n    };\n    var from = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Option = {\n      some: some,\n      none: none,\n      from: from\n    };\n\n    var typeOf = function (x) {\n      if (x === null) {\n        return 'null';\n      }\n      var t = typeof x;\n      if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n        return 'array';\n      }\n      if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n        return 'string';\n      }\n      return t;\n    };\n    var isType = function (type) {\n      return function (value) {\n        return typeOf(value) === type;\n      };\n    };\n    var isString = isType('string');\n    var isObject = isType('object');\n    var isArray = isType('array');\n    var isNull = isType('null');\n    var isBoolean = isType('boolean');\n    var isFunction = isType('function');\n    var isNumber = isType('number');\n\n    var nativeSlice = Array.prototype.slice;\n    var nativeIndexOf = Array.prototype.indexOf;\n    var nativePush = Array.prototype.push;\n    var rawIndexOf = function (ts, t) {\n      return nativeIndexOf.call(ts, t);\n    };\n    var indexOf = function (xs, x) {\n      var r = rawIndexOf(xs, x);\n      return r === -1 ? Option.none() : Option.some(r);\n    };\n    var contains = function (xs, x) {\n      return rawIndexOf(xs, x) > -1;\n    };\n    var exists = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return true;\n        }\n      }\n      return false;\n    };\n    var map = function (xs, f) {\n      var len = xs.length;\n      var r = new Array(len);\n      for (var i = 0; i < len; i++) {\n        var x = xs[i];\n        r[i] = f(x, i);\n      }\n      return r;\n    };\n    var each = function (xs, f) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var eachr = function (xs, f) {\n      for (var i = xs.length - 1; i >= 0; i--) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var partition = function (xs, pred) {\n      var pass = [];\n      var fail = [];\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        var arr = pred(x, i) ? pass : fail;\n        arr.push(x);\n      }\n      return {\n        pass: pass,\n        fail: fail\n      };\n    };\n    var filter = function (xs, pred) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          r.push(x);\n        }\n      }\n      return r;\n    };\n    var foldr = function (xs, f, acc) {\n      eachr(xs, function (x) {\n        acc = f(acc, x);\n      });\n      return acc;\n    };\n    var foldl = function (xs, f, acc) {\n      each(xs, function (x) {\n        acc = f(acc, x);\n      });\n      return acc;\n    };\n    var find = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return Option.some(x);\n        }\n      }\n      return Option.none();\n    };\n    var findIndex = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return Option.some(i);\n        }\n      }\n      return Option.none();\n    };\n    var flatten = function (xs) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        if (!isArray(xs[i])) {\n          throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n        }\n        nativePush.apply(r, xs[i]);\n      }\n      return r;\n    };\n    var bind = function (xs, f) {\n      return flatten(map(xs, f));\n    };\n    var forall = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        var x = xs[i];\n        if (pred(x, i) !== true) {\n          return false;\n        }\n      }\n      return true;\n    };\n    var reverse = function (xs) {\n      var r = nativeSlice.call(xs, 0);\n      r.reverse();\n      return r;\n    };\n    var difference = function (a1, a2) {\n      return filter(a1, function (x) {\n        return !contains(a2, x);\n      });\n    };\n    var mapToObject = function (xs, f) {\n      var r = {};\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        r[String(x)] = f(x, i);\n      }\n      return r;\n    };\n    var sort = function (xs, comparator) {\n      var copy = nativeSlice.call(xs, 0);\n      copy.sort(comparator);\n      return copy;\n    };\n    var head = function (xs) {\n      return xs.length === 0 ? Option.none() : Option.some(xs[0]);\n    };\n    var last = function (xs) {\n      return xs.length === 0 ? Option.none() : Option.some(xs[xs.length - 1]);\n    };\n    var from$1 = isFunction(Array.from) ? Array.from : function (x) {\n      return nativeSlice.call(x);\n    };\n\n    var keys = Object.keys;\n    var hasOwnProperty = Object.hasOwnProperty;\n    var each$1 = function (obj, f) {\n      var props = keys(obj);\n      for (var k = 0, len = props.length; k < len; k++) {\n        var i = props[k];\n        var x = obj[i];\n        f(x, i);\n      }\n    };\n    var map$1 = function (obj, f) {\n      return tupleMap(obj, function (x, i) {\n        return {\n          k: i,\n          v: f(x, i)\n        };\n      });\n    };\n    var tupleMap = function (obj, f) {\n      var r = {};\n      each$1(obj, function (x, i) {\n        var tuple = f(x, i);\n        r[tuple.k] = tuple.v;\n      });\n      return r;\n    };\n    var objAcc = function (r) {\n      return function (x, i) {\n        r[i] = x;\n      };\n    };\n    var internalFilter = function (obj, pred, onTrue, onFalse) {\n      var r = {};\n      each$1(obj, function (x, i) {\n        (pred(x, i) ? onTrue : onFalse)(x, i);\n      });\n      return r;\n    };\n    var bifilter = function (obj, pred) {\n      var t = {};\n      var f = {};\n      internalFilter(obj, pred, objAcc(t), objAcc(f));\n      return {\n        t: t,\n        f: f\n      };\n    };\n    var get = function (obj, key) {\n      return has(obj, key) ? Option.from(obj[key]) : Option.none();\n    };\n    var has = function (obj, key) {\n      return hasOwnProperty.call(obj, key);\n    };\n\n    var __assign = function () {\n      __assign = Object.assign || function __assign(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s)\n            if (Object.prototype.hasOwnProperty.call(s, p))\n              t[p] = s[p];\n        }\n        return t;\n      };\n      return __assign.apply(this, arguments);\n    };\n    function __rest(s, e) {\n      var t = {};\n      for (var p in s)\n        if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n          t[p] = s[p];\n      if (s != null && typeof Object.getOwnPropertySymbols === 'function')\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n          if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n            t[p[i]] = s[p[i]];\n        }\n      return t;\n    }\n\n    var fromHtml = function (html, scope) {\n      var doc = scope || domGlobals.document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      if (!div.hasChildNodes() || div.childNodes.length > 1) {\n        domGlobals.console.error('HTML does not have a single root node', html);\n        throw new Error('HTML must have a single root node');\n      }\n      return fromDom(div.childNodes[0]);\n    };\n    var fromTag = function (tag, scope) {\n      var doc = scope || domGlobals.document;\n      var node = doc.createElement(tag);\n      return fromDom(node);\n    };\n    var fromText = function (text, scope) {\n      var doc = scope || domGlobals.document;\n      var node = doc.createTextNode(text);\n      return fromDom(node);\n    };\n    var fromDom = function (node) {\n      if (node === null || node === undefined) {\n        throw new Error('Node cannot be null or undefined');\n      }\n      return { dom: constant(node) };\n    };\n    var fromPoint = function (docElm, x, y) {\n      var doc = docElm.dom();\n      return Option.from(doc.elementFromPoint(x, y)).map(fromDom);\n    };\n    var Element = {\n      fromHtml: fromHtml,\n      fromTag: fromTag,\n      fromText: fromText,\n      fromDom: fromDom,\n      fromPoint: fromPoint\n    };\n\n    var Cell = function (initial) {\n      var value = initial;\n      var get = function () {\n        return value;\n      };\n      var set = function (v) {\n        value = v;\n      };\n      var clone = function () {\n        return Cell(get());\n      };\n      return {\n        get: get,\n        set: set,\n        clone: clone\n      };\n    };\n\n    var firstMatch = function (regexes, s) {\n      for (var i = 0; i < regexes.length; i++) {\n        var x = regexes[i];\n        if (x.test(s)) {\n          return x;\n        }\n      }\n      return undefined;\n    };\n    var find$1 = function (regexes, agent) {\n      var r = firstMatch(regexes, agent);\n      if (!r) {\n        return {\n          major: 0,\n          minor: 0\n        };\n      }\n      var group = function (i) {\n        return Number(agent.replace(r, '$' + i));\n      };\n      return nu(group(1), group(2));\n    };\n    var detect = function (versionRegexes, agent) {\n      var cleanedAgent = String(agent).toLowerCase();\n      if (versionRegexes.length === 0) {\n        return unknown();\n      }\n      return find$1(versionRegexes, cleanedAgent);\n    };\n    var unknown = function () {\n      return nu(0, 0);\n    };\n    var nu = function (major, minor) {\n      return {\n        major: major,\n        minor: minor\n      };\n    };\n    var Version = {\n      nu: nu,\n      detect: detect,\n      unknown: unknown\n    };\n\n    var edge = 'Edge';\n    var chrome = 'Chrome';\n    var ie = 'IE';\n    var opera = 'Opera';\n    var firefox = 'Firefox';\n    var safari = 'Safari';\n    var isBrowser = function (name, current) {\n      return function () {\n        return current === name;\n      };\n    };\n    var unknown$1 = function () {\n      return nu$1({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$1 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      return {\n        current: current,\n        version: version,\n        isEdge: isBrowser(edge, current),\n        isChrome: isBrowser(chrome, current),\n        isIE: isBrowser(ie, current),\n        isOpera: isBrowser(opera, current),\n        isFirefox: isBrowser(firefox, current),\n        isSafari: isBrowser(safari, current)\n      };\n    };\n    var Browser = {\n      unknown: unknown$1,\n      nu: nu$1,\n      edge: constant(edge),\n      chrome: constant(chrome),\n      ie: constant(ie),\n      opera: constant(opera),\n      firefox: constant(firefox),\n      safari: constant(safari)\n    };\n\n    var windows = 'Windows';\n    var ios = 'iOS';\n    var android = 'Android';\n    var linux = 'Linux';\n    var osx = 'OSX';\n    var solaris = 'Solaris';\n    var freebsd = 'FreeBSD';\n    var chromeos = 'ChromeOS';\n    var isOS = function (name, current) {\n      return function () {\n        return current === name;\n      };\n    };\n    var unknown$2 = function () {\n      return nu$2({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$2 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      return {\n        current: current,\n        version: version,\n        isWindows: isOS(windows, current),\n        isiOS: isOS(ios, current),\n        isAndroid: isOS(android, current),\n        isOSX: isOS(osx, current),\n        isLinux: isOS(linux, current),\n        isSolaris: isOS(solaris, current),\n        isFreeBSD: isOS(freebsd, current),\n        isChromeOS: isOS(chromeos, current)\n      };\n    };\n    var OperatingSystem = {\n      unknown: unknown$2,\n      nu: nu$2,\n      windows: constant(windows),\n      ios: constant(ios),\n      android: constant(android),\n      linux: constant(linux),\n      osx: constant(osx),\n      solaris: constant(solaris),\n      freebsd: constant(freebsd),\n      chromeos: constant(chromeos)\n    };\n\n    var DeviceType = function (os, browser, userAgent, mediaMatch) {\n      var isiPad = os.isiOS() && /ipad/i.test(userAgent) === true;\n      var isiPhone = os.isiOS() && !isiPad;\n      var isMobile = os.isiOS() || os.isAndroid();\n      var isTouch = isMobile || mediaMatch('(pointer:coarse)');\n      var isTablet = isiPad || !isiPhone && isMobile && mediaMatch('(min-device-width:768px)');\n      var isPhone = isiPhone || isMobile && !isTablet;\n      var iOSwebview = browser.isSafari() && os.isiOS() && /safari/i.test(userAgent) === false;\n      var isDesktop = !isPhone && !isTablet && !iOSwebview;\n      return {\n        isiPad: constant(isiPad),\n        isiPhone: constant(isiPhone),\n        isTablet: constant(isTablet),\n        isPhone: constant(isPhone),\n        isTouch: constant(isTouch),\n        isAndroid: os.isAndroid,\n        isiOS: os.isiOS,\n        isWebView: constant(iOSwebview),\n        isDesktop: constant(isDesktop)\n      };\n    };\n\n    var detect$1 = function (candidates, userAgent) {\n      var agent = String(userAgent).toLowerCase();\n      return find(candidates, function (candidate) {\n        return candidate.search(agent);\n      });\n    };\n    var detectBrowser = function (browsers, userAgent) {\n      return detect$1(browsers, userAgent).map(function (browser) {\n        var version = Version.detect(browser.versionRegexes, userAgent);\n        return {\n          current: browser.name,\n          version: version\n        };\n      });\n    };\n    var detectOs = function (oses, userAgent) {\n      return detect$1(oses, userAgent).map(function (os) {\n        var version = Version.detect(os.versionRegexes, userAgent);\n        return {\n          current: os.name,\n          version: version\n        };\n      });\n    };\n    var UaString = {\n      detectBrowser: detectBrowser,\n      detectOs: detectOs\n    };\n\n    var checkRange = function (str, substr, start) {\n      if (substr === '') {\n        return true;\n      }\n      if (str.length < substr.length) {\n        return false;\n      }\n      var x = str.substr(start, start + substr.length);\n      return x === substr;\n    };\n    var contains$1 = function (str, substr) {\n      return str.indexOf(substr) !== -1;\n    };\n    var startsWith = function (str, prefix) {\n      return checkRange(str, prefix, 0);\n    };\n    var trim = function (str) {\n      return str.replace(/^\\s+|\\s+$/g, '');\n    };\n    var lTrim = function (str) {\n      return str.replace(/^\\s+/g, '');\n    };\n    var rTrim = function (str) {\n      return str.replace(/\\s+$/g, '');\n    };\n\n    var normalVersionRegex = /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/;\n    var checkContains = function (target) {\n      return function (uastring) {\n        return contains$1(uastring, target);\n      };\n    };\n    var browsers = [\n      {\n        name: 'Edge',\n        versionRegexes: [/.*?edge\\/ ?([0-9]+)\\.([0-9]+)$/],\n        search: function (uastring) {\n          return contains$1(uastring, 'edge/') && contains$1(uastring, 'chrome') && contains$1(uastring, 'safari') && contains$1(uastring, 'applewebkit');\n        }\n      },\n      {\n        name: 'Chrome',\n        versionRegexes: [\n          /.*?chrome\\/([0-9]+)\\.([0-9]+).*/,\n          normalVersionRegex\n        ],\n        search: function (uastring) {\n          return contains$1(uastring, 'chrome') && !contains$1(uastring, 'chromeframe');\n        }\n      },\n      {\n        name: 'IE',\n        versionRegexes: [\n          /.*?msie\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*?rv:([0-9]+)\\.([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return contains$1(uastring, 'msie') || contains$1(uastring, 'trident');\n        }\n      },\n      {\n        name: 'Opera',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?opera\\/([0-9]+)\\.([0-9]+).*/\n        ],\n        search: checkContains('opera')\n      },\n      {\n        name: 'Firefox',\n        versionRegexes: [/.*?firefox\\/\\ ?([0-9]+)\\.([0-9]+).*/],\n        search: checkContains('firefox')\n      },\n      {\n        name: 'Safari',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?cpu os ([0-9]+)_([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return (contains$1(uastring, 'safari') || contains$1(uastring, 'mobile/')) && contains$1(uastring, 'applewebkit');\n        }\n      }\n    ];\n    var oses = [\n      {\n        name: 'Windows',\n        search: checkContains('win'),\n        versionRegexes: [/.*?windows\\ nt\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'iOS',\n        search: function (uastring) {\n          return contains$1(uastring, 'iphone') || contains$1(uastring, 'ipad');\n        },\n        versionRegexes: [\n          /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*cpu os ([0-9]+)_([0-9]+).*/,\n          /.*cpu iphone os ([0-9]+)_([0-9]+).*/\n        ]\n      },\n      {\n        name: 'Android',\n        search: checkContains('android'),\n        versionRegexes: [/.*?android\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'OSX',\n        search: checkContains('mac os x'),\n        versionRegexes: [/.*?mac\\ os\\ x\\ ?([0-9]+)_([0-9]+).*/]\n      },\n      {\n        name: 'Linux',\n        search: checkContains('linux'),\n        versionRegexes: []\n      },\n      {\n        name: 'Solaris',\n        search: checkContains('sunos'),\n        versionRegexes: []\n      },\n      {\n        name: 'FreeBSD',\n        search: checkContains('freebsd'),\n        versionRegexes: []\n      },\n      {\n        name: 'ChromeOS',\n        search: checkContains('cros'),\n        versionRegexes: [/.*?chrome\\/([0-9]+)\\.([0-9]+).*/]\n      }\n    ];\n    var PlatformInfo = {\n      browsers: constant(browsers),\n      oses: constant(oses)\n    };\n\n    var detect$2 = function (userAgent, mediaMatch) {\n      var browsers = PlatformInfo.browsers();\n      var oses = PlatformInfo.oses();\n      var browser = UaString.detectBrowser(browsers, userAgent).fold(Browser.unknown, Browser.nu);\n      var os = UaString.detectOs(oses, userAgent).fold(OperatingSystem.unknown, OperatingSystem.nu);\n      var deviceType = DeviceType(os, browser, userAgent, mediaMatch);\n      return {\n        browser: browser,\n        os: os,\n        deviceType: deviceType\n      };\n    };\n    var PlatformDetection = { detect: detect$2 };\n\n    var mediaMatch = function (query) {\n      return domGlobals.window.matchMedia(query).matches;\n    };\n    var platform = Cell(PlatformDetection.detect(domGlobals.navigator.userAgent, mediaMatch));\n    var detect$3 = function () {\n      return platform.get();\n    };\n\n    var Immutable = function () {\n      var fields = [];\n      for (var _i = 0; _i < arguments.length; _i++) {\n        fields[_i] = arguments[_i];\n      }\n      return function () {\n        var values = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          values[_i] = arguments[_i];\n        }\n        if (fields.length !== values.length) {\n          throw new Error('Wrong number of arguments to struct. Expected \"[' + fields.length + ']\", got ' + values.length + ' arguments');\n        }\n        var struct = {};\n        each(fields, function (name, i) {\n          struct[name] = constant(values[i]);\n        });\n        return struct;\n      };\n    };\n\n    var toArray = function (target, f) {\n      var r = [];\n      var recurse = function (e) {\n        r.push(e);\n        return f(e);\n      };\n      var cur = f(target);\n      do {\n        cur = cur.bind(recurse);\n      } while (cur.isSome());\n      return r;\n    };\n    var Recurse = { toArray: toArray };\n\n    var compareDocumentPosition = function (a, b, match) {\n      return (a.compareDocumentPosition(b) & match) !== 0;\n    };\n    var documentPositionPreceding = function (a, b) {\n      return compareDocumentPosition(a, b, domGlobals.Node.DOCUMENT_POSITION_PRECEDING);\n    };\n    var documentPositionContainedBy = function (a, b) {\n      return compareDocumentPosition(a, b, domGlobals.Node.DOCUMENT_POSITION_CONTAINED_BY);\n    };\n    var Node = {\n      documentPositionPreceding: documentPositionPreceding,\n      documentPositionContainedBy: documentPositionContainedBy\n    };\n\n    var ATTRIBUTE = domGlobals.Node.ATTRIBUTE_NODE;\n    var CDATA_SECTION = domGlobals.Node.CDATA_SECTION_NODE;\n    var COMMENT = domGlobals.Node.COMMENT_NODE;\n    var DOCUMENT = domGlobals.Node.DOCUMENT_NODE;\n    var DOCUMENT_TYPE = domGlobals.Node.DOCUMENT_TYPE_NODE;\n    var DOCUMENT_FRAGMENT = domGlobals.Node.DOCUMENT_FRAGMENT_NODE;\n    var ELEMENT = domGlobals.Node.ELEMENT_NODE;\n    var TEXT = domGlobals.Node.TEXT_NODE;\n    var PROCESSING_INSTRUCTION = domGlobals.Node.PROCESSING_INSTRUCTION_NODE;\n    var ENTITY_REFERENCE = domGlobals.Node.ENTITY_REFERENCE_NODE;\n    var ENTITY = domGlobals.Node.ENTITY_NODE;\n    var NOTATION = domGlobals.Node.NOTATION_NODE;\n\n    var ELEMENT$1 = ELEMENT;\n    var DOCUMENT$1 = DOCUMENT;\n    var is = function (element, selector) {\n      var dom = element.dom();\n      if (dom.nodeType !== ELEMENT$1) {\n        return false;\n      } else {\n        var elem = dom;\n        if (elem.matches !== undefined) {\n          return elem.matches(selector);\n        } else if (elem.msMatchesSelector !== undefined) {\n          return elem.msMatchesSelector(selector);\n        } else if (elem.webkitMatchesSelector !== undefined) {\n          return elem.webkitMatchesSelector(selector);\n        } else if (elem.mozMatchesSelector !== undefined) {\n          return elem.mozMatchesSelector(selector);\n        } else {\n          throw new Error('Browser lacks native selectors');\n        }\n      }\n    };\n    var bypassSelector = function (dom) {\n      return dom.nodeType !== ELEMENT$1 && dom.nodeType !== DOCUMENT$1 || dom.childElementCount === 0;\n    };\n    var all = function (selector, scope) {\n      var base = scope === undefined ? domGlobals.document : scope.dom();\n      return bypassSelector(base) ? [] : map(base.querySelectorAll(selector), Element.fromDom);\n    };\n    var one = function (selector, scope) {\n      var base = scope === undefined ? domGlobals.document : scope.dom();\n      return bypassSelector(base) ? Option.none() : Option.from(base.querySelector(selector)).map(Element.fromDom);\n    };\n\n    var eq = function (e1, e2) {\n      return e1.dom() === e2.dom();\n    };\n    var regularContains = function (e1, e2) {\n      var d1 = e1.dom();\n      var d2 = e2.dom();\n      return d1 === d2 ? false : d1.contains(d2);\n    };\n    var ieContains = function (e1, e2) {\n      return Node.documentPositionContainedBy(e1.dom(), e2.dom());\n    };\n    var browser = detect$3().browser;\n    var contains$2 = browser.isIE() ? ieContains : regularContains;\n\n    var owner = function (element) {\n      return Element.fromDom(element.dom().ownerDocument);\n    };\n    var documentElement = function (element) {\n      return Element.fromDom(element.dom().ownerDocument.documentElement);\n    };\n    var defaultView = function (element) {\n      return Element.fromDom(element.dom().ownerDocument.defaultView);\n    };\n    var parent = function (element) {\n      return Option.from(element.dom().parentNode).map(Element.fromDom);\n    };\n    var parents = function (element, isRoot) {\n      var stop = isFunction(isRoot) ? isRoot : never;\n      var dom = element.dom();\n      var ret = [];\n      while (dom.parentNode !== null && dom.parentNode !== undefined) {\n        var rawParent = dom.parentNode;\n        var p = Element.fromDom(rawParent);\n        ret.push(p);\n        if (stop(p) === true) {\n          break;\n        } else {\n          dom = rawParent;\n        }\n      }\n      return ret;\n    };\n    var prevSibling = function (element) {\n      return Option.from(element.dom().previousSibling).map(Element.fromDom);\n    };\n    var nextSibling = function (element) {\n      return Option.from(element.dom().nextSibling).map(Element.fromDom);\n    };\n    var prevSiblings = function (element) {\n      return reverse(Recurse.toArray(element, prevSibling));\n    };\n    var nextSiblings = function (element) {\n      return Recurse.toArray(element, nextSibling);\n    };\n    var children = function (element) {\n      return map(element.dom().childNodes, Element.fromDom);\n    };\n    var child = function (element, index) {\n      var cs = element.dom().childNodes;\n      return Option.from(cs[index]).map(Element.fromDom);\n    };\n    var firstChild = function (element) {\n      return child(element, 0);\n    };\n    var lastChild = function (element) {\n      return child(element, element.dom().childNodes.length - 1);\n    };\n    var childNodesCount = function (element) {\n      return element.dom().childNodes.length;\n    };\n    var spot = Immutable('element', 'offset');\n\n    var before = function (marker, element) {\n      var parent$1 = parent(marker);\n      parent$1.each(function (v) {\n        v.dom().insertBefore(element.dom(), marker.dom());\n      });\n    };\n    var after = function (marker, element) {\n      var sibling = nextSibling(marker);\n      sibling.fold(function () {\n        var parent$1 = parent(marker);\n        parent$1.each(function (v) {\n          append(v, element);\n        });\n      }, function (v) {\n        before(v, element);\n      });\n    };\n    var prepend = function (parent, element) {\n      var firstChild$1 = firstChild(parent);\n      firstChild$1.fold(function () {\n        append(parent, element);\n      }, function (v) {\n        parent.dom().insertBefore(element.dom(), v.dom());\n      });\n    };\n    var append = function (parent, element) {\n      parent.dom().appendChild(element.dom());\n    };\n    var wrap = function (element, wrapper) {\n      before(element, wrapper);\n      append(wrapper, element);\n    };\n\n    var before$1 = function (marker, elements) {\n      each(elements, function (x) {\n        before(marker, x);\n      });\n    };\n    var append$1 = function (parent, elements) {\n      each(elements, function (x) {\n        append(parent, x);\n      });\n    };\n\n    var empty = function (element) {\n      element.dom().textContent = '';\n      each(children(element), function (rogue) {\n        remove(rogue);\n      });\n    };\n    var remove = function (element) {\n      var dom = element.dom();\n      if (dom.parentNode !== null) {\n        dom.parentNode.removeChild(dom);\n      }\n    };\n    var unwrap = function (wrapper) {\n      var children$1 = children(wrapper);\n      if (children$1.length > 0) {\n        before$1(wrapper, children$1);\n      }\n      remove(wrapper);\n    };\n\n    var Global = typeof domGlobals.window !== 'undefined' ? domGlobals.window : Function('return this;')();\n\n    var name = function (element) {\n      var r = element.dom().nodeName;\n      return r.toLowerCase();\n    };\n    var type = function (element) {\n      return element.dom().nodeType;\n    };\n    var isType$1 = function (t) {\n      return function (element) {\n        return type(element) === t;\n      };\n    };\n    var isElement = isType$1(ELEMENT);\n    var isText = isType$1(TEXT);\n\n    var inBody = function (element) {\n      var dom = isText(element) ? element.dom().parentNode : element.dom();\n      return dom !== undefined && dom !== null && dom.ownerDocument.body.contains(dom);\n    };\n\n    var r = function (left, top) {\n      var translate = function (x, y) {\n        return r(left + x, top + y);\n      };\n      return {\n        left: constant(left),\n        top: constant(top),\n        translate: translate\n      };\n    };\n    var Position = r;\n\n    var boxPosition = function (dom) {\n      var box = dom.getBoundingClientRect();\n      return Position(box.left, box.top);\n    };\n    var firstDefinedOrZero = function (a, b) {\n      return a !== undefined ? a : b !== undefined ? b : 0;\n    };\n    var absolute = function (element) {\n      var doc = element.dom().ownerDocument;\n      var body = doc.body;\n      var win = doc.defaultView;\n      var html = doc.documentElement;\n      if (body === element.dom()) {\n        return Position(body.offsetLeft, body.offsetTop);\n      }\n      var scrollTop = firstDefinedOrZero(win.pageYOffset, html.scrollTop);\n      var scrollLeft = firstDefinedOrZero(win.pageXOffset, html.scrollLeft);\n      var clientTop = firstDefinedOrZero(html.clientTop, body.clientTop);\n      var clientLeft = firstDefinedOrZero(html.clientLeft, body.clientLeft);\n      return viewport(element).translate(scrollLeft - clientLeft, scrollTop - clientTop);\n    };\n    var viewport = function (element) {\n      var dom = element.dom();\n      var doc = dom.ownerDocument;\n      var body = doc.body;\n      if (body === dom) {\n        return Position(body.offsetLeft, body.offsetTop);\n      }\n      if (!inBody(element)) {\n        return Position(0, 0);\n      }\n      return boxPosition(dom);\n    };\n\n    var isSafari = detect$3().browser.isSafari();\n    var get$1 = function (_DOC) {\n      var doc = _DOC !== undefined ? _DOC.dom() : domGlobals.document;\n      var x = doc.body.scrollLeft || doc.documentElement.scrollLeft;\n      var y = doc.body.scrollTop || doc.documentElement.scrollTop;\n      return Position(x, y);\n    };\n    var to = function (x, y, _DOC) {\n      var doc = _DOC !== undefined ? _DOC.dom() : domGlobals.document;\n      var win = doc.defaultView;\n      win.scrollTo(x, y);\n    };\n    var intoView = function (element, alignToTop) {\n      if (isSafari && isFunction(element.dom().scrollIntoViewIfNeeded)) {\n        element.dom().scrollIntoViewIfNeeded(false);\n      } else {\n        element.dom().scrollIntoView(alignToTop);\n      }\n    };\n\n    var get$2 = function (_win) {\n      var win = _win === undefined ? domGlobals.window : _win;\n      return Option.from(win['visualViewport']);\n    };\n    var bounds = function (x, y, width, height) {\n      return {\n        x: constant(x),\n        y: constant(y),\n        width: constant(width),\n        height: constant(height),\n        right: constant(x + width),\n        bottom: constant(y + height)\n      };\n    };\n    var getBounds = function (_win) {\n      var win = _win === undefined ? domGlobals.window : _win;\n      var doc = win.document;\n      var scroll = get$1(Element.fromDom(doc));\n      return get$2(win).fold(function () {\n        var html = win.document.documentElement;\n        var width = html.clientWidth;\n        var height = html.clientHeight;\n        return bounds(scroll.left(), scroll.top(), width, height);\n      }, function (visualViewport) {\n        return bounds(Math.max(visualViewport.pageLeft, scroll.left()), Math.max(visualViewport.pageTop, scroll.top()), visualViewport.width, visualViewport.height);\n      });\n    };\n\n    var isNodeType = function (type) {\n      return function (node) {\n        return !!node && node.nodeType === type;\n      };\n    };\n    var isRestrictedNode = function (node) {\n      return !!node && !Object.getPrototypeOf(node);\n    };\n    var isElement$1 = isNodeType(1);\n    var matchNodeNames = function (names) {\n      var lowercasedNames = names.map(function (s) {\n        return s.toLowerCase();\n      });\n      return function (node) {\n        if (node && node.nodeName) {\n          var nodeName = node.nodeName.toLowerCase();\n          return contains(lowercasedNames, nodeName);\n        }\n        return false;\n      };\n    };\n    var matchStyleValues = function (name, values) {\n      var items = values.toLowerCase().split(' ');\n      return function (node) {\n        var i, cssValue;\n        if (isElement$1(node)) {\n          for (i = 0; i < items.length; i++) {\n            var computed = node.ownerDocument.defaultView.getComputedStyle(node, null);\n            cssValue = computed ? computed.getPropertyValue(name) : null;\n            if (cssValue === items[i]) {\n              return true;\n            }\n          }\n        }\n        return false;\n      };\n    };\n    var hasPropValue = function (propName, propValue) {\n      return function (node) {\n        return isElement$1(node) && node[propName] === propValue;\n      };\n    };\n    var hasAttribute = function (attrName, attrValue) {\n      return function (node) {\n        return isElement$1(node) && node.hasAttribute(attrName);\n      };\n    };\n    var hasAttributeValue = function (attrName, attrValue) {\n      return function (node) {\n        return isElement$1(node) && node.getAttribute(attrName) === attrValue;\n      };\n    };\n    var isBogus = function (node) {\n      return isElement$1(node) && node.hasAttribute('data-mce-bogus');\n    };\n    var isBogusAll = function (node) {\n      return isElement$1(node) && node.getAttribute('data-mce-bogus') === 'all';\n    };\n    var isTable = function (node) {\n      return isElement$1(node) && node.tagName === 'TABLE';\n    };\n    var hasContentEditableState = function (value) {\n      return function (node) {\n        if (isElement$1(node)) {\n          if (node.contentEditable === value) {\n            return true;\n          }\n          if (node.getAttribute('data-mce-contenteditable') === value) {\n            return true;\n          }\n        }\n        return false;\n      };\n    };\n    var isTextareaOrInput = matchNodeNames([\n      'textarea',\n      'input'\n    ]);\n    var isText$1 = isNodeType(3);\n    var isComment = isNodeType(8);\n    var isDocument = isNodeType(9);\n    var isDocumentFragment = isNodeType(11);\n    var isBr = matchNodeNames(['br']);\n    var isContentEditableTrue = hasContentEditableState('true');\n    var isContentEditableFalse = hasContentEditableState('false');\n    var NodeType = {\n      isText: isText$1,\n      isElement: isElement$1,\n      isComment: isComment,\n      isDocument: isDocument,\n      isDocumentFragment: isDocumentFragment,\n      isBr: isBr,\n      isContentEditableTrue: isContentEditableTrue,\n      isContentEditableFalse: isContentEditableFalse,\n      isRestrictedNode: isRestrictedNode,\n      matchNodeNames: matchNodeNames,\n      hasPropValue: hasPropValue,\n      hasAttribute: hasAttribute,\n      hasAttributeValue: hasAttributeValue,\n      matchStyleValues: matchStyleValues,\n      isBogus: isBogus,\n      isBogusAll: isBogusAll,\n      isTable: isTable,\n      isTextareaOrInput: isTextareaOrInput\n    };\n\n    var isSupported = function (dom) {\n      return dom.style !== undefined && isFunction(dom.style.getPropertyValue);\n    };\n\n    var rawSet = function (dom, key, value) {\n      if (isString(value) || isBoolean(value) || isNumber(value)) {\n        dom.setAttribute(key, value + '');\n      } else {\n        domGlobals.console.error('Invalid call to Attr.set. Key ', key, ':: Value ', value, ':: Element ', dom);\n        throw new Error('Attribute value was not simple');\n      }\n    };\n    var set = function (element, key, value) {\n      rawSet(element.dom(), key, value);\n    };\n    var setAll = function (element, attrs) {\n      var dom = element.dom();\n      each$1(attrs, function (v, k) {\n        rawSet(dom, k, v);\n      });\n    };\n    var get$3 = function (element, key) {\n      var v = element.dom().getAttribute(key);\n      return v === null ? undefined : v;\n    };\n    var getOpt = function (element, key) {\n      return Option.from(get$3(element, key));\n    };\n    var has$1 = function (element, key) {\n      var dom = element.dom();\n      return dom && dom.hasAttribute ? dom.hasAttribute(key) : false;\n    };\n    var remove$1 = function (element, key) {\n      element.dom().removeAttribute(key);\n    };\n\n    var get$4 = function (element, property) {\n      var dom = element.dom();\n      var styles = domGlobals.window.getComputedStyle(dom);\n      var r = styles.getPropertyValue(property);\n      var v = r === '' && !inBody(element) ? getUnsafeProperty(dom, property) : r;\n      return v === null ? undefined : v;\n    };\n    var getUnsafeProperty = function (dom, property) {\n      return isSupported(dom) ? dom.style.getPropertyValue(property) : '';\n    };\n    var getRaw = function (element, property) {\n      var dom = element.dom();\n      var raw = getUnsafeProperty(dom, property);\n      return Option.from(raw).filter(function (r) {\n        return r.length > 0;\n      });\n    };\n    var reflow = function (e) {\n      return e.dom().offsetWidth;\n    };\n\n    var browser$1 = detect$3().browser;\n    var firstElement = function (nodes) {\n      return find(nodes, isElement);\n    };\n    var getTableCaptionDeltaY = function (elm) {\n      if (browser$1.isFirefox() && name(elm) === 'table') {\n        return firstElement(children(elm)).filter(function (elm) {\n          return name(elm) === 'caption';\n        }).bind(function (caption) {\n          return firstElement(nextSiblings(caption)).map(function (body) {\n            var bodyTop = body.dom().offsetTop;\n            var captionTop = caption.dom().offsetTop;\n            var captionHeight = caption.dom().offsetHeight;\n            return bodyTop <= captionTop ? -captionHeight : 0;\n          });\n        }).getOr(0);\n      } else {\n        return 0;\n      }\n    };\n    var hasChild = function (elm, child) {\n      return elm.children && contains(elm.children, child);\n    };\n    var getPos = function (body, elm, rootElm) {\n      var x = 0, y = 0, offsetParent;\n      var doc = body.ownerDocument;\n      var pos;\n      rootElm = rootElm ? rootElm : body;\n      if (elm) {\n        if (rootElm === body && elm.getBoundingClientRect && get$4(Element.fromDom(body), 'position') === 'static') {\n          pos = elm.getBoundingClientRect();\n          x = pos.left + (doc.documentElement.scrollLeft || body.scrollLeft) - doc.documentElement.clientLeft;\n          y = pos.top + (doc.documentElement.scrollTop || body.scrollTop) - doc.documentElement.clientTop;\n          return {\n            x: x,\n            y: y\n          };\n        }\n        offsetParent = elm;\n        while (offsetParent && offsetParent !== rootElm && offsetParent.nodeType && !hasChild(offsetParent, rootElm)) {\n          x += offsetParent.offsetLeft || 0;\n          y += offsetParent.offsetTop || 0;\n          offsetParent = offsetParent.offsetParent;\n        }\n        offsetParent = elm.parentNode;\n        while (offsetParent && offsetParent !== rootElm && offsetParent.nodeType && !hasChild(offsetParent, rootElm)) {\n          x -= offsetParent.scrollLeft || 0;\n          y -= offsetParent.scrollTop || 0;\n          offsetParent = offsetParent.parentNode;\n        }\n        y += getTableCaptionDeltaY(Element.fromDom(elm));\n      }\n      return {\n        x: x,\n        y: y\n      };\n    };\n    var Position$1 = { getPos: getPos };\n\n    var exports$1 = {}, module$1 = { exports: exports$1 };\n    (function (define, exports, module, require) {\n      (function (f) {\n        if (typeof exports === 'object' && typeof module !== 'undefined') {\n          module.exports = f();\n        } else if (typeof define === 'function' && define.amd) {\n          define([], f);\n        } else {\n          var g;\n          if (typeof window !== 'undefined') {\n            g = window;\n          } else if (typeof global !== 'undefined') {\n            g = global;\n          } else if (typeof self !== 'undefined') {\n            g = self;\n          } else {\n            g = this;\n          }\n          g.EphoxContactWrapper = f();\n        }\n      }(function () {\n        return function () {\n          function r(e, n, t) {\n            function o(i, f) {\n              if (!n[i]) {\n                if (!e[i]) {\n                  var c = 'function' == typeof require && require;\n                  if (!f && c)\n                    return c(i, !0);\n                  if (u)\n                    return u(i, !0);\n                  var a = new Error('Cannot find module \\'' + i + '\\'');\n                  throw a.code = 'MODULE_NOT_FOUND', a;\n                }\n                var p = n[i] = { exports: {} };\n                e[i][0].call(p.exports, function (r) {\n                  var n = e[i][1][r];\n                  return o(n || r);\n                }, p, p.exports, r, e, n, t);\n              }\n              return n[i].exports;\n            }\n            for (var u = 'function' == typeof require && require, i = 0; i < t.length; i++)\n              o(t[i]);\n            return o;\n          }\n          return r;\n        }()({\n          1: [\n            function (require, module, exports) {\n              var process = module.exports = {};\n              var cachedSetTimeout;\n              var cachedClearTimeout;\n              function defaultSetTimout() {\n                throw new Error('setTimeout has not been defined');\n              }\n              function defaultClearTimeout() {\n                throw new Error('clearTimeout has not been defined');\n              }\n              (function () {\n                try {\n                  if (typeof setTimeout === 'function') {\n                    cachedSetTimeout = setTimeout;\n                  } else {\n                    cachedSetTimeout = defaultSetTimout;\n                  }\n                } catch (e) {\n                  cachedSetTimeout = defaultSetTimout;\n                }\n                try {\n                  if (typeof clearTimeout === 'function') {\n                    cachedClearTimeout = clearTimeout;\n                  } else {\n                    cachedClearTimeout = defaultClearTimeout;\n                  }\n                } catch (e) {\n                  cachedClearTimeout = defaultClearTimeout;\n                }\n              }());\n              function runTimeout(fun) {\n                if (cachedSetTimeout === setTimeout) {\n                  return setTimeout(fun, 0);\n                }\n                if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n                  cachedSetTimeout = setTimeout;\n                  return setTimeout(fun, 0);\n                }\n                try {\n                  return cachedSetTimeout(fun, 0);\n                } catch (e) {\n                  try {\n                    return cachedSetTimeout.call(null, fun, 0);\n                  } catch (e) {\n                    return cachedSetTimeout.call(this, fun, 0);\n                  }\n                }\n              }\n              function runClearTimeout(marker) {\n                if (cachedClearTimeout === clearTimeout) {\n                  return clearTimeout(marker);\n                }\n                if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n                  cachedClearTimeout = clearTimeout;\n                  return clearTimeout(marker);\n                }\n                try {\n                  return cachedClearTimeout(marker);\n                } catch (e) {\n                  try {\n                    return cachedClearTimeout.call(null, marker);\n                  } catch (e) {\n                    return cachedClearTimeout.call(this, marker);\n                  }\n                }\n              }\n              var queue = [];\n              var draining = false;\n              var currentQueue;\n              var queueIndex = -1;\n              function cleanUpNextTick() {\n                if (!draining || !currentQueue) {\n                  return;\n                }\n                draining = false;\n                if (currentQueue.length) {\n                  queue = currentQueue.concat(queue);\n                } else {\n                  queueIndex = -1;\n                }\n                if (queue.length) {\n                  drainQueue();\n                }\n              }\n              function drainQueue() {\n                if (draining) {\n                  return;\n                }\n                var timeout = runTimeout(cleanUpNextTick);\n                draining = true;\n                var len = queue.length;\n                while (len) {\n                  currentQueue = queue;\n                  queue = [];\n                  while (++queueIndex < len) {\n                    if (currentQueue) {\n                      currentQueue[queueIndex].run();\n                    }\n                  }\n                  queueIndex = -1;\n                  len = queue.length;\n                }\n                currentQueue = null;\n                draining = false;\n                runClearTimeout(timeout);\n              }\n              process.nextTick = function (fun) {\n                var args = new Array(arguments.length - 1);\n                if (arguments.length > 1) {\n                  for (var i = 1; i < arguments.length; i++) {\n                    args[i - 1] = arguments[i];\n                  }\n                }\n                queue.push(new Item(fun, args));\n                if (queue.length === 1 && !draining) {\n                  runTimeout(drainQueue);\n                }\n              };\n              function Item(fun, array) {\n                this.fun = fun;\n                this.array = array;\n              }\n              Item.prototype.run = function () {\n                this.fun.apply(null, this.array);\n              };\n              process.title = 'browser';\n              process.browser = true;\n              process.env = {};\n              process.argv = [];\n              process.version = '';\n              process.versions = {};\n              function noop() {\n              }\n              process.on = noop;\n              process.addListener = noop;\n              process.once = noop;\n              process.off = noop;\n              process.removeListener = noop;\n              process.removeAllListeners = noop;\n              process.emit = noop;\n              process.prependListener = noop;\n              process.prependOnceListener = noop;\n              process.listeners = function (name) {\n                return [];\n              };\n              process.binding = function (name) {\n                throw new Error('process.binding is not supported');\n              };\n              process.cwd = function () {\n                return '/';\n              };\n              process.chdir = function (dir) {\n                throw new Error('process.chdir is not supported');\n              };\n              process.umask = function () {\n                return 0;\n              };\n            },\n            {}\n          ],\n          2: [\n            function (require, module, exports) {\n              (function (setImmediate) {\n                (function (root) {\n                  var setTimeoutFunc = setTimeout;\n                  function noop() {\n                  }\n                  function bind(fn, thisArg) {\n                    return function () {\n                      fn.apply(thisArg, arguments);\n                    };\n                  }\n                  function Promise(fn) {\n                    if (typeof this !== 'object')\n                      throw new TypeError('Promises must be constructed via new');\n                    if (typeof fn !== 'function')\n                      throw new TypeError('not a function');\n                    this._state = 0;\n                    this._handled = false;\n                    this._value = undefined;\n                    this._deferreds = [];\n                    doResolve(fn, this);\n                  }\n                  function handle(self, deferred) {\n                    while (self._state === 3) {\n                      self = self._value;\n                    }\n                    if (self._state === 0) {\n                      self._deferreds.push(deferred);\n                      return;\n                    }\n                    self._handled = true;\n                    Promise._immediateFn(function () {\n                      var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n                      if (cb === null) {\n                        (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n                        return;\n                      }\n                      var ret;\n                      try {\n                        ret = cb(self._value);\n                      } catch (e) {\n                        reject(deferred.promise, e);\n                        return;\n                      }\n                      resolve(deferred.promise, ret);\n                    });\n                  }\n                  function resolve(self, newValue) {\n                    try {\n                      if (newValue === self)\n                        throw new TypeError('A promise cannot be resolved with itself.');\n                      if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n                        var then = newValue.then;\n                        if (newValue instanceof Promise) {\n                          self._state = 3;\n                          self._value = newValue;\n                          finale(self);\n                          return;\n                        } else if (typeof then === 'function') {\n                          doResolve(bind(then, newValue), self);\n                          return;\n                        }\n                      }\n                      self._state = 1;\n                      self._value = newValue;\n                      finale(self);\n                    } catch (e) {\n                      reject(self, e);\n                    }\n                  }\n                  function reject(self, newValue) {\n                    self._state = 2;\n                    self._value = newValue;\n                    finale(self);\n                  }\n                  function finale(self) {\n                    if (self._state === 2 && self._deferreds.length === 0) {\n                      Promise._immediateFn(function () {\n                        if (!self._handled) {\n                          Promise._unhandledRejectionFn(self._value);\n                        }\n                      });\n                    }\n                    for (var i = 0, len = self._deferreds.length; i < len; i++) {\n                      handle(self, self._deferreds[i]);\n                    }\n                    self._deferreds = null;\n                  }\n                  function Handler(onFulfilled, onRejected, promise) {\n                    this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n                    this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n                    this.promise = promise;\n                  }\n                  function doResolve(fn, self) {\n                    var done = false;\n                    try {\n                      fn(function (value) {\n                        if (done)\n                          return;\n                        done = true;\n                        resolve(self, value);\n                      }, function (reason) {\n                        if (done)\n                          return;\n                        done = true;\n                        reject(self, reason);\n                      });\n                    } catch (ex) {\n                      if (done)\n                        return;\n                      done = true;\n                      reject(self, ex);\n                    }\n                  }\n                  Promise.prototype['catch'] = function (onRejected) {\n                    return this.then(null, onRejected);\n                  };\n                  Promise.prototype.then = function (onFulfilled, onRejected) {\n                    var prom = new this.constructor(noop);\n                    handle(this, new Handler(onFulfilled, onRejected, prom));\n                    return prom;\n                  };\n                  Promise.all = function (arr) {\n                    var args = Array.prototype.slice.call(arr);\n                    return new Promise(function (resolve, reject) {\n                      if (args.length === 0)\n                        return resolve([]);\n                      var remaining = args.length;\n                      function res(i, val) {\n                        try {\n                          if (val && (typeof val === 'object' || typeof val === 'function')) {\n                            var then = val.then;\n                            if (typeof then === 'function') {\n                              then.call(val, function (val) {\n                                res(i, val);\n                              }, reject);\n                              return;\n                            }\n                          }\n                          args[i] = val;\n                          if (--remaining === 0) {\n                            resolve(args);\n                          }\n                        } catch (ex) {\n                          reject(ex);\n                        }\n                      }\n                      for (var i = 0; i < args.length; i++) {\n                        res(i, args[i]);\n                      }\n                    });\n                  };\n                  Promise.resolve = function (value) {\n                    if (value && typeof value === 'object' && value.constructor === Promise) {\n                      return value;\n                    }\n                    return new Promise(function (resolve) {\n                      resolve(value);\n                    });\n                  };\n                  Promise.reject = function (value) {\n                    return new Promise(function (resolve, reject) {\n                      reject(value);\n                    });\n                  };\n                  Promise.race = function (values) {\n                    return new Promise(function (resolve, reject) {\n                      for (var i = 0, len = values.length; i < len; i++) {\n                        values[i].then(resolve, reject);\n                      }\n                    });\n                  };\n                  Promise._immediateFn = typeof setImmediate === 'function' ? function (fn) {\n                    setImmediate(fn);\n                  } : function (fn) {\n                    setTimeoutFunc(fn, 0);\n                  };\n                  Promise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n                    if (typeof console !== 'undefined' && console) {\n                      console.warn('Possible Unhandled Promise Rejection:', err);\n                    }\n                  };\n                  Promise._setImmediateFn = function _setImmediateFn(fn) {\n                    Promise._immediateFn = fn;\n                  };\n                  Promise._setUnhandledRejectionFn = function _setUnhandledRejectionFn(fn) {\n                    Promise._unhandledRejectionFn = fn;\n                  };\n                  if (typeof module !== 'undefined' && module.exports) {\n                    module.exports = Promise;\n                  } else if (!root.Promise) {\n                    root.Promise = Promise;\n                  }\n                }(this));\n              }.call(this, require('timers').setImmediate));\n            },\n            { 'timers': 3 }\n          ],\n          3: [\n            function (require, module, exports) {\n              (function (setImmediate, clearImmediate) {\n                var nextTick = require('process/browser.js').nextTick;\n                var apply = Function.prototype.apply;\n                var slice = Array.prototype.slice;\n                var immediateIds = {};\n                var nextImmediateId = 0;\n                exports.setTimeout = function () {\n                  return new Timeout(apply.call(setTimeout, window, arguments), clearTimeout);\n                };\n                exports.setInterval = function () {\n                  return new Timeout(apply.call(setInterval, window, arguments), clearInterval);\n                };\n                exports.clearTimeout = exports.clearInterval = function (timeout) {\n                  timeout.close();\n                };\n                function Timeout(id, clearFn) {\n                  this._id = id;\n                  this._clearFn = clearFn;\n                }\n                Timeout.prototype.unref = Timeout.prototype.ref = function () {\n                };\n                Timeout.prototype.close = function () {\n                  this._clearFn.call(window, this._id);\n                };\n                exports.enroll = function (item, msecs) {\n                  clearTimeout(item._idleTimeoutId);\n                  item._idleTimeout = msecs;\n                };\n                exports.unenroll = function (item) {\n                  clearTimeout(item._idleTimeoutId);\n                  item._idleTimeout = -1;\n                };\n                exports._unrefActive = exports.active = function (item) {\n                  clearTimeout(item._idleTimeoutId);\n                  var msecs = item._idleTimeout;\n                  if (msecs >= 0) {\n                    item._idleTimeoutId = setTimeout(function onTimeout() {\n                      if (item._onTimeout)\n                        item._onTimeout();\n                    }, msecs);\n                  }\n                };\n                exports.setImmediate = typeof setImmediate === 'function' ? setImmediate : function (fn) {\n                  var id = nextImmediateId++;\n                  var args = arguments.length < 2 ? false : slice.call(arguments, 1);\n                  immediateIds[id] = true;\n                  nextTick(function onNextTick() {\n                    if (immediateIds[id]) {\n                      if (args) {\n                        fn.apply(null, args);\n                      } else {\n                        fn.call(null);\n                      }\n                      exports.clearImmediate(id);\n                    }\n                  });\n                  return id;\n                };\n                exports.clearImmediate = typeof clearImmediate === 'function' ? clearImmediate : function (id) {\n                  delete immediateIds[id];\n                };\n              }.call(this, require('timers').setImmediate, require('timers').clearImmediate));\n            },\n            {\n              'process/browser.js': 1,\n              'timers': 3\n            }\n          ],\n          4: [\n            function (require, module, exports) {\n              var promisePolyfill = require('promise-polyfill');\n              var Global = function () {\n                if (typeof window !== 'undefined') {\n                  return window;\n                } else {\n                  return Function('return this;')();\n                }\n              }();\n              module.exports = { boltExport: Global.Promise || promisePolyfill };\n            },\n            { 'promise-polyfill': 2 }\n          ]\n        }, {}, [4])(4);\n      }));\n    }(undefined, exports$1, module$1, undefined));\n    var Promise = module$1.exports.boltExport;\n\n    var nu$3 = function (baseFn) {\n      var data = Option.none();\n      var callbacks = [];\n      var map = function (f) {\n        return nu$3(function (nCallback) {\n          get(function (data) {\n            nCallback(f(data));\n          });\n        });\n      };\n      var get = function (nCallback) {\n        if (isReady()) {\n          call(nCallback);\n        } else {\n          callbacks.push(nCallback);\n        }\n      };\n      var set = function (x) {\n        data = Option.some(x);\n        run(callbacks);\n        callbacks = [];\n      };\n      var isReady = function () {\n        return data.isSome();\n      };\n      var run = function (cbs) {\n        each(cbs, call);\n      };\n      var call = function (cb) {\n        data.each(function (x) {\n          domGlobals.setTimeout(function () {\n            cb(x);\n          }, 0);\n        });\n      };\n      baseFn(set);\n      return {\n        get: get,\n        map: map,\n        isReady: isReady\n      };\n    };\n    var pure = function (a) {\n      return nu$3(function (callback) {\n        callback(a);\n      });\n    };\n    var LazyValue = {\n      nu: nu$3,\n      pure: pure\n    };\n\n    var errorReporter = function (err) {\n      domGlobals.setTimeout(function () {\n        throw err;\n      }, 0);\n    };\n    var make = function (run) {\n      var get = function (callback) {\n        run().then(callback, errorReporter);\n      };\n      var map = function (fab) {\n        return make(function () {\n          return run().then(fab);\n        });\n      };\n      var bind = function (aFutureB) {\n        return make(function () {\n          return run().then(function (v) {\n            return aFutureB(v).toPromise();\n          });\n        });\n      };\n      var anonBind = function (futureB) {\n        return make(function () {\n          return run().then(function () {\n            return futureB.toPromise();\n          });\n        });\n      };\n      var toLazy = function () {\n        return LazyValue.nu(get);\n      };\n      var toCached = function () {\n        var cache = null;\n        return make(function () {\n          if (cache === null) {\n            cache = run();\n          }\n          return cache;\n        });\n      };\n      var toPromise = run;\n      return {\n        map: map,\n        bind: bind,\n        anonBind: anonBind,\n        toLazy: toLazy,\n        toCached: toCached,\n        toPromise: toPromise,\n        get: get\n      };\n    };\n    var nu$4 = function (baseFn) {\n      return make(function () {\n        return new Promise(baseFn);\n      });\n    };\n    var pure$1 = function (a) {\n      return make(function () {\n        return Promise.resolve(a);\n      });\n    };\n    var Future = {\n      nu: nu$4,\n      pure: pure$1\n    };\n\n    var par = function (asyncValues, nu) {\n      return nu(function (callback) {\n        var r = [];\n        var count = 0;\n        var cb = function (i) {\n          return function (value) {\n            r[i] = value;\n            count++;\n            if (count >= asyncValues.length) {\n              callback(r);\n            }\n          };\n        };\n        if (asyncValues.length === 0) {\n          callback([]);\n        } else {\n          each(asyncValues, function (asyncValue, i) {\n            asyncValue.get(cb(i));\n          });\n        }\n      });\n    };\n\n    var par$1 = function (futures) {\n      return par(futures, Future.nu);\n    };\n\n    var value = function (o) {\n      var is = function (v) {\n        return o === v;\n      };\n      var or = function (opt) {\n        return value(o);\n      };\n      var orThunk = function (f) {\n        return value(o);\n      };\n      var map = function (f) {\n        return value(f(o));\n      };\n      var mapError = function (f) {\n        return value(o);\n      };\n      var each = function (f) {\n        f(o);\n      };\n      var bind = function (f) {\n        return f(o);\n      };\n      var fold = function (_, onValue) {\n        return onValue(o);\n      };\n      var exists = function (f) {\n        return f(o);\n      };\n      var forall = function (f) {\n        return f(o);\n      };\n      var toOption = function () {\n        return Option.some(o);\n      };\n      return {\n        is: is,\n        isValue: always,\n        isError: never,\n        getOr: constant(o),\n        getOrThunk: constant(o),\n        getOrDie: constant(o),\n        or: or,\n        orThunk: orThunk,\n        fold: fold,\n        map: map,\n        mapError: mapError,\n        each: each,\n        bind: bind,\n        exists: exists,\n        forall: forall,\n        toOption: toOption\n      };\n    };\n    var error = function (message) {\n      var getOrThunk = function (f) {\n        return f();\n      };\n      var getOrDie = function () {\n        return die(String(message))();\n      };\n      var or = function (opt) {\n        return opt;\n      };\n      var orThunk = function (f) {\n        return f();\n      };\n      var map = function (f) {\n        return error(message);\n      };\n      var mapError = function (f) {\n        return error(f(message));\n      };\n      var bind = function (f) {\n        return error(message);\n      };\n      var fold = function (onError, _) {\n        return onError(message);\n      };\n      return {\n        is: never,\n        isValue: never,\n        isError: always,\n        getOr: identity,\n        getOrThunk: getOrThunk,\n        getOrDie: getOrDie,\n        or: or,\n        orThunk: orThunk,\n        fold: fold,\n        map: map,\n        mapError: mapError,\n        each: noop,\n        bind: bind,\n        exists: never,\n        forall: always,\n        toOption: Option.none\n      };\n    };\n    var fromOption = function (opt, err) {\n      return opt.fold(function () {\n        return error(err);\n      }, value);\n    };\n    var Result = {\n      value: value,\n      error: error,\n      fromOption: fromOption\n    };\n\n    var promise = function () {\n      function bind(fn, thisArg) {\n        return function () {\n          fn.apply(thisArg, arguments);\n        };\n      }\n      var isArray = Array.isArray || function (value) {\n        return Object.prototype.toString.call(value) === '[object Array]';\n      };\n      var Promise = function (fn) {\n        if (typeof this !== 'object') {\n          throw new TypeError('Promises must be constructed via new');\n        }\n        if (typeof fn !== 'function') {\n          throw new TypeError('not a function');\n        }\n        this._state = null;\n        this._value = null;\n        this._deferreds = [];\n        doResolve(fn, bind(resolve, this), bind(reject, this));\n      };\n      var asap = Promise.immediateFn || typeof domGlobals.setImmediate === 'function' && domGlobals.setImmediate || function (fn) {\n        domGlobals.setTimeout(fn, 1);\n      };\n      function handle(deferred) {\n        var me = this;\n        if (this._state === null) {\n          this._deferreds.push(deferred);\n          return;\n        }\n        asap(function () {\n          var cb = me._state ? deferred.onFulfilled : deferred.onRejected;\n          if (cb === null) {\n            (me._state ? deferred.resolve : deferred.reject)(me._value);\n            return;\n          }\n          var ret;\n          try {\n            ret = cb(me._value);\n          } catch (e) {\n            deferred.reject(e);\n            return;\n          }\n          deferred.resolve(ret);\n        });\n      }\n      function resolve(newValue) {\n        try {\n          if (newValue === this) {\n            throw new TypeError('A promise cannot be resolved with itself.');\n          }\n          if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n            var then = newValue.then;\n            if (typeof then === 'function') {\n              doResolve(bind(then, newValue), bind(resolve, this), bind(reject, this));\n              return;\n            }\n          }\n          this._state = true;\n          this._value = newValue;\n          finale.call(this);\n        } catch (e) {\n          reject.call(this, e);\n        }\n      }\n      function reject(newValue) {\n        this._state = false;\n        this._value = newValue;\n        finale.call(this);\n      }\n      function finale() {\n        for (var i = 0, len = this._deferreds.length; i < len; i++) {\n          handle.call(this, this._deferreds[i]);\n        }\n        this._deferreds = null;\n      }\n      function Handler(onFulfilled, onRejected, resolve, reject) {\n        this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n        this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n        this.resolve = resolve;\n        this.reject = reject;\n      }\n      function doResolve(fn, onFulfilled, onRejected) {\n        var done = false;\n        try {\n          fn(function (value) {\n            if (done) {\n              return;\n            }\n            done = true;\n            onFulfilled(value);\n          }, function (reason) {\n            if (done) {\n              return;\n            }\n            done = true;\n            onRejected(reason);\n          });\n        } catch (ex) {\n          if (done) {\n            return;\n          }\n          done = true;\n          onRejected(ex);\n        }\n      }\n      Promise.prototype.catch = function (onRejected) {\n        return this.then(null, onRejected);\n      };\n      Promise.prototype.then = function (onFulfilled, onRejected) {\n        var me = this;\n        return new Promise(function (resolve, reject) {\n          handle.call(me, new Handler(onFulfilled, onRejected, resolve, reject));\n        });\n      };\n      Promise.all = function () {\n        var args = Array.prototype.slice.call(arguments.length === 1 && isArray(arguments[0]) ? arguments[0] : arguments);\n        return new Promise(function (resolve, reject) {\n          if (args.length === 0) {\n            return resolve([]);\n          }\n          var remaining = args.length;\n          function res(i, val) {\n            try {\n              if (val && (typeof val === 'object' || typeof val === 'function')) {\n                var then = val.then;\n                if (typeof then === 'function') {\n                  then.call(val, function (val) {\n                    res(i, val);\n                  }, reject);\n                  return;\n                }\n              }\n              args[i] = val;\n              if (--remaining === 0) {\n                resolve(args);\n              }\n            } catch (ex) {\n              reject(ex);\n            }\n          }\n          for (var i = 0; i < args.length; i++) {\n            res(i, args[i]);\n          }\n        });\n      };\n      Promise.resolve = function (value) {\n        if (value && typeof value === 'object' && value.constructor === Promise) {\n          return value;\n        }\n        return new Promise(function (resolve) {\n          resolve(value);\n        });\n      };\n      Promise.reject = function (value) {\n        return new Promise(function (resolve, reject) {\n          reject(value);\n        });\n      };\n      Promise.race = function (values) {\n        return new Promise(function (resolve, reject) {\n          for (var i = 0, len = values.length; i < len; i++) {\n            values[i].then(resolve, reject);\n          }\n        });\n      };\n      return Promise;\n    };\n    var promiseObj = window.Promise ? window.Promise : promise();\n\n    var requestAnimationFramePromise;\n    var requestAnimationFrame = function (callback, element) {\n      var i, requestAnimationFrameFunc = domGlobals.window.requestAnimationFrame;\n      var vendors = [\n        'ms',\n        'moz',\n        'webkit'\n      ];\n      var featurefill = function (callback) {\n        domGlobals.window.setTimeout(callback, 0);\n      };\n      for (i = 0; i < vendors.length && !requestAnimationFrameFunc; i++) {\n        requestAnimationFrameFunc = domGlobals.window[vendors[i] + 'RequestAnimationFrame'];\n      }\n      if (!requestAnimationFrameFunc) {\n        requestAnimationFrameFunc = featurefill;\n      }\n      requestAnimationFrameFunc(callback, element);\n    };\n    var wrappedSetTimeout = function (callback, time) {\n      if (typeof time !== 'number') {\n        time = 0;\n      }\n      return domGlobals.setTimeout(callback, time);\n    };\n    var wrappedSetInterval = function (callback, time) {\n      if (typeof time !== 'number') {\n        time = 1;\n      }\n      return domGlobals.setInterval(callback, time);\n    };\n    var wrappedClearTimeout = function (id) {\n      return domGlobals.clearTimeout(id);\n    };\n    var wrappedClearInterval = function (id) {\n      return domGlobals.clearInterval(id);\n    };\n    var debounce = function (callback, time) {\n      var timer, func;\n      func = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        domGlobals.clearTimeout(timer);\n        timer = wrappedSetTimeout(function () {\n          callback.apply(this, args);\n        }, time);\n      };\n      func.stop = function () {\n        domGlobals.clearTimeout(timer);\n      };\n      return func;\n    };\n    var Delay = {\n      requestAnimationFrame: function (callback, element) {\n        if (requestAnimationFramePromise) {\n          requestAnimationFramePromise.then(callback);\n          return;\n        }\n        requestAnimationFramePromise = new promiseObj(function (resolve) {\n          if (!element) {\n            element = domGlobals.document.body;\n          }\n          requestAnimationFrame(resolve, element);\n        }).then(callback);\n      },\n      setTimeout: wrappedSetTimeout,\n      setInterval: wrappedSetInterval,\n      setEditorTimeout: function (editor, callback, time) {\n        return wrappedSetTimeout(function () {\n          if (!editor.removed) {\n            callback();\n          }\n        }, time);\n      },\n      setEditorInterval: function (editor, callback, time) {\n        var timer;\n        timer = wrappedSetInterval(function () {\n          if (!editor.removed) {\n            callback();\n          } else {\n            domGlobals.clearInterval(timer);\n          }\n        }, time);\n        return timer;\n      },\n      debounce: debounce,\n      throttle: debounce,\n      clearInterval: wrappedClearInterval,\n      clearTimeout: wrappedClearTimeout\n    };\n\n    var userAgent = domGlobals.navigator.userAgent;\n    var platform$1 = detect$3();\n    var browser$2 = platform$1.browser;\n    var os = platform$1.os;\n    var deviceType = platform$1.deviceType;\n    var webkit = /WebKit/.test(userAgent) && !browser$2.isEdge();\n    var fileApi = 'FormData' in domGlobals.window && 'FileReader' in domGlobals.window && 'URL' in domGlobals.window && !!domGlobals.URL.createObjectURL;\n    var windowsPhone = userAgent.indexOf('Windows Phone') !== -1;\n    var Env = {\n      opera: browser$2.isOpera(),\n      webkit: webkit,\n      ie: browser$2.isIE() || browser$2.isEdge() ? browser$2.version.major : false,\n      gecko: browser$2.isFirefox(),\n      mac: os.isOSX() || os.isiOS(),\n      iOS: deviceType.isiPad() || deviceType.isiPhone(),\n      android: os.isAndroid(),\n      contentEditable: true,\n      transparentSrc: 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7',\n      caretAfter: true,\n      range: domGlobals.window.getSelection && 'Range' in domGlobals.window,\n      documentMode: browser$2.isIE() ? domGlobals.document.documentMode || 7 : 10,\n      fileApi: fileApi,\n      ceFalse: true,\n      cacheSuffix: null,\n      container: null,\n      experimentalShadowDom: false,\n      canHaveCSP: !browser$2.isIE(),\n      desktop: deviceType.isDesktop(),\n      windowsPhone: windowsPhone,\n      browser: {\n        current: browser$2.current,\n        version: browser$2.version,\n        isChrome: browser$2.isChrome,\n        isEdge: browser$2.isEdge,\n        isFirefox: browser$2.isFirefox,\n        isIE: browser$2.isIE,\n        isOpera: browser$2.isOpera,\n        isSafari: browser$2.isSafari\n      },\n      os: {\n        current: os.current,\n        version: os.version,\n        isAndroid: os.isAndroid,\n        isChromeOS: os.isChromeOS,\n        isFreeBSD: os.isFreeBSD,\n        isiOS: os.isiOS,\n        isLinux: os.isLinux,\n        isOSX: os.isOSX,\n        isSolaris: os.isSolaris,\n        isWindows: os.isWindows\n      },\n      deviceType: {\n        isDesktop: deviceType.isDesktop,\n        isiPad: deviceType.isiPad,\n        isiPhone: deviceType.isiPhone,\n        isPhone: deviceType.isPhone,\n        isTablet: deviceType.isTablet,\n        isTouch: deviceType.isTouch,\n        isWebView: deviceType.isWebView\n      }\n    };\n\n    var isArray$1 = Array.isArray;\n    var toArray$1 = function (obj) {\n      var array = obj, i, l;\n      if (!isArray$1(obj)) {\n        array = [];\n        for (i = 0, l = obj.length; i < l; i++) {\n          array[i] = obj[i];\n        }\n      }\n      return array;\n    };\n    var each$2 = function (o, cb, s) {\n      var n, l;\n      if (!o) {\n        return 0;\n      }\n      s = s || o;\n      if (o.length !== undefined) {\n        for (n = 0, l = o.length; n < l; n++) {\n          if (cb.call(s, o[n], n, o) === false) {\n            return 0;\n          }\n        }\n      } else {\n        for (n in o) {\n          if (o.hasOwnProperty(n)) {\n            if (cb.call(s, o[n], n, o) === false) {\n              return 0;\n            }\n          }\n        }\n      }\n      return 1;\n    };\n    var map$2 = function (array, callback) {\n      var out = [];\n      each$2(array, function (item, index) {\n        out.push(callback(item, index, array));\n      });\n      return out;\n    };\n    var filter$1 = function (a, f) {\n      var o = [];\n      each$2(a, function (v, index) {\n        if (!f || f(v, index, a)) {\n          o.push(v);\n        }\n      });\n      return o;\n    };\n    var indexOf$1 = function (a, v) {\n      var i, l;\n      if (a) {\n        for (i = 0, l = a.length; i < l; i++) {\n          if (a[i] === v) {\n            return i;\n          }\n        }\n      }\n      return -1;\n    };\n    var reduce = function (collection, iteratee, accumulator, thisArg) {\n      var i = 0;\n      if (arguments.length < 3) {\n        accumulator = collection[0];\n      }\n      for (; i < collection.length; i++) {\n        accumulator = iteratee.call(thisArg, accumulator, collection[i], i);\n      }\n      return accumulator;\n    };\n    var findIndex$1 = function (array, predicate, thisArg) {\n      var i, l;\n      for (i = 0, l = array.length; i < l; i++) {\n        if (predicate.call(thisArg, array[i], i, array)) {\n          return i;\n        }\n      }\n      return -1;\n    };\n    var find$2 = function (array, predicate, thisArg) {\n      var idx = findIndex$1(array, predicate, thisArg);\n      if (idx !== -1) {\n        return array[idx];\n      }\n      return undefined;\n    };\n    var last$1 = function (collection) {\n      return collection[collection.length - 1];\n    };\n    var ArrUtils = {\n      isArray: isArray$1,\n      toArray: toArray$1,\n      each: each$2,\n      map: map$2,\n      filter: filter$1,\n      indexOf: indexOf$1,\n      reduce: reduce,\n      findIndex: findIndex$1,\n      find: find$2,\n      last: last$1\n    };\n\n    var whiteSpaceRegExp = /^\\s*|\\s*$/g;\n    var trim$1 = function (str) {\n      return str === null || str === undefined ? '' : ('' + str).replace(whiteSpaceRegExp, '');\n    };\n    var is$1 = function (obj, type) {\n      if (!type) {\n        return obj !== undefined;\n      }\n      if (type === 'array' && ArrUtils.isArray(obj)) {\n        return true;\n      }\n      return typeof obj === type;\n    };\n    var makeMap = function (items, delim, map) {\n      var i;\n      items = items || [];\n      delim = delim || ',';\n      if (typeof items === 'string') {\n        items = items.split(delim);\n      }\n      map = map || {};\n      i = items.length;\n      while (i--) {\n        map[items[i]] = {};\n      }\n      return map;\n    };\n    var hasOwnProperty$1 = function (obj, prop) {\n      return Object.prototype.hasOwnProperty.call(obj, prop);\n    };\n    var create = function (s, p, root) {\n      var self = this;\n      var sp, ns, cn, scn, c, de = 0;\n      s = /^((static) )?([\\w.]+)(:([\\w.]+))?/.exec(s);\n      cn = s[3].match(/(^|\\.)(\\w+)$/i)[2];\n      ns = self.createNS(s[3].replace(/\\.\\w+$/, ''), root);\n      if (ns[cn]) {\n        return;\n      }\n      if (s[2] === 'static') {\n        ns[cn] = p;\n        if (this.onCreate) {\n          this.onCreate(s[2], s[3], ns[cn]);\n        }\n        return;\n      }\n      if (!p[cn]) {\n        p[cn] = function () {\n        };\n        de = 1;\n      }\n      ns[cn] = p[cn];\n      self.extend(ns[cn].prototype, p);\n      if (s[5]) {\n        sp = self.resolve(s[5]).prototype;\n        scn = s[5].match(/\\.(\\w+)$/i)[1];\n        c = ns[cn];\n        if (de) {\n          ns[cn] = function () {\n            return sp[scn].apply(this, arguments);\n          };\n        } else {\n          ns[cn] = function () {\n            this.parent = sp[scn];\n            return c.apply(this, arguments);\n          };\n        }\n        ns[cn].prototype[cn] = ns[cn];\n        self.each(sp, function (f, n) {\n          ns[cn].prototype[n] = sp[n];\n        });\n        self.each(p, function (f, n) {\n          if (sp[n]) {\n            ns[cn].prototype[n] = function () {\n              this.parent = sp[n];\n              return f.apply(this, arguments);\n            };\n          } else {\n            if (n !== cn) {\n              ns[cn].prototype[n] = f;\n            }\n          }\n        });\n      }\n      self.each(p.static, function (f, n) {\n        ns[cn][n] = f;\n      });\n    };\n    var extend = function (obj, ext) {\n      var x = [];\n      for (var _i = 2; _i < arguments.length; _i++) {\n        x[_i - 2] = arguments[_i];\n      }\n      var i, l, name;\n      var args = arguments;\n      var value;\n      for (i = 1, l = args.length; i < l; i++) {\n        ext = args[i];\n        for (name in ext) {\n          if (ext.hasOwnProperty(name)) {\n            value = ext[name];\n            if (value !== undefined) {\n              obj[name] = value;\n            }\n          }\n        }\n      }\n      return obj;\n    };\n    var walk = function (o, f, n, s) {\n      s = s || this;\n      if (o) {\n        if (n) {\n          o = o[n];\n        }\n        ArrUtils.each(o, function (o, i) {\n          if (f.call(s, o, i, n) === false) {\n            return false;\n          }\n          walk(o, f, n, s);\n        });\n      }\n    };\n    var createNS = function (n, o) {\n      var i, v;\n      o = o || domGlobals.window;\n      n = n.split('.');\n      for (i = 0; i < n.length; i++) {\n        v = n[i];\n        if (!o[v]) {\n          o[v] = {};\n        }\n        o = o[v];\n      }\n      return o;\n    };\n    var resolve = function (n, o) {\n      var i, l;\n      o = o || domGlobals.window;\n      n = n.split('.');\n      for (i = 0, l = n.length; i < l; i++) {\n        o = o[n[i]];\n        if (!o) {\n          break;\n        }\n      }\n      return o;\n    };\n    var explode = function (s, d) {\n      if (!s || is$1(s, 'array')) {\n        return s;\n      }\n      return ArrUtils.map(s.split(d || ','), trim$1);\n    };\n    var _addCacheSuffix = function (url) {\n      var cacheSuffix = Env.cacheSuffix;\n      if (cacheSuffix) {\n        url += (url.indexOf('?') === -1 ? '?' : '&') + cacheSuffix;\n      }\n      return url;\n    };\n    var Tools = {\n      trim: trim$1,\n      isArray: ArrUtils.isArray,\n      is: is$1,\n      toArray: ArrUtils.toArray,\n      makeMap: makeMap,\n      each: ArrUtils.each,\n      map: ArrUtils.map,\n      grep: ArrUtils.filter,\n      inArray: ArrUtils.indexOf,\n      hasOwn: hasOwnProperty$1,\n      extend: extend,\n      create: create,\n      walk: walk,\n      createNS: createNS,\n      resolve: resolve,\n      explode: explode,\n      _addCacheSuffix: _addCacheSuffix\n    };\n\n    function StyleSheetLoader(document, settings) {\n      if (settings === void 0) {\n        settings = {};\n      }\n      var idCount = 0;\n      var loadedStates = {};\n      var maxLoadTime;\n      maxLoadTime = settings.maxLoadTime || 5000;\n      var _setReferrerPolicy = function (referrerPolicy) {\n        settings.referrerPolicy = referrerPolicy;\n      };\n      var appendToHead = function (node) {\n        document.getElementsByTagName('head')[0].appendChild(node);\n      };\n      var load = function (url, loadedCallback, errorCallback) {\n        var link, style, startTime, state;\n        var resolve = function (status) {\n          state.status = status;\n          state.passed = [];\n          state.failed = [];\n          if (link) {\n            link.onload = null;\n            link.onerror = null;\n            link = null;\n          }\n        };\n        var passed = function () {\n          var callbacks = state.passed;\n          var i = callbacks.length;\n          while (i--) {\n            callbacks[i]();\n          }\n          resolve(2);\n        };\n        var failed = function () {\n          var callbacks = state.failed;\n          var i = callbacks.length;\n          while (i--) {\n            callbacks[i]();\n          }\n          resolve(3);\n        };\n        var isOldWebKit = function () {\n          var webKitChunks = domGlobals.navigator.userAgent.match(/WebKit\\/(\\d*)/);\n          return !!(webKitChunks && parseInt(webKitChunks[1], 10) < 536);\n        };\n        var wait = function (testCallback, waitCallback) {\n          if (!testCallback()) {\n            if (new Date().getTime() - startTime < maxLoadTime) {\n              Delay.setTimeout(waitCallback);\n            } else {\n              failed();\n            }\n          }\n        };\n        var waitForWebKitLinkLoaded = function () {\n          wait(function () {\n            var styleSheets = document.styleSheets;\n            var styleSheet, i = styleSheets.length, owner;\n            while (i--) {\n              styleSheet = styleSheets[i];\n              owner = styleSheet.ownerNode ? styleSheet.ownerNode : styleSheet.owningElement;\n              if (owner && owner.id === link.id) {\n                passed();\n                return true;\n              }\n            }\n          }, waitForWebKitLinkLoaded);\n        };\n        var waitForGeckoLinkLoaded = function () {\n          wait(function () {\n            try {\n              var cssRules = style.sheet.cssRules;\n              passed();\n              return !!cssRules;\n            } catch (ex) {\n            }\n          }, waitForGeckoLinkLoaded);\n        };\n        url = Tools._addCacheSuffix(url);\n        if (!loadedStates[url]) {\n          state = {\n            passed: [],\n            failed: []\n          };\n          loadedStates[url] = state;\n        } else {\n          state = loadedStates[url];\n        }\n        if (loadedCallback) {\n          state.passed.push(loadedCallback);\n        }\n        if (errorCallback) {\n          state.failed.push(errorCallback);\n        }\n        if (state.status === 1) {\n          return;\n        }\n        if (state.status === 2) {\n          passed();\n          return;\n        }\n        if (state.status === 3) {\n          failed();\n          return;\n        }\n        state.status = 1;\n        link = document.createElement('link');\n        link.rel = 'stylesheet';\n        link.type = 'text/css';\n        link.id = 'u' + idCount++;\n        link.async = false;\n        link.defer = false;\n        startTime = new Date().getTime();\n        if (settings.contentCssCors) {\n          link.crossOrigin = 'anonymous';\n        }\n        if (settings.referrerPolicy) {\n          set(Element.fromDom(link), 'referrerpolicy', settings.referrerPolicy);\n        }\n        if ('onload' in link && !isOldWebKit()) {\n          link.onload = waitForWebKitLinkLoaded;\n          link.onerror = failed;\n        } else {\n          if (domGlobals.navigator.userAgent.indexOf('Firefox') > 0) {\n            style = document.createElement('style');\n            style.textContent = '@import \"' + url + '\"';\n            waitForGeckoLinkLoaded();\n            appendToHead(style);\n            return;\n          }\n          waitForWebKitLinkLoaded();\n        }\n        appendToHead(link);\n        link.href = url;\n      };\n      var loadF = function (url) {\n        return Future.nu(function (resolve) {\n          load(url, compose(resolve, constant(Result.value(url))), compose(resolve, constant(Result.error(url))));\n        });\n      };\n      var unbox = function (result) {\n        return result.fold(identity, identity);\n      };\n      var loadAll = function (urls, success, failure) {\n        par$1(map(urls, loadF)).get(function (result) {\n          var parts = partition(result, function (r) {\n            return r.isValue();\n          });\n          if (parts.fail.length > 0) {\n            failure(parts.fail.map(unbox));\n          } else {\n            success(parts.pass.map(unbox));\n          }\n        });\n      };\n      return {\n        load: load,\n        loadAll: loadAll,\n        _setReferrerPolicy: _setReferrerPolicy\n      };\n    }\n\n    var blocks = [\n      'article',\n      'aside',\n      'details',\n      'div',\n      'dt',\n      'figcaption',\n      'footer',\n      'form',\n      'fieldset',\n      'header',\n      'hgroup',\n      'html',\n      'main',\n      'nav',\n      'section',\n      'summary',\n      'body',\n      'p',\n      'dl',\n      'multicol',\n      'dd',\n      'figure',\n      'address',\n      'center',\n      'blockquote',\n      'h1',\n      'h2',\n      'h3',\n      'h4',\n      'h5',\n      'h6',\n      'listing',\n      'xmp',\n      'pre',\n      'plaintext',\n      'menu',\n      'dir',\n      'ul',\n      'ol',\n      'li',\n      'hr',\n      'table',\n      'tbody',\n      'thead',\n      'tfoot',\n      'th',\n      'tr',\n      'td',\n      'caption'\n    ];\n    var voids = [\n      'area',\n      'base',\n      'basefont',\n      'br',\n      'col',\n      'frame',\n      'hr',\n      'img',\n      'input',\n      'isindex',\n      'link',\n      'meta',\n      'param',\n      'embed',\n      'source',\n      'wbr',\n      'track'\n    ];\n    var tableCells = [\n      'td',\n      'th'\n    ];\n    var tableSections = [\n      'thead',\n      'tbody',\n      'tfoot'\n    ];\n    var textBlocks = [\n      'h1',\n      'h2',\n      'h3',\n      'h4',\n      'h5',\n      'h6',\n      'p',\n      'div',\n      'address',\n      'pre',\n      'form',\n      'blockquote',\n      'center',\n      'dir',\n      'fieldset',\n      'header',\n      'footer',\n      'article',\n      'section',\n      'hgroup',\n      'aside',\n      'nav',\n      'figure'\n    ];\n    var headings = [\n      'h1',\n      'h2',\n      'h3',\n      'h4',\n      'h5',\n      'h6'\n    ];\n    var listItems = [\n      'li',\n      'dd',\n      'dt'\n    ];\n    var lists = [\n      'ul',\n      'ol',\n      'dl'\n    ];\n    var wsElements = [\n      'pre',\n      'script',\n      'textarea',\n      'style'\n    ];\n    var lazyLookup = function (items) {\n      var lookup;\n      return function (node) {\n        lookup = lookup ? lookup : mapToObject(items, constant(true));\n        return lookup.hasOwnProperty(name(node));\n      };\n    };\n    var isHeading = lazyLookup(headings);\n    var isBlock = lazyLookup(blocks);\n    var isTable$1 = function (node) {\n      return name(node) === 'table';\n    };\n    var isInline = function (node) {\n      return isElement(node) && !isBlock(node);\n    };\n    var isBr$1 = function (node) {\n      return isElement(node) && name(node) === 'br';\n    };\n    var isTextBlock = lazyLookup(textBlocks);\n    var isList = lazyLookup(lists);\n    var isListItem = lazyLookup(listItems);\n    var isVoid = lazyLookup(voids);\n    var isTableSection = lazyLookup(tableSections);\n    var isTableCell = lazyLookup(tableCells);\n    var isWsPreserveElement = lazyLookup(wsElements);\n\n    var surroundedBySpans = function (node) {\n      var previousIsSpan = node.previousSibling && node.previousSibling.nodeName === 'SPAN';\n      var nextIsSpan = node.nextSibling && node.nextSibling.nodeName === 'SPAN';\n      return previousIsSpan && nextIsSpan;\n    };\n    var isBookmarkNode = function (node) {\n      return node && node.tagName === 'SPAN' && node.getAttribute('data-mce-type') === 'bookmark';\n    };\n    var trimNode = function (dom, node) {\n      var i, children = node.childNodes;\n      if (NodeType.isElement(node) && isBookmarkNode(node)) {\n        return;\n      }\n      for (i = children.length - 1; i >= 0; i--) {\n        trimNode(dom, children[i]);\n      }\n      if (NodeType.isDocument(node) === false) {\n        if (NodeType.isText(node) && node.nodeValue.length > 0) {\n          var trimmedLength = Tools.trim(node.nodeValue).length;\n          if (dom.isBlock(node.parentNode) || trimmedLength > 0) {\n            return;\n          }\n          if (trimmedLength === 0 && surroundedBySpans(node)) {\n            return;\n          }\n        } else if (NodeType.isElement(node)) {\n          children = node.childNodes;\n          if (children.length === 1 && isBookmarkNode(children[0])) {\n            node.parentNode.insertBefore(children[0], node);\n          }\n          if (children.length || isVoid(Element.fromDom(node))) {\n            return;\n          }\n        }\n        dom.remove(node);\n      }\n      return node;\n    };\n    var TrimNode = { trimNode: trimNode };\n\n    var makeMap$1 = Tools.makeMap;\n    var namedEntities, baseEntities, reverseEntities;\n    var attrsCharsRegExp = /[&<>\\\"\\u0060\\u007E-\\uD7FF\\uE000-\\uFFEF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]/g;\n    var textCharsRegExp = /[<>&\\u007E-\\uD7FF\\uE000-\\uFFEF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]/g;\n    var rawCharsRegExp = /[<>&\\\"\\']/g;\n    var entityRegExp = /&#([a-z0-9]+);?|&([a-z0-9]+);/gi;\n    var asciiMap = {\n      128: '\\u20AC',\n      130: '\\u201A',\n      131: '\\u0192',\n      132: '\\u201E',\n      133: '\\u2026',\n      134: '\\u2020',\n      135: '\\u2021',\n      136: '\\u02c6',\n      137: '\\u2030',\n      138: '\\u0160',\n      139: '\\u2039',\n      140: '\\u0152',\n      142: '\\u017d',\n      145: '\\u2018',\n      146: '\\u2019',\n      147: '\\u201C',\n      148: '\\u201D',\n      149: '\\u2022',\n      150: '\\u2013',\n      151: '\\u2014',\n      152: '\\u02DC',\n      153: '\\u2122',\n      154: '\\u0161',\n      155: '\\u203A',\n      156: '\\u0153',\n      158: '\\u017e',\n      159: '\\u0178'\n    };\n    baseEntities = {\n      '\"': '&quot;',\n      '\\'': '&#39;',\n      '<': '&lt;',\n      '>': '&gt;',\n      '&': '&amp;',\n      '`': '&#96;'\n    };\n    reverseEntities = {\n      '&lt;': '<',\n      '&gt;': '>',\n      '&amp;': '&',\n      '&quot;': '\"',\n      '&apos;': '\\''\n    };\n    var nativeDecode = function (text) {\n      var elm;\n      elm = Element.fromTag('div').dom();\n      elm.innerHTML = text;\n      return elm.textContent || elm.innerText || text;\n    };\n    var buildEntitiesLookup = function (items, radix) {\n      var i, chr, entity;\n      var lookup = {};\n      if (items) {\n        items = items.split(',');\n        radix = radix || 10;\n        for (i = 0; i < items.length; i += 2) {\n          chr = String.fromCharCode(parseInt(items[i], radix));\n          if (!baseEntities[chr]) {\n            entity = '&' + items[i + 1] + ';';\n            lookup[chr] = entity;\n            lookup[entity] = chr;\n          }\n        }\n        return lookup;\n      }\n    };\n    namedEntities = buildEntitiesLookup('50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,' + '5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,' + '5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,' + '5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,' + '68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,' + '6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,' + '6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,' + '75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,' + '7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,' + '7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,' + 'sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,' + 'st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,' + 't9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,' + 'tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,' + 'u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,' + '81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,' + '8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,' + '8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,' + '8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,' + '8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,' + 'nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,' + 'rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,' + 'Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,' + '80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,' + '811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro', 32);\n    var encodeRaw = function (text, attr) {\n      return text.replace(attr ? attrsCharsRegExp : textCharsRegExp, function (chr) {\n        return baseEntities[chr] || chr;\n      });\n    };\n    var encodeAllRaw = function (text) {\n      return ('' + text).replace(rawCharsRegExp, function (chr) {\n        return baseEntities[chr] || chr;\n      });\n    };\n    var encodeNumeric = function (text, attr) {\n      return text.replace(attr ? attrsCharsRegExp : textCharsRegExp, function (chr) {\n        if (chr.length > 1) {\n          return '&#' + ((chr.charCodeAt(0) - 55296) * 1024 + (chr.charCodeAt(1) - 56320) + 65536) + ';';\n        }\n        return baseEntities[chr] || '&#' + chr.charCodeAt(0) + ';';\n      });\n    };\n    var encodeNamed = function (text, attr, entities) {\n      entities = entities || namedEntities;\n      return text.replace(attr ? attrsCharsRegExp : textCharsRegExp, function (chr) {\n        return baseEntities[chr] || entities[chr] || chr;\n      });\n    };\n    var getEncodeFunc = function (name, entities) {\n      var entitiesMap = buildEntitiesLookup(entities) || namedEntities;\n      var encodeNamedAndNumeric = function (text, attr) {\n        return text.replace(attr ? attrsCharsRegExp : textCharsRegExp, function (chr) {\n          if (baseEntities[chr] !== undefined) {\n            return baseEntities[chr];\n          }\n          if (entitiesMap[chr] !== undefined) {\n            return entitiesMap[chr];\n          }\n          if (chr.length > 1) {\n            return '&#' + ((chr.charCodeAt(0) - 55296) * 1024 + (chr.charCodeAt(1) - 56320) + 65536) + ';';\n          }\n          return '&#' + chr.charCodeAt(0) + ';';\n        });\n      };\n      var encodeCustomNamed = function (text, attr) {\n        return encodeNamed(text, attr, entitiesMap);\n      };\n      var nameMap = makeMap$1(name.replace(/\\+/g, ','));\n      if (nameMap.named && nameMap.numeric) {\n        return encodeNamedAndNumeric;\n      }\n      if (nameMap.named) {\n        if (entities) {\n          return encodeCustomNamed;\n        }\n        return encodeNamed;\n      }\n      if (nameMap.numeric) {\n        return encodeNumeric;\n      }\n      return encodeRaw;\n    };\n    var decode = function (text) {\n      return text.replace(entityRegExp, function (all, numeric) {\n        if (numeric) {\n          if (numeric.charAt(0).toLowerCase() === 'x') {\n            numeric = parseInt(numeric.substr(1), 16);\n          } else {\n            numeric = parseInt(numeric, 10);\n          }\n          if (numeric > 65535) {\n            numeric -= 65536;\n            return String.fromCharCode(55296 + (numeric >> 10), 56320 + (numeric & 1023));\n          }\n          return asciiMap[numeric] || String.fromCharCode(numeric);\n        }\n        return reverseEntities[all] || namedEntities[all] || nativeDecode(all);\n      });\n    };\n    var Entities = {\n      encodeRaw: encodeRaw,\n      encodeAllRaw: encodeAllRaw,\n      encodeNumeric: encodeNumeric,\n      encodeNamed: encodeNamed,\n      getEncodeFunc: getEncodeFunc,\n      decode: decode\n    };\n\n    var mapCache = {}, dummyObj = {};\n    var makeMap$2 = Tools.makeMap, each$3 = Tools.each, extend$1 = Tools.extend, explode$1 = Tools.explode, inArray = Tools.inArray;\n    var split = function (items, delim) {\n      items = Tools.trim(items);\n      return items ? items.split(delim || ' ') : [];\n    };\n    var compileSchema = function (type) {\n      var schema = {};\n      var globalAttributes, blockContent;\n      var phrasingContent, flowContent, html4BlockContent, html4PhrasingContent;\n      var add = function (name, attributes, children) {\n        var ni, attributesOrder, element;\n        var arrayToMap = function (array, obj) {\n          var map = {};\n          var i, l;\n          for (i = 0, l = array.length; i < l; i++) {\n            map[array[i]] = obj || {};\n          }\n          return map;\n        };\n        children = children || [];\n        attributes = attributes || '';\n        if (typeof children === 'string') {\n          children = split(children);\n        }\n        name = split(name);\n        ni = name.length;\n        while (ni--) {\n          attributesOrder = split([\n            globalAttributes,\n            attributes\n          ].join(' '));\n          element = {\n            attributes: arrayToMap(attributesOrder),\n            attributesOrder: attributesOrder,\n            children: arrayToMap(children, dummyObj)\n          };\n          schema[name[ni]] = element;\n        }\n      };\n      var addAttrs = function (name, attributes) {\n        var ni, schemaItem, i, l;\n        name = split(name);\n        ni = name.length;\n        attributes = split(attributes);\n        while (ni--) {\n          schemaItem = schema[name[ni]];\n          for (i = 0, l = attributes.length; i < l; i++) {\n            schemaItem.attributes[attributes[i]] = {};\n            schemaItem.attributesOrder.push(attributes[i]);\n          }\n        }\n      };\n      if (mapCache[type]) {\n        return mapCache[type];\n      }\n      globalAttributes = 'id accesskey class dir lang style tabindex title role';\n      blockContent = 'address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul';\n      phrasingContent = 'a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd ' + 'label map noscript object q s samp script select small span strong sub sup ' + 'textarea u var #text #comment';\n      if (type !== 'html4') {\n        globalAttributes += ' contenteditable contextmenu draggable dropzone ' + 'hidden spellcheck translate';\n        blockContent += ' article aside details dialog figure main header footer hgroup section nav';\n        phrasingContent += ' audio canvas command datalist mark meter output picture ' + 'progress time wbr video ruby bdi keygen';\n      }\n      if (type !== 'html5-strict') {\n        globalAttributes += ' xml:lang';\n        html4PhrasingContent = 'acronym applet basefont big font strike tt';\n        phrasingContent = [\n          phrasingContent,\n          html4PhrasingContent\n        ].join(' ');\n        each$3(split(html4PhrasingContent), function (name) {\n          add(name, '', phrasingContent);\n        });\n        html4BlockContent = 'center dir isindex noframes';\n        blockContent = [\n          blockContent,\n          html4BlockContent\n        ].join(' ');\n        flowContent = [\n          blockContent,\n          phrasingContent\n        ].join(' ');\n        each$3(split(html4BlockContent), function (name) {\n          add(name, '', flowContent);\n        });\n      }\n      flowContent = flowContent || [\n        blockContent,\n        phrasingContent\n      ].join(' ');\n      add('html', 'manifest', 'head body');\n      add('head', '', 'base command link meta noscript script style title');\n      add('title hr noscript br');\n      add('base', 'href target');\n      add('link', 'href rel media hreflang type sizes hreflang');\n      add('meta', 'name http-equiv content charset');\n      add('style', 'media type scoped');\n      add('script', 'src async defer type charset');\n      add('body', 'onafterprint onbeforeprint onbeforeunload onblur onerror onfocus ' + 'onhashchange onload onmessage onoffline ononline onpagehide onpageshow ' + 'onpopstate onresize onscroll onstorage onunload', flowContent);\n      add('address dt dd div caption', '', flowContent);\n      add('h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn', '', phrasingContent);\n      add('blockquote', 'cite', flowContent);\n      add('ol', 'reversed start type', 'li');\n      add('ul', '', 'li');\n      add('li', 'value', flowContent);\n      add('dl', '', 'dt dd');\n      add('a', 'href target rel media hreflang type', phrasingContent);\n      add('q', 'cite', phrasingContent);\n      add('ins del', 'cite datetime', flowContent);\n      add('img', 'src sizes srcset alt usemap ismap width height');\n      add('iframe', 'src name width height', flowContent);\n      add('embed', 'src type width height');\n      add('object', 'data type typemustmatch name usemap form width height', [\n        flowContent,\n        'param'\n      ].join(' '));\n      add('param', 'name value');\n      add('map', 'name', [\n        flowContent,\n        'area'\n      ].join(' '));\n      add('area', 'alt coords shape href target rel media hreflang type');\n      add('table', 'border', 'caption colgroup thead tfoot tbody tr' + (type === 'html4' ? ' col' : ''));\n      add('colgroup', 'span', 'col');\n      add('col', 'span');\n      add('tbody thead tfoot', '', 'tr');\n      add('tr', '', 'td th');\n      add('td', 'colspan rowspan headers', flowContent);\n      add('th', 'colspan rowspan headers scope abbr', flowContent);\n      add('form', 'accept-charset action autocomplete enctype method name novalidate target', flowContent);\n      add('fieldset', 'disabled form name', [\n        flowContent,\n        'legend'\n      ].join(' '));\n      add('label', 'form for', phrasingContent);\n      add('input', 'accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate ' + 'formtarget height list max maxlength min multiple name pattern readonly required size src step type value width');\n      add('button', 'disabled form formaction formenctype formmethod formnovalidate formtarget name type value', type === 'html4' ? flowContent : phrasingContent);\n      add('select', 'disabled form multiple name required size', 'option optgroup');\n      add('optgroup', 'disabled label', 'option');\n      add('option', 'disabled label selected value');\n      add('textarea', 'cols dirname disabled form maxlength name readonly required rows wrap');\n      add('menu', 'type label', [\n        flowContent,\n        'li'\n      ].join(' '));\n      add('noscript', '', flowContent);\n      if (type !== 'html4') {\n        add('wbr');\n        add('ruby', '', [\n          phrasingContent,\n          'rt rp'\n        ].join(' '));\n        add('figcaption', '', flowContent);\n        add('mark rt rp summary bdi', '', phrasingContent);\n        add('canvas', 'width height', flowContent);\n        add('video', 'src crossorigin poster preload autoplay mediagroup loop ' + 'muted controls width height buffered', [\n          flowContent,\n          'track source'\n        ].join(' '));\n        add('audio', 'src crossorigin preload autoplay mediagroup loop muted controls ' + 'buffered volume', [\n          flowContent,\n          'track source'\n        ].join(' '));\n        add('picture', '', 'img source');\n        add('source', 'src srcset type media sizes');\n        add('track', 'kind src srclang label default');\n        add('datalist', '', [\n          phrasingContent,\n          'option'\n        ].join(' '));\n        add('article section nav aside main header footer', '', flowContent);\n        add('hgroup', '', 'h1 h2 h3 h4 h5 h6');\n        add('figure', '', [\n          flowContent,\n          'figcaption'\n        ].join(' '));\n        add('time', 'datetime', phrasingContent);\n        add('dialog', 'open', flowContent);\n        add('command', 'type label icon disabled checked radiogroup command');\n        add('output', 'for form name', phrasingContent);\n        add('progress', 'value max', phrasingContent);\n        add('meter', 'value min max low high optimum', phrasingContent);\n        add('details', 'open', [\n          flowContent,\n          'summary'\n        ].join(' '));\n        add('keygen', 'autofocus challenge disabled form keytype name');\n      }\n      if (type !== 'html5-strict') {\n        addAttrs('script', 'language xml:space');\n        addAttrs('style', 'xml:space');\n        addAttrs('object', 'declare classid code codebase codetype archive standby align border hspace vspace');\n        addAttrs('embed', 'align name hspace vspace');\n        addAttrs('param', 'valuetype type');\n        addAttrs('a', 'charset name rev shape coords');\n        addAttrs('br', 'clear');\n        addAttrs('applet', 'codebase archive code object alt name width height align hspace vspace');\n        addAttrs('img', 'name longdesc align border hspace vspace');\n        addAttrs('iframe', 'longdesc frameborder marginwidth marginheight scrolling align');\n        addAttrs('font basefont', 'size color face');\n        addAttrs('input', 'usemap align');\n        addAttrs('select');\n        addAttrs('textarea');\n        addAttrs('h1 h2 h3 h4 h5 h6 div p legend caption', 'align');\n        addAttrs('ul', 'type compact');\n        addAttrs('li', 'type');\n        addAttrs('ol dl menu dir', 'compact');\n        addAttrs('pre', 'width xml:space');\n        addAttrs('hr', 'align noshade size width');\n        addAttrs('isindex', 'prompt');\n        addAttrs('table', 'summary width frame rules cellspacing cellpadding align bgcolor');\n        addAttrs('col', 'width align char charoff valign');\n        addAttrs('colgroup', 'width align char charoff valign');\n        addAttrs('thead', 'align char charoff valign');\n        addAttrs('tr', 'align char charoff valign bgcolor');\n        addAttrs('th', 'axis align char charoff valign nowrap bgcolor width height');\n        addAttrs('form', 'accept');\n        addAttrs('td', 'abbr axis scope align char charoff valign nowrap bgcolor width height');\n        addAttrs('tfoot', 'align char charoff valign');\n        addAttrs('tbody', 'align char charoff valign');\n        addAttrs('area', 'nohref');\n        addAttrs('body', 'background bgcolor text link vlink alink');\n      }\n      if (type !== 'html4') {\n        addAttrs('input button select textarea', 'autofocus');\n        addAttrs('input textarea', 'placeholder');\n        addAttrs('a', 'download');\n        addAttrs('link script img', 'crossorigin');\n        addAttrs('img', 'loading');\n        addAttrs('iframe', 'sandbox seamless allowfullscreen loading');\n      }\n      each$3(split('a form meter progress dfn'), function (name) {\n        if (schema[name]) {\n          delete schema[name].children[name];\n        }\n      });\n      delete schema.caption.children.table;\n      delete schema.script;\n      mapCache[type] = schema;\n      return schema;\n    };\n    var compileElementMap = function (value, mode) {\n      var styles;\n      if (value) {\n        styles = {};\n        if (typeof value === 'string') {\n          value = { '*': value };\n        }\n        each$3(value, function (value, key) {\n          styles[key] = styles[key.toUpperCase()] = mode === 'map' ? makeMap$2(value, /[, ]/) : explode$1(value, /[, ]/);\n        });\n      }\n      return styles;\n    };\n    function Schema(settings) {\n      var elements = {};\n      var children = {};\n      var patternElements = [];\n      var validStyles;\n      var invalidStyles;\n      var schemaItems;\n      var whiteSpaceElementsMap, selfClosingElementsMap, shortEndedElementsMap, boolAttrMap, validClasses;\n      var blockElementsMap, nonEmptyElementsMap, moveCaretBeforeOnEnterElementsMap, textBlockElementsMap, textInlineElementsMap;\n      var customElementsMap = {}, specialElements = {};\n      var createLookupTable = function (option, defaultValue, extendWith) {\n        var value = settings[option];\n        if (!value) {\n          value = mapCache[option];\n          if (!value) {\n            value = makeMap$2(defaultValue, ' ', makeMap$2(defaultValue.toUpperCase(), ' '));\n            value = extend$1(value, extendWith);\n            mapCache[option] = value;\n          }\n        } else {\n          value = makeMap$2(value, /[, ]/, makeMap$2(value.toUpperCase(), /[, ]/));\n        }\n        return value;\n      };\n      settings = settings || {};\n      schemaItems = compileSchema(settings.schema);\n      if (settings.verify_html === false) {\n        settings.valid_elements = '*[*]';\n      }\n      validStyles = compileElementMap(settings.valid_styles);\n      invalidStyles = compileElementMap(settings.invalid_styles, 'map');\n      validClasses = compileElementMap(settings.valid_classes, 'map');\n      whiteSpaceElementsMap = createLookupTable('whitespace_elements', 'pre script noscript style textarea video audio iframe object code');\n      selfClosingElementsMap = createLookupTable('self_closing_elements', 'colgroup dd dt li option p td tfoot th thead tr');\n      shortEndedElementsMap = createLookupTable('short_ended_elements', 'area base basefont br col frame hr img input isindex link ' + 'meta param embed source wbr track');\n      boolAttrMap = createLookupTable('boolean_attributes', 'checked compact declare defer disabled ismap multiple nohref noresize ' + 'noshade nowrap readonly selected autoplay loop controls');\n      nonEmptyElementsMap = createLookupTable('non_empty_elements', 'td th iframe video audio object ' + 'script pre code', shortEndedElementsMap);\n      moveCaretBeforeOnEnterElementsMap = createLookupTable('move_caret_before_on_enter_elements', 'table', nonEmptyElementsMap);\n      textBlockElementsMap = createLookupTable('text_block_elements', 'h1 h2 h3 h4 h5 h6 p div address pre form ' + 'blockquote center dir fieldset header footer article section hgroup aside main nav figure');\n      blockElementsMap = createLookupTable('block_elements', 'hr table tbody thead tfoot ' + 'th tr td li ol ul caption dl dt dd noscript menu isindex option ' + 'datalist select optgroup figcaption details summary', textBlockElementsMap);\n      textInlineElementsMap = createLookupTable('text_inline_elements', 'span strong b em i font strike u var cite ' + 'dfn code mark q sup sub samp');\n      each$3((settings.special || 'script noscript noframes noembed title style textarea xmp').split(' '), function (name) {\n        specialElements[name] = new RegExp('</' + name + '[^>]*>', 'gi');\n      });\n      var patternToRegExp = function (str) {\n        return new RegExp('^' + str.replace(/([?+*])/g, '.$1') + '$');\n      };\n      var addValidElements = function (validElements) {\n        var ei, el, ai, al, matches, element, attr, attrData, elementName, attrName, attrType, attributes, attributesOrder, prefix, outputName, globalAttributes, globalAttributesOrder, key, value;\n        var elementRuleRegExp = /^([#+\\-])?([^\\[!\\/]+)(?:\\/([^\\[!]+))?(?:(!?)\\[([^\\]]+)\\])?$/, attrRuleRegExp = /^([!\\-])?(\\w+[\\\\:]:\\w+|[^=:<]+)?(?:([=:<])(.*))?$/, hasPatternsRegExp = /[*?+]/;\n        if (validElements) {\n          validElements = split(validElements, ',');\n          if (elements['@']) {\n            globalAttributes = elements['@'].attributes;\n            globalAttributesOrder = elements['@'].attributesOrder;\n          }\n          for (ei = 0, el = validElements.length; ei < el; ei++) {\n            matches = elementRuleRegExp.exec(validElements[ei]);\n            if (matches) {\n              prefix = matches[1];\n              elementName = matches[2];\n              outputName = matches[3];\n              attrData = matches[5];\n              attributes = {};\n              attributesOrder = [];\n              element = {\n                attributes: attributes,\n                attributesOrder: attributesOrder\n              };\n              if (prefix === '#') {\n                element.paddEmpty = true;\n              }\n              if (prefix === '-') {\n                element.removeEmpty = true;\n              }\n              if (matches[4] === '!') {\n                element.removeEmptyAttrs = true;\n              }\n              if (globalAttributes) {\n                for (key in globalAttributes) {\n                  attributes[key] = globalAttributes[key];\n                }\n                attributesOrder.push.apply(attributesOrder, globalAttributesOrder);\n              }\n              if (attrData) {\n                attrData = split(attrData, '|');\n                for (ai = 0, al = attrData.length; ai < al; ai++) {\n                  matches = attrRuleRegExp.exec(attrData[ai]);\n                  if (matches) {\n                    attr = {};\n                    attrType = matches[1];\n                    attrName = matches[2].replace(/[\\\\:]:/g, ':');\n                    prefix = matches[3];\n                    value = matches[4];\n                    if (attrType === '!') {\n                      element.attributesRequired = element.attributesRequired || [];\n                      element.attributesRequired.push(attrName);\n                      attr.required = true;\n                    }\n                    if (attrType === '-') {\n                      delete attributes[attrName];\n                      attributesOrder.splice(inArray(attributesOrder, attrName), 1);\n                      continue;\n                    }\n                    if (prefix) {\n                      if (prefix === '=') {\n                        element.attributesDefault = element.attributesDefault || [];\n                        element.attributesDefault.push({\n                          name: attrName,\n                          value: value\n                        });\n                        attr.defaultValue = value;\n                      }\n                      if (prefix === ':') {\n                        element.attributesForced = element.attributesForced || [];\n                        element.attributesForced.push({\n                          name: attrName,\n                          value: value\n                        });\n                        attr.forcedValue = value;\n                      }\n                      if (prefix === '<') {\n                        attr.validValues = makeMap$2(value, '?');\n                      }\n                    }\n                    if (hasPatternsRegExp.test(attrName)) {\n                      element.attributePatterns = element.attributePatterns || [];\n                      attr.pattern = patternToRegExp(attrName);\n                      element.attributePatterns.push(attr);\n                    } else {\n                      if (!attributes[attrName]) {\n                        attributesOrder.push(attrName);\n                      }\n                      attributes[attrName] = attr;\n                    }\n                  }\n                }\n              }\n              if (!globalAttributes && elementName === '@') {\n                globalAttributes = attributes;\n                globalAttributesOrder = attributesOrder;\n              }\n              if (outputName) {\n                element.outputName = elementName;\n                elements[outputName] = element;\n              }\n              if (hasPatternsRegExp.test(elementName)) {\n                element.pattern = patternToRegExp(elementName);\n                patternElements.push(element);\n              } else {\n                elements[elementName] = element;\n              }\n            }\n          }\n        }\n      };\n      var setValidElements = function (validElements) {\n        elements = {};\n        patternElements = [];\n        addValidElements(validElements);\n        each$3(schemaItems, function (element, name) {\n          children[name] = element.children;\n        });\n      };\n      var addCustomElements = function (customElements) {\n        var customElementRegExp = /^(~)?(.+)$/;\n        if (customElements) {\n          mapCache.text_block_elements = mapCache.block_elements = null;\n          each$3(split(customElements, ','), function (rule) {\n            var matches = customElementRegExp.exec(rule), inline = matches[1] === '~', cloneName = inline ? 'span' : 'div', name = matches[2];\n            children[name] = children[cloneName];\n            customElementsMap[name] = cloneName;\n            if (!inline) {\n              blockElementsMap[name.toUpperCase()] = {};\n              blockElementsMap[name] = {};\n            }\n            if (!elements[name]) {\n              var customRule = elements[cloneName];\n              customRule = extend$1({}, customRule);\n              delete customRule.removeEmptyAttrs;\n              delete customRule.removeEmpty;\n              elements[name] = customRule;\n            }\n            each$3(children, function (element, elmName) {\n              if (element[cloneName]) {\n                children[elmName] = element = extend$1({}, children[elmName]);\n                element[name] = element[cloneName];\n              }\n            });\n          });\n        }\n      };\n      var addValidChildren = function (validChildren) {\n        var childRuleRegExp = /^([+\\-]?)(\\w+)\\[([^\\]]+)\\]$/;\n        mapCache[settings.schema] = null;\n        if (validChildren) {\n          each$3(split(validChildren, ','), function (rule) {\n            var matches = childRuleRegExp.exec(rule);\n            var parent, prefix;\n            if (matches) {\n              prefix = matches[1];\n              if (prefix) {\n                parent = children[matches[2]];\n              } else {\n                parent = children[matches[2]] = { '#comment': {} };\n              }\n              parent = children[matches[2]];\n              each$3(split(matches[3], '|'), function (child) {\n                if (prefix === '-') {\n                  delete parent[child];\n                } else {\n                  parent[child] = {};\n                }\n              });\n            }\n          });\n        }\n      };\n      var getElementRule = function (name) {\n        var element = elements[name], i;\n        if (element) {\n          return element;\n        }\n        i = patternElements.length;\n        while (i--) {\n          element = patternElements[i];\n          if (element.pattern.test(name)) {\n            return element;\n          }\n        }\n      };\n      if (!settings.valid_elements) {\n        each$3(schemaItems, function (element, name) {\n          elements[name] = {\n            attributes: element.attributes,\n            attributesOrder: element.attributesOrder\n          };\n          children[name] = element.children;\n        });\n        if (settings.schema !== 'html5') {\n          each$3(split('strong/b em/i'), function (item) {\n            item = split(item, '/');\n            elements[item[1]].outputName = item[0];\n          });\n        }\n        each$3(split('ol ul sub sup blockquote span font a table tbody tr strong em b i'), function (name) {\n          if (elements[name]) {\n            elements[name].removeEmpty = true;\n          }\n        });\n        each$3(split('p h1 h2 h3 h4 h5 h6 th td pre div address caption li'), function (name) {\n          elements[name].paddEmpty = true;\n        });\n        each$3(split('span'), function (name) {\n          elements[name].removeEmptyAttrs = true;\n        });\n      } else {\n        setValidElements(settings.valid_elements);\n      }\n      addCustomElements(settings.custom_elements);\n      addValidChildren(settings.valid_children);\n      addValidElements(settings.extended_valid_elements);\n      addValidChildren('+ol[ul|ol],+ul[ul|ol]');\n      each$3({\n        dd: 'dl',\n        dt: 'dl',\n        li: 'ul ol',\n        td: 'tr',\n        th: 'tr',\n        tr: 'tbody thead tfoot',\n        tbody: 'table',\n        thead: 'table',\n        tfoot: 'table',\n        legend: 'fieldset',\n        area: 'map',\n        param: 'video audio object'\n      }, function (parents, item) {\n        if (elements[item]) {\n          elements[item].parentsRequired = split(parents);\n        }\n      });\n      if (settings.invalid_elements) {\n        each$3(explode$1(settings.invalid_elements), function (item) {\n          if (elements[item]) {\n            delete elements[item];\n          }\n        });\n      }\n      if (!getElementRule('span')) {\n        addValidElements('span[!data-mce-type|*]');\n      }\n      var getValidStyles = function () {\n        return validStyles;\n      };\n      var getInvalidStyles = function () {\n        return invalidStyles;\n      };\n      var getValidClasses = function () {\n        return validClasses;\n      };\n      var getBoolAttrs = function () {\n        return boolAttrMap;\n      };\n      var getBlockElements = function () {\n        return blockElementsMap;\n      };\n      var getTextBlockElements = function () {\n        return textBlockElementsMap;\n      };\n      var getTextInlineElements = function () {\n        return textInlineElementsMap;\n      };\n      var getShortEndedElements = function () {\n        return shortEndedElementsMap;\n      };\n      var getSelfClosingElements = function () {\n        return selfClosingElementsMap;\n      };\n      var getNonEmptyElements = function () {\n        return nonEmptyElementsMap;\n      };\n      var getMoveCaretBeforeOnEnterElements = function () {\n        return moveCaretBeforeOnEnterElementsMap;\n      };\n      var getWhiteSpaceElements = function () {\n        return whiteSpaceElementsMap;\n      };\n      var getSpecialElements = function () {\n        return specialElements;\n      };\n      var isValidChild = function (name, child) {\n        var parent = children[name.toLowerCase()];\n        return !!(parent && parent[child.toLowerCase()]);\n      };\n      var isValid = function (name, attr) {\n        var attrPatterns, i;\n        var rule = getElementRule(name);\n        if (rule) {\n          if (attr) {\n            if (rule.attributes[attr]) {\n              return true;\n            }\n            attrPatterns = rule.attributePatterns;\n            if (attrPatterns) {\n              i = attrPatterns.length;\n              while (i--) {\n                if (attrPatterns[i].pattern.test(name)) {\n                  return true;\n                }\n              }\n            }\n          } else {\n            return true;\n          }\n        }\n        return false;\n      };\n      var getCustomElements = function () {\n        return customElementsMap;\n      };\n      return {\n        children: children,\n        elements: elements,\n        getValidStyles: getValidStyles,\n        getValidClasses: getValidClasses,\n        getBlockElements: getBlockElements,\n        getInvalidStyles: getInvalidStyles,\n        getShortEndedElements: getShortEndedElements,\n        getTextBlockElements: getTextBlockElements,\n        getTextInlineElements: getTextInlineElements,\n        getBoolAttrs: getBoolAttrs,\n        getElementRule: getElementRule,\n        getSelfClosingElements: getSelfClosingElements,\n        getNonEmptyElements: getNonEmptyElements,\n        getMoveCaretBeforeOnEnterElements: getMoveCaretBeforeOnEnterElements,\n        getWhiteSpaceElements: getWhiteSpaceElements,\n        getSpecialElements: getSpecialElements,\n        isValidChild: isValidChild,\n        isValid: isValid,\n        getCustomElements: getCustomElements,\n        addValidElements: addValidElements,\n        setValidElements: setValidElements,\n        addCustomElements: addCustomElements,\n        addValidChildren: addValidChildren\n      };\n    }\n\n    var zeroWidth = '\\uFEFF';\n    var nbsp = '\\xA0';\n\n    var toHex = function (match, r, g, b) {\n      var hex = function (val) {\n        val = parseInt(val, 10).toString(16);\n        return val.length > 1 ? val : '0' + val;\n      };\n      return '#' + hex(r) + hex(g) + hex(b);\n    };\n    var Styles = function (settings, schema) {\n      var rgbRegExp = /rgb\\s*\\(\\s*([0-9]+)\\s*,\\s*([0-9]+)\\s*,\\s*([0-9]+)\\s*\\)/gi;\n      var urlOrStrRegExp = /(?:url(?:(?:\\(\\s*\\\"([^\\\"]+)\\\"\\s*\\))|(?:\\(\\s*\\'([^\\']+)\\'\\s*\\))|(?:\\(\\s*([^)\\s]+)\\s*\\))))|(?:\\'([^\\']+)\\')|(?:\\\"([^\\\"]+)\\\")/gi;\n      var styleRegExp = /\\s*([^:]+):\\s*([^;]+);?/g;\n      var trimRightRegExp = /\\s+$/;\n      var i;\n      var encodingLookup = {};\n      var encodingItems;\n      var validStyles;\n      var invalidStyles;\n      var invisibleChar = zeroWidth;\n      settings = settings || {};\n      if (schema) {\n        validStyles = schema.getValidStyles();\n        invalidStyles = schema.getInvalidStyles();\n      }\n      encodingItems = ('\\\\\" \\\\\\' \\\\; \\\\: ; : ' + invisibleChar).split(' ');\n      for (i = 0; i < encodingItems.length; i++) {\n        encodingLookup[encodingItems[i]] = invisibleChar + i;\n        encodingLookup[invisibleChar + i] = encodingItems[i];\n      }\n      return {\n        toHex: function (color) {\n          return color.replace(rgbRegExp, toHex);\n        },\n        parse: function (css) {\n          var styles = {};\n          var matches, name, value, isEncoded;\n          var urlConverter = settings.url_converter;\n          var urlConverterScope = settings.url_converter_scope || this;\n          var compress = function (prefix, suffix, noJoin) {\n            var top, right, bottom, left;\n            top = styles[prefix + '-top' + suffix];\n            if (!top) {\n              return;\n            }\n            right = styles[prefix + '-right' + suffix];\n            if (!right) {\n              return;\n            }\n            bottom = styles[prefix + '-bottom' + suffix];\n            if (!bottom) {\n              return;\n            }\n            left = styles[prefix + '-left' + suffix];\n            if (!left) {\n              return;\n            }\n            var box = [\n              top,\n              right,\n              bottom,\n              left\n            ];\n            i = box.length - 1;\n            while (i--) {\n              if (box[i] !== box[i + 1]) {\n                break;\n              }\n            }\n            if (i > -1 && noJoin) {\n              return;\n            }\n            styles[prefix + suffix] = i === -1 ? box[0] : box.join(' ');\n            delete styles[prefix + '-top' + suffix];\n            delete styles[prefix + '-right' + suffix];\n            delete styles[prefix + '-bottom' + suffix];\n            delete styles[prefix + '-left' + suffix];\n          };\n          var canCompress = function (key) {\n            var value = styles[key], i;\n            if (!value) {\n              return;\n            }\n            value = value.split(' ');\n            i = value.length;\n            while (i--) {\n              if (value[i] !== value[0]) {\n                return false;\n              }\n            }\n            styles[key] = value[0];\n            return true;\n          };\n          var compress2 = function (target, a, b, c) {\n            if (!canCompress(a)) {\n              return;\n            }\n            if (!canCompress(b)) {\n              return;\n            }\n            if (!canCompress(c)) {\n              return;\n            }\n            styles[target] = styles[a] + ' ' + styles[b] + ' ' + styles[c];\n            delete styles[a];\n            delete styles[b];\n            delete styles[c];\n          };\n          var encode = function (str) {\n            isEncoded = true;\n            return encodingLookup[str];\n          };\n          var decode = function (str, keepSlashes) {\n            if (isEncoded) {\n              str = str.replace(/\\uFEFF[0-9]/g, function (str) {\n                return encodingLookup[str];\n              });\n            }\n            if (!keepSlashes) {\n              str = str.replace(/\\\\([\\'\\\";:])/g, '$1');\n            }\n            return str;\n          };\n          var decodeSingleHexSequence = function (escSeq) {\n            return String.fromCharCode(parseInt(escSeq.slice(1), 16));\n          };\n          var decodeHexSequences = function (value) {\n            return value.replace(/\\\\[0-9a-f]+/gi, decodeSingleHexSequence);\n          };\n          var processUrl = function (match, url, url2, url3, str, str2) {\n            str = str || str2;\n            if (str) {\n              str = decode(str);\n              return '\\'' + str.replace(/\\'/g, '\\\\\\'') + '\\'';\n            }\n            url = decode(url || url2 || url3);\n            if (!settings.allow_script_urls) {\n              var scriptUrl = url.replace(/[\\s\\r\\n]+/g, '');\n              if (/(java|vb)script:/i.test(scriptUrl)) {\n                return '';\n              }\n              if (!settings.allow_svg_data_urls && /^data:image\\/svg/i.test(scriptUrl)) {\n                return '';\n              }\n            }\n            if (urlConverter) {\n              url = urlConverter.call(urlConverterScope, url, 'style');\n            }\n            return 'url(\\'' + url.replace(/\\'/g, '\\\\\\'') + '\\')';\n          };\n          if (css) {\n            css = css.replace(/[\\u0000-\\u001F]/g, '');\n            css = css.replace(/\\\\[\\\"\\';:\\uFEFF]/g, encode).replace(/\\\"[^\\\"]+\\\"|\\'[^\\']+\\'/g, function (str) {\n              return str.replace(/[;:]/g, encode);\n            });\n            while (matches = styleRegExp.exec(css)) {\n              styleRegExp.lastIndex = matches.index + matches[0].length;\n              name = matches[1].replace(trimRightRegExp, '').toLowerCase();\n              value = matches[2].replace(trimRightRegExp, '');\n              if (name && value) {\n                name = decodeHexSequences(name);\n                value = decodeHexSequences(value);\n                if (name.indexOf(invisibleChar) !== -1 || name.indexOf('\"') !== -1) {\n                  continue;\n                }\n                if (!settings.allow_script_urls && (name === 'behavior' || /expression\\s*\\(|\\/\\*|\\*\\//.test(value))) {\n                  continue;\n                }\n                if (name === 'font-weight' && value === '700') {\n                  value = 'bold';\n                } else if (name === 'color' || name === 'background-color') {\n                  value = value.toLowerCase();\n                }\n                value = value.replace(rgbRegExp, toHex);\n                value = value.replace(urlOrStrRegExp, processUrl);\n                styles[name] = isEncoded ? decode(value, true) : value;\n              }\n            }\n            compress('border', '', true);\n            compress('border', '-width');\n            compress('border', '-color');\n            compress('border', '-style');\n            compress('padding', '');\n            compress('margin', '');\n            compress2('border', 'border-width', 'border-style', 'border-color');\n            if (styles.border === 'medium none') {\n              delete styles.border;\n            }\n            if (styles['border-image'] === 'none') {\n              delete styles['border-image'];\n            }\n          }\n          return styles;\n        },\n        serialize: function (styles, elementName) {\n          var css = '', name, value;\n          var serializeStyles = function (name) {\n            var styleList, i, l, value;\n            styleList = validStyles[name];\n            if (styleList) {\n              for (i = 0, l = styleList.length; i < l; i++) {\n                name = styleList[i];\n                value = styles[name];\n                if (value) {\n                  css += (css.length > 0 ? ' ' : '') + name + ': ' + value + ';';\n                }\n              }\n            }\n          };\n          var isValid = function (name, elementName) {\n            var styleMap;\n            styleMap = invalidStyles['*'];\n            if (styleMap && styleMap[name]) {\n              return false;\n            }\n            styleMap = invalidStyles[elementName];\n            if (styleMap && styleMap[name]) {\n              return false;\n            }\n            return true;\n          };\n          if (elementName && validStyles) {\n            serializeStyles('*');\n            serializeStyles(elementName);\n          } else {\n            for (name in styles) {\n              value = styles[name];\n              if (value && (!invalidStyles || isValid(name, elementName))) {\n                css += (css.length > 0 ? ' ' : '') + name + ': ' + value + ';';\n              }\n            }\n          }\n          return css;\n        }\n      };\n    };\n\n    var eventExpandoPrefix = 'mce-data-';\n    var mouseEventRe = /^(?:mouse|contextmenu)|click/;\n    var deprecated = {\n      keyLocation: 1,\n      layerX: 1,\n      layerY: 1,\n      returnValue: 1,\n      webkitMovementX: 1,\n      webkitMovementY: 1,\n      keyIdentifier: 1,\n      mozPressure: 1\n    };\n    var hasIsDefaultPrevented = function (event) {\n      return event.isDefaultPrevented === returnTrue || event.isDefaultPrevented === returnFalse;\n    };\n    var returnFalse = function () {\n      return false;\n    };\n    var returnTrue = function () {\n      return true;\n    };\n    var addEvent = function (target, name, callback, capture) {\n      if (target.addEventListener) {\n        target.addEventListener(name, callback, capture || false);\n      } else if (target.attachEvent) {\n        target.attachEvent('on' + name, callback);\n      }\n    };\n    var removeEvent = function (target, name, callback, capture) {\n      if (target.removeEventListener) {\n        target.removeEventListener(name, callback, capture || false);\n      } else if (target.detachEvent) {\n        target.detachEvent('on' + name, callback);\n      }\n    };\n    var getTargetFromShadowDom = function (event, defaultTarget) {\n      if (event.composedPath) {\n        var composedPath = event.composedPath();\n        if (composedPath && composedPath.length > 0) {\n          return composedPath[0];\n        }\n      }\n      return defaultTarget;\n    };\n    var fix = function (originalEvent, data) {\n      var name;\n      var event = data || {};\n      for (name in originalEvent) {\n        if (!deprecated[name]) {\n          event[name] = originalEvent[name];\n        }\n      }\n      if (!event.target) {\n        event.target = event.srcElement || domGlobals.document;\n      }\n      if (Env.experimentalShadowDom) {\n        event.target = getTargetFromShadowDom(originalEvent, event.target);\n      }\n      if (originalEvent && mouseEventRe.test(originalEvent.type) && originalEvent.pageX === undefined && originalEvent.clientX !== undefined) {\n        var eventDoc = event.target.ownerDocument || domGlobals.document;\n        var doc = eventDoc.documentElement;\n        var body = eventDoc.body;\n        event.pageX = originalEvent.clientX + (doc && doc.scrollLeft || body && body.scrollLeft || 0) - (doc && doc.clientLeft || body && body.clientLeft || 0);\n        event.pageY = originalEvent.clientY + (doc && doc.scrollTop || body && body.scrollTop || 0) - (doc && doc.clientTop || body && body.clientTop || 0);\n      }\n      event.preventDefault = function () {\n        event.isDefaultPrevented = returnTrue;\n        if (originalEvent) {\n          if (originalEvent.preventDefault) {\n            originalEvent.preventDefault();\n          } else {\n            originalEvent.returnValue = false;\n          }\n        }\n      };\n      event.stopPropagation = function () {\n        event.isPropagationStopped = returnTrue;\n        if (originalEvent) {\n          if (originalEvent.stopPropagation) {\n            originalEvent.stopPropagation();\n          } else {\n            originalEvent.cancelBubble = true;\n          }\n        }\n      };\n      event.stopImmediatePropagation = function () {\n        event.isImmediatePropagationStopped = returnTrue;\n        event.stopPropagation();\n      };\n      if (hasIsDefaultPrevented(event) === false) {\n        event.isDefaultPrevented = returnFalse;\n        event.isPropagationStopped = returnFalse;\n        event.isImmediatePropagationStopped = returnFalse;\n      }\n      if (typeof event.metaKey === 'undefined') {\n        event.metaKey = false;\n      }\n      return event;\n    };\n    var bindOnReady = function (win, callback, eventUtils) {\n      var doc = win.document, event = { type: 'ready' };\n      if (eventUtils.domLoaded) {\n        callback(event);\n        return;\n      }\n      var isDocReady = function () {\n        return doc.readyState === 'complete' || doc.readyState === 'interactive' && doc.body;\n      };\n      var readyHandler = function () {\n        removeEvent(win, 'DOMContentLoaded', readyHandler);\n        removeEvent(win, 'load', readyHandler);\n        if (!eventUtils.domLoaded) {\n          eventUtils.domLoaded = true;\n          callback(event);\n        }\n      };\n      if (isDocReady()) {\n        readyHandler();\n      } else {\n        addEvent(win, 'DOMContentLoaded', readyHandler);\n      }\n      addEvent(win, 'load', readyHandler);\n    };\n    var EventUtils = function () {\n      function EventUtils() {\n        this.domLoaded = false;\n        this.events = {};\n        this.count = 1;\n        this.expando = eventExpandoPrefix + (+new Date()).toString(32);\n        this.hasMouseEnterLeave = 'onmouseenter' in domGlobals.document.documentElement;\n        this.hasFocusIn = 'onfocusin' in domGlobals.document.documentElement;\n        this.count = 1;\n      }\n      EventUtils.prototype.bind = function (target, names, callback, scope) {\n        var self = this;\n        var id, callbackList, i, name, fakeName, nativeHandler, capture;\n        var win = domGlobals.window;\n        var defaultNativeHandler = function (evt) {\n          self.executeHandlers(fix(evt || win.event), id);\n        };\n        if (!target || target.nodeType === 3 || target.nodeType === 8) {\n          return;\n        }\n        if (!target[self.expando]) {\n          id = self.count++;\n          target[self.expando] = id;\n          self.events[id] = {};\n        } else {\n          id = target[self.expando];\n        }\n        scope = scope || target;\n        var namesList = names.split(' ');\n        i = namesList.length;\n        while (i--) {\n          name = namesList[i];\n          nativeHandler = defaultNativeHandler;\n          fakeName = capture = false;\n          if (name === 'DOMContentLoaded') {\n            name = 'ready';\n          }\n          if (self.domLoaded && name === 'ready' && target.readyState === 'complete') {\n            callback.call(scope, fix({ type: name }));\n            continue;\n          }\n          if (!self.hasMouseEnterLeave) {\n            fakeName = self.mouseEnterLeave[name];\n            if (fakeName) {\n              nativeHandler = function (evt) {\n                var current, related;\n                current = evt.currentTarget;\n                related = evt.relatedTarget;\n                if (related && current.contains) {\n                  related = current.contains(related);\n                } else {\n                  while (related && related !== current) {\n                    related = related.parentNode;\n                  }\n                }\n                if (!related) {\n                  evt = fix(evt || win.event);\n                  evt.type = evt.type === 'mouseout' ? 'mouseleave' : 'mouseenter';\n                  evt.target = current;\n                  self.executeHandlers(evt, id);\n                }\n              };\n            }\n          }\n          if (!self.hasFocusIn && (name === 'focusin' || name === 'focusout')) {\n            capture = true;\n            fakeName = name === 'focusin' ? 'focus' : 'blur';\n            nativeHandler = function (evt) {\n              evt = fix(evt || win.event);\n              evt.type = evt.type === 'focus' ? 'focusin' : 'focusout';\n              self.executeHandlers(evt, id);\n            };\n          }\n          callbackList = self.events[id][name];\n          if (!callbackList) {\n            self.events[id][name] = callbackList = [{\n                func: callback,\n                scope: scope\n              }];\n            callbackList.fakeName = fakeName;\n            callbackList.capture = capture;\n            callbackList.nativeHandler = nativeHandler;\n            if (name === 'ready') {\n              bindOnReady(target, nativeHandler, self);\n            } else {\n              addEvent(target, fakeName || name, nativeHandler, capture);\n            }\n          } else {\n            if (name === 'ready' && self.domLoaded) {\n              callback(fix({ type: name }));\n            } else {\n              callbackList.push({\n                func: callback,\n                scope: scope\n              });\n            }\n          }\n        }\n        target = callbackList = 0;\n        return callback;\n      };\n      EventUtils.prototype.unbind = function (target, names, callback) {\n        var id, callbackList, i, ci, name, eventMap;\n        if (!target || target.nodeType === 3 || target.nodeType === 8) {\n          return this;\n        }\n        id = target[this.expando];\n        if (id) {\n          eventMap = this.events[id];\n          if (names) {\n            var namesList = names.split(' ');\n            i = namesList.length;\n            while (i--) {\n              name = namesList[i];\n              callbackList = eventMap[name];\n              if (callbackList) {\n                if (callback) {\n                  ci = callbackList.length;\n                  while (ci--) {\n                    if (callbackList[ci].func === callback) {\n                      var nativeHandler = callbackList.nativeHandler;\n                      var fakeName = callbackList.fakeName, capture = callbackList.capture;\n                      callbackList = callbackList.slice(0, ci).concat(callbackList.slice(ci + 1));\n                      callbackList.nativeHandler = nativeHandler;\n                      callbackList.fakeName = fakeName;\n                      callbackList.capture = capture;\n                      eventMap[name] = callbackList;\n                    }\n                  }\n                }\n                if (!callback || callbackList.length === 0) {\n                  delete eventMap[name];\n                  removeEvent(target, callbackList.fakeName || name, callbackList.nativeHandler, callbackList.capture);\n                }\n              }\n            }\n          } else {\n            for (name in eventMap) {\n              callbackList = eventMap[name];\n              removeEvent(target, callbackList.fakeName || name, callbackList.nativeHandler, callbackList.capture);\n            }\n            eventMap = {};\n          }\n          for (name in eventMap) {\n            return this;\n          }\n          delete this.events[id];\n          try {\n            delete target[this.expando];\n          } catch (ex) {\n            target[this.expando] = null;\n          }\n        }\n        return this;\n      };\n      EventUtils.prototype.fire = function (target, name, args) {\n        var id;\n        if (!target || target.nodeType === 3 || target.nodeType === 8) {\n          return this;\n        }\n        var event = fix(null, args);\n        event.type = name;\n        event.target = target;\n        do {\n          id = target[this.expando];\n          if (id) {\n            this.executeHandlers(event, id);\n          }\n          target = target.parentNode || target.ownerDocument || target.defaultView || target.parentWindow;\n        } while (target && !event.isPropagationStopped());\n        return this;\n      };\n      EventUtils.prototype.clean = function (target) {\n        var i, children;\n        if (!target || target.nodeType === 3 || target.nodeType === 8) {\n          return this;\n        }\n        if (target[this.expando]) {\n          this.unbind(target);\n        }\n        if (!target.getElementsByTagName) {\n          target = target.document;\n        }\n        if (target && target.getElementsByTagName) {\n          this.unbind(target);\n          children = target.getElementsByTagName('*');\n          i = children.length;\n          while (i--) {\n            target = children[i];\n            if (target[this.expando]) {\n              this.unbind(target);\n            }\n          }\n        }\n        return this;\n      };\n      EventUtils.prototype.destroy = function () {\n        this.events = {};\n      };\n      EventUtils.prototype.cancel = function (e) {\n        if (e) {\n          e.preventDefault();\n          e.stopImmediatePropagation();\n        }\n        return false;\n      };\n      EventUtils.prototype.executeHandlers = function (evt, id) {\n        var callbackList, i, l, callback;\n        var container = this.events[id];\n        callbackList = container && container[evt.type];\n        if (callbackList) {\n          for (i = 0, l = callbackList.length; i < l; i++) {\n            callback = callbackList[i];\n            if (callback && callback.func.call(callback.scope, evt) === false) {\n              evt.preventDefault();\n            }\n            if (evt.isImmediatePropagationStopped()) {\n              return;\n            }\n          }\n        }\n      };\n      EventUtils.Event = new EventUtils();\n      return EventUtils;\n    }();\n\n    var i, support, Expr, getText, isXML, tokenize, compile, select, outermostContext, sortInput, hasDuplicate, setDocument, document, docElem, documentIsHTML, rbuggyQSA, rbuggyMatches, matches, contains$3, expando = 'sizzle' + -new Date(), preferredDoc = domGlobals.window.document, dirruns = 0, done = 0, classCache = createCache(), tokenCache = createCache(), compilerCache = createCache(), sortOrder = function (a, b) {\n        if (a === b) {\n          hasDuplicate = true;\n        }\n        return 0;\n      }, strundefined = typeof undefined, MAX_NEGATIVE = 1 << 31, hasOwn = {}.hasOwnProperty, arr = [], pop = arr.pop, push_native = arr.push, push = arr.push, slice = arr.slice, indexOf$2 = arr.indexOf || function (elem) {\n        var i = 0, len = this.length;\n        for (; i < len; i++) {\n          if (this[i] === elem) {\n            return i;\n          }\n        }\n        return -1;\n      }, booleans = 'checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped', whitespace = '[\\\\x20\\\\t\\\\r\\\\n\\\\f]', identifier = '(?:\\\\\\\\.|[\\\\w-]|[^\\\\x00-\\\\xa0])+', attributes = '\\\\[' + whitespace + '*(' + identifier + ')(?:' + whitespace + '*([*^$|!~]?=)' + whitespace + '*(?:\\'((?:\\\\\\\\.|[^\\\\\\\\\\'])*)\\'|\"((?:\\\\\\\\.|[^\\\\\\\\\"])*)\"|(' + identifier + '))|)' + whitespace + '*\\\\]', pseudos = ':(' + identifier + ')(?:\\\\((' + '(\\'((?:\\\\\\\\.|[^\\\\\\\\\\'])*)\\'|\"((?:\\\\\\\\.|[^\\\\\\\\\"])*)\")|' + '((?:\\\\\\\\.|[^\\\\\\\\()[\\\\]]|' + attributes + ')*)|' + '.*' + ')\\\\)|)', rtrim = new RegExp('^' + whitespace + '+|((?:^|[^\\\\\\\\])(?:\\\\\\\\.)*)' + whitespace + '+$', 'g'), rcomma = new RegExp('^' + whitespace + '*,' + whitespace + '*'), rcombinators = new RegExp('^' + whitespace + '*([>+~]|' + whitespace + ')' + whitespace + '*'), rattributeQuotes = new RegExp('=' + whitespace + '*([^\\\\]\\'\"]*?)' + whitespace + '*\\\\]', 'g'), rpseudo = new RegExp(pseudos), ridentifier = new RegExp('^' + identifier + '$'), matchExpr = {\n        ID: new RegExp('^#(' + identifier + ')'),\n        CLASS: new RegExp('^\\\\.(' + identifier + ')'),\n        TAG: new RegExp('^(' + identifier + '|[*])'),\n        ATTR: new RegExp('^' + attributes),\n        PSEUDO: new RegExp('^' + pseudos),\n        CHILD: new RegExp('^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\\\(' + whitespace + '*(even|odd|(([+-]|)(\\\\d*)n|)' + whitespace + '*(?:([+-]|)' + whitespace + '*(\\\\d+)|))' + whitespace + '*\\\\)|)', 'i'),\n        bool: new RegExp('^(?:' + booleans + ')$', 'i'),\n        needsContext: new RegExp('^' + whitespace + '*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\\\(' + whitespace + '*((?:-\\\\d)?\\\\d*)' + whitespace + '*\\\\)|)(?=[^-]|$)', 'i')\n      }, rinputs = /^(?:input|select|textarea|button)$/i, rheader = /^h\\d$/i, rnative = /^[^{]+\\{\\s*\\[native \\w/, rquickExpr = /^(?:#([\\w-]+)|(\\w+)|\\.([\\w-]+))$/, rsibling = /[+~]/, rescape = /'|\\\\/g, runescape = new RegExp('\\\\\\\\([\\\\da-f]{1,6}' + whitespace + '?|(' + whitespace + ')|.)', 'ig'), funescape = function (_, escaped, escapedWhitespace) {\n        var high = '0x' + escaped - 65536;\n        return high !== high || escapedWhitespace ? escaped : high < 0 ? String.fromCharCode(high + 65536) : String.fromCharCode(high >> 10 | 55296, high & 1023 | 56320);\n      };\n    try {\n      push.apply(arr = slice.call(preferredDoc.childNodes), preferredDoc.childNodes);\n      arr[preferredDoc.childNodes.length].nodeType;\n    } catch (e) {\n      push = {\n        apply: arr.length ? function (target, els) {\n          push_native.apply(target, slice.call(els));\n        } : function (target, els) {\n          var j = target.length, i = 0;\n          while (target[j++] = els[i++]) {\n          }\n          target.length = j - 1;\n        }\n      };\n    }\n    var Sizzle = function (selector, context, results, seed) {\n      var match, elem, m, nodeType, i, groups, old, nid, newContext, newSelector;\n      if ((context ? context.ownerDocument || context : preferredDoc) !== document) {\n        setDocument(context);\n      }\n      context = context || document;\n      results = results || [];\n      if (!selector || typeof selector !== 'string') {\n        return results;\n      }\n      if ((nodeType = context.nodeType) !== 1 && nodeType !== 9) {\n        return [];\n      }\n      if (documentIsHTML && !seed) {\n        if (match = rquickExpr.exec(selector)) {\n          if (m = match[1]) {\n            if (nodeType === 9) {\n              elem = context.getElementById(m);\n              if (elem && elem.parentNode) {\n                if (elem.id === m) {\n                  results.push(elem);\n                  return results;\n                }\n              } else {\n                return results;\n              }\n            } else {\n              if (context.ownerDocument && (elem = context.ownerDocument.getElementById(m)) && contains$3(context, elem) && elem.id === m) {\n                results.push(elem);\n                return results;\n              }\n            }\n          } else if (match[2]) {\n            push.apply(results, context.getElementsByTagName(selector));\n            return results;\n          } else if ((m = match[3]) && support.getElementsByClassName) {\n            push.apply(results, context.getElementsByClassName(m));\n            return results;\n          }\n        }\n        if (support.qsa && (!rbuggyQSA || !rbuggyQSA.test(selector))) {\n          nid = old = expando;\n          newContext = context;\n          newSelector = nodeType === 9 && selector;\n          if (nodeType === 1 && context.nodeName.toLowerCase() !== 'object') {\n            groups = tokenize(selector);\n            if (old = context.getAttribute('id')) {\n              nid = old.replace(rescape, '\\\\$&');\n            } else {\n              context.setAttribute('id', nid);\n            }\n            nid = '[id=\\'' + nid + '\\'] ';\n            i = groups.length;\n            while (i--) {\n              groups[i] = nid + toSelector(groups[i]);\n            }\n            newContext = rsibling.test(selector) && testContext(context.parentNode) || context;\n            newSelector = groups.join(',');\n          }\n          if (newSelector) {\n            try {\n              push.apply(results, newContext.querySelectorAll(newSelector));\n              return results;\n            } catch (qsaError) {\n            } finally {\n              if (!old) {\n                context.removeAttribute('id');\n              }\n            }\n          }\n        }\n      }\n      return select(selector.replace(rtrim, '$1'), context, results, seed);\n    };\n    function createCache() {\n      var keys = [];\n      function cache(key, value) {\n        if (keys.push(key + ' ') > Expr.cacheLength) {\n          delete cache[keys.shift()];\n        }\n        return cache[key + ' '] = value;\n      }\n      return cache;\n    }\n    function markFunction(fn) {\n      fn[expando] = true;\n      return fn;\n    }\n    function siblingCheck(a, b) {\n      var cur = b && a, diff = cur && a.nodeType === 1 && b.nodeType === 1 && (~b.sourceIndex || MAX_NEGATIVE) - (~a.sourceIndex || MAX_NEGATIVE);\n      if (diff) {\n        return diff;\n      }\n      if (cur) {\n        while (cur = cur.nextSibling) {\n          if (cur === b) {\n            return -1;\n          }\n        }\n      }\n      return a ? 1 : -1;\n    }\n    function createInputPseudo(type) {\n      return function (elem) {\n        var name = elem.nodeName.toLowerCase();\n        return name === 'input' && elem.type === type;\n      };\n    }\n    function createButtonPseudo(type) {\n      return function (elem) {\n        var name = elem.nodeName.toLowerCase();\n        return (name === 'input' || name === 'button') && elem.type === type;\n      };\n    }\n    function createPositionalPseudo(fn) {\n      return markFunction(function (argument) {\n        argument = +argument;\n        return markFunction(function (seed, matches) {\n          var j, matchIndexes = fn([], seed.length, argument), i = matchIndexes.length;\n          while (i--) {\n            if (seed[j = matchIndexes[i]]) {\n              seed[j] = !(matches[j] = seed[j]);\n            }\n          }\n        });\n      });\n    }\n    function testContext(context) {\n      return context && typeof context.getElementsByTagName !== strundefined && context;\n    }\n    support = Sizzle.support = {};\n    isXML = Sizzle.isXML = function (elem) {\n      var documentElement = elem && (elem.ownerDocument || elem).documentElement;\n      return documentElement ? documentElement.nodeName !== 'HTML' : false;\n    };\n    setDocument = Sizzle.setDocument = function (node) {\n      var hasCompare, doc = node ? node.ownerDocument || node : preferredDoc, parent = doc.defaultView;\n      function getTop(win) {\n        try {\n          return win.top;\n        } catch (ex) {\n        }\n        return null;\n      }\n      if (doc === document || doc.nodeType !== 9 || !doc.documentElement) {\n        return document;\n      }\n      document = doc;\n      docElem = doc.documentElement;\n      documentIsHTML = !isXML(doc);\n      if (parent && parent !== getTop(parent)) {\n        if (parent.addEventListener) {\n          parent.addEventListener('unload', function () {\n            setDocument();\n          }, false);\n        } else if (parent.attachEvent) {\n          parent.attachEvent('onunload', function () {\n            setDocument();\n          });\n        }\n      }\n      support.attributes = true;\n      support.getElementsByTagName = true;\n      support.getElementsByClassName = rnative.test(doc.getElementsByClassName);\n      support.getById = true;\n      Expr.find.ID = function (id, context) {\n        if (typeof context.getElementById !== strundefined && documentIsHTML) {\n          var m = context.getElementById(id);\n          return m && m.parentNode ? [m] : [];\n        }\n      };\n      Expr.filter.ID = function (id) {\n        var attrId = id.replace(runescape, funescape);\n        return function (elem) {\n          return elem.getAttribute('id') === attrId;\n        };\n      };\n      Expr.find.TAG = support.getElementsByTagName ? function (tag, context) {\n        if (typeof context.getElementsByTagName !== strundefined) {\n          return context.getElementsByTagName(tag);\n        }\n      } : function (tag, context) {\n        var elem, tmp = [], i = 0, results = context.getElementsByTagName(tag);\n        if (tag === '*') {\n          while (elem = results[i++]) {\n            if (elem.nodeType === 1) {\n              tmp.push(elem);\n            }\n          }\n          return tmp;\n        }\n        return results;\n      };\n      Expr.find.CLASS = support.getElementsByClassName && function (className, context) {\n        if (documentIsHTML) {\n          return context.getElementsByClassName(className);\n        }\n      };\n      rbuggyMatches = [];\n      rbuggyQSA = [];\n      support.disconnectedMatch = true;\n      rbuggyQSA = rbuggyQSA.length && new RegExp(rbuggyQSA.join('|'));\n      rbuggyMatches = rbuggyMatches.length && new RegExp(rbuggyMatches.join('|'));\n      hasCompare = rnative.test(docElem.compareDocumentPosition);\n      contains$3 = hasCompare || rnative.test(docElem.contains) ? function (a, b) {\n        var adown = a.nodeType === 9 ? a.documentElement : a, bup = b && b.parentNode;\n        return a === bup || !!(bup && bup.nodeType === 1 && (adown.contains ? adown.contains(bup) : a.compareDocumentPosition && a.compareDocumentPosition(bup) & 16));\n      } : function (a, b) {\n        if (b) {\n          while (b = b.parentNode) {\n            if (b === a) {\n              return true;\n            }\n          }\n        }\n        return false;\n      };\n      sortOrder = hasCompare ? function (a, b) {\n        if (a === b) {\n          hasDuplicate = true;\n          return 0;\n        }\n        var compare = !a.compareDocumentPosition - !b.compareDocumentPosition;\n        if (compare) {\n          return compare;\n        }\n        compare = (a.ownerDocument || a) === (b.ownerDocument || b) ? a.compareDocumentPosition(b) : 1;\n        if (compare & 1 || !support.sortDetached && b.compareDocumentPosition(a) === compare) {\n          if (a === doc || a.ownerDocument === preferredDoc && contains$3(preferredDoc, a)) {\n            return -1;\n          }\n          if (b === doc || b.ownerDocument === preferredDoc && contains$3(preferredDoc, b)) {\n            return 1;\n          }\n          return sortInput ? indexOf$2.call(sortInput, a) - indexOf$2.call(sortInput, b) : 0;\n        }\n        return compare & 4 ? -1 : 1;\n      } : function (a, b) {\n        if (a === b) {\n          hasDuplicate = true;\n          return 0;\n        }\n        var cur, i = 0, aup = a.parentNode, bup = b.parentNode, ap = [a], bp = [b];\n        if (!aup || !bup) {\n          return a === doc ? -1 : b === doc ? 1 : aup ? -1 : bup ? 1 : sortInput ? indexOf$2.call(sortInput, a) - indexOf$2.call(sortInput, b) : 0;\n        } else if (aup === bup) {\n          return siblingCheck(a, b);\n        }\n        cur = a;\n        while (cur = cur.parentNode) {\n          ap.unshift(cur);\n        }\n        cur = b;\n        while (cur = cur.parentNode) {\n          bp.unshift(cur);\n        }\n        while (ap[i] === bp[i]) {\n          i++;\n        }\n        return i ? siblingCheck(ap[i], bp[i]) : ap[i] === preferredDoc ? -1 : bp[i] === preferredDoc ? 1 : 0;\n      };\n      return doc;\n    };\n    Sizzle.matches = function (expr, elements) {\n      return Sizzle(expr, null, null, elements);\n    };\n    Sizzle.matchesSelector = function (elem, expr) {\n      if ((elem.ownerDocument || elem) !== document) {\n        setDocument(elem);\n      }\n      expr = expr.replace(rattributeQuotes, '=\\'$1\\']');\n      if (support.matchesSelector && documentIsHTML && (!rbuggyMatches || !rbuggyMatches.test(expr)) && (!rbuggyQSA || !rbuggyQSA.test(expr))) {\n        try {\n          var ret = matches.call(elem, expr);\n          if (ret || support.disconnectedMatch || elem.document && elem.document.nodeType !== 11) {\n            return ret;\n          }\n        } catch (e) {\n        }\n      }\n      return Sizzle(expr, document, null, [elem]).length > 0;\n    };\n    Sizzle.contains = function (context, elem) {\n      if ((context.ownerDocument || context) !== document) {\n        setDocument(context);\n      }\n      return contains$3(context, elem);\n    };\n    Sizzle.attr = function (elem, name) {\n      if ((elem.ownerDocument || elem) !== document) {\n        setDocument(elem);\n      }\n      var fn = Expr.attrHandle[name.toLowerCase()], val = fn && hasOwn.call(Expr.attrHandle, name.toLowerCase()) ? fn(elem, name, !documentIsHTML) : undefined;\n      return val !== undefined ? val : support.attributes || !documentIsHTML ? elem.getAttribute(name) : (val = elem.getAttributeNode(name)) && val.specified ? val.value : null;\n    };\n    Sizzle.error = function (msg) {\n      throw new Error('Syntax error, unrecognized expression: ' + msg);\n    };\n    Sizzle.uniqueSort = function (results) {\n      var elem, duplicates = [], j = 0, i = 0;\n      hasDuplicate = !support.detectDuplicates;\n      sortInput = !support.sortStable && results.slice(0);\n      results.sort(sortOrder);\n      if (hasDuplicate) {\n        while (elem = results[i++]) {\n          if (elem === results[i]) {\n            j = duplicates.push(i);\n          }\n        }\n        while (j--) {\n          results.splice(duplicates[j], 1);\n        }\n      }\n      sortInput = null;\n      return results;\n    };\n    getText = Sizzle.getText = function (elem) {\n      var node, ret = '', i = 0, nodeType = elem.nodeType;\n      if (!nodeType) {\n        while (node = elem[i++]) {\n          ret += getText(node);\n        }\n      } else if (nodeType === 1 || nodeType === 9 || nodeType === 11) {\n        if (typeof elem.textContent === 'string') {\n          return elem.textContent;\n        } else {\n          for (elem = elem.firstChild; elem; elem = elem.nextSibling) {\n            ret += getText(elem);\n          }\n        }\n      } else if (nodeType === 3 || nodeType === 4) {\n        return elem.nodeValue;\n      }\n      return ret;\n    };\n    Expr = Sizzle.selectors = {\n      cacheLength: 50,\n      createPseudo: markFunction,\n      match: matchExpr,\n      attrHandle: {},\n      find: {},\n      relative: {\n        '>': {\n          dir: 'parentNode',\n          first: true\n        },\n        ' ': { dir: 'parentNode' },\n        '+': {\n          dir: 'previousSibling',\n          first: true\n        },\n        '~': { dir: 'previousSibling' }\n      },\n      preFilter: {\n        ATTR: function (match) {\n          match[1] = match[1].replace(runescape, funescape);\n          match[3] = (match[3] || match[4] || match[5] || '').replace(runescape, funescape);\n          if (match[2] === '~=') {\n            match[3] = ' ' + match[3] + ' ';\n          }\n          return match.slice(0, 4);\n        },\n        CHILD: function (match) {\n          match[1] = match[1].toLowerCase();\n          if (match[1].slice(0, 3) === 'nth') {\n            if (!match[3]) {\n              Sizzle.error(match[0]);\n            }\n            match[4] = +(match[4] ? match[5] + (match[6] || 1) : 2 * (match[3] === 'even' || match[3] === 'odd'));\n            match[5] = +(match[7] + match[8] || match[3] === 'odd');\n          } else if (match[3]) {\n            Sizzle.error(match[0]);\n          }\n          return match;\n        },\n        PSEUDO: function (match) {\n          var excess, unquoted = !match[6] && match[2];\n          if (matchExpr.CHILD.test(match[0])) {\n            return null;\n          }\n          if (match[3]) {\n            match[2] = match[4] || match[5] || '';\n          } else if (unquoted && rpseudo.test(unquoted) && (excess = tokenize(unquoted, true)) && (excess = unquoted.indexOf(')', unquoted.length - excess) - unquoted.length)) {\n            match[0] = match[0].slice(0, excess);\n            match[2] = unquoted.slice(0, excess);\n          }\n          return match.slice(0, 3);\n        }\n      },\n      filter: {\n        TAG: function (nodeNameSelector) {\n          var nodeName = nodeNameSelector.replace(runescape, funescape).toLowerCase();\n          return nodeNameSelector === '*' ? function () {\n            return true;\n          } : function (elem) {\n            return elem.nodeName && elem.nodeName.toLowerCase() === nodeName;\n          };\n        },\n        CLASS: function (className) {\n          var pattern = classCache[className + ' '];\n          return pattern || (pattern = new RegExp('(^|' + whitespace + ')' + className + '(' + whitespace + '|$)')) && classCache(className, function (elem) {\n            return pattern.test(typeof elem.className === 'string' && elem.className || typeof elem.getAttribute !== strundefined && elem.getAttribute('class') || '');\n          });\n        },\n        ATTR: function (name, operator, check) {\n          return function (elem) {\n            var result = Sizzle.attr(elem, name);\n            if (result == null) {\n              return operator === '!=';\n            }\n            if (!operator) {\n              return true;\n            }\n            result += '';\n            return operator === '=' ? result === check : operator === '!=' ? result !== check : operator === '^=' ? check && result.indexOf(check) === 0 : operator === '*=' ? check && result.indexOf(check) > -1 : operator === '$=' ? check && result.slice(-check.length) === check : operator === '~=' ? (' ' + result + ' ').indexOf(check) > -1 : operator === '|=' ? result === check || result.slice(0, check.length + 1) === check + '-' : false;\n          };\n        },\n        CHILD: function (type, what, argument, first, last) {\n          var simple = type.slice(0, 3) !== 'nth', forward = type.slice(-4) !== 'last', ofType = what === 'of-type';\n          return first === 1 && last === 0 ? function (elem) {\n            return !!elem.parentNode;\n          } : function (elem, context, xml) {\n            var cache, outerCache, node, diff, nodeIndex, start, dir = simple !== forward ? 'nextSibling' : 'previousSibling', parent = elem.parentNode, name = ofType && elem.nodeName.toLowerCase(), useCache = !xml && !ofType;\n            if (parent) {\n              if (simple) {\n                while (dir) {\n                  node = elem;\n                  while (node = node[dir]) {\n                    if (ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1) {\n                      return false;\n                    }\n                  }\n                  start = dir = type === 'only' && !start && 'nextSibling';\n                }\n                return true;\n              }\n              start = [forward ? parent.firstChild : parent.lastChild];\n              if (forward && useCache) {\n                outerCache = parent[expando] || (parent[expando] = {});\n                cache = outerCache[type] || [];\n                nodeIndex = cache[0] === dirruns && cache[1];\n                diff = cache[0] === dirruns && cache[2];\n                node = nodeIndex && parent.childNodes[nodeIndex];\n                while (node = ++nodeIndex && node && node[dir] || (diff = nodeIndex = 0) || start.pop()) {\n                  if (node.nodeType === 1 && ++diff && node === elem) {\n                    outerCache[type] = [\n                      dirruns,\n                      nodeIndex,\n                      diff\n                    ];\n                    break;\n                  }\n                }\n              } else if (useCache && (cache = (elem[expando] || (elem[expando] = {}))[type]) && cache[0] === dirruns) {\n                diff = cache[1];\n              } else {\n                while (node = ++nodeIndex && node && node[dir] || (diff = nodeIndex = 0) || start.pop()) {\n                  if ((ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1) && ++diff) {\n                    if (useCache) {\n                      (node[expando] || (node[expando] = {}))[type] = [\n                        dirruns,\n                        diff\n                      ];\n                    }\n                    if (node === elem) {\n                      break;\n                    }\n                  }\n                }\n              }\n              diff -= last;\n              return diff === first || diff % first === 0 && diff / first >= 0;\n            }\n          };\n        },\n        PSEUDO: function (pseudo, argument) {\n          var args, fn = Expr.pseudos[pseudo] || Expr.setFilters[pseudo.toLowerCase()] || Sizzle.error('unsupported pseudo: ' + pseudo);\n          if (fn[expando]) {\n            return fn(argument);\n          }\n          if (fn.length > 1) {\n            args = [\n              pseudo,\n              pseudo,\n              '',\n              argument\n            ];\n            return Expr.setFilters.hasOwnProperty(pseudo.toLowerCase()) ? markFunction(function (seed, matches) {\n              var idx, matched = fn(seed, argument), i = matched.length;\n              while (i--) {\n                idx = indexOf$2.call(seed, matched[i]);\n                seed[idx] = !(matches[idx] = matched[i]);\n              }\n            }) : function (elem) {\n              return fn(elem, 0, args);\n            };\n          }\n          return fn;\n        }\n      },\n      pseudos: {\n        not: markFunction(function (selector) {\n          var input = [], results = [], matcher = compile(selector.replace(rtrim, '$1'));\n          return matcher[expando] ? markFunction(function (seed, matches, context, xml) {\n            var elem, unmatched = matcher(seed, null, xml, []), i = seed.length;\n            while (i--) {\n              if (elem = unmatched[i]) {\n                seed[i] = !(matches[i] = elem);\n              }\n            }\n          }) : function (elem, context, xml) {\n            input[0] = elem;\n            matcher(input, null, xml, results);\n            return !results.pop();\n          };\n        }),\n        has: markFunction(function (selector) {\n          return function (elem) {\n            return Sizzle(selector, elem).length > 0;\n          };\n        }),\n        contains: markFunction(function (text) {\n          text = text.replace(runescape, funescape);\n          return function (elem) {\n            return (elem.textContent || elem.innerText || getText(elem)).indexOf(text) > -1;\n          };\n        }),\n        lang: markFunction(function (lang) {\n          if (!ridentifier.test(lang || '')) {\n            Sizzle.error('unsupported lang: ' + lang);\n          }\n          lang = lang.replace(runescape, funescape).toLowerCase();\n          return function (elem) {\n            var elemLang;\n            do {\n              if (elemLang = documentIsHTML ? elem.lang : elem.getAttribute('xml:lang') || elem.getAttribute('lang')) {\n                elemLang = elemLang.toLowerCase();\n                return elemLang === lang || elemLang.indexOf(lang + '-') === 0;\n              }\n            } while ((elem = elem.parentNode) && elem.nodeType === 1);\n            return false;\n          };\n        }),\n        target: function (elem) {\n          var hash = domGlobals.window.location && domGlobals.window.location.hash;\n          return hash && hash.slice(1) === elem.id;\n        },\n        root: function (elem) {\n          return elem === docElem;\n        },\n        focus: function (elem) {\n          return elem === document.activeElement && (!document.hasFocus || document.hasFocus()) && !!(elem.type || elem.href || ~elem.tabIndex);\n        },\n        enabled: function (elem) {\n          return elem.disabled === false;\n        },\n        disabled: function (elem) {\n          return elem.disabled === true;\n        },\n        checked: function (elem) {\n          var nodeName = elem.nodeName.toLowerCase();\n          return nodeName === 'input' && !!elem.checked || nodeName === 'option' && !!elem.selected;\n        },\n        selected: function (elem) {\n          if (elem.parentNode) {\n            elem.parentNode.selectedIndex;\n          }\n          return elem.selected === true;\n        },\n        empty: function (elem) {\n          for (elem = elem.firstChild; elem; elem = elem.nextSibling) {\n            if (elem.nodeType < 6) {\n              return false;\n            }\n          }\n          return true;\n        },\n        parent: function (elem) {\n          return !Expr.pseudos.empty(elem);\n        },\n        header: function (elem) {\n          return rheader.test(elem.nodeName);\n        },\n        input: function (elem) {\n          return rinputs.test(elem.nodeName);\n        },\n        button: function (elem) {\n          var name = elem.nodeName.toLowerCase();\n          return name === 'input' && elem.type === 'button' || name === 'button';\n        },\n        text: function (elem) {\n          var attr;\n          return elem.nodeName.toLowerCase() === 'input' && elem.type === 'text' && ((attr = elem.getAttribute('type')) == null || attr.toLowerCase() === 'text');\n        },\n        first: createPositionalPseudo(function () {\n          return [0];\n        }),\n        last: createPositionalPseudo(function (matchIndexes, length) {\n          return [length - 1];\n        }),\n        eq: createPositionalPseudo(function (matchIndexes, length, argument) {\n          return [argument < 0 ? argument + length : argument];\n        }),\n        even: createPositionalPseudo(function (matchIndexes, length) {\n          var i = 0;\n          for (; i < length; i += 2) {\n            matchIndexes.push(i);\n          }\n          return matchIndexes;\n        }),\n        odd: createPositionalPseudo(function (matchIndexes, length) {\n          var i = 1;\n          for (; i < length; i += 2) {\n            matchIndexes.push(i);\n          }\n          return matchIndexes;\n        }),\n        lt: createPositionalPseudo(function (matchIndexes, length, argument) {\n          var i = argument < 0 ? argument + length : argument;\n          for (; --i >= 0;) {\n            matchIndexes.push(i);\n          }\n          return matchIndexes;\n        }),\n        gt: createPositionalPseudo(function (matchIndexes, length, argument) {\n          var i = argument < 0 ? argument + length : argument;\n          for (; ++i < length;) {\n            matchIndexes.push(i);\n          }\n          return matchIndexes;\n        })\n      }\n    };\n    Expr.pseudos.nth = Expr.pseudos.eq;\n    for (i in {\n        radio: true,\n        checkbox: true,\n        file: true,\n        password: true,\n        image: true\n      }) {\n      Expr.pseudos[i] = createInputPseudo(i);\n    }\n    for (i in {\n        submit: true,\n        reset: true\n      }) {\n      Expr.pseudos[i] = createButtonPseudo(i);\n    }\n    function setFilters() {\n    }\n    setFilters.prototype = Expr.filters = Expr.pseudos;\n    Expr.setFilters = new setFilters();\n    tokenize = Sizzle.tokenize = function (selector, parseOnly) {\n      var matched, match, tokens, type, soFar, groups, preFilters, cached = tokenCache[selector + ' '];\n      if (cached) {\n        return parseOnly ? 0 : cached.slice(0);\n      }\n      soFar = selector;\n      groups = [];\n      preFilters = Expr.preFilter;\n      while (soFar) {\n        if (!matched || (match = rcomma.exec(soFar))) {\n          if (match) {\n            soFar = soFar.slice(match[0].length) || soFar;\n          }\n          groups.push(tokens = []);\n        }\n        matched = false;\n        if (match = rcombinators.exec(soFar)) {\n          matched = match.shift();\n          tokens.push({\n            value: matched,\n            type: match[0].replace(rtrim, ' ')\n          });\n          soFar = soFar.slice(matched.length);\n        }\n        for (type in Expr.filter) {\n          if (!Expr.filter.hasOwnProperty(type))\n            continue;\n          if ((match = matchExpr[type].exec(soFar)) && (!preFilters[type] || (match = preFilters[type](match)))) {\n            matched = match.shift();\n            tokens.push({\n              value: matched,\n              type: type,\n              matches: match\n            });\n            soFar = soFar.slice(matched.length);\n          }\n        }\n        if (!matched) {\n          break;\n        }\n      }\n      return parseOnly ? soFar.length : soFar ? Sizzle.error(selector) : tokenCache(selector, groups).slice(0);\n    };\n    function toSelector(tokens) {\n      var i = 0, len = tokens.length, selector = '';\n      for (; i < len; i++) {\n        selector += tokens[i].value;\n      }\n      return selector;\n    }\n    function addCombinator(matcher, combinator, base) {\n      var dir = combinator.dir, checkNonElements = base && dir === 'parentNode', doneName = done++;\n      return combinator.first ? function (elem, context, xml) {\n        while (elem = elem[dir]) {\n          if (elem.nodeType === 1 || checkNonElements) {\n            return matcher(elem, context, xml);\n          }\n        }\n      } : function (elem, context, xml) {\n        var oldCache, outerCache, newCache = [\n            dirruns,\n            doneName\n          ];\n        if (xml) {\n          while (elem = elem[dir]) {\n            if (elem.nodeType === 1 || checkNonElements) {\n              if (matcher(elem, context, xml)) {\n                return true;\n              }\n            }\n          }\n        } else {\n          while (elem = elem[dir]) {\n            if (elem.nodeType === 1 || checkNonElements) {\n              outerCache = elem[expando] || (elem[expando] = {});\n              if ((oldCache = outerCache[dir]) && oldCache[0] === dirruns && oldCache[1] === doneName) {\n                return newCache[2] = oldCache[2];\n              } else {\n                outerCache[dir] = newCache;\n                if (newCache[2] = matcher(elem, context, xml)) {\n                  return true;\n                }\n              }\n            }\n          }\n        }\n      };\n    }\n    function elementMatcher(matchers) {\n      return matchers.length > 1 ? function (elem, context, xml) {\n        var i = matchers.length;\n        while (i--) {\n          if (!matchers[i](elem, context, xml)) {\n            return false;\n          }\n        }\n        return true;\n      } : matchers[0];\n    }\n    function multipleContexts(selector, contexts, results) {\n      var i = 0, len = contexts.length;\n      for (; i < len; i++) {\n        Sizzle(selector, contexts[i], results);\n      }\n      return results;\n    }\n    function condense(unmatched, map, filter, context, xml) {\n      var elem, newUnmatched = [], i = 0, len = unmatched.length, mapped = map != null;\n      for (; i < len; i++) {\n        if (elem = unmatched[i]) {\n          if (!filter || filter(elem, context, xml)) {\n            newUnmatched.push(elem);\n            if (mapped) {\n              map.push(i);\n            }\n          }\n        }\n      }\n      return newUnmatched;\n    }\n    function setMatcher(preFilter, selector, matcher, postFilter, postFinder, postSelector) {\n      if (postFilter && !postFilter[expando]) {\n        postFilter = setMatcher(postFilter);\n      }\n      if (postFinder && !postFinder[expando]) {\n        postFinder = setMatcher(postFinder, postSelector);\n      }\n      return markFunction(function (seed, results, context, xml) {\n        var temp, i, elem, preMap = [], postMap = [], preexisting = results.length, elems = seed || multipleContexts(selector || '*', context.nodeType ? [context] : context, []), matcherIn = preFilter && (seed || !selector) ? condense(elems, preMap, preFilter, context, xml) : elems, matcherOut = matcher ? postFinder || (seed ? preFilter : preexisting || postFilter) ? [] : results : matcherIn;\n        if (matcher) {\n          matcher(matcherIn, matcherOut, context, xml);\n        }\n        if (postFilter) {\n          temp = condense(matcherOut, postMap);\n          postFilter(temp, [], context, xml);\n          i = temp.length;\n          while (i--) {\n            if (elem = temp[i]) {\n              matcherOut[postMap[i]] = !(matcherIn[postMap[i]] = elem);\n            }\n          }\n        }\n        if (seed) {\n          if (postFinder || preFilter) {\n            if (postFinder) {\n              temp = [];\n              i = matcherOut.length;\n              while (i--) {\n                if (elem = matcherOut[i]) {\n                  temp.push(matcherIn[i] = elem);\n                }\n              }\n              postFinder(null, matcherOut = [], temp, xml);\n            }\n            i = matcherOut.length;\n            while (i--) {\n              if ((elem = matcherOut[i]) && (temp = postFinder ? indexOf$2.call(seed, elem) : preMap[i]) > -1) {\n                seed[temp] = !(results[temp] = elem);\n              }\n            }\n          }\n        } else {\n          matcherOut = condense(matcherOut === results ? matcherOut.splice(preexisting, matcherOut.length) : matcherOut);\n          if (postFinder) {\n            postFinder(null, results, matcherOut, xml);\n          } else {\n            push.apply(results, matcherOut);\n          }\n        }\n      });\n    }\n    function matcherFromTokens(tokens) {\n      var checkContext, matcher, j, len = tokens.length, leadingRelative = Expr.relative[tokens[0].type], implicitRelative = leadingRelative || Expr.relative[' '], i = leadingRelative ? 1 : 0, matchContext = addCombinator(function (elem) {\n          return elem === checkContext;\n        }, implicitRelative, true), matchAnyContext = addCombinator(function (elem) {\n          return indexOf$2.call(checkContext, elem) > -1;\n        }, implicitRelative, true), matchers = [function (elem, context, xml) {\n            return !leadingRelative && (xml || context !== outermostContext) || ((checkContext = context).nodeType ? matchContext(elem, context, xml) : matchAnyContext(elem, context, xml));\n          }];\n      for (; i < len; i++) {\n        if (matcher = Expr.relative[tokens[i].type]) {\n          matchers = [addCombinator(elementMatcher(matchers), matcher)];\n        } else {\n          matcher = Expr.filter[tokens[i].type].apply(null, tokens[i].matches);\n          if (matcher[expando]) {\n            j = ++i;\n            for (; j < len; j++) {\n              if (Expr.relative[tokens[j].type]) {\n                break;\n              }\n            }\n            return setMatcher(i > 1 && elementMatcher(matchers), i > 1 && toSelector(tokens.slice(0, i - 1).concat({ value: tokens[i - 2].type === ' ' ? '*' : '' })).replace(rtrim, '$1'), matcher, i < j && matcherFromTokens(tokens.slice(i, j)), j < len && matcherFromTokens(tokens = tokens.slice(j)), j < len && toSelector(tokens));\n          }\n          matchers.push(matcher);\n        }\n      }\n      return elementMatcher(matchers);\n    }\n    function matcherFromGroupMatchers(elementMatchers, setMatchers) {\n      var bySet = setMatchers.length > 0, byElement = elementMatchers.length > 0, superMatcher = function (seed, context, xml, results, outermost) {\n          var elem, j, matcher, matchedCount = 0, i = '0', unmatched = seed && [], setMatched = [], contextBackup = outermostContext, elems = seed || byElement && Expr.find.TAG('*', outermost), dirrunsUnique = dirruns += contextBackup == null ? 1 : Math.random() || 0.1, len = elems.length;\n          if (outermost) {\n            outermostContext = context !== document && context;\n          }\n          for (; i !== len && (elem = elems[i]) != null; i++) {\n            if (byElement && elem) {\n              j = 0;\n              while (matcher = elementMatchers[j++]) {\n                if (matcher(elem, context, xml)) {\n                  results.push(elem);\n                  break;\n                }\n              }\n              if (outermost) {\n                dirruns = dirrunsUnique;\n              }\n            }\n            if (bySet) {\n              if (elem = !matcher && elem) {\n                matchedCount--;\n              }\n              if (seed) {\n                unmatched.push(elem);\n              }\n            }\n          }\n          matchedCount += i;\n          if (bySet && i !== matchedCount) {\n            j = 0;\n            while (matcher = setMatchers[j++]) {\n              matcher(unmatched, setMatched, context, xml);\n            }\n            if (seed) {\n              if (matchedCount > 0) {\n                while (i--) {\n                  if (!(unmatched[i] || setMatched[i])) {\n                    setMatched[i] = pop.call(results);\n                  }\n                }\n              }\n              setMatched = condense(setMatched);\n            }\n            push.apply(results, setMatched);\n            if (outermost && !seed && setMatched.length > 0 && matchedCount + setMatchers.length > 1) {\n              Sizzle.uniqueSort(results);\n            }\n          }\n          if (outermost) {\n            dirruns = dirrunsUnique;\n            outermostContext = contextBackup;\n          }\n          return unmatched;\n        };\n      return bySet ? markFunction(superMatcher) : superMatcher;\n    }\n    compile = Sizzle.compile = function (selector, match) {\n      var i, setMatchers = [], elementMatchers = [], cached = compilerCache[selector + ' '];\n      if (!cached) {\n        if (!match) {\n          match = tokenize(selector);\n        }\n        i = match.length;\n        while (i--) {\n          cached = matcherFromTokens(match[i]);\n          if (cached[expando]) {\n            setMatchers.push(cached);\n          } else {\n            elementMatchers.push(cached);\n          }\n        }\n        cached = compilerCache(selector, matcherFromGroupMatchers(elementMatchers, setMatchers));\n        cached.selector = selector;\n      }\n      return cached;\n    };\n    select = Sizzle.select = function (selector, context, results, seed) {\n      var i, tokens, token, type, find, compiled = typeof selector === 'function' && selector, match = !seed && tokenize(selector = compiled.selector || selector);\n      results = results || [];\n      if (match.length === 1) {\n        tokens = match[0] = match[0].slice(0);\n        if (tokens.length > 2 && (token = tokens[0]).type === 'ID' && support.getById && context.nodeType === 9 && documentIsHTML && Expr.relative[tokens[1].type]) {\n          context = (Expr.find.ID(token.matches[0].replace(runescape, funescape), context) || [])[0];\n          if (!context) {\n            return results;\n          } else if (compiled) {\n            context = context.parentNode;\n          }\n          selector = selector.slice(tokens.shift().value.length);\n        }\n        i = matchExpr.needsContext.test(selector) ? 0 : tokens.length;\n        while (i--) {\n          token = tokens[i];\n          if (Expr.relative[type = token.type]) {\n            break;\n          }\n          if (find = Expr.find[type]) {\n            if (seed = find(token.matches[0].replace(runescape, funescape), rsibling.test(tokens[0].type) && testContext(context.parentNode) || context)) {\n              tokens.splice(i, 1);\n              selector = seed.length && toSelector(tokens);\n              if (!selector) {\n                push.apply(results, seed);\n                return results;\n              }\n              break;\n            }\n          }\n        }\n      }\n      (compiled || compile(selector, match))(seed, context, !documentIsHTML, results, rsibling.test(selector) && testContext(context.parentNode) || context);\n      return results;\n    };\n    support.sortStable = expando.split('').sort(sortOrder).join('') === expando;\n    support.detectDuplicates = !!hasDuplicate;\n    setDocument();\n    support.sortDetached = true;\n\n    var doc = domGlobals.document, push$1 = Array.prototype.push, slice$1 = Array.prototype.slice;\n    var rquickExpr$1 = /^(?:[^#<]*(<[\\w\\W]+>)[^>]*$|#([\\w\\-]*)$)/;\n    var Event = EventUtils.Event;\n    var skipUniques = Tools.makeMap('children,contents,next,prev');\n    var isDefined = function (obj) {\n      return typeof obj !== 'undefined';\n    };\n    var isString$1 = function (obj) {\n      return typeof obj === 'string';\n    };\n    var isWindow = function (obj) {\n      return obj && obj === obj.window;\n    };\n    var createFragment = function (html, fragDoc) {\n      var frag, node, container;\n      fragDoc = fragDoc || doc;\n      container = fragDoc.createElement('div');\n      frag = fragDoc.createDocumentFragment();\n      container.innerHTML = html;\n      while (node = container.firstChild) {\n        frag.appendChild(node);\n      }\n      return frag;\n    };\n    var domManipulate = function (targetNodes, sourceItem, callback, reverse) {\n      var i;\n      if (isString$1(sourceItem)) {\n        sourceItem = createFragment(sourceItem, getElementDocument(targetNodes[0]));\n      } else if (sourceItem.length && !sourceItem.nodeType) {\n        sourceItem = DomQuery.makeArray(sourceItem);\n        if (reverse) {\n          for (i = sourceItem.length - 1; i >= 0; i--) {\n            domManipulate(targetNodes, sourceItem[i], callback, reverse);\n          }\n        } else {\n          for (i = 0; i < sourceItem.length; i++) {\n            domManipulate(targetNodes, sourceItem[i], callback, reverse);\n          }\n        }\n        return targetNodes;\n      }\n      if (sourceItem.nodeType) {\n        i = targetNodes.length;\n        while (i--) {\n          callback.call(targetNodes[i], sourceItem);\n        }\n      }\n      return targetNodes;\n    };\n    var hasClass = function (node, className) {\n      return node && className && (' ' + node.className + ' ').indexOf(' ' + className + ' ') !== -1;\n    };\n    var wrap$1 = function (elements, wrapper, all) {\n      var lastParent, newWrapper;\n      wrapper = DomQuery(wrapper)[0];\n      elements.each(function () {\n        var self = this;\n        if (!all || lastParent !== self.parentNode) {\n          lastParent = self.parentNode;\n          newWrapper = wrapper.cloneNode(false);\n          self.parentNode.insertBefore(newWrapper, self);\n          newWrapper.appendChild(self);\n        } else {\n          newWrapper.appendChild(self);\n        }\n      });\n      return elements;\n    };\n    var numericCssMap = Tools.makeMap('fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom', ' ');\n    var booleanMap = Tools.makeMap('checked compact declare defer disabled ismap multiple nohref noshade nowrap readonly selected', ' ');\n    var propFix = {\n      for: 'htmlFor',\n      class: 'className',\n      readonly: 'readOnly'\n    };\n    var cssFix = { float: 'cssFloat' };\n    var attrHooks = {}, cssHooks = {};\n    var DomQueryConstructor = function (selector, context) {\n      return new DomQuery.fn.init(selector, context);\n    };\n    var inArray$1 = function (item, array) {\n      var i;\n      if (array.indexOf) {\n        return array.indexOf(item);\n      }\n      i = array.length;\n      while (i--) {\n        if (array[i] === item) {\n          return i;\n        }\n      }\n      return -1;\n    };\n    var whiteSpaceRegExp$1 = /^\\s*|\\s*$/g;\n    var trim$2 = function (str) {\n      return str === null || str === undefined ? '' : ('' + str).replace(whiteSpaceRegExp$1, '');\n    };\n    var each$4 = function (obj, callback) {\n      var length, key, i, value;\n      if (obj) {\n        length = obj.length;\n        if (length === undefined) {\n          for (key in obj) {\n            if (obj.hasOwnProperty(key)) {\n              value = obj[key];\n              if (callback.call(value, key, value) === false) {\n                break;\n              }\n            }\n          }\n        } else {\n          for (i = 0; i < length; i++) {\n            value = obj[i];\n            if (callback.call(value, i, value) === false) {\n              break;\n            }\n          }\n        }\n      }\n      return obj;\n    };\n    var grep = function (array, callback) {\n      var out = [];\n      each$4(array, function (i, item) {\n        if (callback(item, i)) {\n          out.push(item);\n        }\n      });\n      return out;\n    };\n    var getElementDocument = function (element) {\n      if (!element) {\n        return doc;\n      }\n      if (element.nodeType === 9) {\n        return element;\n      }\n      return element.ownerDocument;\n    };\n    DomQueryConstructor.fn = DomQueryConstructor.prototype = {\n      constructor: DomQueryConstructor,\n      selector: '',\n      context: null,\n      length: 0,\n      init: function (selector, context) {\n        var self = this;\n        var match, node;\n        if (!selector) {\n          return self;\n        }\n        if (selector.nodeType) {\n          self.context = self[0] = selector;\n          self.length = 1;\n          return self;\n        }\n        if (context && context.nodeType) {\n          self.context = context;\n        } else {\n          if (context) {\n            return DomQuery(selector).attr(context);\n          }\n          self.context = context = domGlobals.document;\n        }\n        if (isString$1(selector)) {\n          self.selector = selector;\n          if (selector.charAt(0) === '<' && selector.charAt(selector.length - 1) === '>' && selector.length >= 3) {\n            match = [\n              null,\n              selector,\n              null\n            ];\n          } else {\n            match = rquickExpr$1.exec(selector);\n          }\n          if (match) {\n            if (match[1]) {\n              node = createFragment(selector, getElementDocument(context)).firstChild;\n              while (node) {\n                push$1.call(self, node);\n                node = node.nextSibling;\n              }\n            } else {\n              node = getElementDocument(context).getElementById(match[2]);\n              if (!node) {\n                return self;\n              }\n              if (node.id !== match[2]) {\n                return self.find(selector);\n              }\n              self.length = 1;\n              self[0] = node;\n            }\n          } else {\n            return DomQuery(context).find(selector);\n          }\n        } else {\n          this.add(selector, false);\n        }\n        return self;\n      },\n      toArray: function () {\n        return Tools.toArray(this);\n      },\n      add: function (items, sort) {\n        var self = this;\n        var nodes, i;\n        if (isString$1(items)) {\n          return self.add(DomQuery(items));\n        }\n        if (sort !== false) {\n          nodes = DomQuery.unique(self.toArray().concat(DomQuery.makeArray(items)));\n          self.length = nodes.length;\n          for (i = 0; i < nodes.length; i++) {\n            self[i] = nodes[i];\n          }\n        } else {\n          push$1.apply(self, DomQuery.makeArray(items));\n        }\n        return self;\n      },\n      attr: function (name, value) {\n        var self = this;\n        var hook;\n        if (typeof name === 'object') {\n          each$4(name, function (name, value) {\n            self.attr(name, value);\n          });\n        } else if (isDefined(value)) {\n          this.each(function () {\n            var hook;\n            if (this.nodeType === 1) {\n              hook = attrHooks[name];\n              if (hook && hook.set) {\n                hook.set(this, value);\n                return;\n              }\n              if (value === null) {\n                this.removeAttribute(name, 2);\n              } else {\n                this.setAttribute(name, value, 2);\n              }\n            }\n          });\n        } else {\n          if (self[0] && self[0].nodeType === 1) {\n            hook = attrHooks[name];\n            if (hook && hook.get) {\n              return hook.get(self[0], name);\n            }\n            if (booleanMap[name]) {\n              return self.prop(name) ? name : undefined;\n            }\n            value = self[0].getAttribute(name, 2);\n            if (value === null) {\n              value = undefined;\n            }\n          }\n          return value;\n        }\n        return self;\n      },\n      removeAttr: function (name) {\n        return this.attr(name, null);\n      },\n      prop: function (name, value) {\n        var self = this;\n        name = propFix[name] || name;\n        if (typeof name === 'object') {\n          each$4(name, function (name, value) {\n            self.prop(name, value);\n          });\n        } else if (isDefined(value)) {\n          this.each(function () {\n            if (this.nodeType === 1) {\n              this[name] = value;\n            }\n          });\n        } else {\n          if (self[0] && self[0].nodeType && name in self[0]) {\n            return self[0][name];\n          }\n          return value;\n        }\n        return self;\n      },\n      css: function (name, value) {\n        var self = this;\n        var elm, hook;\n        var camel = function (name) {\n          return name.replace(/-(\\D)/g, function (a, b) {\n            return b.toUpperCase();\n          });\n        };\n        var dashed = function (name) {\n          return name.replace(/[A-Z]/g, function (a) {\n            return '-' + a;\n          });\n        };\n        if (typeof name === 'object') {\n          each$4(name, function (name, value) {\n            self.css(name, value);\n          });\n        } else {\n          if (isDefined(value)) {\n            name = camel(name);\n            if (typeof value === 'number' && !numericCssMap[name]) {\n              value = value.toString() + 'px';\n            }\n            self.each(function () {\n              var style = this.style;\n              hook = cssHooks[name];\n              if (hook && hook.set) {\n                hook.set(this, value);\n                return;\n              }\n              try {\n                this.style[cssFix[name] || name] = value;\n              } catch (ex) {\n              }\n              if (value === null || value === '') {\n                if (style.removeProperty) {\n                  style.removeProperty(dashed(name));\n                } else {\n                  style.removeAttribute(name);\n                }\n              }\n            });\n          } else {\n            elm = self[0];\n            hook = cssHooks[name];\n            if (hook && hook.get) {\n              return hook.get(elm);\n            }\n            if (elm.ownerDocument.defaultView) {\n              try {\n                return elm.ownerDocument.defaultView.getComputedStyle(elm, null).getPropertyValue(dashed(name));\n              } catch (ex) {\n                return undefined;\n              }\n            } else if (elm.currentStyle) {\n              return elm.currentStyle[camel(name)];\n            } else {\n              return '';\n            }\n          }\n        }\n        return self;\n      },\n      remove: function () {\n        var self = this;\n        var node, i = this.length;\n        while (i--) {\n          node = self[i];\n          Event.clean(node);\n          if (node.parentNode) {\n            node.parentNode.removeChild(node);\n          }\n        }\n        return this;\n      },\n      empty: function () {\n        var self = this;\n        var node, i = this.length;\n        while (i--) {\n          node = self[i];\n          while (node.firstChild) {\n            node.removeChild(node.firstChild);\n          }\n        }\n        return this;\n      },\n      html: function (value) {\n        var self = this;\n        var i;\n        if (isDefined(value)) {\n          i = self.length;\n          try {\n            while (i--) {\n              self[i].innerHTML = value;\n            }\n          } catch (ex) {\n            DomQuery(self[i]).empty().append(value);\n          }\n          return self;\n        }\n        return self[0] ? self[0].innerHTML : '';\n      },\n      text: function (value) {\n        var self = this;\n        var i;\n        if (isDefined(value)) {\n          i = self.length;\n          while (i--) {\n            if ('innerText' in self[i]) {\n              self[i].innerText = value;\n            } else {\n              self[0].textContent = value;\n            }\n          }\n          return self;\n        }\n        return self[0] ? self[0].innerText || self[0].textContent : '';\n      },\n      append: function () {\n        return domManipulate(this, arguments, function (node) {\n          if (this.nodeType === 1 || this.host && this.host.nodeType === 1) {\n            this.appendChild(node);\n          }\n        });\n      },\n      prepend: function () {\n        return domManipulate(this, arguments, function (node) {\n          if (this.nodeType === 1 || this.host && this.host.nodeType === 1) {\n            this.insertBefore(node, this.firstChild);\n          }\n        }, true);\n      },\n      before: function () {\n        var self = this;\n        if (self[0] && self[0].parentNode) {\n          return domManipulate(self, arguments, function (node) {\n            this.parentNode.insertBefore(node, this);\n          });\n        }\n        return self;\n      },\n      after: function () {\n        var self = this;\n        if (self[0] && self[0].parentNode) {\n          return domManipulate(self, arguments, function (node) {\n            this.parentNode.insertBefore(node, this.nextSibling);\n          }, true);\n        }\n        return self;\n      },\n      appendTo: function (val) {\n        DomQuery(val).append(this);\n        return this;\n      },\n      prependTo: function (val) {\n        DomQuery(val).prepend(this);\n        return this;\n      },\n      replaceWith: function (content) {\n        return this.before(content).remove();\n      },\n      wrap: function (content) {\n        return wrap$1(this, content);\n      },\n      wrapAll: function (content) {\n        return wrap$1(this, content, true);\n      },\n      wrapInner: function (content) {\n        this.each(function () {\n          DomQuery(this).contents().wrapAll(content);\n        });\n        return this;\n      },\n      unwrap: function () {\n        return this.parent().each(function () {\n          DomQuery(this).replaceWith(this.childNodes);\n        });\n      },\n      clone: function () {\n        var result = [];\n        this.each(function () {\n          result.push(this.cloneNode(true));\n        });\n        return DomQuery(result);\n      },\n      addClass: function (className) {\n        return this.toggleClass(className, true);\n      },\n      removeClass: function (className) {\n        return this.toggleClass(className, false);\n      },\n      toggleClass: function (className, state) {\n        var self = this;\n        if (typeof className !== 'string') {\n          return self;\n        }\n        if (className.indexOf(' ') !== -1) {\n          each$4(className.split(' '), function () {\n            self.toggleClass(this, state);\n          });\n        } else {\n          self.each(function (index, node) {\n            var existingClassName, classState;\n            classState = hasClass(node, className);\n            if (classState !== state) {\n              existingClassName = node.className;\n              if (classState) {\n                node.className = trim$2((' ' + existingClassName + ' ').replace(' ' + className + ' ', ' '));\n              } else {\n                node.className += existingClassName ? ' ' + className : className;\n              }\n            }\n          });\n        }\n        return self;\n      },\n      hasClass: function (className) {\n        return hasClass(this[0], className);\n      },\n      each: function (callback) {\n        return each$4(this, callback);\n      },\n      on: function (name, callback) {\n        return this.each(function () {\n          Event.bind(this, name, callback);\n        });\n      },\n      off: function (name, callback) {\n        return this.each(function () {\n          Event.unbind(this, name, callback);\n        });\n      },\n      trigger: function (name) {\n        return this.each(function () {\n          if (typeof name === 'object') {\n            Event.fire(this, name.type, name);\n          } else {\n            Event.fire(this, name);\n          }\n        });\n      },\n      show: function () {\n        return this.css('display', '');\n      },\n      hide: function () {\n        return this.css('display', 'none');\n      },\n      slice: function () {\n        return new DomQuery(slice$1.apply(this, arguments));\n      },\n      eq: function (index) {\n        return index === -1 ? this.slice(index) : this.slice(index, +index + 1);\n      },\n      first: function () {\n        return this.eq(0);\n      },\n      last: function () {\n        return this.eq(-1);\n      },\n      find: function (selector) {\n        var i, l;\n        var ret = [];\n        for (i = 0, l = this.length; i < l; i++) {\n          DomQuery.find(selector, this[i], ret);\n        }\n        return DomQuery(ret);\n      },\n      filter: function (selector) {\n        if (typeof selector === 'function') {\n          return DomQuery(grep(this.toArray(), function (item, i) {\n            return selector(i, item);\n          }));\n        }\n        return DomQuery(DomQuery.filter(selector, this.toArray()));\n      },\n      closest: function (selector) {\n        var result = [];\n        if (selector instanceof DomQuery) {\n          selector = selector[0];\n        }\n        this.each(function (i, node) {\n          while (node) {\n            if (typeof selector === 'string' && DomQuery(node).is(selector)) {\n              result.push(node);\n              break;\n            } else if (node === selector) {\n              result.push(node);\n              break;\n            }\n            node = node.parentNode;\n          }\n        });\n        return DomQuery(result);\n      },\n      offset: function (offset) {\n        var elm, doc, docElm;\n        var x = 0, y = 0, pos;\n        if (!offset) {\n          elm = this[0];\n          if (elm) {\n            doc = elm.ownerDocument;\n            docElm = doc.documentElement;\n            if (elm.getBoundingClientRect) {\n              pos = elm.getBoundingClientRect();\n              x = pos.left + (docElm.scrollLeft || doc.body.scrollLeft) - docElm.clientLeft;\n              y = pos.top + (docElm.scrollTop || doc.body.scrollTop) - docElm.clientTop;\n            }\n          }\n          return {\n            left: x,\n            top: y\n          };\n        }\n        return this.css(offset);\n      },\n      push: push$1,\n      sort: Array.prototype.sort,\n      splice: Array.prototype.splice\n    };\n    Tools.extend(DomQueryConstructor, {\n      extend: Tools.extend,\n      makeArray: function (object) {\n        if (isWindow(object) || object.nodeType) {\n          return [object];\n        }\n        return Tools.toArray(object);\n      },\n      inArray: inArray$1,\n      isArray: Tools.isArray,\n      each: each$4,\n      trim: trim$2,\n      grep: grep,\n      find: Sizzle,\n      expr: Sizzle.selectors,\n      unique: Sizzle.uniqueSort,\n      text: Sizzle.getText,\n      contains: Sizzle.contains,\n      filter: function (expr, elems, not) {\n        var i = elems.length;\n        if (not) {\n          expr = ':not(' + expr + ')';\n        }\n        while (i--) {\n          if (elems[i].nodeType !== 1) {\n            elems.splice(i, 1);\n          }\n        }\n        if (elems.length === 1) {\n          elems = DomQuery.find.matchesSelector(elems[0], expr) ? [elems[0]] : [];\n        } else {\n          elems = DomQuery.find.matches(expr, elems);\n        }\n        return elems;\n      }\n    });\n    var dir = function (el, prop, until) {\n      var matched = [];\n      var cur = el[prop];\n      if (typeof until !== 'string' && until instanceof DomQuery) {\n        until = until[0];\n      }\n      while (cur && cur.nodeType !== 9) {\n        if (until !== undefined) {\n          if (cur === until) {\n            break;\n          }\n          if (typeof until === 'string' && DomQuery(cur).is(until)) {\n            break;\n          }\n        }\n        if (cur.nodeType === 1) {\n          matched.push(cur);\n        }\n        cur = cur[prop];\n      }\n      return matched;\n    };\n    var sibling = function (node, siblingName, nodeType, until) {\n      var result = [];\n      if (until instanceof DomQuery) {\n        until = until[0];\n      }\n      for (; node; node = node[siblingName]) {\n        if (nodeType && node.nodeType !== nodeType) {\n          continue;\n        }\n        if (until !== undefined) {\n          if (node === until) {\n            break;\n          }\n          if (typeof until === 'string' && DomQuery(node).is(until)) {\n            break;\n          }\n        }\n        result.push(node);\n      }\n      return result;\n    };\n    var firstSibling = function (node, siblingName, nodeType) {\n      for (node = node[siblingName]; node; node = node[siblingName]) {\n        if (node.nodeType === nodeType) {\n          return node;\n        }\n      }\n      return null;\n    };\n    each$4({\n      parent: function (node) {\n        var parent = node.parentNode;\n        return parent && parent.nodeType !== 11 ? parent : null;\n      },\n      parents: function (node) {\n        return dir(node, 'parentNode');\n      },\n      next: function (node) {\n        return firstSibling(node, 'nextSibling', 1);\n      },\n      prev: function (node) {\n        return firstSibling(node, 'previousSibling', 1);\n      },\n      children: function (node) {\n        return sibling(node.firstChild, 'nextSibling', 1);\n      },\n      contents: function (node) {\n        return Tools.toArray((node.nodeName === 'iframe' ? node.contentDocument || node.contentWindow.document : node).childNodes);\n      }\n    }, function (name, fn) {\n      DomQueryConstructor.fn[name] = function (selector) {\n        var self = this;\n        var result = [];\n        self.each(function () {\n          var nodes = fn.call(result, this, selector, result);\n          if (nodes) {\n            if (DomQuery.isArray(nodes)) {\n              result.push.apply(result, nodes);\n            } else {\n              result.push(nodes);\n            }\n          }\n        });\n        if (this.length > 1) {\n          if (!skipUniques[name]) {\n            result = DomQuery.unique(result);\n          }\n          if (name.indexOf('parents') === 0) {\n            result = result.reverse();\n          }\n        }\n        var wrappedResult = DomQuery(result);\n        if (selector) {\n          return wrappedResult.filter(selector);\n        }\n        return wrappedResult;\n      };\n    });\n    each$4({\n      parentsUntil: function (node, until) {\n        return dir(node, 'parentNode', until);\n      },\n      nextUntil: function (node, until) {\n        return sibling(node, 'nextSibling', 1, until).slice(1);\n      },\n      prevUntil: function (node, until) {\n        return sibling(node, 'previousSibling', 1, until).slice(1);\n      }\n    }, function (name, fn) {\n      DomQueryConstructor.fn[name] = function (selector, filter) {\n        var self = this;\n        var result = [];\n        self.each(function () {\n          var nodes = fn.call(result, this, selector, result);\n          if (nodes) {\n            if (DomQuery.isArray(nodes)) {\n              result.push.apply(result, nodes);\n            } else {\n              result.push(nodes);\n            }\n          }\n        });\n        if (this.length > 1) {\n          result = DomQuery.unique(result);\n          if (name.indexOf('parents') === 0 || name === 'prevUntil') {\n            result = result.reverse();\n          }\n        }\n        var wrappedResult = DomQuery(result);\n        if (filter) {\n          return wrappedResult.filter(filter);\n        }\n        return wrappedResult;\n      };\n    });\n    DomQueryConstructor.fn.is = function (selector) {\n      return !!selector && this.filter(selector).length > 0;\n    };\n    DomQueryConstructor.fn.init.prototype = DomQueryConstructor.fn;\n    DomQueryConstructor.overrideDefaults = function (callback) {\n      var defaults;\n      var sub = function (selector, context) {\n        defaults = defaults || callback();\n        if (arguments.length === 0) {\n          selector = defaults.element;\n        }\n        if (!context) {\n          context = defaults.context;\n        }\n        return new sub.fn.init(selector, context);\n      };\n      DomQuery.extend(sub, this);\n      return sub;\n    };\n    DomQueryConstructor.attrHooks = attrHooks;\n    DomQueryConstructor.cssHooks = cssHooks;\n    var DomQuery = DomQueryConstructor;\n\n    var TreeWalker = function () {\n      function TreeWalker(startNode, rootNode) {\n        this.node = startNode;\n        this.rootNode = rootNode;\n        this.current = this.current.bind(this);\n        this.next = this.next.bind(this);\n        this.prev = this.prev.bind(this);\n        this.prev2 = this.prev2.bind(this);\n      }\n      TreeWalker.prototype.current = function () {\n        return this.node;\n      };\n      TreeWalker.prototype.next = function (shallow) {\n        this.node = this.findSibling(this.node, 'firstChild', 'nextSibling', shallow);\n        return this.node;\n      };\n      TreeWalker.prototype.prev = function (shallow) {\n        this.node = this.findSibling(this.node, 'lastChild', 'previousSibling', shallow);\n        return this.node;\n      };\n      TreeWalker.prototype.prev2 = function (shallow) {\n        this.node = this.findPreviousNode(this.node, 'lastChild', 'previousSibling', shallow);\n        return this.node;\n      };\n      TreeWalker.prototype.findSibling = function (node, startName, siblingName, shallow) {\n        var sibling, parent;\n        if (node) {\n          if (!shallow && node[startName]) {\n            return node[startName];\n          }\n          if (node !== this.rootNode) {\n            sibling = node[siblingName];\n            if (sibling) {\n              return sibling;\n            }\n            for (parent = node.parentNode; parent && parent !== this.rootNode; parent = parent.parentNode) {\n              sibling = parent[siblingName];\n              if (sibling) {\n                return sibling;\n              }\n            }\n          }\n        }\n      };\n      TreeWalker.prototype.findPreviousNode = function (node, startName, siblingName, shallow) {\n        var sibling, parent, child;\n        if (node) {\n          sibling = node[siblingName];\n          if (this.rootNode && sibling === this.rootNode) {\n            return;\n          }\n          if (sibling) {\n            if (!shallow) {\n              for (child = sibling[startName]; child; child = child[startName]) {\n                if (!child[startName]) {\n                  return child;\n                }\n              }\n            }\n            return sibling;\n          }\n          parent = node.parentNode;\n          if (parent && parent !== this.rootNode) {\n            return parent;\n          }\n        }\n      };\n      return TreeWalker;\n    }();\n\n    var each$5 = Tools.each;\n    var grep$1 = Tools.grep;\n    var isIE = Env.ie;\n    var simpleSelectorRe = /^([a-z0-9],?)+$/i;\n    var whiteSpaceRegExp$2 = /^[ \\t\\r\\n]*$/;\n    var setupAttrHooks = function (styles, settings, getContext) {\n      var keepValues = settings.keep_values;\n      var keepUrlHook = {\n        set: function ($elm, value, name) {\n          if (settings.url_converter) {\n            value = settings.url_converter.call(settings.url_converter_scope || getContext(), value, name, $elm[0]);\n          }\n          $elm.attr('data-mce-' + name, value).attr(name, value);\n        },\n        get: function ($elm, name) {\n          return $elm.attr('data-mce-' + name) || $elm.attr(name);\n        }\n      };\n      var attrHooks = {\n        style: {\n          set: function ($elm, value) {\n            if (value !== null && typeof value === 'object') {\n              $elm.css(value);\n              return;\n            }\n            if (keepValues) {\n              $elm.attr('data-mce-style', value);\n            }\n            if (value !== null && typeof value === 'string') {\n              $elm.removeAttr('style');\n              $elm.css(styles.parse(value));\n            } else {\n              $elm.attr('style', value);\n            }\n          },\n          get: function ($elm) {\n            var value = $elm.attr('data-mce-style') || $elm.attr('style');\n            value = styles.serialize(styles.parse(value), $elm[0].nodeName);\n            return value;\n          }\n        }\n      };\n      if (keepValues) {\n        attrHooks.href = attrHooks.src = keepUrlHook;\n      }\n      return attrHooks;\n    };\n    var updateInternalStyleAttr = function (styles, $elm) {\n      var rawValue = $elm.attr('style');\n      var value = styles.serialize(styles.parse(rawValue), $elm[0].nodeName);\n      if (!value) {\n        value = null;\n      }\n      $elm.attr('data-mce-style', value);\n    };\n    var findNodeIndex = function (node, normalized) {\n      var idx = 0, lastNodeType, nodeType;\n      if (node) {\n        for (lastNodeType = node.nodeType, node = node.previousSibling; node; node = node.previousSibling) {\n          nodeType = node.nodeType;\n          if (normalized && nodeType === 3) {\n            if (nodeType === lastNodeType || !node.nodeValue.length) {\n              continue;\n            }\n          }\n          idx++;\n          lastNodeType = nodeType;\n        }\n      }\n      return idx;\n    };\n    function DOMUtils(doc, settings) {\n      var _this = this;\n      if (settings === void 0) {\n        settings = {};\n      }\n      var attrHooks;\n      var addedStyles = {};\n      var win = domGlobals.window;\n      var files = {};\n      var counter = 0;\n      var stdMode = true;\n      var boxModel = true;\n      var styleSheetLoader = StyleSheetLoader(doc, {\n        contentCssCors: settings.contentCssCors,\n        referrerPolicy: settings.referrerPolicy\n      });\n      var boundEvents = [];\n      var schema = settings.schema ? settings.schema : Schema({});\n      var styles = Styles({\n        url_converter: settings.url_converter,\n        url_converter_scope: settings.url_converter_scope\n      }, settings.schema);\n      var events = settings.ownEvents ? new EventUtils() : EventUtils.Event;\n      var blockElementsMap = schema.getBlockElements();\n      var $ = DomQuery.overrideDefaults(function () {\n        return {\n          context: doc,\n          element: self.getRoot()\n        };\n      });\n      var isBlock = function (node) {\n        if (typeof node === 'string') {\n          return !!blockElementsMap[node];\n        } else if (node) {\n          var type = node.nodeType;\n          if (type) {\n            return !!(type === 1 && blockElementsMap[node.nodeName]);\n          }\n        }\n        return false;\n      };\n      var get = function (elm) {\n        if (elm && doc && typeof elm === 'string') {\n          var node = doc.getElementById(elm);\n          if (node && node.id !== elm) {\n            return doc.getElementsByName(elm)[1];\n          } else {\n            return node;\n          }\n        }\n        return elm;\n      };\n      var $$ = function (elm) {\n        if (typeof elm === 'string') {\n          elm = get(elm);\n        }\n        return $(elm);\n      };\n      var getAttrib = function (elm, name, defaultVal) {\n        var hook, value;\n        var $elm = $$(elm);\n        if ($elm.length) {\n          hook = attrHooks[name];\n          if (hook && hook.get) {\n            value = hook.get($elm, name);\n          } else {\n            value = $elm.attr(name);\n          }\n        }\n        if (typeof value === 'undefined') {\n          value = defaultVal || '';\n        }\n        return value;\n      };\n      var getAttribs = function (elm) {\n        var node = get(elm);\n        if (!node) {\n          return [];\n        }\n        return node.attributes;\n      };\n      var setAttrib = function (elm, name, value) {\n        var originalValue, hook;\n        if (value === '') {\n          value = null;\n        }\n        var $elm = $$(elm);\n        originalValue = $elm.attr(name);\n        if (!$elm.length) {\n          return;\n        }\n        hook = attrHooks[name];\n        if (hook && hook.set) {\n          hook.set($elm, value, name);\n        } else {\n          $elm.attr(name, value);\n        }\n        if (originalValue !== value && settings.onSetAttrib) {\n          settings.onSetAttrib({\n            attrElm: $elm,\n            attrName: name,\n            attrValue: value\n          });\n        }\n      };\n      var clone = function (node, deep) {\n        if (!isIE || node.nodeType !== 1 || deep) {\n          return node.cloneNode(deep);\n        }\n        if (!deep) {\n          var clone_1 = doc.createElement(node.nodeName);\n          each$5(getAttribs(node), function (attr) {\n            setAttrib(clone_1, attr.nodeName, getAttrib(node, attr.nodeName));\n          });\n          return clone_1;\n        }\n        return null;\n      };\n      var getRoot = function () {\n        return settings.root_element || doc.body;\n      };\n      var getViewPort = function (argWin) {\n        var vp = getBounds(argWin);\n        return {\n          x: vp.x(),\n          y: vp.y(),\n          w: vp.width(),\n          h: vp.height()\n        };\n      };\n      var getPos = function (elm, rootElm) {\n        return Position$1.getPos(doc.body, get(elm), rootElm);\n      };\n      var setStyle = function (elm, name, value) {\n        var $elm = isString(name) ? $$(elm).css(name, value) : $$(elm).css(name);\n        if (settings.update_styles) {\n          updateInternalStyleAttr(styles, $elm);\n        }\n      };\n      var setStyles = function (elm, stylesArg) {\n        var $elm = $$(elm).css(stylesArg);\n        if (settings.update_styles) {\n          updateInternalStyleAttr(styles, $elm);\n        }\n      };\n      var getStyle = function (elm, name, computed) {\n        var $elm = $$(elm);\n        if (computed) {\n          return $elm.css(name);\n        }\n        name = name.replace(/-(\\D)/g, function (a, b) {\n          return b.toUpperCase();\n        });\n        if (name === 'float') {\n          name = Env.browser.isIE() ? 'styleFloat' : 'cssFloat';\n        }\n        return $elm[0] && $elm[0].style ? $elm[0].style[name] : undefined;\n      };\n      var getSize = function (elm) {\n        var w, h;\n        elm = get(elm);\n        w = getStyle(elm, 'width');\n        h = getStyle(elm, 'height');\n        if (w.indexOf('px') === -1) {\n          w = 0;\n        }\n        if (h.indexOf('px') === -1) {\n          h = 0;\n        }\n        return {\n          w: parseInt(w, 10) || elm.offsetWidth || elm.clientWidth,\n          h: parseInt(h, 10) || elm.offsetHeight || elm.clientHeight\n        };\n      };\n      var getRect = function (elm) {\n        var pos, size;\n        elm = get(elm);\n        pos = getPos(elm);\n        size = getSize(elm);\n        return {\n          x: pos.x,\n          y: pos.y,\n          w: size.w,\n          h: size.h\n        };\n      };\n      var is = function (elm, selector) {\n        var i;\n        if (!elm) {\n          return false;\n        }\n        if (!Array.isArray(elm)) {\n          if (selector === '*') {\n            return elm.nodeType === 1;\n          }\n          if (simpleSelectorRe.test(selector)) {\n            var selectors = selector.toLowerCase().split(/,/);\n            var elmName = elm.nodeName.toLowerCase();\n            for (i = selectors.length - 1; i >= 0; i--) {\n              if (selectors[i] === elmName) {\n                return true;\n              }\n            }\n            return false;\n          }\n          if (elm.nodeType && elm.nodeType !== 1) {\n            return false;\n          }\n        }\n        var elms = !Array.isArray(elm) ? [elm] : elm;\n        return Sizzle(selector, elms[0].ownerDocument || elms[0], null, elms).length > 0;\n      };\n      var getParents = function (elm, selector, root, collect) {\n        var result = [];\n        var selectorVal;\n        var node = get(elm);\n        collect = collect === undefined;\n        root = root || (getRoot().nodeName !== 'BODY' ? getRoot().parentNode : null);\n        if (Tools.is(selector, 'string')) {\n          selectorVal = selector;\n          if (selector === '*') {\n            selector = function (node) {\n              return node.nodeType === 1;\n            };\n          } else {\n            selector = function (node) {\n              return is(node, selectorVal);\n            };\n          }\n        }\n        while (node) {\n          if (node === root || !node.nodeType || node.nodeType === 9) {\n            break;\n          }\n          if (!selector || typeof selector === 'function' && selector(node)) {\n            if (collect) {\n              result.push(node);\n            } else {\n              return [node];\n            }\n          }\n          node = node.parentNode;\n        }\n        return collect ? result : null;\n      };\n      var getParent = function (node, selector, root) {\n        var parents = getParents(node, selector, root, false);\n        return parents && parents.length > 0 ? parents[0] : null;\n      };\n      var _findSib = function (node, selector, name) {\n        var func = selector;\n        if (node) {\n          if (typeof selector === 'string') {\n            func = function (node) {\n              return is(node, selector);\n            };\n          }\n          for (node = node[name]; node; node = node[name]) {\n            if (typeof func === 'function' && func(node)) {\n              return node;\n            }\n          }\n        }\n        return null;\n      };\n      var getNext = function (node, selector) {\n        return _findSib(node, selector, 'nextSibling');\n      };\n      var getPrev = function (node, selector) {\n        return _findSib(node, selector, 'previousSibling');\n      };\n      var select = function (selector, scope) {\n        return Sizzle(selector, get(scope) || settings.root_element || doc, []);\n      };\n      var run = function (elm, func, scope) {\n        var result;\n        var node = typeof elm === 'string' ? get(elm) : elm;\n        if (!node) {\n          return false;\n        }\n        if (Tools.isArray(node) && (node.length || node.length === 0)) {\n          result = [];\n          each$5(node, function (elm, i) {\n            if (elm) {\n              if (typeof elm === 'string') {\n                elm = get(elm);\n              }\n              result.push(func.call(scope, elm, i));\n            }\n          });\n          return result;\n        }\n        var context = scope ? scope : _this;\n        return func.call(context, node);\n      };\n      var setAttribs = function (elm, attrs) {\n        $$(elm).each(function (i, node) {\n          each$5(attrs, function (value, name) {\n            setAttrib(node, name, value);\n          });\n        });\n      };\n      var setHTML = function (elm, html) {\n        var $elm = $$(elm);\n        if (isIE) {\n          $elm.each(function (i, target) {\n            if (target.canHaveHTML === false) {\n              return;\n            }\n            while (target.firstChild) {\n              target.removeChild(target.firstChild);\n            }\n            try {\n              target.innerHTML = '<br>' + html;\n              target.removeChild(target.firstChild);\n            } catch (ex) {\n              DomQuery('<div></div>').html('<br>' + html).contents().slice(1).appendTo(target);\n            }\n            return html;\n          });\n        } else {\n          $elm.html(html);\n        }\n      };\n      var add = function (parentElm, name, attrs, html, create) {\n        return run(parentElm, function (parentElm) {\n          var newElm = typeof name === 'string' ? doc.createElement(name) : name;\n          setAttribs(newElm, attrs);\n          if (html) {\n            if (typeof html !== 'string' && html.nodeType) {\n              newElm.appendChild(html);\n            } else if (typeof html === 'string') {\n              setHTML(newElm, html);\n            }\n          }\n          return !create ? parentElm.appendChild(newElm) : newElm;\n        });\n      };\n      var create = function (name, attrs, html) {\n        return add(doc.createElement(name), name, attrs, html, true);\n      };\n      var decode = Entities.decode;\n      var encode = Entities.encodeAllRaw;\n      var createHTML = function (name, attrs, html) {\n        var outHtml = '', key;\n        outHtml += '<' + name;\n        for (key in attrs) {\n          if (attrs.hasOwnProperty(key) && attrs[key] !== null && typeof attrs[key] !== 'undefined') {\n            outHtml += ' ' + key + '=\"' + encode(attrs[key]) + '\"';\n          }\n        }\n        if (typeof html !== 'undefined') {\n          return outHtml + '>' + html + '</' + name + '>';\n        }\n        return outHtml + ' />';\n      };\n      var createFragment = function (html) {\n        var node;\n        var container = doc.createElement('div');\n        var frag = doc.createDocumentFragment();\n        if (html) {\n          container.innerHTML = html;\n        }\n        while (node = container.firstChild) {\n          frag.appendChild(node);\n        }\n        return frag;\n      };\n      var remove = function (node, keepChildren) {\n        var $node = $$(node);\n        if (keepChildren) {\n          $node.each(function () {\n            var child;\n            while (child = this.firstChild) {\n              if (child.nodeType === 3 && child.data.length === 0) {\n                this.removeChild(child);\n              } else {\n                this.parentNode.insertBefore(child, this);\n              }\n            }\n          }).remove();\n        } else {\n          $node.remove();\n        }\n        return $node.length > 1 ? $node.toArray() : $node[0];\n      };\n      var removeAllAttribs = function (e) {\n        return run(e, function (e) {\n          var i;\n          var attrs = e.attributes;\n          for (i = attrs.length - 1; i >= 0; i--) {\n            e.removeAttributeNode(attrs.item(i));\n          }\n        });\n      };\n      var parseStyle = function (cssText) {\n        return styles.parse(cssText);\n      };\n      var serializeStyle = function (stylesArg, name) {\n        return styles.serialize(stylesArg, name);\n      };\n      var addStyle = function (cssText) {\n        var head, styleElm;\n        if (self !== DOMUtils.DOM && doc === domGlobals.document) {\n          if (addedStyles[cssText]) {\n            return;\n          }\n          addedStyles[cssText] = true;\n        }\n        styleElm = doc.getElementById('mceDefaultStyles');\n        if (!styleElm) {\n          styleElm = doc.createElement('style');\n          styleElm.id = 'mceDefaultStyles';\n          styleElm.type = 'text/css';\n          head = doc.getElementsByTagName('head')[0];\n          if (head.firstChild) {\n            head.insertBefore(styleElm, head.firstChild);\n          } else {\n            head.appendChild(styleElm);\n          }\n        }\n        if (styleElm.styleSheet) {\n          styleElm.styleSheet.cssText += cssText;\n        } else {\n          styleElm.appendChild(doc.createTextNode(cssText));\n        }\n      };\n      var loadCSS = function (url) {\n        var head;\n        if (self !== DOMUtils.DOM && doc === domGlobals.document) {\n          DOMUtils.DOM.loadCSS(url);\n          return;\n        }\n        if (!url) {\n          url = '';\n        }\n        head = doc.getElementsByTagName('head')[0];\n        each$5(url.split(','), function (url) {\n          var link;\n          url = Tools._addCacheSuffix(url);\n          if (files[url]) {\n            return;\n          }\n          files[url] = true;\n          link = create('link', __assign(__assign({\n            rel: 'stylesheet',\n            type: 'text/css',\n            href: url\n          }, settings.contentCssCors ? { crossOrigin: 'anonymous' } : {}), settings.referrerPolicy ? { referrerPolicy: settings.referrerPolicy } : {}));\n          head.appendChild(link);\n        });\n      };\n      var toggleClass = function (elm, cls, state) {\n        $$(elm).toggleClass(cls, state).each(function () {\n          if (this.className === '') {\n            DomQuery(this).attr('class', null);\n          }\n        });\n      };\n      var addClass = function (elm, cls) {\n        $$(elm).addClass(cls);\n      };\n      var removeClass = function (elm, cls) {\n        toggleClass(elm, cls, false);\n      };\n      var hasClass = function (elm, cls) {\n        return $$(elm).hasClass(cls);\n      };\n      var show = function (elm) {\n        $$(elm).show();\n      };\n      var hide = function (elm) {\n        $$(elm).hide();\n      };\n      var isHidden = function (elm) {\n        return $$(elm).css('display') === 'none';\n      };\n      var uniqueId = function (prefix) {\n        return (!prefix ? 'mce_' : prefix) + counter++;\n      };\n      var getOuterHTML = function (elm) {\n        var node = typeof elm === 'string' ? get(elm) : elm;\n        return NodeType.isElement(node) ? node.outerHTML : DomQuery('<div></div>').append(DomQuery(node).clone()).html();\n      };\n      var setOuterHTML = function (elm, html) {\n        $$(elm).each(function () {\n          try {\n            if ('outerHTML' in this) {\n              this.outerHTML = html;\n              return;\n            }\n          } catch (ex) {\n          }\n          remove(DomQuery(this).html(html), true);\n        });\n      };\n      var insertAfter = function (node, reference) {\n        var referenceNode = get(reference);\n        return run(node, function (node) {\n          var parent, nextSibling;\n          parent = referenceNode.parentNode;\n          nextSibling = referenceNode.nextSibling;\n          if (nextSibling) {\n            parent.insertBefore(node, nextSibling);\n          } else {\n            parent.appendChild(node);\n          }\n          return node;\n        });\n      };\n      var replace = function (newElm, oldElm, keepChildren) {\n        return run(oldElm, function (oldElm) {\n          if (Tools.is(oldElm, 'array')) {\n            newElm = newElm.cloneNode(true);\n          }\n          if (keepChildren) {\n            each$5(grep$1(oldElm.childNodes), function (node) {\n              newElm.appendChild(node);\n            });\n          }\n          return oldElm.parentNode.replaceChild(newElm, oldElm);\n        });\n      };\n      var rename = function (elm, name) {\n        var newElm;\n        if (elm.nodeName !== name.toUpperCase()) {\n          newElm = create(name);\n          each$5(getAttribs(elm), function (attrNode) {\n            setAttrib(newElm, attrNode.nodeName, getAttrib(elm, attrNode.nodeName));\n          });\n          replace(newElm, elm, true);\n        }\n        return newElm || elm;\n      };\n      var findCommonAncestor = function (a, b) {\n        var ps = a, pe;\n        while (ps) {\n          pe = b;\n          while (pe && ps !== pe) {\n            pe = pe.parentNode;\n          }\n          if (ps === pe) {\n            break;\n          }\n          ps = ps.parentNode;\n        }\n        if (!ps && a.ownerDocument) {\n          return a.ownerDocument.documentElement;\n        }\n        return ps;\n      };\n      var toHex = function (rgbVal) {\n        return styles.toHex(Tools.trim(rgbVal));\n      };\n      var isEmpty = function (node, elements) {\n        var i, attributes, type, name, brCount = 0;\n        node = node.firstChild;\n        if (node) {\n          var walker = new TreeWalker(node, node.parentNode);\n          var whitespace = schema ? schema.getWhiteSpaceElements() : {};\n          elements = elements || (schema ? schema.getNonEmptyElements() : null);\n          do {\n            type = node.nodeType;\n            if (NodeType.isElement(node)) {\n              var bogusVal = node.getAttribute('data-mce-bogus');\n              if (bogusVal) {\n                node = walker.next(bogusVal === 'all');\n                continue;\n              }\n              name = node.nodeName.toLowerCase();\n              if (elements && elements[name]) {\n                if (name === 'br') {\n                  brCount++;\n                  node = walker.next();\n                  continue;\n                }\n                return false;\n              }\n              attributes = getAttribs(node);\n              i = attributes.length;\n              while (i--) {\n                name = attributes[i].nodeName;\n                if (name === 'name' || name === 'data-mce-bookmark') {\n                  return false;\n                }\n              }\n            }\n            if (type === 8) {\n              return false;\n            }\n            if (type === 3 && !whiteSpaceRegExp$2.test(node.nodeValue)) {\n              return false;\n            }\n            if (type === 3 && node.parentNode && whitespace[node.parentNode.nodeName] && whiteSpaceRegExp$2.test(node.nodeValue)) {\n              return false;\n            }\n            node = walker.next();\n          } while (node);\n        }\n        return brCount <= 1;\n      };\n      var createRng = function () {\n        return doc.createRange();\n      };\n      var split = function (parentElm, splitElm, replacementElm) {\n        var r = createRng(), bef, aft, pa;\n        if (parentElm && splitElm) {\n          r.setStart(parentElm.parentNode, findNodeIndex(parentElm));\n          r.setEnd(splitElm.parentNode, findNodeIndex(splitElm));\n          bef = r.extractContents();\n          r = createRng();\n          r.setStart(splitElm.parentNode, findNodeIndex(splitElm) + 1);\n          r.setEnd(parentElm.parentNode, findNodeIndex(parentElm) + 1);\n          aft = r.extractContents();\n          pa = parentElm.parentNode;\n          pa.insertBefore(TrimNode.trimNode(self, bef), parentElm);\n          if (replacementElm) {\n            pa.insertBefore(replacementElm, parentElm);\n          } else {\n            pa.insertBefore(splitElm, parentElm);\n          }\n          pa.insertBefore(TrimNode.trimNode(self, aft), parentElm);\n          remove(parentElm);\n          return replacementElm || splitElm;\n        }\n      };\n      var bind = function (target, name, func, scope) {\n        if (Tools.isArray(target)) {\n          var i = target.length;\n          var rv = [];\n          while (i--) {\n            rv[i] = bind(target[i], name, func, scope);\n          }\n          return rv;\n        }\n        if (settings.collect && (target === doc || target === win)) {\n          boundEvents.push([\n            target,\n            name,\n            func,\n            scope\n          ]);\n        }\n        return events.bind(target, name, func, scope || self);\n      };\n      var unbind = function (target, name, func) {\n        var i;\n        if (Tools.isArray(target)) {\n          i = target.length;\n          var rv = [];\n          while (i--) {\n            rv[i] = unbind(target[i], name, func);\n          }\n          return rv;\n        }\n        if (boundEvents && (target === doc || target === win)) {\n          i = boundEvents.length;\n          while (i--) {\n            var item = boundEvents[i];\n            if (target === item[0] && (!name || name === item[1]) && (!func || func === item[2])) {\n              events.unbind(item[0], item[1], item[2]);\n            }\n          }\n        }\n        return events.unbind(target, name, func);\n      };\n      var fire = function (target, name, evt) {\n        return events.fire(target, name, evt);\n      };\n      var getContentEditable = function (node) {\n        if (node && NodeType.isElement(node)) {\n          var contentEditable = node.getAttribute('data-mce-contenteditable');\n          if (contentEditable && contentEditable !== 'inherit') {\n            return contentEditable;\n          }\n          return node.contentEditable !== 'inherit' ? node.contentEditable : null;\n        } else {\n          return null;\n        }\n      };\n      var getContentEditableParent = function (node) {\n        var root = getRoot();\n        var state = null;\n        for (; node && node !== root; node = node.parentNode) {\n          state = getContentEditable(node);\n          if (state !== null) {\n            break;\n          }\n        }\n        return state;\n      };\n      var destroy = function () {\n        if (boundEvents) {\n          var i = boundEvents.length;\n          while (i--) {\n            var item = boundEvents[i];\n            events.unbind(item[0], item[1], item[2]);\n          }\n        }\n        if (Sizzle.setDocument) {\n          Sizzle.setDocument();\n        }\n      };\n      var isChildOf = function (node, parent) {\n        while (node) {\n          if (parent === node) {\n            return true;\n          }\n          node = node.parentNode;\n        }\n        return false;\n      };\n      var dumpRng = function (r) {\n        return 'startContainer: ' + r.startContainer.nodeName + ', startOffset: ' + r.startOffset + ', endContainer: ' + r.endContainer.nodeName + ', endOffset: ' + r.endOffset;\n      };\n      var self = {\n        doc: doc,\n        settings: settings,\n        win: win,\n        files: files,\n        stdMode: stdMode,\n        boxModel: boxModel,\n        styleSheetLoader: styleSheetLoader,\n        boundEvents: boundEvents,\n        styles: styles,\n        schema: schema,\n        events: events,\n        isBlock: isBlock,\n        $: $,\n        $$: $$,\n        root: null,\n        clone: clone,\n        getRoot: getRoot,\n        getViewPort: getViewPort,\n        getRect: getRect,\n        getSize: getSize,\n        getParent: getParent,\n        getParents: getParents,\n        get: get,\n        getNext: getNext,\n        getPrev: getPrev,\n        select: select,\n        is: is,\n        add: add,\n        create: create,\n        createHTML: createHTML,\n        createFragment: createFragment,\n        remove: remove,\n        setStyle: setStyle,\n        getStyle: getStyle,\n        setStyles: setStyles,\n        removeAllAttribs: removeAllAttribs,\n        setAttrib: setAttrib,\n        setAttribs: setAttribs,\n        getAttrib: getAttrib,\n        getPos: getPos,\n        parseStyle: parseStyle,\n        serializeStyle: serializeStyle,\n        addStyle: addStyle,\n        loadCSS: loadCSS,\n        addClass: addClass,\n        removeClass: removeClass,\n        hasClass: hasClass,\n        toggleClass: toggleClass,\n        show: show,\n        hide: hide,\n        isHidden: isHidden,\n        uniqueId: uniqueId,\n        setHTML: setHTML,\n        getOuterHTML: getOuterHTML,\n        setOuterHTML: setOuterHTML,\n        decode: decode,\n        encode: encode,\n        insertAfter: insertAfter,\n        replace: replace,\n        rename: rename,\n        findCommonAncestor: findCommonAncestor,\n        toHex: toHex,\n        run: run,\n        getAttribs: getAttribs,\n        isEmpty: isEmpty,\n        createRng: createRng,\n        nodeIndex: findNodeIndex,\n        split: split,\n        bind: bind,\n        unbind: unbind,\n        fire: fire,\n        getContentEditable: getContentEditable,\n        getContentEditableParent: getContentEditableParent,\n        destroy: destroy,\n        isChildOf: isChildOf,\n        dumpRng: dumpRng\n      };\n      attrHooks = setupAttrHooks(styles, settings, function () {\n        return self;\n      });\n      return self;\n    }\n    (function (DOMUtils) {\n      DOMUtils.DOM = DOMUtils(domGlobals.document);\n      DOMUtils.nodeIndex = findNodeIndex;\n    }(DOMUtils || (DOMUtils = {})));\n    var DOMUtils$1 = DOMUtils;\n\n    var DOM = DOMUtils$1.DOM;\n    var each$6 = Tools.each, grep$2 = Tools.grep;\n    var QUEUED = 0;\n    var LOADING = 1;\n    var LOADED = 2;\n    var FAILED = 3;\n    var ScriptLoader = function () {\n      function ScriptLoader(settings) {\n        if (settings === void 0) {\n          settings = {};\n        }\n        this.states = {};\n        this.queue = [];\n        this.scriptLoadedCallbacks = {};\n        this.queueLoadedCallbacks = [];\n        this.loading = 0;\n        this.settings = settings;\n      }\n      ScriptLoader.prototype._setReferrerPolicy = function (referrerPolicy) {\n        this.settings.referrerPolicy = referrerPolicy;\n      };\n      ScriptLoader.prototype.loadScript = function (url, success, failure) {\n        var dom = DOM;\n        var elm, id;\n        var done = function () {\n          dom.remove(id);\n          if (elm) {\n            elm.onreadystatechange = elm.onload = elm = null;\n          }\n          success();\n        };\n        var error = function () {\n          if (isFunction(failure)) {\n            failure();\n          } else {\n            if (typeof domGlobals.console !== 'undefined' && domGlobals.console.log) {\n              domGlobals.console.log('Failed to load script: ' + url);\n            }\n          }\n        };\n        id = dom.uniqueId();\n        elm = domGlobals.document.createElement('script');\n        elm.id = id;\n        elm.type = 'text/javascript';\n        elm.src = Tools._addCacheSuffix(url);\n        if (this.settings.referrerPolicy) {\n          dom.setAttrib(elm, 'referrerpolicy', this.settings.referrerPolicy);\n        }\n        elm.onload = done;\n        elm.onerror = error;\n        (domGlobals.document.getElementsByTagName('head')[0] || domGlobals.document.body).appendChild(elm);\n      };\n      ScriptLoader.prototype.isDone = function (url) {\n        return this.states[url] === LOADED;\n      };\n      ScriptLoader.prototype.markDone = function (url) {\n        this.states[url] = LOADED;\n      };\n      ScriptLoader.prototype.add = function (url, success, scope, failure) {\n        var state = this.states[url];\n        if (state === undefined) {\n          this.queue.push(url);\n          this.states[url] = QUEUED;\n        }\n        if (success) {\n          if (!this.scriptLoadedCallbacks[url]) {\n            this.scriptLoadedCallbacks[url] = [];\n          }\n          this.scriptLoadedCallbacks[url].push({\n            success: success,\n            failure: failure,\n            scope: scope || this\n          });\n        }\n      };\n      ScriptLoader.prototype.load = function (url, success, scope, failure) {\n        return this.add(url, success, scope, failure);\n      };\n      ScriptLoader.prototype.remove = function (url) {\n        delete this.states[url];\n        delete this.scriptLoadedCallbacks[url];\n      };\n      ScriptLoader.prototype.loadQueue = function (success, scope, failure) {\n        this.loadScripts(this.queue, success, scope, failure);\n      };\n      ScriptLoader.prototype.loadScripts = function (scripts, success, scope, failure) {\n        var self = this;\n        var loadScripts;\n        var failures = [];\n        var execCallbacks = function (name, url) {\n          each$6(self.scriptLoadedCallbacks[url], function (callback) {\n            if (isFunction(callback[name])) {\n              callback[name].call(callback.scope);\n            }\n          });\n          self.scriptLoadedCallbacks[url] = undefined;\n        };\n        self.queueLoadedCallbacks.push({\n          success: success,\n          failure: failure,\n          scope: scope || this\n        });\n        loadScripts = function () {\n          var loadingScripts = grep$2(scripts);\n          scripts.length = 0;\n          each$6(loadingScripts, function (url) {\n            if (self.states[url] === LOADED) {\n              execCallbacks('success', url);\n              return;\n            }\n            if (self.states[url] === FAILED) {\n              execCallbacks('failure', url);\n              return;\n            }\n            if (self.states[url] !== LOADING) {\n              self.states[url] = LOADING;\n              self.loading++;\n              self.loadScript(url, function () {\n                self.states[url] = LOADED;\n                self.loading--;\n                execCallbacks('success', url);\n                loadScripts();\n              }, function () {\n                self.states[url] = FAILED;\n                self.loading--;\n                failures.push(url);\n                execCallbacks('failure', url);\n                loadScripts();\n              });\n            }\n          });\n          if (!self.loading) {\n            var notifyCallbacks = self.queueLoadedCallbacks.slice(0);\n            self.queueLoadedCallbacks.length = 0;\n            each$6(notifyCallbacks, function (callback) {\n              if (failures.length === 0) {\n                if (isFunction(callback.success)) {\n                  callback.success.call(callback.scope);\n                }\n              } else {\n                if (isFunction(callback.failure)) {\n                  callback.failure.call(callback.scope, failures);\n                }\n              }\n            });\n          }\n        };\n        loadScripts();\n      };\n      ScriptLoader.ScriptLoader = new ScriptLoader();\n      return ScriptLoader;\n    }();\n\n    var isRaw = function (str) {\n      return isObject(str) && has(str, 'raw');\n    };\n    var isTokenised = function (str) {\n      return isArray(str) && str.length > 1;\n    };\n    var data = {};\n    var currentCode = Cell('en');\n    var getLanguageData = function () {\n      return get(data, currentCode.get());\n    };\n    var getData = function () {\n      return map$1(data, function (value) {\n        return __assign({}, value);\n      });\n    };\n    var setCode = function (newCode) {\n      if (newCode) {\n        currentCode.set(newCode);\n      }\n    };\n    var getCode = function () {\n      return currentCode.get();\n    };\n    var add = function (code, items) {\n      var langData = data[code];\n      if (!langData) {\n        data[code] = langData = {};\n      }\n      each$1(items, function (translation, name) {\n        langData[name.toLowerCase()] = translation;\n      });\n    };\n    var translate = function (text) {\n      var langData = getLanguageData().getOr({});\n      var toString = function (obj) {\n        if (isFunction(obj)) {\n          return Object.prototype.toString.call(obj);\n        }\n        return !isEmpty(obj) ? '' + obj : '';\n      };\n      var isEmpty = function (text) {\n        return text === '' || text === null || text === undefined;\n      };\n      var getLangData = function (text) {\n        var textstr = toString(text);\n        return get(langData, textstr.toLowerCase()).map(toString).getOr(textstr);\n      };\n      var removeContext = function (str) {\n        return str.replace(/{context:\\w+}$/, '');\n      };\n      var translated = function (text) {\n        return text;\n      };\n      if (isEmpty(text)) {\n        return translated('');\n      }\n      if (isRaw(text)) {\n        return translated(toString(text.raw));\n      }\n      if (isTokenised(text)) {\n        var values_1 = text.slice(1);\n        var substitued = getLangData(text[0]).replace(/\\{([0-9]+)\\}/g, function ($1, $2) {\n          return has(values_1, $2) ? toString(values_1[$2]) : $1;\n        });\n        return translated(removeContext(substitued));\n      }\n      return translated(removeContext(getLangData(text)));\n    };\n    var isRtl = function () {\n      return getLanguageData().bind(function (items) {\n        return get(items, '_dir');\n      }).exists(function (dir) {\n        return dir === 'rtl';\n      });\n    };\n    var hasCode = function (code) {\n      return has(data, code);\n    };\n    var I18n = {\n      getData: getData,\n      setCode: setCode,\n      getCode: getCode,\n      add: add,\n      translate: translate,\n      isRtl: isRtl,\n      hasCode: hasCode\n    };\n\n    function AddOnManager() {\n      var _this = this;\n      var items = [];\n      var urls = {};\n      var lookup = {};\n      var _listeners = [];\n      var runListeners = function (name, state) {\n        var matchedListeners = filter(_listeners, function (listener) {\n          return listener.name === name && listener.state === state;\n        });\n        each(matchedListeners, function (listener) {\n          return listener.callback();\n        });\n      };\n      var get = function (name) {\n        if (lookup[name]) {\n          return lookup[name].instance;\n        }\n        return undefined;\n      };\n      var dependencies = function (name) {\n        var result;\n        if (lookup[name]) {\n          result = lookup[name].dependencies;\n        }\n        return result || [];\n      };\n      var requireLangPack = function (name, languages) {\n        if (AddOnManager.languageLoad !== false) {\n          waitFor(name, function () {\n            var language = I18n.getCode();\n            var wrappedLanguages = ',' + (languages || '') + ',';\n            if (!language || languages && wrappedLanguages.indexOf(',' + language + ',') === -1) {\n              return;\n            }\n            ScriptLoader.ScriptLoader.add(urls[name] + '/langs/' + language + '.js');\n          }, 'loaded');\n        }\n      };\n      var add = function (id, addOn, dependencies) {\n        var addOnConstructor = addOn;\n        items.push(addOnConstructor);\n        lookup[id] = {\n          instance: addOnConstructor,\n          dependencies: dependencies\n        };\n        runListeners(id, 'added');\n        return addOnConstructor;\n      };\n      var remove = function (name) {\n        delete urls[name];\n        delete lookup[name];\n      };\n      var createUrl = function (baseUrl, dep) {\n        if (typeof dep === 'object') {\n          return dep;\n        }\n        return typeof baseUrl === 'string' ? {\n          prefix: '',\n          resource: dep,\n          suffix: ''\n        } : {\n          prefix: baseUrl.prefix,\n          resource: dep,\n          suffix: baseUrl.suffix\n        };\n      };\n      var addComponents = function (pluginName, scripts) {\n        var pluginUrl = _this.urls[pluginName];\n        each(scripts, function (script) {\n          ScriptLoader.ScriptLoader.add(pluginUrl + '/' + script);\n        });\n      };\n      var loadDependencies = function (name, addOnUrl, success, scope) {\n        var deps = dependencies(name);\n        each(deps, function (dep) {\n          var newUrl = createUrl(addOnUrl, dep);\n          load(newUrl.resource, newUrl, undefined, undefined);\n        });\n        if (success) {\n          if (scope) {\n            success.call(scope);\n          } else {\n            success.call(ScriptLoader);\n          }\n        }\n      };\n      var load = function (name, addOnUrl, success, scope, failure) {\n        if (urls[name]) {\n          return;\n        }\n        var urlString = typeof addOnUrl === 'string' ? addOnUrl : addOnUrl.prefix + addOnUrl.resource + addOnUrl.suffix;\n        if (urlString.indexOf('/') !== 0 && urlString.indexOf('://') === -1) {\n          urlString = AddOnManager.baseURL + '/' + urlString;\n        }\n        urls[name] = urlString.substring(0, urlString.lastIndexOf('/'));\n        var done = function () {\n          runListeners(name, 'loaded');\n          loadDependencies(name, addOnUrl, success, scope);\n        };\n        if (lookup[name]) {\n          done();\n        } else {\n          ScriptLoader.ScriptLoader.add(urlString, done, scope, failure);\n        }\n      };\n      var waitFor = function (name, callback, state) {\n        if (state === void 0) {\n          state = 'added';\n        }\n        if (has(lookup, name) && state === 'added') {\n          callback();\n        } else if (has(urls, name) && state === 'loaded') {\n          callback();\n        } else {\n          _listeners.push({\n            name: name,\n            state: state,\n            callback: callback\n          });\n        }\n      };\n      return {\n        items: items,\n        urls: urls,\n        lookup: lookup,\n        _listeners: _listeners,\n        get: get,\n        dependencies: dependencies,\n        requireLangPack: requireLangPack,\n        add: add,\n        remove: remove,\n        createUrl: createUrl,\n        addComponents: addComponents,\n        load: load,\n        waitFor: waitFor\n      };\n    }\n    (function (AddOnManager) {\n      AddOnManager.PluginManager = AddOnManager();\n      AddOnManager.ThemeManager = AddOnManager();\n    }(AddOnManager || (AddOnManager = {})));\n    var AddOnManager$1 = AddOnManager;\n\n    var first = function (fn, rate) {\n      var timer = null;\n      var cancel = function () {\n        if (timer !== null) {\n          domGlobals.clearTimeout(timer);\n          timer = null;\n        }\n      };\n      var throttle = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (timer === null) {\n          timer = domGlobals.setTimeout(function () {\n            fn.apply(null, args);\n            timer = null;\n          }, rate);\n        }\n      };\n      return {\n        cancel: cancel,\n        throttle: throttle\n      };\n    };\n    var last$2 = function (fn, rate) {\n      var timer = null;\n      var cancel = function () {\n        if (timer !== null) {\n          domGlobals.clearTimeout(timer);\n          timer = null;\n        }\n      };\n      var throttle = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (timer !== null) {\n          domGlobals.clearTimeout(timer);\n        }\n        timer = domGlobals.setTimeout(function () {\n          fn.apply(null, args);\n          timer = null;\n        }, rate);\n      };\n      return {\n        cancel: cancel,\n        throttle: throttle\n      };\n    };\n\n    var read = function (element, attr) {\n      var value = get$3(element, attr);\n      return value === undefined || value === '' ? [] : value.split(' ');\n    };\n    var add$1 = function (element, attr, id) {\n      var old = read(element, attr);\n      var nu = old.concat([id]);\n      set(element, attr, nu.join(' '));\n      return true;\n    };\n    var remove$2 = function (element, attr, id) {\n      var nu = filter(read(element, attr), function (v) {\n        return v !== id;\n      });\n      if (nu.length > 0) {\n        set(element, attr, nu.join(' '));\n      } else {\n        remove$1(element, attr);\n      }\n      return false;\n    };\n\n    var supports = function (element) {\n      return element.dom().classList !== undefined;\n    };\n    var get$5 = function (element) {\n      return read(element, 'class');\n    };\n    var add$2 = function (element, clazz) {\n      return add$1(element, 'class', clazz);\n    };\n    var remove$3 = function (element, clazz) {\n      return remove$2(element, 'class', clazz);\n    };\n\n    var add$3 = function (element, clazz) {\n      if (supports(element)) {\n        element.dom().classList.add(clazz);\n      } else {\n        add$2(element, clazz);\n      }\n    };\n    var cleanClass = function (element) {\n      var classList = supports(element) ? element.dom().classList : get$5(element);\n      if (classList.length === 0) {\n        remove$1(element, 'class');\n      }\n    };\n    var remove$4 = function (element, clazz) {\n      if (supports(element)) {\n        var classList = element.dom().classList;\n        classList.remove(clazz);\n      } else {\n        remove$3(element, clazz);\n      }\n      cleanClass(element);\n    };\n    var has$2 = function (element, clazz) {\n      return supports(element) && element.dom().classList.contains(clazz);\n    };\n\n    var descendants = function (scope, predicate) {\n      var result = [];\n      each(children(scope), function (x) {\n        if (predicate(x)) {\n          result = result.concat([x]);\n        }\n        result = result.concat(descendants(x, predicate));\n      });\n      return result;\n    };\n\n    var descendants$1 = function (scope, selector) {\n      return all(selector, scope);\n    };\n\n    function ClosestOrAncestor (is, ancestor, scope, a, isRoot) {\n      return is(scope, a) ? Option.some(scope) : isFunction(isRoot) && isRoot(scope) ? Option.none() : ancestor(scope, a, isRoot);\n    }\n\n    var ancestor = function (scope, predicate, isRoot) {\n      var element = scope.dom();\n      var stop = isFunction(isRoot) ? isRoot : constant(false);\n      while (element.parentNode) {\n        element = element.parentNode;\n        var el = Element.fromDom(element);\n        if (predicate(el)) {\n          return Option.some(el);\n        } else if (stop(el)) {\n          break;\n        }\n      }\n      return Option.none();\n    };\n    var closest = function (scope, predicate, isRoot) {\n      var is = function (s, test) {\n        return test(s);\n      };\n      return ClosestOrAncestor(is, ancestor, scope, predicate, isRoot);\n    };\n\n    var ancestor$1 = function (scope, selector, isRoot) {\n      return ancestor(scope, function (e) {\n        return is(e, selector);\n      }, isRoot);\n    };\n    var descendant = function (scope, selector) {\n      return one(selector, scope);\n    };\n    var closest$1 = function (scope, selector, isRoot) {\n      return ClosestOrAncestor(is, ancestor$1, scope, selector, isRoot);\n    };\n\n    var annotation = constant('mce-annotation');\n    var dataAnnotation = constant('data-mce-annotation');\n    var dataAnnotationId = constant('data-mce-annotation-uid');\n\n    var identify = function (editor, annotationName) {\n      var rng = editor.selection.getRng();\n      var start = Element.fromDom(rng.startContainer);\n      var root = Element.fromDom(editor.getBody());\n      var selector = annotationName.fold(function () {\n        return '.' + annotation();\n      }, function (an) {\n        return '[' + dataAnnotation() + '=\"' + an + '\"]';\n      });\n      var newStart = child(start, rng.startOffset).getOr(start);\n      var closest = closest$1(newStart, selector, function (n) {\n        return eq(n, root);\n      });\n      var getAttr = function (c, property) {\n        if (has$1(c, property)) {\n          return Option.some(get$3(c, property));\n        } else {\n          return Option.none();\n        }\n      };\n      return closest.bind(function (c) {\n        return getAttr(c, '' + dataAnnotationId()).bind(function (uid) {\n          return getAttr(c, '' + dataAnnotation()).map(function (name) {\n            var elements = findMarkers(editor, uid);\n            return {\n              uid: uid,\n              name: name,\n              elements: elements\n            };\n          });\n        });\n      });\n    };\n    var isAnnotation = function (elem) {\n      return isElement(elem) && has$2(elem, annotation());\n    };\n    var findMarkers = function (editor, uid) {\n      var body = Element.fromDom(editor.getBody());\n      return descendants$1(body, '[' + dataAnnotationId() + '=\"' + uid + '\"]');\n    };\n    var findAll = function (editor, name) {\n      var body = Element.fromDom(editor.getBody());\n      var markers = descendants$1(body, '[' + dataAnnotation() + '=\"' + name + '\"]');\n      var directory = {};\n      each(markers, function (m) {\n        var uid = get$3(m, dataAnnotationId());\n        var nodesAlready = directory.hasOwnProperty(uid) ? directory[uid] : [];\n        directory[uid] = nodesAlready.concat([m]);\n      });\n      return directory;\n    };\n\n    var setup = function (editor, registry) {\n      var changeCallbacks = Cell({});\n      var initData = function () {\n        return {\n          listeners: [],\n          previous: Cell(Option.none())\n        };\n      };\n      var withCallbacks = function (name, f) {\n        updateCallbacks(name, function (data) {\n          f(data);\n          return data;\n        });\n      };\n      var updateCallbacks = function (name, f) {\n        var callbackMap = changeCallbacks.get();\n        var data = callbackMap.hasOwnProperty(name) ? callbackMap[name] : initData();\n        var outputData = f(data);\n        callbackMap[name] = outputData;\n        changeCallbacks.set(callbackMap);\n      };\n      var fireCallbacks = function (name, uid, elements) {\n        withCallbacks(name, function (data) {\n          each(data.listeners, function (f) {\n            return f(true, name, {\n              uid: uid,\n              nodes: map(elements, function (elem) {\n                return elem.dom();\n              })\n            });\n          });\n        });\n      };\n      var fireNoAnnotation = function (name) {\n        withCallbacks(name, function (data) {\n          each(data.listeners, function (f) {\n            return f(false, name);\n          });\n        });\n      };\n      var onNodeChange = last$2(function () {\n        var callbackMap = changeCallbacks.get();\n        var annotations = sort(keys(callbackMap));\n        each(annotations, function (name) {\n          updateCallbacks(name, function (data) {\n            var prev = data.previous.get();\n            identify(editor, Option.some(name)).fold(function () {\n              if (prev.isSome()) {\n                fireNoAnnotation(name);\n                data.previous.set(Option.none());\n              }\n            }, function (_a) {\n              var uid = _a.uid, name = _a.name, elements = _a.elements;\n              if (!prev.is(uid)) {\n                fireCallbacks(name, uid, elements);\n                data.previous.set(Option.some(uid));\n              }\n            });\n            return {\n              previous: data.previous,\n              listeners: data.listeners\n            };\n          });\n        });\n      }, 30);\n      editor.on('remove', function () {\n        onNodeChange.cancel();\n      });\n      editor.on('NodeChange', function () {\n        onNodeChange.throttle();\n      });\n      var addListener = function (name, f) {\n        updateCallbacks(name, function (data) {\n          return {\n            previous: data.previous,\n            listeners: data.listeners.concat([f])\n          };\n        });\n      };\n      return { addListener: addListener };\n    };\n\n    var setup$1 = function (editor, registry) {\n      var identifyParserNode = function (span) {\n        return Option.from(span.attr(dataAnnotation())).bind(registry.lookup);\n      };\n      editor.on('init', function () {\n        editor.serializer.addNodeFilter('span', function (spans) {\n          each(spans, function (span) {\n            identifyParserNode(span).each(function (settings) {\n              if (settings.persistent === false) {\n                span.unwrap();\n              }\n            });\n          });\n        });\n      });\n    };\n\n    var create$1 = function () {\n      var annotations = {};\n      var register = function (name, settings) {\n        annotations[name] = {\n          name: name,\n          settings: settings\n        };\n      };\n      var lookup = function (name) {\n        return annotations.hasOwnProperty(name) ? Option.from(annotations[name]).map(function (a) {\n          return a.settings;\n        }) : Option.none();\n      };\n      return {\n        register: register,\n        lookup: lookup\n      };\n    };\n\n    var unique = 0;\n    var generate = function (prefix) {\n      var date = new Date();\n      var time = date.getTime();\n      var random = Math.floor(Math.random() * 1000000000);\n      unique++;\n      return prefix + '_' + random + unique + String(time);\n    };\n\n    var add$4 = function (element, classes) {\n      each(classes, function (x) {\n        add$3(element, x);\n      });\n    };\n\n    var fromHtml$1 = function (html, scope) {\n      var doc = scope || domGlobals.document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      return children(Element.fromDom(div));\n    };\n\n    var get$6 = function (element) {\n      return element.dom().innerHTML;\n    };\n    var set$1 = function (element, content) {\n      var owner$1 = owner(element);\n      var docDom = owner$1.dom();\n      var fragment = Element.fromDom(docDom.createDocumentFragment());\n      var contentElements = fromHtml$1(content, docDom);\n      append$1(fragment, contentElements);\n      empty(element);\n      append(element, fragment);\n    };\n\n    var clone = function (original, isDeep) {\n      return Element.fromDom(original.dom().cloneNode(isDeep));\n    };\n    var shallow = function (original) {\n      return clone(original, false);\n    };\n    var deep = function (original) {\n      return clone(original, true);\n    };\n\n    var ZWSP = zeroWidth;\n    var isZwsp = function (chr) {\n      return chr === ZWSP;\n    };\n    var trim$3 = function (text) {\n      return text.replace(new RegExp(ZWSP, 'g'), '');\n    };\n    var Zwsp = {\n      isZwsp: isZwsp,\n      ZWSP: ZWSP,\n      trim: trim$3\n    };\n\n    var isElement$2 = NodeType.isElement;\n    var isText$2 = NodeType.isText;\n    var isCaretContainerBlock = function (node) {\n      if (isText$2(node)) {\n        node = node.parentNode;\n      }\n      return isElement$2(node) && node.hasAttribute('data-mce-caret');\n    };\n    var isCaretContainerInline = function (node) {\n      return isText$2(node) && Zwsp.isZwsp(node.data);\n    };\n    var isCaretContainer = function (node) {\n      return isCaretContainerBlock(node) || isCaretContainerInline(node);\n    };\n    var hasContent = function (node) {\n      return node.firstChild !== node.lastChild || !NodeType.isBr(node.firstChild);\n    };\n    var insertInline = function (node, before) {\n      var doc, sibling, textNode, parentNode;\n      doc = node.ownerDocument;\n      textNode = doc.createTextNode(Zwsp.ZWSP);\n      parentNode = node.parentNode;\n      if (!before) {\n        sibling = node.nextSibling;\n        if (isText$2(sibling)) {\n          if (isCaretContainer(sibling)) {\n            return sibling;\n          }\n          if (startsWithCaretContainer(sibling)) {\n            sibling.splitText(1);\n            return sibling;\n          }\n        }\n        if (node.nextSibling) {\n          parentNode.insertBefore(textNode, node.nextSibling);\n        } else {\n          parentNode.appendChild(textNode);\n        }\n      } else {\n        sibling = node.previousSibling;\n        if (isText$2(sibling)) {\n          if (isCaretContainer(sibling)) {\n            return sibling;\n          }\n          if (endsWithCaretContainer(sibling)) {\n            return sibling.splitText(sibling.data.length - 1);\n          }\n        }\n        parentNode.insertBefore(textNode, node);\n      }\n      return textNode;\n    };\n    var isBeforeInline = function (pos) {\n      var container = pos.container();\n      if (!pos || !NodeType.isText(container)) {\n        return false;\n      }\n      return container.data.charAt(pos.offset()) === Zwsp.ZWSP || pos.isAtStart() && isCaretContainerInline(container.previousSibling);\n    };\n    var isAfterInline = function (pos) {\n      var container = pos.container();\n      if (!pos || !NodeType.isText(container)) {\n        return false;\n      }\n      return container.data.charAt(pos.offset() - 1) === Zwsp.ZWSP || pos.isAtEnd() && isCaretContainerInline(container.nextSibling);\n    };\n    var createBogusBr = function () {\n      var br = domGlobals.document.createElement('br');\n      br.setAttribute('data-mce-bogus', '1');\n      return br;\n    };\n    var insertBlock = function (blockName, node, before) {\n      var doc, blockNode, parentNode;\n      doc = node.ownerDocument;\n      blockNode = doc.createElement(blockName);\n      blockNode.setAttribute('data-mce-caret', before ? 'before' : 'after');\n      blockNode.setAttribute('data-mce-bogus', 'all');\n      blockNode.appendChild(createBogusBr());\n      parentNode = node.parentNode;\n      if (!before) {\n        if (node.nextSibling) {\n          parentNode.insertBefore(blockNode, node.nextSibling);\n        } else {\n          parentNode.appendChild(blockNode);\n        }\n      } else {\n        parentNode.insertBefore(blockNode, node);\n      }\n      return blockNode;\n    };\n    var startsWithCaretContainer = function (node) {\n      return isText$2(node) && node.data[0] === Zwsp.ZWSP;\n    };\n    var endsWithCaretContainer = function (node) {\n      return isText$2(node) && node.data[node.data.length - 1] === Zwsp.ZWSP;\n    };\n    var trimBogusBr = function (elm) {\n      var brs = elm.getElementsByTagName('br');\n      var lastBr = brs[brs.length - 1];\n      if (NodeType.isBogus(lastBr)) {\n        lastBr.parentNode.removeChild(lastBr);\n      }\n    };\n    var showCaretContainerBlock = function (caretContainer) {\n      if (caretContainer && caretContainer.hasAttribute('data-mce-caret')) {\n        trimBogusBr(caretContainer);\n        caretContainer.removeAttribute('data-mce-caret');\n        caretContainer.removeAttribute('data-mce-bogus');\n        caretContainer.removeAttribute('style');\n        caretContainer.removeAttribute('_moz_abspos');\n        return caretContainer;\n      }\n      return null;\n    };\n    var isRangeInCaretContainerBlock = function (range) {\n      return isCaretContainerBlock(range.startContainer);\n    };\n\n    var isContentEditableTrue$1 = NodeType.isContentEditableTrue;\n    var isContentEditableFalse$1 = NodeType.isContentEditableFalse;\n    var isBr$2 = NodeType.isBr;\n    var isText$3 = NodeType.isText;\n    var isInvalidTextElement = NodeType.matchNodeNames([\n      'script',\n      'style',\n      'textarea'\n    ]);\n    var isAtomicInline = NodeType.matchNodeNames([\n      'img',\n      'input',\n      'textarea',\n      'hr',\n      'iframe',\n      'video',\n      'audio',\n      'object'\n    ]);\n    var isTable$2 = NodeType.matchNodeNames(['table']);\n    var isCaretContainer$1 = isCaretContainer;\n    var isCaretCandidate = function (node) {\n      if (isCaretContainer$1(node)) {\n        return false;\n      }\n      if (isText$3(node)) {\n        if (isInvalidTextElement(node.parentNode)) {\n          return false;\n        }\n        return true;\n      }\n      return isAtomicInline(node) || isBr$2(node) || isTable$2(node) || isNonUiContentEditableFalse(node);\n    };\n    var isUnselectable = function (node) {\n      return NodeType.isElement(node) && node.getAttribute('unselectable') === 'true';\n    };\n    var isNonUiContentEditableFalse = function (node) {\n      return isUnselectable(node) === false && isContentEditableFalse$1(node);\n    };\n    var isInEditable = function (node, root) {\n      for (node = node.parentNode; node && node !== root; node = node.parentNode) {\n        if (isNonUiContentEditableFalse(node)) {\n          return false;\n        }\n        if (isContentEditableTrue$1(node)) {\n          return true;\n        }\n      }\n      return true;\n    };\n    var isAtomicContentEditableFalse = function (node) {\n      if (!isNonUiContentEditableFalse(node)) {\n        return false;\n      }\n      return foldl(from$1(node.getElementsByTagName('*')), function (result, elm) {\n        return result || isContentEditableTrue$1(elm);\n      }, false) !== true;\n    };\n    var isAtomic = function (node) {\n      return isAtomicInline(node) || isAtomicContentEditableFalse(node);\n    };\n    var isEditableCaretCandidate = function (node, root) {\n      return isCaretCandidate(node) && isInEditable(node, root);\n    };\n\n    var round = Math.round;\n    var clone$1 = function (rect) {\n      if (!rect) {\n        return {\n          left: 0,\n          top: 0,\n          bottom: 0,\n          right: 0,\n          width: 0,\n          height: 0\n        };\n      }\n      return {\n        left: round(rect.left),\n        top: round(rect.top),\n        bottom: round(rect.bottom),\n        right: round(rect.right),\n        width: round(rect.width),\n        height: round(rect.height)\n      };\n    };\n    var collapse = function (rect, toStart) {\n      rect = clone$1(rect);\n      if (toStart) {\n        rect.right = rect.left;\n      } else {\n        rect.left = rect.left + rect.width;\n        rect.right = rect.left;\n      }\n      rect.width = 0;\n      return rect;\n    };\n    var isEqual = function (rect1, rect2) {\n      return rect1.left === rect2.left && rect1.top === rect2.top && rect1.bottom === rect2.bottom && rect1.right === rect2.right;\n    };\n    var isValidOverflow = function (overflowY, rect1, rect2) {\n      return overflowY >= 0 && overflowY <= Math.min(rect1.height, rect2.height) / 2;\n    };\n    var isAbove = function (rect1, rect2) {\n      if (rect1.bottom - rect1.height / 2 < rect2.top) {\n        return true;\n      }\n      if (rect1.top > rect2.bottom) {\n        return false;\n      }\n      return isValidOverflow(rect2.top - rect1.bottom, rect1, rect2);\n    };\n    var isBelow = function (rect1, rect2) {\n      if (rect1.top > rect2.bottom) {\n        return true;\n      }\n      if (rect1.bottom < rect2.top) {\n        return false;\n      }\n      return isValidOverflow(rect2.bottom - rect1.top, rect1, rect2);\n    };\n    var containsXY = function (rect, clientX, clientY) {\n      return clientX >= rect.left && clientX <= rect.right && clientY >= rect.top && clientY <= rect.bottom;\n    };\n\n    var getSelectedNode = function (range) {\n      var startContainer = range.startContainer, startOffset = range.startOffset;\n      if (startContainer.hasChildNodes() && range.endOffset === startOffset + 1) {\n        return startContainer.childNodes[startOffset];\n      }\n      return null;\n    };\n    var getNode = function (container, offset) {\n      if (container.nodeType === 1 && container.hasChildNodes()) {\n        if (offset >= container.childNodes.length) {\n          offset = container.childNodes.length - 1;\n        }\n        container = container.childNodes[offset];\n      }\n      return container;\n    };\n\n    var extendingChars = new RegExp('[\\u0300-\\u036f\\u0483-\\u0487\\u0488-\\u0489\\u0591-\\u05bd\\u05bf\\u05c1-\\u05c2\\u05c4-\\u05c5\\u05c7\\u0610-\\u061a' + '\\u064b-\\u065f\\u0670\\u06d6-\\u06dc\\u06df-\\u06e4\\u06e7-\\u06e8\\u06ea-\\u06ed\\u0711\\u0730-\\u074a\\u07a6-\\u07b0' + '\\u07eb-\\u07f3\\u0816-\\u0819\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0859-\\u085b\\u08e3-\\u0902\\u093a\\u093c' + '\\u0941-\\u0948\\u094d\\u0951-\\u0957\\u0962-\\u0963\\u0981\\u09bc\\u09be\\u09c1-\\u09c4\\u09cd\\u09d7\\u09e2-\\u09e3' + '\\u0a01-\\u0a02\\u0a3c\\u0a41-\\u0a42\\u0a47-\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a70-\\u0a71\\u0a75\\u0a81-\\u0a82\\u0abc' + '\\u0ac1-\\u0ac5\\u0ac7-\\u0ac8\\u0acd\\u0ae2-\\u0ae3\\u0b01\\u0b3c\\u0b3e\\u0b3f\\u0b41-\\u0b44\\u0b4d\\u0b56\\u0b57' + '\\u0b62-\\u0b63\\u0b82\\u0bbe\\u0bc0\\u0bcd\\u0bd7\\u0c00\\u0c3e-\\u0c40\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55-\\u0c56' + '\\u0c62-\\u0c63\\u0c81\\u0cbc\\u0cbf\\u0cc2\\u0cc6\\u0ccc-\\u0ccd\\u0cd5-\\u0cd6\\u0ce2-\\u0ce3\\u0d01\\u0d3e\\u0d41-\\u0d44' + '\\u0d4d\\u0d57\\u0d62-\\u0d63\\u0dca\\u0dcf\\u0dd2-\\u0dd4\\u0dd6\\u0ddf\\u0e31\\u0e34-\\u0e3a\\u0e47-\\u0e4e\\u0eb1\\u0eb4-\\u0eb9' + '\\u0ebb-\\u0ebc\\u0ec8-\\u0ecd\\u0f18-\\u0f19\\u0f35\\u0f37\\u0f39\\u0f71-\\u0f7e\\u0f80-\\u0f84\\u0f86-\\u0f87\\u0f8d-\\u0f97' + '\\u0f99-\\u0fbc\\u0fc6\\u102d-\\u1030\\u1032-\\u1037\\u1039-\\u103a\\u103d-\\u103e\\u1058-\\u1059\\u105e-\\u1060\\u1071-\\u1074' + '\\u1082\\u1085-\\u1086\\u108d\\u109d\\u135d-\\u135f\\u1712-\\u1714\\u1732-\\u1734\\u1752-\\u1753\\u1772-\\u1773\\u17b4-\\u17b5' + '\\u17b7-\\u17bd\\u17c6\\u17c9-\\u17d3\\u17dd\\u180b-\\u180d\\u18a9\\u1920-\\u1922\\u1927-\\u1928\\u1932\\u1939-\\u193b\\u1a17-\\u1a18' + '\\u1a1b\\u1a56\\u1a58-\\u1a5e\\u1a60\\u1a62\\u1a65-\\u1a6c\\u1a73-\\u1a7c\\u1a7f\\u1ab0-\\u1abd\\u1ABE\\u1b00-\\u1b03\\u1b34' + '\\u1b36-\\u1b3a\\u1b3c\\u1b42\\u1b6b-\\u1b73\\u1b80-\\u1b81\\u1ba2-\\u1ba5\\u1ba8-\\u1ba9\\u1bab-\\u1bad\\u1be6\\u1be8-\\u1be9' + '\\u1bed\\u1bef-\\u1bf1\\u1c2c-\\u1c33\\u1c36-\\u1c37\\u1cd0-\\u1cd2\\u1cd4-\\u1ce0\\u1ce2-\\u1ce8\\u1ced\\u1cf4\\u1cf8-\\u1cf9' + '\\u1dc0-\\u1df5\\u1dfc-\\u1dff\\u200c-\\u200d\\u20d0-\\u20dc\\u20DD-\\u20E0\\u20e1\\u20E2-\\u20E4\\u20e5-\\u20f0\\u2cef-\\u2cf1' + '\\u2d7f\\u2de0-\\u2dff\\u302a-\\u302d\\u302e-\\u302f\\u3099-\\u309a\\ua66f\\uA670-\\uA672\\ua674-\\ua67d\\ua69e-\\ua69f\\ua6f0-\\ua6f1' + '\\ua802\\ua806\\ua80b\\ua825-\\ua826\\ua8c4\\ua8e0-\\ua8f1\\ua926-\\ua92d\\ua947-\\ua951\\ua980-\\ua982\\ua9b3\\ua9b6-\\ua9b9\\ua9bc' + '\\ua9e5\\uaa29-\\uaa2e\\uaa31-\\uaa32\\uaa35-\\uaa36\\uaa43\\uaa4c\\uaa7c\\uaab0\\uaab2-\\uaab4\\uaab7-\\uaab8\\uaabe-\\uaabf\\uaac1' + '\\uaaec-\\uaaed\\uaaf6\\uabe5\\uabe8\\uabed\\ufb1e\\ufe00-\\ufe0f\\ufe20-\\ufe2f\\uff9e-\\uff9f]');\n    var isExtendingChar = function (ch) {\n      return typeof ch === 'string' && ch.charCodeAt(0) >= 768 && extendingChars.test(ch);\n    };\n\n    var lift2 = function (oa, ob, f) {\n      return oa.isSome() && ob.isSome() ? Option.some(f(oa.getOrDie(), ob.getOrDie())) : Option.none();\n    };\n    var lift3 = function (oa, ob, oc, f) {\n      return oa.isSome() && ob.isSome() && oc.isSome() ? Option.some(f(oa.getOrDie(), ob.getOrDie(), oc.getOrDie())) : Option.none();\n    };\n    var someIf = function (b, a) {\n      return b ? Option.some(a) : Option.none();\n    };\n\n    var slice$2 = [].slice;\n    var or = function () {\n      var x = [];\n      for (var _i = 0; _i < arguments.length; _i++) {\n        x[_i] = arguments[_i];\n      }\n      var args = slice$2.call(arguments);\n      return function (x) {\n        for (var i = 0; i < args.length; i++) {\n          if (args[i](x)) {\n            return true;\n          }\n        }\n        return false;\n      };\n    };\n    var and = function () {\n      var x = [];\n      for (var _i = 0; _i < arguments.length; _i++) {\n        x[_i] = arguments[_i];\n      }\n      var args = slice$2.call(arguments);\n      return function (x) {\n        for (var i = 0; i < args.length; i++) {\n          if (!args[i](x)) {\n            return false;\n          }\n        }\n        return true;\n      };\n    };\n    var Predicate = {\n      and: and,\n      or: or\n    };\n\n    var isElement$3 = NodeType.isElement;\n    var isCaretCandidate$1 = isCaretCandidate;\n    var isBlock$1 = NodeType.matchStyleValues('display', 'block table');\n    var isFloated = NodeType.matchStyleValues('float', 'left right');\n    var isValidElementCaretCandidate = Predicate.and(isElement$3, isCaretCandidate$1, not(isFloated));\n    var isNotPre = not(NodeType.matchStyleValues('white-space', 'pre pre-line pre-wrap'));\n    var isText$4 = NodeType.isText;\n    var isBr$3 = NodeType.isBr;\n    var nodeIndex = DOMUtils$1.nodeIndex;\n    var resolveIndex = getNode;\n    var createRange = function (doc) {\n      return 'createRange' in doc ? doc.createRange() : DOMUtils$1.DOM.createRng();\n    };\n    var isWhiteSpace = function (chr) {\n      return chr && /[\\r\\n\\t ]/.test(chr);\n    };\n    var isRange = function (rng) {\n      return !!rng.setStart && !!rng.setEnd;\n    };\n    var isHiddenWhiteSpaceRange = function (range) {\n      var container = range.startContainer;\n      var offset = range.startOffset;\n      var text;\n      if (isWhiteSpace(range.toString()) && isNotPre(container.parentNode) && NodeType.isText(container)) {\n        text = container.data;\n        if (isWhiteSpace(text[offset - 1]) || isWhiteSpace(text[offset + 1])) {\n          return true;\n        }\n      }\n      return false;\n    };\n    var getBrClientRect = function (brNode) {\n      var doc = brNode.ownerDocument;\n      var rng = createRange(doc);\n      var nbsp$1 = doc.createTextNode(nbsp);\n      var parentNode = brNode.parentNode;\n      var clientRect;\n      parentNode.insertBefore(nbsp$1, brNode);\n      rng.setStart(nbsp$1, 0);\n      rng.setEnd(nbsp$1, 1);\n      clientRect = clone$1(rng.getBoundingClientRect());\n      parentNode.removeChild(nbsp$1);\n      return clientRect;\n    };\n    var getBoundingClientRectWebKitText = function (rng) {\n      var sc = rng.startContainer;\n      var ec = rng.endContainer;\n      var so = rng.startOffset;\n      var eo = rng.endOffset;\n      if (sc === ec && NodeType.isText(ec) && so === 0 && eo === 1) {\n        var newRng = rng.cloneRange();\n        newRng.setEndAfter(ec);\n        return getBoundingClientRect(newRng);\n      } else {\n        return null;\n      }\n    };\n    var isZeroRect = function (r) {\n      return r.left === 0 && r.right === 0 && r.top === 0 && r.bottom === 0;\n    };\n    var getBoundingClientRect = function (item) {\n      var clientRect, clientRects;\n      clientRects = item.getClientRects();\n      if (clientRects.length > 0) {\n        clientRect = clone$1(clientRects[0]);\n      } else {\n        clientRect = clone$1(item.getBoundingClientRect());\n      }\n      if (!isRange(item) && isBr$3(item) && isZeroRect(clientRect)) {\n        return getBrClientRect(item);\n      }\n      if (isZeroRect(clientRect) && isRange(item)) {\n        return getBoundingClientRectWebKitText(item);\n      }\n      return clientRect;\n    };\n    var collapseAndInflateWidth = function (clientRect, toStart) {\n      var newClientRect = collapse(clientRect, toStart);\n      newClientRect.width = 1;\n      newClientRect.right = newClientRect.left + 1;\n      return newClientRect;\n    };\n    var getCaretPositionClientRects = function (caretPosition) {\n      var clientRects = [];\n      var beforeNode, node;\n      var addUniqueAndValidRect = function (clientRect) {\n        if (clientRect.height === 0) {\n          return;\n        }\n        if (clientRects.length > 0) {\n          if (isEqual(clientRect, clientRects[clientRects.length - 1])) {\n            return;\n          }\n        }\n        clientRects.push(clientRect);\n      };\n      var addCharacterOffset = function (container, offset) {\n        var range = createRange(container.ownerDocument);\n        if (offset < container.data.length) {\n          if (isExtendingChar(container.data[offset])) {\n            return clientRects;\n          }\n          if (isExtendingChar(container.data[offset - 1])) {\n            range.setStart(container, offset);\n            range.setEnd(container, offset + 1);\n            if (!isHiddenWhiteSpaceRange(range)) {\n              addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(range), false));\n              return clientRects;\n            }\n          }\n        }\n        if (offset > 0) {\n          range.setStart(container, offset - 1);\n          range.setEnd(container, offset);\n          if (!isHiddenWhiteSpaceRange(range)) {\n            addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(range), false));\n          }\n        }\n        if (offset < container.data.length) {\n          range.setStart(container, offset);\n          range.setEnd(container, offset + 1);\n          if (!isHiddenWhiteSpaceRange(range)) {\n            addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(range), true));\n          }\n        }\n      };\n      if (isText$4(caretPosition.container())) {\n        addCharacterOffset(caretPosition.container(), caretPosition.offset());\n        return clientRects;\n      }\n      if (isElement$3(caretPosition.container())) {\n        if (caretPosition.isAtEnd()) {\n          node = resolveIndex(caretPosition.container(), caretPosition.offset());\n          if (isText$4(node)) {\n            addCharacterOffset(node, node.data.length);\n          }\n          if (isValidElementCaretCandidate(node) && !isBr$3(node)) {\n            addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(node), false));\n          }\n        } else {\n          node = resolveIndex(caretPosition.container(), caretPosition.offset());\n          if (isText$4(node)) {\n            addCharacterOffset(node, 0);\n          }\n          if (isValidElementCaretCandidate(node) && caretPosition.isAtEnd()) {\n            addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(node), false));\n            return clientRects;\n          }\n          beforeNode = resolveIndex(caretPosition.container(), caretPosition.offset() - 1);\n          if (isValidElementCaretCandidate(beforeNode) && !isBr$3(beforeNode)) {\n            if (isBlock$1(beforeNode) || isBlock$1(node) || !isValidElementCaretCandidate(node)) {\n              addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(beforeNode), false));\n            }\n          }\n          if (isValidElementCaretCandidate(node)) {\n            addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(node), true));\n          }\n        }\n      }\n      return clientRects;\n    };\n    function CaretPosition(container, offset, clientRects) {\n      var isAtStart = function () {\n        if (isText$4(container)) {\n          return offset === 0;\n        }\n        return offset === 0;\n      };\n      var isAtEnd = function () {\n        if (isText$4(container)) {\n          return offset >= container.data.length;\n        }\n        return offset >= container.childNodes.length;\n      };\n      var toRange = function () {\n        var range;\n        range = createRange(container.ownerDocument);\n        range.setStart(container, offset);\n        range.setEnd(container, offset);\n        return range;\n      };\n      var getClientRects = function () {\n        if (!clientRects) {\n          clientRects = getCaretPositionClientRects(CaretPosition(container, offset));\n        }\n        return clientRects;\n      };\n      var isVisible = function () {\n        return getClientRects().length > 0;\n      };\n      var isEqual = function (caretPosition) {\n        return caretPosition && container === caretPosition.container() && offset === caretPosition.offset();\n      };\n      var getNode = function (before) {\n        return resolveIndex(container, before ? offset - 1 : offset);\n      };\n      return {\n        container: constant(container),\n        offset: constant(offset),\n        toRange: toRange,\n        getClientRects: getClientRects,\n        isVisible: isVisible,\n        isAtStart: isAtStart,\n        isAtEnd: isAtEnd,\n        isEqual: isEqual,\n        getNode: getNode\n      };\n    }\n    (function (CaretPosition) {\n      CaretPosition.fromRangeStart = function (range) {\n        return CaretPosition(range.startContainer, range.startOffset);\n      };\n      CaretPosition.fromRangeEnd = function (range) {\n        return CaretPosition(range.endContainer, range.endOffset);\n      };\n      CaretPosition.after = function (node) {\n        return CaretPosition(node.parentNode, nodeIndex(node) + 1);\n      };\n      CaretPosition.before = function (node) {\n        return CaretPosition(node.parentNode, nodeIndex(node));\n      };\n      CaretPosition.isAbove = function (pos1, pos2) {\n        return lift2(head(pos2.getClientRects()), last(pos1.getClientRects()), isAbove).getOr(false);\n      };\n      CaretPosition.isBelow = function (pos1, pos2) {\n        return lift2(last(pos2.getClientRects()), head(pos1.getClientRects()), isBelow).getOr(false);\n      };\n      CaretPosition.isAtStart = function (pos) {\n        return pos ? pos.isAtStart() : false;\n      };\n      CaretPosition.isAtEnd = function (pos) {\n        return pos ? pos.isAtEnd() : false;\n      };\n      CaretPosition.isTextPosition = function (pos) {\n        return pos ? NodeType.isText(pos.container()) : false;\n      };\n      CaretPosition.isElementPosition = function (pos) {\n        return CaretPosition.isTextPosition(pos) === false;\n      };\n    }(CaretPosition || (CaretPosition = {})));\n    var CaretPosition$1 = CaretPosition;\n\n    var isText$5 = NodeType.isText;\n    var isBogus$1 = NodeType.isBogus;\n    var nodeIndex$1 = DOMUtils$1.nodeIndex;\n    var normalizedParent = function (node) {\n      var parentNode = node.parentNode;\n      if (isBogus$1(parentNode)) {\n        return normalizedParent(parentNode);\n      }\n      return parentNode;\n    };\n    var getChildNodes = function (node) {\n      if (!node) {\n        return [];\n      }\n      return ArrUtils.reduce(node.childNodes, function (result, node) {\n        if (isBogus$1(node) && node.nodeName !== 'BR') {\n          result = result.concat(getChildNodes(node));\n        } else {\n          result.push(node);\n        }\n        return result;\n      }, []);\n    };\n    var normalizedTextOffset = function (node, offset) {\n      while (node = node.previousSibling) {\n        if (!isText$5(node)) {\n          break;\n        }\n        offset += node.data.length;\n      }\n      return offset;\n    };\n    var equal = function (a) {\n      return function (b) {\n        return a === b;\n      };\n    };\n    var normalizedNodeIndex = function (node) {\n      var nodes, index, numTextFragments;\n      nodes = getChildNodes(normalizedParent(node));\n      index = ArrUtils.findIndex(nodes, equal(node), node);\n      nodes = nodes.slice(0, index + 1);\n      numTextFragments = ArrUtils.reduce(nodes, function (result, node, i) {\n        if (isText$5(node) && isText$5(nodes[i - 1])) {\n          result++;\n        }\n        return result;\n      }, 0);\n      nodes = ArrUtils.filter(nodes, NodeType.matchNodeNames([node.nodeName]));\n      index = ArrUtils.findIndex(nodes, equal(node), node);\n      return index - numTextFragments;\n    };\n    var createPathItem = function (node) {\n      var name;\n      if (isText$5(node)) {\n        name = 'text()';\n      } else {\n        name = node.nodeName.toLowerCase();\n      }\n      return name + '[' + normalizedNodeIndex(node) + ']';\n    };\n    var parentsUntil = function (root, node, predicate) {\n      var parents = [];\n      for (node = node.parentNode; node !== root; node = node.parentNode) {\n        if (predicate && predicate(node)) {\n          break;\n        }\n        parents.push(node);\n      }\n      return parents;\n    };\n    var create$2 = function (root, caretPosition) {\n      var container, offset, path = [], outputOffset, childNodes, parents;\n      container = caretPosition.container();\n      offset = caretPosition.offset();\n      if (isText$5(container)) {\n        outputOffset = normalizedTextOffset(container, offset);\n      } else {\n        childNodes = container.childNodes;\n        if (offset >= childNodes.length) {\n          outputOffset = 'after';\n          offset = childNodes.length - 1;\n        } else {\n          outputOffset = 'before';\n        }\n        container = childNodes[offset];\n      }\n      path.push(createPathItem(container));\n      parents = parentsUntil(root, container);\n      parents = ArrUtils.filter(parents, not(NodeType.isBogus));\n      path = path.concat(ArrUtils.map(parents, function (node) {\n        return createPathItem(node);\n      }));\n      return path.reverse().join('/') + ',' + outputOffset;\n    };\n    var resolvePathItem = function (node, name, index) {\n      var nodes = getChildNodes(node);\n      nodes = ArrUtils.filter(nodes, function (node, index) {\n        return !isText$5(node) || !isText$5(nodes[index - 1]);\n      });\n      nodes = ArrUtils.filter(nodes, NodeType.matchNodeNames([name]));\n      return nodes[index];\n    };\n    var findTextPosition = function (container, offset) {\n      var node = container, targetOffset = 0, dataLen;\n      while (isText$5(node)) {\n        dataLen = node.data.length;\n        if (offset >= targetOffset && offset <= targetOffset + dataLen) {\n          container = node;\n          offset = offset - targetOffset;\n          break;\n        }\n        if (!isText$5(node.nextSibling)) {\n          container = node;\n          offset = dataLen;\n          break;\n        }\n        targetOffset += dataLen;\n        node = node.nextSibling;\n      }\n      if (isText$5(container) && offset > container.data.length) {\n        offset = container.data.length;\n      }\n      return CaretPosition$1(container, offset);\n    };\n    var resolve$1 = function (root, path) {\n      var parts, container, offset;\n      if (!path) {\n        return null;\n      }\n      parts = path.split(',');\n      path = parts[0].split('/');\n      offset = parts.length > 1 ? parts[1] : 'before';\n      container = ArrUtils.reduce(path, function (result, value) {\n        value = /([\\w\\-\\(\\)]+)\\[([0-9]+)\\]/.exec(value);\n        if (!value) {\n          return null;\n        }\n        if (value[1] === 'text()') {\n          value[1] = '#text';\n        }\n        return resolvePathItem(result, value[1], parseInt(value[2], 10));\n      }, root);\n      if (!container) {\n        return null;\n      }\n      if (!isText$5(container)) {\n        if (offset === 'after') {\n          offset = nodeIndex$1(container) + 1;\n        } else {\n          offset = nodeIndex$1(container);\n        }\n        return CaretPosition$1(container.parentNode, offset);\n      }\n      return findTextPosition(container, parseInt(offset, 10));\n    };\n\n    var trimEmptyTextNode = function (dom, node) {\n      if (NodeType.isText(node) && node.data.length === 0) {\n        dom.remove(node);\n      }\n    };\n    var insertNode = function (dom, rng, node) {\n      rng.insertNode(node);\n      trimEmptyTextNode(dom, node.previousSibling);\n      trimEmptyTextNode(dom, node.nextSibling);\n    };\n    var insertFragment = function (dom, rng, frag) {\n      var firstChild = Option.from(frag.firstChild);\n      var lastChild = Option.from(frag.lastChild);\n      rng.insertNode(frag);\n      firstChild.each(function (child) {\n        return trimEmptyTextNode(dom, child.previousSibling);\n      });\n      lastChild.each(function (child) {\n        return trimEmptyTextNode(dom, child.nextSibling);\n      });\n    };\n    var rangeInsertNode = function (dom, rng, node) {\n      if (NodeType.isDocumentFragment(node)) {\n        insertFragment(dom, rng, node);\n      } else {\n        insertNode(dom, rng, node);\n      }\n    };\n\n    var isContentEditableFalse$2 = NodeType.isContentEditableFalse;\n    var getNormalizedTextOffset = function (trim, container, offset) {\n      var node, trimmedOffset;\n      trimmedOffset = trim(container.data.slice(0, offset)).length;\n      for (node = container.previousSibling; node && NodeType.isText(node); node = node.previousSibling) {\n        trimmedOffset += trim(node.data).length;\n      }\n      return trimmedOffset;\n    };\n    var getPoint = function (dom, trim, normalized, rng, start) {\n      var container = rng[start ? 'startContainer' : 'endContainer'];\n      var offset = rng[start ? 'startOffset' : 'endOffset'];\n      var point = [];\n      var childNodes, after = 0;\n      var root = dom.getRoot();\n      if (NodeType.isText(container)) {\n        point.push(normalized ? getNormalizedTextOffset(trim, container, offset) : offset);\n      } else {\n        childNodes = container.childNodes;\n        if (offset >= childNodes.length && childNodes.length) {\n          after = 1;\n          offset = Math.max(0, childNodes.length - 1);\n        }\n        point.push(dom.nodeIndex(childNodes[offset], normalized) + after);\n      }\n      for (; container && container !== root; container = container.parentNode) {\n        point.push(dom.nodeIndex(container, normalized));\n      }\n      return point;\n    };\n    var getLocation = function (trim, selection, normalized, rng) {\n      var dom = selection.dom, bookmark = {};\n      bookmark.start = getPoint(dom, trim, normalized, rng, true);\n      if (!selection.isCollapsed()) {\n        bookmark.end = getPoint(dom, trim, normalized, rng, false);\n      }\n      return bookmark;\n    };\n    var findIndex$2 = function (dom, name, element) {\n      var count = 0;\n      Tools.each(dom.select(name), function (node) {\n        if (node.getAttribute('data-mce-bogus') === 'all') {\n          return;\n        }\n        if (node === element) {\n          return false;\n        }\n        count++;\n      });\n      return count;\n    };\n    var moveEndPoint = function (rng, start) {\n      var container, offset, childNodes;\n      var prefix = start ? 'start' : 'end';\n      container = rng[prefix + 'Container'];\n      offset = rng[prefix + 'Offset'];\n      if (NodeType.isElement(container) && container.nodeName === 'TR') {\n        childNodes = container.childNodes;\n        container = childNodes[Math.min(start ? offset : offset - 1, childNodes.length - 1)];\n        if (container) {\n          offset = start ? 0 : container.childNodes.length;\n          rng['set' + (start ? 'Start' : 'End')](container, offset);\n        }\n      }\n    };\n    var normalizeTableCellSelection = function (rng) {\n      moveEndPoint(rng, true);\n      moveEndPoint(rng, false);\n      return rng;\n    };\n    var findSibling = function (node, offset) {\n      var sibling;\n      if (NodeType.isElement(node)) {\n        node = getNode(node, offset);\n        if (isContentEditableFalse$2(node)) {\n          return node;\n        }\n      }\n      if (isCaretContainer(node)) {\n        if (NodeType.isText(node) && isCaretContainerBlock(node)) {\n          node = node.parentNode;\n        }\n        sibling = node.previousSibling;\n        if (isContentEditableFalse$2(sibling)) {\n          return sibling;\n        }\n        sibling = node.nextSibling;\n        if (isContentEditableFalse$2(sibling)) {\n          return sibling;\n        }\n      }\n    };\n    var findAdjacentContentEditableFalseElm = function (rng) {\n      return findSibling(rng.startContainer, rng.startOffset) || findSibling(rng.endContainer, rng.endOffset);\n    };\n    var getOffsetBookmark = function (trim, normalized, selection) {\n      var element = selection.getNode();\n      var name = element ? element.nodeName : null;\n      var rng = selection.getRng();\n      if (isContentEditableFalse$2(element) || name === 'IMG') {\n        return {\n          name: name,\n          index: findIndex$2(selection.dom, name, element)\n        };\n      }\n      var sibling = findAdjacentContentEditableFalseElm(rng);\n      if (sibling) {\n        name = sibling.tagName;\n        return {\n          name: name,\n          index: findIndex$2(selection.dom, name, sibling)\n        };\n      }\n      return getLocation(trim, selection, normalized, rng);\n    };\n    var getCaretBookmark = function (selection) {\n      var rng = selection.getRng();\n      return {\n        start: create$2(selection.dom.getRoot(), CaretPosition$1.fromRangeStart(rng)),\n        end: create$2(selection.dom.getRoot(), CaretPosition$1.fromRangeEnd(rng))\n      };\n    };\n    var getRangeBookmark = function (selection) {\n      return { rng: selection.getRng() };\n    };\n    var createBookmarkSpan = function (dom, id, filled) {\n      var args = {\n        'data-mce-type': 'bookmark',\n        'id': id,\n        'style': 'overflow:hidden;line-height:0px'\n      };\n      return filled ? dom.create('span', args, '&#xFEFF;') : dom.create('span', args);\n    };\n    var getPersistentBookmark = function (selection, filled) {\n      var dom = selection.dom;\n      var rng = selection.getRng();\n      var id = dom.uniqueId();\n      var collapsed = selection.isCollapsed();\n      var element = selection.getNode();\n      var name = element.nodeName;\n      if (name === 'IMG') {\n        return {\n          name: name,\n          index: findIndex$2(dom, name, element)\n        };\n      }\n      var rng2 = normalizeTableCellSelection(rng.cloneRange());\n      if (!collapsed) {\n        rng2.collapse(false);\n        var endBookmarkNode = createBookmarkSpan(dom, id + '_end', filled);\n        rangeInsertNode(dom, rng2, endBookmarkNode);\n      }\n      rng = normalizeTableCellSelection(rng);\n      rng.collapse(true);\n      var startBookmarkNode = createBookmarkSpan(dom, id + '_start', filled);\n      rangeInsertNode(dom, rng, startBookmarkNode);\n      selection.moveToBookmark({\n        id: id,\n        keep: 1\n      });\n      return { id: id };\n    };\n    var getBookmark = function (selection, type, normalized) {\n      if (type === 2) {\n        return getOffsetBookmark(Zwsp.trim, normalized, selection);\n      } else if (type === 3) {\n        return getCaretBookmark(selection);\n      } else if (type) {\n        return getRangeBookmark(selection);\n      } else {\n        return getPersistentBookmark(selection, false);\n      }\n    };\n    var GetBookmark = {\n      getBookmark: getBookmark,\n      getUndoBookmark: curry(getOffsetBookmark, identity, true),\n      getPersistentBookmark: getPersistentBookmark\n    };\n\n    var TextWalker = function (startNode, rootNode, isBoundary) {\n      if (isBoundary === void 0) {\n        isBoundary = never;\n      }\n      var walker = new TreeWalker(startNode, rootNode);\n      var walk = function (direction) {\n        var next;\n        do {\n          next = walker[direction]();\n        } while (next && !NodeType.isText(next) && !isBoundary(next));\n        return Option.from(next).filter(NodeType.isText);\n      };\n      return {\n        current: function () {\n          return Option.from(walker.current()).filter(NodeType.isText);\n        },\n        next: function () {\n          return walk('next');\n        },\n        prev: function () {\n          return walk('prev');\n        },\n        prev2: function () {\n          return walk('prev2');\n        }\n      };\n    };\n\n    var TextSeeker = function (dom, isBoundary) {\n      var isBlockBoundary = isBoundary ? isBoundary : function (node) {\n        return dom.isBlock(node) || NodeType.isBr(node) || NodeType.isContentEditableFalse(node);\n      };\n      var walk = function (node, offset, walker, process) {\n        if (NodeType.isText(node)) {\n          var newOffset = process(node, offset, node.data);\n          if (newOffset !== -1) {\n            return Option.some({\n              container: node,\n              offset: newOffset\n            });\n          }\n        }\n        return walker().bind(function (next) {\n          return walk(next.container, next.offset, walker, process);\n        });\n      };\n      var backwards = function (node, offset, process, root) {\n        var walker = TextWalker(node, root, isBlockBoundary);\n        return walk(node, offset, function () {\n          return walker.prev().map(function (prev) {\n            return {\n              container: prev,\n              offset: prev.length\n            };\n          });\n        }, process).getOrNull();\n      };\n      var forwards = function (node, offset, process, root) {\n        var walker = TextWalker(node, root, isBlockBoundary);\n        return walk(node, offset, function () {\n          return walker.next().map(function (next) {\n            return {\n              container: next,\n              offset: 0\n            };\n          });\n        }, process).getOrNull();\n      };\n      return {\n        backwards: backwards,\n        forwards: forwards\n      };\n    };\n\n    var CARET_ID = '_mce_caret';\n    var isCaretNode = function (node) {\n      return NodeType.isElement(node) && node.id === CARET_ID;\n    };\n    var getParentCaretContainer = function (body, node) {\n      while (node && node !== body) {\n        if (node.id === CARET_ID) {\n          return node;\n        }\n        node = node.parentNode;\n      }\n      return null;\n    };\n\n    var isElement$4 = NodeType.isElement;\n    var isText$6 = NodeType.isText;\n    var removeNode = function (node) {\n      var parentNode = node.parentNode;\n      if (parentNode) {\n        parentNode.removeChild(node);\n      }\n    };\n    var getNodeValue = function (node) {\n      try {\n        return node.nodeValue;\n      } catch (ex) {\n        return '';\n      }\n    };\n    var setNodeValue = function (node, text) {\n      if (text.length === 0) {\n        removeNode(node);\n      } else {\n        node.nodeValue = text;\n      }\n    };\n    var trimCount = function (text) {\n      var trimmedText = Zwsp.trim(text);\n      return {\n        count: text.length - trimmedText.length,\n        text: trimmedText\n      };\n    };\n    var removeUnchanged = function (caretContainer, pos) {\n      remove$5(caretContainer);\n      return pos;\n    };\n    var removeTextAndReposition = function (caretContainer, pos) {\n      var before = trimCount(caretContainer.data.substr(0, pos.offset()));\n      var after = trimCount(caretContainer.data.substr(pos.offset()));\n      var text = before.text + after.text;\n      if (text.length > 0) {\n        setNodeValue(caretContainer, text);\n        return CaretPosition$1(caretContainer, pos.offset() - before.count);\n      } else {\n        return pos;\n      }\n    };\n    var removeElementAndReposition = function (caretContainer, pos) {\n      var parentNode = pos.container();\n      var newPosition = indexOf(from$1(parentNode.childNodes), caretContainer).map(function (index) {\n        return index < pos.offset() ? CaretPosition$1(parentNode, pos.offset() - 1) : pos;\n      }).getOr(pos);\n      remove$5(caretContainer);\n      return newPosition;\n    };\n    var removeTextCaretContainer = function (caretContainer, pos) {\n      return isText$6(caretContainer) && pos.container() === caretContainer ? removeTextAndReposition(caretContainer, pos) : removeUnchanged(caretContainer, pos);\n    };\n    var removeElementCaretContainer = function (caretContainer, pos) {\n      return pos.container() === caretContainer.parentNode ? removeElementAndReposition(caretContainer, pos) : removeUnchanged(caretContainer, pos);\n    };\n    var removeAndReposition = function (container, pos) {\n      return CaretPosition$1.isTextPosition(pos) ? removeTextCaretContainer(container, pos) : removeElementCaretContainer(container, pos);\n    };\n    var remove$5 = function (caretContainerNode) {\n      if (isElement$4(caretContainerNode) && isCaretContainer(caretContainerNode)) {\n        if (hasContent(caretContainerNode)) {\n          caretContainerNode.removeAttribute('data-mce-caret');\n        } else {\n          removeNode(caretContainerNode);\n        }\n      }\n      if (isText$6(caretContainerNode)) {\n        var text = Zwsp.trim(getNodeValue(caretContainerNode));\n        setNodeValue(caretContainerNode, text);\n      }\n    };\n    var CaretContainerRemove = {\n      removeAndReposition: removeAndReposition,\n      remove: remove$5\n    };\n\n    var DOM$1 = DOMUtils$1.DOM;\n    var getBodySetting = function (editor, name, defaultValue) {\n      var value = editor.getParam(name, defaultValue);\n      if (value.indexOf('=') !== -1) {\n        var bodyObj = editor.getParam(name, '', 'hash');\n        return bodyObj.hasOwnProperty(editor.id) ? bodyObj[editor.id] : defaultValue;\n      } else {\n        return value;\n      }\n    };\n    var getIframeAttrs = function (editor) {\n      return editor.getParam('iframe_attrs', {});\n    };\n    var getDocType = function (editor) {\n      return editor.getParam('doctype', '<!DOCTYPE html>');\n    };\n    var getDocumentBaseUrl = function (editor) {\n      return editor.getParam('document_base_url', '');\n    };\n    var getBodyId = function (editor) {\n      return getBodySetting(editor, 'body_id', 'tinymce');\n    };\n    var getBodyClass = function (editor) {\n      return getBodySetting(editor, 'body_class', '');\n    };\n    var getContentSecurityPolicy = function (editor) {\n      return editor.getParam('content_security_policy', '');\n    };\n    var shouldPutBrInPre = function (editor) {\n      return editor.getParam('br_in_pre', true);\n    };\n    var getForcedRootBlock = function (editor) {\n      if (editor.getParam('force_p_newlines', false)) {\n        return 'p';\n      }\n      var block = editor.getParam('forced_root_block', 'p');\n      if (block === false) {\n        return '';\n      } else if (block === true) {\n        return 'p';\n      } else {\n        return block;\n      }\n    };\n    var getForcedRootBlockAttrs = function (editor) {\n      return editor.getParam('forced_root_block_attrs', {});\n    };\n    var getBrNewLineSelector = function (editor) {\n      return editor.getParam('br_newline_selector', '.mce-toc h2,figcaption,caption');\n    };\n    var getNoNewLineSelector = function (editor) {\n      return editor.getParam('no_newline_selector', '');\n    };\n    var shouldKeepStyles = function (editor) {\n      return editor.getParam('keep_styles', true);\n    };\n    var shouldEndContainerOnEmptyBlock = function (editor) {\n      return editor.getParam('end_container_on_empty_block', false);\n    };\n    var getFontStyleValues = function (editor) {\n      return Tools.explode(editor.getParam('font_size_style_values', 'xx-small,x-small,small,medium,large,x-large,xx-large'));\n    };\n    var getFontSizeClasses = function (editor) {\n      return Tools.explode(editor.getParam('font_size_classes', ''));\n    };\n    var getImagesDataImgFilter = function (editor) {\n      return editor.getParam('images_dataimg_filter', constant(true), 'function');\n    };\n    var isAutomaticUploadsEnabled = function (editor) {\n      return editor.getParam('automatic_uploads', true, 'boolean');\n    };\n    var shouldReuseFileName = function (editor) {\n      return editor.getParam('images_reuse_filename', false, 'boolean');\n    };\n    var shouldReplaceBlobUris = function (editor) {\n      return editor.getParam('images_replace_blob_uris', true, 'boolean');\n    };\n    var getIconPackName = function (editor) {\n      return editor.getParam('icons', '', 'string');\n    };\n    var getIconsUrl = function (editor) {\n      return editor.getParam('icons_url', '', 'string');\n    };\n    var getImageUploadUrl = function (editor) {\n      return editor.getParam('images_upload_url', '', 'string');\n    };\n    var getImageUploadBasePath = function (editor) {\n      return editor.getParam('images_upload_base_path', '', 'string');\n    };\n    var getImagesUploadCredentials = function (editor) {\n      return editor.getParam('images_upload_credentials', false, 'boolean');\n    };\n    var getImagesUploadHandler = function (editor) {\n      return editor.getParam('images_upload_handler', null, 'function');\n    };\n    var shouldUseContentCssCors = function (editor) {\n      return editor.getParam('content_css_cors', false, 'boolean');\n    };\n    var getReferrerPolicy = function (editor) {\n      return editor.getParam('referrer_policy', '', 'string');\n    };\n    var getLanguageCode = function (editor) {\n      return editor.getParam('language', 'en', 'string');\n    };\n    var getLanguageUrl = function (editor) {\n      return editor.getParam('language_url', '', 'string');\n    };\n    var shouldIndentUseMargin = function (editor) {\n      return editor.getParam('indent_use_margin', false);\n    };\n    var getIndentation = function (editor) {\n      return editor.getParam('indentation', '40px', 'string');\n    };\n    var getContentCss = function (editor) {\n      var contentCss = editor.settings.content_css;\n      if (isString(contentCss)) {\n        return map(contentCss.split(','), trim);\n      } else if (isArray(contentCss)) {\n        return contentCss;\n      } else if (contentCss === false || editor.inline) {\n        return [];\n      } else {\n        return ['default'];\n      }\n    };\n    var getDirectionality = function (editor) {\n      return editor.getParam('directionality', I18n.isRtl() ? 'rtl' : undefined);\n    };\n    var getInlineBoundarySelector = function (editor) {\n      return editor.getParam('inline_boundaries_selector', 'a[href],code,.mce-annotation', 'string');\n    };\n    var getObjectResizing = function (editor) {\n      return editor.getParam('object_resizing');\n    };\n    var getResizeImgProportional = function (editor) {\n      return editor.getParam('resize_img_proportional', true, 'boolean');\n    };\n    var getPlaceholder = function (editor) {\n      return editor.getParam('placeholder', DOM$1.getAttrib(editor.getElement(), 'placeholder'), 'string');\n    };\n    var Settings = {\n      getIframeAttrs: getIframeAttrs,\n      getDocType: getDocType,\n      getDocumentBaseUrl: getDocumentBaseUrl,\n      getBodyId: getBodyId,\n      getBodyClass: getBodyClass,\n      getContentSecurityPolicy: getContentSecurityPolicy,\n      shouldPutBrInPre: shouldPutBrInPre,\n      getForcedRootBlock: getForcedRootBlock,\n      getForcedRootBlockAttrs: getForcedRootBlockAttrs,\n      getBrNewLineSelector: getBrNewLineSelector,\n      getNoNewLineSelector: getNoNewLineSelector,\n      shouldKeepStyles: shouldKeepStyles,\n      shouldEndContainerOnEmptyBlock: shouldEndContainerOnEmptyBlock,\n      getFontStyleValues: getFontStyleValues,\n      getFontSizeClasses: getFontSizeClasses,\n      getIconPackName: getIconPackName,\n      getIconsUrl: getIconsUrl,\n      getImagesDataImgFilter: getImagesDataImgFilter,\n      isAutomaticUploadsEnabled: isAutomaticUploadsEnabled,\n      shouldReuseFileName: shouldReuseFileName,\n      shouldReplaceBlobUris: shouldReplaceBlobUris,\n      getImageUploadUrl: getImageUploadUrl,\n      getImageUploadBasePath: getImageUploadBasePath,\n      getImagesUploadCredentials: getImagesUploadCredentials,\n      getImagesUploadHandler: getImagesUploadHandler,\n      shouldUseContentCssCors: shouldUseContentCssCors,\n      getReferrerPolicy: getReferrerPolicy,\n      getLanguageCode: getLanguageCode,\n      getLanguageUrl: getLanguageUrl,\n      shouldIndentUseMargin: shouldIndentUseMargin,\n      getIndentation: getIndentation,\n      getContentCss: getContentCss,\n      getDirectionality: getDirectionality,\n      getInlineBoundarySelector: getInlineBoundarySelector,\n      getObjectResizing: getObjectResizing,\n      getResizeImgProportional: getResizeImgProportional,\n      getPlaceholder: getPlaceholder\n    };\n\n    var browser$3 = detect$3().browser;\n    var isContentEditableFalse$3 = NodeType.isContentEditableFalse;\n    var isTableCell$1 = function (node) {\n      return NodeType.isElement(node) && /^(TD|TH)$/i.test(node.tagName);\n    };\n    var getAbsoluteClientRect = function (root, element, before) {\n      var clientRect = collapse(element.getBoundingClientRect(), before);\n      var docElm, scrollX, scrollY, margin, rootRect;\n      if (root.tagName === 'BODY') {\n        docElm = root.ownerDocument.documentElement;\n        scrollX = root.scrollLeft || docElm.scrollLeft;\n        scrollY = root.scrollTop || docElm.scrollTop;\n      } else {\n        rootRect = root.getBoundingClientRect();\n        scrollX = root.scrollLeft - rootRect.left;\n        scrollY = root.scrollTop - rootRect.top;\n      }\n      clientRect.left += scrollX;\n      clientRect.right += scrollX;\n      clientRect.top += scrollY;\n      clientRect.bottom += scrollY;\n      clientRect.width = 1;\n      margin = element.offsetWidth - element.clientWidth;\n      if (margin > 0) {\n        if (before) {\n          margin *= -1;\n        }\n        clientRect.left += margin;\n        clientRect.right += margin;\n      }\n      return clientRect;\n    };\n    var trimInlineCaretContainers = function (root) {\n      var contentEditableFalseNodes, node, sibling, i, data;\n      contentEditableFalseNodes = DomQuery('*[contentEditable=false]', root);\n      for (i = 0; i < contentEditableFalseNodes.length; i++) {\n        node = contentEditableFalseNodes[i];\n        sibling = node.previousSibling;\n        if (endsWithCaretContainer(sibling)) {\n          data = sibling.data;\n          if (data.length === 1) {\n            sibling.parentNode.removeChild(sibling);\n          } else {\n            sibling.deleteData(data.length - 1, 1);\n          }\n        }\n        sibling = node.nextSibling;\n        if (startsWithCaretContainer(sibling)) {\n          data = sibling.data;\n          if (data.length === 1) {\n            sibling.parentNode.removeChild(sibling);\n          } else {\n            sibling.deleteData(0, 1);\n          }\n        }\n      }\n    };\n    var FakeCaret = function (editor, root, isBlock, hasFocus) {\n      var lastVisualCaret = Cell(Option.none());\n      var cursorInterval, caretContainerNode;\n      var rootBlock = Settings.getForcedRootBlock(editor);\n      var caretBlock = rootBlock.length > 0 ? rootBlock : 'p';\n      var show = function (before, element) {\n        var clientRect, rng;\n        hide();\n        if (isTableCell$1(element)) {\n          return null;\n        }\n        if (isBlock(element)) {\n          caretContainerNode = insertBlock(caretBlock, element, before);\n          clientRect = getAbsoluteClientRect(root, element, before);\n          DomQuery(caretContainerNode).css('top', clientRect.top);\n          var caret = DomQuery('<div class=\"mce-visual-caret\" data-mce-bogus=\"all\"></div>').css(clientRect).appendTo(root)[0];\n          lastVisualCaret.set(Option.some({\n            caret: caret,\n            element: element,\n            before: before\n          }));\n          lastVisualCaret.get().each(function (caretState) {\n            if (before) {\n              DomQuery(caretState.caret).addClass('mce-visual-caret-before');\n            }\n          });\n          startBlink();\n          rng = element.ownerDocument.createRange();\n          rng.setStart(caretContainerNode, 0);\n          rng.setEnd(caretContainerNode, 0);\n        } else {\n          caretContainerNode = insertInline(element, before);\n          rng = element.ownerDocument.createRange();\n          if (isContentEditableFalse$3(caretContainerNode.nextSibling)) {\n            rng.setStart(caretContainerNode, 0);\n            rng.setEnd(caretContainerNode, 0);\n          } else {\n            rng.setStart(caretContainerNode, 1);\n            rng.setEnd(caretContainerNode, 1);\n          }\n          return rng;\n        }\n        return rng;\n      };\n      var hide = function () {\n        trimInlineCaretContainers(root);\n        if (caretContainerNode) {\n          CaretContainerRemove.remove(caretContainerNode);\n          caretContainerNode = null;\n        }\n        lastVisualCaret.get().each(function (caretState) {\n          DomQuery(caretState.caret).remove();\n          lastVisualCaret.set(Option.none());\n        });\n        Delay.clearInterval(cursorInterval);\n      };\n      var startBlink = function () {\n        cursorInterval = Delay.setInterval(function () {\n          if (hasFocus()) {\n            DomQuery('div.mce-visual-caret', root).toggleClass('mce-visual-caret-hidden');\n          } else {\n            DomQuery('div.mce-visual-caret', root).addClass('mce-visual-caret-hidden');\n          }\n        }, 500);\n      };\n      var reposition = function () {\n        lastVisualCaret.get().each(function (caretState) {\n          var clientRect = getAbsoluteClientRect(root, caretState.element, caretState.before);\n          DomQuery(caretState.caret).css(__assign({}, clientRect));\n        });\n      };\n      var destroy = function () {\n        return Delay.clearInterval(cursorInterval);\n      };\n      var getCss = function () {\n        return '.mce-visual-caret {' + 'position: absolute;' + 'background-color: black;' + 'background-color: currentcolor;' + '}' + '.mce-visual-caret-hidden {' + 'display: none;' + '}' + '*[data-mce-caret] {' + 'position: absolute;' + 'left: -1000px;' + 'right: auto;' + 'top: 0;' + 'margin: 0;' + 'padding: 0;' + '}';\n      };\n      return {\n        show: show,\n        hide: hide,\n        getCss: getCss,\n        reposition: reposition,\n        destroy: destroy\n      };\n    };\n    var isFakeCaretTableBrowser = function () {\n      return browser$3.isIE() || browser$3.isEdge() || browser$3.isFirefox();\n    };\n    var isFakeCaretTarget = function (node) {\n      return isContentEditableFalse$3(node) || NodeType.isTable(node) && isFakeCaretTableBrowser();\n    };\n\n    var isContentEditableFalse$4 = NodeType.isContentEditableFalse;\n    var isBlockLike = NodeType.matchStyleValues('display', 'block table table-cell table-caption list-item');\n    var isCaretContainer$2 = isCaretContainer;\n    var isCaretContainerBlock$1 = isCaretContainerBlock;\n    var isElement$5 = NodeType.isElement;\n    var isCaretCandidate$2 = isCaretCandidate;\n    var isForwards = function (direction) {\n      return direction > 0;\n    };\n    var isBackwards = function (direction) {\n      return direction < 0;\n    };\n    var skipCaretContainers = function (walk, shallow) {\n      var node;\n      while (node = walk(shallow)) {\n        if (!isCaretContainerBlock$1(node)) {\n          return node;\n        }\n      }\n      return null;\n    };\n    var findNode = function (node, direction, predicateFn, rootNode, shallow) {\n      var walker = new TreeWalker(node, rootNode);\n      if (isBackwards(direction)) {\n        if (isContentEditableFalse$4(node) || isCaretContainerBlock$1(node)) {\n          node = skipCaretContainers(walker.prev, true);\n          if (predicateFn(node)) {\n            return node;\n          }\n        }\n        while (node = skipCaretContainers(walker.prev, shallow)) {\n          if (predicateFn(node)) {\n            return node;\n          }\n        }\n      }\n      if (isForwards(direction)) {\n        if (isContentEditableFalse$4(node) || isCaretContainerBlock$1(node)) {\n          node = skipCaretContainers(walker.next, true);\n          if (predicateFn(node)) {\n            return node;\n          }\n        }\n        while (node = skipCaretContainers(walker.next, shallow)) {\n          if (predicateFn(node)) {\n            return node;\n          }\n        }\n      }\n      return null;\n    };\n    var getParentBlock = function (node, rootNode) {\n      while (node && node !== rootNode) {\n        if (isBlockLike(node)) {\n          return node;\n        }\n        node = node.parentNode;\n      }\n      return null;\n    };\n    var isInSameBlock = function (caretPosition1, caretPosition2, rootNode) {\n      return getParentBlock(caretPosition1.container(), rootNode) === getParentBlock(caretPosition2.container(), rootNode);\n    };\n    var getChildNodeAtRelativeOffset = function (relativeOffset, caretPosition) {\n      var container, offset;\n      if (!caretPosition) {\n        return null;\n      }\n      container = caretPosition.container();\n      offset = caretPosition.offset();\n      if (!isElement$5(container)) {\n        return null;\n      }\n      return container.childNodes[offset + relativeOffset];\n    };\n    var beforeAfter = function (before, node) {\n      var range = node.ownerDocument.createRange();\n      if (before) {\n        range.setStartBefore(node);\n        range.setEndBefore(node);\n      } else {\n        range.setStartAfter(node);\n        range.setEndAfter(node);\n      }\n      return range;\n    };\n    var isNodesInSameBlock = function (root, node1, node2) {\n      return getParentBlock(node1, root) === getParentBlock(node2, root);\n    };\n    var lean = function (left, root, node) {\n      var sibling, siblingName;\n      if (left) {\n        siblingName = 'previousSibling';\n      } else {\n        siblingName = 'nextSibling';\n      }\n      while (node && node !== root) {\n        sibling = node[siblingName];\n        if (isCaretContainer$2(sibling)) {\n          sibling = sibling[siblingName];\n        }\n        if (isContentEditableFalse$4(sibling)) {\n          if (isNodesInSameBlock(root, sibling, node)) {\n            return sibling;\n          }\n          break;\n        }\n        if (isCaretCandidate$2(sibling)) {\n          break;\n        }\n        node = node.parentNode;\n      }\n      return null;\n    };\n    var before$2 = curry(beforeAfter, true);\n    var after$1 = curry(beforeAfter, false);\n    var normalizeRange = function (direction, root, range) {\n      var node, container, offset, location;\n      var leanLeft = curry(lean, true, root);\n      var leanRight = curry(lean, false, root);\n      container = range.startContainer;\n      offset = range.startOffset;\n      if (isCaretContainerBlock(container)) {\n        if (!isElement$5(container)) {\n          container = container.parentNode;\n        }\n        location = container.getAttribute('data-mce-caret');\n        if (location === 'before') {\n          node = container.nextSibling;\n          if (isFakeCaretTarget(node)) {\n            return before$2(node);\n          }\n        }\n        if (location === 'after') {\n          node = container.previousSibling;\n          if (isFakeCaretTarget(node)) {\n            return after$1(node);\n          }\n        }\n      }\n      if (!range.collapsed) {\n        return range;\n      }\n      if (NodeType.isText(container)) {\n        if (isCaretContainer$2(container)) {\n          if (direction === 1) {\n            node = leanRight(container);\n            if (node) {\n              return before$2(node);\n            }\n            node = leanLeft(container);\n            if (node) {\n              return after$1(node);\n            }\n          }\n          if (direction === -1) {\n            node = leanLeft(container);\n            if (node) {\n              return after$1(node);\n            }\n            node = leanRight(container);\n            if (node) {\n              return before$2(node);\n            }\n          }\n          return range;\n        }\n        if (endsWithCaretContainer(container) && offset >= container.data.length - 1) {\n          if (direction === 1) {\n            node = leanRight(container);\n            if (node) {\n              return before$2(node);\n            }\n          }\n          return range;\n        }\n        if (startsWithCaretContainer(container) && offset <= 1) {\n          if (direction === -1) {\n            node = leanLeft(container);\n            if (node) {\n              return after$1(node);\n            }\n          }\n          return range;\n        }\n        if (offset === container.data.length) {\n          node = leanRight(container);\n          if (node) {\n            return before$2(node);\n          }\n          return range;\n        }\n        if (offset === 0) {\n          node = leanLeft(container);\n          if (node) {\n            return after$1(node);\n          }\n          return range;\n        }\n      }\n      return range;\n    };\n    var getRelativeCefElm = function (forward, caretPosition) {\n      return Option.from(getChildNodeAtRelativeOffset(forward ? 0 : -1, caretPosition)).filter(isContentEditableFalse$4);\n    };\n    var getNormalizedRangeEndPoint = function (direction, root, range) {\n      var normalizedRange = normalizeRange(direction, root, range);\n      if (direction === -1) {\n        return CaretPosition.fromRangeStart(normalizedRange);\n      }\n      return CaretPosition.fromRangeEnd(normalizedRange);\n    };\n    var getElementFromPosition = function (pos) {\n      return Option.from(pos.getNode()).map(Element.fromDom);\n    };\n    var getElementFromPrevPosition = function (pos) {\n      return Option.from(pos.getNode(true)).map(Element.fromDom);\n    };\n    var getVisualCaretPosition = function (walkFn, caretPosition) {\n      while (caretPosition = walkFn(caretPosition)) {\n        if (caretPosition.isVisible()) {\n          return caretPosition;\n        }\n      }\n      return caretPosition;\n    };\n    var isMoveInsideSameBlock = function (from, to) {\n      var inSameBlock = isInSameBlock(from, to);\n      if (!inSameBlock && NodeType.isBr(from.getNode())) {\n        return true;\n      }\n      return inSameBlock;\n    };\n\n    var HDirection;\n    (function (HDirection) {\n      HDirection[HDirection['Backwards'] = -1] = 'Backwards';\n      HDirection[HDirection['Forwards'] = 1] = 'Forwards';\n    }(HDirection || (HDirection = {})));\n    var isContentEditableFalse$5 = NodeType.isContentEditableFalse;\n    var isText$7 = NodeType.isText;\n    var isElement$6 = NodeType.isElement;\n    var isBr$4 = NodeType.isBr;\n    var isCaretCandidate$3 = isCaretCandidate;\n    var isAtomic$1 = isAtomic;\n    var isEditableCaretCandidate$1 = isEditableCaretCandidate;\n    var getParents = function (node, root) {\n      var parents = [];\n      while (node && node !== root) {\n        parents.push(node);\n        node = node.parentNode;\n      }\n      return parents;\n    };\n    var nodeAtIndex = function (container, offset) {\n      if (container.hasChildNodes() && offset < container.childNodes.length) {\n        return container.childNodes[offset];\n      }\n      return null;\n    };\n    var getCaretCandidatePosition = function (direction, node) {\n      if (isForwards(direction)) {\n        if (isCaretCandidate$3(node.previousSibling) && !isText$7(node.previousSibling)) {\n          return CaretPosition$1.before(node);\n        }\n        if (isText$7(node)) {\n          return CaretPosition$1(node, 0);\n        }\n      }\n      if (isBackwards(direction)) {\n        if (isCaretCandidate$3(node.nextSibling) && !isText$7(node.nextSibling)) {\n          return CaretPosition$1.after(node);\n        }\n        if (isText$7(node)) {\n          return CaretPosition$1(node, node.data.length);\n        }\n      }\n      if (isBackwards(direction)) {\n        if (isBr$4(node)) {\n          return CaretPosition$1.before(node);\n        }\n        return CaretPosition$1.after(node);\n      }\n      return CaretPosition$1.before(node);\n    };\n    var moveForwardFromBr = function (root, nextNode) {\n      var nextSibling = nextNode.nextSibling;\n      if (nextSibling && isCaretCandidate$3(nextSibling)) {\n        if (isText$7(nextSibling)) {\n          return CaretPosition$1(nextSibling, 0);\n        } else {\n          return CaretPosition$1.before(nextSibling);\n        }\n      } else {\n        return findCaretPosition(HDirection.Forwards, CaretPosition$1.after(nextNode), root);\n      }\n    };\n    var findCaretPosition = function (direction, startPos, root) {\n      var node, nextNode, innerNode;\n      var rootContentEditableFalseElm, caretPosition;\n      if (!isElement$6(root) || !startPos) {\n        return null;\n      }\n      if (startPos.isEqual(CaretPosition$1.after(root)) && root.lastChild) {\n        caretPosition = CaretPosition$1.after(root.lastChild);\n        if (isBackwards(direction) && isCaretCandidate$3(root.lastChild) && isElement$6(root.lastChild)) {\n          return isBr$4(root.lastChild) ? CaretPosition$1.before(root.lastChild) : caretPosition;\n        }\n      } else {\n        caretPosition = startPos;\n      }\n      var container = caretPosition.container();\n      var offset = caretPosition.offset();\n      if (isText$7(container)) {\n        if (isBackwards(direction) && offset > 0) {\n          return CaretPosition$1(container, --offset);\n        }\n        if (isForwards(direction) && offset < container.length) {\n          return CaretPosition$1(container, ++offset);\n        }\n        node = container;\n      } else {\n        if (isBackwards(direction) && offset > 0) {\n          nextNode = nodeAtIndex(container, offset - 1);\n          if (isCaretCandidate$3(nextNode)) {\n            if (!isAtomic$1(nextNode)) {\n              innerNode = findNode(nextNode, direction, isEditableCaretCandidate$1, nextNode);\n              if (innerNode) {\n                if (isText$7(innerNode)) {\n                  return CaretPosition$1(innerNode, innerNode.data.length);\n                }\n                return CaretPosition$1.after(innerNode);\n              }\n            }\n            if (isText$7(nextNode)) {\n              return CaretPosition$1(nextNode, nextNode.data.length);\n            }\n            return CaretPosition$1.before(nextNode);\n          }\n        }\n        if (isForwards(direction) && offset < container.childNodes.length) {\n          nextNode = nodeAtIndex(container, offset);\n          if (isCaretCandidate$3(nextNode)) {\n            if (isBr$4(nextNode)) {\n              return moveForwardFromBr(root, nextNode);\n            }\n            if (!isAtomic$1(nextNode)) {\n              innerNode = findNode(nextNode, direction, isEditableCaretCandidate$1, nextNode);\n              if (innerNode) {\n                if (isText$7(innerNode)) {\n                  return CaretPosition$1(innerNode, 0);\n                }\n                return CaretPosition$1.before(innerNode);\n              }\n            }\n            if (isText$7(nextNode)) {\n              return CaretPosition$1(nextNode, 0);\n            }\n            return CaretPosition$1.after(nextNode);\n          }\n        }\n        node = nextNode ? nextNode : caretPosition.getNode();\n      }\n      if (isForwards(direction) && caretPosition.isAtEnd() || isBackwards(direction) && caretPosition.isAtStart()) {\n        node = findNode(node, direction, constant(true), root, true);\n        if (isEditableCaretCandidate$1(node, root)) {\n          return getCaretCandidatePosition(direction, node);\n        }\n      }\n      nextNode = findNode(node, direction, isEditableCaretCandidate$1, root);\n      rootContentEditableFalseElm = ArrUtils.last(filter(getParents(container, root), isContentEditableFalse$5));\n      if (rootContentEditableFalseElm && (!nextNode || !rootContentEditableFalseElm.contains(nextNode))) {\n        if (isForwards(direction)) {\n          caretPosition = CaretPosition$1.after(rootContentEditableFalseElm);\n        } else {\n          caretPosition = CaretPosition$1.before(rootContentEditableFalseElm);\n        }\n        return caretPosition;\n      }\n      if (nextNode) {\n        return getCaretCandidatePosition(direction, nextNode);\n      }\n      return null;\n    };\n    var CaretWalker = function (root) {\n      return {\n        next: function (caretPosition) {\n          return findCaretPosition(HDirection.Forwards, caretPosition, root);\n        },\n        prev: function (caretPosition) {\n          return findCaretPosition(HDirection.Backwards, caretPosition, root);\n        }\n      };\n    };\n\n    var walkToPositionIn = function (forward, root, start) {\n      var position = forward ? CaretPosition$1.before(start) : CaretPosition$1.after(start);\n      return fromPosition(forward, root, position);\n    };\n    var afterElement = function (node) {\n      return NodeType.isBr(node) ? CaretPosition$1.before(node) : CaretPosition$1.after(node);\n    };\n    var isBeforeOrStart = function (position) {\n      if (CaretPosition$1.isTextPosition(position)) {\n        return position.offset() === 0;\n      } else {\n        return isCaretCandidate(position.getNode());\n      }\n    };\n    var isAfterOrEnd = function (position) {\n      if (CaretPosition$1.isTextPosition(position)) {\n        var container = position.container();\n        return position.offset() === container.data.length;\n      } else {\n        return isCaretCandidate(position.getNode(true));\n      }\n    };\n    var isBeforeAfterSameElement = function (from, to) {\n      return !CaretPosition$1.isTextPosition(from) && !CaretPosition$1.isTextPosition(to) && from.getNode() === to.getNode(true);\n    };\n    var isAtBr = function (position) {\n      return !CaretPosition$1.isTextPosition(position) && NodeType.isBr(position.getNode());\n    };\n    var shouldSkipPosition = function (forward, from, to) {\n      if (forward) {\n        return !isBeforeAfterSameElement(from, to) && !isAtBr(from) && isAfterOrEnd(from) && isBeforeOrStart(to);\n      } else {\n        return !isBeforeAfterSameElement(to, from) && isBeforeOrStart(from) && isAfterOrEnd(to);\n      }\n    };\n    var fromPosition = function (forward, root, pos) {\n      var walker = CaretWalker(root);\n      return Option.from(forward ? walker.next(pos) : walker.prev(pos));\n    };\n    var navigate = function (forward, root, from) {\n      return fromPosition(forward, root, from).bind(function (to) {\n        if (isInSameBlock(from, to, root) && shouldSkipPosition(forward, from, to)) {\n          return fromPosition(forward, root, to);\n        } else {\n          return Option.some(to);\n        }\n      });\n    };\n    var navigateIgnore = function (forward, root, from, ignoreFilter) {\n      return navigate(forward, root, from).bind(function (pos) {\n        return ignoreFilter(pos) ? navigateIgnore(forward, root, pos, ignoreFilter) : Option.some(pos);\n      });\n    };\n    var positionIn = function (forward, element) {\n      var startNode = forward ? element.firstChild : element.lastChild;\n      if (NodeType.isText(startNode)) {\n        return Option.some(CaretPosition$1(startNode, forward ? 0 : startNode.data.length));\n      } else if (startNode) {\n        if (isCaretCandidate(startNode)) {\n          return Option.some(forward ? CaretPosition$1.before(startNode) : afterElement(startNode));\n        } else {\n          return walkToPositionIn(forward, element, startNode);\n        }\n      } else {\n        return Option.none();\n      }\n    };\n    var nextPosition = curry(fromPosition, true);\n    var prevPosition = curry(fromPosition, false);\n    var CaretFinder = {\n      fromPosition: fromPosition,\n      nextPosition: nextPosition,\n      prevPosition: prevPosition,\n      navigate: navigate,\n      navigateIgnore: navigateIgnore,\n      positionIn: positionIn,\n      firstPositionIn: curry(positionIn, true),\n      lastPositionIn: curry(positionIn, false)\n    };\n\n    var isStringPathBookmark = function (bookmark) {\n      return typeof bookmark.start === 'string';\n    };\n    var isRangeBookmark = function (bookmark) {\n      return bookmark.hasOwnProperty('rng');\n    };\n    var isIdBookmark = function (bookmark) {\n      return bookmark.hasOwnProperty('id');\n    };\n    var isIndexBookmark = function (bookmark) {\n      return bookmark.hasOwnProperty('name');\n    };\n    var isPathBookmark = function (bookmark) {\n      return Tools.isArray(bookmark.start);\n    };\n\n    var addBogus = function (dom, node) {\n      if (NodeType.isElement(node) && dom.isBlock(node) && !node.innerHTML && !Env.ie) {\n        node.innerHTML = '<br data-mce-bogus=\"1\" />';\n      }\n      return node;\n    };\n    var resolveCaretPositionBookmark = function (dom, bookmark) {\n      var rng, pos;\n      rng = dom.createRng();\n      pos = resolve$1(dom.getRoot(), bookmark.start);\n      rng.setStart(pos.container(), pos.offset());\n      pos = resolve$1(dom.getRoot(), bookmark.end);\n      rng.setEnd(pos.container(), pos.offset());\n      return rng;\n    };\n    var insertZwsp = function (node, rng) {\n      var textNode = node.ownerDocument.createTextNode(Zwsp.ZWSP);\n      node.appendChild(textNode);\n      rng.setStart(textNode, 0);\n      rng.setEnd(textNode, 0);\n    };\n    var isEmpty = function (node) {\n      return node.hasChildNodes() === false;\n    };\n    var tryFindRangePosition = function (node, rng) {\n      return CaretFinder.lastPositionIn(node).fold(function () {\n        return false;\n      }, function (pos) {\n        rng.setStart(pos.container(), pos.offset());\n        rng.setEnd(pos.container(), pos.offset());\n        return true;\n      });\n    };\n    var padEmptyCaretContainer = function (root, node, rng) {\n      if (isEmpty(node) && getParentCaretContainer(root, node)) {\n        insertZwsp(node, rng);\n        return true;\n      } else {\n        return false;\n      }\n    };\n    var setEndPoint = function (dom, start, bookmark, rng) {\n      var point = bookmark[start ? 'start' : 'end'];\n      var i, node, offset, children;\n      var root = dom.getRoot();\n      if (point) {\n        offset = point[0];\n        for (node = root, i = point.length - 1; i >= 1; i--) {\n          children = node.childNodes;\n          if (padEmptyCaretContainer(root, node, rng)) {\n            return true;\n          }\n          if (point[i] > children.length - 1) {\n            if (padEmptyCaretContainer(root, node, rng)) {\n              return true;\n            }\n            return tryFindRangePosition(node, rng);\n          }\n          node = children[point[i]];\n        }\n        if (node.nodeType === 3) {\n          offset = Math.min(point[0], node.nodeValue.length);\n        }\n        if (node.nodeType === 1) {\n          offset = Math.min(point[0], node.childNodes.length);\n        }\n        if (start) {\n          rng.setStart(node, offset);\n        } else {\n          rng.setEnd(node, offset);\n        }\n      }\n      return true;\n    };\n    var isValidTextNode = function (node) {\n      return NodeType.isText(node) && node.data.length > 0;\n    };\n    var restoreEndPoint = function (dom, suffix, bookmark) {\n      var marker = dom.get(bookmark.id + '_' + suffix), node, idx, next, prev;\n      var keep = bookmark.keep;\n      var container, offset;\n      if (marker) {\n        node = marker.parentNode;\n        if (suffix === 'start') {\n          if (!keep) {\n            idx = dom.nodeIndex(marker);\n          } else {\n            if (marker.hasChildNodes()) {\n              node = marker.firstChild;\n              idx = 1;\n            } else if (isValidTextNode(marker.nextSibling)) {\n              node = marker.nextSibling;\n              idx = 0;\n            } else if (isValidTextNode(marker.previousSibling)) {\n              node = marker.previousSibling;\n              idx = marker.previousSibling.data.length;\n            } else {\n              node = marker.parentNode;\n              idx = dom.nodeIndex(marker) + 1;\n            }\n          }\n          container = node;\n          offset = idx;\n        } else {\n          if (!keep) {\n            idx = dom.nodeIndex(marker);\n          } else {\n            if (marker.hasChildNodes()) {\n              node = marker.firstChild;\n              idx = 1;\n            } else if (isValidTextNode(marker.previousSibling)) {\n              node = marker.previousSibling;\n              idx = marker.previousSibling.data.length;\n            } else {\n              node = marker.parentNode;\n              idx = dom.nodeIndex(marker);\n            }\n          }\n          container = node;\n          offset = idx;\n        }\n        if (!keep) {\n          prev = marker.previousSibling;\n          next = marker.nextSibling;\n          Tools.each(Tools.grep(marker.childNodes), function (node) {\n            if (NodeType.isText(node)) {\n              node.nodeValue = node.nodeValue.replace(/\\uFEFF/g, '');\n            }\n          });\n          while (marker = dom.get(bookmark.id + '_' + suffix)) {\n            dom.remove(marker, true);\n          }\n          if (prev && next && prev.nodeType === next.nodeType && NodeType.isText(prev) && !Env.opera) {\n            idx = prev.nodeValue.length;\n            prev.appendData(next.nodeValue);\n            dom.remove(next);\n            if (suffix === 'start') {\n              container = prev;\n              offset = idx;\n            } else {\n              container = prev;\n              offset = idx;\n            }\n          }\n        }\n        return Option.some(CaretPosition$1(container, offset));\n      } else {\n        return Option.none();\n      }\n    };\n    var resolvePaths = function (dom, bookmark) {\n      var rng = dom.createRng();\n      if (setEndPoint(dom, true, bookmark, rng) && setEndPoint(dom, false, bookmark, rng)) {\n        return Option.some(rng);\n      } else {\n        return Option.none();\n      }\n    };\n    var resolveId = function (dom, bookmark) {\n      var startPos = restoreEndPoint(dom, 'start', bookmark);\n      var endPos = restoreEndPoint(dom, 'end', bookmark);\n      return lift2(startPos, endPos.or(startPos), function (spos, epos) {\n        var rng = dom.createRng();\n        rng.setStart(addBogus(dom, spos.container()), spos.offset());\n        rng.setEnd(addBogus(dom, epos.container()), epos.offset());\n        return rng;\n      });\n    };\n    var resolveIndex$1 = function (dom, bookmark) {\n      return Option.from(dom.select(bookmark.name)[bookmark.index]).map(function (elm) {\n        var rng = dom.createRng();\n        rng.selectNode(elm);\n        return rng;\n      });\n    };\n    var resolve$2 = function (selection, bookmark) {\n      var dom = selection.dom;\n      if (bookmark) {\n        if (isPathBookmark(bookmark)) {\n          return resolvePaths(dom, bookmark);\n        } else if (isStringPathBookmark(bookmark)) {\n          return Option.some(resolveCaretPositionBookmark(dom, bookmark));\n        } else if (isIdBookmark(bookmark)) {\n          return resolveId(dom, bookmark);\n        } else if (isIndexBookmark(bookmark)) {\n          return resolveIndex$1(dom, bookmark);\n        } else if (isRangeBookmark(bookmark)) {\n          return Option.some(bookmark.rng);\n        }\n      }\n      return Option.none();\n    };\n    var ResolveBookmark = { resolve: resolve$2 };\n\n    var getBookmark$1 = function (selection, type, normalized) {\n      return GetBookmark.getBookmark(selection, type, normalized);\n    };\n    var moveToBookmark = function (selection, bookmark) {\n      ResolveBookmark.resolve(selection, bookmark).each(function (rng) {\n        selection.setRng(rng);\n      });\n    };\n    var isBookmarkNode$1 = function (node) {\n      return NodeType.isElement(node) && node.tagName === 'SPAN' && node.getAttribute('data-mce-type') === 'bookmark';\n    };\n    var Bookmarks = {\n      getBookmark: getBookmark$1,\n      moveToBookmark: moveToBookmark,\n      isBookmarkNode: isBookmarkNode$1\n    };\n\n    var is$2 = function (expected) {\n      return function (actual) {\n        return expected === actual;\n      };\n    };\n    var isNbsp = is$2(nbsp);\n    var isWhiteSpace$1 = function (chr) {\n      return chr !== '' && ' \\f\\n\\r\\t\\x0B'.indexOf(chr) !== -1;\n    };\n    var isContent = function (chr) {\n      return !isWhiteSpace$1(chr) && !isNbsp(chr);\n    };\n\n    var isNode = function (node) {\n      return !!node.nodeType;\n    };\n    var isInlineBlock = function (node) {\n      return node && /^(IMG)$/.test(node.nodeName);\n    };\n    var moveStart = function (dom, selection, rng) {\n      var offset = rng.startOffset;\n      var container = rng.startContainer, walker, node, nodes;\n      if (rng.startContainer === rng.endContainer) {\n        if (isInlineBlock(rng.startContainer.childNodes[rng.startOffset])) {\n          return;\n        }\n      }\n      if (container.nodeType === 1) {\n        nodes = container.childNodes;\n        if (offset < nodes.length) {\n          container = nodes[offset];\n          walker = new TreeWalker(container, dom.getParent(container, dom.isBlock));\n        } else {\n          container = nodes[nodes.length - 1];\n          walker = new TreeWalker(container, dom.getParent(container, dom.isBlock));\n          walker.next(true);\n        }\n        for (node = walker.current(); node; node = walker.next()) {\n          if (node.nodeType === 3 && !isWhiteSpaceNode(node)) {\n            rng.setStart(node, 0);\n            selection.setRng(rng);\n            return;\n          }\n        }\n      }\n    };\n    var getNonWhiteSpaceSibling = function (node, next, inc) {\n      if (node) {\n        var nextName = next ? 'nextSibling' : 'previousSibling';\n        for (node = inc ? node : node[nextName]; node; node = node[nextName]) {\n          if (node.nodeType === 1 || !isWhiteSpaceNode(node)) {\n            return node;\n          }\n        }\n      }\n    };\n    var isTextBlock$1 = function (editor, name) {\n      if (isNode(name)) {\n        name = name.nodeName;\n      }\n      return !!editor.schema.getTextBlockElements()[name.toLowerCase()];\n    };\n    var isValid = function (ed, parent, child) {\n      return ed.schema.isValidChild(parent, child);\n    };\n    var isWhiteSpaceNode = function (node) {\n      return node && NodeType.isText(node) && /^([\\t \\r\\n]+|)$/.test(node.nodeValue);\n    };\n    var isEmptyTextNode = function (node) {\n      return node && NodeType.isText(node) && node.length === 0;\n    };\n    var replaceVars = function (value, vars) {\n      if (typeof value !== 'string') {\n        value = value(vars);\n      } else if (vars) {\n        value = value.replace(/%(\\w+)/g, function (str, name) {\n          return vars[name] || str;\n        });\n      }\n      return value;\n    };\n    var isEq = function (str1, str2) {\n      str1 = str1 || '';\n      str2 = str2 || '';\n      str1 = '' + (str1.nodeName || str1);\n      str2 = '' + (str2.nodeName || str2);\n      return str1.toLowerCase() === str2.toLowerCase();\n    };\n    var normalizeStyleValue = function (dom, value, name) {\n      if (name === 'color' || name === 'backgroundColor') {\n        value = dom.toHex(value);\n      }\n      if (name === 'fontWeight' && value === 700) {\n        value = 'bold';\n      }\n      if (name === 'fontFamily') {\n        value = value.replace(/[\\'\\\"]/g, '').replace(/,\\s+/g, ',');\n      }\n      return '' + value;\n    };\n    var getStyle = function (dom, node, name) {\n      return normalizeStyleValue(dom, dom.getStyle(node, name), name);\n    };\n    var getTextDecoration = function (dom, node) {\n      var decoration;\n      dom.getParent(node, function (n) {\n        decoration = dom.getStyle(n, 'text-decoration');\n        return decoration && decoration !== 'none';\n      });\n      return decoration;\n    };\n    var getParents$1 = function (dom, node, selector) {\n      return dom.getParents(node, selector, dom.getRoot());\n    };\n\n    var isBookmarkNode$2 = Bookmarks.isBookmarkNode;\n    var getParents$2 = getParents$1, isWhiteSpaceNode$1 = isWhiteSpaceNode, isTextBlock$2 = isTextBlock$1;\n    var isBogusBr = function (node) {\n      return node.nodeName === 'BR' && node.getAttribute('data-mce-bogus') && !node.nextSibling;\n    };\n    var findParentContentEditable = function (dom, node) {\n      var parent = node;\n      while (parent) {\n        if (NodeType.isElement(parent) && dom.getContentEditable(parent)) {\n          return dom.getContentEditable(parent) === 'false' ? parent : node;\n        }\n        parent = parent.parentNode;\n      }\n      return node;\n    };\n    var walkText = function (start, node, offset, predicate) {\n      var str = node.data;\n      for (var i = offset; start ? i >= 0 : i < str.length; start ? i-- : i++) {\n        if (predicate(str.charAt(i))) {\n          return start ? i + 1 : i;\n        }\n      }\n      return -1;\n    };\n    var findSpace = function (start, node, offset) {\n      return walkText(start, node, offset, function (c) {\n        return isNbsp(c) || isWhiteSpace$1(c);\n      });\n    };\n    var findContent = function (start, node, offset) {\n      return walkText(start, node, offset, isContent);\n    };\n    var findWordEndPoint = function (dom, body, container, offset, start, includeTrailingSpaces) {\n      var lastTextNode;\n      var rootNode = dom.getParent(container, dom.isBlock) || body;\n      var walk = function (container, offset, pred) {\n        var textSeeker = TextSeeker(dom);\n        var walker = start ? textSeeker.backwards : textSeeker.forwards;\n        return Option.from(walker(container, offset, function (text, textOffset) {\n          if (isBookmarkNode$2(text.parentNode)) {\n            return -1;\n          } else {\n            lastTextNode = text;\n            return pred(start, text, textOffset);\n          }\n        }, rootNode));\n      };\n      var spaceResult = walk(container, offset, findSpace);\n      return spaceResult.bind(function (result) {\n        return includeTrailingSpaces ? walk(result.container, result.offset + (start ? -1 : 0), findContent) : Option.some(result);\n      }).orThunk(function () {\n        return lastTextNode ? Option.some({\n          container: lastTextNode,\n          offset: start ? 0 : lastTextNode.length\n        }) : Option.none();\n      });\n    };\n    var findSelectorEndPoint = function (dom, format, rng, container, siblingName) {\n      if (NodeType.isText(container) && container.nodeValue.length === 0 && container[siblingName]) {\n        container = container[siblingName];\n      }\n      var parents = getParents$2(dom, container);\n      for (var i = 0; i < parents.length; i++) {\n        for (var y = 0; y < format.length; y++) {\n          var curFormat = format[y];\n          if ('collapsed' in curFormat && curFormat.collapsed !== rng.collapsed) {\n            continue;\n          }\n          if (dom.is(parents[i], curFormat.selector)) {\n            return parents[i];\n          }\n        }\n      }\n      return container;\n    };\n    var findBlockEndPoint = function (editor, format, container, siblingName) {\n      var node;\n      var dom = editor.dom;\n      var root = dom.getRoot();\n      if (!format[0].wrapper) {\n        node = dom.getParent(container, format[0].block, root);\n      }\n      if (!node) {\n        var scopeRoot = dom.getParent(container, 'LI,TD,TH');\n        node = dom.getParent(NodeType.isText(container) ? container.parentNode : container, function (node) {\n          return node !== root && isTextBlock$2(editor, node);\n        }, scopeRoot);\n      }\n      if (node && format[0].wrapper) {\n        node = getParents$2(dom, node, 'ul,ol').reverse()[0] || node;\n      }\n      if (!node) {\n        node = container;\n        while (node[siblingName] && !dom.isBlock(node[siblingName])) {\n          node = node[siblingName];\n          if (isEq(node, 'br')) {\n            break;\n          }\n        }\n      }\n      return node || container;\n    };\n    var findParentContainer = function (dom, format, startContainer, startOffset, endContainer, endOffset, start) {\n      var container, parent, sibling, siblingName, root;\n      container = parent = start ? startContainer : endContainer;\n      siblingName = start ? 'previousSibling' : 'nextSibling';\n      root = dom.getRoot();\n      if (NodeType.isText(container) && !isWhiteSpaceNode$1(container)) {\n        if (start ? startOffset > 0 : endOffset < container.nodeValue.length) {\n          return container;\n        }\n      }\n      while (true) {\n        if (!format[0].block_expand && dom.isBlock(parent)) {\n          return parent;\n        }\n        for (sibling = parent[siblingName]; sibling; sibling = sibling[siblingName]) {\n          if (!isBookmarkNode$2(sibling) && !isWhiteSpaceNode$1(sibling) && !isBogusBr(sibling)) {\n            return parent;\n          }\n        }\n        if (parent === root || parent.parentNode === root) {\n          container = parent;\n          break;\n        }\n        parent = parent.parentNode;\n      }\n      return container;\n    };\n    var expandRng = function (editor, rng, format, includeTrailingSpace) {\n      if (includeTrailingSpace === void 0) {\n        includeTrailingSpace = false;\n      }\n      var startContainer = rng.startContainer, startOffset = rng.startOffset, endContainer = rng.endContainer, endOffset = rng.endOffset;\n      var dom = editor.dom;\n      if (NodeType.isElement(startContainer) && startContainer.hasChildNodes()) {\n        startContainer = getNode(startContainer, startOffset);\n        if (NodeType.isText(startContainer)) {\n          startOffset = 0;\n        }\n      }\n      if (NodeType.isElement(endContainer) && endContainer.hasChildNodes()) {\n        endContainer = getNode(endContainer, rng.collapsed ? endOffset : endOffset - 1);\n        if (NodeType.isText(endContainer)) {\n          endOffset = endContainer.nodeValue.length;\n        }\n      }\n      startContainer = findParentContentEditable(dom, startContainer);\n      endContainer = findParentContentEditable(dom, endContainer);\n      if (isBookmarkNode$2(startContainer.parentNode) || isBookmarkNode$2(startContainer)) {\n        startContainer = isBookmarkNode$2(startContainer) ? startContainer : startContainer.parentNode;\n        if (rng.collapsed) {\n          startContainer = startContainer.previousSibling || startContainer;\n        } else {\n          startContainer = startContainer.nextSibling || startContainer;\n        }\n        if (NodeType.isText(startContainer)) {\n          startOffset = rng.collapsed ? startContainer.length : 0;\n        }\n      }\n      if (isBookmarkNode$2(endContainer.parentNode) || isBookmarkNode$2(endContainer)) {\n        endContainer = isBookmarkNode$2(endContainer) ? endContainer : endContainer.parentNode;\n        if (rng.collapsed) {\n          endContainer = endContainer.nextSibling || endContainer;\n        } else {\n          endContainer = endContainer.previousSibling || endContainer;\n        }\n        if (NodeType.isText(endContainer)) {\n          endOffset = rng.collapsed ? 0 : endContainer.length;\n        }\n      }\n      if (rng.collapsed) {\n        var startPoint = findWordEndPoint(dom, editor.getBody(), startContainer, startOffset, true, includeTrailingSpace);\n        startPoint.each(function (_a) {\n          var container = _a.container, offset = _a.offset;\n          startContainer = container;\n          startOffset = offset;\n        });\n        var endPoint = findWordEndPoint(dom, editor.getBody(), endContainer, endOffset, false, includeTrailingSpace);\n        endPoint.each(function (_a) {\n          var container = _a.container, offset = _a.offset;\n          endContainer = container;\n          endOffset = offset;\n        });\n      }\n      if (format[0].inline || format[0].block_expand) {\n        if (!format[0].inline || (!NodeType.isText(startContainer) || startOffset === 0)) {\n          startContainer = findParentContainer(dom, format, startContainer, startOffset, endContainer, endOffset, true);\n        }\n        if (!format[0].inline || (!NodeType.isText(endContainer) || endOffset === endContainer.nodeValue.length)) {\n          endContainer = findParentContainer(dom, format, startContainer, startOffset, endContainer, endOffset, false);\n        }\n      }\n      if (format[0].selector && format[0].expand !== false && !format[0].inline) {\n        startContainer = findSelectorEndPoint(dom, format, rng, startContainer, 'previousSibling');\n        endContainer = findSelectorEndPoint(dom, format, rng, endContainer, 'nextSibling');\n      }\n      if (format[0].block || format[0].selector) {\n        startContainer = findBlockEndPoint(editor, format, startContainer, 'previousSibling');\n        endContainer = findBlockEndPoint(editor, format, endContainer, 'nextSibling');\n        if (format[0].block) {\n          if (!dom.isBlock(startContainer)) {\n            startContainer = findParentContainer(dom, format, startContainer, startOffset, endContainer, endOffset, true);\n          }\n          if (!dom.isBlock(endContainer)) {\n            endContainer = findParentContainer(dom, format, startContainer, startOffset, endContainer, endOffset, false);\n          }\n        }\n      }\n      if (NodeType.isElement(startContainer)) {\n        startOffset = dom.nodeIndex(startContainer);\n        startContainer = startContainer.parentNode;\n      }\n      if (NodeType.isElement(endContainer)) {\n        endOffset = dom.nodeIndex(endContainer) + 1;\n        endContainer = endContainer.parentNode;\n      }\n      return {\n        startContainer: startContainer,\n        startOffset: startOffset,\n        endContainer: endContainer,\n        endOffset: endOffset\n      };\n    };\n\n    var each$7 = Tools.each;\n    var getEndChild = function (container, index) {\n      var childNodes = container.childNodes;\n      index--;\n      if (index > childNodes.length - 1) {\n        index = childNodes.length - 1;\n      } else if (index < 0) {\n        index = 0;\n      }\n      return childNodes[index] || container;\n    };\n    var walk$1 = function (dom, rng, callback) {\n      var startContainer = rng.startContainer;\n      var startOffset = rng.startOffset;\n      var endContainer = rng.endContainer;\n      var endOffset = rng.endOffset;\n      var nodes = dom.select('td[data-mce-selected],th[data-mce-selected]');\n      if (nodes.length > 0) {\n        each$7(nodes, function (node) {\n          callback([node]);\n        });\n        return;\n      }\n      var exclude = function (nodes) {\n        var node;\n        node = nodes[0];\n        if (node.nodeType === 3 && node === startContainer && startOffset >= node.nodeValue.length) {\n          nodes.splice(0, 1);\n        }\n        node = nodes[nodes.length - 1];\n        if (endOffset === 0 && nodes.length > 0 && node === endContainer && node.nodeType === 3) {\n          nodes.splice(nodes.length - 1, 1);\n        }\n        return nodes;\n      };\n      var collectSiblings = function (node, name, endNode) {\n        var siblings = [];\n        for (; node && node !== endNode; node = node[name]) {\n          siblings.push(node);\n        }\n        return siblings;\n      };\n      var findEndPoint = function (node, root) {\n        do {\n          if (node.parentNode === root) {\n            return node;\n          }\n          node = node.parentNode;\n        } while (node);\n      };\n      var walkBoundary = function (startNode, endNode, next) {\n        var siblingName = next ? 'nextSibling' : 'previousSibling';\n        for (var node = startNode, parent_1 = node.parentNode; node && node !== endNode; node = parent_1) {\n          parent_1 = node.parentNode;\n          var siblings_1 = collectSiblings(node === startNode ? node : node[siblingName], siblingName);\n          if (siblings_1.length) {\n            if (!next) {\n              siblings_1.reverse();\n            }\n            callback(exclude(siblings_1));\n          }\n        }\n      };\n      if (startContainer.nodeType === 1 && startContainer.hasChildNodes()) {\n        startContainer = startContainer.childNodes[startOffset];\n      }\n      if (endContainer.nodeType === 1 && endContainer.hasChildNodes()) {\n        endContainer = getEndChild(endContainer, endOffset);\n      }\n      if (startContainer === endContainer) {\n        return callback(exclude([startContainer]));\n      }\n      var ancestor = dom.findCommonAncestor(startContainer, endContainer);\n      for (var node = startContainer; node; node = node.parentNode) {\n        if (node === endContainer) {\n          return walkBoundary(startContainer, ancestor, true);\n        }\n        if (node === ancestor) {\n          break;\n        }\n      }\n      for (var node = endContainer; node; node = node.parentNode) {\n        if (node === startContainer) {\n          return walkBoundary(endContainer, ancestor);\n        }\n        if (node === ancestor) {\n          break;\n        }\n      }\n      var startPoint = findEndPoint(startContainer, ancestor) || startContainer;\n      var endPoint = findEndPoint(endContainer, ancestor) || endContainer;\n      walkBoundary(startContainer, startPoint, true);\n      var siblings = collectSiblings(startPoint === startContainer ? startPoint : startPoint.nextSibling, 'nextSibling', endPoint === endContainer ? endPoint.nextSibling : endPoint);\n      if (siblings.length) {\n        callback(exclude(siblings));\n      }\n      walkBoundary(endContainer, endPoint);\n    };\n    var RangeWalk = { walk: walk$1 };\n\n    function NodeValue (is, name) {\n      var get = function (element) {\n        if (!is(element)) {\n          throw new Error('Can only get ' + name + ' value of a ' + name + ' node');\n        }\n        return getOption(element).getOr('');\n      };\n      var getOption = function (element) {\n        return is(element) ? Option.from(element.dom().nodeValue) : Option.none();\n      };\n      var set = function (element, value) {\n        if (!is(element)) {\n          throw new Error('Can only set raw ' + name + ' value of a ' + name + ' node');\n        }\n        element.dom().nodeValue = value;\n      };\n      return {\n        get: get,\n        getOption: getOption,\n        set: set\n      };\n    }\n\n    var api = NodeValue(isText, 'text');\n    var get$7 = function (element) {\n      return api.get(element);\n    };\n\n    var isZeroWidth = function (elem) {\n      return isText(elem) && get$7(elem) === zeroWidth;\n    };\n    var context = function (editor, elem, wrapName, nodeName) {\n      return parent(elem).fold(function () {\n        return 'skipping';\n      }, function (parent) {\n        if (nodeName === 'br' || isZeroWidth(elem)) {\n          return 'valid';\n        } else if (isAnnotation(elem)) {\n          return 'existing';\n        } else if (isCaretNode(elem)) {\n          return 'caret';\n        } else if (!isValid(editor, wrapName, nodeName) || !isValid(editor, name(parent), wrapName)) {\n          return 'invalid-child';\n        } else {\n          return 'valid';\n        }\n      });\n    };\n\n    var applyWordGrab = function (editor, rng) {\n      var r = expandRng(editor, rng, [{ inline: true }]);\n      rng.setStart(r.startContainer, r.startOffset);\n      rng.setEnd(r.endContainer, r.endOffset);\n      editor.selection.setRng(rng);\n    };\n    var makeAnnotation = function (eDoc, _a, annotationName, decorate) {\n      var _b = _a.uid, uid = _b === void 0 ? generate('mce-annotation') : _b, data = __rest(_a, ['uid']);\n      var master = Element.fromTag('span', eDoc);\n      add$3(master, annotation());\n      set(master, '' + dataAnnotationId(), uid);\n      set(master, '' + dataAnnotation(), annotationName);\n      var _c = decorate(uid, data), _d = _c.attributes, attributes = _d === void 0 ? {} : _d, _e = _c.classes, classes = _e === void 0 ? [] : _e;\n      setAll(master, attributes);\n      add$4(master, classes);\n      return master;\n    };\n    var annotate = function (editor, rng, annotationName, decorate, data) {\n      var newWrappers = [];\n      var master = makeAnnotation(editor.getDoc(), data, annotationName, decorate);\n      var wrapper = Cell(Option.none());\n      var finishWrapper = function () {\n        wrapper.set(Option.none());\n      };\n      var getOrOpenWrapper = function () {\n        return wrapper.get().getOrThunk(function () {\n          var nu = shallow(master);\n          newWrappers.push(nu);\n          wrapper.set(Option.some(nu));\n          return nu;\n        });\n      };\n      var processElements = function (elems) {\n        each(elems, processElement);\n      };\n      var processElement = function (elem) {\n        var ctx = context(editor, elem, 'span', name(elem));\n        switch (ctx) {\n        case 'invalid-child': {\n            finishWrapper();\n            var children$1 = children(elem);\n            processElements(children$1);\n            finishWrapper();\n            break;\n          }\n        case 'valid': {\n            var w = getOrOpenWrapper();\n            wrap(elem, w);\n            break;\n          }\n        }\n      };\n      var processNodes = function (nodes) {\n        var elems = map(nodes, Element.fromDom);\n        processElements(elems);\n      };\n      RangeWalk.walk(editor.dom, rng, function (nodes) {\n        finishWrapper();\n        processNodes(nodes);\n      });\n      return newWrappers;\n    };\n    var annotateWithBookmark = function (editor, name, settings, data) {\n      editor.undoManager.transact(function () {\n        var initialRng = editor.selection.getRng();\n        if (initialRng.collapsed) {\n          applyWordGrab(editor, initialRng);\n        }\n        if (editor.selection.getRng().collapsed) {\n          var wrapper = makeAnnotation(editor.getDoc(), data, name, settings.decorate);\n          set$1(wrapper, nbsp);\n          editor.selection.getRng().insertNode(wrapper.dom());\n          editor.selection.select(wrapper.dom());\n        } else {\n          var bookmark = GetBookmark.getPersistentBookmark(editor.selection, false);\n          var rng = editor.selection.getRng();\n          annotate(editor, rng, name, settings.decorate, data);\n          editor.selection.moveToBookmark(bookmark);\n        }\n      });\n    };\n\n    var Annotator = function (editor) {\n      var registry = create$1();\n      setup$1(editor, registry);\n      var changes = setup(editor);\n      return {\n        register: function (name, settings) {\n          registry.register(name, settings);\n        },\n        annotate: function (name, data) {\n          registry.lookup(name).each(function (settings) {\n            annotateWithBookmark(editor, name, settings, data);\n          });\n        },\n        annotationChanged: function (name, callback) {\n          changes.addListener(name, callback);\n        },\n        remove: function (name) {\n          identify(editor, Option.some(name)).each(function (_a) {\n            var elements = _a.elements;\n            each(elements, unwrap);\n          });\n        },\n        getAll: function (name) {\n          var directory = findAll(editor, name);\n          return map$1(directory, function (elems) {\n            return map(elems, function (elem) {\n              return elem.dom();\n            });\n          });\n        }\n      };\n    };\n\n    var whiteSpaceRegExp$3 = /^[ \\t\\r\\n]*$/;\n    var typeLookup = {\n      '#text': 3,\n      '#comment': 8,\n      '#cdata': 4,\n      '#pi': 7,\n      '#doctype': 10,\n      '#document-fragment': 11\n    };\n    var walk$2 = function (node, root, prev) {\n      var startName = prev ? 'lastChild' : 'firstChild';\n      var siblingName = prev ? 'prev' : 'next';\n      if (node[startName]) {\n        return node[startName];\n      }\n      if (node !== root) {\n        var sibling = node[siblingName];\n        if (sibling) {\n          return sibling;\n        }\n        for (var parent_1 = node.parent; parent_1 && parent_1 !== root; parent_1 = parent_1.parent) {\n          sibling = parent_1[siblingName];\n          if (sibling) {\n            return sibling;\n          }\n        }\n      }\n    };\n    var isEmptyTextNode$1 = function (node) {\n      if (!whiteSpaceRegExp$3.test(node.value)) {\n        return false;\n      }\n      var parentNode = node.parent;\n      if (parentNode && (parentNode.name !== 'span' || parentNode.attr('style')) && /^[ ]+$/.test(node.value)) {\n        return false;\n      }\n      return true;\n    };\n    var Node$1 = function () {\n      function Node(name, type) {\n        this.name = name;\n        this.type = type;\n        if (type === 1) {\n          this.attributes = [];\n          this.attributes.map = {};\n        }\n      }\n      Node.create = function (name, attrs) {\n        var node = new Node(name, typeLookup[name] || 1);\n        if (attrs) {\n          for (var attrName in attrs) {\n            node.attr(attrName, attrs[attrName]);\n          }\n        }\n        return node;\n      };\n      Node.prototype.replace = function (node) {\n        var self = this;\n        if (node.parent) {\n          node.remove();\n        }\n        self.insert(node, self);\n        self.remove();\n        return self;\n      };\n      Node.prototype.attr = function (name, value) {\n        var self = this;\n        var attrs;\n        if (typeof name !== 'string') {\n          for (var key in name) {\n            self.attr(key, name[key]);\n          }\n          return self;\n        }\n        if (attrs = self.attributes) {\n          if (value !== undefined) {\n            if (value === null) {\n              if (name in attrs.map) {\n                delete attrs.map[name];\n                var i = attrs.length;\n                while (i--) {\n                  if (attrs[i].name === name) {\n                    attrs.splice(i, 1);\n                    return self;\n                  }\n                }\n              }\n              return self;\n            }\n            if (name in attrs.map) {\n              var i = attrs.length;\n              while (i--) {\n                if (attrs[i].name === name) {\n                  attrs[i].value = value;\n                  break;\n                }\n              }\n            } else {\n              attrs.push({\n                name: name,\n                value: value\n              });\n            }\n            attrs.map[name] = value;\n            return self;\n          }\n          return attrs.map[name];\n        }\n      };\n      Node.prototype.clone = function () {\n        var self = this;\n        var clone = new Node(self.name, self.type);\n        var selfAttrs;\n        if (selfAttrs = self.attributes) {\n          var cloneAttrs = [];\n          cloneAttrs.map = {};\n          for (var i = 0, l = selfAttrs.length; i < l; i++) {\n            var selfAttr = selfAttrs[i];\n            if (selfAttr.name !== 'id') {\n              cloneAttrs[cloneAttrs.length] = {\n                name: selfAttr.name,\n                value: selfAttr.value\n              };\n              cloneAttrs.map[selfAttr.name] = selfAttr.value;\n            }\n          }\n          clone.attributes = cloneAttrs;\n        }\n        clone.value = self.value;\n        clone.shortEnded = self.shortEnded;\n        return clone;\n      };\n      Node.prototype.wrap = function (wrapper) {\n        var self = this;\n        self.parent.insert(wrapper, self);\n        wrapper.append(self);\n        return self;\n      };\n      Node.prototype.unwrap = function () {\n        var self = this;\n        for (var node = self.firstChild; node;) {\n          var next = node.next;\n          self.insert(node, self, true);\n          node = next;\n        }\n        self.remove();\n      };\n      Node.prototype.remove = function () {\n        var self = this, parent = self.parent, next = self.next, prev = self.prev;\n        if (parent) {\n          if (parent.firstChild === self) {\n            parent.firstChild = next;\n            if (next) {\n              next.prev = null;\n            }\n          } else {\n            prev.next = next;\n          }\n          if (parent.lastChild === self) {\n            parent.lastChild = prev;\n            if (prev) {\n              prev.next = null;\n            }\n          } else {\n            next.prev = prev;\n          }\n          self.parent = self.next = self.prev = null;\n        }\n        return self;\n      };\n      Node.prototype.append = function (node) {\n        var self = this;\n        if (node.parent) {\n          node.remove();\n        }\n        var last = self.lastChild;\n        if (last) {\n          last.next = node;\n          node.prev = last;\n          self.lastChild = node;\n        } else {\n          self.lastChild = self.firstChild = node;\n        }\n        node.parent = self;\n        return node;\n      };\n      Node.prototype.insert = function (node, refNode, before) {\n        if (node.parent) {\n          node.remove();\n        }\n        var parent = refNode.parent || this;\n        if (before) {\n          if (refNode === parent.firstChild) {\n            parent.firstChild = node;\n          } else {\n            refNode.prev.next = node;\n          }\n          node.prev = refNode.prev;\n          node.next = refNode;\n          refNode.prev = node;\n        } else {\n          if (refNode === parent.lastChild) {\n            parent.lastChild = node;\n          } else {\n            refNode.next.prev = node;\n          }\n          node.next = refNode.next;\n          node.prev = refNode;\n          refNode.next = node;\n        }\n        node.parent = parent;\n        return node;\n      };\n      Node.prototype.getAll = function (name) {\n        var self = this;\n        var collection = [];\n        for (var node = self.firstChild; node; node = walk$2(node, self)) {\n          if (node.name === name) {\n            collection.push(node);\n          }\n        }\n        return collection;\n      };\n      Node.prototype.empty = function () {\n        var self = this;\n        if (self.firstChild) {\n          var nodes = [];\n          for (var node = self.firstChild; node; node = walk$2(node, self)) {\n            nodes.push(node);\n          }\n          var i = nodes.length;\n          while (i--) {\n            var node = nodes[i];\n            node.parent = node.firstChild = node.lastChild = node.next = node.prev = null;\n          }\n        }\n        self.firstChild = self.lastChild = null;\n        return self;\n      };\n      Node.prototype.isEmpty = function (elements, whitespace, predicate) {\n        if (whitespace === void 0) {\n          whitespace = {};\n        }\n        var self = this;\n        var node = self.firstChild;\n        if (node) {\n          do {\n            if (node.type === 1) {\n              if (node.attr('data-mce-bogus')) {\n                continue;\n              }\n              if (elements[node.name]) {\n                return false;\n              }\n              var i = node.attributes.length;\n              while (i--) {\n                var name_1 = node.attributes[i].name;\n                if (name_1 === 'name' || name_1.indexOf('data-mce-bookmark') === 0) {\n                  return false;\n                }\n              }\n            }\n            if (node.type === 8) {\n              return false;\n            }\n            if (node.type === 3 && !isEmptyTextNode$1(node)) {\n              return false;\n            }\n            if (node.type === 3 && node.parent && whitespace[node.parent.name] && whiteSpaceRegExp$3.test(node.value)) {\n              return false;\n            }\n            if (predicate && predicate(node)) {\n              return false;\n            }\n          } while (node = walk$2(node, self));\n        }\n        return true;\n      };\n      Node.prototype.walk = function (prev) {\n        return walk$2(this, null, prev);\n      };\n      return Node;\n    }();\n\n    var isValidPrefixAttrName = function (name) {\n      return name.indexOf('data-') === 0 || name.indexOf('aria-') === 0;\n    };\n    var isInvalidUri = function (settings, uri) {\n      if (settings.allow_html_data_urls) {\n        return false;\n      } else if (/^data:image\\//i.test(uri)) {\n        return settings.allow_svg_data_urls === false && /^data:image\\/svg\\+xml/i.test(uri);\n      } else {\n        return /^data:/i.test(uri);\n      }\n    };\n    var findEndTagIndex = function (schema, html, startIndex) {\n      var count = 1, index, matches, tokenRegExp, shortEndedElements;\n      shortEndedElements = schema.getShortEndedElements();\n      tokenRegExp = /<([!?\\/])?([A-Za-z0-9\\-_\\:\\.]+)((?:\\s+[^\"\\'>]+(?:(?:\"[^\"]*\")|(?:\\'[^\\']*\\')|[^>]*))*|\\/|\\s+)>/g;\n      tokenRegExp.lastIndex = index = startIndex;\n      while (matches = tokenRegExp.exec(html)) {\n        index = tokenRegExp.lastIndex;\n        if (matches[1] === '/') {\n          count--;\n        } else if (!matches[1]) {\n          if (matches[2] in shortEndedElements) {\n            continue;\n          }\n          count++;\n        }\n        if (count === 0) {\n          break;\n        }\n      }\n      return index;\n    };\n    var isConditionalComment = function (html, startIndex) {\n      return /^\\s*\\[if [\\w\\W]+\\]>.*<!\\[endif\\](--!?)?>/.test(html.substr(startIndex));\n    };\n    var findCommentEndIndex = function (html, isBogus, startIndex) {\n      if (startIndex === void 0) {\n        startIndex = 0;\n      }\n      var lcHtml = html.toLowerCase();\n      if (lcHtml.indexOf('[if ', startIndex) !== -1 && isConditionalComment(lcHtml, startIndex)) {\n        var endIfIndex = lcHtml.indexOf('[endif]', startIndex);\n        return lcHtml.indexOf('>', endIfIndex);\n      } else {\n        if (isBogus) {\n          var endIndex = lcHtml.indexOf('>', startIndex);\n          return endIndex !== -1 ? endIndex : lcHtml.length;\n        } else {\n          var endCommentRegexp = /--!?>/;\n          endCommentRegexp.lastIndex = startIndex;\n          var match = endCommentRegexp.exec(html);\n          return match ? match.index + match[0].length : lcHtml.length;\n        }\n      }\n    };\n    var checkBogusAttribute = function (regExp, attrString) {\n      var matches = regExp.exec(attrString);\n      if (matches) {\n        var name_1 = matches[1];\n        var value = matches[2];\n        return typeof name_1 === 'string' && name_1.toLowerCase() === 'data-mce-bogus' ? value : null;\n      } else {\n        return null;\n      }\n    };\n    function SaxParser(settings, schema) {\n      if (schema === void 0) {\n        schema = Schema();\n      }\n      var noop = function () {\n      };\n      settings = settings || {};\n      if (settings.fix_self_closing !== false) {\n        settings.fix_self_closing = true;\n      }\n      var comment = settings.comment ? settings.comment : noop;\n      var cdata = settings.cdata ? settings.cdata : noop;\n      var text = settings.text ? settings.text : noop;\n      var start = settings.start ? settings.start : noop;\n      var end = settings.end ? settings.end : noop;\n      var pi = settings.pi ? settings.pi : noop;\n      var doctype = settings.doctype ? settings.doctype : noop;\n      var parse = function (html, format) {\n        if (format === void 0) {\n          format = 'html';\n        }\n        var matches, index = 0, value, endRegExp;\n        var stack = [];\n        var attrList, i, textData, name;\n        var isInternalElement, removeInternalElements, shortEndedElements, fillAttrsMap, isShortEnded;\n        var validate, elementRule, isValidElement, attr, attribsValue, validAttributesMap, validAttributePatterns;\n        var attributesRequired, attributesDefault, attributesForced, processHtml;\n        var anyAttributesRequired, selfClosing, tokenRegExp, attrRegExp, specialElements, attrValue, idCount = 0;\n        var decode = Entities.decode;\n        var fixSelfClosing;\n        var filteredUrlAttrs = Tools.makeMap('src,href,data,background,formaction,poster,xlink:href');\n        var scriptUriRegExp = /((java|vb)script|mhtml):/i;\n        var parsingMode = format === 'html' ? 0 : 1;\n        var processEndTag = function (name) {\n          var pos, i;\n          pos = stack.length;\n          while (pos--) {\n            if (stack[pos].name === name) {\n              break;\n            }\n          }\n          if (pos >= 0) {\n            for (i = stack.length - 1; i >= pos; i--) {\n              name = stack[i];\n              if (name.valid) {\n                end(name.name);\n              }\n            }\n            stack.length = pos;\n          }\n        };\n        var processComment = function (value) {\n          if (value === '') {\n            return;\n          }\n          if (value.charAt(0) === '>') {\n            value = ' ' + value;\n          }\n          if (!settings.allow_conditional_comments && value.substr(0, 3).toLowerCase() === '[if') {\n            value = ' ' + value;\n          }\n          comment(value);\n        };\n        var processMalformedComment = function (value, startIndex) {\n          var startTag = value || '';\n          var isBogus = !startsWith(startTag, '--');\n          var endIndex = findCommentEndIndex(html, isBogus, startIndex);\n          value = html.substr(startIndex, endIndex - startIndex);\n          processComment(isBogus ? startTag + value : value);\n          return endIndex + 1;\n        };\n        var parseAttribute = function (match, name, value, val2, val3) {\n          var attrRule, i;\n          var trimRegExp = /[\\s\\u0000-\\u001F]+/g;\n          name = name.toLowerCase();\n          value = name in fillAttrsMap ? name : decode(value || val2 || val3 || '');\n          if (validate && !isInternalElement && isValidPrefixAttrName(name) === false) {\n            attrRule = validAttributesMap[name];\n            if (!attrRule && validAttributePatterns) {\n              i = validAttributePatterns.length;\n              while (i--) {\n                attrRule = validAttributePatterns[i];\n                if (attrRule.pattern.test(name)) {\n                  break;\n                }\n              }\n              if (i === -1) {\n                attrRule = null;\n              }\n            }\n            if (!attrRule) {\n              return;\n            }\n            if (attrRule.validValues && !(value in attrRule.validValues)) {\n              return;\n            }\n          }\n          if (filteredUrlAttrs[name] && !settings.allow_script_urls) {\n            var uri = value.replace(trimRegExp, '');\n            try {\n              uri = decodeURIComponent(uri);\n            } catch (ex) {\n              uri = unescape(uri);\n            }\n            if (scriptUriRegExp.test(uri)) {\n              return;\n            }\n            if (isInvalidUri(settings, uri)) {\n              return;\n            }\n          }\n          if (isInternalElement && (name in filteredUrlAttrs || name.indexOf('on') === 0)) {\n            return;\n          }\n          attrList.map[name] = value;\n          attrList.push({\n            name: name,\n            value: value\n          });\n        };\n        tokenRegExp = new RegExp('<(?:' + '(?:!--([\\\\w\\\\W]*?)--!?>)|' + '(?:!\\\\[CDATA\\\\[([\\\\w\\\\W]*?)\\\\]\\\\]>)|' + '(?:![Dd][Oo][Cc][Tt][Yy][Pp][Ee]([\\\\w\\\\W]*?)>)|' + '(?:!(--)?)|' + '(?:\\\\?([^\\\\s\\\\/<>]+) ?([\\\\w\\\\W]*?)[?/]>)|' + '(?:\\\\/([A-Za-z][A-Za-z0-9\\\\-_\\\\:\\\\.]*)>)|' + '(?:([A-Za-z][A-Za-z0-9\\\\-_\\\\:\\\\.]*)((?:\\\\s+[^\"\\'>]+(?:(?:\"[^\"]*\")|(?:\\'[^\\']*\\')|[^>]*))*|\\\\/|\\\\s+)>)' + ')', 'g');\n        attrRegExp = /([\\w:\\-]+)(?:\\s*=\\s*(?:(?:\\\"((?:[^\\\"])*)\\\")|(?:\\'((?:[^\\'])*)\\')|([^>\\s]+)))?/g;\n        shortEndedElements = schema.getShortEndedElements();\n        selfClosing = settings.self_closing_elements || schema.getSelfClosingElements();\n        fillAttrsMap = schema.getBoolAttrs();\n        validate = settings.validate;\n        removeInternalElements = settings.remove_internals;\n        fixSelfClosing = settings.fix_self_closing;\n        specialElements = schema.getSpecialElements();\n        processHtml = html + '>';\n        while (matches = tokenRegExp.exec(processHtml)) {\n          var matchText = matches[0];\n          if (index < matches.index) {\n            text(decode(html.substr(index, matches.index - index)));\n          }\n          if (value = matches[7]) {\n            value = value.toLowerCase();\n            if (value.charAt(0) === ':') {\n              value = value.substr(1);\n            }\n            processEndTag(value);\n          } else if (value = matches[8]) {\n            if (matches.index + matchText.length > html.length) {\n              text(decode(html.substr(matches.index)));\n              index = matches.index + matchText.length;\n              continue;\n            }\n            value = value.toLowerCase();\n            if (value.charAt(0) === ':') {\n              value = value.substr(1);\n            }\n            isShortEnded = value in shortEndedElements;\n            if (fixSelfClosing && selfClosing[value] && stack.length > 0 && stack[stack.length - 1].name === value) {\n              processEndTag(value);\n            }\n            var bogusValue = checkBogusAttribute(attrRegExp, matches[9]);\n            if (bogusValue !== null) {\n              if (bogusValue === 'all') {\n                index = findEndTagIndex(schema, html, tokenRegExp.lastIndex);\n                tokenRegExp.lastIndex = index;\n                continue;\n              }\n              isValidElement = false;\n            }\n            if (!validate || (elementRule = schema.getElementRule(value))) {\n              isValidElement = true;\n              if (validate) {\n                validAttributesMap = elementRule.attributes;\n                validAttributePatterns = elementRule.attributePatterns;\n              }\n              if (attribsValue = matches[9]) {\n                isInternalElement = attribsValue.indexOf('data-mce-type') !== -1;\n                if (isInternalElement && removeInternalElements) {\n                  isValidElement = false;\n                }\n                attrList = [];\n                attrList.map = {};\n                attribsValue.replace(attrRegExp, parseAttribute);\n              } else {\n                attrList = [];\n                attrList.map = {};\n              }\n              if (validate && !isInternalElement) {\n                attributesRequired = elementRule.attributesRequired;\n                attributesDefault = elementRule.attributesDefault;\n                attributesForced = elementRule.attributesForced;\n                anyAttributesRequired = elementRule.removeEmptyAttrs;\n                if (anyAttributesRequired && !attrList.length) {\n                  isValidElement = false;\n                }\n                if (attributesForced) {\n                  i = attributesForced.length;\n                  while (i--) {\n                    attr = attributesForced[i];\n                    name = attr.name;\n                    attrValue = attr.value;\n                    if (attrValue === '{$uid}') {\n                      attrValue = 'mce_' + idCount++;\n                    }\n                    attrList.map[name] = attrValue;\n                    attrList.push({\n                      name: name,\n                      value: attrValue\n                    });\n                  }\n                }\n                if (attributesDefault) {\n                  i = attributesDefault.length;\n                  while (i--) {\n                    attr = attributesDefault[i];\n                    name = attr.name;\n                    if (!(name in attrList.map)) {\n                      attrValue = attr.value;\n                      if (attrValue === '{$uid}') {\n                        attrValue = 'mce_' + idCount++;\n                      }\n                      attrList.map[name] = attrValue;\n                      attrList.push({\n                        name: name,\n                        value: attrValue\n                      });\n                    }\n                  }\n                }\n                if (attributesRequired) {\n                  i = attributesRequired.length;\n                  while (i--) {\n                    if (attributesRequired[i] in attrList.map) {\n                      break;\n                    }\n                  }\n                  if (i === -1) {\n                    isValidElement = false;\n                  }\n                }\n                if (attr = attrList.map['data-mce-bogus']) {\n                  if (attr === 'all') {\n                    index = findEndTagIndex(schema, html, tokenRegExp.lastIndex);\n                    tokenRegExp.lastIndex = index;\n                    continue;\n                  }\n                  isValidElement = false;\n                }\n              }\n              if (isValidElement) {\n                start(value, attrList, isShortEnded);\n              }\n            } else {\n              isValidElement = false;\n            }\n            if (endRegExp = specialElements[value]) {\n              endRegExp.lastIndex = index = matches.index + matchText.length;\n              if (matches = endRegExp.exec(html)) {\n                if (isValidElement) {\n                  textData = html.substr(index, matches.index - index);\n                }\n                index = matches.index + matches[0].length;\n              } else {\n                textData = html.substr(index);\n                index = html.length;\n              }\n              if (isValidElement) {\n                if (textData.length > 0) {\n                  text(textData, true);\n                }\n                end(value);\n              }\n              tokenRegExp.lastIndex = index;\n              continue;\n            }\n            if (!isShortEnded) {\n              if (!attribsValue || attribsValue.indexOf('/') !== attribsValue.length - 1) {\n                stack.push({\n                  name: value,\n                  valid: isValidElement\n                });\n              } else if (isValidElement) {\n                end(value);\n              }\n            }\n          } else if (value = matches[1]) {\n            processComment(value);\n          } else if (value = matches[2]) {\n            var isValidCdataSection = parsingMode === 1 || settings.preserve_cdata || stack.length > 0 && schema.isValidChild(stack[stack.length - 1].name, '#cdata');\n            if (isValidCdataSection) {\n              cdata(value);\n            } else {\n              index = processMalformedComment('', matches.index + 2);\n              tokenRegExp.lastIndex = index;\n              continue;\n            }\n          } else if (value = matches[3]) {\n            doctype(value);\n          } else if ((value = matches[4]) || matchText === '<!') {\n            index = processMalformedComment(value, matches.index + matchText.length);\n            tokenRegExp.lastIndex = index;\n            continue;\n          } else if (value = matches[5]) {\n            if (parsingMode === 1) {\n              pi(value, matches[6]);\n            } else {\n              index = processMalformedComment('?', matches.index + 2);\n              tokenRegExp.lastIndex = index;\n              continue;\n            }\n          }\n          index = matches.index + matchText.length;\n        }\n        if (index < html.length) {\n          text(decode(html.substr(index)));\n        }\n        for (i = stack.length - 1; i >= 0; i--) {\n          value = stack[i];\n          if (value.valid) {\n            end(value.name);\n          }\n        }\n      };\n      return { parse: parse };\n    }\n    (function (SaxParser) {\n      SaxParser.findEndTag = findEndTagIndex;\n    }(SaxParser || (SaxParser = {})));\n    var SaxParser$1 = SaxParser;\n\n    var trimHtml = function (tempAttrs, html) {\n      var trimContentRegExp = new RegExp(['\\\\s?(' + tempAttrs.join('|') + ')=\"[^\"]+\"'].join('|'), 'gi');\n      return html.replace(trimContentRegExp, '');\n    };\n    var trimInternal = function (serializer, html) {\n      var content = html;\n      var bogusAllRegExp = /<(\\w+) [^>]*data-mce-bogus=\"all\"[^>]*>/g;\n      var endTagIndex, index, matchLength, matches, shortEndedElements;\n      var schema = serializer.schema;\n      content = trimHtml(serializer.getTempAttrs(), content);\n      shortEndedElements = schema.getShortEndedElements();\n      while (matches = bogusAllRegExp.exec(content)) {\n        index = bogusAllRegExp.lastIndex;\n        matchLength = matches[0].length;\n        if (shortEndedElements[matches[1]]) {\n          endTagIndex = index;\n        } else {\n          endTagIndex = SaxParser$1.findEndTag(schema, content, index);\n        }\n        content = content.substring(0, index - matchLength) + content.substring(endTagIndex);\n        bogusAllRegExp.lastIndex = index - matchLength;\n      }\n      return Zwsp.trim(content);\n    };\n    var trimExternal = trimInternal;\n    var TrimHtml = {\n      trimExternal: trimExternal,\n      trimInternal: trimInternal\n    };\n\n    var defaultFormat = 'html';\n    var trimEmptyContents = function (editor, html) {\n      var blockName = Settings.getForcedRootBlock(editor);\n      var emptyRegExp = new RegExp('^(<' + blockName + '[^>]*>(&nbsp;|&#160;|\\\\s|\\xA0|<br \\\\/>|)<\\\\/' + blockName + '>[\\r\\n]*|<br \\\\/>[\\r\\n]*)$');\n      return html.replace(emptyRegExp, '');\n    };\n    var getContentFromBody = function (editor, args, body) {\n      var content;\n      args.format = args.format ? args.format : defaultFormat;\n      args.get = true;\n      args.getInner = true;\n      if (!args.no_events) {\n        editor.fire('BeforeGetContent', args);\n      }\n      if (args.format === 'raw') {\n        content = Tools.trim(TrimHtml.trimExternal(editor.serializer, body.innerHTML));\n      } else if (args.format === 'text') {\n        content = Zwsp.trim(body.innerText || body.textContent);\n      } else if (args.format === 'tree') {\n        return editor.serializer.serialize(body, args);\n      } else {\n        content = trimEmptyContents(editor, editor.serializer.serialize(body, args));\n      }\n      if (args.format !== 'text' && !isWsPreserveElement(Element.fromDom(body))) {\n        args.content = Tools.trim(content);\n      } else {\n        args.content = content;\n      }\n      if (!args.no_events) {\n        editor.fire('GetContent', args);\n      }\n      return args.content;\n    };\n    var getContent = function (editor, args) {\n      if (args === void 0) {\n        args = {};\n      }\n      return Option.from(editor.getBody()).fold(constant(args.format === 'tree' ? new Node$1('body', 11) : ''), function (body) {\n        return getContentFromBody(editor, args, body);\n      });\n    };\n\n    var makeMap$3 = Tools.makeMap;\n    var Writer = function (settings) {\n      var html = [];\n      var indent, indentBefore, indentAfter, encode, htmlOutput;\n      settings = settings || {};\n      indent = settings.indent;\n      indentBefore = makeMap$3(settings.indent_before || '');\n      indentAfter = makeMap$3(settings.indent_after || '');\n      encode = Entities.getEncodeFunc(settings.entity_encoding || 'raw', settings.entities);\n      htmlOutput = settings.element_format === 'html';\n      return {\n        start: function (name, attrs, empty) {\n          var i, l, attr, value;\n          if (indent && indentBefore[name] && html.length > 0) {\n            value = html[html.length - 1];\n            if (value.length > 0 && value !== '\\n') {\n              html.push('\\n');\n            }\n          }\n          html.push('<', name);\n          if (attrs) {\n            for (i = 0, l = attrs.length; i < l; i++) {\n              attr = attrs[i];\n              html.push(' ', attr.name, '=\"', encode(attr.value, true), '\"');\n            }\n          }\n          if (!empty || htmlOutput) {\n            html[html.length] = '>';\n          } else {\n            html[html.length] = ' />';\n          }\n          if (empty && indent && indentAfter[name] && html.length > 0) {\n            value = html[html.length - 1];\n            if (value.length > 0 && value !== '\\n') {\n              html.push('\\n');\n            }\n          }\n        },\n        end: function (name) {\n          var value;\n          html.push('</', name, '>');\n          if (indent && indentAfter[name] && html.length > 0) {\n            value = html[html.length - 1];\n            if (value.length > 0 && value !== '\\n') {\n              html.push('\\n');\n            }\n          }\n        },\n        text: function (text, raw) {\n          if (text.length > 0) {\n            html[html.length] = raw ? text : encode(text);\n          }\n        },\n        cdata: function (text) {\n          html.push('<![CDATA[', text, ']]>');\n        },\n        comment: function (text) {\n          html.push('<!--', text, '-->');\n        },\n        pi: function (name, text) {\n          if (text) {\n            html.push('<?', name, ' ', encode(text), '?>');\n          } else {\n            html.push('<?', name, '?>');\n          }\n          if (indent) {\n            html.push('\\n');\n          }\n        },\n        doctype: function (text) {\n          html.push('<!DOCTYPE', text, '>', indent ? '\\n' : '');\n        },\n        reset: function () {\n          html.length = 0;\n        },\n        getContent: function () {\n          return html.join('').replace(/\\n$/, '');\n        }\n      };\n    };\n\n    var Serializer = function (settings, schema) {\n      if (schema === void 0) {\n        schema = Schema();\n      }\n      var writer = Writer(settings);\n      settings = settings || {};\n      settings.validate = 'validate' in settings ? settings.validate : true;\n      var serialize = function (node) {\n        var handlers, validate;\n        validate = settings.validate;\n        handlers = {\n          3: function (node) {\n            writer.text(node.value, node.raw);\n          },\n          8: function (node) {\n            writer.comment(node.value);\n          },\n          7: function (node) {\n            writer.pi(node.name, node.value);\n          },\n          10: function (node) {\n            writer.doctype(node.value);\n          },\n          4: function (node) {\n            writer.cdata(node.value);\n          },\n          11: function (node) {\n            if (node = node.firstChild) {\n              do {\n                walk(node);\n              } while (node = node.next);\n            }\n          }\n        };\n        writer.reset();\n        var walk = function (node) {\n          var handler = handlers[node.type];\n          var name, isEmpty, attrs, attrName, attrValue, sortedAttrs, i, l, elementRule;\n          if (!handler) {\n            name = node.name;\n            isEmpty = node.shortEnded;\n            attrs = node.attributes;\n            if (validate && attrs && attrs.length > 1) {\n              sortedAttrs = [];\n              sortedAttrs.map = {};\n              elementRule = schema.getElementRule(node.name);\n              if (elementRule) {\n                for (i = 0, l = elementRule.attributesOrder.length; i < l; i++) {\n                  attrName = elementRule.attributesOrder[i];\n                  if (attrName in attrs.map) {\n                    attrValue = attrs.map[attrName];\n                    sortedAttrs.map[attrName] = attrValue;\n                    sortedAttrs.push({\n                      name: attrName,\n                      value: attrValue\n                    });\n                  }\n                }\n                for (i = 0, l = attrs.length; i < l; i++) {\n                  attrName = attrs[i].name;\n                  if (!(attrName in sortedAttrs.map)) {\n                    attrValue = attrs.map[attrName];\n                    sortedAttrs.map[attrName] = attrValue;\n                    sortedAttrs.push({\n                      name: attrName,\n                      value: attrValue\n                    });\n                  }\n                }\n                attrs = sortedAttrs;\n              }\n            }\n            writer.start(node.name, attrs, isEmpty);\n            if (!isEmpty) {\n              if (node = node.firstChild) {\n                do {\n                  walk(node);\n                } while (node = node.next);\n              }\n              writer.end(name);\n            }\n          } else {\n            handler(node);\n          }\n        };\n        if (node.type === 1 && !settings.inner) {\n          walk(node);\n        } else {\n          handlers[11](node);\n        }\n        return writer.getContent();\n      };\n      return { serialize: serialize };\n    };\n\n    var traverse = function (node, fn) {\n      fn(node);\n      if (node.firstChild) {\n        traverse(node.firstChild, fn);\n      }\n      if (node.next) {\n        traverse(node.next, fn);\n      }\n    };\n    var findMatchingNodes = function (nodeFilters, attributeFilters, node) {\n      var nodeMatches = {};\n      var attrMatches = {};\n      var matches = [];\n      if (node.firstChild) {\n        traverse(node.firstChild, function (node) {\n          each(nodeFilters, function (filter) {\n            if (filter.name === node.name) {\n              if (nodeMatches[filter.name]) {\n                nodeMatches[filter.name].nodes.push(node);\n              } else {\n                nodeMatches[filter.name] = {\n                  filter: filter,\n                  nodes: [node]\n                };\n              }\n            }\n          });\n          each(attributeFilters, function (filter) {\n            if (typeof node.attr(filter.name) === 'string') {\n              if (attrMatches[filter.name]) {\n                attrMatches[filter.name].nodes.push(node);\n              } else {\n                attrMatches[filter.name] = {\n                  filter: filter,\n                  nodes: [node]\n                };\n              }\n            }\n          });\n        });\n      }\n      for (var name_1 in nodeMatches) {\n        if (nodeMatches.hasOwnProperty(name_1)) {\n          matches.push(nodeMatches[name_1]);\n        }\n      }\n      for (var name_2 in attrMatches) {\n        if (attrMatches.hasOwnProperty(name_2)) {\n          matches.push(attrMatches[name_2]);\n        }\n      }\n      return matches;\n    };\n    var filter$2 = function (nodeFilters, attributeFilters, node) {\n      var matches = findMatchingNodes(nodeFilters, attributeFilters, node);\n      each(matches, function (match) {\n        each(match.filter.callbacks, function (callback) {\n          callback(match.nodes, match.filter.name, {});\n        });\n      });\n    };\n\n    var hasFocus = function (element) {\n      var doc = owner(element).dom();\n      return element.dom() === doc.activeElement;\n    };\n    var active = function (_doc) {\n      var doc = _doc !== undefined ? _doc.dom() : domGlobals.document;\n      return Option.from(doc.activeElement).map(Element.fromDom);\n    };\n    var search = function (element) {\n      return active(owner(element)).filter(function (e) {\n        return element.dom().contains(e.dom());\n      });\n    };\n\n    var generate$1 = function (cases) {\n      if (!isArray(cases)) {\n        throw new Error('cases must be an array');\n      }\n      if (cases.length === 0) {\n        throw new Error('there must be at least one case');\n      }\n      var constructors = [];\n      var adt = {};\n      each(cases, function (acase, count) {\n        var keys$1 = keys(acase);\n        if (keys$1.length !== 1) {\n          throw new Error('one and only one name per case');\n        }\n        var key = keys$1[0];\n        var value = acase[key];\n        if (adt[key] !== undefined) {\n          throw new Error('duplicate key detected:' + key);\n        } else if (key === 'cata') {\n          throw new Error('cannot have a case named cata (sorry)');\n        } else if (!isArray(value)) {\n          throw new Error('case arguments must be an array');\n        }\n        constructors.push(key);\n        adt[key] = function () {\n          var argLength = arguments.length;\n          if (argLength !== value.length) {\n            throw new Error('Wrong number of arguments to case ' + key + '. Expected ' + value.length + ' (' + value + '), got ' + argLength);\n          }\n          var args = new Array(argLength);\n          for (var i = 0; i < args.length; i++) {\n            args[i] = arguments[i];\n          }\n          var match = function (branches) {\n            var branchKeys = keys(branches);\n            if (constructors.length !== branchKeys.length) {\n              throw new Error('Wrong number of arguments to match. Expected: ' + constructors.join(',') + '\\nActual: ' + branchKeys.join(','));\n            }\n            var allReqd = forall(constructors, function (reqKey) {\n              return contains(branchKeys, reqKey);\n            });\n            if (!allReqd) {\n              throw new Error('Not all branches were specified when using match. Specified: ' + branchKeys.join(', ') + '\\nRequired: ' + constructors.join(', '));\n            }\n            return branches[key].apply(null, args);\n          };\n          return {\n            fold: function () {\n              if (arguments.length !== cases.length) {\n                throw new Error('Wrong number of arguments to fold. Expected ' + cases.length + ', got ' + arguments.length);\n              }\n              var target = arguments[count];\n              return target.apply(null, args);\n            },\n            match: match,\n            log: function (label) {\n              domGlobals.console.log(label, {\n                constructors: constructors,\n                constructor: key,\n                params: args\n              });\n            }\n          };\n        };\n      });\n      return adt;\n    };\n    var Adt = { generate: generate$1 };\n\n    var create$3 = Immutable('start', 'soffset', 'finish', 'foffset');\n    var SimRange = { create: create$3 };\n\n    var adt = Adt.generate([\n      { before: ['element'] },\n      {\n        on: [\n          'element',\n          'offset'\n        ]\n      },\n      { after: ['element'] }\n    ]);\n    var cata = function (subject, onBefore, onOn, onAfter) {\n      return subject.fold(onBefore, onOn, onAfter);\n    };\n    var getStart = function (situ) {\n      return situ.fold(identity, identity, identity);\n    };\n    var before$3 = adt.before;\n    var on = adt.on;\n    var after$2 = adt.after;\n    var Situ = {\n      before: before$3,\n      on: on,\n      after: after$2,\n      cata: cata,\n      getStart: getStart\n    };\n\n    var adt$1 = Adt.generate([\n      { domRange: ['rng'] },\n      {\n        relative: [\n          'startSitu',\n          'finishSitu'\n        ]\n      },\n      {\n        exact: [\n          'start',\n          'soffset',\n          'finish',\n          'foffset'\n        ]\n      }\n    ]);\n    var exactFromRange = function (simRange) {\n      return adt$1.exact(simRange.start(), simRange.soffset(), simRange.finish(), simRange.foffset());\n    };\n    var getStart$1 = function (selection) {\n      return selection.match({\n        domRange: function (rng) {\n          return Element.fromDom(rng.startContainer);\n        },\n        relative: function (startSitu, finishSitu) {\n          return Situ.getStart(startSitu);\n        },\n        exact: function (start, soffset, finish, foffset) {\n          return start;\n        }\n      });\n    };\n    var domRange = adt$1.domRange;\n    var relative = adt$1.relative;\n    var exact = adt$1.exact;\n    var getWin = function (selection) {\n      var start = getStart$1(selection);\n      return defaultView(start);\n    };\n    var range = SimRange.create;\n    var Selection = {\n      domRange: domRange,\n      relative: relative,\n      exact: exact,\n      exactFromRange: exactFromRange,\n      getWin: getWin,\n      range: range\n    };\n\n    var browser$4 = detect$3().browser;\n    var clamp = function (offset, element) {\n      var max = isText(element) ? get$7(element).length : children(element).length + 1;\n      if (offset > max) {\n        return max;\n      } else if (offset < 0) {\n        return 0;\n      }\n      return offset;\n    };\n    var normalizeRng = function (rng) {\n      return Selection.range(rng.start(), clamp(rng.soffset(), rng.start()), rng.finish(), clamp(rng.foffset(), rng.finish()));\n    };\n    var isOrContains = function (root, elm) {\n      return !NodeType.isRestrictedNode(elm.dom()) && (contains$2(root, elm) || eq(root, elm));\n    };\n    var isRngInRoot = function (root) {\n      return function (rng) {\n        return isOrContains(root, rng.start()) && isOrContains(root, rng.finish());\n      };\n    };\n    var shouldStore = function (editor) {\n      return editor.inline === true || browser$4.isIE();\n    };\n    var nativeRangeToSelectionRange = function (r) {\n      return Selection.range(Element.fromDom(r.startContainer), r.startOffset, Element.fromDom(r.endContainer), r.endOffset);\n    };\n    var readRange = function (win) {\n      var selection = win.getSelection();\n      var rng = !selection || selection.rangeCount === 0 ? Option.none() : Option.from(selection.getRangeAt(0));\n      return rng.map(nativeRangeToSelectionRange);\n    };\n    var getBookmark$2 = function (root) {\n      var win = defaultView(root);\n      return readRange(win.dom()).filter(isRngInRoot(root));\n    };\n    var validate = function (root, bookmark) {\n      return Option.from(bookmark).filter(isRngInRoot(root)).map(normalizeRng);\n    };\n    var bookmarkToNativeRng = function (bookmark) {\n      var rng = domGlobals.document.createRange();\n      try {\n        rng.setStart(bookmark.start().dom(), bookmark.soffset());\n        rng.setEnd(bookmark.finish().dom(), bookmark.foffset());\n        return Option.some(rng);\n      } catch (_) {\n        return Option.none();\n      }\n    };\n    var store = function (editor) {\n      var newBookmark = shouldStore(editor) ? getBookmark$2(Element.fromDom(editor.getBody())) : Option.none();\n      editor.bookmark = newBookmark.isSome() ? newBookmark : editor.bookmark;\n    };\n    var storeNative = function (editor, rng) {\n      var root = Element.fromDom(editor.getBody());\n      var range = shouldStore(editor) ? Option.from(rng) : Option.none();\n      var newBookmark = range.map(nativeRangeToSelectionRange).filter(isRngInRoot(root));\n      editor.bookmark = newBookmark.isSome() ? newBookmark : editor.bookmark;\n    };\n    var getRng = function (editor) {\n      var bookmark = editor.bookmark ? editor.bookmark : Option.none();\n      return bookmark.bind(function (x) {\n        return validate(Element.fromDom(editor.getBody()), x);\n      }).bind(bookmarkToNativeRng);\n    };\n    var restore = function (editor) {\n      getRng(editor).each(function (rng) {\n        editor.selection.setRng(rng);\n      });\n    };\n    var SelectionBookmark = {\n      store: store,\n      storeNative: storeNative,\n      readRange: readRange,\n      restore: restore,\n      getRng: getRng,\n      getBookmark: getBookmark$2,\n      validate: validate\n    };\n\n    var isEditorUIElement = function (elm) {\n      var className = elm.className.toString();\n      return className.indexOf('tox-') !== -1 || className.indexOf('mce-') !== -1;\n    };\n    var FocusManager = { isEditorUIElement: isEditorUIElement };\n\n    var isManualNodeChange = function (e) {\n      return e.type === 'nodechange' && e.selectionChange;\n    };\n    var registerPageMouseUp = function (editor, throttledStore) {\n      var mouseUpPage = function () {\n        throttledStore.throttle();\n      };\n      DOMUtils$1.DOM.bind(domGlobals.document, 'mouseup', mouseUpPage);\n      editor.on('remove', function () {\n        DOMUtils$1.DOM.unbind(domGlobals.document, 'mouseup', mouseUpPage);\n      });\n    };\n    var registerFocusOut = function (editor) {\n      editor.on('focusout', function () {\n        SelectionBookmark.store(editor);\n      });\n    };\n    var registerMouseUp = function (editor, throttledStore) {\n      editor.on('mouseup touchend', function (e) {\n        throttledStore.throttle();\n      });\n    };\n    var registerEditorEvents = function (editor, throttledStore) {\n      var browser = detect$3().browser;\n      if (browser.isIE()) {\n        registerFocusOut(editor);\n      } else {\n        registerMouseUp(editor, throttledStore);\n      }\n      editor.on('keyup NodeChange', function (e) {\n        if (!isManualNodeChange(e)) {\n          SelectionBookmark.store(editor);\n        }\n      });\n    };\n    var register = function (editor) {\n      var throttledStore = first(function () {\n        SelectionBookmark.store(editor);\n      }, 0);\n      editor.on('init', function () {\n        if (editor.inline) {\n          registerPageMouseUp(editor, throttledStore);\n        }\n        registerEditorEvents(editor, throttledStore);\n      });\n      editor.on('remove', function () {\n        throttledStore.cancel();\n      });\n    };\n    var SelectionRestore = { register: register };\n\n    var documentFocusInHandler;\n    var DOM$2 = DOMUtils$1.DOM;\n    var isEditorUIElement$1 = function (elm) {\n      return FocusManager.isEditorUIElement(elm);\n    };\n    var isEditorContentAreaElement = function (elm) {\n      var classList = elm.classList;\n      if (classList !== undefined) {\n        return classList.contains('tox-edit-area') || classList.contains('tox-edit-area__iframe') || classList.contains('mce-content-body');\n      } else {\n        return false;\n      }\n    };\n    var isUIElement = function (editor, elm) {\n      var customSelector = editor ? editor.settings.custom_ui_selector : '';\n      var parent = DOM$2.getParent(elm, function (elm) {\n        return isEditorUIElement$1(elm) || (customSelector ? editor.dom.is(elm, customSelector) : false);\n      });\n      return parent !== null;\n    };\n    var getActiveElement = function () {\n      try {\n        return domGlobals.document.activeElement;\n      } catch (ex) {\n        return domGlobals.document.body;\n      }\n    };\n    var registerEvents = function (editorManager, e) {\n      var editor = e.editor;\n      SelectionRestore.register(editor);\n      editor.on('focusin', function () {\n        var self = this;\n        var focusedEditor = editorManager.focusedEditor;\n        if (focusedEditor !== self) {\n          if (focusedEditor) {\n            focusedEditor.fire('blur', { focusedEditor: self });\n          }\n          editorManager.setActive(self);\n          editorManager.focusedEditor = self;\n          self.fire('focus', { blurredEditor: focusedEditor });\n          self.focus(true);\n        }\n      });\n      editor.on('focusout', function () {\n        var self = this;\n        Delay.setEditorTimeout(self, function () {\n          var focusedEditor = editorManager.focusedEditor;\n          if (!isUIElement(self, getActiveElement()) && focusedEditor === self) {\n            self.fire('blur', { focusedEditor: null });\n            editorManager.focusedEditor = null;\n          }\n        });\n      });\n      if (!documentFocusInHandler) {\n        documentFocusInHandler = function (e) {\n          var activeEditor = editorManager.activeEditor;\n          var target;\n          target = e.target;\n          if (activeEditor && target.ownerDocument === domGlobals.document) {\n            if (target !== domGlobals.document.body && !isUIElement(activeEditor, target) && editorManager.focusedEditor === activeEditor) {\n              activeEditor.fire('blur', { focusedEditor: null });\n              editorManager.focusedEditor = null;\n            }\n          }\n        };\n        DOM$2.bind(domGlobals.document, 'focusin', documentFocusInHandler);\n      }\n    };\n    var unregisterDocumentEvents = function (editorManager, e) {\n      if (editorManager.focusedEditor === e.editor) {\n        editorManager.focusedEditor = null;\n      }\n      if (!editorManager.activeEditor) {\n        DOM$2.unbind(domGlobals.document, 'focusin', documentFocusInHandler);\n        documentFocusInHandler = null;\n      }\n    };\n    var setup$2 = function (editorManager) {\n      editorManager.on('AddEditor', curry(registerEvents, editorManager));\n      editorManager.on('RemoveEditor', curry(unregisterDocumentEvents, editorManager));\n    };\n    var FocusController = {\n      setup: setup$2,\n      isEditorUIElement: isEditorUIElement$1,\n      isEditorContentAreaElement: isEditorContentAreaElement,\n      isUIElement: isUIElement\n    };\n\n    var getContentEditableHost = function (editor, node) {\n      return editor.dom.getParent(node, function (node) {\n        return editor.dom.getContentEditable(node) === 'true';\n      });\n    };\n    var getCollapsedNode = function (rng) {\n      return rng.collapsed ? Option.from(getNode(rng.startContainer, rng.startOffset)).map(Element.fromDom) : Option.none();\n    };\n    var getFocusInElement = function (root, rng) {\n      return getCollapsedNode(rng).bind(function (node) {\n        if (isTableSection(node)) {\n          return Option.some(node);\n        } else if (contains$2(root, node) === false) {\n          return Option.some(root);\n        } else {\n          return Option.none();\n        }\n      });\n    };\n    var normalizeSelection = function (editor, rng) {\n      getFocusInElement(Element.fromDom(editor.getBody()), rng).bind(function (elm) {\n        return CaretFinder.firstPositionIn(elm.dom());\n      }).fold(function () {\n        editor.selection.normalize();\n        return;\n      }, function (caretPos) {\n        return editor.selection.setRng(caretPos.toRange());\n      });\n    };\n    var focusBody = function (body) {\n      if (body.setActive) {\n        try {\n          body.setActive();\n        } catch (ex) {\n          body.focus();\n        }\n      } else {\n        body.focus();\n      }\n    };\n    var hasElementFocus = function (elm) {\n      return hasFocus(elm) || search(elm).isSome();\n    };\n    var hasIframeFocus = function (editor) {\n      return editor.iframeElement && hasFocus(Element.fromDom(editor.iframeElement));\n    };\n    var hasInlineFocus = function (editor) {\n      var rawBody = editor.getBody();\n      return rawBody && hasElementFocus(Element.fromDom(rawBody));\n    };\n    var hasUiFocus = function (editor) {\n      return active().filter(function (elem) {\n        return !FocusController.isEditorContentAreaElement(elem.dom()) && FocusController.isUIElement(editor, elem.dom());\n      }).isSome();\n    };\n    var hasFocus$1 = function (editor) {\n      return editor.inline ? hasInlineFocus(editor) : hasIframeFocus(editor);\n    };\n    var hasEditorOrUiFocus = function (editor) {\n      return hasFocus$1(editor) || hasUiFocus(editor);\n    };\n    var focusEditor = function (editor) {\n      var selection = editor.selection;\n      var body = editor.getBody();\n      var rng = selection.getRng();\n      editor.quirks.refreshContentEditable();\n      if (editor.bookmark !== undefined && hasFocus$1(editor) === false) {\n        SelectionBookmark.getRng(editor).each(function (bookmarkRng) {\n          editor.selection.setRng(bookmarkRng);\n          rng = bookmarkRng;\n        });\n      }\n      var contentEditableHost = getContentEditableHost(editor, selection.getNode());\n      if (editor.$.contains(body, contentEditableHost)) {\n        focusBody(contentEditableHost);\n        normalizeSelection(editor, rng);\n        activateEditor(editor);\n        return;\n      }\n      if (!editor.inline) {\n        if (!Env.opera) {\n          focusBody(body);\n        }\n        editor.getWin().focus();\n      }\n      if (Env.gecko || editor.inline) {\n        focusBody(body);\n        normalizeSelection(editor, rng);\n      }\n      activateEditor(editor);\n    };\n    var activateEditor = function (editor) {\n      return editor.editorManager.setActive(editor);\n    };\n    var focus = function (editor, skipFocus) {\n      if (editor.removed) {\n        return;\n      }\n      skipFocus ? activateEditor(editor) : focusEditor(editor);\n    };\n    var EditorFocus = {\n      focus: focus,\n      hasFocus: hasFocus$1,\n      hasEditorOrUiFocus: hasEditorOrUiFocus\n    };\n\n    var defaultFormat$1 = 'html';\n    var isTreeNode = function (content) {\n      return content instanceof Node$1;\n    };\n    var moveSelection = function (editor) {\n      if (EditorFocus.hasFocus(editor)) {\n        CaretFinder.firstPositionIn(editor.getBody()).each(function (pos) {\n          var node = pos.getNode();\n          var caretPos = NodeType.isTable(node) ? CaretFinder.firstPositionIn(node).getOr(pos) : pos;\n          editor.selection.setRng(caretPos.toRange());\n        });\n      }\n    };\n    var setEditorHtml = function (editor, html) {\n      editor.dom.setHTML(editor.getBody(), html);\n      moveSelection(editor);\n    };\n    var setContentString = function (editor, body, content, args) {\n      var forcedRootBlockName, padd;\n      if (content.length === 0 || /^\\s+$/.test(content)) {\n        padd = '<br data-mce-bogus=\"1\">';\n        if (body.nodeName === 'TABLE') {\n          content = '<tr><td>' + padd + '</td></tr>';\n        } else if (/^(UL|OL)$/.test(body.nodeName)) {\n          content = '<li>' + padd + '</li>';\n        }\n        forcedRootBlockName = Settings.getForcedRootBlock(editor);\n        if (forcedRootBlockName && editor.schema.isValidChild(body.nodeName.toLowerCase(), forcedRootBlockName.toLowerCase())) {\n          content = padd;\n          content = editor.dom.createHTML(forcedRootBlockName, editor.settings.forced_root_block_attrs, content);\n        } else if (!content) {\n          content = '<br data-mce-bogus=\"1\">';\n        }\n        setEditorHtml(editor, content);\n        editor.fire('SetContent', args);\n      } else {\n        if (args.format !== 'raw') {\n          content = Serializer({ validate: editor.validate }, editor.schema).serialize(editor.parser.parse(content, {\n            isRootContent: true,\n            insert: true\n          }));\n        }\n        args.content = isWsPreserveElement(Element.fromDom(body)) ? content : Tools.trim(content);\n        setEditorHtml(editor, args.content);\n        if (!args.no_events) {\n          editor.fire('SetContent', args);\n        }\n      }\n      return args.content;\n    };\n    var setContentTree = function (editor, body, content, args) {\n      filter$2(editor.parser.getNodeFilters(), editor.parser.getAttributeFilters(), content);\n      var html = Serializer({ validate: editor.validate }, editor.schema).serialize(content);\n      args.content = isWsPreserveElement(Element.fromDom(body)) ? html : Tools.trim(html);\n      setEditorHtml(editor, args.content);\n      if (!args.no_events) {\n        editor.fire('SetContent', args);\n      }\n      return content;\n    };\n    var setContent = function (editor, content, args) {\n      if (args === void 0) {\n        args = {};\n      }\n      args.format = args.format ? args.format : defaultFormat$1;\n      args.set = true;\n      args.content = isTreeNode(content) ? '' : content;\n      if (!isTreeNode(content) && !args.no_events) {\n        editor.fire('BeforeSetContent', args);\n        content = args.content;\n      }\n      return Option.from(editor.getBody()).fold(constant(content), function (body) {\n        return isTreeNode(content) ? setContentTree(editor, body, content, args) : setContentString(editor, body, content, args);\n      });\n    };\n\n    var firePreProcess = function (editor, args) {\n      return editor.fire('PreProcess', args);\n    };\n    var firePostProcess = function (editor, args) {\n      return editor.fire('PostProcess', args);\n    };\n    var fireRemove = function (editor) {\n      return editor.fire('remove');\n    };\n    var fireDetach = function (editor) {\n      return editor.fire('detach');\n    };\n    var fireSwitchMode = function (editor, mode) {\n      return editor.fire('SwitchMode', { mode: mode });\n    };\n    var fireObjectResizeStart = function (editor, target, width, height) {\n      editor.fire('ObjectResizeStart', {\n        target: target,\n        width: width,\n        height: height\n      });\n    };\n    var fireObjectResized = function (editor, target, width, height) {\n      editor.fire('ObjectResized', {\n        target: target,\n        width: width,\n        height: height\n      });\n    };\n    var firePreInit = function (editor) {\n      return editor.fire('PreInit');\n    };\n    var firePostRender = function (editor) {\n      return editor.fire('PostRender');\n    };\n    var fireInit = function (editor) {\n      return editor.fire('Init');\n    };\n    var firePlaceholderToggle = function (editor, state) {\n      return editor.fire('PlaceholderToggle', { state: state });\n    };\n    var fireError = function (editor, errorType, error) {\n      return editor.fire(errorType, error);\n    };\n\n    var DOM$3 = DOMUtils$1.DOM;\n    var restoreOriginalStyles = function (editor) {\n      DOM$3.setStyle(editor.id, 'display', editor.orgDisplay);\n    };\n    var safeDestroy = function (x) {\n      return Option.from(x).each(function (x) {\n        return x.destroy();\n      });\n    };\n    var clearDomReferences = function (editor) {\n      editor.contentAreaContainer = editor.formElement = editor.container = editor.editorContainer = null;\n      editor.bodyElement = editor.contentDocument = editor.contentWindow = null;\n      editor.iframeElement = editor.targetElm = null;\n      if (editor.selection) {\n        editor.selection = editor.selection.win = editor.selection.dom = editor.selection.dom.doc = null;\n      }\n    };\n    var restoreForm = function (editor) {\n      var form = editor.formElement;\n      if (form) {\n        if (form._mceOldSubmit) {\n          form.submit = form._mceOldSubmit;\n          form._mceOldSubmit = null;\n        }\n        DOM$3.unbind(form, 'submit reset', editor.formEventDelegate);\n      }\n    };\n    var remove$6 = function (editor) {\n      if (!editor.removed) {\n        var _selectionOverrides = editor._selectionOverrides, editorUpload = editor.editorUpload;\n        var body = editor.getBody();\n        var element = editor.getElement();\n        if (body) {\n          editor.save({ is_removing: true });\n        }\n        editor.removed = true;\n        editor.unbindAllNativeEvents();\n        if (editor.hasHiddenInput && element) {\n          DOM$3.remove(element.nextSibling);\n        }\n        fireRemove(editor);\n        editor.editorManager.remove(editor);\n        if (!editor.inline && body) {\n          restoreOriginalStyles(editor);\n        }\n        fireDetach(editor);\n        DOM$3.remove(editor.getContainer());\n        safeDestroy(_selectionOverrides);\n        safeDestroy(editorUpload);\n        editor.destroy();\n      }\n    };\n    var destroy = function (editor, automatic) {\n      var selection = editor.selection, dom = editor.dom;\n      if (editor.destroyed) {\n        return;\n      }\n      if (!automatic && !editor.removed) {\n        editor.remove();\n        return;\n      }\n      if (!automatic) {\n        editor.editorManager.off('beforeunload', editor._beforeUnload);\n        if (editor.theme && editor.theme.destroy) {\n          editor.theme.destroy();\n        }\n        safeDestroy(selection);\n        safeDestroy(dom);\n      }\n      restoreForm(editor);\n      clearDomReferences(editor);\n      editor.destroyed = true;\n    };\n\n    var hasOwnProperty$2 = Object.prototype.hasOwnProperty;\n    var deep$1 = function (old, nu) {\n      var bothObjects = isObject(old) && isObject(nu);\n      return bothObjects ? deepMerge(old, nu) : nu;\n    };\n    var baseMerge = function (merger) {\n      return function () {\n        var objects = new Array(arguments.length);\n        for (var i = 0; i < objects.length; i++) {\n          objects[i] = arguments[i];\n        }\n        if (objects.length === 0) {\n          throw new Error('Can\\'t merge zero objects');\n        }\n        var ret = {};\n        for (var j = 0; j < objects.length; j++) {\n          var curObject = objects[j];\n          for (var key in curObject) {\n            if (hasOwnProperty$2.call(curObject, key)) {\n              ret[key] = merger(ret[key], curObject[key]);\n            }\n          }\n        }\n        return ret;\n      };\n    };\n    var deepMerge = baseMerge(deep$1);\n\n    var sectionResult = Immutable('sections', 'settings');\n    var deviceDetection = detect$3().deviceType;\n    var isTouch = deviceDetection.isTouch();\n    var isPhone = deviceDetection.isPhone();\n    var isTablet = deviceDetection.isTablet();\n    var legacyMobilePlugins = [\n      'lists',\n      'autolink',\n      'autosave'\n    ];\n    var defaultTouchSettings = {\n      table_grid: false,\n      object_resizing: false,\n      resize: false\n    };\n    var normalizePlugins = function (plugins) {\n      var pluginNames = isArray(plugins) ? plugins.join(' ') : plugins;\n      var trimmedPlugins = map(isString(pluginNames) ? pluginNames.split(' ') : [], trim);\n      return filter(trimmedPlugins, function (item) {\n        return item.length > 0;\n      });\n    };\n    var filterLegacyMobilePlugins = function (plugins) {\n      return filter(plugins, curry(contains, legacyMobilePlugins));\n    };\n    var extractSections = function (keys, settings) {\n      var result = bifilter(settings, function (value, key) {\n        return contains(keys, key);\n      });\n      return sectionResult(result.t, result.f);\n    };\n    var getSection = function (sectionResult, name, defaults) {\n      if (defaults === void 0) {\n        defaults = {};\n      }\n      var sections = sectionResult.sections();\n      var sectionSettings = sections.hasOwnProperty(name) ? sections[name] : {};\n      return Tools.extend({}, defaults, sectionSettings);\n    };\n    var hasSection = function (sectionResult, name) {\n      return sectionResult.sections().hasOwnProperty(name);\n    };\n    var isSectionTheme = function (sectionResult, name, theme) {\n      var section = sectionResult.sections();\n      return hasSection(sectionResult, name) && section[name].theme === theme;\n    };\n    var getSectionConfig = function (sectionResult, name) {\n      return hasSection(sectionResult, name) ? sectionResult.sections()[name] : {};\n    };\n    var getToolbarMode = function (settings, defaultVal) {\n      return get(settings, 'toolbar_mode').orThunk(function () {\n        return get(settings, 'toolbar_drawer').map(function (val) {\n          return val === false ? 'wrap' : val;\n        });\n      }).getOr(defaultVal);\n    };\n    var getDefaultSettings = function (settings, id, documentBaseUrl, isTouch, editor) {\n      var baseDefaults = {\n        id: id,\n        theme: 'silver',\n        toolbar_mode: getToolbarMode(settings, 'floating'),\n        plugins: '',\n        document_base_url: documentBaseUrl,\n        add_form_submit_trigger: true,\n        submit_patch: true,\n        add_unload_trigger: true,\n        convert_urls: true,\n        relative_urls: true,\n        remove_script_host: true,\n        object_resizing: true,\n        doctype: '<!DOCTYPE html>',\n        visual: true,\n        font_size_legacy_values: 'xx-small,small,medium,large,x-large,xx-large,300%',\n        forced_root_block: 'p',\n        hidden_input: true,\n        inline_styles: true,\n        convert_fonts_to_spans: true,\n        indent: true,\n        indent_before: 'p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,' + 'tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist',\n        indent_after: 'p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,' + 'tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist',\n        entity_encoding: 'named',\n        url_converter: editor.convertURL,\n        url_converter_scope: editor\n      };\n      return __assign(__assign({}, baseDefaults), isTouch ? defaultTouchSettings : {});\n    };\n    var getDefaultMobileSettings = function (settings, isPhone) {\n      var defaultMobileSettings = {\n        resize: false,\n        toolbar_mode: getToolbarMode(settings, 'scrolling'),\n        toolbar_sticky: false\n      };\n      var defaultPhoneSettings = { menubar: false };\n      return __assign(__assign(__assign({}, defaultTouchSettings), defaultMobileSettings), isPhone ? defaultPhoneSettings : {});\n    };\n    var getExternalPlugins = function (overrideSettings, settings) {\n      var userDefinedExternalPlugins = settings.external_plugins ? settings.external_plugins : {};\n      if (overrideSettings && overrideSettings.external_plugins) {\n        return Tools.extend({}, overrideSettings.external_plugins, userDefinedExternalPlugins);\n      } else {\n        return userDefinedExternalPlugins;\n      }\n    };\n    var combinePlugins = function (forcedPlugins, plugins) {\n      return [].concat(normalizePlugins(forcedPlugins)).concat(normalizePlugins(plugins));\n    };\n    var processPlugins = function (isMobileDevice, sectionResult, defaultOverrideSettings, settings) {\n      var forcedPlugins = normalizePlugins(defaultOverrideSettings.forced_plugins);\n      var desktopPlugins = normalizePlugins(settings.plugins);\n      var mobileConfig = getSectionConfig(sectionResult, 'mobile');\n      var mobilePlugins = mobileConfig.plugins ? normalizePlugins(mobileConfig.plugins) : desktopPlugins;\n      var platformPlugins = isMobileDevice && isSectionTheme(sectionResult, 'mobile', 'mobile') ? filterLegacyMobilePlugins(mobilePlugins) : isMobileDevice && hasSection(sectionResult, 'mobile') ? mobilePlugins : desktopPlugins;\n      var combinedPlugins = combinePlugins(forcedPlugins, platformPlugins);\n      return Tools.extend(settings, { plugins: combinedPlugins.join(' ') });\n    };\n    var isOnMobile = function (isMobileDevice, sectionResult) {\n      return isMobileDevice && hasSection(sectionResult, 'mobile');\n    };\n    var combineSettings = function (isMobileDevice, isPhone, defaultSettings, defaultOverrideSettings, settings) {\n      var defaultDeviceSettings = isMobileDevice ? { mobile: getDefaultMobileSettings(settings, isPhone) } : {};\n      var sectionResult = extractSections(['mobile'], deepMerge(defaultDeviceSettings, settings));\n      var extendedSettings = Tools.extend(defaultSettings, defaultOverrideSettings, sectionResult.settings(), isOnMobile(isMobileDevice, sectionResult) ? getSection(sectionResult, 'mobile') : {}, {\n        validate: true,\n        external_plugins: getExternalPlugins(defaultOverrideSettings, sectionResult.settings())\n      });\n      return processPlugins(isMobileDevice, sectionResult, defaultOverrideSettings, extendedSettings);\n    };\n    var getEditorSettings = function (editor, id, documentBaseUrl, defaultOverrideSettings, settings) {\n      var defaultSettings = getDefaultSettings(settings, id, documentBaseUrl, isTouch, editor);\n      return combineSettings(isPhone || isTablet, isPhone, defaultSettings, defaultOverrideSettings, settings);\n    };\n    var getFiltered = function (predicate, editor, name) {\n      return Option.from(editor.settings[name]).filter(predicate);\n    };\n    var getParamObject = function (value) {\n      var output = {};\n      if (typeof value === 'string') {\n        each(value.indexOf('=') > 0 ? value.split(/[;,](?![^=;,]*(?:[;,]|$))/) : value.split(','), function (val) {\n          var arr = val.split('=');\n          if (arr.length > 1) {\n            output[Tools.trim(arr[0])] = Tools.trim(arr[1]);\n          } else {\n            output[Tools.trim(arr[0])] = Tools.trim(arr[0]);\n          }\n        });\n      } else {\n        output = value;\n      }\n      return output;\n    };\n    var isArrayOf = function (p) {\n      return function (a) {\n        return isArray(a) && forall(a, p);\n      };\n    };\n    var getParam = function (editor, name, defaultVal, type) {\n      var value = name in editor.settings ? editor.settings[name] : defaultVal;\n      if (type === 'hash') {\n        return getParamObject(value);\n      } else if (type === 'string') {\n        return getFiltered(isString, editor, name).getOr(defaultVal);\n      } else if (type === 'number') {\n        return getFiltered(isNumber, editor, name).getOr(defaultVal);\n      } else if (type === 'boolean') {\n        return getFiltered(isBoolean, editor, name).getOr(defaultVal);\n      } else if (type === 'object') {\n        return getFiltered(isObject, editor, name).getOr(defaultVal);\n      } else if (type === 'array') {\n        return getFiltered(isArray, editor, name).getOr(defaultVal);\n      } else if (type === 'string[]') {\n        return getFiltered(isArrayOf(isString), editor, name).getOr(defaultVal);\n      } else if (type === 'function') {\n        return getFiltered(isFunction, editor, name).getOr(defaultVal);\n      } else {\n        return value;\n      }\n    };\n\n    var CreateIconManager = function () {\n      var lookup = {};\n      var add = function (id, iconPack) {\n        lookup[id] = iconPack;\n      };\n      var get = function (id) {\n        if (lookup[id]) {\n          return lookup[id];\n        }\n        return { icons: {} };\n      };\n      var has$1 = function (id) {\n        return has(lookup, id);\n      };\n      return {\n        add: add,\n        get: get,\n        has: has$1\n      };\n    };\n    var IconManager = CreateIconManager();\n\n    var getProp = function (propName, elm) {\n      var rawElm = elm.dom();\n      return rawElm[propName];\n    };\n    var getComputedSizeProp = function (propName, elm) {\n      return parseInt(get$4(elm, propName), 10);\n    };\n    var getClientWidth = curry(getProp, 'clientWidth');\n    var getClientHeight = curry(getProp, 'clientHeight');\n    var getMarginTop = curry(getComputedSizeProp, 'margin-top');\n    var getMarginLeft = curry(getComputedSizeProp, 'margin-left');\n    var getBoundingClientRect$1 = function (elm) {\n      return elm.dom().getBoundingClientRect();\n    };\n    var isInsideElementContentArea = function (bodyElm, clientX, clientY) {\n      var clientWidth = getClientWidth(bodyElm);\n      var clientHeight = getClientHeight(bodyElm);\n      return clientX >= 0 && clientY >= 0 && clientX <= clientWidth && clientY <= clientHeight;\n    };\n    var transpose = function (inline, elm, clientX, clientY) {\n      var clientRect = getBoundingClientRect$1(elm);\n      var deltaX = inline ? clientRect.left + elm.dom().clientLeft + getMarginLeft(elm) : 0;\n      var deltaY = inline ? clientRect.top + elm.dom().clientTop + getMarginTop(elm) : 0;\n      var x = clientX - deltaX;\n      var y = clientY - deltaY;\n      return {\n        x: x,\n        y: y\n      };\n    };\n    var isXYInContentArea = function (editor, clientX, clientY) {\n      var bodyElm = Element.fromDom(editor.getBody());\n      var targetElm = editor.inline ? bodyElm : documentElement(bodyElm);\n      var transposedPoint = transpose(editor.inline, targetElm, clientX, clientY);\n      return isInsideElementContentArea(targetElm, transposedPoint.x, transposedPoint.y);\n    };\n    var fromDomSafe = function (node) {\n      return Option.from(node).map(Element.fromDom);\n    };\n    var isEditorAttachedToDom = function (editor) {\n      var rawContainer = editor.inline ? editor.getBody() : editor.getContentAreaContainer();\n      return fromDomSafe(rawContainer).map(function (container) {\n        return contains$2(owner(container), container);\n      }).getOr(false);\n    };\n    var EditorView = {\n      isXYInContentArea: isXYInContentArea,\n      isEditorAttachedToDom: isEditorAttachedToDom\n    };\n\n    function NotificationManagerImpl() {\n      var unimplemented = function () {\n        throw new Error('Theme did not provide a NotificationManager implementation.');\n      };\n      return {\n        open: unimplemented,\n        close: unimplemented,\n        reposition: unimplemented,\n        getArgs: unimplemented\n      };\n    }\n\n    function NotificationManager(editor) {\n      var notifications = [];\n      var getImplementation = function () {\n        var theme = editor.theme;\n        return theme && theme.getNotificationManagerImpl ? theme.getNotificationManagerImpl() : NotificationManagerImpl();\n      };\n      var getTopNotification = function () {\n        return Option.from(notifications[0]);\n      };\n      var isEqual = function (a, b) {\n        return a.type === b.type && a.text === b.text && !a.progressBar && !a.timeout && !b.progressBar && !b.timeout;\n      };\n      var reposition = function () {\n        if (notifications.length > 0) {\n          getImplementation().reposition(notifications);\n        }\n      };\n      var addNotification = function (notification) {\n        notifications.push(notification);\n      };\n      var closeNotification = function (notification) {\n        findIndex(notifications, function (otherNotification) {\n          return otherNotification === notification;\n        }).each(function (index) {\n          notifications.splice(index, 1);\n        });\n      };\n      var open = function (spec) {\n        if (editor.removed || !EditorView.isEditorAttachedToDom(editor)) {\n          return;\n        }\n        return find(notifications, function (notification) {\n          return isEqual(getImplementation().getArgs(notification), spec);\n        }).getOrThunk(function () {\n          editor.editorManager.setActive(editor);\n          var notification = getImplementation().open(spec, function () {\n            closeNotification(notification);\n            reposition();\n          });\n          addNotification(notification);\n          reposition();\n          return notification;\n        });\n      };\n      var close = function () {\n        getTopNotification().each(function (notification) {\n          getImplementation().close(notification);\n          closeNotification(notification);\n          reposition();\n        });\n      };\n      var getNotifications = function () {\n        return notifications;\n      };\n      var registerEvents = function (editor) {\n        editor.on('SkinLoaded', function () {\n          var serviceMessage = editor.settings.service_message;\n          if (serviceMessage) {\n            open({\n              text: serviceMessage,\n              type: 'warning',\n              timeout: 0\n            });\n          }\n        });\n        editor.on('ResizeEditor ResizeWindow NodeChange', function () {\n          Delay.requestAnimationFrame(reposition);\n        });\n        editor.on('remove', function () {\n          each(notifications.slice(), function (notification) {\n            getImplementation().close(notification);\n          });\n        });\n      };\n      registerEvents(editor);\n      return {\n        open: open,\n        close: close,\n        getNotifications: getNotifications\n      };\n    }\n\n    var PluginManager = AddOnManager$1.PluginManager;\n\n    var ThemeManager = AddOnManager$1.ThemeManager;\n\n    function WindowManagerImpl () {\n      var unimplemented = function () {\n        throw new Error('Theme did not provide a WindowManager implementation.');\n      };\n      return {\n        open: unimplemented,\n        openUrl: unimplemented,\n        alert: unimplemented,\n        confirm: unimplemented,\n        close: unimplemented,\n        getParams: unimplemented,\n        setParams: unimplemented\n      };\n    }\n\n    var WindowManager = function (editor) {\n      var dialogs = [];\n      var getImplementation = function () {\n        var theme = editor.theme;\n        return theme && theme.getWindowManagerImpl ? theme.getWindowManagerImpl() : WindowManagerImpl();\n      };\n      var funcBind = function (scope, f) {\n        return function () {\n          return f ? f.apply(scope, arguments) : undefined;\n        };\n      };\n      var fireOpenEvent = function (dialog) {\n        editor.fire('OpenWindow', { dialog: dialog });\n      };\n      var fireCloseEvent = function (dialog) {\n        editor.fire('CloseWindow', { dialog: dialog });\n      };\n      var addDialog = function (dialog) {\n        dialogs.push(dialog);\n        fireOpenEvent(dialog);\n      };\n      var closeDialog = function (dialog) {\n        fireCloseEvent(dialog);\n        dialogs = filter(dialogs, function (otherDialog) {\n          return otherDialog !== dialog;\n        });\n        if (dialogs.length === 0) {\n          editor.focus();\n        }\n      };\n      var getTopDialog = function () {\n        return Option.from(dialogs[dialogs.length - 1]);\n      };\n      var storeSelectionAndOpenDialog = function (openDialog) {\n        editor.editorManager.setActive(editor);\n        SelectionBookmark.store(editor);\n        var dialog = openDialog();\n        addDialog(dialog);\n        return dialog;\n      };\n      var open = function (args, params) {\n        return storeSelectionAndOpenDialog(function () {\n          return getImplementation().open(args, params, closeDialog);\n        });\n      };\n      var openUrl = function (args) {\n        return storeSelectionAndOpenDialog(function () {\n          return getImplementation().openUrl(args, closeDialog);\n        });\n      };\n      var alert = function (message, callback, scope) {\n        getImplementation().alert(message, funcBind(scope ? scope : this, callback));\n      };\n      var confirm = function (message, callback, scope) {\n        getImplementation().confirm(message, funcBind(scope ? scope : this, callback));\n      };\n      var close = function () {\n        getTopDialog().each(function (dialog) {\n          getImplementation().close(dialog);\n          closeDialog(dialog);\n        });\n      };\n      editor.on('remove', function () {\n        each(dialogs, function (dialog) {\n          getImplementation().close(dialog);\n        });\n      });\n      return {\n        open: open,\n        openUrl: openUrl,\n        alert: alert,\n        confirm: confirm,\n        close: close\n      };\n    };\n\n    var displayNotification = function (editor, message) {\n      editor.notificationManager.open({\n        type: 'error',\n        text: message\n      });\n    };\n    var displayError = function (editor, message) {\n      if (editor._skinLoaded) {\n        displayNotification(editor, message);\n      } else {\n        editor.on('SkinLoaded', function () {\n          displayNotification(editor, message);\n        });\n      }\n    };\n    var uploadError = function (editor, message) {\n      displayError(editor, I18n.translate([\n        'Failed to upload image: {0}',\n        message\n      ]));\n    };\n    var logError = function (editor, errorType, msg) {\n      fireError(editor, errorType, { message: msg });\n      domGlobals.console.error(msg);\n    };\n    var createLoadError = function (type, url, name) {\n      return name ? 'Failed to load ' + type + ': ' + name + ' from url ' + url : 'Failed to load ' + type + ' url: ' + url;\n    };\n    var pluginLoadError = function (editor, url, name) {\n      logError(editor, 'PluginLoadError', createLoadError('plugin', url, name));\n    };\n    var iconsLoadError = function (editor, url, name) {\n      logError(editor, 'IconsLoadError', createLoadError('icons', url, name));\n    };\n    var languageLoadError = function (editor, url, name) {\n      logError(editor, 'LanguageLoadError', createLoadError('language', url, name));\n    };\n    var pluginInitError = function (editor, name, err) {\n      var message = I18n.translate([\n        'Failed to initialize plugin: {0}',\n        name\n      ]);\n      initError(message, err);\n      displayError(editor, message);\n    };\n    var initError = function (message) {\n      var x = [];\n      for (var _i = 1; _i < arguments.length; _i++) {\n        x[_i - 1] = arguments[_i];\n      }\n      var console = domGlobals.window.console;\n      if (console) {\n        if (console.error) {\n          console.error.apply(console, arguments);\n        } else {\n          console.log.apply(console, arguments);\n        }\n      }\n    };\n    var ErrorReporter = {\n      pluginLoadError: pluginLoadError,\n      iconsLoadError: iconsLoadError,\n      languageLoadError: languageLoadError,\n      pluginInitError: pluginInitError,\n      uploadError: uploadError,\n      displayError: displayError,\n      initError: initError\n    };\n\n    var getAll = function () {\n      return {\n        'accessibility-check': '<svg width=\"24\" height=\"24\"><path d=\"M12 2a2 2 0 0 1 2 2 2 2 0 0 1-2 2 2 2 0 0 1-2-2c0-1.1.9-2 2-2zm8 7h-5v12c0 .6-.4 1-1 1a1 1 0 0 1-1-1v-5c0-.6-.4-1-1-1a1 1 0 0 0-1 1v5c0 .6-.4 1-1 1a1 1 0 0 1-1-1V9H4a1 1 0 1 1 0-2h16c.6 0 1 .4 1 1s-.4 1-1 1z\" fill-rule=\"nonzero\"/></svg>',\n        'action-next': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M5.7 7.3a1 1 0 0 0-1.4 1.4l7.7 7.7 7.7-7.7a1 1 0 1 0-1.4-1.4L12 13.6 5.7 7.3z\"/></svg>',\n        'action-prev': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M18.3 15.7a1 1 0 0 0 1.4-1.4L12 6.6l-7.7 7.7a1 1 0 0 0 1.4 1.4L12 9.4l6.3 6.3z\"/></svg>',\n        'align-center': '<svg width=\"24\" height=\"24\"><path d=\"M5 5h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 1 1 0-2zm3 4h8c.6 0 1 .4 1 1s-.4 1-1 1H8a1 1 0 1 1 0-2zm0 8h8c.6 0 1 .4 1 1s-.4 1-1 1H8a1 1 0 0 1 0-2zm-3-4h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 0 1 0-2z\" fill-rule=\"evenodd\"/></svg>',\n        'align-justify': '<svg width=\"24\" height=\"24\"><path d=\"M5 5h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 1 1 0-2zm0 4h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 1 1 0-2zm0 4h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 0 1 0-2zm0 4h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 0 1 0-2z\" fill-rule=\"evenodd\"/></svg>',\n        'align-left': '<svg width=\"24\" height=\"24\"><path d=\"M5 5h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 1 1 0-2zm0 4h8c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 1 1 0-2zm0 8h8c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 0 1 0-2zm0-4h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 0 1 0-2z\" fill-rule=\"evenodd\"/></svg>',\n        'align-none': '<svg width=\"24\" height=\"24\"><path d=\"M14.2 5L13 7H5a1 1 0 1 1 0-2h9.2zm4 0h.8a1 1 0 0 1 0 2h-2l1.2-2zm-6.4 4l-1.2 2H5a1 1 0 0 1 0-2h6.8zm4 0H19a1 1 0 0 1 0 2h-4.4l1.2-2zm-6.4 4l-1.2 2H5a1 1 0 0 1 0-2h4.4zm4 0H19a1 1 0 0 1 0 2h-6.8l1.2-2zM7 17l-1.2 2H5a1 1 0 0 1 0-2h2zm4 0h8a1 1 0 0 1 0 2H9.8l1.2-2zm5.2-13.5l1.3.7-9.7 16.3-1.3-.7 9.7-16.3z\" fill-rule=\"evenodd\"/></svg>',\n        'align-right': '<svg width=\"24\" height=\"24\"><path d=\"M5 5h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 1 1 0-2zm6 4h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zm0 8h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zm-6-4h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 0 1 0-2z\" fill-rule=\"evenodd\"/></svg>',\n        'arrow-left': '<svg width=\"24\" height=\"24\"><path d=\"M5.6 13l12 6a1 1 0 0 0 1.4-1V6a1 1 0 0 0-1.4-.9l-12 6a1 1 0 0 0 0 1.8z\" fill-rule=\"evenodd\"/></svg>',\n        'arrow-right': '<svg width=\"24\" height=\"24\"><path d=\"M18.5 13l-12 6A1 1 0 0 1 5 18V6a1 1 0 0 1 1.4-.9l12 6a1 1 0 0 1 0 1.8z\" fill-rule=\"evenodd\"/></svg>',\n        'bold': '<svg width=\"24\" height=\"24\"><path d=\"M7.8 19c-.3 0-.5 0-.6-.2l-.2-.5V5.7c0-.2 0-.4.2-.5l.6-.2h5c1.5 0 2.7.3 3.5 1 .7.6 1.1 1.4 1.1 2.5a3 3 0 0 1-.6 1.9c-.4.6-1 1-1.6 1.2.4.1.9.3 1.3.6s.8.7 1 1.2c.4.4.5 1 .5 1.6 0 1.3-.4 2.3-1.3 3-.8.7-2.1 1-3.8 1H7.8zm5-8.3c.6 0 1.2-.1 1.6-.5.4-.3.6-.7.6-1.3 0-1.1-.8-1.7-2.3-1.7H9.3v3.5h3.4zm.5 6c.7 0 1.3-.1 1.7-.4.4-.4.6-.9.6-1.5s-.2-1-.7-1.4c-.4-.3-1-.4-2-.4H9.4v3.8h4z\" fill-rule=\"evenodd\"/></svg>',\n        'bookmark': '<svg width=\"24\" height=\"24\"><path d=\"M6 4v17l6-4 6 4V4c0-.6-.4-1-1-1H7a1 1 0 0 0-1 1z\" fill-rule=\"nonzero\"/></svg>',\n        'border-width': '<svg width=\"24\" height=\"24\"><path d=\"M5 14.8h14a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2zm-.5 3.7h15c.3 0 .5.2.5.5s-.2.5-.5.5h-15a.5.5 0 1 1 0-1zm.5-8.3h14c.6 0 1 .4 1 1v1c0 .5-.4 1-1 1H5a1 1 0 0 1-1-1v-1c0-.6.4-1 1-1zm0-5.7h14c.6 0 1 .4 1 1v2c0 .6-.4 1-1 1H5a1 1 0 0 1-1-1v-2c0-.6.4-1 1-1z\" fill-rule=\"evenodd\"/></svg>',\n        'brightness': '<svg width=\"24\" height=\"24\"><path d=\"M12 17c.3 0 .5.1.7.3.2.2.3.4.3.7v1c0 .3-.1.5-.3.7a1 1 0 0 1-.7.3 1 1 0 0 1-.7-.3 1 1 0 0 1-.3-.7v-1c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3zm0-10a1 1 0 0 1-.7-.3A1 1 0 0 1 11 6V5c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3.3 0 .5.1.7.3.2.2.3.4.3.7v1c0 .3-.1.5-.3.7a1 1 0 0 1-.7.3zm7 4c.3 0 .5.1.7.3.2.2.3.4.3.7 0 .3-.1.5-.3.7a1 1 0 0 1-.7.3h-1a1 1 0 0 1-.7-.3 1 1 0 0 1-.3-.7c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3h1zM7 12c0 .3-.1.5-.3.7a1 1 0 0 1-.7.3H5a1 1 0 0 1-.7-.3A1 1 0 0 1 4 12c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3h1c.3 0 .5.1.7.3.2.2.3.4.3.7zm10 3.5l.7.8c.2.1.3.4.3.6 0 .3-.1.6-.3.8a1 1 0 0 1-.8.3 1 1 0 0 1-.6-.3l-.8-.7a1 1 0 0 1-.3-.8c0-.2.1-.5.3-.7a1 1 0 0 1 1.4 0zm-10-7l-.7-.8a1 1 0 0 1-.3-.6c0-.3.1-.6.3-.8.2-.2.5-.3.8-.3.2 0 .5.1.7.3l.7.7c.2.2.3.5.3.8 0 .2-.1.5-.3.7a1 1 0 0 1-.7.3 1 1 0 0 1-.8-.3zm10 0a1 1 0 0 1-.8.3 1 1 0 0 1-.7-.3 1 1 0 0 1-.3-.7c0-.3.1-.6.3-.8l.8-.7c.1-.2.4-.3.6-.3.3 0 .6.1.8.3.2.2.3.5.3.8 0 .2-.1.5-.3.7l-.7.7zm-10 7c.2-.2.5-.3.8-.3.2 0 .5.1.7.3a1 1 0 0 1 0 1.4l-.8.8a1 1 0 0 1-.6.3 1 1 0 0 1-.8-.3 1 1 0 0 1-.3-.8c0-.2.1-.5.3-.6l.7-.8zM12 8a4 4 0 0 1 3.7 2.4 4 4 0 0 1 0 3.2A4 4 0 0 1 12 16a4 4 0 0 1-3.7-2.4 4 4 0 0 1 0-3.2A4 4 0 0 1 12 8zm0 6.5c.7 0 1.3-.2 1.8-.7.5-.5.7-1.1.7-1.8s-.2-1.3-.7-1.8c-.5-.5-1.1-.7-1.8-.7s-1.3.2-1.8.7c-.5.5-.7 1.1-.7 1.8s.2 1.3.7 1.8c.5.5 1.1.7 1.8.7z\" fill-rule=\"evenodd\"/></svg>',\n        'browse': '<svg width=\"24\" height=\"24\"><path d=\"M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2h-4v-2h4V8H5v10h4v2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zm-8 9.4l-2.3 2.3a1 1 0 1 1-1.4-1.4l4-4a1 1 0 0 1 1.4 0l4 4a1 1 0 0 1-1.4 1.4L13 13.4V20a1 1 0 0 1-2 0v-6.6z\" fill-rule=\"nonzero\"/></svg>',\n        'cancel': '<svg width=\"24\" height=\"24\"><path d=\"M12 4.6a7.4 7.4 0 1 1 0 14.8 7.4 7.4 0 0 1 0-14.8zM12 3a9 9 0 1 0 0 18 9 9 0 0 0 0-18zm0 8L14.8 8l1 1.1-2.7 2.8 2.7 2.7-1.1 1.1-2.7-2.7-2.7 2.7-1-1.1 2.6-2.7-2.7-2.7 1-1.1 2.8 2.7z\" fill-rule=\"nonzero\"/></svg>',\n        'change-case': '<svg width=\"24\" height=\"24\"><path d=\"M18.4 18.2v-.6c-.5.8-1.3 1.2-2.4 1.2-2.2 0-3.3-1.6-3.3-4.8 0-3.1 1-4.7 3.3-4.7 1.1 0 1.8.3 2.4 1.1v-.6c0-.5.4-.8.8-.8s.8.3.8.8v8.4c0 .5-.4.8-.8.8a.8.8 0 0 1-.8-.8zm-2-7.4c-1.3 0-1.8.9-1.8 3.2 0 2.4.5 3.3 1.7 3.3 1.3 0 1.8-.9 1.8-3.2 0-2.4-.5-3.3-1.7-3.3zM10 15.7H5.5l-.8 2.6a1 1 0 0 1-1 .7h-.2a.7.7 0 0 1-.7-1l4-12a1 1 0 1 1 2 0l4 12a.7.7 0 0 1-.8 1h-.2a1 1 0 0 1-1-.7l-.8-2.6zm-.3-1.5l-2-6.5-1.9 6.5h3.9z\" fill-rule=\"evenodd\"/></svg>',\n        'character-count': '<svg width=\"24\" height=\"24\"><path d=\"M4 11.5h16v1H4v-1zm4.8-6.8V10H7.7V5.8h-1v-1h2zM11 8.3V9h2v1h-3V7.7l2-1v-.9h-2v-1h3v2.4l-2 1zm6.3-3.4V10h-3.1V9h2.1V8h-2.1V6.8h2.1v-1h-2.1v-1h3.1zM5.8 16.4c0-.5.2-.8.5-1 .2-.2.6-.3 1.2-.3l.8.1c.2 0 .4.2.5.3l.4.4v2.8l.2.3H8.2v-.1-.2l-.6.3H7c-.4 0-.7 0-1-.2a1 1 0 0 1-.3-.9c0-.3 0-.6.3-.8.3-.2.7-.4 1.2-.4l.6-.2h.3v-.2l-.1-.2a.8.8 0 0 0-.5-.1 1 1 0 0 0-.4 0l-.3.4h-1zm2.3.8h-.2l-.2.1-.4.1a1 1 0 0 0-.4.2l-.2.2.1.3.5.1h.4l.4-.4v-.6zm2-3.4h1.2v1.7l.5-.3h.5c.5 0 .9.1 1.2.5.3.4.5.8.5 1.4 0 .6-.2 1.1-.5 1.5-.3.4-.7.6-1.3.6l-.6-.1-.4-.4v.4h-1.1v-5.4zm1.1 3.3c0 .3 0 .6.2.8a.7.7 0 0 0 1.2 0l.2-.8c0-.4 0-.6-.2-.8a.7.7 0 0 0-.6-.3l-.6.3-.2.8zm6.1-.5c0-.2 0-.3-.2-.4a.8.8 0 0 0-.5-.2c-.3 0-.5.1-.6.3l-.2.9c0 .3 0 .6.2.8.1.2.3.3.6.3.2 0 .4 0 .5-.2l.2-.4h1.1c0 .5-.3.8-.6 1.1a2 2 0 0 1-1.3.4c-.5 0-1-.2-1.3-.6a2 2 0 0 1-.5-1.4c0-.6.1-1.1.5-1.5.3-.4.8-.5 1.4-.5.5 0 1 0 1.2.3.4.3.5.7.5 1.2h-1v-.1z\" fill-rule=\"evenodd\"/></svg>',\n        'checklist-rtl': '<svg width=\"24\" height=\"24\"><path d=\"M5 17h8c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 0 1 0-2zm0-6h8c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 0 1 0-2zm0-6h8c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 1 1 0-2zm14.2 11c.2-.4.6-.5.9-.3.3.2.4.6.2 1L18 20c-.2.3-.7.4-1 0l-1.3-1.3a.7.7 0 0 1 0-1c.3-.2.7-.2 1 0l.7.9 1.7-2.8zm0-6c.2-.4.6-.5.9-.3.3.2.4.6.2 1L18 14c-.2.3-.7.4-1 0l-1.3-1.3a.7.7 0 0 1 0-1c.3-.2.7-.2 1 0l.7.9 1.7-2.8zm0-6c.2-.4.6-.5.9-.3.3.2.4.6.2 1L18 8c-.2.3-.7.4-1 0l-1.3-1.3a.7.7 0 0 1 0-1c.3-.2.7-.2 1 0l.7.9 1.7-2.8z\" fill-rule=\"evenodd\"/></svg>',\n        'checklist': '<svg width=\"24\" height=\"24\"><path d=\"M11 17h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zm0-6h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zm0-6h8a1 1 0 0 1 0 2h-8a1 1 0 0 1 0-2zM7.2 16c.2-.4.6-.5.9-.3.3.2.4.6.2 1L6 20c-.2.3-.7.4-1 0l-1.3-1.3a.7.7 0 0 1 0-1c.3-.2.7-.2 1 0l.7.9 1.7-2.8zm0-6c.2-.4.6-.5.9-.3.3.2.4.6.2 1L6 14c-.2.3-.7.4-1 0l-1.3-1.3a.7.7 0 0 1 0-1c.3-.2.7-.2 1 0l.7.9 1.7-2.8zm0-6c.2-.4.6-.5.9-.3.3.2.4.6.2 1L6 8c-.2.3-.7.4-1 0L3.8 6.9a.7.7 0 0 1 0-1c.3-.2.7-.2 1 0l.7.9 1.7-2.8z\" fill-rule=\"evenodd\"/></svg>',\n        'checkmark': '<svg width=\"24\" height=\"24\"><path d=\"M18.2 5.4a1 1 0 0 1 1.6 1.2l-8 12a1 1 0 0 1-1.5.1l-5-5a1 1 0 1 1 1.4-1.4l4.1 4.1 7.4-11z\" fill-rule=\"nonzero\"/></svg>',\n        'chevron-down': '<svg width=\"10\" height=\"10\"><path d=\"M8.7 2.2c.3-.3.8-.3 1 0 .4.4.4.9 0 1.2L5.7 7.8c-.3.3-.9.3-1.2 0L.2 3.4a.8.8 0 0 1 0-1.2c.3-.3.8-.3 1.1 0L5 6l3.7-3.8z\" fill-rule=\"nonzero\"/></svg>',\n        'chevron-left': '<svg width=\"10\" height=\"10\"><path d=\"M7.8 1.3L4 5l3.8 3.7c.3.3.3.8 0 1-.4.4-.9.4-1.2 0L2.2 5.7a.8.8 0 0 1 0-1.2L6.6.2C7 0 7.4 0 7.8.2c.3.3.3.8 0 1.1z\" fill-rule=\"nonzero\"/></svg>',\n        'chevron-right': '<svg width=\"10\" height=\"10\"><path d=\"M2.2 1.3a.8.8 0 0 1 0-1c.4-.4.9-.4 1.2 0l4.4 4.1c.3.4.3.9 0 1.2L3.4 9.8c-.3.3-.8.3-1.2 0a.8.8 0 0 1 0-1.1L6 5 2.2 1.3z\" fill-rule=\"nonzero\"/></svg>',\n        'chevron-up': '<svg width=\"10\" height=\"10\"><path d=\"M8.7 7.8L5 4 1.3 7.8c-.3.3-.8.3-1 0a.8.8 0 0 1 0-1.2l4.1-4.4c.3-.3.9-.3 1.2 0l4.2 4.4c.3.3.3.9 0 1.2-.3.3-.8.3-1.1 0z\" fill-rule=\"nonzero\"/></svg>',\n        'close': '<svg width=\"24\" height=\"24\"><path d=\"M17.3 8.2L13.4 12l3.9 3.8a1 1 0 0 1-1.5 1.5L12 13.4l-3.8 3.9a1 1 0 0 1-1.5-1.5l3.9-3.8-3.9-3.8a1 1 0 0 1 1.5-1.5l3.8 3.9 3.8-3.9a1 1 0 0 1 1.5 1.5z\" fill-rule=\"evenodd\"/></svg>',\n        'code-sample': '<svg width=\"24\" height=\"26\"><path d=\"M7.1 11a2.8 2.8 0 0 1-.8 2 2.8 2.8 0 0 1 .8 2v1.7c0 .3.1.6.4.8.2.3.5.4.8.4.3 0 .4.2.4.4v.8c0 .2-.1.4-.4.4-.7 0-1.4-.3-2-.8-.5-.6-.8-1.3-.8-2V15c0-.3-.1-.6-.4-.8-.2-.3-.5-.4-.8-.4a.4.4 0 0 1-.4-.4v-.8c0-.2.2-.4.4-.4.3 0 .6-.1.8-.4.3-.2.4-.5.4-.8V9.3c0-.7.3-1.4.8-2 .6-.5 1.3-.8 2-.8.3 0 .4.2.4.4v.8c0 .2-.1.4-.4.4-.3 0-.6.1-.8.4-.3.2-.4.5-.4.8V11zm9.8 0V9.3c0-.3-.1-.6-.4-.8-.2-.3-.5-.4-.8-.4a.4.4 0 0 1-.4-.4V7c0-.2.1-.4.4-.4.7 0 1.4.3 2 .8.5.6.8 1.3.8 2V11c0 .3.1.6.4.8.2.3.5.4.8.4.2 0 .4.2.4.4v.8c0 .2-.2.4-.4.4-.3 0-.6.1-.8.4-.3.2-.4.5-.4.8v1.7c0 .7-.3 1.4-.8 2-.6.5-1.3.8-2 .8a.4.4 0 0 1-.4-.4v-.8c0-.2.1-.4.4-.4.3 0 .6-.1.8-.4.3-.2.4-.5.4-.8V15a2.8 2.8 0 0 1 .8-2 2.8 2.8 0 0 1-.8-2zm-3.3-.4c0 .4-.1.8-.5 1.1-.3.3-.7.5-1.1.5-.4 0-.8-.2-1.1-.5-.4-.3-.5-.7-.5-1.1 0-.5.1-.9.5-1.2.3-.3.7-.4 1.1-.4.4 0 .8.1 1.1.4.4.3.5.7.5 1.2zM12 13c.4 0 .8.1 1.1.5.4.3.5.7.5 1.1 0 1-.1 1.6-.5 2a3 3 0 0 1-1.1 1c-.4.3-.8.4-1.1.4a.5.5 0 0 1-.5-.5V17a3 3 0 0 0 1-.2l.6-.6c-.6 0-1-.2-1.3-.5-.2-.3-.3-.7-.3-1 0-.5.1-1 .5-1.2.3-.4.7-.5 1.1-.5z\" fill-rule=\"evenodd\"/></svg>',\n        'color-levels': '<svg width=\"24\" height=\"24\"><path d=\"M17.5 11.4A9 9 0 0 1 18 14c0 .5 0 1-.2 1.4 0 .4-.3.9-.5 1.3a6.2 6.2 0 0 1-3.7 3 5.7 5.7 0 0 1-3.2 0A5.9 5.9 0 0 1 7.6 18a6.2 6.2 0 0 1-1.4-2.6 6.7 6.7 0 0 1 0-2.8c0-.4.1-.9.3-1.3a13.6 13.6 0 0 1 2.3-4A20 20 0 0 1 12 4a26.4 26.4 0 0 1 3.2 3.4 18.2 18.2 0 0 1 2.3 4zm-2 4.5c.4-.7.5-1.4.5-2a7.3 7.3 0 0 0-1-3.2c.2.6.2 1.2.2 1.9a4.5 4.5 0 0 1-1.3 3 5.3 5.3 0 0 1-2.3 1.5 4.9 4.9 0 0 1-2 .1 4.3 4.3 0 0 0 2.4.8 4 4 0 0 0 2-.6 4 4 0 0 0 1.5-1.5z\" fill-rule=\"evenodd\"/></svg>',\n        'color-picker': '<svg width=\"24\" height=\"24\"><path d=\"M12 3a9 9 0 0 0 0 18 1.5 1.5 0 0 0 1.1-2.5c-.2-.3-.4-.6-.4-1 0-.8.7-1.5 1.5-1.5H16a5 5 0 0 0 5-5c0-4.4-4-8-9-8zm-5.5 9a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm3-4a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm3 4a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z\" fill-rule=\"nonzero\"/></svg>',\n        'color-swatch-remove-color': '<svg width=\"24\" height=\"24\"><path stroke=\"#000\" stroke-width=\"2\" d=\"M21 3L3 21\" fill-rule=\"evenodd\"/></svg>',\n        'color-swatch': '<svg width=\"24\" height=\"24\"><rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"1\" fill-rule=\"evenodd\"/></svg>',\n        'comment-add': '<svg width=\"24\" height=\"24\"><g fill-rule=\"nonzero\"><path d=\"M9 19l3-2h7c.6 0 1-.4 1-1V6c0-.6-.4-1-1-1H5a1 1 0 0 0-1 1v10c0 .6.4 1 1 1h4v2zm-2 4v-4H5a3 3 0 0 1-3-3V6a3 3 0 0 1 3-3h14a3 3 0 0 1 3 3v10a3 3 0 0 1-3 3h-6.4L7 23z\"/><path d=\"M13 10h2a1 1 0 0 1 0 2h-2v2a1 1 0 0 1-2 0v-2H9a1 1 0 0 1 0-2h2V8a1 1 0 0 1 2 0v2z\"/></g></svg>',\n        'comment': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M9 19l3-2h7c.6 0 1-.4 1-1V6c0-.6-.4-1-1-1H5a1 1 0 0 0-1 1v10c0 .6.4 1 1 1h4v2zm-2 4v-4H5a3 3 0 0 1-3-3V6a3 3 0 0 1 3-3h14a3 3 0 0 1 3 3v10a3 3 0 0 1-3 3h-6.4L7 23z\"/></svg>',\n        'contrast': '<svg width=\"24\" height=\"24\"><path d=\"M12 4a7.8 7.8 0 0 1 5.7 2.3A8 8 0 1 1 12 4zm-6 8a6 6 0 0 0 6 6V6a6 6 0 0 0-6 6z\" fill-rule=\"evenodd\"/></svg>',\n        'copy': '<svg width=\"24\" height=\"24\"><path d=\"M16 3H6a2 2 0 0 0-2 2v11h2V5h10V3zm1 4a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-7a2 2 0 0 1-2-2V9c0-1.2.9-2 2-2h7zm0 12V9h-7v10h7z\" fill-rule=\"nonzero\"/></svg>',\n        'crop': '<svg width=\"24\" height=\"24\"><path d=\"M17 8v7h2c.6 0 1 .4 1 1s-.4 1-1 1h-2v2c0 .6-.4 1-1 1a1 1 0 0 1-1-1v-2H7V9H5a1 1 0 1 1 0-2h2V5c0-.6.4-1 1-1s1 .4 1 1v2h7l3-3 1 1-3 3zM9 9v5l5-5H9zm1 6h5v-5l-5 5z\" fill-rule=\"evenodd\"/></svg>',\n        'cut': '<svg width=\"24\" height=\"24\"><path d=\"M18 15c.6.7 1 1.4 1 2.3 0 .8-.2 1.5-.7 2l-.8.5-1 .2c-.4 0-.8 0-1.2-.3a3.9 3.9 0 0 1-2.1-2.2c-.2-.5-.3-1-.2-1.5l-1-1-1 1c0 .5 0 1-.2 1.5-.1.5-.4 1-.9 1.4-.3.4-.7.6-1.2.8l-1.2.3c-.4 0-.7 0-1-.2-.3 0-.6-.3-.8-.5-.5-.5-.8-1.2-.7-2 0-.9.4-1.6 1-2.2A3.7 3.7 0 0 1 8.6 14H9l1-1-4-4-.5-1a3.3 3.3 0 0 1 0-2c0-.4.3-.7.5-1l6 6 6-6 .5 1a3.3 3.3 0 0 1 0 2c0 .4-.3.7-.5 1l-4 4 1 1h.5c.4 0 .8 0 1.2.3.5.2.9.4 1.2.8zm-8.5 2.2l.1-.4v-.3-.4a1 1 0 0 0-.2-.5 1 1 0 0 0-.4-.2 1.6 1.6 0 0 0-.8 0 2.6 2.6 0 0 0-.8.3 2.5 2.5 0 0 0-.9 1.1l-.1.4v.7l.2.5.5.2h.7a2.5 2.5 0 0 0 .8-.3 2.8 2.8 0 0 0 1-1zm2.5-2.8c.4 0 .7-.1 1-.4.3-.3.4-.6.4-1s-.1-.7-.4-1c-.3-.3-.6-.4-1-.4s-.7.1-1 .4c-.3.3-.4.6-.4 1s.1.7.4 1c.3.3.6.4 1 .4zm5.4 4l.2-.5v-.4-.3a2.6 2.6 0 0 0-.3-.8 2.4 2.4 0 0 0-.7-.7 2.5 2.5 0 0 0-.8-.3 1.5 1.5 0 0 0-.8 0 1 1 0 0 0-.4.2 1 1 0 0 0-.2.5 1.5 1.5 0 0 0 0 .7v.4l.3.4.3.4a2.8 2.8 0 0 0 .8.5l.4.1h.7l.5-.2z\" fill-rule=\"evenodd\"/></svg>',\n        'document-properties': '<svg width=\"24\" height=\"24\"><path d=\"M14.4 3H7a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h10a2 2 0 0 0 2-2V7.6L14.4 3zM17 19H7V5h6v4h4v10z\" fill-rule=\"nonzero\"/></svg>',\n        'drag': '<svg width=\"24\" height=\"24\"><path d=\"M13 5h2v2h-2V5zm0 4h2v2h-2V9zM9 9h2v2H9V9zm4 4h2v2h-2v-2zm-4 0h2v2H9v-2zm0 4h2v2H9v-2zm4 0h2v2h-2v-2zM9 5h2v2H9V5z\" fill-rule=\"evenodd\"/></svg>',\n        'duplicate': '<svg width=\"24\" height=\"24\"><g fill-rule=\"nonzero\"><path d=\"M16 3v2H6v11H4V5c0-1.1.9-2 2-2h10zm3 8h-2V9h-7v10h9a2 2 0 0 1-2 2h-7a2 2 0 0 1-2-2V9c0-1.2.9-2 2-2h7a2 2 0 0 1 2 2v2z\"/><path d=\"M17 14h1a1 1 0 0 1 0 2h-1v1a1 1 0 0 1-2 0v-1h-1a1 1 0 0 1 0-2h1v-1a1 1 0 0 1 2 0v1z\"/></g></svg>',\n        'edit-block': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M19.8 8.8l-9.4 9.4c-.2.2-.5.4-.9.4l-5.4 1.2 1.2-5.4.5-.8 9.4-9.4c.7-.7 1.8-.7 2.5 0l2.1 2.1c.7.7.7 1.8 0 2.5zm-2-.2l1-.9v-.3l-2.2-2.2a.3.3 0 0 0-.3 0l-1 1L18 8.5zm-1 1l-2.5-2.4-6 6 2.5 2.5 6-6zm-7 7.1l-2.6-2.4-.3.3-.1.2-.7 3 3.1-.6h.1l.4-.5z\"/></svg>',\n        'edit-image': '<svg width=\"24\" height=\"24\"><path d=\"M18 16h2V7a2 2 0 0 0-2-2H7v2h11v9zM6 17h15a1 1 0 0 1 0 2h-1v1a1 1 0 0 1-2 0v-1H6a2 2 0 0 1-2-2V7H3a1 1 0 1 1 0-2h1V4a1 1 0 1 1 2 0v13zm3-5.3l1.3 2 3-4.7 3.7 6H7l2-3.3z\" fill-rule=\"nonzero\"/></svg>',\n        'embed-page': '<svg width=\"24\" height=\"24\"><path d=\"M19 6V5H5v14h2A13 13 0 0 1 19 6zm0 1.4c-.8.8-1.6 2.4-2.2 4.6H19V7.4zm0 5.6h-2.4c-.4 1.8-.6 3.8-.6 6h3v-6zm-4 6c0-2.2.2-4.2.6-6H13c-.7 1.8-1.1 3.8-1.1 6h3zm-4 0c0-2.2.4-4.2 1-6H9.6A12 12 0 0 0 8 19h3zM4 3h16c.6 0 1 .4 1 1v16c0 .6-.4 1-1 1H4a1 1 0 0 1-1-1V4c0-.6.4-1 1-1zm11.8 9c.4-1.9 1-3.4 1.8-4.5a9.2 9.2 0 0 0-4 4.5h2.2zm-3.4 0a12 12 0 0 1 2.8-4 12 12 0 0 0-5 4h2.2z\" fill-rule=\"nonzero\"/></svg>',\n        'embed': '<svg width=\"24\" height=\"24\"><path d=\"M4 3h16c.6 0 1 .4 1 1v16c0 .6-.4 1-1 1H4a1 1 0 0 1-1-1V4c0-.6.4-1 1-1zm1 2v14h14V5H5zm4.8 2.6l5.6 4a.5.5 0 0 1 0 .8l-5.6 4A.5.5 0 0 1 9 16V8a.5.5 0 0 1 .8-.4z\" fill-rule=\"nonzero\"/></svg>',\n        'emoji': '<svg width=\"24\" height=\"24\"><path d=\"M9 11c.6 0 1-.4 1-1s-.4-1-1-1a1 1 0 0 0-1 1c0 .6.4 1 1 1zm6 0c.6 0 1-.4 1-1s-.4-1-1-1a1 1 0 0 0-1 1c0 .6.4 1 1 1zm-3 5.5c2.1 0 4-1.5 4.4-3.5H7.6c.5 2 2.3 3.5 4.4 3.5zM12 4a8 8 0 1 0 0 16 8 8 0 0 0 0-16zm0 14.5a6.5 6.5 0 1 1 0-13 6.5 6.5 0 0 1 0 13z\" fill-rule=\"nonzero\"/></svg>',\n        'fill': '<svg width=\"24\" height=\"26\"><path d=\"M16.6 12l-9-9-1.4 1.4 2.4 2.4-5.2 5.1c-.5.6-.5 1.6 0 2.2L9 19.6a1.5 1.5 0 0 0 2.2 0l5.5-5.5c.5-.6.5-1.6 0-2.2zM5.2 13L10 8.2l4.8 4.8H5.2zM19 14.5s-2 2.2-2 3.5c0 1.1.9 2 2 2a2 2 0 0 0 2-2c0-1.3-2-3.5-2-3.5z\" fill-rule=\"nonzero\"/></svg>',\n        'flip-horizontally': '<svg width=\"24\" height=\"24\"><path d=\"M14 19h2v-2h-2v2zm4-8h2V9h-2v2zM4 7v10c0 1.1.9 2 2 2h3v-2H6V7h3V5H6a2 2 0 0 0-2 2zm14-2v2h2a2 2 0 0 0-2-2zm-7 16h2V3h-2v18zm7-6h2v-2h-2v2zm-4-8h2V5h-2v2zm4 12a2 2 0 0 0 2-2h-2v2z\" fill-rule=\"nonzero\"/></svg>',\n        'flip-vertically': '<svg width=\"24\" height=\"24\"><path d=\"M5 14v2h2v-2H5zm8 4v2h2v-2h-2zm4-14H7a2 2 0 0 0-2 2v3h2V6h10v3h2V6a2 2 0 0 0-2-2zm2 14h-2v2a2 2 0 0 0 2-2zM3 11v2h18v-2H3zm6 7v2h2v-2H9zm8-4v2h2v-2h-2zM5 18c0 1.1.9 2 2 2v-2H5z\" fill-rule=\"nonzero\"/></svg>',\n        'format-painter': '<svg width=\"24\" height=\"24\"><path d=\"M18 5V4c0-.5-.4-1-1-1H5a1 1 0 0 0-1 1v4c0 .6.5 1 1 1h12c.6 0 1-.4 1-1V7h1v4H9v9c0 .6.4 1 1 1h2c.6 0 1-.4 1-1v-7h8V5h-3z\" fill-rule=\"nonzero\"/></svg>',\n        'format': '<svg width=\"24\" height=\"24\"><path fill-rule=\"evenodd\" d=\"M17 5a1 1 0 0 1 0 2h-4v11a1 1 0 0 1-2 0V7H7a1 1 0 1 1 0-2h10z\"/></svg>',\n        'fullscreen': '<svg width=\"24\" height=\"24\"><path d=\"M15.3 10l-1.2-1.3 2.9-3h-2.3a.9.9 0 1 1 0-1.7H19c.5 0 .9.4.9.9v4.4a.9.9 0 1 1-1.8 0V7l-2.9 3zm0 4l3 3v-2.3a.9.9 0 1 1 1.7 0V19c0 .5-.4.9-.9.9h-4.4a.9.9 0 1 1 0-1.8H17l-3-2.9 1.3-1.2zM10 15.4l-2.9 3h2.3a.9.9 0 1 1 0 1.7H5a.9.9 0 0 1-.9-.9v-4.4a.9.9 0 1 1 1.8 0V17l2.9-3 1.2 1.3zM8.7 10L5.7 7v2.3a.9.9 0 0 1-1.7 0V5c0-.5.4-.9.9-.9h4.4a.9.9 0 0 1 0 1.8H7l3 2.9-1.3 1.2z\" fill-rule=\"nonzero\"/></svg>',\n        'gallery': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M5 15.7l2.3-2.2c.3-.3.7-.3 1 0L11 16l5.1-5c.3-.4.8-.4 1 0l2 1.9V8H5v7.7zM5 18V19h3l1.8-1.9-2-2L5 17.9zm14-3l-2.5-2.4-6.4 6.5H19v-4zM4 6h16c.6 0 1 .4 1 1v13c0 .6-.4 1-1 1H4a1 1 0 0 1-1-1V7c0-.6.4-1 1-1zm6 7a2 2 0 1 1 0-4 2 2 0 0 1 0 4zM4.5 4h15a.5.5 0 1 1 0 1h-15a.5.5 0 0 1 0-1zm2-2h11a.5.5 0 1 1 0 1h-11a.5.5 0 0 1 0-1z\"/></svg>',\n        'gamma': '<svg width=\"24\" height=\"24\"><path d=\"M4 3h16c.6 0 1 .4 1 1v16c0 .6-.4 1-1 1H4a1 1 0 0 1-1-1V4c0-.6.4-1 1-1zm1 2v14h14V5H5zm6.5 11.8V14L9.2 8.7a5.1 5.1 0 0 0-.4-.8l-.1-.2H8 8v-1l.3-.1.3-.1h.7a1 1 0 0 1 .6.5l.1.3a8.5 8.5 0 0 1 .3.6l1.9 4.6 2-5.2a1 1 0 0 1 1-.6.5.5 0 0 1 .5.6L13 14v2.8a.7.7 0 0 1-1.4 0z\" fill-rule=\"nonzero\"/></svg>',\n        'help': '<svg width=\"24\" height=\"24\"><g fill-rule=\"evenodd\"><path d=\"M12 5.5a6.5 6.5 0 0 0-6 9 6.3 6.3 0 0 0 1.4 2l1 1a6.3 6.3 0 0 0 3.6 1 6.5 6.5 0 0 0 6-9 6.3 6.3 0 0 0-1.4-2l-1-1a6.3 6.3 0 0 0-3.6-1zM12 4a7.8 7.8 0 0 1 5.7 2.3A8 8 0 1 1 12 4z\"/><path d=\"M9.6 9.7a.7.7 0 0 1-.7-.8c0-1.1 1.5-1.8 3.2-1.8 1.8 0 3.2.8 3.2 2.4 0 1.4-.4 2.1-1.5 2.8-.2 0-.3.1-.3.2a2 2 0 0 0-.8.8.8.8 0 0 1-1.4-.6c.3-.7.8-1 1.3-1.5l.4-.2c.7-.4.8-.6.8-1.5 0-.5-.6-.9-1.7-.9-.5 0-1 .1-1.4.3-.2 0-.3.1-.3.2v-.2c0 .4-.4.8-.8.8z\" fill-rule=\"nonzero\"/><circle cx=\"12\" cy=\"16\" r=\"1\"/></g></svg>',\n        'highlight-bg-color': '<svg width=\"24\" height=\"24\"><g fill-rule=\"evenodd\"><path id=\"tox-icon-highlight-bg-color__color\" d=\"M3 18h18v3H3z\"/><path fill-rule=\"nonzero\" d=\"M7.7 16.7H3l3.3-3.3-.7-.8L10.2 8l4 4.1-4 4.2c-.2.2-.6.2-.8 0l-.6-.7-1.1 1.1zm5-7.5L11 7.4l3-2.9a2 2 0 0 1 2.6 0L18 6c.7.7.7 2 0 2.7l-2.9 2.9-1.8-1.8-.5-.6\"/></g></svg>',\n        'home': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z\"/></svg>',\n        'horizontal-rule': '<svg width=\"24\" height=\"24\"><path d=\"M4 11h16v2H4z\" fill-rule=\"evenodd\"/></svg>',\n        'image-options': '<svg width=\"24\" height=\"24\"><path d=\"M6 10a2 2 0 0 0-2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2 2 2 0 0 0-2-2zm12 0a2 2 0 0 0-2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2 2 2 0 0 0-2-2zm-6 0a2 2 0 0 0-2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2 2 2 0 0 0-2-2z\" fill-rule=\"nonzero\"/></svg>',\n        'image': '<svg width=\"24\" height=\"24\"><path d=\"M5 15.7l3.3-3.2c.3-.3.7-.3 1 0L12 15l4.1-4c.3-.4.8-.4 1 0l2 1.9V5H5v10.7zM5 18V19h3l2.8-2.9-2-2L5 17.9zm14-3l-2.5-2.4-6.4 6.5H19v-4zM4 3h16c.6 0 1 .4 1 1v16c0 .6-.4 1-1 1H4a1 1 0 0 1-1-1V4c0-.6.4-1 1-1zm6 8a2 2 0 1 0 0-4 2 2 0 0 0 0 4z\" fill-rule=\"nonzero\"/></svg>',\n        'indent': '<svg width=\"24\" height=\"24\"><path d=\"M7 5h12c.6 0 1 .4 1 1s-.4 1-1 1H7a1 1 0 1 1 0-2zm5 4h7c.6 0 1 .4 1 1s-.4 1-1 1h-7a1 1 0 0 1 0-2zm0 4h7c.6 0 1 .4 1 1s-.4 1-1 1h-7a1 1 0 0 1 0-2zm-5 4h12a1 1 0 0 1 0 2H7a1 1 0 0 1 0-2zm-2.6-3.8L6.2 12l-1.8-1.2a1 1 0 0 1 1.2-1.6l3 2a1 1 0 0 1 0 1.6l-3 2a1 1 0 1 1-1.2-1.6z\" fill-rule=\"evenodd\"/></svg>',\n        'info': '<svg width=\"24\" height=\"24\"><path d=\"M12 4a7.8 7.8 0 0 1 5.7 2.3A8 8 0 1 1 12 4zm-1 3v2h2V7h-2zm3 10v-1h-1v-5h-3v1h1v4h-1v1h4z\" fill-rule=\"evenodd\"/></svg>',\n        'insert-character': '<svg width=\"24\" height=\"24\"><path d=\"M15 18h4l1-2v4h-6v-3.3l1.4-1a6 6 0 0 0 1.8-2.9 6.3 6.3 0 0 0-.1-4.1 5.8 5.8 0 0 0-3-3.2c-.6-.3-1.3-.5-2.1-.5a5.1 5.1 0 0 0-3.9 1.8 6.3 6.3 0 0 0-1.3 6 6.2 6.2 0 0 0 1.8 3l1.4.9V20H4v-4l1 2h4v-.5l-2-1L5.4 15A6.5 6.5 0 0 1 4 11c0-1 .2-1.9.6-2.7A7 7 0 0 1 6.3 6C7.1 5.4 8 5 9 4.5c1-.3 2-.5 3.1-.5a8.8 8.8 0 0 1 5.7 2 7 7 0 0 1 1.7 2.3 6 6 0 0 1 .2 4.8c-.2.7-.6 1.3-1 1.9a7.6 7.6 0 0 1-3.6 2.5v.5z\" fill-rule=\"evenodd\"/></svg>',\n        'insert-time': '<svg width=\"24\" height=\"24\"><g fill-rule=\"nonzero\"><path d=\"M12 19a7 7 0 1 0 0-14 7 7 0 0 0 0 14zm0 2a9 9 0 1 1 0-18 9 9 0 0 1 0 18z\"/><path d=\"M16 12h-3V7c0-.6-.4-1-1-1a1 1 0 0 0-1 1v7h5c.6 0 1-.4 1-1s-.4-1-1-1z\"/></g></svg>',\n        'invert': '<svg width=\"24\" height=\"24\"><path d=\"M18 19.3L16.5 18a5.8 5.8 0 0 1-3.1 1.9 6.1 6.1 0 0 1-5.5-1.6A5.8 5.8 0 0 1 6 14v-.3l.1-1.2A13.9 13.9 0 0 1 7.7 9l-3-3 .7-.8 2.8 2.9 9 8.9 1.5 1.6-.7.6zm0-5.5v.3l-.1 1.1-.4 1-1.2-1.2a4.3 4.3 0 0 0 .2-1v-.2c0-.4 0-.8-.2-1.3l-.5-1.4a14.8 14.8 0 0 0-3-4.2L12 6a26.1 26.1 0 0 0-2.2 2.5l-1-1a20.9 20.9 0 0 1 2.9-3.3L12 4l1 .8a22.2 22.2 0 0 1 4 5.4c.6 1.2 1 2.4 1 3.6z\" fill-rule=\"evenodd\"/></svg>',\n        'italic': '<svg width=\"24\" height=\"24\"><path d=\"M16.7 4.7l-.1.9h-.3c-.6 0-1 0-1.4.3-.3.3-.4.6-.5 1.1l-2.1 9.8v.6c0 .5.4.8 1.4.8h.2l-.2.8H8l.2-.8h.2c1.1 0 1.8-.5 2-1.5l2-9.8.1-.5c0-.6-.4-.8-1.4-.8h-.3l.2-.9h5.8z\" fill-rule=\"evenodd\"/></svg>',\n        'line': '<svg width=\"24\" height=\"24\"><path d=\"M15 9l-8 8H4v-3l8-8 3 3zm1-1l-3-3 1-1h1c-.2 0 0 0 0 0l2 2s0 .2 0 0v1l-1 1zM4 18h16v2H4v-2z\" fill-rule=\"evenodd\"/></svg>',\n        'link': '<svg width=\"24\" height=\"24\"><path d=\"M6.2 12.3a1 1 0 0 1 1.4 1.4l-2.1 2a2 2 0 1 0 2.7 2.8l4.8-4.8a1 1 0 0 0 0-1.4 1 1 0 1 1 1.4-1.3 2.9 2.9 0 0 1 0 4L9.6 20a3.9 3.9 0 0 1-5.5-5.5l2-2zm11.6-.6a1 1 0 0 1-1.4-1.4l2-2a2 2 0 1 0-2.6-2.8L11 10.3a1 1 0 0 0 0 1.4A1 1 0 1 1 9.6 13a2.9 2.9 0 0 1 0-4L14.4 4a3.9 3.9 0 0 1 5.5 5.5l-2 2z\" fill-rule=\"nonzero\"/></svg>',\n        'list-bull-circle': '<svg width=\"48\" height=\"48\"><g fill-rule=\"evenodd\"><path d=\"M11 16a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm0 1a3 3 0 1 1 0-6 3 3 0 0 1 0 6zM11 26a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm0 1a3 3 0 1 1 0-6 3 3 0 0 1 0 6zM11 36a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm0 1a3 3 0 1 1 0-6 3 3 0 0 1 0 6z\" fill-rule=\"nonzero\"/><path opacity=\".2\" d=\"M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z\"/></g></svg>',\n        'list-bull-default': '<svg width=\"48\" height=\"48\"><g fill-rule=\"evenodd\"><circle cx=\"11\" cy=\"14\" r=\"3\"/><circle cx=\"11\" cy=\"24\" r=\"3\"/><circle cx=\"11\" cy=\"34\" r=\"3\"/><path opacity=\".2\" d=\"M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z\"/></g></svg>',\n        'list-bull-square': '<svg width=\"48\" height=\"48\"><g fill-rule=\"evenodd\"><path d=\"M8 11h6v6H8zM8 21h6v6H8zM8 31h6v6H8z\"/><path opacity=\".2\" d=\"M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z\"/></g></svg>',\n        'list-num-default-rtl': '<svg width=\"48\" height=\"48\"><g fill-rule=\"evenodd\"><path opacity=\".2\" d=\"M8 12h22v4H8zM8 22h22v4H8zM8 32h22v4H8z\"/><path d=\"M37.4 17v-4.8l-1.6 1v-1.1l1.6-1h1.2V17zM33.3 17.1c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zm1.7 5.7c0-1.2 1-2 2.2-2 1.3 0 2.1.8 2.1 1.8 0 .7-.3 1.2-1.3 2.2l-1.2 1v.2h2.6v1h-4.3v-.9l2-1.9c.8-.8 1-1.1 1-1.5 0-.5-.4-.8-1-.8-.5 0-.9.3-.9.9H35zm-1.7 4.3c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zm3.2 7.3v-1h.7c.6 0 1-.3 1-.8 0-.4-.4-.7-1-.7s-1 .3-1 .8H35c0-1.1 1-1.8 2.2-1.8 1.2 0 2.1.6 2.1 1.6 0 .7-.4 1.2-1 1.3v.1c.7.1 1.3.7 1.3 1.4 0 1-1 1.9-2.4 1.9-1.3 0-2.2-.8-2.3-2h1.2c0 .6.5 1 1.1 1 .6 0 1-.4 1-1 0-.5-.3-.8-1-.8h-.7zm-3.3 2.7c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .8.3.8.7 0 .4-.3.7-.8.7z\"/></g></svg>',\n        'list-num-default': '<svg width=\"48\" height=\"48\"><g fill-rule=\"evenodd\"><path opacity=\".2\" d=\"M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z\"/><path d=\"M10 17v-4.8l-1.5 1v-1.1l1.6-1h1.2V17h-1.2zm3.6.1c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .7.3.7.7 0 .4-.2.7-.7.7zm-5 5.7c0-1.2.8-2 2.1-2s2.1.8 2.1 1.8c0 .7-.3 1.2-1.4 2.2l-1.1 1v.2h2.6v1H8.6v-.9l2-1.9c.8-.8 1-1.1 1-1.5 0-.5-.4-.8-1-.8-.5 0-.9.3-.9.9H8.5zm6.3 4.3c-.5 0-.7-.3-.7-.7 0-.4.2-.7.7-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zM10 34.4v-1h.7c.6 0 1-.3 1-.8 0-.4-.4-.7-1-.7s-1 .3-1 .8H8.6c0-1.1 1-1.8 2.2-1.8 1.3 0 2.1.6 2.1 1.6 0 .7-.4 1.2-1 1.3v.1c.8.1 1.3.7 1.3 1.4 0 1-1 1.9-2.4 1.9-1.3 0-2.2-.8-2.3-2h1.2c0 .6.5 1 1.1 1 .7 0 1-.4 1-1 0-.5-.3-.8-1-.8h-.7zm4.7 2.7c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .8.3.8.7 0 .4-.3.7-.8.7z\"/></g></svg>',\n        'list-num-lower-alpha-rtl': '<svg width=\"48\" height=\"48\"><g fill-rule=\"evenodd\"><path opacity=\".2\" d=\"M8 12h22v4H8zM8 22h22v4H8zM8 32h22v4H8z\"/><path d=\"M36.5 16c-.9 0-1.5-.5-1.5-1.3s.6-1.3 1.8-1.4h1v-.4c0-.4-.2-.6-.7-.6-.4 0-.7.1-.8.4h-1.1c0-.8.8-1.4 2-1.4S39 12 39 13V16h-1.2v-.6c-.3.4-.8.7-1.4.7zm.4-.8c.6 0 1-.4 1-.9V14h-1c-.5.1-.7.3-.7.6 0 .4.3.6.7.6zM33.1 16.1c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .8.3.8.7 0 .4-.3.7-.8.7zM37.7 26c-.7 0-1.2-.2-1.5-.7v.7H35v-6.3h1.2v2.5c.3-.5.8-.9 1.5-.9 1.1 0 1.8 1 1.8 2.4 0 1.5-.7 2.4-1.8 2.4zm-.5-3.6c-.6 0-1 .5-1 1.3s.4 1.4 1 1.4c.7 0 1-.6 1-1.4 0-.8-.3-1.3-1-1.3zM33.2 26.1c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .8.3.8.7 0 .4-.3.7-.8.7zm6 7h-1c-.1-.5-.4-.8-1-.8s-1 .5-1 1.4c0 1 .4 1.4 1 1.4.5 0 .9-.2 1-.7h1c0 1-.8 1.7-2 1.7-1.4 0-2.2-.9-2.2-2.4s.8-2.4 2.2-2.4c1.2 0 2 .7 2 1.7zm-6.1 3c-.5 0-.7-.3-.7-.7 0-.4.2-.7.7-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7z\"/></g></svg>',\n        'list-num-lower-alpha': '<svg width=\"48\" height=\"48\"><g fill-rule=\"evenodd\"><path opacity=\".2\" d=\"M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z\"/><path d=\"M10.3 15.2c.5 0 1-.4 1-.9V14h-1c-.5.1-.8.3-.8.6 0 .4.3.6.8.6zm-.4.9c-1 0-1.5-.6-1.5-1.4 0-.8.6-1.3 1.7-1.4h1.1v-.4c0-.4-.2-.6-.7-.6-.5 0-.8.1-.9.4h-1c0-.8.8-1.4 2-1.4 1.1 0 1.8.6 1.8 1.6V16h-1.1v-.6h-.1c-.2.4-.7.7-1.3.7zm4.6 0c-.5 0-.7-.3-.7-.7 0-.4.2-.7.7-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zm-3.2 10c-.6 0-1.2-.3-1.4-.8v.7H8.5v-6.3H10v2.5c.3-.5.8-.9 1.4-.9 1.2 0 1.9 1 1.9 2.4 0 1.5-.7 2.4-1.9 2.4zm-.4-3.7c-.7 0-1 .5-1 1.3s.3 1.4 1 1.4c.6 0 1-.6 1-1.4 0-.8-.4-1.3-1-1.3zm4 3.7c-.5 0-.7-.3-.7-.7 0-.4.2-.7.7-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zm-2.2 7h-1.2c0-.5-.4-.8-.9-.8-.6 0-1 .5-1 1.4 0 1 .4 1.4 1 1.4.5 0 .8-.2 1-.7h1c0 1-.8 1.7-2 1.7-1.4 0-2.2-.9-2.2-2.4s.8-2.4 2.2-2.4c1.2 0 2 .7 2 1.7zm1.8 3c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7z\"/></g></svg>',\n        'list-num-lower-greek-rtl': '<svg width=\"48\" height=\"48\"><g fill-rule=\"evenodd\"><path opacity=\".2\" d=\"M8 12h22v4H8zM8 22h22v4H8zM8 32h22v4H8z\"/><path d=\"M37.4 16c-1.2 0-2-.8-2-2.3 0-1.5.8-2.4 2-2.4.6 0 1 .4 1.3 1v-.9H40v3.2c0 .4.1.5.4.5h.2v.9h-.6c-.6 0-1-.2-1-.7h-.2c-.2.4-.7.8-1.3.8zm.3-1c.6 0 1-.5 1-1.3s-.4-1.3-1-1.3-1 .5-1 1.3.4 1.4 1 1.4zM33.3 16.1c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zM36 21.9c0-1.5.8-2.3 2.1-2.3 1.2 0 2 .6 2 1.6 0 .6-.3 1-.9 1.3.9.3 1.3.8 1.3 1.7 0 1.2-.7 1.9-1.8 1.9-.6 0-1.1-.3-1.4-.8v2.2H36V22zm1.8 1.2v-1h.3c.5 0 .9-.2.9-.7 0-.5-.3-.8-.9-.8-.5 0-.8.3-.8 1v2.2c0 .8.4 1.3 1 1.3s1-.4 1-1-.4-1-1.2-1h-.3zM33.3 26.1c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zM37.1 34.6L34.8 30h1.4l1.7 3.5 1.7-3.5h1.1l-2.2 4.6v.1c.5.8.7 1.4.7 1.8 0 .4-.2.8-.4 1-.2.2-.6.3-1 .3-.9 0-1.3-.4-1.3-1.2 0-.5.2-1 .5-1.7l.1-.2zm.7 1a2 2 0 0 0-.4.9c0 .3.1.4.4.4.3 0 .4-.1.4-.4 0-.2-.1-.6-.4-1zM33.3 36.1c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7z\"/></g></svg>',\n        'list-num-lower-greek': '<svg width=\"48\" height=\"48\"><g fill-rule=\"evenodd\"><path opacity=\".2\" d=\"M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z\"/><path d=\"M10.5 15c.7 0 1-.5 1-1.3s-.3-1.3-1-1.3c-.5 0-.9.5-.9 1.3s.4 1.4 1 1.4zm-.3 1c-1.1 0-1.8-.8-1.8-2.3 0-1.5.7-2.4 1.8-2.4.7 0 1.1.4 1.3 1h.1v-.9h1.2v3.2c0 .4.1.5.4.5h.2v.9h-.6c-.6 0-1-.2-1.1-.7h-.1c-.2.4-.7.8-1.4.8zm5 .1c-.5 0-.8-.3-.8-.7 0-.4.3-.7.7-.7.5 0 .8.3.8.7 0 .4-.3.7-.8.7zm-4.9 7v-1h.3c.6 0 1-.2 1-.7 0-.5-.4-.8-1-.8-.5 0-.8.3-.8 1v2.2c0 .8.4 1.3 1.1 1.3.6 0 1-.4 1-1s-.5-1-1.3-1h-.3zM8.6 22c0-1.5.7-2.3 2-2.3 1.2 0 2 .6 2 1.6 0 .6-.3 1-.8 1.3.8.3 1.3.8 1.3 1.7 0 1.2-.8 1.9-1.9 1.9-.6 0-1.1-.3-1.3-.8v2.2H8.5V22zm6.2 4.2c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .7.3.7.7 0 .4-.2.7-.7.7zm-4.5 8.5L8 30h1.4l1.7 3.5 1.7-3.5h1.1l-2.2 4.6v.1c.5.8.7 1.4.7 1.8 0 .4-.1.8-.4 1-.2.2-.6.3-1 .3-.9 0-1.3-.4-1.3-1.2 0-.5.2-1 .5-1.7l.1-.2zm.7 1a2 2 0 0 0-.4.9c0 .3.1.4.4.4.3 0 .4-.1.4-.4 0-.2-.1-.6-.4-1zm4.5.5c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7z\"/></g></svg>',\n        'list-num-lower-roman-rtl': '<svg width=\"48\" height=\"48\"><g fill-rule=\"evenodd\"><path opacity=\".2\" d=\"M8 12h22v4H8zM8 22h22v4H8zM8 32h22v4H8z\"/><path d=\"M32.9 16v-1.2h-1.3V16H33zm0 10v-1.2h-1.3V26H33zm0 10v-1.2h-1.3V36H33z\"/><path fill-rule=\"nonzero\" d=\"M36 21h-1.5v5H36zM36 31h-1.5v5H36zM39 21h-1.5v5H39zM39 31h-1.5v5H39zM42 31h-1.5v5H42zM36 11h-1.5v5H36zM36 19h-1.5v1H36zM36 29h-1.5v1H36zM39 19h-1.5v1H39zM39 29h-1.5v1H39zM42 29h-1.5v1H42zM36 9h-1.5v1H36z\"/></g></svg>',\n        'list-num-lower-roman': '<svg width=\"48\" height=\"48\"><g fill-rule=\"evenodd\"><path opacity=\".2\" d=\"M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z\"/><path d=\"M15.1 16v-1.2h1.3V16H15zm0 10v-1.2h1.3V26H15zm0 10v-1.2h1.3V36H15z\"/><path fill-rule=\"nonzero\" d=\"M12 21h1.5v5H12zM12 31h1.5v5H12zM9 21h1.5v5H9zM9 31h1.5v5H9zM6 31h1.5v5H6zM12 11h1.5v5H12zM12 19h1.5v1H12zM12 29h1.5v1H12zM9 19h1.5v1H9zM9 29h1.5v1H9zM6 29h1.5v1H6zM12 9h1.5v1H12z\"/></g></svg>',\n        'list-num-upper-alpha-rtl': '<svg width=\"48\" height=\"48\"><g fill-rule=\"evenodd\"><path opacity=\".2\" d=\"M8 12h22v4H8zM8 22h22v4H8zM8 32h22v4H8z\"/><path d=\"M39.3 17l-.5-1.4h-2l-.5 1.4H35l2-6h1.6l2 6h-1.3zm-1.6-4.7l-.7 2.3h1.6l-.8-2.3zM33.4 17c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .7.3.7.7 0 .4-.2.7-.7.7zm4.7 9.9h-2.7v-6H38c1.2 0 1.9.6 1.9 1.5 0 .6-.5 1.2-1 1.3.7.1 1.3.7 1.3 1.5 0 1-.8 1.7-2 1.7zm-1.4-5v1.5h1c.6 0 1-.3 1-.8 0-.4-.4-.7-1-.7h-1zm0 4h1.1c.7 0 1.1-.3 1.1-.8 0-.6-.4-.9-1.1-.9h-1.1V26zM33 27.1c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zm4.9 10c-1.8 0-2.8-1.1-2.8-3.1s1-3.1 2.8-3.1c1.4 0 2.5.9 2.6 2.2h-1.3c0-.7-.6-1.1-1.3-1.1-1 0-1.6.7-1.6 2s.6 2 1.6 2c.7 0 1.2-.4 1.4-1h1.2c-.1 1.3-1.2 2.2-2.6 2.2zm-4.5 0c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7z\"/></g></svg>',\n        'list-num-upper-alpha': '<svg width=\"48\" height=\"48\"><g fill-rule=\"evenodd\"><path opacity=\".2\" d=\"M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z\"/><path d=\"M12.6 17l-.5-1.4h-2L9.5 17H8.3l2-6H12l2 6h-1.3zM11 12.3l-.7 2.3h1.6l-.8-2.3zm4.7 4.8c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .7.3.7.7 0 .4-.2.7-.7.7zM11.4 27H8.7v-6h2.6c1.2 0 1.9.6 1.9 1.5 0 .6-.5 1.2-1 1.3.7.1 1.3.7 1.3 1.5 0 1-.8 1.7-2 1.7zM10 22v1.5h1c.6 0 1-.3 1-.8 0-.4-.4-.7-1-.7h-1zm0 4H11c.7 0 1.1-.3 1.1-.8 0-.6-.4-.9-1.1-.9H10V26zm5.4 1.1c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zm-4.1 10c-1.8 0-2.8-1.1-2.8-3.1s1-3.1 2.8-3.1c1.4 0 2.5.9 2.6 2.2h-1.3c0-.7-.6-1.1-1.3-1.1-1 0-1.6.7-1.6 2s.6 2 1.6 2c.7 0 1.2-.4 1.4-1h1.2c-.1 1.3-1.2 2.2-2.6 2.2zm4.5 0c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7z\"/></g></svg>',\n        'list-num-upper-roman-rtl': '<svg width=\"48\" height=\"48\"><g fill-rule=\"evenodd\"><path opacity=\".2\" d=\"M8 12h22v4H8zM8 22h22v4H8zM8 32h22v4H8z\"/><path d=\"M31.6 17v-1.2H33V17h-1.3zm0 10v-1.2H33V27h-1.3zm0 10v-1.2H33V37h-1.3z\"/><path fill-rule=\"nonzero\" d=\"M34.5 20H36v7h-1.5zM34.5 30H36v7h-1.5zM37.5 20H39v7h-1.5zM37.5 30H39v7h-1.5zM40.5 30H42v7h-1.5zM34.5 10H36v7h-1.5z\"/></g></svg>',\n        'list-num-upper-roman': '<svg width=\"48\" height=\"48\"><g fill-rule=\"evenodd\"><path opacity=\".2\" d=\"M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z\"/><path d=\"M15.1 17v-1.2h1.3V17H15zm0 10v-1.2h1.3V27H15zm0 10v-1.2h1.3V37H15z\"/><path fill-rule=\"nonzero\" d=\"M12 20h1.5v7H12zM12 30h1.5v7H12zM9 20h1.5v7H9zM9 30h1.5v7H9zM6 30h1.5v7H6zM12 10h1.5v7H12z\"/></g></svg>',\n        'lock': '<svg width=\"24\" height=\"24\"><path d=\"M16.3 11c.2 0 .3 0 .5.2l.2.6v7.4c0 .3 0 .4-.2.6l-.6.2H7.8c-.3 0-.4 0-.6-.2a.7.7 0 0 1-.2-.6v-7.4c0-.3 0-.4.2-.6l.5-.2H8V8c0-.8.3-1.5.9-2.1.6-.6 1.3-.9 2.1-.9h2c.8 0 1.5.3 2.1.9.6.6.9 1.3.9 2.1v3h.3zM10 8v3h4V8a1 1 0 0 0-.3-.7A1 1 0 0 0 13 7h-2a1 1 0 0 0-.7.3 1 1 0 0 0-.3.7z\" fill-rule=\"evenodd\"/></svg>',\n        'ltr': '<svg width=\"24\" height=\"24\"><path d=\"M11 5h7a1 1 0 0 1 0 2h-1v11a1 1 0 0 1-2 0V7h-2v11a1 1 0 0 1-2 0v-6c-.5 0-1 0-1.4-.3A3.4 3.4 0 0 1 7.8 10a3.3 3.3 0 0 1 0-2.8 3.4 3.4 0 0 1 1.8-1.8L11 5zM4.4 16.2L6.2 15l-1.8-1.2a1 1 0 0 1 1.2-1.6l3 2a1 1 0 0 1 0 1.6l-3 2a1 1 0 1 1-1.2-1.6z\" fill-rule=\"evenodd\"/></svg>',\n        'more-drawer': '<svg width=\"24\" height=\"24\"><path d=\"M6 10a2 2 0 0 0-2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2 2 2 0 0 0-2-2zm12 0a2 2 0 0 0-2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2 2 2 0 0 0-2-2zm-6 0a2 2 0 0 0-2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2 2 2 0 0 0-2-2z\" fill-rule=\"nonzero\"/></svg>',\n        'new-document': '<svg width=\"24\" height=\"24\"><path d=\"M14.4 3H7a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h10a2 2 0 0 0 2-2V7.6L14.4 3zM17 19H7V5h6v4h4v10z\" fill-rule=\"nonzero\"/></svg>',\n        'new-tab': '<svg width=\"24\" height=\"24\"><path d=\"M15 13l2-2v8H5V7h8l-2 2H7v8h8v-4zm4-8v5.5l-2-2-5.6 5.5H10v-1.4L15.5 7l-2-2H19z\" fill-rule=\"evenodd\"/></svg>',\n        'non-breaking': '<svg width=\"24\" height=\"24\"><path d=\"M11 11H8a1 1 0 1 1 0-2h3V6c0-.6.4-1 1-1s1 .4 1 1v3h3c.6 0 1 .4 1 1s-.4 1-1 1h-3v3c0 .6-.4 1-1 1a1 1 0 0 1-1-1v-3zm10 4v5H3v-5c0-.6.4-1 1-1s1 .4 1 1v3h14v-3c0-.6.4-1 1-1s1 .4 1 1z\" fill-rule=\"evenodd\"/></svg>',\n        'notice': '<svg width=\"24\" height=\"24\"><path d=\"M17.8 9.8L15.4 4 20 8.5v7L15.5 20h-7L4 15.5v-7L8.5 4h7l2.3 5.8zm0 0l2.2 5.7-2.3-5.8zM13 17v-2h-2v2h2zm0-4V7h-2v6h2z\" fill-rule=\"evenodd\"/></svg>',\n        'ordered-list-rtl': '<svg width=\"24\" height=\"24\"><path d=\"M6 17h8a1 1 0 0 1 0 2H6a1 1 0 0 1 0-2zm0-6h8a1 1 0 0 1 0 2H6a1 1 0 0 1 0-2zm0-6h8a1 1 0 0 1 0 2H6a1 1 0 1 1 0-2zm13-1v3.5a.5.5 0 1 1-1 0V5h-.5a.5.5 0 1 1 0-1H19zm-1 8.8l.2.2h1.3a.5.5 0 1 1 0 1h-1.6a1 1 0 0 1-.9-1V13c0-.4.3-.8.6-1l1.2-.4.2-.3a.2.2 0 0 0-.2-.2h-1.3a.5.5 0 0 1-.5-.5c0-.3.2-.5.5-.5h1.6c.5 0 .9.4.9 1v.1c0 .4-.3.8-.6 1l-1.2.4-.2.3zm2 4.2v2c0 .6-.4 1-1 1h-1.5a.5.5 0 0 1 0-1h1.2a.3.3 0 1 0 0-.6h-1.3a.4.4 0 1 1 0-.8h1.3a.3.3 0 0 0 0-.6h-1.2a.5.5 0 1 1 0-1H19c.6 0 1 .4 1 1z\" fill-rule=\"evenodd\"/></svg>',\n        'ordered-list': '<svg width=\"24\" height=\"24\"><path d=\"M10 17h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zm0-6h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zm0-6h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 1 1 0-2zM6 4v3.5c0 .3-.2.5-.5.5a.5.5 0 0 1-.5-.5V5h-.5a.5.5 0 0 1 0-1H6zm-1 8.8l.2.2h1.3c.3 0 .5.2.5.5s-.2.5-.5.5H4.9a1 1 0 0 1-.9-1V13c0-.4.3-.8.6-1l1.2-.4.2-.3a.2.2 0 0 0-.2-.2H4.5a.5.5 0 0 1-.5-.5c0-.3.2-.5.5-.5h1.6c.5 0 .9.4.9 1v.1c0 .4-.3.8-.6 1l-1.2.4-.2.3zM7 17v2c0 .6-.4 1-1 1H4.5a.5.5 0 0 1 0-1h1.2c.2 0 .3-.1.3-.3 0-.2-.1-.3-.3-.3H4.4a.4.4 0 1 1 0-.8h1.3c.2 0 .3-.1.3-.3 0-.2-.1-.3-.3-.3H4.5a.5.5 0 1 1 0-1H6c.6 0 1 .4 1 1z\" fill-rule=\"evenodd\"/></svg>',\n        'orientation': '<svg width=\"24\" height=\"24\"><path d=\"M7.3 6.4L1 13l6.4 6.5 6.5-6.5-6.5-6.5zM3.7 13l3.6-3.7L11 13l-3.7 3.7-3.6-3.7zM12 6l2.8 2.7c.3.3.3.8 0 1-.3.4-.9.4-1.2 0L9.2 5.7a.8.8 0 0 1 0-1.2L13.6.2c.3-.3.9-.3 1.2 0 .3.3.3.8 0 1.1L12 4h1a9 9 0 1 1-4.3 16.9l1.5-1.5A7 7 0 1 0 13 6h-1z\" fill-rule=\"nonzero\"/></svg>',\n        'outdent': '<svg width=\"24\" height=\"24\"><path d=\"M7 5h12c.6 0 1 .4 1 1s-.4 1-1 1H7a1 1 0 1 1 0-2zm5 4h7c.6 0 1 .4 1 1s-.4 1-1 1h-7a1 1 0 0 1 0-2zm0 4h7c.6 0 1 .4 1 1s-.4 1-1 1h-7a1 1 0 0 1 0-2zm-5 4h12a1 1 0 0 1 0 2H7a1 1 0 0 1 0-2zm1.6-3.8a1 1 0 0 1-1.2 1.6l-3-2a1 1 0 0 1 0-1.6l3-2a1 1 0 0 1 1.2 1.6L6.8 12l1.8 1.2z\" fill-rule=\"evenodd\"/></svg>',\n        'page-break': '<svg width=\"24\" height=\"24\"><g fill-rule=\"evenodd\"><path d=\"M5 11c.6 0 1 .4 1 1s-.4 1-1 1a1 1 0 0 1 0-2zm3 0h1c.6 0 1 .4 1 1s-.4 1-1 1H8a1 1 0 0 1 0-2zm4 0c.6 0 1 .4 1 1s-.4 1-1 1a1 1 0 0 1 0-2zm3 0h1c.6 0 1 .4 1 1s-.4 1-1 1h-1a1 1 0 0 1 0-2zm4 0c.6 0 1 .4 1 1s-.4 1-1 1a1 1 0 0 1 0-2zM7 3v5h10V3c0-.6.4-1 1-1s1 .4 1 1v7H5V3c0-.6.4-1 1-1s1 .4 1 1zM6 22a1 1 0 0 1-1-1v-7h14v7c0 .6-.4 1-1 1a1 1 0 0 1-1-1v-5H7v5c0 .6-.4 1-1 1z\"/></g></svg>',\n        'paragraph': '<svg width=\"24\" height=\"24\"><path fill-rule=\"evenodd\" d=\"M10 5h7a1 1 0 0 1 0 2h-1v11a1 1 0 0 1-2 0V7h-2v11a1 1 0 0 1-2 0v-6c-.5 0-1 0-1.4-.3A3.4 3.4 0 0 1 6.8 10a3.3 3.3 0 0 1 0-2.8 3.4 3.4 0 0 1 1.8-1.8L10 5z\"/></svg>',\n        'paste-text': '<svg width=\"24\" height=\"24\"><path d=\"M18 9V5h-2v1c0 .6-.4 1-1 1H9a1 1 0 0 1-1-1V5H6v13h3V9h9zM9 20H6a2 2 0 0 1-2-2V5c0-1.1.9-2 2-2h3.2A3 3 0 0 1 12 1a3 3 0 0 1 2.8 2H18a2 2 0 0 1 2 2v4h1v12H9v-1zm1.5-9.5v9h9v-9h-9zM12 3a1 1 0 0 0-1 1c0 .5.4 1 1 1s1-.5 1-1-.4-1-1-1zm0 9h6v2h-.5l-.5-1h-1v4h.8v1h-3.6v-1h.8v-4h-1l-.5 1H12v-2z\" fill-rule=\"nonzero\"/></svg>',\n        'paste': '<svg width=\"24\" height=\"24\"><path d=\"M18 9V5h-2v1c0 .6-.4 1-1 1H9a1 1 0 0 1-1-1V5H6v13h3V9h9zM9 20H6a2 2 0 0 1-2-2V5c0-1.1.9-2 2-2h3.2A3 3 0 0 1 12 1a3 3 0 0 1 2.8 2H18a2 2 0 0 1 2 2v4h1v12H9v-1zm1.5-9.5v9h9v-9h-9zM12 3a1 1 0 0 0-1 1c0 .5.4 1 1 1s1-.5 1-1-.4-1-1-1z\" fill-rule=\"nonzero\"/></svg>',\n        'permanent-pen': '<svg width=\"24\" height=\"24\"><path d=\"M10.5 17.5L8 20H3v-3l3.5-3.5a2 2 0 0 1 0-3L14 3l1 1-7.3 7.3a1 1 0 0 0 0 1.4l3.6 3.6c.4.4 1 .4 1.4 0L20 9l1 1-7.6 7.6a2 2 0 0 1-2.8 0l-.1-.1z\" fill-rule=\"nonzero\"/></svg>',\n        'plus': '<svg width=\"24\" height=\"24\"><path d=\"M12 4c.5 0 1 .4 1 .9V11h6a1 1 0 0 1 .1 2H13v6a1 1 0 0 1-2 .1V13H5a1 1 0 0 1-.1-2H11V5c0-.6.4-1 1-1z\"/></svg>',\n        'preferences': '<svg width=\"24\" height=\"24\"><path d=\"M20.1 13.5l-1.9.2a5.8 5.8 0 0 1-.6 1.5l1.2 1.5c.4.4.3 1 0 1.4l-.7.7a1 1 0 0 1-1.4 0l-1.5-1.2a6.2 6.2 0 0 1-1.5.6l-.2 1.9c0 .5-.5.9-1 .9h-1a1 1 0 0 1-1-.9l-.2-1.9a5.8 5.8 0 0 1-1.5-.6l-1.5 1.2a1 1 0 0 1-1.4 0l-.7-.7a1 1 0 0 1 0-1.4l1.2-1.5a6.2 6.2 0 0 1-.6-1.5l-1.9-.2a1 1 0 0 1-.9-1v-1c0-.5.4-1 .9-1l1.9-.2a5.8 5.8 0 0 1 .6-1.5L5.2 7.3a1 1 0 0 1 0-1.4l.7-.7a1 1 0 0 1 1.4 0l1.5 1.2a6.2 6.2 0 0 1 1.5-.6l.2-1.9c0-.5.5-.9 1-.9h1c.5 0 1 .4 1 .9l.2 1.9a5.8 5.8 0 0 1 1.5.6l1.5-1.2a1 1 0 0 1 1.4 0l.7.7c.3.4.4 1 0 1.4l-1.2 1.5a6.2 6.2 0 0 1 .6 1.5l1.9.2c.5 0 .9.5.9 1v1c0 .5-.4 1-.9 1zM12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6z\" fill-rule=\"evenodd\"/></svg>',\n        'preview': '<svg width=\"24\" height=\"24\"><path d=\"M3.5 12.5c.5.8 1.1 1.6 1.8 2.3 2 2 4.2 3.2 6.7 3.2s4.7-1.2 6.7-3.2a16.2 16.2 0 0 0 2.1-2.8 15.7 15.7 0 0 0-2.1-2.8c-2-2-4.2-3.2-6.7-3.2a9.3 9.3 0 0 0-6.7 3.2A16.2 16.2 0 0 0 3.2 12c0 .2.2.3.3.5zm-2.4-1l.7-1.2L4 7.8C6.2 5.4 8.9 4 12 4c3 0 5.8 1.4 8.1 3.8a18.2 18.2 0 0 1 2.8 3.7v1l-.7 1.2-2.1 2.5c-2.3 2.4-5 3.8-8.1 3.8-3 0-5.8-1.4-8.1-3.8a18.2 18.2 0 0 1-2.8-3.7 1 1 0 0 1 0-1zm12-3.3a2 2 0 1 0 2.7 2.6 4 4 0 1 1-2.6-2.6z\" fill-rule=\"nonzero\"/></svg>',\n        'print': '<svg width=\"24\" height=\"24\"><path d=\"M18 8H6a3 3 0 0 0-3 3v6h2v3h14v-3h2v-6a3 3 0 0 0-3-3zm-1 10H7v-4h10v4zm.5-5c-.8 0-1.5-.7-1.5-1.5s.7-1.5 1.5-1.5 1.5.7 1.5 1.5-.7 1.5-1.5 1.5zm.5-8H6v2h12V5z\" fill-rule=\"nonzero\"/></svg>',\n        'quote': '<svg width=\"24\" height=\"24\"><path d=\"M7.5 17h.9c.4 0 .7-.2.9-.6L11 13V8c0-.6-.4-1-1-1H6a1 1 0 0 0-1 1v4c0 .6.4 1 1 1h2l-1.3 2.7a1 1 0 0 0 .8 1.3zm8 0h.9c.4 0 .7-.2.9-.6L19 13V8c0-.6-.4-1-1-1h-4a1 1 0 0 0-1 1v4c0 .6.4 1 1 1h2l-1.3 2.7a1 1 0 0 0 .8 1.3z\" fill-rule=\"nonzero\"/></svg>',\n        'redo': '<svg width=\"24\" height=\"24\"><path d=\"M17.6 10H12c-2.8 0-4.4 1.4-4.9 3.5-.4 2 .3 4 1.4 4.6a1 1 0 1 1-1 1.8c-2-1.2-2.9-4.1-2.3-6.8.6-3 3-5.1 6.8-5.1h5.6l-3.3-3.3a1 1 0 1 1 1.4-1.4l5 5a1 1 0 0 1 0 1.4l-5 5a1 1 0 0 1-1.4-1.4l3.3-3.3z\" fill-rule=\"nonzero\"/></svg>',\n        'reload': '<svg width=\"24\" height=\"24\"><g fill-rule=\"nonzero\"><path d=\"M5 22.1l-1.2-4.7v-.2a1 1 0 0 1 1-1l5 .4a1 1 0 1 1-.2 2l-2.2-.2a7.8 7.8 0 0 0 8.4.2 7.5 7.5 0 0 0 3.5-6.4 1 1 0 1 1 2 0 9.5 9.5 0 0 1-4.5 8 9.9 9.9 0 0 1-10.2 0l.4 1.4a1 1 0 1 1-2 .5zM13.6 7.4c0-.5.5-1 1-.9l2.8.2a8 8 0 0 0-9.5-1 7.5 7.5 0 0 0-3.6 7 1 1 0 0 1-2 0 9.5 9.5 0 0 1 4.5-8.6 10 10 0 0 1 10.9.3l-.3-1a1 1 0 0 1 2-.5l1.1 4.8a1 1 0 0 1-1 1.2l-5-.4a1 1 0 0 1-.9-1z\"/></g></svg>',\n        'remove-formatting': '<svg width=\"24\" height=\"24\"><path d=\"M13.2 6a1 1 0 0 1 0 .2l-2.6 10a1 1 0 0 1-1 .8h-.2a.8.8 0 0 1-.8-1l2.6-10H8a1 1 0 1 1 0-2h9a1 1 0 0 1 0 2h-3.8zM5 18h7a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2zm13 1.5L16.5 18 15 19.5a.7.7 0 0 1-1-1l1.5-1.5-1.5-1.5a.7.7 0 0 1 1-1l1.5 1.5 1.5-1.5a.7.7 0 0 1 1 1L17.5 17l1.5 1.5a.7.7 0 0 1-1 1z\" fill-rule=\"evenodd\"/></svg>',\n        'remove': '<svg width=\"24\" height=\"24\"><path d=\"M16 7h3a1 1 0 0 1 0 2h-1v9a3 3 0 0 1-3 3H9a3 3 0 0 1-3-3V9H5a1 1 0 1 1 0-2h3V6a3 3 0 0 1 3-3h2a3 3 0 0 1 3 3v1zm-2 0V6c0-.6-.4-1-1-1h-2a1 1 0 0 0-1 1v1h4zm2 2H8v9c0 .6.4 1 1 1h6c.6 0 1-.4 1-1V9zm-7 3a1 1 0 0 1 2 0v4a1 1 0 0 1-2 0v-4zm4 0a1 1 0 0 1 2 0v4a1 1 0 0 1-2 0v-4z\" fill-rule=\"nonzero\"/></svg>',\n        'resize-handle': '<svg width=\"10\" height=\"10\"><g fill-rule=\"nonzero\"><path d=\"M8.1 1.1A.5.5 0 1 1 9 2l-7 7A.5.5 0 1 1 1 8l7-7zM8.1 5.1A.5.5 0 1 1 9 6l-3 3A.5.5 0 1 1 5 8l3-3z\"/></g></svg>',\n        'resize': '<svg width=\"24\" height=\"24\"><path d=\"M4 5c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3h6c.3 0 .5.1.7.3.2.2.3.4.3.7 0 .3-.1.5-.3.7a1 1 0 0 1-.7.3H7.4L18 16.6V13c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3.3 0 .5.1.7.3.2.2.3.4.3.7v6c0 .3-.1.5-.3.7a1 1 0 0 1-.7.3h-6a1 1 0 0 1-.7-.3 1 1 0 0 1-.3-.7c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3h3.6L6 7.4V11c0 .3-.1.5-.3.7a1 1 0 0 1-.7.3 1 1 0 0 1-.7-.3A1 1 0 0 1 4 11V5z\" fill-rule=\"evenodd\"/></svg>',\n        'restore-draft': '<svg width=\"24\" height=\"24\"><g fill-rule=\"evenodd\"><path d=\"M17 13c0 .6-.4 1-1 1h-4V8c0-.6.4-1 1-1s1 .4 1 1v4h2c.6 0 1 .4 1 1z\"/><path d=\"M4.7 10H9a1 1 0 0 1 0 2H3a1 1 0 0 1-1-1V5a1 1 0 1 1 2 0v3l2.5-2.4a9.2 9.2 0 0 1 10.8-1.5A9 9 0 0 1 13.4 21c-2.4.1-4.7-.7-6.5-2.2a1 1 0 1 1 1.3-1.5 7.2 7.2 0 0 0 11.6-3.7 7 7 0 0 0-3.5-7.7A7.2 7.2 0 0 0 8 7L4.7 10z\" fill-rule=\"nonzero\"/></g></svg>',\n        'rotate-left': '<svg width=\"24\" height=\"24\"><path d=\"M4.7 10H9a1 1 0 0 1 0 2H3a1 1 0 0 1-1-1V5a1 1 0 1 1 2 0v3l2.5-2.4a9.2 9.2 0 0 1 10.8-1.5A9 9 0 0 1 13.4 21c-2.4.1-4.7-.7-6.5-2.2a1 1 0 1 1 1.3-1.5 7.2 7.2 0 0 0 11.6-3.7 7 7 0 0 0-3.5-7.7A7.2 7.2 0 0 0 8 7L4.7 10z\" fill-rule=\"nonzero\"/></svg>',\n        'rotate-right': '<svg width=\"24\" height=\"24\"><path d=\"M20 8V5a1 1 0 0 1 2 0v6c0 .6-.4 1-1 1h-6a1 1 0 0 1 0-2h4.3L16 7A7.2 7.2 0 0 0 7.7 6a7 7 0 0 0 3 13.1c1.9.1 3.7-.5 5-1.7a1 1 0 0 1 1.4 1.5A9.2 9.2 0 0 1 2.2 14c-.9-3.9 1-8 4.5-9.9 3.5-1.9 8-1.3 10.8 1.5L20 8z\" fill-rule=\"nonzero\"/></svg>',\n        'rtl': '<svg width=\"24\" height=\"24\"><path d=\"M8 5h8v2h-2v12h-2V7h-2v12H8v-7c-.5 0-1 0-1.4-.3A3.4 3.4 0 0 1 4.8 10a3.3 3.3 0 0 1 0-2.8 3.4 3.4 0 0 1 1.8-1.8L8 5zm12 11.2a1 1 0 1 1-1 1.6l-3-2a1 1 0 0 1 0-1.6l3-2a1 1 0 1 1 1 1.6L18.4 15l1.8 1.2z\" fill-rule=\"evenodd\"/></svg>',\n        'save': '<svg width=\"24\" height=\"24\"><path d=\"M5 16h14a2 2 0 0 1 2 2v2a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-2c0-1.1.9-2 2-2zm0 2v2h14v-2H5zm10 0h2v2h-2v-2zm-4-6.4L8.7 9.3a1 1 0 1 0-1.4 1.4l4 4c.4.4 1 .4 1.4 0l4-4a1 1 0 1 0-1.4-1.4L13 11.6V4a1 1 0 0 0-2 0v7.6z\" fill-rule=\"nonzero\"/></svg>',\n        'search': '<svg width=\"24\" height=\"24\"><path d=\"M16 17.3a8 8 0 1 1 1.4-1.4l4.3 4.4a1 1 0 0 1-1.4 1.4l-4.4-4.3zm-5-.3a6 6 0 1 0 0-12 6 6 0 0 0 0 12z\" fill-rule=\"nonzero\"/></svg>',\n        'select-all': '<svg width=\"24\" height=\"24\"><path d=\"M3 5h2V3a2 2 0 0 0-2 2zm0 8h2v-2H3v2zm4 8h2v-2H7v2zM3 9h2V7H3v2zm10-6h-2v2h2V3zm6 0v2h2a2 2 0 0 0-2-2zM5 21v-2H3c0 1.1.9 2 2 2zm-2-4h2v-2H3v2zM9 3H7v2h2V3zm2 18h2v-2h-2v2zm8-8h2v-2h-2v2zm0 8a2 2 0 0 0 2-2h-2v2zm0-12h2V7h-2v2zm0 8h2v-2h-2v2zm-4 4h2v-2h-2v2zm0-16h2V3h-2v2zM7 17h10V7H7v10zm2-8h6v6H9V9z\" fill-rule=\"nonzero\"/></svg>',\n        'selected': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M6 4h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2zm3.6 10.9L7 12.3a.7.7 0 0 0-1 1L9.6 17 18 8.6a.7.7 0 0 0 0-1 .7.7 0 0 0-1 0l-7.4 7.3z\"/></svg>',\n        'settings': '<svg width=\"24\" height=\"24\"><path d=\"M11 6h8c.6 0 1 .4 1 1s-.4 1-1 1h-8v.3c0 .2 0 .3-.2.5l-.6.2H7.8c-.3 0-.4 0-.6-.2a.7.7 0 0 1-.2-.6V8H5a1 1 0 1 1 0-2h2v-.3c0-.2 0-.3.2-.5l.5-.2h2.5c.3 0 .4 0 .6.2l.2.5V6zM8 8h2V6H8v2zm9 2.8v.2h2c.6 0 1 .4 1 1s-.4 1-1 1h-2v.3c0 .2 0 .3-.2.5l-.6.2h-2.4c-.3 0-.4 0-.6-.2a.7.7 0 0 1-.2-.6V13H5a1 1 0 0 1 0-2h8v-.3c0-.2 0-.3.2-.5l.6-.2h2.4c.3 0 .4 0 .6.2l.2.6zM14 13h2v-2h-2v2zm-3 2.8v.2h8c.6 0 1 .4 1 1s-.4 1-1 1h-8v.3c0 .2 0 .3-.2.5l-.6.2H7.8c-.3 0-.4 0-.6-.2a.7.7 0 0 1-.2-.6V18H5a1 1 0 0 1 0-2h2v-.3c0-.2 0-.3.2-.5l.5-.2h2.5c.3 0 .4 0 .6.2l.2.6zM8 18h2v-2H8v2z\" fill-rule=\"evenodd\"/></svg>',\n        'sharpen': '<svg width=\"24\" height=\"24\"><path d=\"M16 6l4 4-8 9-8-9 4-4h8zm-4 10.2l5.5-6.2-.1-.1H12v-.3h5.1l-.2-.2H12V9h4.6l-.2-.2H12v-.3h4.1l-.2-.2H12V8h3.6l-.2-.2H8.7L6.5 10l.1.1H12v.3H6.9l.2.2H12v.3H7.3l.2.2H12v.3H7.7l.3.2h4v.3H8.2l.2.2H12v.3H8.6l.3.2H12v.3H9l.3.2H12v.3H9.5l.2.2H12v.3h-2l.2.2H12v.3h-1.6l.2.2H12v.3h-1.1l.2.2h.9v.3h-.7l.2.2h.5v.3h-.3l.3.2z\" fill-rule=\"evenodd\"/></svg>',\n        'sort-asc': '<svg width=\"24\" height=\"24\"><g fill-rule=\"evenodd\"><path d=\"M4 8h5a1 1 0 1 1 0 2H4a1 1 0 1 1 0-2zm0 8h8a1 1 0 0 1 0 2H4a1 1 0 0 1 0-2zm0-4h7a1 1 0 0 1 0 2H4a1 1 0 0 1 0-2z\"/><path fill-rule=\"nonzero\" d=\"M16 8.4l-2.3 2.3a1 1 0 0 1-1.4-1.4l4-4a1 1 0 0 1 1.4 0l4 4a1 1 0 1 1-1.4 1.4L18 8.4V18a1 1 0 0 1-2 0V8.4z\"/></g></svg>',\n        'sort-dsc': '<svg width=\"24\" height=\"24\"><g fill-rule=\"evenodd\"><path d=\"M4 16h5a1 1 0 0 0 0-2H4a1 1 0 0 0 0 2zm0-8h8a1 1 0 0 0 0-2H4a1 1 0 1 0 0 2zm0 4h7a1 1 0 0 0 0-2H4a1 1 0 0 0 0 2z\"/><path fill-rule=\"nonzero\" d=\"M16 15.6l-2.3-2.3a1 1 0 0 0-1.4 1.4l4 4c.4.4 1 .4 1.4 0l4-4a1 1 0 0 0-1.4-1.4L18 15.6V6a1 1 0 0 0-2 0v9.6z\"/></g></svg>',\n        'sourcecode': '<svg width=\"24\" height=\"24\"><g fill-rule=\"nonzero\"><path d=\"M9.8 15.7c.3.3.3.8 0 1-.3.4-.9.4-1.2 0l-4.4-4.1a.8.8 0 0 1 0-1.2l4.4-4.2c.3-.3.9-.3 1.2 0 .3.3.3.8 0 1.1L6 12l3.8 3.7zM14.2 15.7c-.3.3-.3.8 0 1 .4.4.9.4 1.2 0l4.4-4.1c.3-.3.3-.9 0-1.2l-4.4-4.2a.8.8 0 0 0-1.2 0c-.3.3-.3.8 0 1.1L18 12l-3.8 3.7z\"/></g></svg>',\n        'spell-check': '<svg width=\"24\" height=\"24\"><path d=\"M6 8v3H5V5c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3h2c.3 0 .5.1.7.3.2.2.3.4.3.7v6H8V8H6zm0-3v2h2V5H6zm13 0h-3v5h3v1h-3a1 1 0 0 1-.7-.3 1 1 0 0 1-.3-.7V5c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3h3v1zm-5 1.5l-.1.7c-.1.2-.3.3-.6.3.3 0 .5.1.6.3l.1.7V10c0 .3-.1.5-.3.7a1 1 0 0 1-.7.3h-3V4h3c.3 0 .5.1.7.3.2.2.3.4.3.7v1.5zM13 10V8h-2v2h2zm0-3V5h-2v2h2zm3 5l1 1-6.5 7L7 15.5l1.3-1 2.2 2.2L16 12z\" fill-rule=\"evenodd\"/></svg>',\n        'strike-through': '<svg width=\"24\" height=\"24\"><g fill-rule=\"evenodd\"><path d=\"M15.6 8.5c-.5-.7-1-1.1-1.3-1.3-.6-.4-1.3-.6-2-.6-2.7 0-2.8 1.7-2.8 2.1 0 1.6 1.8 2 3.2 2.3 4.4.9 4.6 2.8 4.6 3.9 0 1.4-.7 4.1-5 4.1A6.2 6.2 0 0 1 7 16.4l1.5-1.1c.4.6 1.6 2 3.7 2 1.6 0 2.5-.4 3-1.2.4-.8.3-2-.8-2.6-.7-.4-1.6-.7-2.9-1-1-.2-3.9-.8-3.9-3.6C7.6 6 10.3 5 12.4 5c2.9 0 4.2 1.6 4.7 2.4l-1.5 1.1z\"/><path d=\"M5 11h14a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2z\" fill-rule=\"nonzero\"/></g></svg>',\n        'subscript': '<svg width=\"24\" height=\"24\"><path d=\"M10.4 10l4.6 4.6-1.4 1.4L9 11.4 4.4 16 3 14.6 7.6 10 3 5.4 4.4 4 9 8.6 13.6 4 15 5.4 10.4 10zM21 19h-5v-1l1-.8 1.7-1.6c.3-.4.5-.8.5-1.2 0-.3 0-.6-.2-.7-.2-.2-.5-.3-.9-.3a2 2 0 0 0-.8.2l-.7.3-.4-1.1 1-.6 1.2-.2c.8 0 1.4.3 1.8.7.4.4.6.9.6 1.5s-.2 1.1-.5 1.6a8 8 0 0 1-1.3 1.3l-.6.6h2.6V19z\" fill-rule=\"nonzero\"/></svg>',\n        'superscript': '<svg width=\"24\" height=\"24\"><path d=\"M15 9.4L10.4 14l4.6 4.6-1.4 1.4L9 15.4 4.4 20 3 18.6 7.6 14 3 9.4 4.4 8 9 12.6 13.6 8 15 9.4zm5.9 1.6h-5v-1l1-.8 1.7-1.6c.3-.5.5-.9.5-1.3 0-.3 0-.5-.2-.7-.2-.2-.5-.3-.9-.3l-.8.2-.7.4-.4-1.2c.2-.2.5-.4 1-.5.3-.2.8-.2 1.2-.2.8 0 1.4.2 1.8.6.4.4.6 1 .6 1.6 0 .5-.2 1-.5 1.5l-1.3 1.4-.6.5h2.6V11z\" fill-rule=\"nonzero\"/></svg>',\n        'table-cell-properties': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zm-8 9H5v5h6v-5zm8 0h-6v5h6v-5zm-8-7H5v5h6V6z\"/></svg>',\n        'table-cell-select-all': '<svg width=\"24\" height=\"24\"><g fill-rule=\"evenodd\"><path fill-rule=\"nonzero\" d=\"M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zm0 2H5v12h14V6z\"/><path d=\"M13 6v5h6v2h-6v5h-2v-5H5v-2h6V6h2z\" opacity=\".2\"/></g></svg>',\n        'table-cell-select-inner': '<svg width=\"24\" height=\"24\"><g fill-rule=\"evenodd\"><path fill-rule=\"nonzero\" d=\"M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zm0 2H5v12h14V6z\" opacity=\".2\"/><path d=\"M13 6v5h6v2h-6v5h-2v-5H5v-2h6V6h2z\"/></g></svg>',\n        'table-delete-column': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zm-4 4h-2V6h-2v2H9V6H5v12h4v-2h2v2h2v-2h2v2h4V6h-4v2zm.3.5l1 1.2-3 2.3 3 2.3-1 1.2L12 13l-3.3 2.6-1-1.2 3-2.3-3-2.3 1-1.2L12 11l3.3-2.5z\"/></svg>',\n        'table-delete-row': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zm0 2H5v3h2.5v2H5v2h2.5v2H5v3h14v-3h-2.5v-2H19v-2h-2.5V9H19V6zm-4.7 1.8l1.2 1L13 12l2.6 3.3-1.2 1-2.3-3-2.3 3-1.2-1L11 12 8.5 8.7l1.2-1 2.3 3 2.3-3z\"/></svg>',\n        'table-delete-table': '<svg width=\"24\" height=\"24\"><g fill-rule=\"nonzero\"><path d=\"M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zM5 6v12h14V6H5z\"/><path d=\"M14.4 8.6l1 1-2.3 2.4 2.3 2.4-1 1-2.4-2.3-2.4 2.3-1-1 2.3-2.4-2.3-2.4 1-1 2.4 2.3z\"/></g></svg>',\n        'table-insert-column-after': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M20 4c.6 0 1 .4 1 1v2a1 1 0 0 1-2 0V6h-8v12h8v-1a1 1 0 0 1 2 0v2c0 .5-.4 1-.9 1H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h15zM9 13H5v5h4v-5zm7-5c.5 0 1 .4 1 .9V11h2a1 1 0 0 1 .1 2H17v2a1 1 0 0 1-2 .1V13h-2a1 1 0 0 1-.1-2H15V9c0-.6.4-1 1-1zM9 6H5v5h4V6z\"/></svg>',\n        'table-insert-column-before': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a1 1 0 0 1-1-1v-2a1 1 0 0 1 2 0v1h8V6H5v1a1 1 0 1 1-2 0V5c0-.6.4-1 1-1h15zm0 9h-4v5h4v-5zM8 8c.5 0 1 .4 1 .9V11h2a1 1 0 0 1 .1 2H9v2a1 1 0 0 1-2 .1V13H5a1 1 0 0 1-.1-2H7V9c0-.6.4-1 1-1zm11-2h-4v5h4V6z\"/></svg>',\n        'table-insert-row-above': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M6 4a1 1 0 1 1 0 2H5v6h14V6h-1a1 1 0 0 1 0-2h2c.6 0 1 .4 1 1v13a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5c0-.6.4-1 1-1h2zm5 10H5v4h6v-4zm8 0h-6v4h6v-4zM12 3c.5 0 1 .4 1 .9V6h2a1 1 0 0 1 0 2h-2v2a1 1 0 0 1-2 .1V8H9a1 1 0 0 1 0-2h2V4c0-.6.4-1 1-1z\"/></svg>',\n        'table-insert-row-after': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M12 13c.5 0 1 .4 1 .9V16h2a1 1 0 0 1 .1 2H13v2a1 1 0 0 1-2 .1V18H9a1 1 0 0 1-.1-2H11v-2c0-.6.4-1 1-1zm6 7a1 1 0 0 1 0-2h1v-6H5v6h1a1 1 0 0 1 0 2H4a1 1 0 0 1-1-1V6c0-1.1.9-2 2-2h14a2 2 0 0 1 2 2v13c0 .5-.4 1-.9 1H18zM11 6H5v4h6V6zm8 0h-6v4h6V6z\"/></svg>',\n        'table-left-header': '<svg width=\"24\" height=\"24\"><path d=\"M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zm0 9h-4v5h4v-5zm-6 0H9v5h4v-5zm0-7H9v5h4V6zm6 0h-4v5h4V6z\"/></svg>',\n        'table-merge-cells': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zM5 15.5V18h3v-2.5H5zm14-5h-9V18h9v-7.5zM19 6h-4v2.5h4V6zM8 6H5v2.5h3V6zm5 0h-3v2.5h3V6zm-8 7.5h3v-3H5v3z\"/></svg>',\n        'table-row-properties': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zM5 15v3h6v-3H5zm14 0h-6v3h6v-3zm0-9h-6v3h6V6zM5 9h6V6H5v3z\"/></svg>',\n        'table-split-cells': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zM8 15.5H5V18h3v-2.5zm11-5h-9V18h9v-7.5zm-2.5 1l1 1-2 2 2 2-1 1-2-2-2 2-1-1 2-2-2-2 1-1 2 2 2-2zm-8.5-1H5v3h3v-3zM19 6h-4v2.5h4V6zM8 6H5v2.5h3V6zm5 0h-3v2.5h3V6z\"/></svg>',\n        'table-top-header': '<svg width=\"24\" height=\"24\"><path d=\"M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zm-8 11H5v3h6v-3zm8 0h-6v3h6v-3zm0-5h-6v3h6v-3zM5 13h6v-3H5v3z\"/></svg>',\n        'table': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zM5 14v4h6v-4H5zm14 0h-6v4h6v-4zm0-6h-6v4h6V8zM5 12h6V8H5v4z\"/></svg>',\n        'template': '<svg width=\"24\" height=\"24\"><path d=\"M19 19v-1H5v1h14zM9 16v-4a5 5 0 1 1 6 0v4h4a2 2 0 0 1 2 2v3H3v-3c0-1.1.9-2 2-2h4zm4 0v-5l.8-.6a3 3 0 1 0-3.6 0l.8.6v5h2z\" fill-rule=\"nonzero\"/></svg>',\n        'temporary-placeholder': '<svg width=\"24\" height=\"24\"><g fill-rule=\"evenodd\"><path d=\"M9 7.6V6h2.5V4.5a.5.5 0 1 1 1 0V6H15v1.6a8 8 0 1 1-6 0zm-2.6 5.3a.5.5 0 0 0 .3.6c.3 0 .6 0 .6-.3l.1-.2a5 5 0 0 1 3.3-2.8c.3-.1.4-.4.4-.6-.1-.3-.4-.5-.6-.4a6 6 0 0 0-4.1 3.7z\"/><circle cx=\"14\" cy=\"4\" r=\"1\"/><circle cx=\"12\" cy=\"2\" r=\"1\"/><circle cx=\"10\" cy=\"4\" r=\"1\"/></g></svg>',\n        'text-color': '<svg width=\"24\" height=\"24\"><g fill-rule=\"evenodd\"><path id=\"tox-icon-text-color__color\" d=\"M3 18h18v3H3z\"/><path d=\"M8.7 16h-.8a.5.5 0 0 1-.5-.6l2.7-9c.1-.3.3-.4.5-.4h2.8c.2 0 .4.1.5.4l2.7 9a.5.5 0 0 1-.5.6h-.8a.5.5 0 0 1-.4-.4l-.7-2.2c0-.3-.3-.4-.5-.4h-3.4c-.2 0-.4.1-.5.4l-.7 2.2c0 .3-.2.4-.4.4zm2.6-7.6l-.6 2a.5.5 0 0 0 .5.6h1.6a.5.5 0 0 0 .5-.6l-.6-2c0-.3-.3-.4-.5-.4h-.4c-.2 0-.4.1-.5.4z\"/></g></svg>',\n        'toc': '<svg width=\"24\" height=\"24\"><path d=\"M5 5c.6 0 1 .4 1 1s-.4 1-1 1a1 1 0 1 1 0-2zm3 0h11c.6 0 1 .4 1 1s-.4 1-1 1H8a1 1 0 1 1 0-2zm-3 8c.6 0 1 .4 1 1s-.4 1-1 1a1 1 0 0 1 0-2zm3 0h11c.6 0 1 .4 1 1s-.4 1-1 1H8a1 1 0 0 1 0-2zm0-4c.6 0 1 .4 1 1s-.4 1-1 1a1 1 0 1 1 0-2zm3 0h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zm-3 8c.6 0 1 .4 1 1s-.4 1-1 1a1 1 0 0 1 0-2zm3 0h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2z\" fill-rule=\"evenodd\"/></svg>',\n        'translate': '<svg width=\"24\" height=\"24\"><path d=\"M12.7 14.3l-.3.7-.4.7-2.2-2.2-3.1 3c-.3.4-.8.4-1 0a.7.7 0 0 1 0-1l3.1-3A12.4 12.4 0 0 1 6.7 9H8a10.1 10.1 0 0 0 1.7 2.4c.5-.5 1-1.1 1.4-1.8l.9-2H4.7a.7.7 0 1 1 0-1.5h4.4v-.7c0-.4.3-.8.7-.8.4 0 .7.4.7.8v.7H15c.4 0 .8.3.8.7 0 .4-.4.8-.8.8h-1.4a12.3 12.3 0 0 1-1 2.4 13.5 13.5 0 0 1-1.7 2.3l1.9 1.8zm4.3-3l2.7 7.3a.5.5 0 0 1-.4.7 1 1 0 0 1-1-.7l-.6-1.5h-3.4l-.6 1.5a1 1 0 0 1-1 .7.5.5 0 0 1-.4-.7l2.7-7.4a1 1 0 1 1 2 0zm-2.2 4.4h2.4L16 12.5l-1.2 3.2z\" fill-rule=\"evenodd\"/></svg>',\n        'underline': '<svg width=\"24\" height=\"24\"><path d=\"M16 5c.6 0 1 .4 1 1v5.5a4 4 0 0 1-.4 1.8l-1 1.4a5.3 5.3 0 0 1-5.5 1 5 5 0 0 1-1.6-1c-.5-.4-.8-.9-1.1-1.4a4 4 0 0 1-.4-1.8V6c0-.6.4-1 1-1s1 .4 1 1v5.5c0 .3 0 .6.2 1l.6.7a3.3 3.3 0 0 0 2.2.8 3.4 3.4 0 0 0 2.2-.8c.3-.2.4-.5.6-.8l.2-.9V6c0-.6.4-1 1-1zM8 17h8c.6 0 1 .4 1 1s-.4 1-1 1H8a1 1 0 0 1 0-2z\" fill-rule=\"evenodd\"/></svg>',\n        'undo': '<svg width=\"24\" height=\"24\"><path d=\"M6.4 8H12c3.7 0 6.2 2 6.8 5.1.6 2.7-.4 5.6-2.3 6.8a1 1 0 0 1-1-1.8c1.1-.6 1.8-2.7 1.4-4.6-.5-2.1-2.1-3.5-4.9-3.5H6.4l3.3 3.3a1 1 0 1 1-1.4 1.4l-5-5a1 1 0 0 1 0-1.4l5-5a1 1 0 0 1 1.4 1.4L6.4 8z\" fill-rule=\"nonzero\"/></svg>',\n        'unlink': '<svg width=\"24\" height=\"24\"><path d=\"M6.2 12.3a1 1 0 0 1 1.4 1.4l-2 2a2 2 0 1 0 2.6 2.8l4.8-4.8a1 1 0 0 0 0-1.4 1 1 0 1 1 1.4-1.3 2.9 2.9 0 0 1 0 4L9.6 20a3.9 3.9 0 0 1-5.5-5.5l2-2zm11.6-.6a1 1 0 0 1-1.4-1.4l2.1-2a2 2 0 1 0-2.7-2.8L11 10.3a1 1 0 0 0 0 1.4A1 1 0 1 1 9.6 13a2.9 2.9 0 0 1 0-4L14.4 4a3.9 3.9 0 0 1 5.5 5.5l-2 2zM7.6 6.3a.8.8 0 0 1-1 1.1L3.3 4.2a.7.7 0 1 1 1-1l3.2 3.1zM5.1 8.6a.8.8 0 0 1 0 1.5H3a.8.8 0 0 1 0-1.5H5zm5-3.5a.8.8 0 0 1-1.5 0V3a.8.8 0 0 1 1.5 0V5zm6 11.8a.8.8 0 0 1 1-1l3.2 3.2a.8.8 0 0 1-1 1L16 17zm-2.2 2a.8.8 0 0 1 1.5 0V21a.8.8 0 0 1-1.5 0V19zm5-3.5a.7.7 0 1 1 0-1.5H21a.8.8 0 0 1 0 1.5H19z\" fill-rule=\"nonzero\"/></svg>',\n        'unlock': '<svg width=\"24\" height=\"24\"><path d=\"M16 5c.8 0 1.5.3 2.1.9.6.6.9 1.3.9 2.1v3h-2V8a1 1 0 0 0-.3-.7A1 1 0 0 0 16 7h-2a1 1 0 0 0-.7.3 1 1 0 0 0-.3.7v3h.3c.2 0 .3 0 .5.2l.2.6v7.4c0 .3 0 .4-.2.6l-.6.2H4.8c-.3 0-.4 0-.6-.2a.7.7 0 0 1-.2-.6v-7.4c0-.3 0-.4.2-.6l.5-.2H11V8c0-.8.3-1.5.9-2.1.6-.6 1.3-.9 2.1-.9h2z\" fill-rule=\"evenodd\"/></svg>',\n        'unordered-list': '<svg width=\"24\" height=\"24\"><path d=\"M11 5h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zm0 6h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zm0 6h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zM4.5 6c0-.4.1-.8.4-1 .3-.4.7-.5 1.1-.5.4 0 .8.1 1 .4.4.3.5.7.5 1.1 0 .4-.1.8-.4 1-.3.4-.7.5-1.1.5-.4 0-.8-.1-1-.4-.4-.3-.5-.7-.5-1.1zm0 6c0-.4.1-.8.4-1 .3-.4.7-.5 1.1-.5.4 0 .8.1 1 .4.4.3.5.7.5 1.1 0 .4-.1.8-.4 1-.3.4-.7.5-1.1.5-.4 0-.8-.1-1-.4-.4-.3-.5-.7-.5-1.1zm0 6c0-.4.1-.8.4-1 .3-.4.7-.5 1.1-.5.4 0 .8.1 1 .4.4.3.5.7.5 1.1 0 .4-.1.8-.4 1-.3.4-.7.5-1.1.5-.4 0-.8-.1-1-.4-.4-.3-.5-.7-.5-1.1z\" fill-rule=\"evenodd\"/></svg>',\n        'unselected': '<svg width=\"24\" height=\"24\"><path fill-rule=\"nonzero\" d=\"M6 4h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2zm0 1a1 1 0 0 0-1 1v12c0 .6.4 1 1 1h12c.6 0 1-.4 1-1V6c0-.6-.4-1-1-1H6z\"/></svg>',\n        'upload': '<svg width=\"24\" height=\"24\"><path d=\"M18 19v-2a1 1 0 0 1 2 0v3c0 .6-.4 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 2 0v2h12zM11 6.4L8.7 8.7a1 1 0 0 1-1.4-1.4l4-4a1 1 0 0 1 1.4 0l4 4a1 1 0 1 1-1.4 1.4L13 6.4V16a1 1 0 0 1-2 0V6.4z\" fill-rule=\"nonzero\"/></svg>',\n        'user': '<svg width=\"24\" height=\"24\"><path d=\"M12 24a12 12 0 1 1 0-24 12 12 0 0 1 0 24zm-8.7-5.3a11 11 0 0 0 17.4 0C19.4 16.3 14.6 15 12 15c-2.6 0-7.4 1.3-8.7 3.7zM12 13c2.2 0 4-2 4-4.5S14.2 4 12 4 8 6 8 8.5 9.8 13 12 13z\" fill-rule=\"nonzero\"/></svg>',\n        'visualblocks': '<svg width=\"24\" height=\"24\"><path d=\"M9 19v2H7v-2h2zm-4 0v2a2 2 0 0 1-2-2h2zm8 0v2h-2v-2h2zm8 0a2 2 0 0 1-2 2v-2h2zm-4 0v2h-2v-2h2zM15 7a1 1 0 0 1 0 2v7a1 1 0 0 1-2 0V9h-1v7a1 1 0 0 1-2 0v-4a2.5 2.5 0 0 1-.2-5H15zM5 15v2H3v-2h2zm16 0v2h-2v-2h2zM5 11v2H3v-2h2zm16 0v2h-2v-2h2zM5 7v2H3V7h2zm16 0v2h-2V7h2zM5 3v2H3c0-1.1.9-2 2-2zm8 0v2h-2V3h2zm6 0a2 2 0 0 1 2 2h-2V3zM9 3v2H7V3h2zm8 0v2h-2V3h2z\" fill-rule=\"evenodd\"/></svg>',\n        'visualchars': '<svg width=\"24\" height=\"24\"><path d=\"M10 5h7a1 1 0 0 1 0 2h-1v11a1 1 0 0 1-2 0V7h-2v11a1 1 0 0 1-2 0v-6c-.5 0-1 0-1.4-.3A3.4 3.4 0 0 1 6.8 10a3.3 3.3 0 0 1 0-2.8 3.4 3.4 0 0 1 1.8-1.8L10 5z\" fill-rule=\"evenodd\"/></svg>',\n        'warning': '<svg width=\"24\" height=\"24\"><path d=\"M19.8 18.3c.2.5.3.9 0 1.2-.1.3-.5.5-1 .5H5.2c-.5 0-.9-.2-1-.5-.3-.3-.2-.7 0-1.2L11 4.7l.5-.5.5-.2c.2 0 .3 0 .5.2.2 0 .3.3.5.5l6.8 13.6zM12 18c.3 0 .5-.1.7-.3.2-.2.3-.4.3-.7a1 1 0 0 0-.3-.7 1 1 0 0 0-.7-.3 1 1 0 0 0-.7.3 1 1 0 0 0-.3.7c0 .3.1.5.3.7.2.2.4.3.7.3zm.7-3l.3-4a1 1 0 0 0-.3-.7 1 1 0 0 0-.7-.3 1 1 0 0 0-.7.3 1 1 0 0 0-.3.7l.3 4h1.4z\" fill-rule=\"evenodd\"/></svg>',\n        'zoom-in': '<svg width=\"24\" height=\"24\"><path d=\"M16 17.3a8 8 0 1 1 1.4-1.4l4.3 4.4a1 1 0 0 1-1.4 1.4l-4.4-4.3zm-5-.3a6 6 0 1 0 0-12 6 6 0 0 0 0 12zm-1-9a1 1 0 0 1 2 0v6a1 1 0 0 1-2 0V8zm-2 4a1 1 0 0 1 0-2h6a1 1 0 0 1 0 2H8z\" fill-rule=\"nonzero\"/></svg>',\n        'zoom-out': '<svg width=\"24\" height=\"24\"><path d=\"M16 17.3a8 8 0 1 1 1.4-1.4l4.3 4.4a1 1 0 0 1-1.4 1.4l-4.4-4.3zm-5-.3a6 6 0 1 0 0-12 6 6 0 0 0 0 12zm-3-5a1 1 0 0 1 0-2h6a1 1 0 0 1 0 2H8z\" fill-rule=\"nonzero\"/></svg>'\n      };\n    };\n\n    var isContentCssSkinName = function (url) {\n      return /^[a-z0-9\\-]+$/i.test(url);\n    };\n    var getContentCssUrls = function (editor) {\n      var contentCss = Settings.getContentCss(editor);\n      var skinUrl = editor.editorManager.baseURL + '/skins/content';\n      var suffix = editor.editorManager.suffix;\n      var contentCssFile = 'content' + suffix + '.css';\n      var inline = editor.inline === true;\n      return map(contentCss, function (url) {\n        if (isContentCssSkinName(url) && !inline) {\n          return skinUrl + '/' + url + '/' + contentCssFile;\n        } else {\n          return editor.documentBaseURI.toAbsolute(url);\n        }\n      });\n    };\n    var appendContentCssFromSettings = function (editor) {\n      editor.contentCSS = editor.contentCSS.concat(getContentCssUrls(editor));\n    };\n\n    function BookmarkManager(selection) {\n      return {\n        getBookmark: curry(Bookmarks.getBookmark, selection),\n        moveToBookmark: curry(Bookmarks.moveToBookmark, selection)\n      };\n    }\n    (function (BookmarkManager) {\n      BookmarkManager.isBookmarkNode = Bookmarks.isBookmarkNode;\n    }(BookmarkManager || (BookmarkManager = {})));\n    var BookmarkManager$1 = BookmarkManager;\n\n    var isXYWithinRange = function (clientX, clientY, range) {\n      if (range.collapsed) {\n        return false;\n      }\n      if (Env.browser.isIE() && range.startOffset === range.endOffset - 1 && range.startContainer === range.endContainer) {\n        var elm = range.startContainer.childNodes[range.startOffset];\n        if (NodeType.isElement(elm)) {\n          return exists(elm.getClientRects(), function (rect) {\n            return containsXY(rect, clientX, clientY);\n          });\n        }\n      }\n      return exists(range.getClientRects(), function (rect) {\n        return containsXY(rect, clientX, clientY);\n      });\n    };\n    var RangePoint = { isXYWithinRange: isXYWithinRange };\n\n    var VK = {\n      BACKSPACE: 8,\n      DELETE: 46,\n      DOWN: 40,\n      ENTER: 13,\n      LEFT: 37,\n      RIGHT: 39,\n      SPACEBAR: 32,\n      TAB: 9,\n      UP: 38,\n      END: 35,\n      HOME: 36,\n      modifierPressed: function (e) {\n        return e.shiftKey || e.ctrlKey || e.altKey || this.metaKeyPressed(e);\n      },\n      metaKeyPressed: function (e) {\n        return Env.mac ? e.metaKey : e.ctrlKey && !e.altKey;\n      }\n    };\n\n    var isContentEditableFalse$6 = NodeType.isContentEditableFalse;\n    var isContentEditableTrue$2 = NodeType.isContentEditableTrue;\n    var getContentEditableRoot = function (root, node) {\n      while (node && node !== root) {\n        if (isContentEditableTrue$2(node) || isContentEditableFalse$6(node)) {\n          return node;\n        }\n        node = node.parentNode;\n      }\n      return null;\n    };\n    var ControlSelection = function (selection, editor) {\n      var dom = editor.dom, each = Tools.each;\n      var selectedElm, selectedElmGhost, resizeHelper, resizeHandles, selectedHandle;\n      var startX, startY, selectedElmX, selectedElmY, startW, startH, ratio, resizeStarted;\n      var width, height;\n      var editableDoc = editor.getDoc(), rootDocument = domGlobals.document;\n      var abs = Math.abs, round = Math.round, rootElement = editor.getBody();\n      var startScrollWidth, startScrollHeight;\n      resizeHandles = {\n        nw: [\n          0,\n          0,\n          -1,\n          -1\n        ],\n        ne: [\n          1,\n          0,\n          1,\n          -1\n        ],\n        se: [\n          1,\n          1,\n          1,\n          1\n        ],\n        sw: [\n          0,\n          1,\n          -1,\n          1\n        ]\n      };\n      var isImage = function (elm) {\n        return elm && (elm.nodeName === 'IMG' || editor.dom.is(elm, 'figure.image'));\n      };\n      var isEventOnImageOutsideRange = function (evt, range) {\n        if (evt.type === 'longpress' || evt.type.indexOf('touch') === 0) {\n          var touch = evt.touches[0];\n          return isImage(evt.target) && !RangePoint.isXYWithinRange(touch.clientX, touch.clientY, range);\n        } else {\n          return isImage(evt.target) && !RangePoint.isXYWithinRange(evt.clientX, evt.clientY, range);\n        }\n      };\n      var contextMenuSelectImage = function (evt) {\n        var target = evt.target;\n        if (isEventOnImageOutsideRange(evt, editor.selection.getRng()) && !evt.isDefaultPrevented()) {\n          editor.selection.select(target);\n        }\n      };\n      var getResizeTarget = function (elm) {\n        return editor.dom.is(elm, 'figure.image') ? elm.querySelector('img') : elm;\n      };\n      var isResizable = function (elm) {\n        var selector = Settings.getObjectResizing(editor);\n        if (selector === false || Env.iOS) {\n          return false;\n        }\n        if (typeof selector !== 'string') {\n          selector = 'table,img,figure.image,div';\n        }\n        if (elm.getAttribute('data-mce-resize') === 'false') {\n          return false;\n        }\n        if (elm === editor.getBody()) {\n          return false;\n        }\n        return is(Element.fromDom(elm), selector);\n      };\n      var resizeGhostElement = function (e) {\n        var deltaX, deltaY, proportional;\n        var resizeHelperX, resizeHelperY;\n        deltaX = e.screenX - startX;\n        deltaY = e.screenY - startY;\n        width = deltaX * selectedHandle[2] + startW;\n        height = deltaY * selectedHandle[3] + startH;\n        width = width < 5 ? 5 : width;\n        height = height < 5 ? 5 : height;\n        if (isImage(selectedElm) && Settings.getResizeImgProportional(editor) !== false) {\n          proportional = !VK.modifierPressed(e);\n        } else {\n          proportional = VK.modifierPressed(e);\n        }\n        if (proportional) {\n          if (abs(deltaX) > abs(deltaY)) {\n            height = round(width * ratio);\n            width = round(height / ratio);\n          } else {\n            width = round(height / ratio);\n            height = round(width * ratio);\n          }\n        }\n        dom.setStyles(getResizeTarget(selectedElmGhost), {\n          width: width,\n          height: height\n        });\n        resizeHelperX = selectedHandle.startPos.x + deltaX;\n        resizeHelperY = selectedHandle.startPos.y + deltaY;\n        resizeHelperX = resizeHelperX > 0 ? resizeHelperX : 0;\n        resizeHelperY = resizeHelperY > 0 ? resizeHelperY : 0;\n        dom.setStyles(resizeHelper, {\n          left: resizeHelperX,\n          top: resizeHelperY,\n          display: 'block'\n        });\n        resizeHelper.innerHTML = width + ' &times; ' + height;\n        if (selectedHandle[2] < 0 && selectedElmGhost.clientWidth <= width) {\n          dom.setStyle(selectedElmGhost, 'left', selectedElmX + (startW - width));\n        }\n        if (selectedHandle[3] < 0 && selectedElmGhost.clientHeight <= height) {\n          dom.setStyle(selectedElmGhost, 'top', selectedElmY + (startH - height));\n        }\n        deltaX = rootElement.scrollWidth - startScrollWidth;\n        deltaY = rootElement.scrollHeight - startScrollHeight;\n        if (deltaX + deltaY !== 0) {\n          dom.setStyles(resizeHelper, {\n            left: resizeHelperX - deltaX,\n            top: resizeHelperY - deltaY\n          });\n        }\n        if (!resizeStarted) {\n          fireObjectResizeStart(editor, selectedElm, startW, startH);\n          resizeStarted = true;\n        }\n      };\n      var endGhostResize = function () {\n        resizeStarted = false;\n        var setSizeProp = function (name, value) {\n          if (value) {\n            if (selectedElm.style[name] || !editor.schema.isValid(selectedElm.nodeName.toLowerCase(), name)) {\n              dom.setStyle(getResizeTarget(selectedElm), name, value);\n            } else {\n              dom.setAttrib(getResizeTarget(selectedElm), name, value);\n            }\n          }\n        };\n        setSizeProp('width', width);\n        setSizeProp('height', height);\n        dom.unbind(editableDoc, 'mousemove', resizeGhostElement);\n        dom.unbind(editableDoc, 'mouseup', endGhostResize);\n        if (rootDocument !== editableDoc) {\n          dom.unbind(rootDocument, 'mousemove', resizeGhostElement);\n          dom.unbind(rootDocument, 'mouseup', endGhostResize);\n        }\n        dom.remove(selectedElmGhost);\n        dom.remove(resizeHelper);\n        showResizeRect(selectedElm);\n        fireObjectResized(editor, selectedElm, width, height);\n        dom.setAttrib(selectedElm, 'style', dom.getAttrib(selectedElm, 'style'));\n        editor.nodeChanged();\n      };\n      var showResizeRect = function (targetElm) {\n        var position, targetWidth, targetHeight, e, rect;\n        hideResizeRect();\n        unbindResizeHandleEvents();\n        position = dom.getPos(targetElm, rootElement);\n        selectedElmX = position.x;\n        selectedElmY = position.y;\n        rect = targetElm.getBoundingClientRect();\n        targetWidth = rect.width || rect.right - rect.left;\n        targetHeight = rect.height || rect.bottom - rect.top;\n        if (selectedElm !== targetElm) {\n          selectedElm = targetElm;\n          width = height = 0;\n        }\n        e = editor.fire('ObjectSelected', { target: targetElm });\n        if (isResizable(targetElm) && !e.isDefaultPrevented()) {\n          each(resizeHandles, function (handle, name) {\n            var handleElm;\n            var startDrag = function (e) {\n              startX = e.screenX;\n              startY = e.screenY;\n              startW = getResizeTarget(selectedElm).clientWidth;\n              startH = getResizeTarget(selectedElm).clientHeight;\n              ratio = startH / startW;\n              selectedHandle = handle;\n              handle.startPos = {\n                x: targetWidth * handle[0] + selectedElmX,\n                y: targetHeight * handle[1] + selectedElmY\n              };\n              startScrollWidth = rootElement.scrollWidth;\n              startScrollHeight = rootElement.scrollHeight;\n              selectedElmGhost = selectedElm.cloneNode(true);\n              dom.addClass(selectedElmGhost, 'mce-clonedresizable');\n              dom.setAttrib(selectedElmGhost, 'data-mce-bogus', 'all');\n              selectedElmGhost.contentEditable = false;\n              selectedElmGhost.unSelectabe = true;\n              dom.setStyles(selectedElmGhost, {\n                left: selectedElmX,\n                top: selectedElmY,\n                margin: 0\n              });\n              selectedElmGhost.removeAttribute('data-mce-selected');\n              rootElement.appendChild(selectedElmGhost);\n              dom.bind(editableDoc, 'mousemove', resizeGhostElement);\n              dom.bind(editableDoc, 'mouseup', endGhostResize);\n              if (rootDocument !== editableDoc) {\n                dom.bind(rootDocument, 'mousemove', resizeGhostElement);\n                dom.bind(rootDocument, 'mouseup', endGhostResize);\n              }\n              resizeHelper = dom.add(rootElement, 'div', {\n                'class': 'mce-resize-helper',\n                'data-mce-bogus': 'all'\n              }, startW + ' &times; ' + startH);\n            };\n            handleElm = dom.get('mceResizeHandle' + name);\n            if (handleElm) {\n              dom.remove(handleElm);\n            }\n            handleElm = dom.add(rootElement, 'div', {\n              'id': 'mceResizeHandle' + name,\n              'data-mce-bogus': 'all',\n              'class': 'mce-resizehandle',\n              'unselectable': true,\n              'style': 'cursor:' + name + '-resize; margin:0; padding:0'\n            });\n            if (Env.ie === 11) {\n              handleElm.contentEditable = false;\n            }\n            dom.bind(handleElm, 'mousedown', function (e) {\n              e.stopImmediatePropagation();\n              e.preventDefault();\n              startDrag(e);\n            });\n            handle.elm = handleElm;\n            dom.setStyles(handleElm, {\n              left: targetWidth * handle[0] + selectedElmX - handleElm.offsetWidth / 2,\n              top: targetHeight * handle[1] + selectedElmY - handleElm.offsetHeight / 2\n            });\n          });\n        } else {\n          hideResizeRect();\n        }\n        selectedElm.setAttribute('data-mce-selected', '1');\n      };\n      var hideResizeRect = function () {\n        var name, handleElm;\n        unbindResizeHandleEvents();\n        if (selectedElm) {\n          selectedElm.removeAttribute('data-mce-selected');\n        }\n        for (name in resizeHandles) {\n          handleElm = dom.get('mceResizeHandle' + name);\n          if (handleElm) {\n            dom.unbind(handleElm);\n            dom.remove(handleElm);\n          }\n        }\n      };\n      var updateResizeRect = function (e) {\n        var startElm, controlElm;\n        var isChildOrEqual = function (node, parent) {\n          if (node) {\n            do {\n              if (node === parent) {\n                return true;\n              }\n            } while (node = node.parentNode);\n          }\n        };\n        if (resizeStarted || editor.removed) {\n          return;\n        }\n        each(dom.select('img[data-mce-selected],hr[data-mce-selected]'), function (img) {\n          img.removeAttribute('data-mce-selected');\n        });\n        controlElm = e.type === 'mousedown' ? e.target : selection.getNode();\n        controlElm = dom.$(controlElm).closest('table,img,figure.image,hr')[0];\n        if (isChildOrEqual(controlElm, rootElement)) {\n          disableGeckoResize();\n          startElm = selection.getStart(true);\n          if (isChildOrEqual(startElm, controlElm) && isChildOrEqual(selection.getEnd(true), controlElm)) {\n            showResizeRect(controlElm);\n            return;\n          }\n        }\n        hideResizeRect();\n      };\n      var isWithinContentEditableFalse = function (elm) {\n        return isContentEditableFalse$6(getContentEditableRoot(editor.getBody(), elm));\n      };\n      var unbindResizeHandleEvents = function () {\n        for (var name_1 in resizeHandles) {\n          var handle = resizeHandles[name_1];\n          if (handle.elm) {\n            dom.unbind(handle.elm);\n            delete handle.elm;\n          }\n        }\n      };\n      var disableGeckoResize = function () {\n        try {\n          editor.getDoc().execCommand('enableObjectResizing', false, false);\n        } catch (ex) {\n        }\n      };\n      editor.on('init', function () {\n        disableGeckoResize();\n        if (Env.browser.isIE() || Env.browser.isEdge()) {\n          editor.on('mousedown click', function (e) {\n            var target = e.target, nodeName = target.nodeName;\n            if (!resizeStarted && /^(TABLE|IMG|HR)$/.test(nodeName) && !isWithinContentEditableFalse(target)) {\n              if (e.button !== 2) {\n                editor.selection.select(target, nodeName === 'TABLE');\n              }\n              if (e.type === 'mousedown') {\n                editor.nodeChanged();\n              }\n            }\n          });\n          var handleMSControlSelect_1 = function (e) {\n            var delayedSelect = function (node) {\n              Delay.setEditorTimeout(editor, function () {\n                return editor.selection.select(node);\n              });\n            };\n            if (isWithinContentEditableFalse(e.target)) {\n              e.preventDefault();\n              delayedSelect(e.target);\n              return;\n            }\n            if (/^(TABLE|IMG|HR)$/.test(e.target.nodeName)) {\n              e.preventDefault();\n              if (e.target.tagName === 'IMG') {\n                delayedSelect(e.target);\n              }\n            }\n          };\n          dom.bind(rootElement, 'mscontrolselect', handleMSControlSelect_1);\n          editor.on('remove', function () {\n            return dom.unbind(rootElement, 'mscontrolselect', handleMSControlSelect_1);\n          });\n        }\n        var throttledUpdateResizeRect = Delay.throttle(function (e) {\n          if (!editor.composing) {\n            updateResizeRect(e);\n          }\n        });\n        editor.on('nodechange ResizeEditor ResizeWindow drop FullscreenStateChanged', throttledUpdateResizeRect);\n        editor.on('keyup compositionend', function (e) {\n          if (selectedElm && selectedElm.nodeName === 'TABLE') {\n            throttledUpdateResizeRect(e);\n          }\n        });\n        editor.on('hide blur', hideResizeRect);\n        editor.on('contextmenu longpress', contextMenuSelectImage, true);\n      });\n      editor.on('remove', unbindResizeHandleEvents);\n      var destroy = function () {\n        selectedElm = selectedElmGhost = null;\n      };\n      return {\n        isResizable: isResizable,\n        showResizeRect: showResizeRect,\n        hideResizeRect: hideResizeRect,\n        updateResizeRect: updateResizeRect,\n        destroy: destroy\n      };\n    };\n\n    function Dimension (name, getOffset) {\n      var set = function (element, h) {\n        if (!isNumber(h) && !h.match(/^[0-9]+$/)) {\n          throw new Error(name + '.set accepts only positive integer values. Value was ' + h);\n        }\n        var dom = element.dom();\n        if (isSupported(dom)) {\n          dom.style[name] = h + 'px';\n        }\n      };\n      var get = function (element) {\n        var r = getOffset(element);\n        if (r <= 0 || r === null) {\n          var css = get$4(element, name);\n          return parseFloat(css) || 0;\n        }\n        return r;\n      };\n      var getOuter = get;\n      var aggregate = function (element, properties) {\n        return foldl(properties, function (acc, property) {\n          var val = get$4(element, property);\n          var value = val === undefined ? 0 : parseInt(val, 10);\n          return isNaN(value) ? acc : acc + value;\n        }, 0);\n      };\n      var max = function (element, value, properties) {\n        var cumulativeInclusions = aggregate(element, properties);\n        var absoluteMax = value > cumulativeInclusions ? value - cumulativeInclusions : 0;\n        return absoluteMax;\n      };\n      return {\n        set: set,\n        get: get,\n        getOuter: getOuter,\n        aggregate: aggregate,\n        max: max\n      };\n    }\n\n    var api$1 = Dimension('height', function (element) {\n      var dom = element.dom();\n      return inBody(element) ? dom.getBoundingClientRect().height : dom.offsetHeight;\n    });\n    var get$8 = function (element) {\n      return api$1.get(element);\n    };\n\n    var walkUp = function (navigation, doc) {\n      var frame = navigation.view(doc);\n      return frame.fold(constant([]), function (f) {\n        var parent = navigation.owner(f);\n        var rest = walkUp(navigation, parent);\n        return [f].concat(rest);\n      });\n    };\n    var pathTo = function (element, navigation) {\n      var d = navigation.owner(element);\n      return walkUp(navigation, d);\n    };\n\n    var view = function (doc) {\n      var element = doc.dom() === domGlobals.document ? Option.none() : Option.from(doc.dom().defaultView.frameElement);\n      return element.map(Element.fromDom);\n    };\n    var owner$1 = function (element) {\n      return owner(element);\n    };\n\n    var Navigation = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        view: view,\n        owner: owner$1\n    });\n\n    var find$3 = function (element) {\n      var doc = Element.fromDom(domGlobals.document);\n      var scroll = get$1(doc);\n      var frames = pathTo(element, Navigation);\n      var offset = viewport(element);\n      var r = foldr(frames, function (b, a) {\n        var loc = viewport(a);\n        return {\n          left: b.left + loc.left(),\n          top: b.top + loc.top()\n        };\n      }, {\n        left: 0,\n        top: 0\n      });\n      return Position(r.left + offset.left() + scroll.left(), r.top + offset.top() + scroll.top());\n    };\n\n    var excludeFromDescend = function (element) {\n      return name(element) === 'textarea';\n    };\n    var fireScrollIntoViewEvent = function (editor, data) {\n      var scrollEvent = editor.fire('ScrollIntoView', data);\n      return scrollEvent.isDefaultPrevented();\n    };\n    var fireAfterScrollIntoViewEvent = function (editor, data) {\n      editor.fire('AfterScrollIntoView', data);\n    };\n    var descend = function (element, offset) {\n      var children$1 = children(element);\n      if (children$1.length === 0 || excludeFromDescend(element)) {\n        return {\n          element: element,\n          offset: offset\n        };\n      } else if (offset < children$1.length && !excludeFromDescend(children$1[offset])) {\n        return {\n          element: children$1[offset],\n          offset: 0\n        };\n      } else {\n        var last = children$1[children$1.length - 1];\n        if (excludeFromDescend(last)) {\n          return {\n            element: element,\n            offset: offset\n          };\n        } else {\n          if (name(last) === 'img') {\n            return {\n              element: last,\n              offset: 1\n            };\n          } else if (isText(last)) {\n            return {\n              element: last,\n              offset: get$7(last).length\n            };\n          } else {\n            return {\n              element: last,\n              offset: children(last).length\n            };\n          }\n        }\n      }\n    };\n    var markerInfo = function (element, cleanupFun) {\n      var pos = absolute(element);\n      var height = get$8(element);\n      return {\n        element: element,\n        bottom: pos.top() + height,\n        height: height,\n        pos: pos,\n        cleanup: cleanupFun\n      };\n    };\n    var createMarker = function (element, offset) {\n      var startPoint = descend(element, offset);\n      var span = Element.fromHtml('<span data-mce-bogus=\"all\">' + Zwsp.ZWSP + '</span>');\n      before(startPoint.element, span);\n      return markerInfo(span, function () {\n        return remove(span);\n      });\n    };\n    var elementMarker = function (element) {\n      return markerInfo(Element.fromDom(element), noop);\n    };\n    var withMarker = function (editor, f, rng, alignToTop) {\n      preserveWith(editor, function (_s, _e) {\n        return applyWithMarker(editor, f, rng, alignToTop);\n      }, rng);\n    };\n    var withScrollEvents = function (editor, doc, f, marker, alignToTop) {\n      var data = {\n        elm: marker.element.dom(),\n        alignToTop: alignToTop\n      };\n      if (fireScrollIntoViewEvent(editor, data)) {\n        return;\n      }\n      var scrollTop = get$1(doc).top();\n      f(doc, scrollTop, marker, alignToTop);\n      fireAfterScrollIntoViewEvent(editor, data);\n    };\n    var applyWithMarker = function (editor, f, rng, alignToTop) {\n      var body = Element.fromDom(editor.getBody());\n      var doc = Element.fromDom(editor.getDoc());\n      reflow(body);\n      var marker = createMarker(Element.fromDom(rng.startContainer), rng.startOffset);\n      withScrollEvents(editor, doc, f, marker, alignToTop);\n      marker.cleanup();\n    };\n    var withElement = function (editor, element, f, alignToTop) {\n      var doc = Element.fromDom(editor.getDoc());\n      withScrollEvents(editor, doc, f, elementMarker(element), alignToTop);\n    };\n    var preserveWith = function (editor, f, rng) {\n      var startElement = rng.startContainer;\n      var startOffset = rng.startOffset;\n      var endElement = rng.endContainer;\n      var endOffset = rng.endOffset;\n      f(Element.fromDom(startElement), Element.fromDom(endElement));\n      var newRng = editor.dom.createRng();\n      newRng.setStart(startElement, startOffset);\n      newRng.setEnd(endElement, endOffset);\n      editor.selection.setRng(rng);\n    };\n    var scrollToMarker = function (marker, viewHeight, alignToTop, doc) {\n      var pos = marker.pos;\n      if (alignToTop) {\n        to(pos.left(), pos.top(), doc);\n      } else {\n        var y = pos.top() - viewHeight + marker.height;\n        to(pos.left(), y, doc);\n      }\n    };\n    var intoWindowIfNeeded = function (doc, scrollTop, viewHeight, marker, alignToTop) {\n      var viewportBottom = viewHeight + scrollTop;\n      var markerTop = marker.pos.top();\n      var markerBottom = marker.bottom;\n      var largerThanViewport = markerBottom - markerTop >= viewHeight;\n      if (markerTop < scrollTop) {\n        scrollToMarker(marker, viewHeight, alignToTop !== false, doc);\n      } else if (markerTop > viewportBottom) {\n        var align = largerThanViewport ? alignToTop !== false : alignToTop === true;\n        scrollToMarker(marker, viewHeight, align, doc);\n      } else if (markerBottom > viewportBottom && !largerThanViewport) {\n        scrollToMarker(marker, viewHeight, alignToTop === true, doc);\n      }\n    };\n    var intoWindow = function (doc, scrollTop, marker, alignToTop) {\n      var viewHeight = doc.dom().defaultView.innerHeight;\n      intoWindowIfNeeded(doc, scrollTop, viewHeight, marker, alignToTop);\n    };\n    var intoFrame = function (doc, scrollTop, marker, alignToTop) {\n      var frameViewHeight = doc.dom().defaultView.innerHeight;\n      intoWindowIfNeeded(doc, scrollTop, frameViewHeight, marker, alignToTop);\n      var op = find$3(marker.element);\n      var viewportBounds = getBounds(domGlobals.window);\n      if (op.top() < viewportBounds.y()) {\n        intoView(marker.element, alignToTop !== false);\n      } else if (op.top() > viewportBounds.bottom()) {\n        intoView(marker.element, alignToTop === true);\n      }\n    };\n    var rangeIntoWindow = function (editor, rng, alignToTop) {\n      return withMarker(editor, intoWindow, rng, alignToTop);\n    };\n    var elementIntoWindow = function (editor, element, alignToTop) {\n      return withElement(editor, element, intoWindow, alignToTop);\n    };\n    var rangeIntoFrame = function (editor, rng, alignToTop) {\n      return withMarker(editor, intoFrame, rng, alignToTop);\n    };\n    var elementIntoFrame = function (editor, element, alignToTop) {\n      return withElement(editor, element, intoFrame, alignToTop);\n    };\n    var elementIntoView = function (editor, element, alignToTop) {\n      var scroller = editor.inline ? elementIntoWindow : elementIntoFrame;\n      scroller(editor, element, alignToTop);\n    };\n    var rangeIntoView = function (editor, rng, alignToTop) {\n      var scroller = editor.inline ? rangeIntoWindow : rangeIntoFrame;\n      scroller(editor, rng, alignToTop);\n    };\n    var ScrollIntoView = {\n      scrollElementIntoView: elementIntoView,\n      scrollRangeIntoView: rangeIntoView\n    };\n\n    var hasCeProperty = function (node) {\n      return NodeType.isContentEditableTrue(node) || NodeType.isContentEditableFalse(node);\n    };\n    var findParent = function (node, rootNode, predicate) {\n      while (node && node !== rootNode) {\n        if (predicate(node)) {\n          return node;\n        }\n        node = node.parentNode;\n      }\n      return null;\n    };\n    var findClosestIeRange = function (clientX, clientY, doc) {\n      var element, rng, rects;\n      element = doc.elementFromPoint(clientX, clientY);\n      rng = doc.body.createTextRange();\n      if (!element || element.tagName === 'HTML') {\n        element = doc.body;\n      }\n      rng.moveToElementText(element);\n      rects = Tools.toArray(rng.getClientRects());\n      rects = rects.sort(function (a, b) {\n        a = Math.abs(Math.max(a.top - clientY, a.bottom - clientY));\n        b = Math.abs(Math.max(b.top - clientY, b.bottom - clientY));\n        return a - b;\n      });\n      if (rects.length > 0) {\n        clientY = (rects[0].bottom + rects[0].top) / 2;\n        try {\n          rng.moveToPoint(clientX, clientY);\n          rng.collapse(true);\n          return rng;\n        } catch (ex) {\n        }\n      }\n      return null;\n    };\n    var moveOutOfContentEditableFalse = function (rng, rootNode) {\n      var parentElement = rng && rng.parentElement ? rng.parentElement() : null;\n      return NodeType.isContentEditableFalse(findParent(parentElement, rootNode, hasCeProperty)) ? null : rng;\n    };\n    var fromPoint$1 = function (clientX, clientY, doc) {\n      var rng, point;\n      var pointDoc = doc;\n      if (pointDoc.caretPositionFromPoint) {\n        point = pointDoc.caretPositionFromPoint(clientX, clientY);\n        if (point) {\n          rng = doc.createRange();\n          rng.setStart(point.offsetNode, point.offset);\n          rng.collapse(true);\n        }\n      } else if (doc.caretRangeFromPoint) {\n        rng = doc.caretRangeFromPoint(clientX, clientY);\n      } else if (pointDoc.body.createTextRange) {\n        rng = pointDoc.body.createTextRange();\n        try {\n          rng.moveToPoint(clientX, clientY);\n          rng.collapse(true);\n        } catch (ex) {\n          rng = findClosestIeRange(clientX, clientY, doc);\n        }\n        return moveOutOfContentEditableFalse(rng, doc.body);\n      }\n      return rng;\n    };\n    var CaretRangeFromPoint = { fromPoint: fromPoint$1 };\n\n    var processRanges = function (editor, ranges) {\n      return map(ranges, function (range) {\n        var evt = editor.fire('GetSelectionRange', { range: range });\n        return evt.range !== range ? evt.range : range;\n      });\n    };\n    var EventProcessRanges = { processRanges: processRanges };\n\n    var fromElements = function (elements, scope) {\n      var doc = scope || domGlobals.document;\n      var fragment = doc.createDocumentFragment();\n      each(elements, function (element) {\n        fragment.appendChild(element.dom());\n      });\n      return Element.fromDom(fragment);\n    };\n\n    var dropLast = function (xs) {\n      return xs.slice(0, -1);\n    };\n    var parentsUntil$1 = function (start, root, predicate) {\n      if (contains$2(root, start)) {\n        return dropLast(parents(start, function (elm) {\n          return predicate(elm) || eq(elm, root);\n        }));\n      } else {\n        return [];\n      }\n    };\n    var parents$1 = function (start, root) {\n      return parentsUntil$1(start, root, constant(false));\n    };\n    var parentsAndSelf = function (start, root) {\n      return [start].concat(parents$1(start, root));\n    };\n    var Parents = {\n      parentsUntil: parentsUntil$1,\n      parents: parents$1,\n      parentsAndSelf: parentsAndSelf\n    };\n\n    var getStartNode = function (rng) {\n      var sc = rng.startContainer, so = rng.startOffset;\n      if (NodeType.isText(sc)) {\n        return so === 0 ? Option.some(Element.fromDom(sc)) : Option.none();\n      } else {\n        return Option.from(sc.childNodes[so]).map(Element.fromDom);\n      }\n    };\n    var getEndNode = function (rng) {\n      var ec = rng.endContainer, eo = rng.endOffset;\n      if (NodeType.isText(ec)) {\n        return eo === ec.data.length ? Option.some(Element.fromDom(ec)) : Option.none();\n      } else {\n        return Option.from(ec.childNodes[eo - 1]).map(Element.fromDom);\n      }\n    };\n    var getFirstChildren = function (node) {\n      return firstChild(node).fold(constant([node]), function (child) {\n        return [node].concat(getFirstChildren(child));\n      });\n    };\n    var getLastChildren = function (node) {\n      return lastChild(node).fold(constant([node]), function (child) {\n        if (name(child) === 'br') {\n          return prevSibling(child).map(function (sibling) {\n            return [node].concat(getLastChildren(sibling));\n          }).getOr([]);\n        } else {\n          return [node].concat(getLastChildren(child));\n        }\n      });\n    };\n    var hasAllContentsSelected = function (elm, rng) {\n      return lift2(getStartNode(rng), getEndNode(rng), function (startNode, endNode) {\n        var start = find(getFirstChildren(elm), curry(eq, startNode));\n        var end = find(getLastChildren(elm), curry(eq, endNode));\n        return start.isSome() && end.isSome();\n      }).getOr(false);\n    };\n    var moveEndPoint$1 = function (dom, rng, node, start) {\n      var root = node, walker = new TreeWalker(node, root);\n      var nonEmptyElementsMap = dom.schema.getNonEmptyElements();\n      do {\n        if (node.nodeType === 3 && Tools.trim(node.nodeValue).length !== 0) {\n          if (start) {\n            rng.setStart(node, 0);\n          } else {\n            rng.setEnd(node, node.nodeValue.length);\n          }\n          return;\n        }\n        if (nonEmptyElementsMap[node.nodeName] && !/^(TD|TH)$/.test(node.nodeName)) {\n          if (start) {\n            rng.setStartBefore(node);\n          } else {\n            if (node.nodeName === 'BR') {\n              rng.setEndBefore(node);\n            } else {\n              rng.setEndAfter(node);\n            }\n          }\n          return;\n        }\n      } while (node = start ? walker.next() : walker.prev());\n      if (root.nodeName === 'BODY') {\n        if (start) {\n          rng.setStart(root, 0);\n        } else {\n          rng.setEnd(root, root.childNodes.length);\n        }\n      }\n    };\n    var hasAnyRanges = function (editor) {\n      var sel = editor.selection.getSel();\n      return sel && sel.rangeCount > 0;\n    };\n\n    var tableModel = Immutable('element', 'width', 'rows');\n    var tableRow = Immutable('element', 'cells');\n    var cellPosition = Immutable('x', 'y');\n    var getSpan = function (td, key) {\n      var value = parseInt(get$3(td, key), 10);\n      return isNaN(value) ? 1 : value;\n    };\n    var fillout = function (table, x, y, tr, td) {\n      var rowspan = getSpan(td, 'rowspan');\n      var colspan = getSpan(td, 'colspan');\n      var rows = table.rows();\n      for (var y2 = y; y2 < y + rowspan; y2++) {\n        if (!rows[y2]) {\n          rows[y2] = tableRow(deep(tr), []);\n        }\n        for (var x2 = x; x2 < x + colspan; x2++) {\n          var cells = rows[y2].cells();\n          cells[x2] = y2 === y && x2 === x ? td : shallow(td);\n        }\n      }\n    };\n    var cellExists = function (table, x, y) {\n      var rows = table.rows();\n      var cells = rows[y] ? rows[y].cells() : [];\n      return !!cells[x];\n    };\n    var skipCellsX = function (table, x, y) {\n      while (cellExists(table, x, y)) {\n        x++;\n      }\n      return x;\n    };\n    var getWidth = function (rows) {\n      return foldl(rows, function (acc, row) {\n        return row.cells().length > acc ? row.cells().length : acc;\n      }, 0);\n    };\n    var findElementPos = function (table, element) {\n      var rows = table.rows();\n      for (var y = 0; y < rows.length; y++) {\n        var cells = rows[y].cells();\n        for (var x = 0; x < cells.length; x++) {\n          if (eq(cells[x], element)) {\n            return Option.some(cellPosition(x, y));\n          }\n        }\n      }\n      return Option.none();\n    };\n    var extractRows = function (table, sx, sy, ex, ey) {\n      var newRows = [];\n      var rows = table.rows();\n      for (var y = sy; y <= ey; y++) {\n        var cells = rows[y].cells();\n        var slice = sx < ex ? cells.slice(sx, ex + 1) : cells.slice(ex, sx + 1);\n        newRows.push(tableRow(rows[y].element(), slice));\n      }\n      return newRows;\n    };\n    var subTable = function (table, startPos, endPos) {\n      var sx = startPos.x(), sy = startPos.y();\n      var ex = endPos.x(), ey = endPos.y();\n      var newRows = sy < ey ? extractRows(table, sx, sy, ex, ey) : extractRows(table, sx, ey, ex, sy);\n      return tableModel(table.element(), getWidth(newRows), newRows);\n    };\n    var createDomTable = function (table, rows) {\n      var tableElement = shallow(table.element());\n      var tableBody = Element.fromTag('tbody');\n      append$1(tableBody, rows);\n      append(tableElement, tableBody);\n      return tableElement;\n    };\n    var modelRowsToDomRows = function (table) {\n      return map(table.rows(), function (row) {\n        var cells = map(row.cells(), function (cell) {\n          var td = deep(cell);\n          remove$1(td, 'colspan');\n          remove$1(td, 'rowspan');\n          return td;\n        });\n        var tr = shallow(row.element());\n        append$1(tr, cells);\n        return tr;\n      });\n    };\n    var fromDom$1 = function (tableElm) {\n      var table = tableModel(shallow(tableElm), 0, []);\n      each(descendants$1(tableElm, 'tr'), function (tr, y) {\n        each(descendants$1(tr, 'td,th'), function (td, x) {\n          fillout(table, skipCellsX(table, x, y), y, tr, td);\n        });\n      });\n      return tableModel(table.element(), getWidth(table.rows()), table.rows());\n    };\n    var toDom = function (table) {\n      return createDomTable(table, modelRowsToDomRows(table));\n    };\n    var subsection = function (table, startElement, endElement) {\n      return findElementPos(table, startElement).bind(function (startPos) {\n        return findElementPos(table, endElement).map(function (endPos) {\n          return subTable(table, startPos, endPos);\n        });\n      });\n    };\n    var SimpleTableModel = {\n      fromDom: fromDom$1,\n      toDom: toDom,\n      subsection: subsection\n    };\n\n    var getRanges = function (selection) {\n      var ranges = [];\n      if (selection) {\n        for (var i = 0; i < selection.rangeCount; i++) {\n          ranges.push(selection.getRangeAt(i));\n        }\n      }\n      return ranges;\n    };\n    var getSelectedNodes = function (ranges) {\n      return bind(ranges, function (range) {\n        var node = getSelectedNode(range);\n        return node ? [Element.fromDom(node)] : [];\n      });\n    };\n    var hasMultipleRanges = function (selection) {\n      return getRanges(selection).length > 1;\n    };\n    var MultiRange = {\n      getRanges: getRanges,\n      getSelectedNodes: getSelectedNodes,\n      hasMultipleRanges: hasMultipleRanges\n    };\n\n    var getCellsFromRanges = function (ranges) {\n      return filter(MultiRange.getSelectedNodes(ranges), isTableCell);\n    };\n    var getCellsFromElement = function (elm) {\n      return descendants$1(elm, 'td[data-mce-selected],th[data-mce-selected]');\n    };\n    var getCellsFromElementOrRanges = function (ranges, element) {\n      var selectedCells = getCellsFromElement(element);\n      var rangeCells = getCellsFromRanges(ranges);\n      return selectedCells.length > 0 ? selectedCells : rangeCells;\n    };\n    var getCellsFromEditor = function (editor) {\n      return getCellsFromElementOrRanges(MultiRange.getRanges(editor.selection.getSel()), Element.fromDom(editor.getBody()));\n    };\n    var TableCellSelection = {\n      getCellsFromRanges: getCellsFromRanges,\n      getCellsFromElement: getCellsFromElement,\n      getCellsFromElementOrRanges: getCellsFromElementOrRanges,\n      getCellsFromEditor: getCellsFromEditor\n    };\n\n    var findParentListContainer = function (parents) {\n      return find(parents, function (elm) {\n        return name(elm) === 'ul' || name(elm) === 'ol';\n      });\n    };\n    var getFullySelectedListWrappers = function (parents, rng) {\n      return find(parents, function (elm) {\n        return name(elm) === 'li' && hasAllContentsSelected(elm, rng);\n      }).fold(constant([]), function (li) {\n        return findParentListContainer(parents).map(function (listCont) {\n          return [\n            Element.fromTag('li'),\n            Element.fromTag(name(listCont))\n          ];\n        }).getOr([]);\n      });\n    };\n    var wrap$2 = function (innerElm, elms) {\n      var wrapped = foldl(elms, function (acc, elm) {\n        append(elm, acc);\n        return elm;\n      }, innerElm);\n      return elms.length > 0 ? fromElements([wrapped]) : wrapped;\n    };\n    var directListWrappers = function (commonAnchorContainer) {\n      if (isListItem(commonAnchorContainer)) {\n        return parent(commonAnchorContainer).filter(isList).fold(constant([]), function (listElm) {\n          return [\n            commonAnchorContainer,\n            listElm\n          ];\n        });\n      } else {\n        return isList(commonAnchorContainer) ? [commonAnchorContainer] : [];\n      }\n    };\n    var getWrapElements = function (rootNode, rng) {\n      var commonAnchorContainer = Element.fromDom(rng.commonAncestorContainer);\n      var parents = Parents.parentsAndSelf(commonAnchorContainer, rootNode);\n      var wrapElements = filter(parents, function (elm) {\n        return isInline(elm) || isHeading(elm);\n      });\n      var listWrappers = getFullySelectedListWrappers(parents, rng);\n      var allWrappers = wrapElements.concat(listWrappers.length ? listWrappers : directListWrappers(commonAnchorContainer));\n      return map(allWrappers, shallow);\n    };\n    var emptyFragment = function () {\n      return fromElements([]);\n    };\n    var getFragmentFromRange = function (rootNode, rng) {\n      return wrap$2(Element.fromDom(rng.cloneContents()), getWrapElements(rootNode, rng));\n    };\n    var getParentTable = function (rootElm, cell) {\n      return ancestor$1(cell, 'table', curry(eq, rootElm));\n    };\n    var getTableFragment = function (rootNode, selectedTableCells) {\n      return getParentTable(rootNode, selectedTableCells[0]).bind(function (tableElm) {\n        var firstCell = selectedTableCells[0];\n        var lastCell = selectedTableCells[selectedTableCells.length - 1];\n        var fullTableModel = SimpleTableModel.fromDom(tableElm);\n        return SimpleTableModel.subsection(fullTableModel, firstCell, lastCell).map(function (sectionedTableModel) {\n          return fromElements([SimpleTableModel.toDom(sectionedTableModel)]);\n        });\n      }).getOrThunk(emptyFragment);\n    };\n    var getSelectionFragment = function (rootNode, ranges) {\n      return ranges.length > 0 && ranges[0].collapsed ? emptyFragment() : getFragmentFromRange(rootNode, ranges[0]);\n    };\n    var read$1 = function (rootNode, ranges) {\n      var selectedCells = TableCellSelection.getCellsFromElementOrRanges(ranges, rootNode);\n      return selectedCells.length > 0 ? getTableFragment(rootNode, selectedCells) : getSelectionFragment(rootNode, ranges);\n    };\n    var FragmentReader = { read: read$1 };\n\n    var getTextContent = function (editor) {\n      return Option.from(editor.selection.getRng()).map(function (rng) {\n        var bin = editor.dom.add(editor.getBody(), 'div', {\n          'data-mce-bogus': 'all',\n          'style': 'overflow: hidden; opacity: 0;'\n        }, rng.cloneContents());\n        var text = Zwsp.trim(bin.innerText);\n        editor.dom.remove(bin);\n        return text;\n      }).getOr('');\n    };\n    var getHtmlContent = function (editor, args) {\n      var rng = editor.selection.getRng(), tmpElm = editor.dom.create('body');\n      var sel = editor.selection.getSel();\n      var fragment;\n      var ranges = EventProcessRanges.processRanges(editor, MultiRange.getRanges(sel));\n      fragment = args.contextual ? FragmentReader.read(Element.fromDom(editor.getBody()), ranges).dom() : rng.cloneContents();\n      if (fragment) {\n        tmpElm.appendChild(fragment);\n      }\n      return editor.selection.serializer.serialize(tmpElm, args);\n    };\n    var getContent$1 = function (editor, args) {\n      if (args === void 0) {\n        args = {};\n      }\n      args.get = true;\n      args.format = args.format || 'html';\n      args.selection = true;\n      args = editor.fire('BeforeGetContent', args);\n      if (args.isDefaultPrevented()) {\n        editor.fire('GetContent', args);\n        return args.content;\n      }\n      if (args.format === 'text') {\n        return getTextContent(editor);\n      } else {\n        args.getInner = true;\n        var content = getHtmlContent(editor, args);\n        if (args.format === 'tree') {\n          return content;\n        } else {\n          args.content = editor.selection.isCollapsed() ? '' : content;\n          editor.fire('GetContent', args);\n          return args.content;\n        }\n      }\n    };\n    var GetSelectionContent = { getContent: getContent$1 };\n\n    var isEq$1 = function (rng1, rng2) {\n      return rng1 && rng2 && (rng1.startContainer === rng2.startContainer && rng1.startOffset === rng2.startOffset) && (rng1.endContainer === rng2.endContainer && rng1.endOffset === rng2.endOffset);\n    };\n    var RangeCompare = { isEq: isEq$1 };\n\n    var findParent$1 = function (node, rootNode, predicate) {\n      while (node && node !== rootNode) {\n        if (predicate(node)) {\n          return node;\n        }\n        node = node.parentNode;\n      }\n      return null;\n    };\n    var hasParent = function (node, rootNode, predicate) {\n      return findParent$1(node, rootNode, predicate) !== null;\n    };\n    var hasParentWithName = function (node, rootNode, name) {\n      return hasParent(node, rootNode, function (node) {\n        return node.nodeName === name;\n      });\n    };\n    var isTable$3 = function (node) {\n      return node && node.nodeName === 'TABLE';\n    };\n    var isTableCell$2 = function (node) {\n      return node && /^(TD|TH|CAPTION)$/.test(node.nodeName);\n    };\n    var isCeFalseCaretContainer = function (node, rootNode) {\n      return isCaretContainer(node) && hasParent(node, rootNode, isCaretNode) === false;\n    };\n    var hasBrBeforeAfter = function (dom, node, left) {\n      var walker = new TreeWalker(node, dom.getParent(node.parentNode, dom.isBlock) || dom.getRoot());\n      while (node = walker[left ? 'prev' : 'next']()) {\n        if (NodeType.isBr(node)) {\n          return true;\n        }\n      }\n    };\n    var isPrevNode = function (node, name) {\n      return node.previousSibling && node.previousSibling.nodeName === name;\n    };\n    var hasContentEditableFalseParent = function (body, node) {\n      while (node && node !== body) {\n        if (NodeType.isContentEditableFalse(node)) {\n          return true;\n        }\n        node = node.parentNode;\n      }\n      return false;\n    };\n    var findTextNodeRelative = function (dom, isAfterNode, collapsed, left, startNode) {\n      var lastInlineElement;\n      var body = dom.getRoot();\n      var node;\n      var nonEmptyElementsMap = dom.schema.getNonEmptyElements();\n      var parentBlockContainer = dom.getParent(startNode.parentNode, dom.isBlock) || body;\n      if (left && NodeType.isBr(startNode) && isAfterNode && dom.isEmpty(parentBlockContainer)) {\n        return Option.some(CaretPosition(startNode.parentNode, dom.nodeIndex(startNode)));\n      }\n      var walker = new TreeWalker(startNode, parentBlockContainer);\n      while (node = walker[left ? 'prev' : 'next']()) {\n        if (dom.getContentEditableParent(node) === 'false' || isCeFalseCaretContainer(node, body)) {\n          return Option.none();\n        }\n        if (NodeType.isText(node) && node.nodeValue.length > 0) {\n          if (hasParentWithName(node, body, 'A') === false) {\n            return Option.some(CaretPosition(node, left ? node.nodeValue.length : 0));\n          }\n          return Option.none();\n        }\n        if (dom.isBlock(node) || nonEmptyElementsMap[node.nodeName.toLowerCase()]) {\n          return Option.none();\n        }\n        lastInlineElement = node;\n      }\n      if (collapsed && lastInlineElement) {\n        return Option.some(CaretPosition(lastInlineElement, 0));\n      }\n      return Option.none();\n    };\n    var normalizeEndPoint = function (dom, collapsed, start, rng) {\n      var container, offset;\n      var body = dom.getRoot();\n      var node, nonEmptyElementsMap;\n      var directionLeft, isAfterNode, normalized = false;\n      container = rng[(start ? 'start' : 'end') + 'Container'];\n      offset = rng[(start ? 'start' : 'end') + 'Offset'];\n      isAfterNode = NodeType.isElement(container) && offset === container.childNodes.length;\n      nonEmptyElementsMap = dom.schema.getNonEmptyElements();\n      directionLeft = start;\n      if (isCaretContainer(container)) {\n        return Option.none();\n      }\n      if (NodeType.isElement(container) && offset > container.childNodes.length - 1) {\n        directionLeft = false;\n      }\n      if (NodeType.isDocument(container)) {\n        container = body;\n        offset = 0;\n      }\n      if (container === body) {\n        if (directionLeft) {\n          node = container.childNodes[offset > 0 ? offset - 1 : 0];\n          if (node) {\n            if (isCaretContainer(node)) {\n              return Option.none();\n            }\n            if (nonEmptyElementsMap[node.nodeName] || isTable$3(node)) {\n              return Option.none();\n            }\n          }\n        }\n        if (container.hasChildNodes()) {\n          offset = Math.min(!directionLeft && offset > 0 ? offset - 1 : offset, container.childNodes.length - 1);\n          container = container.childNodes[offset];\n          offset = NodeType.isText(container) && isAfterNode ? container.data.length : 0;\n          if (!collapsed && container === body.lastChild && isTable$3(container)) {\n            return Option.none();\n          }\n          if (hasContentEditableFalseParent(body, container) || isCaretContainer(container)) {\n            return Option.none();\n          }\n          if (container.hasChildNodes() && isTable$3(container) === false) {\n            node = container;\n            var walker = new TreeWalker(container, body);\n            do {\n              if (NodeType.isContentEditableFalse(node) || isCaretContainer(node)) {\n                normalized = false;\n                break;\n              }\n              if (NodeType.isText(node) && node.nodeValue.length > 0) {\n                offset = directionLeft ? 0 : node.nodeValue.length;\n                container = node;\n                normalized = true;\n                break;\n              }\n              if (nonEmptyElementsMap[node.nodeName.toLowerCase()] && !isTableCell$2(node)) {\n                offset = dom.nodeIndex(node);\n                container = node.parentNode;\n                if (!directionLeft) {\n                  offset++;\n                }\n                normalized = true;\n                break;\n              }\n            } while (node = directionLeft ? walker.next() : walker.prev());\n          }\n        }\n      }\n      if (collapsed) {\n        if (NodeType.isText(container) && offset === 0) {\n          findTextNodeRelative(dom, isAfterNode, collapsed, true, container).each(function (pos) {\n            container = pos.container();\n            offset = pos.offset();\n            normalized = true;\n          });\n        }\n        if (NodeType.isElement(container)) {\n          node = container.childNodes[offset];\n          if (!node) {\n            node = container.childNodes[offset - 1];\n          }\n          if (node && NodeType.isBr(node) && !isPrevNode(node, 'A') && !hasBrBeforeAfter(dom, node, false) && !hasBrBeforeAfter(dom, node, true)) {\n            findTextNodeRelative(dom, isAfterNode, collapsed, true, node).each(function (pos) {\n              container = pos.container();\n              offset = pos.offset();\n              normalized = true;\n            });\n          }\n        }\n      }\n      if (directionLeft && !collapsed && NodeType.isText(container) && offset === container.nodeValue.length) {\n        findTextNodeRelative(dom, isAfterNode, collapsed, false, container).each(function (pos) {\n          container = pos.container();\n          offset = pos.offset();\n          normalized = true;\n        });\n      }\n      return normalized ? Option.some(CaretPosition(container, offset)) : Option.none();\n    };\n    var normalize = function (dom, rng) {\n      var collapsed = rng.collapsed, normRng = rng.cloneRange();\n      var startPos = CaretPosition.fromRangeStart(rng);\n      normalizeEndPoint(dom, collapsed, true, normRng).each(function (pos) {\n        if (!collapsed || !CaretPosition.isAbove(startPos, pos)) {\n          normRng.setStart(pos.container(), pos.offset());\n        }\n      });\n      if (!collapsed) {\n        normalizeEndPoint(dom, collapsed, false, normRng).each(function (pos) {\n          normRng.setEnd(pos.container(), pos.offset());\n        });\n      }\n      if (collapsed) {\n        normRng.collapse(true);\n      }\n      return RangeCompare.isEq(rng, normRng) ? Option.none() : Option.some(normRng);\n    };\n    var NormalizeRange = { normalize: normalize };\n\n    var prependData = function (target, data) {\n      target.insertData(0, data);\n    };\n    var removeEmpty = function (text) {\n      if (text.dom().length === 0) {\n        remove(text);\n        return Option.none();\n      }\n      return Option.some(text);\n    };\n    var rngSetContent = function (rng, fragment) {\n      var firstChild = Option.from(fragment.firstChild).map(Element.fromDom);\n      var lastChild = Option.from(fragment.lastChild).map(Element.fromDom);\n      rng.deleteContents();\n      rng.insertNode(fragment);\n      var prevText = firstChild.bind(prevSibling).filter(isText).bind(removeEmpty);\n      var nextText = lastChild.bind(nextSibling).filter(isText).bind(removeEmpty);\n      lift2(prevText, firstChild.filter(isText), function (prev, start) {\n        prependData(start.dom(), prev.dom().data);\n        remove(prev);\n      });\n      lift2(nextText, lastChild.filter(isText), function (next, end) {\n        var oldLength = end.dom().length;\n        end.dom().appendData(next.dom().data);\n        rng.setEnd(end.dom(), oldLength);\n        remove(next);\n      });\n      rng.collapse(false);\n    };\n    var setupArgs = function (args, content) {\n      args = args || { format: 'html' };\n      args.set = true;\n      args.selection = true;\n      args.content = content;\n      return args;\n    };\n    var setContent$1 = function (editor, content, args) {\n      args = setupArgs(args, content);\n      if (!args.no_events) {\n        args = editor.fire('BeforeSetContent', args);\n        if (args.isDefaultPrevented()) {\n          editor.fire('SetContent', args);\n          return;\n        }\n      }\n      var rng = editor.selection.getRng();\n      rngSetContent(rng, rng.createContextualFragment(args.content));\n      editor.selection.setRng(rng);\n      ScrollIntoView.scrollRangeIntoView(editor, rng);\n      if (!args.no_events) {\n        editor.fire('SetContent', args);\n      }\n    };\n    var SetSelectionContent = { setContent: setContent$1 };\n\n    var getEndpointElement = function (root, rng, start, real, resolve) {\n      var container = start ? rng.startContainer : rng.endContainer;\n      var offset = start ? rng.startOffset : rng.endOffset;\n      return Option.from(container).map(Element.fromDom).map(function (elm) {\n        return !real || !rng.collapsed ? child(elm, resolve(elm, offset)).getOr(elm) : elm;\n      }).bind(function (elm) {\n        return isElement(elm) ? Option.some(elm) : parent(elm);\n      }).map(function (elm) {\n        return elm.dom();\n      }).getOr(root);\n    };\n    var getStart$2 = function (root, rng, real) {\n      return getEndpointElement(root, rng, true, real, function (elm, offset) {\n        return Math.min(childNodesCount(elm), offset);\n      });\n    };\n    var getEnd = function (root, rng, real) {\n      return getEndpointElement(root, rng, false, real, function (elm, offset) {\n        return offset > 0 ? offset - 1 : offset;\n      });\n    };\n    var skipEmptyTextNodes = function (node, forwards) {\n      var orig = node;\n      while (node && NodeType.isText(node) && node.length === 0) {\n        node = forwards ? node.nextSibling : node.previousSibling;\n      }\n      return node || orig;\n    };\n    var getNode$1 = function (root, rng) {\n      var elm, startContainer, endContainer, startOffset, endOffset;\n      if (!rng) {\n        return root;\n      }\n      startContainer = rng.startContainer;\n      endContainer = rng.endContainer;\n      startOffset = rng.startOffset;\n      endOffset = rng.endOffset;\n      elm = rng.commonAncestorContainer;\n      if (!rng.collapsed) {\n        if (startContainer === endContainer) {\n          if (endOffset - startOffset < 2) {\n            if (startContainer.hasChildNodes()) {\n              elm = startContainer.childNodes[startOffset];\n            }\n          }\n        }\n        if (startContainer.nodeType === 3 && endContainer.nodeType === 3) {\n          if (startContainer.length === startOffset) {\n            startContainer = skipEmptyTextNodes(startContainer.nextSibling, true);\n          } else {\n            startContainer = startContainer.parentNode;\n          }\n          if (endOffset === 0) {\n            endContainer = skipEmptyTextNodes(endContainer.previousSibling, false);\n          } else {\n            endContainer = endContainer.parentNode;\n          }\n          if (startContainer && startContainer === endContainer) {\n            return startContainer;\n          }\n        }\n      }\n      if (elm && elm.nodeType === 3) {\n        return elm.parentNode;\n      }\n      return elm;\n    };\n    var getSelectedBlocks = function (dom, rng, startElm, endElm) {\n      var node, root;\n      var selectedBlocks = [];\n      root = dom.getRoot();\n      startElm = dom.getParent(startElm || getStart$2(root, rng, rng.collapsed), dom.isBlock);\n      endElm = dom.getParent(endElm || getEnd(root, rng, rng.collapsed), dom.isBlock);\n      if (startElm && startElm !== root) {\n        selectedBlocks.push(startElm);\n      }\n      if (startElm && endElm && startElm !== endElm) {\n        node = startElm;\n        var walker = new TreeWalker(startElm, root);\n        while ((node = walker.next()) && node !== endElm) {\n          if (dom.isBlock(node)) {\n            selectedBlocks.push(node);\n          }\n        }\n      }\n      if (endElm && startElm !== endElm && endElm !== root) {\n        selectedBlocks.push(endElm);\n      }\n      return selectedBlocks;\n    };\n    var select$1 = function (dom, node, content) {\n      return Option.from(node).map(function (node) {\n        var idx = dom.nodeIndex(node);\n        var rng = dom.createRng();\n        rng.setStart(node.parentNode, idx);\n        rng.setEnd(node.parentNode, idx + 1);\n        if (content) {\n          moveEndPoint$1(dom, rng, node, true);\n          moveEndPoint$1(dom, rng, node, false);\n        }\n        return rng;\n      });\n    };\n\n    var deleteFromCallbackMap = function (callbackMap, selector, callback) {\n      if (callbackMap && callbackMap.hasOwnProperty(selector)) {\n        var newCallbacks = filter(callbackMap[selector], function (cb) {\n          return cb !== callback;\n        });\n        if (newCallbacks.length === 0) {\n          delete callbackMap[selector];\n        } else {\n          callbackMap[selector] = newCallbacks;\n        }\n      }\n    };\n    function SelectorChanged (dom, editor) {\n      var selectorChangedData;\n      var currentSelectors;\n      return {\n        selectorChangedWithUnbind: function (selector, callback) {\n          if (!selectorChangedData) {\n            selectorChangedData = {};\n            currentSelectors = {};\n            editor.on('NodeChange', function (e) {\n              var node = e.element, parents = dom.getParents(node, null, dom.getRoot()), matchedSelectors = {};\n              Tools.each(selectorChangedData, function (callbacks, selector) {\n                Tools.each(parents, function (node) {\n                  if (dom.is(node, selector)) {\n                    if (!currentSelectors[selector]) {\n                      Tools.each(callbacks, function (callback) {\n                        callback(true, {\n                          node: node,\n                          selector: selector,\n                          parents: parents\n                        });\n                      });\n                      currentSelectors[selector] = callbacks;\n                    }\n                    matchedSelectors[selector] = callbacks;\n                    return false;\n                  }\n                });\n              });\n              Tools.each(currentSelectors, function (callbacks, selector) {\n                if (!matchedSelectors[selector]) {\n                  delete currentSelectors[selector];\n                  Tools.each(callbacks, function (callback) {\n                    callback(false, {\n                      node: node,\n                      selector: selector,\n                      parents: parents\n                    });\n                  });\n                }\n              });\n            });\n          }\n          if (!selectorChangedData[selector]) {\n            selectorChangedData[selector] = [];\n          }\n          selectorChangedData[selector].push(callback);\n          return {\n            unbind: function () {\n              deleteFromCallbackMap(selectorChangedData, selector, callback);\n              deleteFromCallbackMap(currentSelectors, selector, callback);\n            }\n          };\n        }\n      };\n    }\n\n    var isNativeIeSelection = function (rng) {\n      return !!rng.select;\n    };\n    var isAttachedToDom = function (node) {\n      return !!(node && node.ownerDocument) && contains$2(Element.fromDom(node.ownerDocument), Element.fromDom(node));\n    };\n    var isValidRange = function (rng) {\n      if (!rng) {\n        return false;\n      } else if (isNativeIeSelection(rng)) {\n        return true;\n      } else {\n        return isAttachedToDom(rng.startContainer) && isAttachedToDom(rng.endContainer);\n      }\n    };\n    var Selection$1 = function (dom, win, serializer, editor) {\n      var bookmarkManager;\n      var controlSelection;\n      var selectedRange;\n      var explicitRange;\n      var selectorChangedWithUnbind = SelectorChanged(dom, editor).selectorChangedWithUnbind;\n      var setCursorLocation = function (node, offset) {\n        var rng = dom.createRng();\n        if (!node) {\n          moveEndPoint$1(dom, rng, editor.getBody(), true);\n          setRng(rng);\n        } else {\n          rng.setStart(node, offset);\n          rng.setEnd(node, offset);\n          setRng(rng);\n          collapse(false);\n        }\n      };\n      var getContent = function (args) {\n        return GetSelectionContent.getContent(editor, args);\n      };\n      var setContent = function (content, args) {\n        return SetSelectionContent.setContent(editor, content, args);\n      };\n      var getStart = function (real) {\n        return getStart$2(editor.getBody(), getRng(), real);\n      };\n      var getEnd$1 = function (real) {\n        return getEnd(editor.getBody(), getRng(), real);\n      };\n      var getBookmark = function (type, normalized) {\n        return bookmarkManager.getBookmark(type, normalized);\n      };\n      var moveToBookmark = function (bookmark) {\n        return bookmarkManager.moveToBookmark(bookmark);\n      };\n      var select = function (node, content) {\n        select$1(dom, node, content).each(setRng);\n        return node;\n      };\n      var isCollapsed = function () {\n        var rng = getRng(), sel = getSel();\n        if (!rng || rng.item) {\n          return false;\n        }\n        if (rng.compareEndPoints) {\n          return rng.compareEndPoints('StartToEnd', rng) === 0;\n        }\n        return !sel || rng.collapsed;\n      };\n      var collapse = function (toStart) {\n        var rng = getRng();\n        rng.collapse(!!toStart);\n        setRng(rng);\n      };\n      var getSel = function () {\n        return win.getSelection ? win.getSelection() : win.document.selection;\n      };\n      var getRng = function () {\n        var selection, rng, elm, doc;\n        var tryCompareBoundaryPoints = function (how, sourceRange, destinationRange) {\n          try {\n            return sourceRange.compareBoundaryPoints(how, destinationRange);\n          } catch (ex) {\n            return -1;\n          }\n        };\n        if (!win) {\n          return null;\n        }\n        doc = win.document;\n        if (typeof doc === 'undefined' || doc === null) {\n          return null;\n        }\n        if (editor.bookmark !== undefined && EditorFocus.hasFocus(editor) === false) {\n          var bookmark = SelectionBookmark.getRng(editor);\n          if (bookmark.isSome()) {\n            return bookmark.map(function (r) {\n              return EventProcessRanges.processRanges(editor, [r])[0];\n            }).getOr(doc.createRange());\n          }\n        }\n        try {\n          if ((selection = getSel()) && !NodeType.isRestrictedNode(selection.anchorNode)) {\n            if (selection.rangeCount > 0) {\n              rng = selection.getRangeAt(0);\n            } else {\n              rng = selection.createRange ? selection.createRange() : doc.createRange();\n            }\n          }\n        } catch (ex) {\n        }\n        rng = EventProcessRanges.processRanges(editor, [rng])[0];\n        if (!rng) {\n          rng = doc.createRange ? doc.createRange() : doc.body.createTextRange();\n        }\n        if (rng.setStart && rng.startContainer.nodeType === 9 && rng.collapsed) {\n          elm = dom.getRoot();\n          rng.setStart(elm, 0);\n          rng.setEnd(elm, 0);\n        }\n        if (selectedRange && explicitRange) {\n          if (tryCompareBoundaryPoints(rng.START_TO_START, rng, selectedRange) === 0 && tryCompareBoundaryPoints(rng.END_TO_END, rng, selectedRange) === 0) {\n            rng = explicitRange;\n          } else {\n            selectedRange = null;\n            explicitRange = null;\n          }\n        }\n        return rng;\n      };\n      var setRng = function (rng, forward) {\n        var sel, node, evt;\n        if (!isValidRange(rng)) {\n          return;\n        }\n        var ieRange = isNativeIeSelection(rng) ? rng : null;\n        if (ieRange) {\n          explicitRange = null;\n          try {\n            ieRange.select();\n          } catch (ex) {\n          }\n          return;\n        }\n        sel = getSel();\n        evt = editor.fire('SetSelectionRange', {\n          range: rng,\n          forward: forward\n        });\n        rng = evt.range;\n        if (sel) {\n          explicitRange = rng;\n          try {\n            sel.removeAllRanges();\n            sel.addRange(rng);\n          } catch (ex) {\n          }\n          if (forward === false && sel.extend) {\n            sel.collapse(rng.endContainer, rng.endOffset);\n            sel.extend(rng.startContainer, rng.startOffset);\n          }\n          selectedRange = sel.rangeCount > 0 ? sel.getRangeAt(0) : null;\n        }\n        if (!rng.collapsed && rng.startContainer === rng.endContainer && sel.setBaseAndExtent && !Env.ie) {\n          if (rng.endOffset - rng.startOffset < 2) {\n            if (rng.startContainer.hasChildNodes()) {\n              node = rng.startContainer.childNodes[rng.startOffset];\n              if (node && node.tagName === 'IMG') {\n                sel.setBaseAndExtent(rng.startContainer, rng.startOffset, rng.endContainer, rng.endOffset);\n                if (sel.anchorNode !== rng.startContainer || sel.focusNode !== rng.endContainer) {\n                  sel.setBaseAndExtent(node, 0, node, 1);\n                }\n              }\n            }\n          }\n        }\n        editor.fire('AfterSetSelectionRange', {\n          range: rng,\n          forward: forward\n        });\n      };\n      var setNode = function (elm) {\n        setContent(dom.getOuterHTML(elm));\n        return elm;\n      };\n      var getNode = function () {\n        return getNode$1(editor.getBody(), getRng());\n      };\n      var getSelectedBlocks$1 = function (startElm, endElm) {\n        return getSelectedBlocks(dom, getRng(), startElm, endElm);\n      };\n      var isForward = function () {\n        var sel = getSel();\n        var anchorRange, focusRange;\n        if (!sel || !sel.anchorNode || !sel.focusNode) {\n          return true;\n        }\n        anchorRange = dom.createRng();\n        anchorRange.setStart(sel.anchorNode, sel.anchorOffset);\n        anchorRange.collapse(true);\n        focusRange = dom.createRng();\n        focusRange.setStart(sel.focusNode, sel.focusOffset);\n        focusRange.collapse(true);\n        return anchorRange.compareBoundaryPoints(anchorRange.START_TO_START, focusRange) <= 0;\n      };\n      var normalize = function () {\n        var rng = getRng();\n        var sel = getSel();\n        if (!MultiRange.hasMultipleRanges(sel) && hasAnyRanges(editor)) {\n          var normRng = NormalizeRange.normalize(dom, rng);\n          normRng.each(function (normRng) {\n            setRng(normRng, isForward());\n          });\n          return normRng.getOr(rng);\n        }\n        return rng;\n      };\n      var selectorChanged = function (selector, callback) {\n        selectorChangedWithUnbind(selector, callback);\n        return exports;\n      };\n      var getScrollContainer = function () {\n        var scrollContainer;\n        var node = dom.getRoot();\n        while (node && node.nodeName !== 'BODY') {\n          if (node.scrollHeight > node.clientHeight) {\n            scrollContainer = node;\n            break;\n          }\n          node = node.parentNode;\n        }\n        return scrollContainer;\n      };\n      var scrollIntoView = function (elm, alignToTop) {\n        return ScrollIntoView.scrollElementIntoView(editor, elm, alignToTop);\n      };\n      var placeCaretAt = function (clientX, clientY) {\n        return setRng(CaretRangeFromPoint.fromPoint(clientX, clientY, editor.getDoc()));\n      };\n      var getBoundingClientRect = function () {\n        var rng = getRng();\n        return rng.collapsed ? CaretPosition$1.fromRangeStart(rng).getClientRects()[0] : rng.getBoundingClientRect();\n      };\n      var destroy = function () {\n        win = selectedRange = explicitRange = null;\n        controlSelection.destroy();\n      };\n      var exports = {\n        bookmarkManager: null,\n        controlSelection: null,\n        dom: dom,\n        win: win,\n        serializer: serializer,\n        editor: editor,\n        collapse: collapse,\n        setCursorLocation: setCursorLocation,\n        getContent: getContent,\n        setContent: setContent,\n        getBookmark: getBookmark,\n        moveToBookmark: moveToBookmark,\n        select: select,\n        isCollapsed: isCollapsed,\n        isForward: isForward,\n        setNode: setNode,\n        getNode: getNode,\n        getSel: getSel,\n        setRng: setRng,\n        getRng: getRng,\n        getStart: getStart,\n        getEnd: getEnd$1,\n        getSelectedBlocks: getSelectedBlocks$1,\n        normalize: normalize,\n        selectorChanged: selectorChanged,\n        selectorChangedWithUnbind: selectorChangedWithUnbind,\n        getScrollContainer: getScrollContainer,\n        scrollIntoView: scrollIntoView,\n        placeCaretAt: placeCaretAt,\n        getBoundingClientRect: getBoundingClientRect,\n        destroy: destroy\n      };\n      bookmarkManager = BookmarkManager$1(exports);\n      controlSelection = ControlSelection(exports, editor);\n      exports.bookmarkManager = bookmarkManager;\n      exports.controlSelection = controlSelection;\n      return exports;\n    };\n\n    var removeAttrs = function (node, names) {\n      each(names, function (name) {\n        node.attr(name, null);\n      });\n    };\n    var addFontToSpansFilter = function (domParser, styles, fontSizes) {\n      domParser.addNodeFilter('font', function (nodes) {\n        each(nodes, function (node) {\n          var props = styles.parse(node.attr('style'));\n          var color = node.attr('color');\n          var face = node.attr('face');\n          var size = node.attr('size');\n          if (color) {\n            props.color = color;\n          }\n          if (face) {\n            props['font-family'] = face;\n          }\n          if (size) {\n            props['font-size'] = fontSizes[parseInt(node.attr('size'), 10) - 1];\n          }\n          node.name = 'span';\n          node.attr('style', styles.serialize(props));\n          removeAttrs(node, [\n            'color',\n            'face',\n            'size'\n          ]);\n        });\n      });\n    };\n    var addStrikeToSpanFilter = function (domParser, styles) {\n      domParser.addNodeFilter('strike', function (nodes) {\n        each(nodes, function (node) {\n          var props = styles.parse(node.attr('style'));\n          props['text-decoration'] = 'line-through';\n          node.name = 'span';\n          node.attr('style', styles.serialize(props));\n        });\n      });\n    };\n    var addFilters = function (domParser, settings) {\n      var styles = Styles();\n      if (settings.convert_fonts_to_spans) {\n        addFontToSpansFilter(domParser, styles, Tools.explode(settings.font_size_legacy_values));\n      }\n      addStrikeToSpanFilter(domParser, styles);\n    };\n    var register$1 = function (domParser, settings) {\n      if (settings.inline_styles) {\n        addFilters(domParser, settings);\n      }\n    };\n    var LegacyFilter = { register: register$1 };\n\n    var paddEmptyNode = function (settings, args, blockElements, node) {\n      var brPreferred = settings.padd_empty_with_br || args.insert;\n      if (brPreferred && blockElements[node.name]) {\n        node.empty().append(new Node$1('br', 1)).shortEnded = true;\n      } else {\n        node.empty().append(new Node$1('#text', 3)).value = nbsp;\n      }\n    };\n    var isPaddedWithNbsp = function (node) {\n      return hasOnlyChild(node, '#text') && node.firstChild.value === nbsp;\n    };\n    var hasOnlyChild = function (node, name) {\n      return node && node.firstChild && node.firstChild === node.lastChild && node.firstChild.name === name;\n    };\n    var isPadded = function (schema, node) {\n      var rule = schema.getElementRule(node.name);\n      return rule && rule.paddEmpty;\n    };\n    var isEmpty$1 = function (schema, nonEmptyElements, whitespaceElements, node) {\n      return node.isEmpty(nonEmptyElements, whitespaceElements, function (node) {\n        return isPadded(schema, node);\n      });\n    };\n    var isLineBreakNode = function (node, blockElements) {\n      return node && (blockElements[node.name] || node.name === 'br');\n    };\n\n    var register$2 = function (parser, settings) {\n      var schema = parser.schema;\n      if (settings.remove_trailing_brs) {\n        parser.addNodeFilter('br', function (nodes, _, args) {\n          var i;\n          var l = nodes.length;\n          var node;\n          var blockElements = Tools.extend({}, schema.getBlockElements());\n          var nonEmptyElements = schema.getNonEmptyElements();\n          var parent, lastParent, prev, prevName;\n          var whiteSpaceElements = schema.getNonEmptyElements();\n          var elementRule, textNode;\n          blockElements.body = 1;\n          for (i = 0; i < l; i++) {\n            node = nodes[i];\n            parent = node.parent;\n            if (blockElements[node.parent.name] && node === parent.lastChild) {\n              prev = node.prev;\n              while (prev) {\n                prevName = prev.name;\n                if (prevName !== 'span' || prev.attr('data-mce-type') !== 'bookmark') {\n                  if (prevName !== 'br') {\n                    break;\n                  }\n                  if (prevName === 'br') {\n                    node = null;\n                    break;\n                  }\n                }\n                prev = prev.prev;\n              }\n              if (node) {\n                node.remove();\n                if (isEmpty$1(schema, nonEmptyElements, whiteSpaceElements, parent)) {\n                  elementRule = schema.getElementRule(parent.name);\n                  if (elementRule) {\n                    if (elementRule.removeEmpty) {\n                      parent.remove();\n                    } else if (elementRule.paddEmpty) {\n                      paddEmptyNode(settings, args, blockElements, parent);\n                    }\n                  }\n                }\n              }\n            } else {\n              lastParent = node;\n              while (parent && parent.firstChild === lastParent && parent.lastChild === lastParent) {\n                lastParent = parent;\n                if (blockElements[parent.name]) {\n                  break;\n                }\n                parent = parent.parent;\n              }\n              if (lastParent === parent && settings.padd_empty_with_br !== true) {\n                textNode = new Node$1('#text', 3);\n                textNode.value = nbsp;\n                node.replace(textNode);\n              }\n            }\n          }\n        });\n      }\n      parser.addAttributeFilter('href', function (nodes) {\n        var i = nodes.length, node;\n        var appendRel = function (rel) {\n          var parts = rel.split(' ').filter(function (p) {\n            return p.length > 0;\n          });\n          return parts.concat(['noopener']).sort().join(' ');\n        };\n        var addNoOpener = function (rel) {\n          var newRel = rel ? Tools.trim(rel) : '';\n          if (!/\\b(noopener)\\b/g.test(newRel)) {\n            return appendRel(newRel);\n          } else {\n            return newRel;\n          }\n        };\n        if (!settings.allow_unsafe_link_target) {\n          while (i--) {\n            node = nodes[i];\n            if (node.name === 'a' && node.attr('target') === '_blank') {\n              node.attr('rel', addNoOpener(node.attr('rel')));\n            }\n          }\n        }\n      });\n      if (!settings.allow_html_in_named_anchor) {\n        parser.addAttributeFilter('id,name', function (nodes) {\n          var i = nodes.length, sibling, prevSibling, parent, node;\n          while (i--) {\n            node = nodes[i];\n            if (node.name === 'a' && node.firstChild && !node.attr('href')) {\n              parent = node.parent;\n              sibling = node.lastChild;\n              do {\n                prevSibling = sibling.prev;\n                parent.insert(sibling, node);\n                sibling = prevSibling;\n              } while (sibling);\n            }\n          }\n        });\n      }\n      if (settings.fix_list_elements) {\n        parser.addNodeFilter('ul,ol', function (nodes) {\n          var i = nodes.length, node, parentNode;\n          while (i--) {\n            node = nodes[i];\n            parentNode = node.parent;\n            if (parentNode.name === 'ul' || parentNode.name === 'ol') {\n              if (node.prev && node.prev.name === 'li') {\n                node.prev.append(node);\n              } else {\n                var li = new Node$1('li', 1);\n                li.attr('style', 'list-style-type: none');\n                node.wrap(li);\n              }\n            }\n          }\n        });\n      }\n      if (settings.validate && schema.getValidClasses()) {\n        parser.addAttributeFilter('class', function (nodes) {\n          var i = nodes.length, node, classList, ci, className, classValue;\n          var validClasses = schema.getValidClasses();\n          var validClassesMap, valid;\n          while (i--) {\n            node = nodes[i];\n            classList = node.attr('class').split(' ');\n            classValue = '';\n            for (ci = 0; ci < classList.length; ci++) {\n              className = classList[ci];\n              valid = false;\n              validClassesMap = validClasses['*'];\n              if (validClassesMap && validClassesMap[className]) {\n                valid = true;\n              }\n              validClassesMap = validClasses[node.name];\n              if (!valid && validClassesMap && validClassesMap[className]) {\n                valid = true;\n              }\n              if (valid) {\n                if (classValue) {\n                  classValue += ' ';\n                }\n                classValue += className;\n              }\n            }\n            if (!classValue.length) {\n              classValue = null;\n            }\n            node.attr('class', classValue);\n          }\n        });\n      }\n    };\n\n    var makeMap$4 = Tools.makeMap, each$8 = Tools.each, explode$2 = Tools.explode, extend$2 = Tools.extend;\n    var DomParser = function (settings, schema) {\n      if (schema === void 0) {\n        schema = Schema();\n      }\n      var nodeFilters = {};\n      var attributeFilters = [];\n      var matchedNodes = {};\n      var matchedAttributes = {};\n      settings = settings || {};\n      settings.validate = 'validate' in settings ? settings.validate : true;\n      settings.root_name = settings.root_name || 'body';\n      var fixInvalidChildren = function (nodes) {\n        var ni, node, parent, parents, newParent, currentNode, tempNode, childNode, i;\n        var nonEmptyElements, whitespaceElements, nonSplitableElements, textBlockElements, specialElements, sibling, nextNode;\n        nonSplitableElements = makeMap$4('tr,td,th,tbody,thead,tfoot,table');\n        nonEmptyElements = schema.getNonEmptyElements();\n        whitespaceElements = schema.getWhiteSpaceElements();\n        textBlockElements = schema.getTextBlockElements();\n        specialElements = schema.getSpecialElements();\n        for (ni = 0; ni < nodes.length; ni++) {\n          node = nodes[ni];\n          if (!node.parent || node.fixed) {\n            continue;\n          }\n          if (textBlockElements[node.name] && node.parent.name === 'li') {\n            sibling = node.next;\n            while (sibling) {\n              if (textBlockElements[sibling.name]) {\n                sibling.name = 'li';\n                sibling.fixed = true;\n                node.parent.insert(sibling, node.parent);\n              } else {\n                break;\n              }\n              sibling = sibling.next;\n            }\n            node.unwrap(node);\n            continue;\n          }\n          parents = [node];\n          for (parent = node.parent; parent && !schema.isValidChild(parent.name, node.name) && !nonSplitableElements[parent.name]; parent = parent.parent) {\n            parents.push(parent);\n          }\n          if (parent && parents.length > 1) {\n            parents.reverse();\n            newParent = currentNode = filterNode(parents[0].clone());\n            for (i = 0; i < parents.length - 1; i++) {\n              if (schema.isValidChild(currentNode.name, parents[i].name)) {\n                tempNode = filterNode(parents[i].clone());\n                currentNode.append(tempNode);\n              } else {\n                tempNode = currentNode;\n              }\n              for (childNode = parents[i].firstChild; childNode && childNode !== parents[i + 1];) {\n                nextNode = childNode.next;\n                tempNode.append(childNode);\n                childNode = nextNode;\n              }\n              currentNode = tempNode;\n            }\n            if (!isEmpty$1(schema, nonEmptyElements, whitespaceElements, newParent)) {\n              parent.insert(newParent, parents[0], true);\n              parent.insert(node, newParent);\n            } else {\n              parent.insert(node, parents[0], true);\n            }\n            parent = parents[0];\n            if (isEmpty$1(schema, nonEmptyElements, whitespaceElements, parent) || hasOnlyChild(parent, 'br')) {\n              parent.empty().remove();\n            }\n          } else if (node.parent) {\n            if (node.name === 'li') {\n              sibling = node.prev;\n              if (sibling && (sibling.name === 'ul' || sibling.name === 'ul')) {\n                sibling.append(node);\n                continue;\n              }\n              sibling = node.next;\n              if (sibling && (sibling.name === 'ul' || sibling.name === 'ul')) {\n                sibling.insert(node, sibling.firstChild, true);\n                continue;\n              }\n              node.wrap(filterNode(new Node$1('ul', 1)));\n              continue;\n            }\n            if (schema.isValidChild(node.parent.name, 'div') && schema.isValidChild('div', node.name)) {\n              node.wrap(filterNode(new Node$1('div', 1)));\n            } else {\n              if (specialElements[node.name]) {\n                node.empty().remove();\n              } else {\n                node.unwrap();\n              }\n            }\n          }\n        }\n      };\n      var filterNode = function (node) {\n        var i, name, list;\n        name = node.name;\n        if (name in nodeFilters) {\n          list = matchedNodes[name];\n          if (list) {\n            list.push(node);\n          } else {\n            matchedNodes[name] = [node];\n          }\n        }\n        i = attributeFilters.length;\n        while (i--) {\n          name = attributeFilters[i].name;\n          if (name in node.attributes.map) {\n            list = matchedAttributes[name];\n            if (list) {\n              list.push(node);\n            } else {\n              matchedAttributes[name] = [node];\n            }\n          }\n        }\n        return node;\n      };\n      var addNodeFilter = function (name, callback) {\n        each$8(explode$2(name), function (name) {\n          var list = nodeFilters[name];\n          if (!list) {\n            nodeFilters[name] = list = [];\n          }\n          list.push(callback);\n        });\n      };\n      var getNodeFilters = function () {\n        var out = [];\n        for (var name_1 in nodeFilters) {\n          if (nodeFilters.hasOwnProperty(name_1)) {\n            out.push({\n              name: name_1,\n              callbacks: nodeFilters[name_1]\n            });\n          }\n        }\n        return out;\n      };\n      var addAttributeFilter = function (name, callback) {\n        each$8(explode$2(name), function (name) {\n          var i;\n          for (i = 0; i < attributeFilters.length; i++) {\n            if (attributeFilters[i].name === name) {\n              attributeFilters[i].callbacks.push(callback);\n              return;\n            }\n          }\n          attributeFilters.push({\n            name: name,\n            callbacks: [callback]\n          });\n        });\n      };\n      var getAttributeFilters = function () {\n        return [].concat(attributeFilters);\n      };\n      var parse = function (html, args) {\n        var parser, nodes, i, l, fi, fl, list, name;\n        var blockElements;\n        var invalidChildren = [];\n        var isInWhiteSpacePreservedElement;\n        var node;\n        var getRootBlockName = function (name) {\n          if (name === false) {\n            return '';\n          } else if (name === true) {\n            return 'p';\n          } else {\n            return name;\n          }\n        };\n        args = args || {};\n        matchedNodes = {};\n        matchedAttributes = {};\n        blockElements = extend$2(makeMap$4('script,style,head,html,body,title,meta,param'), schema.getBlockElements());\n        var nonEmptyElements = schema.getNonEmptyElements();\n        var children = schema.children;\n        var validate = settings.validate;\n        var forcedRootBlockName = 'forced_root_block' in args ? args.forced_root_block : settings.forced_root_block;\n        var rootBlockName = getRootBlockName(forcedRootBlockName);\n        var whiteSpaceElements = schema.getWhiteSpaceElements();\n        var startWhiteSpaceRegExp = /^[ \\t\\r\\n]+/;\n        var endWhiteSpaceRegExp = /[ \\t\\r\\n]+$/;\n        var allWhiteSpaceRegExp = /[ \\t\\r\\n]+/g;\n        var isAllWhiteSpaceRegExp = /^[ \\t\\r\\n]+$/;\n        isInWhiteSpacePreservedElement = whiteSpaceElements.hasOwnProperty(args.context) || whiteSpaceElements.hasOwnProperty(settings.root_name);\n        var addRootBlocks = function () {\n          var node = rootNode.firstChild, next, rootBlockNode;\n          var trim = function (rootBlockNode) {\n            if (rootBlockNode) {\n              node = rootBlockNode.firstChild;\n              if (node && node.type === 3) {\n                node.value = node.value.replace(startWhiteSpaceRegExp, '');\n              }\n              node = rootBlockNode.lastChild;\n              if (node && node.type === 3) {\n                node.value = node.value.replace(endWhiteSpaceRegExp, '');\n              }\n            }\n          };\n          if (!schema.isValidChild(rootNode.name, rootBlockName.toLowerCase())) {\n            return;\n          }\n          while (node) {\n            next = node.next;\n            if (node.type === 3 || node.type === 1 && node.name !== 'p' && !blockElements[node.name] && !node.attr('data-mce-type')) {\n              if (!rootBlockNode) {\n                rootBlockNode = createNode(rootBlockName, 1);\n                rootBlockNode.attr(settings.forced_root_block_attrs);\n                rootNode.insert(rootBlockNode, node);\n                rootBlockNode.append(node);\n              } else {\n                rootBlockNode.append(node);\n              }\n            } else {\n              trim(rootBlockNode);\n              rootBlockNode = null;\n            }\n            node = next;\n          }\n          trim(rootBlockNode);\n        };\n        var createNode = function (name, type) {\n          var node = new Node$1(name, type);\n          var list;\n          if (name in nodeFilters) {\n            list = matchedNodes[name];\n            if (list) {\n              list.push(node);\n            } else {\n              matchedNodes[name] = [node];\n            }\n          }\n          return node;\n        };\n        var removeWhitespaceBefore = function (node) {\n          var textNode, textNodeNext, textVal, sibling;\n          var blockElements = schema.getBlockElements();\n          for (textNode = node.prev; textNode && textNode.type === 3;) {\n            textVal = textNode.value.replace(endWhiteSpaceRegExp, '');\n            if (textVal.length > 0) {\n              textNode.value = textVal;\n              return;\n            }\n            textNodeNext = textNode.next;\n            if (textNodeNext) {\n              if (textNodeNext.type === 3 && textNodeNext.value.length) {\n                textNode = textNode.prev;\n                continue;\n              }\n              if (!blockElements[textNodeNext.name] && textNodeNext.name !== 'script' && textNodeNext.name !== 'style') {\n                textNode = textNode.prev;\n                continue;\n              }\n            }\n            sibling = textNode.prev;\n            textNode.remove();\n            textNode = sibling;\n          }\n        };\n        var cloneAndExcludeBlocks = function (input) {\n          var name;\n          var output = {};\n          for (name in input) {\n            if (name !== 'li' && name !== 'p') {\n              output[name] = input[name];\n            }\n          }\n          return output;\n        };\n        parser = SaxParser$1({\n          validate: validate,\n          allow_script_urls: settings.allow_script_urls,\n          allow_conditional_comments: settings.allow_conditional_comments,\n          preserve_cdata: settings.preserve_cdata,\n          self_closing_elements: cloneAndExcludeBlocks(schema.getSelfClosingElements()),\n          cdata: function (text) {\n            node.append(createNode('#cdata', 4)).value = text;\n          },\n          text: function (text, raw) {\n            var textNode;\n            if (!isInWhiteSpacePreservedElement) {\n              text = text.replace(allWhiteSpaceRegExp, ' ');\n              if (isLineBreakNode(node.lastChild, blockElements)) {\n                text = text.replace(startWhiteSpaceRegExp, '');\n              }\n            }\n            if (text.length !== 0) {\n              textNode = createNode('#text', 3);\n              textNode.raw = !!raw;\n              node.append(textNode).value = text;\n            }\n          },\n          comment: function (text) {\n            node.append(createNode('#comment', 8)).value = text;\n          },\n          pi: function (name, text) {\n            node.append(createNode(name, 7)).value = text;\n            removeWhitespaceBefore(node);\n          },\n          doctype: function (text) {\n            var newNode;\n            newNode = node.append(createNode('#doctype', 10));\n            newNode.value = text;\n            removeWhitespaceBefore(node);\n          },\n          start: function (name, attrs, empty) {\n            var newNode, attrFiltersLen, elementRule, attrName, parent;\n            elementRule = validate ? schema.getElementRule(name) : {};\n            if (elementRule) {\n              newNode = createNode(elementRule.outputName || name, 1);\n              newNode.attributes = attrs;\n              newNode.shortEnded = empty;\n              node.append(newNode);\n              parent = children[node.name];\n              if (parent && children[newNode.name] && !parent[newNode.name]) {\n                invalidChildren.push(newNode);\n              }\n              attrFiltersLen = attributeFilters.length;\n              while (attrFiltersLen--) {\n                attrName = attributeFilters[attrFiltersLen].name;\n                if (attrName in attrs.map) {\n                  list = matchedAttributes[attrName];\n                  if (list) {\n                    list.push(newNode);\n                  } else {\n                    matchedAttributes[attrName] = [newNode];\n                  }\n                }\n              }\n              if (blockElements[name]) {\n                removeWhitespaceBefore(newNode);\n              }\n              if (!empty) {\n                node = newNode;\n              }\n              if (!isInWhiteSpacePreservedElement && whiteSpaceElements[name]) {\n                isInWhiteSpacePreservedElement = true;\n              }\n            }\n          },\n          end: function (name) {\n            var textNode, elementRule, text, sibling, tempNode;\n            elementRule = validate ? schema.getElementRule(name) : {};\n            if (elementRule) {\n              if (blockElements[name]) {\n                if (!isInWhiteSpacePreservedElement) {\n                  textNode = node.firstChild;\n                  if (textNode && textNode.type === 3) {\n                    text = textNode.value.replace(startWhiteSpaceRegExp, '');\n                    if (text.length > 0) {\n                      textNode.value = text;\n                      textNode = textNode.next;\n                    } else {\n                      sibling = textNode.next;\n                      textNode.remove();\n                      textNode = sibling;\n                      while (textNode && textNode.type === 3) {\n                        text = textNode.value;\n                        sibling = textNode.next;\n                        if (text.length === 0 || isAllWhiteSpaceRegExp.test(text)) {\n                          textNode.remove();\n                          textNode = sibling;\n                        }\n                        textNode = sibling;\n                      }\n                    }\n                  }\n                  textNode = node.lastChild;\n                  if (textNode && textNode.type === 3) {\n                    text = textNode.value.replace(endWhiteSpaceRegExp, '');\n                    if (text.length > 0) {\n                      textNode.value = text;\n                      textNode = textNode.prev;\n                    } else {\n                      sibling = textNode.prev;\n                      textNode.remove();\n                      textNode = sibling;\n                      while (textNode && textNode.type === 3) {\n                        text = textNode.value;\n                        sibling = textNode.prev;\n                        if (text.length === 0 || isAllWhiteSpaceRegExp.test(text)) {\n                          textNode.remove();\n                          textNode = sibling;\n                        }\n                        textNode = sibling;\n                      }\n                    }\n                  }\n                }\n              }\n              if (isInWhiteSpacePreservedElement && whiteSpaceElements[name]) {\n                isInWhiteSpacePreservedElement = false;\n              }\n              if (elementRule.removeEmpty && isEmpty$1(schema, nonEmptyElements, whiteSpaceElements, node)) {\n                if (!node.attr('name') && !node.attr('id')) {\n                  tempNode = node.parent;\n                  if (blockElements[node.name]) {\n                    node.empty().remove();\n                  } else {\n                    node.unwrap();\n                  }\n                  node = tempNode;\n                  return;\n                }\n              }\n              if (elementRule.paddEmpty && (isPaddedWithNbsp(node) || isEmpty$1(schema, nonEmptyElements, whiteSpaceElements, node))) {\n                paddEmptyNode(settings, args, blockElements, node);\n              }\n              node = node.parent;\n            }\n          }\n        }, schema);\n        var rootNode = node = new Node$1(args.context || settings.root_name, 11);\n        parser.parse(html, args.format);\n        if (validate && invalidChildren.length) {\n          if (!args.context) {\n            fixInvalidChildren(invalidChildren);\n          } else {\n            args.invalid = true;\n          }\n        }\n        if (rootBlockName && (rootNode.name === 'body' || args.isRootContent)) {\n          addRootBlocks();\n        }\n        if (!args.invalid) {\n          for (name in matchedNodes) {\n            if (!matchedNodes.hasOwnProperty(name)) {\n              continue;\n            }\n            list = nodeFilters[name];\n            nodes = matchedNodes[name];\n            fi = nodes.length;\n            while (fi--) {\n              if (!nodes[fi].parent) {\n                nodes.splice(fi, 1);\n              }\n            }\n            for (i = 0, l = list.length; i < l; i++) {\n              list[i](nodes, name, args);\n            }\n          }\n          for (i = 0, l = attributeFilters.length; i < l; i++) {\n            list = attributeFilters[i];\n            if (list.name in matchedAttributes) {\n              nodes = matchedAttributes[list.name];\n              fi = nodes.length;\n              while (fi--) {\n                if (!nodes[fi].parent) {\n                  nodes.splice(fi, 1);\n                }\n              }\n              for (fi = 0, fl = list.callbacks.length; fi < fl; fi++) {\n                list.callbacks[fi](nodes, list.name, args);\n              }\n            }\n          }\n        }\n        return rootNode;\n      };\n      var exports = {\n        schema: schema,\n        addAttributeFilter: addAttributeFilter,\n        getAttributeFilters: getAttributeFilters,\n        addNodeFilter: addNodeFilter,\n        getNodeFilters: getNodeFilters,\n        filterNode: filterNode,\n        parse: parse\n      };\n      register$2(exports, settings);\n      LegacyFilter.register(exports, settings);\n      return exports;\n    };\n\n    var register$3 = function (htmlParser, settings, dom) {\n      htmlParser.addAttributeFilter('data-mce-tabindex', function (nodes, name) {\n        var i = nodes.length, node;\n        while (i--) {\n          node = nodes[i];\n          node.attr('tabindex', node.attr('data-mce-tabindex'));\n          node.attr(name, null);\n        }\n      });\n      htmlParser.addAttributeFilter('src,href,style', function (nodes, name) {\n        var i = nodes.length, node, value;\n        var internalName = 'data-mce-' + name;\n        var urlConverter = settings.url_converter;\n        var urlConverterScope = settings.url_converter_scope;\n        while (i--) {\n          node = nodes[i];\n          value = node.attr(internalName);\n          if (value !== undefined) {\n            node.attr(name, value.length > 0 ? value : null);\n            node.attr(internalName, null);\n          } else {\n            value = node.attr(name);\n            if (name === 'style') {\n              value = dom.serializeStyle(dom.parseStyle(value), node.name);\n            } else if (urlConverter) {\n              value = urlConverter.call(urlConverterScope, value, name, node.name);\n            }\n            node.attr(name, value.length > 0 ? value : null);\n          }\n        }\n      });\n      htmlParser.addAttributeFilter('class', function (nodes) {\n        var i = nodes.length, node, value;\n        while (i--) {\n          node = nodes[i];\n          value = node.attr('class');\n          if (value) {\n            value = node.attr('class').replace(/(?:^|\\s)mce-item-\\w+(?!\\S)/g, '');\n            node.attr('class', value.length > 0 ? value : null);\n          }\n        }\n      });\n      htmlParser.addAttributeFilter('data-mce-type', function (nodes, name, args) {\n        var i = nodes.length, node;\n        while (i--) {\n          node = nodes[i];\n          if (node.attr('data-mce-type') === 'bookmark' && !args.cleanup) {\n            var hasChildren = Option.from(node.firstChild).exists(function (firstChild) {\n              return !Zwsp.isZwsp(firstChild.value);\n            });\n            if (hasChildren) {\n              node.unwrap();\n            } else {\n              node.remove();\n            }\n          }\n        }\n      });\n      htmlParser.addNodeFilter('noscript', function (nodes) {\n        var i = nodes.length, node;\n        while (i--) {\n          node = nodes[i].firstChild;\n          if (node) {\n            node.value = Entities.decode(node.value);\n          }\n        }\n      });\n      htmlParser.addNodeFilter('script,style', function (nodes, name) {\n        var i = nodes.length, node, value, type;\n        var trim = function (value) {\n          return value.replace(/(<!--\\[CDATA\\[|\\]\\]-->)/g, '\\n').replace(/^[\\r\\n]*|[\\r\\n]*$/g, '').replace(/^\\s*((<!--)?(\\s*\\/\\/)?\\s*<!\\[CDATA\\[|(<!--\\s*)?\\/\\*\\s*<!\\[CDATA\\[\\s*\\*\\/|(\\/\\/)?\\s*<!--|\\/\\*\\s*<!--\\s*\\*\\/)\\s*[\\r\\n]*/gi, '').replace(/\\s*(\\/\\*\\s*\\]\\]>\\s*\\*\\/(-->)?|\\s*\\/\\/\\s*\\]\\]>(-->)?|\\/\\/\\s*(-->)?|\\]\\]>|\\/\\*\\s*-->\\s*\\*\\/|\\s*-->\\s*)\\s*$/g, '');\n        };\n        while (i--) {\n          node = nodes[i];\n          value = node.firstChild ? node.firstChild.value : '';\n          if (name === 'script') {\n            type = node.attr('type');\n            if (type) {\n              node.attr('type', type === 'mce-no/type' ? null : type.replace(/^mce\\-/, ''));\n            }\n            if (settings.element_format === 'xhtml' && value.length > 0) {\n              node.firstChild.value = '// <![CDATA[\\n' + trim(value) + '\\n// ]]>';\n            }\n          } else {\n            if (settings.element_format === 'xhtml' && value.length > 0) {\n              node.firstChild.value = '<!--\\n' + trim(value) + '\\n-->';\n            }\n          }\n        }\n      });\n      htmlParser.addNodeFilter('#comment', function (nodes) {\n        var i = nodes.length, node;\n        while (i--) {\n          node = nodes[i];\n          if (settings.preserve_cdata && node.value.indexOf('[CDATA[') === 0) {\n            node.name = '#cdata';\n            node.type = 4;\n            node.value = dom.decode(node.value.replace(/^\\[CDATA\\[|\\]\\]$/g, ''));\n          } else if (node.value.indexOf('mce:protected ') === 0) {\n            node.name = '#text';\n            node.type = 3;\n            node.raw = true;\n            node.value = unescape(node.value).substr(14);\n          }\n        }\n      });\n      htmlParser.addNodeFilter('xml:namespace,input', function (nodes, name) {\n        var i = nodes.length, node;\n        while (i--) {\n          node = nodes[i];\n          if (node.type === 7) {\n            node.remove();\n          } else if (node.type === 1) {\n            if (name === 'input' && !node.attr('type')) {\n              node.attr('type', 'text');\n            }\n          }\n        }\n      });\n      htmlParser.addAttributeFilter('data-mce-type', function (nodes) {\n        each(nodes, function (node) {\n          if (node.attr('data-mce-type') === 'format-caret') {\n            if (node.isEmpty(htmlParser.schema.getNonEmptyElements())) {\n              node.remove();\n            } else {\n              node.unwrap();\n            }\n          }\n        });\n      });\n      htmlParser.addAttributeFilter('data-mce-src,data-mce-href,data-mce-style,' + 'data-mce-selected,data-mce-expando,' + 'data-mce-type,data-mce-resize,data-mce-placeholder', function (nodes, name) {\n        var i = nodes.length;\n        while (i--) {\n          nodes[i].attr(name, null);\n        }\n      });\n    };\n    var trimTrailingBr = function (rootNode) {\n      var brNode1, brNode2;\n      var isBr = function (node) {\n        return node && node.name === 'br';\n      };\n      brNode1 = rootNode.lastChild;\n      if (isBr(brNode1)) {\n        brNode2 = brNode1.prev;\n        if (isBr(brNode2)) {\n          brNode1.remove();\n          brNode2.remove();\n        }\n      }\n    };\n    var DomSerializerFilters = {\n      register: register$3,\n      trimTrailingBr: trimTrailingBr\n    };\n\n    var preProcess = function (editor, node, args) {\n      var impl, doc, oldDoc;\n      var dom = editor.dom;\n      node = node.cloneNode(true);\n      impl = domGlobals.document.implementation;\n      if (impl.createHTMLDocument) {\n        doc = impl.createHTMLDocument('');\n        Tools.each(node.nodeName === 'BODY' ? node.childNodes : [node], function (node) {\n          doc.body.appendChild(doc.importNode(node, true));\n        });\n        if (node.nodeName !== 'BODY') {\n          node = doc.body.firstChild;\n        } else {\n          node = doc.body;\n        }\n        oldDoc = dom.doc;\n        dom.doc = doc;\n      }\n      firePreProcess(editor, __assign(__assign({}, args), { node: node }));\n      if (oldDoc) {\n        dom.doc = oldDoc;\n      }\n      return node;\n    };\n    var shouldFireEvent = function (editor, args) {\n      return editor && editor.hasEventListeners('PreProcess') && !args.no_events;\n    };\n    var process = function (editor, node, args) {\n      return shouldFireEvent(editor, args) ? preProcess(editor, node, args) : node;\n    };\n    var DomSerializerPreProcess = { process: process };\n\n    var addTempAttr = function (htmlParser, tempAttrs, name) {\n      if (Tools.inArray(tempAttrs, name) === -1) {\n        htmlParser.addAttributeFilter(name, function (nodes, name) {\n          var i = nodes.length;\n          while (i--) {\n            nodes[i].attr(name, null);\n          }\n        });\n        tempAttrs.push(name);\n      }\n    };\n    var postProcess = function (editor, args, content) {\n      if (!args.no_events && editor) {\n        var outArgs = firePostProcess(editor, __assign(__assign({}, args), { content: content }));\n        return outArgs.content;\n      } else {\n        return content;\n      }\n    };\n    var getHtmlFromNode = function (dom, node, args) {\n      var html = Zwsp.trim(args.getInner ? node.innerHTML : dom.getOuterHTML(node));\n      return args.selection || isWsPreserveElement(Element.fromDom(node)) ? html : Tools.trim(html);\n    };\n    var parseHtml = function (htmlParser, html, args) {\n      var parserArgs = args.selection ? __assign({ forced_root_block: false }, args) : args;\n      var rootNode = htmlParser.parse(html, parserArgs);\n      DomSerializerFilters.trimTrailingBr(rootNode);\n      return rootNode;\n    };\n    var serializeNode = function (settings, schema, node) {\n      var htmlSerializer = Serializer(settings, schema);\n      return htmlSerializer.serialize(node);\n    };\n    var toHtml = function (editor, settings, schema, rootNode, args) {\n      var content = serializeNode(settings, schema, rootNode);\n      return postProcess(editor, args, content);\n    };\n    var DomSerializer = function (settings, editor) {\n      var tempAttrs = ['data-mce-selected'];\n      var dom = editor && editor.dom ? editor.dom : DOMUtils$1.DOM;\n      var schema = editor && editor.schema ? editor.schema : Schema(settings);\n      settings.entity_encoding = settings.entity_encoding || 'named';\n      settings.remove_trailing_brs = 'remove_trailing_brs' in settings ? settings.remove_trailing_brs : true;\n      var htmlParser = DomParser(settings, schema);\n      DomSerializerFilters.register(htmlParser, settings, dom);\n      var serialize = function (node, parserArgs) {\n        if (parserArgs === void 0) {\n          parserArgs = {};\n        }\n        var args = __assign({ format: 'html' }, parserArgs);\n        var targetNode = DomSerializerPreProcess.process(editor, node, args);\n        var html = getHtmlFromNode(dom, targetNode, args);\n        var rootNode = parseHtml(htmlParser, html, args);\n        return args.format === 'tree' ? rootNode : toHtml(editor, settings, schema, rootNode, args);\n      };\n      return {\n        schema: schema,\n        addNodeFilter: htmlParser.addNodeFilter,\n        addAttributeFilter: htmlParser.addAttributeFilter,\n        serialize: serialize,\n        addRules: function (rules) {\n          schema.addValidElements(rules);\n        },\n        setRules: function (rules) {\n          schema.setValidElements(rules);\n        },\n        addTempAttr: curry(addTempAttr, htmlParser, tempAttrs),\n        getTempAttrs: function () {\n          return tempAttrs;\n        },\n        getNodeFilters: htmlParser.getNodeFilters,\n        getAttributeFilters: htmlParser.getAttributeFilters\n      };\n    };\n\n    var Serializer$1 = function (settings, editor) {\n      var domSerializer = DomSerializer(settings, editor);\n      return {\n        schema: domSerializer.schema,\n        addNodeFilter: domSerializer.addNodeFilter,\n        addAttributeFilter: domSerializer.addAttributeFilter,\n        serialize: domSerializer.serialize,\n        addRules: domSerializer.addRules,\n        setRules: domSerializer.setRules,\n        addTempAttr: domSerializer.addTempAttr,\n        getTempAttrs: domSerializer.getTempAttrs,\n        getNodeFilters: domSerializer.getNodeFilters,\n        getAttributeFilters: domSerializer.getAttributeFilters\n      };\n    };\n\n    var blobUriToBlob = function (url) {\n      return new promiseObj(function (resolve, reject) {\n        var rejectWithError = function () {\n          reject('Cannot convert ' + url + ' to Blob. Resource might not exist or is inaccessible.');\n        };\n        try {\n          var xhr = new domGlobals.XMLHttpRequest();\n          xhr.open('GET', url, true);\n          xhr.responseType = 'blob';\n          xhr.onload = function () {\n            if (this.status === 200) {\n              resolve(this.response);\n            } else {\n              rejectWithError();\n            }\n          };\n          xhr.onerror = rejectWithError;\n          xhr.send();\n        } catch (ex) {\n          rejectWithError();\n        }\n      });\n    };\n    var parseDataUri = function (uri) {\n      var type, matches;\n      var uriParts = decodeURIComponent(uri).split(',');\n      matches = /data:([^;]+)/.exec(uriParts[0]);\n      if (matches) {\n        type = matches[1];\n      }\n      return {\n        type: type,\n        data: uriParts[1]\n      };\n    };\n    var dataUriToBlob = function (uri) {\n      return new promiseObj(function (resolve) {\n        var str, arr, i;\n        var uriParts = parseDataUri(uri);\n        try {\n          str = domGlobals.atob(uriParts.data);\n        } catch (e) {\n          resolve(new domGlobals.Blob([]));\n          return;\n        }\n        arr = new Uint8Array(str.length);\n        for (i = 0; i < arr.length; i++) {\n          arr[i] = str.charCodeAt(i);\n        }\n        resolve(new domGlobals.Blob([arr], { type: uriParts.type }));\n      });\n    };\n    var uriToBlob = function (url) {\n      if (url.indexOf('blob:') === 0) {\n        return blobUriToBlob(url);\n      }\n      if (url.indexOf('data:') === 0) {\n        return dataUriToBlob(url);\n      }\n      return null;\n    };\n    var blobToDataUri = function (blob) {\n      return new promiseObj(function (resolve) {\n        var reader = new domGlobals.FileReader();\n        reader.onloadend = function () {\n          resolve(reader.result);\n        };\n        reader.readAsDataURL(blob);\n      });\n    };\n    var Conversions = {\n      uriToBlob: uriToBlob,\n      blobToDataUri: blobToDataUri,\n      parseDataUri: parseDataUri\n    };\n\n    var count = 0;\n    var uniqueId = function (prefix) {\n      return (prefix || 'blobid') + count++;\n    };\n    var imageToBlobInfo = function (blobCache, img, resolve, reject) {\n      var base64, blobInfo;\n      if (img.src.indexOf('blob:') === 0) {\n        blobInfo = blobCache.getByUri(img.src);\n        if (blobInfo) {\n          resolve({\n            image: img,\n            blobInfo: blobInfo\n          });\n        } else {\n          Conversions.uriToBlob(img.src).then(function (blob) {\n            Conversions.blobToDataUri(blob).then(function (dataUri) {\n              base64 = Conversions.parseDataUri(dataUri).data;\n              blobInfo = blobCache.create(uniqueId(), blob, base64);\n              blobCache.add(blobInfo);\n              resolve({\n                image: img,\n                blobInfo: blobInfo\n              });\n            });\n          }, function (err) {\n            reject(err);\n          });\n        }\n        return;\n      }\n      base64 = Conversions.parseDataUri(img.src).data;\n      blobInfo = blobCache.findFirst(function (cachedBlobInfo) {\n        return cachedBlobInfo.base64() === base64;\n      });\n      if (blobInfo) {\n        resolve({\n          image: img,\n          blobInfo: blobInfo\n        });\n      } else {\n        Conversions.uriToBlob(img.src).then(function (blob) {\n          blobInfo = blobCache.create(uniqueId(), blob, base64);\n          blobCache.add(blobInfo);\n          resolve({\n            image: img,\n            blobInfo: blobInfo\n          });\n        }, function (err) {\n          reject(err);\n        });\n      }\n    };\n    var getAllImages = function (elm) {\n      return elm ? from$1(elm.getElementsByTagName('img')) : [];\n    };\n    function ImageScanner(uploadStatus, blobCache) {\n      var cachedPromises = {};\n      var findAll = function (elm, predicate) {\n        var images;\n        if (!predicate) {\n          predicate = constant(true);\n        }\n        images = filter(getAllImages(elm), function (img) {\n          var src = img.src;\n          if (!Env.fileApi) {\n            return false;\n          }\n          if (img.hasAttribute('data-mce-bogus')) {\n            return false;\n          }\n          if (img.hasAttribute('data-mce-placeholder')) {\n            return false;\n          }\n          if (!src || src === Env.transparentSrc) {\n            return false;\n          }\n          if (src.indexOf('blob:') === 0) {\n            return !uploadStatus.isUploaded(src) && predicate(img);\n          }\n          if (src.indexOf('data:') === 0) {\n            return predicate(img);\n          }\n          return false;\n        });\n        var promises = map(images, function (img) {\n          if (cachedPromises[img.src]) {\n            return new promiseObj(function (resolve) {\n              cachedPromises[img.src].then(function (imageInfo) {\n                if (typeof imageInfo === 'string') {\n                  return imageInfo;\n                }\n                resolve({\n                  image: img,\n                  blobInfo: imageInfo.blobInfo\n                });\n              });\n            });\n          }\n          var newPromise = new promiseObj(function (resolve, reject) {\n            imageToBlobInfo(blobCache, img, resolve, reject);\n          }).then(function (result) {\n            delete cachedPromises[result.image.src];\n            return result;\n          }).catch(function (error) {\n            delete cachedPromises[img.src];\n            return error;\n          });\n          cachedPromises[img.src] = newPromise;\n          return newPromise;\n        });\n        return promiseObj.all(promises);\n      };\n      return { findAll: findAll };\n    }\n\n    function Uploader(uploadStatus, settings) {\n      var pendingPromises = {};\n      var pathJoin = function (path1, path2) {\n        if (path1) {\n          return path1.replace(/\\/$/, '') + '/' + path2.replace(/^\\//, '');\n        }\n        return path2;\n      };\n      var defaultHandler = function (blobInfo, success, failure, progress) {\n        var xhr, formData;\n        xhr = new domGlobals.XMLHttpRequest();\n        xhr.open('POST', settings.url);\n        xhr.withCredentials = settings.credentials;\n        xhr.upload.onprogress = function (e) {\n          progress(e.loaded / e.total * 100);\n        };\n        xhr.onerror = function () {\n          failure('Image upload failed due to a XHR Transport error. Code: ' + xhr.status);\n        };\n        xhr.onload = function () {\n          var json;\n          if (xhr.status < 200 || xhr.status >= 300) {\n            failure('HTTP Error: ' + xhr.status);\n            return;\n          }\n          json = JSON.parse(xhr.responseText);\n          if (!json || typeof json.location !== 'string') {\n            failure('Invalid JSON: ' + xhr.responseText);\n            return;\n          }\n          success(pathJoin(settings.basePath, json.location));\n        };\n        formData = new domGlobals.FormData();\n        formData.append('file', blobInfo.blob(), blobInfo.filename());\n        xhr.send(formData);\n      };\n      var noUpload = function () {\n        return new promiseObj(function (resolve) {\n          resolve([]);\n        });\n      };\n      var handlerSuccess = function (blobInfo, url) {\n        return {\n          url: url,\n          blobInfo: blobInfo,\n          status: true\n        };\n      };\n      var handlerFailure = function (blobInfo, error) {\n        return {\n          url: '',\n          blobInfo: blobInfo,\n          status: false,\n          error: error\n        };\n      };\n      var resolvePending = function (blobUri, result) {\n        Tools.each(pendingPromises[blobUri], function (resolve) {\n          resolve(result);\n        });\n        delete pendingPromises[blobUri];\n      };\n      var uploadBlobInfo = function (blobInfo, handler, openNotification) {\n        uploadStatus.markPending(blobInfo.blobUri());\n        return new promiseObj(function (resolve) {\n          var notification, progress;\n          var noop = function () {\n          };\n          try {\n            var closeNotification_1 = function () {\n              if (notification) {\n                notification.close();\n                progress = noop;\n              }\n            };\n            var success = function (url) {\n              closeNotification_1();\n              uploadStatus.markUploaded(blobInfo.blobUri(), url);\n              resolvePending(blobInfo.blobUri(), handlerSuccess(blobInfo, url));\n              resolve(handlerSuccess(blobInfo, url));\n            };\n            var failure = function (error) {\n              closeNotification_1();\n              uploadStatus.removeFailed(blobInfo.blobUri());\n              resolvePending(blobInfo.blobUri(), handlerFailure(blobInfo, error));\n              resolve(handlerFailure(blobInfo, error));\n            };\n            progress = function (percent) {\n              if (percent < 0 || percent > 100) {\n                return;\n              }\n              if (!notification) {\n                notification = openNotification();\n              }\n              notification.progressBar.value(percent);\n            };\n            handler(blobInfo, success, failure, progress);\n          } catch (ex) {\n            resolve(handlerFailure(blobInfo, ex.message));\n          }\n        });\n      };\n      var isDefaultHandler = function (handler) {\n        return handler === defaultHandler;\n      };\n      var pendingUploadBlobInfo = function (blobInfo) {\n        var blobUri = blobInfo.blobUri();\n        return new promiseObj(function (resolve) {\n          pendingPromises[blobUri] = pendingPromises[blobUri] || [];\n          pendingPromises[blobUri].push(resolve);\n        });\n      };\n      var uploadBlobs = function (blobInfos, openNotification) {\n        blobInfos = Tools.grep(blobInfos, function (blobInfo) {\n          return !uploadStatus.isUploaded(blobInfo.blobUri());\n        });\n        return promiseObj.all(Tools.map(blobInfos, function (blobInfo) {\n          return uploadStatus.isPending(blobInfo.blobUri()) ? pendingUploadBlobInfo(blobInfo) : uploadBlobInfo(blobInfo, settings.handler, openNotification);\n        }));\n      };\n      var upload = function (blobInfos, openNotification) {\n        return !settings.url && isDefaultHandler(settings.handler) ? noUpload() : uploadBlobs(blobInfos, openNotification);\n      };\n      if (isFunction(settings.handler) === false) {\n        settings.handler = defaultHandler;\n      }\n      return { upload: upload };\n    }\n\n    function UploadStatus () {\n      var PENDING = 1, UPLOADED = 2;\n      var blobUriStatuses = {};\n      var createStatus = function (status, resultUri) {\n        return {\n          status: status,\n          resultUri: resultUri\n        };\n      };\n      var hasBlobUri = function (blobUri) {\n        return blobUri in blobUriStatuses;\n      };\n      var getResultUri = function (blobUri) {\n        var result = blobUriStatuses[blobUri];\n        return result ? result.resultUri : null;\n      };\n      var isPending = function (blobUri) {\n        return hasBlobUri(blobUri) ? blobUriStatuses[blobUri].status === PENDING : false;\n      };\n      var isUploaded = function (blobUri) {\n        return hasBlobUri(blobUri) ? blobUriStatuses[blobUri].status === UPLOADED : false;\n      };\n      var markPending = function (blobUri) {\n        blobUriStatuses[blobUri] = createStatus(PENDING, null);\n      };\n      var markUploaded = function (blobUri, resultUri) {\n        blobUriStatuses[blobUri] = createStatus(UPLOADED, resultUri);\n      };\n      var removeFailed = function (blobUri) {\n        delete blobUriStatuses[blobUri];\n      };\n      var destroy = function () {\n        blobUriStatuses = {};\n      };\n      return {\n        hasBlobUri: hasBlobUri,\n        getResultUri: getResultUri,\n        isPending: isPending,\n        isUploaded: isUploaded,\n        markPending: markPending,\n        markUploaded: markUploaded,\n        removeFailed: removeFailed,\n        destroy: destroy\n      };\n    }\n\n    var count$1 = 0;\n    var seed = function () {\n      var rnd = function () {\n        return Math.round(Math.random() * 4294967295).toString(36);\n      };\n      var now = new Date().getTime();\n      return 's' + now.toString(36) + rnd() + rnd() + rnd();\n    };\n    var uuid = function (prefix) {\n      return prefix + count$1++ + seed();\n    };\n    var Uuid = { uuid: uuid };\n\n    var BlobCache = function () {\n      var cache = [];\n      var mimeToExt = function (mime) {\n        var mimes = {\n          'image/jpeg': 'jpg',\n          'image/jpg': 'jpg',\n          'image/gif': 'gif',\n          'image/png': 'png'\n        };\n        return mimes[mime.toLowerCase()] || 'dat';\n      };\n      var create = function (o, blob, base64, filename) {\n        if (isString(o)) {\n          var id = o;\n          return toBlobInfo({\n            id: id,\n            name: filename,\n            blob: blob,\n            base64: base64\n          });\n        } else if (isObject(o)) {\n          return toBlobInfo(o);\n        } else {\n          throw new Error('Unknown input type');\n        }\n      };\n      var toBlobInfo = function (o) {\n        var id, name;\n        if (!o.blob || !o.base64) {\n          throw new Error('blob and base64 representations of the image are required for BlobInfo to be created');\n        }\n        id = o.id || Uuid.uuid('blobid');\n        name = o.name || id;\n        return {\n          id: constant(id),\n          name: constant(name),\n          filename: constant(name + '.' + mimeToExt(o.blob.type)),\n          blob: constant(o.blob),\n          base64: constant(o.base64),\n          blobUri: constant(o.blobUri || domGlobals.URL.createObjectURL(o.blob)),\n          uri: constant(o.uri)\n        };\n      };\n      var add = function (blobInfo) {\n        if (!get(blobInfo.id())) {\n          cache.push(blobInfo);\n        }\n      };\n      var get = function (id) {\n        return findFirst(function (cachedBlobInfo) {\n          return cachedBlobInfo.id() === id;\n        });\n      };\n      var findFirst = function (predicate) {\n        return filter(cache, predicate)[0];\n      };\n      var getByUri = function (blobUri) {\n        return findFirst(function (blobInfo) {\n          return blobInfo.blobUri() === blobUri;\n        });\n      };\n      var removeByUri = function (blobUri) {\n        cache = filter(cache, function (blobInfo) {\n          if (blobInfo.blobUri() === blobUri) {\n            domGlobals.URL.revokeObjectURL(blobInfo.blobUri());\n            return false;\n          }\n          return true;\n        });\n      };\n      var destroy = function () {\n        each(cache, function (cachedBlobInfo) {\n          domGlobals.URL.revokeObjectURL(cachedBlobInfo.blobUri());\n        });\n        cache = [];\n      };\n      return {\n        create: create,\n        add: add,\n        get: get,\n        getByUri: getByUri,\n        findFirst: findFirst,\n        removeByUri: removeByUri,\n        destroy: destroy\n      };\n    };\n\n    var EditorUpload = function (editor) {\n      var blobCache = BlobCache();\n      var uploader, imageScanner;\n      var uploadStatus = UploadStatus();\n      var urlFilters = [];\n      var aliveGuard = function (callback) {\n        return function (result) {\n          if (editor.selection) {\n            return callback(result);\n          }\n          return [];\n        };\n      };\n      var cacheInvalidator = function (url) {\n        return url + (url.indexOf('?') === -1 ? '?' : '&') + new Date().getTime();\n      };\n      var replaceString = function (content, search, replace) {\n        var index = 0;\n        do {\n          index = content.indexOf(search, index);\n          if (index !== -1) {\n            content = content.substring(0, index) + replace + content.substr(index + search.length);\n            index += replace.length - search.length + 1;\n          }\n        } while (index !== -1);\n        return content;\n      };\n      var replaceImageUrl = function (content, targetUrl, replacementUrl) {\n        content = replaceString(content, 'src=\"' + targetUrl + '\"', 'src=\"' + replacementUrl + '\"');\n        content = replaceString(content, 'data-mce-src=\"' + targetUrl + '\"', 'data-mce-src=\"' + replacementUrl + '\"');\n        return content;\n      };\n      var replaceUrlInUndoStack = function (targetUrl, replacementUrl) {\n        each(editor.undoManager.data, function (level) {\n          if (level.type === 'fragmented') {\n            level.fragments = map(level.fragments, function (fragment) {\n              return replaceImageUrl(fragment, targetUrl, replacementUrl);\n            });\n          } else {\n            level.content = replaceImageUrl(level.content, targetUrl, replacementUrl);\n          }\n        });\n      };\n      var openNotification = function () {\n        return editor.notificationManager.open({\n          text: editor.translate('Image uploading...'),\n          type: 'info',\n          timeout: -1,\n          progressBar: true\n        });\n      };\n      var replaceImageUri = function (image, resultUri) {\n        blobCache.removeByUri(image.src);\n        replaceUrlInUndoStack(image.src, resultUri);\n        editor.$(image).attr({\n          'src': Settings.shouldReuseFileName(editor) ? cacheInvalidator(resultUri) : resultUri,\n          'data-mce-src': editor.convertURL(resultUri, 'src')\n        });\n      };\n      var uploadImages = function (callback) {\n        if (!uploader) {\n          uploader = Uploader(uploadStatus, {\n            url: Settings.getImageUploadUrl(editor),\n            basePath: Settings.getImageUploadBasePath(editor),\n            credentials: Settings.getImagesUploadCredentials(editor),\n            handler: Settings.getImagesUploadHandler(editor)\n          });\n        }\n        return scanForImages().then(aliveGuard(function (imageInfos) {\n          var blobInfos = map(imageInfos, function (imageInfo) {\n            return imageInfo.blobInfo;\n          });\n          return uploader.upload(blobInfos, openNotification).then(aliveGuard(function (result) {\n            var filteredResult = map(result, function (uploadInfo, index) {\n              var image = imageInfos[index].image;\n              if (uploadInfo.status && Settings.shouldReplaceBlobUris(editor)) {\n                replaceImageUri(image, uploadInfo.url);\n              } else if (uploadInfo.error) {\n                ErrorReporter.uploadError(editor, uploadInfo.error);\n              }\n              return {\n                element: image,\n                status: uploadInfo.status\n              };\n            });\n            if (callback) {\n              callback(filteredResult);\n            }\n            return filteredResult;\n          }));\n        }));\n      };\n      var uploadImagesAuto = function (callback) {\n        if (Settings.isAutomaticUploadsEnabled(editor)) {\n          return uploadImages(callback);\n        }\n      };\n      var isValidDataUriImage = function (imgElm) {\n        if (forall(urlFilters, function (filter) {\n            return filter(imgElm);\n          }) === false) {\n          return false;\n        }\n        if (imgElm.getAttribute('src').indexOf('data:') === 0) {\n          var dataImgFilter = Settings.getImagesDataImgFilter(editor);\n          return dataImgFilter(imgElm);\n        }\n        return true;\n      };\n      var addFilter = function (filter) {\n        urlFilters.push(filter);\n      };\n      var scanForImages = function () {\n        if (!imageScanner) {\n          imageScanner = ImageScanner(uploadStatus, blobCache);\n        }\n        return imageScanner.findAll(editor.getBody(), isValidDataUriImage).then(aliveGuard(function (result) {\n          result = filter(result, function (resultItem) {\n            if (typeof resultItem === 'string') {\n              ErrorReporter.displayError(editor, resultItem);\n              return false;\n            }\n            return true;\n          });\n          each(result, function (resultItem) {\n            replaceUrlInUndoStack(resultItem.image.src, resultItem.blobInfo.blobUri());\n            resultItem.image.src = resultItem.blobInfo.blobUri();\n            resultItem.image.removeAttribute('data-mce-src');\n          });\n          return result;\n        }));\n      };\n      var destroy = function () {\n        blobCache.destroy();\n        uploadStatus.destroy();\n        imageScanner = uploader = null;\n      };\n      var replaceBlobUris = function (content) {\n        return content.replace(/src=\"(blob:[^\"]+)\"/g, function (match, blobUri) {\n          var resultUri = uploadStatus.getResultUri(blobUri);\n          if (resultUri) {\n            return 'src=\"' + resultUri + '\"';\n          }\n          var blobInfo = blobCache.getByUri(blobUri);\n          if (!blobInfo) {\n            blobInfo = foldl(editor.editorManager.get(), function (result, editor) {\n              return result || editor.editorUpload && editor.editorUpload.blobCache.getByUri(blobUri);\n            }, null);\n          }\n          if (blobInfo) {\n            var blob = blobInfo.blob();\n            return 'src=\"data:' + blob.type + ';base64,' + blobInfo.base64() + '\"';\n          }\n          return match;\n        });\n      };\n      editor.on('SetContent', function () {\n        if (Settings.isAutomaticUploadsEnabled(editor)) {\n          uploadImagesAuto();\n        } else {\n          scanForImages();\n        }\n      });\n      editor.on('RawSaveContent', function (e) {\n        e.content = replaceBlobUris(e.content);\n      });\n      editor.on('GetContent', function (e) {\n        if (e.source_view || e.format === 'raw') {\n          return;\n        }\n        e.content = replaceBlobUris(e.content);\n      });\n      editor.on('PostRender', function () {\n        editor.parser.addNodeFilter('img', function (images) {\n          each(images, function (img) {\n            var src = img.attr('src');\n            if (blobCache.getByUri(src)) {\n              return;\n            }\n            var resultUri = uploadStatus.getResultUri(src);\n            if (resultUri) {\n              img.attr('src', resultUri);\n            }\n          });\n        });\n      });\n      return {\n        blobCache: blobCache,\n        addFilter: addFilter,\n        uploadImages: uploadImages,\n        uploadImagesAuto: uploadImagesAuto,\n        scanForImages: scanForImages,\n        destroy: destroy\n      };\n    };\n\n    var getLastChildren$1 = function (elm) {\n      var children = [];\n      var rawNode = elm.dom();\n      while (rawNode) {\n        children.push(Element.fromDom(rawNode));\n        rawNode = rawNode.lastChild;\n      }\n      return children;\n    };\n    var removeTrailingBr = function (elm) {\n      var allBrs = descendants$1(elm, 'br');\n      var brs = filter(getLastChildren$1(elm).slice(-1), isBr$1);\n      if (allBrs.length === brs.length) {\n        each(brs, remove);\n      }\n    };\n    var fillWithPaddingBr = function (elm) {\n      empty(elm);\n      append(elm, Element.fromHtml('<br data-mce-bogus=\"1\">'));\n    };\n    var isPaddingContents = function (elm) {\n      return isText(elm) ? get$7(elm) === nbsp : isBr$1(elm);\n    };\n    var isPaddedElement = function (elm) {\n      return filter(children(elm), isPaddingContents).length === 1;\n    };\n    var trimBlockTrailingBr = function (elm) {\n      lastChild(elm).each(function (lastChild) {\n        prevSibling(lastChild).each(function (lastChildPrevSibling) {\n          if (isBlock(elm) && isBr$1(lastChild) && isBlock(lastChildPrevSibling)) {\n            remove(lastChild);\n          }\n        });\n      });\n    };\n    var PaddingBr = {\n      removeTrailingBr: removeTrailingBr,\n      fillWithPaddingBr: fillWithPaddingBr,\n      isPaddedElement: isPaddedElement,\n      trimBlockTrailingBr: trimBlockTrailingBr\n    };\n\n    var isEq$2 = isEq;\n    var matchesUnInheritedFormatSelector = function (ed, node, name) {\n      var formatList = ed.formatter.get(name);\n      if (formatList) {\n        for (var i = 0; i < formatList.length; i++) {\n          if (formatList[i].inherit === false && ed.dom.is(node, formatList[i].selector)) {\n            return true;\n          }\n        }\n      }\n      return false;\n    };\n    var matchParents = function (editor, node, name, vars) {\n      var root = editor.dom.getRoot();\n      if (node === root) {\n        return false;\n      }\n      node = editor.dom.getParent(node, function (node) {\n        if (matchesUnInheritedFormatSelector(editor, node, name)) {\n          return true;\n        }\n        return node.parentNode === root || !!matchNode(editor, node, name, vars, true);\n      });\n      return matchNode(editor, node, name, vars);\n    };\n    var matchName = function (dom, node, format) {\n      if (isEq$2(node, format.inline)) {\n        return true;\n      }\n      if (isEq$2(node, format.block)) {\n        return true;\n      }\n      if (format.selector) {\n        return node.nodeType === 1 && dom.is(node, format.selector);\n      }\n    };\n    var matchItems = function (dom, node, format, itemName, similar, vars) {\n      var key, value;\n      var items = format[itemName];\n      var i;\n      if (format.onmatch) {\n        return format.onmatch(node, format, itemName);\n      }\n      if (items) {\n        if (typeof items.length === 'undefined') {\n          for (key in items) {\n            if (items.hasOwnProperty(key)) {\n              if (itemName === 'attributes') {\n                value = dom.getAttrib(node, key);\n              } else {\n                value = getStyle(dom, node, key);\n              }\n              if (similar && !value && !format.exact) {\n                return;\n              }\n              if ((!similar || format.exact) && !isEq$2(value, normalizeStyleValue(dom, replaceVars(items[key], vars), key))) {\n                return;\n              }\n            }\n          }\n        } else {\n          for (i = 0; i < items.length; i++) {\n            if (itemName === 'attributes' ? dom.getAttrib(node, items[i]) : getStyle(dom, node, items[i])) {\n              return format;\n            }\n          }\n        }\n      }\n      return format;\n    };\n    var matchNode = function (ed, node, name, vars, similar) {\n      var formatList = ed.formatter.get(name);\n      var format, i, x, classes;\n      var dom = ed.dom;\n      if (formatList && node) {\n        for (i = 0; i < formatList.length; i++) {\n          format = formatList[i];\n          if (matchName(ed.dom, node, format) && matchItems(dom, node, format, 'attributes', similar, vars) && matchItems(dom, node, format, 'styles', similar, vars)) {\n            if (classes = format.classes) {\n              for (x = 0; x < classes.length; x++) {\n                if (!ed.dom.hasClass(node, classes[x])) {\n                  return;\n                }\n              }\n            }\n            return format;\n          }\n        }\n      }\n    };\n    var match = function (editor, name, vars, node) {\n      var startNode;\n      if (node) {\n        return matchParents(editor, node, name, vars);\n      }\n      node = editor.selection.getNode();\n      if (matchParents(editor, node, name, vars)) {\n        return true;\n      }\n      startNode = editor.selection.getStart();\n      if (startNode !== node) {\n        if (matchParents(editor, startNode, name, vars)) {\n          return true;\n        }\n      }\n      return false;\n    };\n    var matchAll = function (editor, names, vars) {\n      var startElement;\n      var matchedFormatNames = [];\n      var checkedMap = {};\n      startElement = editor.selection.getStart();\n      editor.dom.getParent(startElement, function (node) {\n        var i, name;\n        for (i = 0; i < names.length; i++) {\n          name = names[i];\n          if (!checkedMap[name] && matchNode(editor, node, name, vars)) {\n            checkedMap[name] = true;\n            matchedFormatNames.push(name);\n          }\n        }\n      }, editor.dom.getRoot());\n      return matchedFormatNames;\n    };\n    var canApply = function (editor, name) {\n      var formatList = editor.formatter.get(name);\n      var startNode, parents, i, x, selector;\n      var dom = editor.dom;\n      if (formatList) {\n        startNode = editor.selection.getStart();\n        parents = getParents$1(dom, startNode);\n        for (x = formatList.length - 1; x >= 0; x--) {\n          selector = formatList[x].selector;\n          if (!selector || formatList[x].defaultBlock) {\n            return true;\n          }\n          for (i = parents.length - 1; i >= 0; i--) {\n            if (dom.is(parents[i], selector)) {\n              return true;\n            }\n          }\n        }\n      }\n      return false;\n    };\n\n    var splitText = function (node, offset) {\n      return node.splitText(offset);\n    };\n    var split$1 = function (rng) {\n      var startContainer = rng.startContainer, startOffset = rng.startOffset, endContainer = rng.endContainer, endOffset = rng.endOffset;\n      if (startContainer === endContainer && NodeType.isText(startContainer)) {\n        if (startOffset > 0 && startOffset < startContainer.nodeValue.length) {\n          endContainer = splitText(startContainer, startOffset);\n          startContainer = endContainer.previousSibling;\n          if (endOffset > startOffset) {\n            endOffset = endOffset - startOffset;\n            startContainer = endContainer = splitText(endContainer, endOffset).previousSibling;\n            endOffset = endContainer.nodeValue.length;\n            startOffset = 0;\n          } else {\n            endOffset = 0;\n          }\n        }\n      } else {\n        if (NodeType.isText(startContainer) && startOffset > 0 && startOffset < startContainer.nodeValue.length) {\n          startContainer = splitText(startContainer, startOffset);\n          startOffset = 0;\n        }\n        if (NodeType.isText(endContainer) && endOffset > 0 && endOffset < endContainer.nodeValue.length) {\n          endContainer = splitText(endContainer, endOffset).previousSibling;\n          endOffset = endContainer.nodeValue.length;\n        }\n      }\n      return {\n        startContainer: startContainer,\n        startOffset: startOffset,\n        endContainer: endContainer,\n        endOffset: endOffset\n      };\n    };\n\n    var normalizeContent = function (content, isStartOfContent, isEndOfContent) {\n      var result = foldl(content, function (acc, c) {\n        if (isWhiteSpace$1(c) || isNbsp(c)) {\n          if (acc.previousCharIsSpace || acc.str === '' && isStartOfContent || acc.str.length === content.length - 1 && isEndOfContent) {\n            return {\n              previousCharIsSpace: false,\n              str: acc.str + nbsp\n            };\n          } else {\n            return {\n              previousCharIsSpace: true,\n              str: acc.str + ' '\n            };\n          }\n        } else {\n          return {\n            previousCharIsSpace: false,\n            str: acc.str + c\n          };\n        }\n      }, {\n        previousCharIsSpace: false,\n        str: ''\n      });\n      return result.str;\n    };\n    var normalize$1 = function (node, offset, count) {\n      if (count === 0) {\n        return;\n      }\n      var whitespace = node.data.slice(offset, offset + count);\n      var isEndOfContent = offset + count >= node.data.length;\n      var isStartOfContent = offset === 0;\n      node.replaceData(offset, count, normalizeContent(whitespace, isStartOfContent, isEndOfContent));\n    };\n    var normalizeWhitespaceAfter = function (node, offset) {\n      var content = node.data.slice(offset);\n      var whitespaceCount = content.length - lTrim(content).length;\n      return normalize$1(node, offset, whitespaceCount);\n    };\n    var normalizeWhitespaceBefore = function (node, offset) {\n      var content = node.data.slice(0, offset);\n      var whitespaceCount = content.length - rTrim(content).length;\n      return normalize$1(node, offset - whitespaceCount, whitespaceCount);\n    };\n    var mergeTextNodes = function (prevNode, nextNode, normalizeWhitespace) {\n      var whitespaceOffset = rTrim(prevNode.data).length;\n      prevNode.appendData(nextNode.data);\n      remove(Element.fromDom(nextNode));\n      if (normalizeWhitespace) {\n        normalizeWhitespaceAfter(prevNode, whitespaceOffset);\n      }\n      return prevNode;\n    };\n\n    var ancestor$2 = function (scope, selector, isRoot) {\n      return ancestor$1(scope, selector, isRoot).isSome();\n    };\n\n    var hasWhitespacePreserveParent = function (rootNode, node) {\n      var rootElement = Element.fromDom(rootNode);\n      var startNode = Element.fromDom(node);\n      return ancestor$2(startNode, 'pre,code', curry(eq, rootElement));\n    };\n    var isWhitespace = function (rootNode, node) {\n      return NodeType.isText(node) && /^[ \\t\\r\\n]*$/.test(node.data) && hasWhitespacePreserveParent(rootNode, node) === false;\n    };\n    var isNamedAnchor = function (node) {\n      return NodeType.isElement(node) && node.nodeName === 'A' && node.hasAttribute('name');\n    };\n    var isContent$1 = function (rootNode, node) {\n      return isCaretCandidate(node) && isWhitespace(rootNode, node) === false || isNamedAnchor(node) || isBookmark(node);\n    };\n    var isBookmark = NodeType.hasAttribute('data-mce-bookmark');\n    var isBogus$2 = NodeType.hasAttribute('data-mce-bogus');\n    var isBogusAll$1 = NodeType.hasAttributeValue('data-mce-bogus', 'all');\n    var isEmptyNode = function (targetNode, skipBogus) {\n      var node, brCount = 0;\n      if (isContent$1(targetNode, targetNode)) {\n        return false;\n      } else {\n        node = targetNode.firstChild;\n        if (!node) {\n          return true;\n        }\n        var walker = new TreeWalker(node, targetNode);\n        do {\n          if (skipBogus) {\n            if (isBogusAll$1(node)) {\n              node = walker.next(true);\n              continue;\n            }\n            if (isBogus$2(node)) {\n              node = walker.next();\n              continue;\n            }\n          }\n          if (NodeType.isBr(node)) {\n            brCount++;\n            node = walker.next();\n            continue;\n          }\n          if (isContent$1(targetNode, node)) {\n            return false;\n          }\n          node = walker.next();\n        } while (node);\n        return brCount <= 1;\n      }\n    };\n    var isEmpty$2 = function (elm, skipBogus) {\n      if (skipBogus === void 0) {\n        skipBogus = true;\n      }\n      return isEmptyNode(elm.dom(), skipBogus);\n    };\n    var Empty = { isEmpty: isEmpty$2 };\n\n    var needsReposition = function (pos, elm) {\n      var container = pos.container();\n      var offset = pos.offset();\n      return CaretPosition$1.isTextPosition(pos) === false && container === elm.parentNode && offset > CaretPosition$1.before(elm).offset();\n    };\n    var reposition = function (elm, pos) {\n      return needsReposition(pos, elm) ? CaretPosition$1(pos.container(), pos.offset() - 1) : pos;\n    };\n    var beforeOrStartOf = function (node) {\n      return NodeType.isText(node) ? CaretPosition$1(node, 0) : CaretPosition$1.before(node);\n    };\n    var afterOrEndOf = function (node) {\n      return NodeType.isText(node) ? CaretPosition$1(node, node.data.length) : CaretPosition$1.after(node);\n    };\n    var getPreviousSiblingCaretPosition = function (elm) {\n      if (isCaretCandidate(elm.previousSibling)) {\n        return Option.some(afterOrEndOf(elm.previousSibling));\n      } else {\n        return elm.previousSibling ? CaretFinder.lastPositionIn(elm.previousSibling) : Option.none();\n      }\n    };\n    var getNextSiblingCaretPosition = function (elm) {\n      if (isCaretCandidate(elm.nextSibling)) {\n        return Option.some(beforeOrStartOf(elm.nextSibling));\n      } else {\n        return elm.nextSibling ? CaretFinder.firstPositionIn(elm.nextSibling) : Option.none();\n      }\n    };\n    var findCaretPositionBackwardsFromElm = function (rootElement, elm) {\n      var startPosition = CaretPosition$1.before(elm.previousSibling ? elm.previousSibling : elm.parentNode);\n      return CaretFinder.prevPosition(rootElement, startPosition).fold(function () {\n        return CaretFinder.nextPosition(rootElement, CaretPosition$1.after(elm));\n      }, Option.some);\n    };\n    var findCaretPositionForwardsFromElm = function (rootElement, elm) {\n      return CaretFinder.nextPosition(rootElement, CaretPosition$1.after(elm)).fold(function () {\n        return CaretFinder.prevPosition(rootElement, CaretPosition$1.before(elm));\n      }, Option.some);\n    };\n    var findCaretPositionBackwards = function (rootElement, elm) {\n      return getPreviousSiblingCaretPosition(elm).orThunk(function () {\n        return getNextSiblingCaretPosition(elm);\n      }).orThunk(function () {\n        return findCaretPositionBackwardsFromElm(rootElement, elm);\n      });\n    };\n    var findCaretPositionForward = function (rootElement, elm) {\n      return getNextSiblingCaretPosition(elm).orThunk(function () {\n        return getPreviousSiblingCaretPosition(elm);\n      }).orThunk(function () {\n        return findCaretPositionForwardsFromElm(rootElement, elm);\n      });\n    };\n    var findCaretPosition$1 = function (forward, rootElement, elm) {\n      return forward ? findCaretPositionForward(rootElement, elm) : findCaretPositionBackwards(rootElement, elm);\n    };\n    var findCaretPosOutsideElmAfterDelete = function (forward, rootElement, elm) {\n      return findCaretPosition$1(forward, rootElement, elm).map(curry(reposition, elm));\n    };\n    var setSelection = function (editor, forward, pos) {\n      pos.fold(function () {\n        editor.focus();\n      }, function (pos) {\n        editor.selection.setRng(pos.toRange(), forward);\n      });\n    };\n    var eqRawNode = function (rawNode) {\n      return function (elm) {\n        return elm.dom() === rawNode;\n      };\n    };\n    var isBlock$2 = function (editor, elm) {\n      return elm && editor.schema.getBlockElements().hasOwnProperty(name(elm));\n    };\n    var paddEmptyBlock = function (elm) {\n      if (Empty.isEmpty(elm)) {\n        var br = Element.fromHtml('<br data-mce-bogus=\"1\">');\n        empty(elm);\n        append(elm, br);\n        return Option.some(CaretPosition$1.before(br.dom()));\n      } else {\n        return Option.none();\n      }\n    };\n    var deleteNormalized = function (elm, afterDeletePosOpt, normalizeWhitespace) {\n      var prevTextOpt = prevSibling(elm).filter(isText);\n      var nextTextOpt = nextSibling(elm).filter(isText);\n      remove(elm);\n      return lift3(prevTextOpt, nextTextOpt, afterDeletePosOpt, function (prev, next, pos) {\n        var prevNode = prev.dom(), nextNode = next.dom();\n        var offset = prevNode.data.length;\n        mergeTextNodes(prevNode, nextNode, normalizeWhitespace);\n        return pos.container() === nextNode ? CaretPosition$1(prevNode, offset) : pos;\n      }).orThunk(function () {\n        if (normalizeWhitespace) {\n          prevTextOpt.each(function (elm) {\n            return normalizeWhitespaceBefore(elm.dom(), elm.dom().length);\n          });\n          nextTextOpt.each(function (elm) {\n            return normalizeWhitespaceAfter(elm.dom(), 0);\n          });\n        }\n        return afterDeletePosOpt;\n      });\n    };\n    var isInlineElement = function (editor, element) {\n      return has(editor.schema.getTextInlineElements(), name(element));\n    };\n    var deleteElement = function (editor, forward, elm, moveCaret) {\n      if (moveCaret === void 0) {\n        moveCaret = true;\n      }\n      var afterDeletePos = findCaretPosOutsideElmAfterDelete(forward, editor.getBody(), elm.dom());\n      var parentBlock = ancestor(elm, curry(isBlock$2, editor), eqRawNode(editor.getBody()));\n      var normalizedAfterDeletePos = deleteNormalized(elm, afterDeletePos, isInlineElement(editor, elm));\n      if (editor.dom.isEmpty(editor.getBody())) {\n        editor.setContent('');\n        editor.selection.setCursorLocation();\n      } else {\n        parentBlock.bind(paddEmptyBlock).fold(function () {\n          if (moveCaret) {\n            setSelection(editor, forward, normalizedAfterDeletePos);\n          }\n        }, function (paddPos) {\n          if (moveCaret) {\n            setSelection(editor, forward, Option.some(paddPos));\n          }\n        });\n      }\n    };\n    var DeleteElement = { deleteElement: deleteElement };\n\n    var ZWSP$1 = Zwsp.ZWSP, CARET_ID$1 = '_mce_caret';\n    var importNode = function (ownerDocument, node) {\n      return ownerDocument.importNode(node, true);\n    };\n    var getEmptyCaretContainers = function (node) {\n      var nodes = [];\n      while (node) {\n        if (node.nodeType === 3 && node.nodeValue !== ZWSP$1 || node.childNodes.length > 1) {\n          return [];\n        }\n        if (node.nodeType === 1) {\n          nodes.push(node);\n        }\n        node = node.firstChild;\n      }\n      return nodes;\n    };\n    var isCaretContainerEmpty = function (node) {\n      return getEmptyCaretContainers(node).length > 0;\n    };\n    var findFirstTextNode = function (node) {\n      if (node) {\n        var walker = new TreeWalker(node, node);\n        for (node = walker.current(); node; node = walker.next()) {\n          if (NodeType.isText(node)) {\n            return node;\n          }\n        }\n      }\n      return null;\n    };\n    var createCaretContainer = function (fill) {\n      var caretContainer = Element.fromTag('span');\n      setAll(caretContainer, {\n        'id': CARET_ID$1,\n        'data-mce-bogus': '1',\n        'data-mce-type': 'format-caret'\n      });\n      if (fill) {\n        append(caretContainer, Element.fromText(ZWSP$1));\n      }\n      return caretContainer;\n    };\n    var trimZwspFromCaretContainer = function (caretContainerNode) {\n      var textNode = findFirstTextNode(caretContainerNode);\n      if (textNode && textNode.nodeValue.charAt(0) === ZWSP$1) {\n        textNode.deleteData(0, 1);\n      }\n      return textNode;\n    };\n    var removeCaretContainerNode = function (editor, node, moveCaret) {\n      if (moveCaret === void 0) {\n        moveCaret = true;\n      }\n      var dom = editor.dom, selection = editor.selection;\n      if (isCaretContainerEmpty(node)) {\n        DeleteElement.deleteElement(editor, false, Element.fromDom(node), moveCaret);\n      } else {\n        var rng = selection.getRng();\n        var block = dom.getParent(node, dom.isBlock);\n        var textNode = trimZwspFromCaretContainer(node);\n        if (rng.startContainer === textNode && rng.startOffset > 0) {\n          rng.setStart(textNode, rng.startOffset - 1);\n        }\n        if (rng.endContainer === textNode && rng.endOffset > 0) {\n          rng.setEnd(textNode, rng.endOffset - 1);\n        }\n        dom.remove(node, true);\n        if (block && dom.isEmpty(block)) {\n          PaddingBr.fillWithPaddingBr(Element.fromDom(block));\n        }\n        selection.setRng(rng);\n      }\n    };\n    var removeCaretContainer = function (editor, node, moveCaret) {\n      if (moveCaret === void 0) {\n        moveCaret = true;\n      }\n      var dom = editor.dom, selection = editor.selection;\n      if (!node) {\n        node = getParentCaretContainer(editor.getBody(), selection.getStart());\n        if (!node) {\n          while (node = dom.get(CARET_ID$1)) {\n            removeCaretContainerNode(editor, node, false);\n          }\n        }\n      } else {\n        removeCaretContainerNode(editor, node, moveCaret);\n      }\n    };\n    var insertCaretContainerNode = function (editor, caretContainer, formatNode) {\n      var dom = editor.dom, block = dom.getParent(formatNode, curry(isTextBlock$1, editor));\n      if (block && dom.isEmpty(block)) {\n        formatNode.parentNode.replaceChild(caretContainer, formatNode);\n      } else {\n        PaddingBr.removeTrailingBr(Element.fromDom(formatNode));\n        if (dom.isEmpty(formatNode)) {\n          formatNode.parentNode.replaceChild(caretContainer, formatNode);\n        } else {\n          dom.insertAfter(caretContainer, formatNode);\n        }\n      }\n    };\n    var appendNode = function (parentNode, node) {\n      parentNode.appendChild(node);\n      return node;\n    };\n    var insertFormatNodesIntoCaretContainer = function (formatNodes, caretContainer) {\n      var innerMostFormatNode = foldr(formatNodes, function (parentNode, formatNode) {\n        return appendNode(parentNode, formatNode.cloneNode(false));\n      }, caretContainer);\n      return appendNode(innerMostFormatNode, innerMostFormatNode.ownerDocument.createTextNode(ZWSP$1));\n    };\n    var applyCaretFormat = function (editor, name, vars) {\n      var rng, caretContainer, textNode, offset, bookmark, container, text;\n      var selection = editor.selection;\n      rng = selection.getRng();\n      offset = rng.startOffset;\n      container = rng.startContainer;\n      text = container.nodeValue;\n      caretContainer = getParentCaretContainer(editor.getBody(), selection.getStart());\n      if (caretContainer) {\n        textNode = findFirstTextNode(caretContainer);\n      }\n      var wordcharRegex = /[^\\s\\u00a0\\u00ad\\u200b\\ufeff]/;\n      if (text && offset > 0 && offset < text.length && wordcharRegex.test(text.charAt(offset)) && wordcharRegex.test(text.charAt(offset - 1))) {\n        bookmark = selection.getBookmark();\n        rng.collapse(true);\n        rng = expandRng(editor, rng, editor.formatter.get(name));\n        rng = split$1(rng);\n        editor.formatter.apply(name, vars, rng);\n        selection.moveToBookmark(bookmark);\n      } else {\n        if (!caretContainer || textNode.nodeValue !== ZWSP$1) {\n          caretContainer = importNode(editor.getDoc(), createCaretContainer(true).dom());\n          textNode = caretContainer.firstChild;\n          rng.insertNode(caretContainer);\n          offset = 1;\n          editor.formatter.apply(name, vars, caretContainer);\n        } else {\n          editor.formatter.apply(name, vars, caretContainer);\n        }\n        selection.setCursorLocation(textNode, offset);\n      }\n    };\n    var removeCaretFormat = function (editor, name, vars, similar) {\n      var dom = editor.dom, selection = editor.selection;\n      var container, offset, bookmark;\n      var hasContentAfter, node, formatNode;\n      var parents = [], rng = selection.getRng();\n      var caretContainer;\n      container = rng.startContainer;\n      offset = rng.startOffset;\n      node = container;\n      if (container.nodeType === 3) {\n        if (offset !== container.nodeValue.length) {\n          hasContentAfter = true;\n        }\n        node = node.parentNode;\n      }\n      while (node) {\n        if (matchNode(editor, node, name, vars, similar)) {\n          formatNode = node;\n          break;\n        }\n        if (node.nextSibling) {\n          hasContentAfter = true;\n        }\n        parents.push(node);\n        node = node.parentNode;\n      }\n      if (!formatNode) {\n        return;\n      }\n      if (hasContentAfter) {\n        bookmark = selection.getBookmark();\n        rng.collapse(true);\n        var expandedRng = expandRng(editor, rng, editor.formatter.get(name), true);\n        expandedRng = split$1(expandedRng);\n        editor.formatter.remove(name, vars, expandedRng);\n        selection.moveToBookmark(bookmark);\n      } else {\n        caretContainer = getParentCaretContainer(editor.getBody(), formatNode);\n        var newCaretContainer = createCaretContainer(false).dom();\n        var caretNode = insertFormatNodesIntoCaretContainer(parents, newCaretContainer);\n        if (caretContainer) {\n          insertCaretContainerNode(editor, newCaretContainer, caretContainer);\n        } else {\n          insertCaretContainerNode(editor, newCaretContainer, formatNode);\n        }\n        removeCaretContainerNode(editor, caretContainer, false);\n        selection.setCursorLocation(caretNode, 1);\n        if (dom.isEmpty(formatNode)) {\n          dom.remove(formatNode);\n        }\n      }\n    };\n    var disableCaretContainer = function (editor, keyCode) {\n      var selection = editor.selection, body = editor.getBody();\n      removeCaretContainer(editor, null, false);\n      if ((keyCode === 8 || keyCode === 46) && selection.isCollapsed() && selection.getStart().innerHTML === ZWSP$1) {\n        removeCaretContainer(editor, getParentCaretContainer(body, selection.getStart()));\n      }\n      if (keyCode === 37 || keyCode === 39) {\n        removeCaretContainer(editor, getParentCaretContainer(body, selection.getStart()));\n      }\n    };\n    var setup$3 = function (editor) {\n      editor.on('mouseup keydown', function (e) {\n        disableCaretContainer(editor, e.keyCode);\n      });\n    };\n    var replaceWithCaretFormat = function (targetNode, formatNodes) {\n      var caretContainer = createCaretContainer(false);\n      var innerMost = insertFormatNodesIntoCaretContainer(formatNodes, caretContainer.dom());\n      before(Element.fromDom(targetNode), caretContainer);\n      remove(Element.fromDom(targetNode));\n      return CaretPosition$1(innerMost, 0);\n    };\n    var isFormatElement = function (editor, element) {\n      var inlineElements = editor.schema.getTextInlineElements();\n      return inlineElements.hasOwnProperty(name(element)) && !isCaretNode(element.dom()) && !NodeType.isBogus(element.dom());\n    };\n    var isEmptyCaretFormatElement = function (element) {\n      return isCaretNode(element.dom()) && isCaretContainerEmpty(element.dom());\n    };\n\n    var postProcessHooks = {}, filter$3 = ArrUtils.filter, each$9 = ArrUtils.each;\n    var addPostProcessHook = function (name, hook) {\n      var hooks = postProcessHooks[name];\n      if (!hooks) {\n        postProcessHooks[name] = hooks = [];\n      }\n      postProcessHooks[name].push(hook);\n    };\n    var postProcess$1 = function (name, editor) {\n      each$9(postProcessHooks[name], function (hook) {\n        hook(editor);\n      });\n    };\n    addPostProcessHook('pre', function (editor) {\n      var rng = editor.selection.getRng();\n      var isPre, blocks;\n      var hasPreSibling = function (pre) {\n        return isPre(pre.previousSibling) && ArrUtils.indexOf(blocks, pre.previousSibling) !== -1;\n      };\n      var joinPre = function (pre1, pre2) {\n        DomQuery(pre2).remove();\n        DomQuery(pre1).append('<br><br>').append(pre2.childNodes);\n      };\n      isPre = NodeType.matchNodeNames(['pre']);\n      if (!rng.collapsed) {\n        blocks = editor.selection.getSelectedBlocks();\n        each$9(filter$3(filter$3(blocks, isPre), hasPreSibling), function (pre) {\n          joinPre(pre.previousSibling, pre);\n        });\n      }\n    });\n\n    var each$a = Tools.each;\n    var ElementUtils = function (dom) {\n      this.compare = function (node1, node2) {\n        if (node1.nodeName !== node2.nodeName) {\n          return false;\n        }\n        var getAttribs = function (node) {\n          var attribs = {};\n          each$a(dom.getAttribs(node), function (attr) {\n            var name = attr.nodeName.toLowerCase();\n            if (name.indexOf('_') !== 0 && name !== 'style' && name.indexOf('data-') !== 0) {\n              attribs[name] = dom.getAttrib(node, name);\n            }\n          });\n          return attribs;\n        };\n        var compareObjects = function (obj1, obj2) {\n          var value, name;\n          for (name in obj1) {\n            if (obj1.hasOwnProperty(name)) {\n              value = obj2[name];\n              if (typeof value === 'undefined') {\n                return false;\n              }\n              if (obj1[name] !== value) {\n                return false;\n              }\n              delete obj2[name];\n            }\n          }\n          for (name in obj2) {\n            if (obj2.hasOwnProperty(name)) {\n              return false;\n            }\n          }\n          return true;\n        };\n        if (!compareObjects(getAttribs(node1), getAttribs(node2))) {\n          return false;\n        }\n        if (!compareObjects(dom.parseStyle(dom.getAttrib(node1, 'style')), dom.parseStyle(dom.getAttrib(node2, 'style')))) {\n          return false;\n        }\n        return !Bookmarks.isBookmarkNode(node1) && !Bookmarks.isBookmarkNode(node2);\n      };\n    };\n\n    var MCE_ATTR_RE = /^(src|href|style)$/;\n    var each$b = Tools.each;\n    var isEq$3 = isEq;\n    var isTableCell$3 = function (node) {\n      return /^(TH|TD)$/.test(node.nodeName);\n    };\n    var isChildOfInlineParent = function (dom, node, parent) {\n      return dom.isChildOf(node, parent) && node !== parent && !dom.isBlock(parent);\n    };\n    var getContainer = function (ed, rng, start) {\n      var container, offset;\n      container = rng[start ? 'startContainer' : 'endContainer'];\n      offset = rng[start ? 'startOffset' : 'endOffset'];\n      if (NodeType.isElement(container)) {\n        var lastIdx = container.childNodes.length - 1;\n        if (!start && offset) {\n          offset--;\n        }\n        container = container.childNodes[offset > lastIdx ? lastIdx : offset];\n      }\n      if (NodeType.isText(container) && start && offset >= container.nodeValue.length) {\n        container = new TreeWalker(container, ed.getBody()).next() || container;\n      }\n      if (NodeType.isText(container) && !start && offset === 0) {\n        container = new TreeWalker(container, ed.getBody()).prev() || container;\n      }\n      return container;\n    };\n    var wrap$3 = function (dom, node, name, attrs) {\n      var wrapper = dom.create(name, attrs);\n      node.parentNode.insertBefore(wrapper, node);\n      wrapper.appendChild(node);\n      return wrapper;\n    };\n    var wrapWithSiblings = function (dom, node, next, name, attrs) {\n      var start = Element.fromDom(node);\n      var wrapper = Element.fromDom(dom.create(name, attrs));\n      var siblings = next ? nextSiblings(start) : prevSiblings(start);\n      append$1(wrapper, siblings);\n      if (next) {\n        before(start, wrapper);\n        prepend(wrapper, start);\n      } else {\n        after(start, wrapper);\n        append(wrapper, start);\n      }\n      return wrapper.dom();\n    };\n    var matchName$1 = function (dom, node, format) {\n      if (isEq$3(node, format.inline)) {\n        return true;\n      }\n      if (isEq$3(node, format.block)) {\n        return true;\n      }\n      if (format.selector) {\n        return NodeType.isElement(node) && dom.is(node, format.selector);\n      }\n    };\n    var isColorFormatAndAnchor = function (node, format) {\n      return format.links && node.nodeName === 'A';\n    };\n    var find$4 = function (dom, node, next, inc) {\n      node = getNonWhiteSpaceSibling(node, next, inc);\n      return !node || (node.nodeName === 'BR' || dom.isBlock(node));\n    };\n    var removeNode$1 = function (ed, node, format) {\n      var parentNode = node.parentNode;\n      var rootBlockElm;\n      var dom = ed.dom, forcedRootBlock = Settings.getForcedRootBlock(ed);\n      if (format.block) {\n        if (!forcedRootBlock) {\n          if (dom.isBlock(node) && !dom.isBlock(parentNode)) {\n            if (!find$4(dom, node, false) && !find$4(dom, node.firstChild, true, true)) {\n              node.insertBefore(dom.create('br'), node.firstChild);\n            }\n            if (!find$4(dom, node, true) && !find$4(dom, node.lastChild, false, true)) {\n              node.appendChild(dom.create('br'));\n            }\n          }\n        } else {\n          if (parentNode === dom.getRoot()) {\n            if (!format.list_block || !isEq$3(node, format.list_block)) {\n              each$b(Tools.grep(node.childNodes), function (node) {\n                if (isValid(ed, forcedRootBlock, node.nodeName.toLowerCase())) {\n                  if (!rootBlockElm) {\n                    rootBlockElm = wrap$3(dom, node, forcedRootBlock);\n                    dom.setAttribs(rootBlockElm, ed.settings.forced_root_block_attrs);\n                  } else {\n                    rootBlockElm.appendChild(node);\n                  }\n                } else {\n                  rootBlockElm = 0;\n                }\n              });\n            }\n          }\n        }\n      }\n      if (format.selector && format.inline && !isEq$3(format.inline, node)) {\n        return;\n      }\n      dom.remove(node, true);\n    };\n    var removeFormat = function (ed, format, vars, node, compareNode) {\n      var stylesModified;\n      var dom = ed.dom;\n      if (!matchName$1(dom, node, format) && !isColorFormatAndAnchor(node, format)) {\n        return false;\n      }\n      var elm = node;\n      if (format.remove !== 'all') {\n        each$b(format.styles, function (value, name) {\n          value = normalizeStyleValue(dom, replaceVars(value, vars), name);\n          if (typeof name === 'number') {\n            name = value;\n            compareNode = null;\n          }\n          if (format.remove_similar || (!compareNode || isEq$3(getStyle(dom, compareNode, name), value))) {\n            dom.setStyle(elm, name, '');\n          }\n          stylesModified = true;\n        });\n        if (stylesModified && dom.getAttrib(elm, 'style') === '') {\n          elm.removeAttribute('style');\n          elm.removeAttribute('data-mce-style');\n        }\n        each$b(format.attributes, function (value, name) {\n          var valueOut;\n          value = replaceVars(value, vars);\n          if (typeof name === 'number') {\n            name = value;\n            compareNode = null;\n          }\n          if (format.remove_similar || (!compareNode || isEq$3(dom.getAttrib(compareNode, name), value))) {\n            if (name === 'class') {\n              value = dom.getAttrib(elm, name);\n              if (value) {\n                valueOut = '';\n                each$b(value.split(/\\s+/), function (cls) {\n                  if (/mce\\-\\w+/.test(cls)) {\n                    valueOut += (valueOut ? ' ' : '') + cls;\n                  }\n                });\n                if (valueOut) {\n                  dom.setAttrib(elm, name, valueOut);\n                  return;\n                }\n              }\n            }\n            if (name === 'class') {\n              elm.removeAttribute('className');\n            }\n            if (MCE_ATTR_RE.test(name)) {\n              elm.removeAttribute('data-mce-' + name);\n            }\n            elm.removeAttribute(name);\n          }\n        });\n        each$b(format.classes, function (value) {\n          value = replaceVars(value, vars);\n          if (!compareNode || dom.hasClass(compareNode, value)) {\n            dom.removeClass(elm, value);\n          }\n        });\n        var attrs = dom.getAttribs(elm);\n        for (var i = 0; i < attrs.length; i++) {\n          var attrName = attrs[i].nodeName;\n          if (attrName.indexOf('_') !== 0 && attrName.indexOf('data-') !== 0) {\n            return false;\n          }\n        }\n      }\n      if (format.remove !== 'none') {\n        removeNode$1(ed, elm, format);\n        return true;\n      }\n    };\n    var findFormatRoot = function (editor, container, name, vars, similar) {\n      var formatRoot;\n      each$b(getParents$1(editor.dom, container.parentNode).reverse(), function (parent) {\n        var format;\n        if (!formatRoot && parent.id !== '_start' && parent.id !== '_end') {\n          format = matchNode(editor, parent, name, vars, similar);\n          if (format && format.split !== false) {\n            formatRoot = parent;\n          }\n        }\n      });\n      return formatRoot;\n    };\n    var wrapAndSplit = function (editor, formatList, formatRoot, container, target, split, format, vars) {\n      var parent, clone, lastClone, firstClone, i, formatRootParent;\n      var dom = editor.dom;\n      if (formatRoot) {\n        formatRootParent = formatRoot.parentNode;\n        for (parent = container.parentNode; parent && parent !== formatRootParent; parent = parent.parentNode) {\n          clone = dom.clone(parent, false);\n          for (i = 0; i < formatList.length; i++) {\n            if (removeFormat(editor, formatList[i], vars, clone, clone)) {\n              clone = 0;\n              break;\n            }\n          }\n          if (clone) {\n            if (lastClone) {\n              clone.appendChild(lastClone);\n            }\n            if (!firstClone) {\n              firstClone = clone;\n            }\n            lastClone = clone;\n          }\n        }\n        if (split && (!format.mixed || !dom.isBlock(formatRoot))) {\n          container = dom.split(formatRoot, container);\n        }\n        if (lastClone) {\n          target.parentNode.insertBefore(lastClone, target);\n          firstClone.appendChild(target);\n        }\n      }\n      return container;\n    };\n    var remove$7 = function (ed, name, vars, node, similar) {\n      var formatList = ed.formatter.get(name), format = formatList[0];\n      var bookmark, rng, contentEditable = true;\n      var dom = ed.dom;\n      var selection = ed.selection;\n      var splitToFormatRoot = function (container) {\n        var formatRoot = findFormatRoot(ed, container, name, vars, similar);\n        return wrapAndSplit(ed, formatList, formatRoot, container, container, true, format, vars);\n      };\n      var isRemoveBookmarkNode = function (node) {\n        return Bookmarks.isBookmarkNode(node) && NodeType.isElement(node) && (node.id === '_start' || node.id === '_end');\n      };\n      var process = function (node) {\n        var children, i, l, lastContentEditable, hasContentEditableState;\n        if (NodeType.isElement(node) && dom.getContentEditable(node)) {\n          lastContentEditable = contentEditable;\n          contentEditable = dom.getContentEditable(node) === 'true';\n          hasContentEditableState = true;\n        }\n        children = Tools.grep(node.childNodes);\n        if (contentEditable && !hasContentEditableState) {\n          for (i = 0, l = formatList.length; i < l; i++) {\n            if (removeFormat(ed, formatList[i], vars, node, node)) {\n              break;\n            }\n          }\n        }\n        if (format.deep) {\n          if (children.length) {\n            for (i = 0, l = children.length; i < l; i++) {\n              process(children[i]);\n            }\n            if (hasContentEditableState) {\n              contentEditable = lastContentEditable;\n            }\n          }\n        }\n      };\n      var unwrap = function (start) {\n        var node = dom.get(start ? '_start' : '_end');\n        var out = node[start ? 'firstChild' : 'lastChild'];\n        if (isRemoveBookmarkNode(out)) {\n          out = out[start ? 'firstChild' : 'lastChild'];\n        }\n        if (NodeType.isText(out) && out.data.length === 0) {\n          out = start ? node.previousSibling || node.nextSibling : node.nextSibling || node.previousSibling;\n        }\n        dom.remove(node, true);\n        return out;\n      };\n      var removeRngStyle = function (rng) {\n        var startContainer, endContainer;\n        var commonAncestorContainer = rng.commonAncestorContainer;\n        var expandedRng = expandRng(ed, rng, formatList, true);\n        if (format.split) {\n          expandedRng = split$1(expandedRng);\n          startContainer = getContainer(ed, expandedRng, true);\n          endContainer = getContainer(ed, expandedRng);\n          if (startContainer !== endContainer) {\n            if (/^(TR|TH|TD)$/.test(startContainer.nodeName) && startContainer.firstChild) {\n              if (startContainer.nodeName === 'TR') {\n                startContainer = startContainer.firstChild.firstChild || startContainer;\n              } else {\n                startContainer = startContainer.firstChild || startContainer;\n              }\n            }\n            if (commonAncestorContainer && /^T(HEAD|BODY|FOOT|R)$/.test(commonAncestorContainer.nodeName) && isTableCell$3(endContainer) && endContainer.firstChild) {\n              endContainer = endContainer.firstChild || endContainer;\n            }\n            if (isChildOfInlineParent(dom, startContainer, endContainer)) {\n              var marker = Option.from(startContainer.firstChild).getOr(startContainer);\n              splitToFormatRoot(wrapWithSiblings(dom, marker, true, 'span', {\n                'id': '_start',\n                'data-mce-type': 'bookmark'\n              }));\n              unwrap(true);\n              return;\n            }\n            if (isChildOfInlineParent(dom, endContainer, startContainer)) {\n              var marker = Option.from(endContainer.lastChild).getOr(endContainer);\n              splitToFormatRoot(wrapWithSiblings(dom, marker, false, 'span', {\n                'id': '_end',\n                'data-mce-type': 'bookmark'\n              }));\n              unwrap(false);\n              return;\n            }\n            startContainer = wrap$3(dom, startContainer, 'span', {\n              'id': '_start',\n              'data-mce-type': 'bookmark'\n            });\n            endContainer = wrap$3(dom, endContainer, 'span', {\n              'id': '_end',\n              'data-mce-type': 'bookmark'\n            });\n            var newRng = dom.createRng();\n            newRng.setStartAfter(startContainer);\n            newRng.setEndBefore(endContainer);\n            RangeWalk.walk(dom, newRng, function (nodes) {\n              each(nodes, function (n) {\n                if (!Bookmarks.isBookmarkNode(n) && !Bookmarks.isBookmarkNode(n.parentNode)) {\n                  splitToFormatRoot(n);\n                }\n              });\n            });\n            splitToFormatRoot(startContainer);\n            splitToFormatRoot(endContainer);\n            startContainer = unwrap(true);\n            endContainer = unwrap();\n          } else {\n            startContainer = endContainer = splitToFormatRoot(startContainer);\n          }\n          expandedRng.startContainer = startContainer.parentNode ? startContainer.parentNode : startContainer;\n          expandedRng.startOffset = dom.nodeIndex(startContainer);\n          expandedRng.endContainer = endContainer.parentNode ? endContainer.parentNode : endContainer;\n          expandedRng.endOffset = dom.nodeIndex(endContainer) + 1;\n        }\n        RangeWalk.walk(dom, expandedRng, function (nodes) {\n          each$b(nodes, function (node) {\n            process(node);\n            if (NodeType.isElement(node) && ed.dom.getStyle(node, 'text-decoration') === 'underline' && node.parentNode && getTextDecoration(dom, node.parentNode) === 'underline') {\n              removeFormat(ed, {\n                deep: false,\n                exact: true,\n                inline: 'span',\n                styles: { textDecoration: 'underline' }\n              }, null, node);\n            }\n          });\n        });\n      };\n      if (node) {\n        if (isNode(node)) {\n          rng = dom.createRng();\n          rng.setStartBefore(node);\n          rng.setEndAfter(node);\n          removeRngStyle(rng);\n        } else {\n          removeRngStyle(node);\n        }\n        return;\n      }\n      if (dom.getContentEditable(selection.getNode()) === 'false') {\n        node = selection.getNode();\n        for (var i = 0, l = formatList.length; i < l; i++) {\n          if (formatList[i].ceFalseOverride) {\n            if (removeFormat(ed, formatList[i], vars, node, node)) {\n              break;\n            }\n          }\n        }\n        return;\n      }\n      if (!selection.isCollapsed() || !format.inline || dom.select('td[data-mce-selected],th[data-mce-selected]').length) {\n        bookmark = GetBookmark.getPersistentBookmark(ed.selection, true);\n        removeRngStyle(selection.getRng());\n        selection.moveToBookmark(bookmark);\n        if (format.inline && match(ed, name, vars, selection.getStart())) {\n          moveStart(dom, selection, selection.getRng());\n        }\n        ed.nodeChanged();\n      } else {\n        removeCaretFormat(ed, name, vars, similar);\n      }\n    };\n\n    var each$c = Tools.each;\n    var isElementNode = function (node) {\n      return NodeType.isElement(node) && !Bookmarks.isBookmarkNode(node) && !isCaretNode(node) && !NodeType.isBogus(node);\n    };\n    var findElementSibling = function (node, siblingName) {\n      var sibling;\n      for (sibling = node; sibling; sibling = sibling[siblingName]) {\n        if (NodeType.isText(sibling) && sibling.nodeValue.length !== 0) {\n          return node;\n        }\n        if (NodeType.isElement(sibling) && !Bookmarks.isBookmarkNode(sibling)) {\n          return sibling;\n        }\n      }\n      return node;\n    };\n    var mergeSiblingsNodes = function (dom, prev, next) {\n      var sibling, tmpSibling;\n      var elementUtils = new ElementUtils(dom);\n      if (prev && next) {\n        prev = findElementSibling(prev, 'previousSibling');\n        next = findElementSibling(next, 'nextSibling');\n        if (elementUtils.compare(prev, next)) {\n          for (sibling = prev.nextSibling; sibling && sibling !== next;) {\n            tmpSibling = sibling;\n            sibling = sibling.nextSibling;\n            prev.appendChild(tmpSibling);\n          }\n          dom.remove(next);\n          Tools.each(Tools.grep(next.childNodes), function (node) {\n            prev.appendChild(node);\n          });\n          return prev;\n        }\n      }\n      return next;\n    };\n    var processChildElements = function (node, filter, process) {\n      each$c(node.childNodes, function (node) {\n        if (isElementNode(node)) {\n          if (filter(node)) {\n            process(node);\n          }\n          if (node.hasChildNodes()) {\n            processChildElements(node, filter, process);\n          }\n        }\n      });\n    };\n    var hasStyle = function (dom, name) {\n      return curry(function (name, node) {\n        return !!(node && getStyle(dom, node, name));\n      }, name);\n    };\n    var applyStyle = function (dom, name, value) {\n      return curry(function (name, value, node) {\n        dom.setStyle(node, name, value);\n        if (node.getAttribute('style') === '') {\n          node.removeAttribute('style');\n        }\n        unwrapEmptySpan(dom, node);\n      }, name, value);\n    };\n    var unwrapEmptySpan = function (dom, node) {\n      if (node.nodeName === 'SPAN' && dom.getAttribs(node).length === 0) {\n        dom.remove(node, true);\n      }\n    };\n    var processUnderlineAndColor = function (dom, node) {\n      var textDecoration;\n      if (node.nodeType === 1 && node.parentNode && node.parentNode.nodeType === 1) {\n        textDecoration = getTextDecoration(dom, node.parentNode);\n        if (dom.getStyle(node, 'color') && textDecoration) {\n          dom.setStyle(node, 'text-decoration', textDecoration);\n        } else if (dom.getStyle(node, 'text-decoration') === textDecoration) {\n          dom.setStyle(node, 'text-decoration', null);\n        }\n      }\n    };\n    var mergeUnderlineAndColor = function (dom, format, vars, node) {\n      if (format.styles.color || format.styles.textDecoration) {\n        Tools.walk(node, curry(processUnderlineAndColor, dom), 'childNodes');\n        processUnderlineAndColor(dom, node);\n      }\n    };\n    var mergeBackgroundColorAndFontSize = function (dom, format, vars, node) {\n      if (format.styles && format.styles.backgroundColor) {\n        processChildElements(node, hasStyle(dom, 'fontSize'), applyStyle(dom, 'backgroundColor', replaceVars(format.styles.backgroundColor, vars)));\n      }\n    };\n    var mergeSubSup = function (dom, format, vars, node) {\n      if (format.inline === 'sub' || format.inline === 'sup') {\n        processChildElements(node, hasStyle(dom, 'fontSize'), applyStyle(dom, 'fontSize', ''));\n        dom.remove(dom.select(format.inline === 'sup' ? 'sub' : 'sup', node), true);\n      }\n    };\n    var mergeSiblings = function (dom, format, vars, node) {\n      if (node && format.merge_siblings !== false) {\n        node = mergeSiblingsNodes(dom, getNonWhiteSpaceSibling(node), node);\n        node = mergeSiblingsNodes(dom, node, getNonWhiteSpaceSibling(node, true));\n      }\n    };\n    var clearChildStyles = function (dom, format, node) {\n      if (format.clear_child_styles) {\n        var selector = format.links ? '*:not(a)' : '*';\n        each$c(dom.select(selector, node), function (node) {\n          if (isElementNode(node)) {\n            each$c(format.styles, function (value, name) {\n              dom.setStyle(node, name, '');\n            });\n          }\n        });\n      }\n    };\n    var mergeWithChildren = function (editor, formatList, vars, node) {\n      each$c(formatList, function (format) {\n        each$c(editor.dom.select(format.inline, node), function (child) {\n          if (!isElementNode(child)) {\n            return;\n          }\n          removeFormat(editor, format, vars, child, format.exact ? child : null);\n        });\n        clearChildStyles(editor.dom, format, node);\n      });\n    };\n    var mergeWithParents = function (editor, format, name, vars, node) {\n      if (matchNode(editor, node.parentNode, name, vars)) {\n        if (removeFormat(editor, format, vars, node)) {\n          return;\n        }\n      }\n      if (format.merge_with_parents) {\n        editor.dom.getParent(node.parentNode, function (parent) {\n          if (matchNode(editor, parent, name, vars)) {\n            removeFormat(editor, format, vars, node);\n            return true;\n          }\n        });\n      }\n    };\n\n    var createRange$1 = function (sc, so, ec, eo) {\n      var rng = domGlobals.document.createRange();\n      rng.setStart(sc, so);\n      rng.setEnd(ec, eo);\n      return rng;\n    };\n    var normalizeBlockSelectionRange = function (rng) {\n      var startPos = CaretPosition$1.fromRangeStart(rng);\n      var endPos = CaretPosition$1.fromRangeEnd(rng);\n      var rootNode = rng.commonAncestorContainer;\n      return CaretFinder.fromPosition(false, rootNode, endPos).map(function (newEndPos) {\n        if (!isInSameBlock(startPos, endPos, rootNode) && isInSameBlock(startPos, newEndPos, rootNode)) {\n          return createRange$1(startPos.container(), startPos.offset(), newEndPos.container(), newEndPos.offset());\n        } else {\n          return rng;\n        }\n      }).getOr(rng);\n    };\n    var normalize$2 = function (rng) {\n      return rng.collapsed ? rng : normalizeBlockSelectionRange(rng);\n    };\n    var RangeNormalizer = { normalize: normalize$2 };\n\n    var each$d = Tools.each;\n    var isElementNode$1 = function (node) {\n      return node && node.nodeType === 1 && !Bookmarks.isBookmarkNode(node) && !isCaretNode(node) && !NodeType.isBogus(node);\n    };\n    var applyFormat = function (ed, name, vars, node) {\n      var formatList = ed.formatter.get(name);\n      var format = formatList[0];\n      var bookmark, rng;\n      var isCollapsed = !node && ed.selection.isCollapsed();\n      var dom = ed.dom, selection = ed.selection;\n      var setElementFormat = function (elm, fmt) {\n        fmt = fmt || format;\n        if (elm) {\n          if (fmt.onformat) {\n            fmt.onformat(elm, fmt, vars, node);\n          }\n          each$d(fmt.styles, function (value, name) {\n            dom.setStyle(elm, name, replaceVars(value, vars));\n          });\n          if (fmt.styles) {\n            var styleVal = dom.getAttrib(elm, 'style');\n            if (styleVal) {\n              dom.setAttrib(elm, 'data-mce-style', styleVal);\n            }\n          }\n          each$d(fmt.attributes, function (value, name) {\n            dom.setAttrib(elm, name, replaceVars(value, vars));\n          });\n          each$d(fmt.classes, function (value) {\n            value = replaceVars(value, vars);\n            if (!dom.hasClass(elm, value)) {\n              dom.addClass(elm, value);\n            }\n          });\n        }\n      };\n      var applyNodeStyle = function (formatList, node) {\n        var found = false;\n        if (!format.selector) {\n          return false;\n        }\n        each$d(formatList, function (format) {\n          if ('collapsed' in format && format.collapsed !== isCollapsed) {\n            return;\n          }\n          if (dom.is(node, format.selector) && !isCaretNode(node)) {\n            setElementFormat(node, format);\n            found = true;\n            return false;\n          }\n        });\n        return found;\n      };\n      var applyRngStyle = function (dom, rng, bookmark, nodeSpecific) {\n        var newWrappers = [];\n        var wrapName, wrapElm, contentEditable = true;\n        wrapName = format.inline || format.block;\n        wrapElm = dom.create(wrapName);\n        setElementFormat(wrapElm);\n        RangeWalk.walk(dom, rng, function (nodes) {\n          var currentWrapElm;\n          var process = function (node) {\n            var hasContentEditableState = false;\n            var lastContentEditable = contentEditable;\n            var nodeName = node.nodeName.toLowerCase();\n            var parentName = node.parentNode.nodeName.toLowerCase();\n            if (NodeType.isElement(node) && dom.getContentEditable(node)) {\n              lastContentEditable = contentEditable;\n              contentEditable = dom.getContentEditable(node) === 'true';\n              hasContentEditableState = true;\n            }\n            if (isEq(nodeName, 'br')) {\n              currentWrapElm = 0;\n              if (format.block) {\n                dom.remove(node);\n              }\n              return;\n            }\n            if (format.wrapper && matchNode(ed, node, name, vars)) {\n              currentWrapElm = 0;\n              return;\n            }\n            if (contentEditable && !hasContentEditableState && format.block && !format.wrapper && isTextBlock$1(ed, nodeName) && isValid(ed, parentName, wrapName)) {\n              node = dom.rename(node, wrapName);\n              setElementFormat(node);\n              newWrappers.push(node);\n              currentWrapElm = 0;\n              return;\n            }\n            if (format.selector) {\n              var found = applyNodeStyle(formatList, node);\n              if (!format.inline || found) {\n                currentWrapElm = 0;\n                return;\n              }\n            }\n            if (contentEditable && !hasContentEditableState && isValid(ed, wrapName, nodeName) && isValid(ed, parentName, wrapName) && !(!nodeSpecific && node.nodeType === 3 && node.nodeValue.length === 1 && node.nodeValue.charCodeAt(0) === 65279) && !isCaretNode(node) && (!format.inline || !dom.isBlock(node))) {\n              if (!currentWrapElm) {\n                currentWrapElm = dom.clone(wrapElm, false);\n                node.parentNode.insertBefore(currentWrapElm, node);\n                newWrappers.push(currentWrapElm);\n              }\n              currentWrapElm.appendChild(node);\n            } else {\n              currentWrapElm = 0;\n              each$d(Tools.grep(node.childNodes), process);\n              if (hasContentEditableState) {\n                contentEditable = lastContentEditable;\n              }\n              currentWrapElm = 0;\n            }\n          };\n          each$d(nodes, process);\n        });\n        if (format.links === true) {\n          each$d(newWrappers, function (node) {\n            var process = function (node) {\n              if (node.nodeName === 'A') {\n                setElementFormat(node, format);\n              }\n              each$d(Tools.grep(node.childNodes), process);\n            };\n            process(node);\n          });\n        }\n        each$d(newWrappers, function (node) {\n          var childCount;\n          var getChildCount = function (node) {\n            var count = 0;\n            each$d(node.childNodes, function (node) {\n              if (!isEmptyTextNode(node) && !Bookmarks.isBookmarkNode(node)) {\n                count++;\n              }\n            });\n            return count;\n          };\n          var getChildElementNode = function (root) {\n            var child = false;\n            each$d(root.childNodes, function (node) {\n              if (isElementNode$1(node)) {\n                child = node;\n                return false;\n              }\n            });\n            return child;\n          };\n          var mergeStyles = function (node) {\n            var child, clone;\n            child = getChildElementNode(node);\n            if (child && !Bookmarks.isBookmarkNode(child) && matchName(dom, child, format)) {\n              clone = dom.clone(child, false);\n              setElementFormat(clone);\n              dom.replace(clone, node, true);\n              dom.remove(child, true);\n            }\n            return clone || node;\n          };\n          childCount = getChildCount(node);\n          if ((newWrappers.length > 1 || !dom.isBlock(node)) && childCount === 0) {\n            dom.remove(node, true);\n            return;\n          }\n          if (format.inline || format.wrapper) {\n            if (!format.exact && childCount === 1) {\n              node = mergeStyles(node);\n            }\n            mergeWithChildren(ed, formatList, vars, node);\n            mergeWithParents(ed, format, name, vars, node);\n            mergeBackgroundColorAndFontSize(dom, format, vars, node);\n            mergeSubSup(dom, format, vars, node);\n            mergeSiblings(dom, format, vars, node);\n          }\n        });\n      };\n      if (dom.getContentEditable(selection.getNode()) === 'false') {\n        node = selection.getNode();\n        for (var i = 0, l = formatList.length; i < l; i++) {\n          if (formatList[i].ceFalseOverride && dom.is(node, formatList[i].selector)) {\n            setElementFormat(node, formatList[i]);\n            return;\n          }\n        }\n        return;\n      }\n      if (format) {\n        if (node) {\n          if (isNode(node)) {\n            if (!applyNodeStyle(formatList, node)) {\n              rng = dom.createRng();\n              rng.setStartBefore(node);\n              rng.setEndAfter(node);\n              applyRngStyle(dom, expandRng(ed, rng, formatList), null, true);\n            }\n          } else {\n            applyRngStyle(dom, node, null, true);\n          }\n        } else {\n          if (!isCollapsed || !format.inline || dom.select('td[data-mce-selected],th[data-mce-selected]').length) {\n            var curSelNode = ed.selection.getNode();\n            if (!ed.settings.forced_root_block && formatList[0].defaultBlock && !dom.getParent(curSelNode, dom.isBlock)) {\n              applyFormat(ed, formatList[0].defaultBlock);\n            }\n            ed.selection.setRng(RangeNormalizer.normalize(ed.selection.getRng()));\n            bookmark = GetBookmark.getPersistentBookmark(ed.selection, true);\n            applyRngStyle(dom, expandRng(ed, selection.getRng(), formatList));\n            if (format.styles) {\n              mergeUnderlineAndColor(dom, format, vars, curSelNode);\n            }\n            selection.moveToBookmark(bookmark);\n            moveStart(dom, selection, selection.getRng());\n            ed.nodeChanged();\n          } else {\n            applyCaretFormat(ed, name, vars);\n          }\n        }\n        postProcess$1(name, ed);\n      }\n    };\n\n    var setup$4 = function (registeredFormatListeners, editor) {\n      var currentFormats = Cell({});\n      registeredFormatListeners.set({});\n      editor.on('NodeChange', function (e) {\n        updateAndFireChangeCallbacks(editor, e.element, currentFormats, registeredFormatListeners.get());\n      });\n    };\n    var updateAndFireChangeCallbacks = function (editor, elm, currentFormats, formatChangeData) {\n      var formatsList = keys(currentFormats.get());\n      var newFormats = {};\n      var matchedFormats = {};\n      var parents = filter(getParents$1(editor.dom, elm), function (node) {\n        return node.nodeType === 1 && !node.getAttribute('data-mce-bogus');\n      });\n      each$1(formatChangeData, function (data, format) {\n        Tools.each(parents, function (node) {\n          if (editor.formatter.matchNode(node, format, {}, data.similar)) {\n            if (formatsList.indexOf(format) === -1) {\n              each(data.callbacks, function (callback) {\n                callback(true, {\n                  node: node,\n                  format: format,\n                  parents: parents\n                });\n              });\n              newFormats[format] = data.callbacks;\n            }\n            matchedFormats[format] = data.callbacks;\n            return false;\n          }\n          if (matchesUnInheritedFormatSelector(editor, node, format)) {\n            return false;\n          }\n        });\n      });\n      var remainingFormats = filterRemainingFormats(currentFormats.get(), matchedFormats, elm, parents);\n      currentFormats.set(__assign(__assign({}, newFormats), remainingFormats));\n    };\n    var filterRemainingFormats = function (currentFormats, matchedFormats, elm, parents) {\n      return bifilter(currentFormats, function (callbacks, format) {\n        if (!has(matchedFormats, format)) {\n          each(callbacks, function (callback) {\n            callback(false, {\n              node: elm,\n              format: format,\n              parents: parents\n            });\n          });\n          return false;\n        } else {\n          return true;\n        }\n      }).t;\n    };\n    var addListeners = function (registeredFormatListeners, formats, callback, similar) {\n      var formatChangeItems = registeredFormatListeners.get();\n      each(formats.split(','), function (format) {\n        if (!formatChangeItems[format]) {\n          formatChangeItems[format] = {\n            similar: similar,\n            callbacks: []\n          };\n        }\n        formatChangeItems[format].callbacks.push(callback);\n      });\n      registeredFormatListeners.set(formatChangeItems);\n    };\n    var removeListeners = function (registeredFormatListeners, formats, callback) {\n      var formatChangeItems = registeredFormatListeners.get();\n      each(formats.split(','), function (format) {\n        formatChangeItems[format].callbacks = filter(formatChangeItems[format].callbacks, function (c) {\n          return c !== callback;\n        });\n        if (formatChangeItems[format].callbacks.length === 0) {\n          delete formatChangeItems[format];\n        }\n      });\n      registeredFormatListeners.set(formatChangeItems);\n    };\n    var formatChanged = function (editor, registeredFormatListeners, formats, callback, similar) {\n      if (registeredFormatListeners.get() === null) {\n        setup$4(registeredFormatListeners, editor);\n      }\n      addListeners(registeredFormatListeners, formats, callback, similar);\n      return {\n        unbind: function () {\n          return removeListeners(registeredFormatListeners, formats, callback);\n        }\n      };\n    };\n\n    var get$9 = function (dom) {\n      var formats = {\n        valigntop: [{\n            selector: 'td,th',\n            styles: { verticalAlign: 'top' }\n          }],\n        valignmiddle: [{\n            selector: 'td,th',\n            styles: { verticalAlign: 'middle' }\n          }],\n        valignbottom: [{\n            selector: 'td,th',\n            styles: { verticalAlign: 'bottom' }\n          }],\n        alignleft: [\n          {\n            selector: 'figure.image',\n            collapsed: false,\n            classes: 'align-left',\n            ceFalseOverride: true,\n            preview: 'font-family font-size'\n          },\n          {\n            selector: 'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',\n            styles: { textAlign: 'left' },\n            inherit: false,\n            preview: false,\n            defaultBlock: 'div'\n          },\n          {\n            selector: 'img,table',\n            collapsed: false,\n            styles: { float: 'left' },\n            preview: 'font-family font-size'\n          }\n        ],\n        aligncenter: [\n          {\n            selector: 'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',\n            styles: { textAlign: 'center' },\n            inherit: false,\n            preview: 'font-family font-size',\n            defaultBlock: 'div'\n          },\n          {\n            selector: 'figure.image',\n            collapsed: false,\n            classes: 'align-center',\n            ceFalseOverride: true,\n            preview: 'font-family font-size'\n          },\n          {\n            selector: 'img',\n            collapsed: false,\n            styles: {\n              display: 'block',\n              marginLeft: 'auto',\n              marginRight: 'auto'\n            },\n            preview: false\n          },\n          {\n            selector: 'table',\n            collapsed: false,\n            styles: {\n              marginLeft: 'auto',\n              marginRight: 'auto'\n            },\n            preview: 'font-family font-size'\n          }\n        ],\n        alignright: [\n          {\n            selector: 'figure.image',\n            collapsed: false,\n            classes: 'align-right',\n            ceFalseOverride: true,\n            preview: 'font-family font-size'\n          },\n          {\n            selector: 'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',\n            styles: { textAlign: 'right' },\n            inherit: false,\n            preview: 'font-family font-size',\n            defaultBlock: 'div'\n          },\n          {\n            selector: 'img,table',\n            collapsed: false,\n            styles: { float: 'right' },\n            preview: 'font-family font-size'\n          }\n        ],\n        alignjustify: [{\n            selector: 'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',\n            styles: { textAlign: 'justify' },\n            inherit: false,\n            defaultBlock: 'div',\n            preview: 'font-family font-size'\n          }],\n        bold: [\n          {\n            inline: 'strong',\n            remove: 'all'\n          },\n          {\n            inline: 'span',\n            styles: { fontWeight: 'bold' }\n          },\n          {\n            inline: 'b',\n            remove: 'all'\n          }\n        ],\n        italic: [\n          {\n            inline: 'em',\n            remove: 'all'\n          },\n          {\n            inline: 'span',\n            styles: { fontStyle: 'italic' }\n          },\n          {\n            inline: 'i',\n            remove: 'all'\n          }\n        ],\n        underline: [\n          {\n            inline: 'span',\n            styles: { textDecoration: 'underline' },\n            exact: true\n          },\n          {\n            inline: 'u',\n            remove: 'all'\n          }\n        ],\n        strikethrough: [\n          {\n            inline: 'span',\n            styles: { textDecoration: 'line-through' },\n            exact: true\n          },\n          {\n            inline: 'strike',\n            remove: 'all'\n          }\n        ],\n        forecolor: {\n          inline: 'span',\n          styles: { color: '%value' },\n          links: true,\n          remove_similar: true,\n          clear_child_styles: true\n        },\n        hilitecolor: {\n          inline: 'span',\n          styles: { backgroundColor: '%value' },\n          links: true,\n          remove_similar: true,\n          clear_child_styles: true\n        },\n        fontname: {\n          inline: 'span',\n          toggle: false,\n          styles: { fontFamily: '%value' },\n          clear_child_styles: true\n        },\n        fontsize: {\n          inline: 'span',\n          toggle: false,\n          styles: { fontSize: '%value' },\n          clear_child_styles: true\n        },\n        fontsize_class: {\n          inline: 'span',\n          attributes: { class: '%value' }\n        },\n        blockquote: {\n          block: 'blockquote',\n          wrapper: true,\n          remove: 'all'\n        },\n        subscript: { inline: 'sub' },\n        superscript: { inline: 'sup' },\n        code: { inline: 'code' },\n        link: {\n          inline: 'a',\n          selector: 'a',\n          remove: 'all',\n          split: true,\n          deep: true,\n          onmatch: function () {\n            return true;\n          },\n          onformat: function (elm, fmt, vars) {\n            Tools.each(vars, function (value, key) {\n              dom.setAttrib(elm, key, value);\n            });\n          }\n        },\n        removeformat: [\n          {\n            selector: 'b,strong,em,i,font,u,strike,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins',\n            remove: 'all',\n            split: true,\n            expand: false,\n            block_expand: true,\n            deep: true\n          },\n          {\n            selector: 'span',\n            attributes: [\n              'style',\n              'class'\n            ],\n            remove: 'empty',\n            split: true,\n            expand: false,\n            deep: true\n          },\n          {\n            selector: '*',\n            attributes: [\n              'style',\n              'class'\n            ],\n            split: false,\n            expand: false,\n            deep: true\n          }\n        ]\n      };\n      Tools.each('p h1 h2 h3 h4 h5 h6 div address pre div dt dd samp'.split(/\\s/), function (name) {\n        formats[name] = {\n          block: name,\n          remove: 'all'\n        };\n      });\n      return formats;\n    };\n    var DefaultFormats = { get: get$9 };\n\n    function FormatRegistry(editor) {\n      var formats = {};\n      var get = function (name) {\n        return name ? formats[name] : formats;\n      };\n      var has$1 = function (name) {\n        return has(formats, name);\n      };\n      var register = function (name, format) {\n        if (name) {\n          if (typeof name !== 'string') {\n            Tools.each(name, function (format, name) {\n              register(name, format);\n            });\n          } else {\n            if (!isArray(format)) {\n              format = [format];\n            }\n            Tools.each(format, function (format) {\n              if (typeof format.deep === 'undefined') {\n                format.deep = !format.selector;\n              }\n              if (typeof format.split === 'undefined') {\n                format.split = !format.selector || format.inline;\n              }\n              if (typeof format.remove === 'undefined' && format.selector && !format.inline) {\n                format.remove = 'none';\n              }\n              if (format.selector && format.inline) {\n                format.mixed = true;\n                format.block_expand = true;\n              }\n              if (typeof format.classes === 'string') {\n                format.classes = format.classes.split(/\\s+/);\n              }\n            });\n            formats[name] = format;\n          }\n        }\n      };\n      var unregister = function (name) {\n        if (name && formats[name]) {\n          delete formats[name];\n        }\n        return formats;\n      };\n      register(DefaultFormats.get(editor.dom));\n      register(editor.settings.formats);\n      return {\n        get: get,\n        has: has$1,\n        register: register,\n        unregister: unregister\n      };\n    }\n\n    var each$e = Tools.each;\n    var dom = DOMUtils$1.DOM;\n    var parsedSelectorToHtml = function (ancestry, editor) {\n      var elm, item, fragment;\n      var schema = editor && editor.schema || Schema({});\n      var decorate = function (elm, item) {\n        if (item.classes.length) {\n          dom.addClass(elm, item.classes.join(' '));\n        }\n        dom.setAttribs(elm, item.attrs);\n      };\n      var createElement = function (sItem) {\n        var elm;\n        item = typeof sItem === 'string' ? {\n          name: sItem,\n          classes: [],\n          attrs: {}\n        } : sItem;\n        elm = dom.create(item.name);\n        decorate(elm, item);\n        return elm;\n      };\n      var getRequiredParent = function (elm, candidate) {\n        var name = typeof elm !== 'string' ? elm.nodeName.toLowerCase() : elm;\n        var elmRule = schema.getElementRule(name);\n        var parentsRequired = elmRule && elmRule.parentsRequired;\n        if (parentsRequired && parentsRequired.length) {\n          return candidate && Tools.inArray(parentsRequired, candidate) !== -1 ? candidate : parentsRequired[0];\n        } else {\n          return false;\n        }\n      };\n      var wrapInHtml = function (elm, ancestry, siblings) {\n        var parent, parentCandidate, parentRequired;\n        var ancestor = ancestry.length > 0 && ancestry[0];\n        var ancestorName = ancestor && ancestor.name;\n        parentRequired = getRequiredParent(elm, ancestorName);\n        if (parentRequired) {\n          if (ancestorName === parentRequired) {\n            parentCandidate = ancestry[0];\n            ancestry = ancestry.slice(1);\n          } else {\n            parentCandidate = parentRequired;\n          }\n        } else if (ancestor) {\n          parentCandidate = ancestry[0];\n          ancestry = ancestry.slice(1);\n        } else if (!siblings) {\n          return elm;\n        }\n        if (parentCandidate) {\n          parent = createElement(parentCandidate);\n          parent.appendChild(elm);\n        }\n        if (siblings) {\n          if (!parent) {\n            parent = dom.create('div');\n            parent.appendChild(elm);\n          }\n          Tools.each(siblings, function (sibling) {\n            var siblingElm = createElement(sibling);\n            parent.insertBefore(siblingElm, elm);\n          });\n        }\n        return wrapInHtml(parent, ancestry, parentCandidate && parentCandidate.siblings);\n      };\n      if (ancestry && ancestry.length) {\n        item = ancestry[0];\n        elm = createElement(item);\n        fragment = dom.create('div');\n        fragment.appendChild(wrapInHtml(elm, ancestry.slice(1), item.siblings));\n        return fragment;\n      } else {\n        return '';\n      }\n    };\n    var parseSelectorItem = function (item) {\n      var tagName;\n      var obj = {\n        classes: [],\n        attrs: {}\n      };\n      item = obj.selector = Tools.trim(item);\n      if (item !== '*') {\n        tagName = item.replace(/(?:([#\\.]|::?)([\\w\\-]+)|(\\[)([^\\]]+)\\]?)/g, function ($0, $1, $2, $3, $4) {\n          switch ($1) {\n          case '#':\n            obj.attrs.id = $2;\n            break;\n          case '.':\n            obj.classes.push($2);\n            break;\n          case ':':\n            if (Tools.inArray('checked disabled enabled read-only required'.split(' '), $2) !== -1) {\n              obj.attrs[$2] = $2;\n            }\n            break;\n          }\n          if ($3 === '[') {\n            var m = $4.match(/([\\w\\-]+)(?:\\=\\\"([^\\\"]+))?/);\n            if (m) {\n              obj.attrs[m[1]] = m[2];\n            }\n          }\n          return '';\n        });\n      }\n      obj.name = tagName || 'div';\n      return obj;\n    };\n    var parseSelector = function (selector) {\n      if (!selector || typeof selector !== 'string') {\n        return [];\n      }\n      selector = selector.split(/\\s*,\\s*/)[0];\n      selector = selector.replace(/\\s*(~\\+|~|\\+|>)\\s*/g, '$1');\n      return Tools.map(selector.split(/(?:>|\\s+(?![^\\[\\]]+\\]))/), function (item) {\n        var siblings = Tools.map(item.split(/(?:~\\+|~|\\+)/), parseSelectorItem);\n        var obj = siblings.pop();\n        if (siblings.length) {\n          obj.siblings = siblings;\n        }\n        return obj;\n      }).reverse();\n    };\n    var getCssText = function (editor, format) {\n      var name, previewFrag, previewElm, items;\n      var previewCss = '', parentFontSize, previewStyles;\n      previewStyles = editor.settings.preview_styles;\n      if (previewStyles === false) {\n        return '';\n      }\n      if (typeof previewStyles !== 'string') {\n        previewStyles = 'font-family font-size font-weight font-style text-decoration ' + 'text-transform color background-color border border-radius outline text-shadow';\n      }\n      var removeVars = function (val) {\n        return val.replace(/%(\\w+)/g, '');\n      };\n      if (typeof format === 'string') {\n        format = editor.formatter.get(format);\n        if (!format) {\n          return;\n        }\n        format = format[0];\n      }\n      if ('preview' in format) {\n        previewStyles = format.preview;\n        if (previewStyles === false) {\n          return '';\n        }\n      }\n      name = format.block || format.inline || 'span';\n      items = parseSelector(format.selector);\n      if (items.length) {\n        if (!items[0].name) {\n          items[0].name = name;\n        }\n        name = format.selector;\n        previewFrag = parsedSelectorToHtml(items, editor);\n      } else {\n        previewFrag = parsedSelectorToHtml([name], editor);\n      }\n      previewElm = dom.select(name, previewFrag)[0] || previewFrag.firstChild;\n      each$e(format.styles, function (value, name) {\n        value = removeVars(value);\n        if (value) {\n          dom.setStyle(previewElm, name, value);\n        }\n      });\n      each$e(format.attributes, function (value, name) {\n        value = removeVars(value);\n        if (value) {\n          dom.setAttrib(previewElm, name, value);\n        }\n      });\n      each$e(format.classes, function (value) {\n        value = removeVars(value);\n        if (!dom.hasClass(previewElm, value)) {\n          dom.addClass(previewElm, value);\n        }\n      });\n      editor.fire('PreviewFormats');\n      dom.setStyles(previewFrag, {\n        position: 'absolute',\n        left: -65535\n      });\n      editor.getBody().appendChild(previewFrag);\n      parentFontSize = dom.getStyle(editor.getBody(), 'fontSize', true);\n      parentFontSize = /px$/.test(parentFontSize) ? parseInt(parentFontSize, 10) : 0;\n      each$e(previewStyles.split(' '), function (name) {\n        var value = dom.getStyle(previewElm, name, true);\n        if (name === 'background-color' && /transparent|rgba\\s*\\([^)]+,\\s*0\\)/.test(value)) {\n          value = dom.getStyle(editor.getBody(), name, true);\n          if (dom.toHex(value).toLowerCase() === '#ffffff') {\n            return;\n          }\n        }\n        if (name === 'color') {\n          if (dom.toHex(value).toLowerCase() === '#000000') {\n            return;\n          }\n        }\n        if (name === 'font-size') {\n          if (/em|%$/.test(value)) {\n            if (parentFontSize === 0) {\n              return;\n            }\n            var numValue = parseFloat(value) / (/%$/.test(value) ? 100 : 1);\n            value = numValue * parentFontSize + 'px';\n          }\n        }\n        if (name === 'border' && value) {\n          previewCss += 'padding:0 2px;';\n        }\n        previewCss += name + ':' + value + ';';\n      });\n      editor.fire('AfterPreviewFormats');\n      dom.remove(previewFrag);\n      return previewCss;\n    };\n\n    var toggle = function (editor, formats, name, vars, node) {\n      var fmt = formats.get(name);\n      if (match(editor, name, vars, node) && (!('toggle' in fmt[0]) || fmt[0].toggle)) {\n        remove$7(editor, name, vars, node);\n      } else {\n        applyFormat(editor, name, vars, node);\n      }\n    };\n\n    var setup$5 = function (editor) {\n      editor.addShortcut('meta+b', '', 'Bold');\n      editor.addShortcut('meta+i', '', 'Italic');\n      editor.addShortcut('meta+u', '', 'Underline');\n      for (var i = 1; i <= 6; i++) {\n        editor.addShortcut('access+' + i, '', [\n          'FormatBlock',\n          false,\n          'h' + i\n        ]);\n      }\n      editor.addShortcut('access+7', '', [\n        'FormatBlock',\n        false,\n        'p'\n      ]);\n      editor.addShortcut('access+8', '', [\n        'FormatBlock',\n        false,\n        'div'\n      ]);\n      editor.addShortcut('access+9', '', [\n        'FormatBlock',\n        false,\n        'address'\n      ]);\n    };\n    var FormatShortcuts = { setup: setup$5 };\n\n    var Formatter = function (editor) {\n      var formats = FormatRegistry(editor);\n      var formatChangeState = Cell(null);\n      FormatShortcuts.setup(editor);\n      setup$3(editor);\n      return {\n        get: formats.get,\n        has: formats.has,\n        register: formats.register,\n        unregister: formats.unregister,\n        apply: curry(applyFormat, editor),\n        remove: curry(remove$7, editor),\n        toggle: curry(toggle, editor, formats),\n        match: curry(match, editor),\n        matchAll: curry(matchAll, editor),\n        matchNode: curry(matchNode, editor),\n        canApply: curry(canApply, editor),\n        formatChanged: curry(formatChanged, editor, formatChangeState),\n        getCssText: curry(getCssText, editor)\n      };\n    };\n\n    var KEEP = 0, INSERT = 1, DELETE = 2;\n    var diff = function (left, right) {\n      var size = left.length + right.length + 2;\n      var vDown = new Array(size);\n      var vUp = new Array(size);\n      var snake = function (start, end, diag) {\n        return {\n          start: start,\n          end: end,\n          diag: diag\n        };\n      };\n      var buildScript = function (start1, end1, start2, end2, script) {\n        var middle = getMiddleSnake(start1, end1, start2, end2);\n        if (middle === null || middle.start === end1 && middle.diag === end1 - end2 || middle.end === start1 && middle.diag === start1 - start2) {\n          var i = start1;\n          var j = start2;\n          while (i < end1 || j < end2) {\n            if (i < end1 && j < end2 && left[i] === right[j]) {\n              script.push([\n                KEEP,\n                left[i]\n              ]);\n              ++i;\n              ++j;\n            } else {\n              if (end1 - start1 > end2 - start2) {\n                script.push([\n                  DELETE,\n                  left[i]\n                ]);\n                ++i;\n              } else {\n                script.push([\n                  INSERT,\n                  right[j]\n                ]);\n                ++j;\n              }\n            }\n          }\n        } else {\n          buildScript(start1, middle.start, start2, middle.start - middle.diag, script);\n          for (var i2 = middle.start; i2 < middle.end; ++i2) {\n            script.push([\n              KEEP,\n              left[i2]\n            ]);\n          }\n          buildScript(middle.end, end1, middle.end - middle.diag, end2, script);\n        }\n      };\n      var buildSnake = function (start, diag, end1, end2) {\n        var end = start;\n        while (end - diag < end2 && end < end1 && left[end] === right[end - diag]) {\n          ++end;\n        }\n        return snake(start, end, diag);\n      };\n      var getMiddleSnake = function (start1, end1, start2, end2) {\n        var m = end1 - start1;\n        var n = end2 - start2;\n        if (m === 0 || n === 0) {\n          return null;\n        }\n        var delta = m - n;\n        var sum = n + m;\n        var offset = (sum % 2 === 0 ? sum : sum + 1) / 2;\n        vDown[1 + offset] = start1;\n        vUp[1 + offset] = end1 + 1;\n        var d, k, i, x, y;\n        for (d = 0; d <= offset; ++d) {\n          for (k = -d; k <= d; k += 2) {\n            i = k + offset;\n            if (k === -d || k !== d && vDown[i - 1] < vDown[i + 1]) {\n              vDown[i] = vDown[i + 1];\n            } else {\n              vDown[i] = vDown[i - 1] + 1;\n            }\n            x = vDown[i];\n            y = x - start1 + start2 - k;\n            while (x < end1 && y < end2 && left[x] === right[y]) {\n              vDown[i] = ++x;\n              ++y;\n            }\n            if (delta % 2 !== 0 && delta - d <= k && k <= delta + d) {\n              if (vUp[i - delta] <= vDown[i]) {\n                return buildSnake(vUp[i - delta], k + start1 - start2, end1, end2);\n              }\n            }\n          }\n          for (k = delta - d; k <= delta + d; k += 2) {\n            i = k + offset - delta;\n            if (k === delta - d || k !== delta + d && vUp[i + 1] <= vUp[i - 1]) {\n              vUp[i] = vUp[i + 1] - 1;\n            } else {\n              vUp[i] = vUp[i - 1];\n            }\n            x = vUp[i] - 1;\n            y = x - start1 + start2 - k;\n            while (x >= start1 && y >= start2 && left[x] === right[y]) {\n              vUp[i] = x--;\n              y--;\n            }\n            if (delta % 2 === 0 && -d <= k && k <= d) {\n              if (vUp[i] <= vDown[i + delta]) {\n                return buildSnake(vUp[i], k + start1 - start2, end1, end2);\n              }\n            }\n          }\n        }\n      };\n      var script = [];\n      buildScript(0, left.length, 0, right.length, script);\n      return script;\n    };\n    var Diff = {\n      KEEP: KEEP,\n      DELETE: DELETE,\n      INSERT: INSERT,\n      diff: diff\n    };\n\n    var getOuterHtml = function (elm) {\n      if (NodeType.isElement(elm)) {\n        return elm.outerHTML;\n      } else if (NodeType.isText(elm)) {\n        return Entities.encodeRaw(elm.data, false);\n      } else if (NodeType.isComment(elm)) {\n        return '<!--' + elm.data + '-->';\n      }\n      return '';\n    };\n    var createFragment$1 = function (html) {\n      var frag, node, container;\n      container = domGlobals.document.createElement('div');\n      frag = domGlobals.document.createDocumentFragment();\n      if (html) {\n        container.innerHTML = html;\n      }\n      while (node = container.firstChild) {\n        frag.appendChild(node);\n      }\n      return frag;\n    };\n    var insertAt = function (elm, html, index) {\n      var fragment = createFragment$1(html);\n      if (elm.hasChildNodes() && index < elm.childNodes.length) {\n        var target = elm.childNodes[index];\n        target.parentNode.insertBefore(fragment, target);\n      } else {\n        elm.appendChild(fragment);\n      }\n    };\n    var removeAt = function (elm, index) {\n      if (elm.hasChildNodes() && index < elm.childNodes.length) {\n        var target = elm.childNodes[index];\n        target.parentNode.removeChild(target);\n      }\n    };\n    var applyDiff = function (diff, elm) {\n      var index = 0;\n      each(diff, function (action) {\n        if (action[0] === Diff.KEEP) {\n          index++;\n        } else if (action[0] === Diff.INSERT) {\n          insertAt(elm, action[1], index);\n          index++;\n        } else if (action[0] === Diff.DELETE) {\n          removeAt(elm, index);\n        }\n      });\n    };\n    var read$2 = function (elm) {\n      return filter(map(from$1(elm.childNodes), getOuterHtml), function (item) {\n        return item.length > 0;\n      });\n    };\n    var write = function (fragments, elm) {\n      var currentFragments = map(from$1(elm.childNodes), getOuterHtml);\n      applyDiff(Diff.diff(currentFragments, fragments), elm);\n      return elm;\n    };\n    var Fragments = {\n      read: read$2,\n      write: write\n    };\n\n    var undoLevelDocument = Cell(Option.none());\n    var lazyTempDocument = function () {\n      return undoLevelDocument.get().getOrThunk(function () {\n        var doc = domGlobals.document.implementation.createHTMLDocument('undo');\n        undoLevelDocument.set(Option.some(doc));\n        return doc;\n      });\n    };\n    var hasIframes = function (html) {\n      return html.indexOf('</iframe>') !== -1;\n    };\n    var createFragmentedLevel = function (fragments) {\n      return {\n        type: 'fragmented',\n        fragments: fragments,\n        content: '',\n        bookmark: null,\n        beforeBookmark: null\n      };\n    };\n    var createCompleteLevel = function (content) {\n      return {\n        type: 'complete',\n        fragments: null,\n        content: content,\n        bookmark: null,\n        beforeBookmark: null\n      };\n    };\n    var createFromEditor = function (editor) {\n      var fragments, content, trimmedFragments;\n      fragments = Fragments.read(editor.getBody());\n      trimmedFragments = bind(fragments, function (html) {\n        var trimmed = TrimHtml.trimInternal(editor.serializer, html);\n        return trimmed.length > 0 ? [trimmed] : [];\n      });\n      content = trimmedFragments.join('');\n      return hasIframes(content) ? createFragmentedLevel(trimmedFragments) : createCompleteLevel(content);\n    };\n    var applyToEditor = function (editor, level, before) {\n      if (level.type === 'fragmented') {\n        Fragments.write(level.fragments, editor.getBody());\n      } else {\n        editor.setContent(level.content, { format: 'raw' });\n      }\n      editor.selection.moveToBookmark(before ? level.beforeBookmark : level.bookmark);\n    };\n    var getLevelContent = function (level) {\n      return level.type === 'fragmented' ? level.fragments.join('') : level.content;\n    };\n    var getCleanLevelContent = function (level) {\n      var elm = Element.fromTag('body', lazyTempDocument());\n      set$1(elm, getLevelContent(level));\n      each(descendants$1(elm, '*[data-mce-bogus]'), unwrap);\n      return get$6(elm);\n    };\n    var hasEqualContent = function (level1, level2) {\n      return getLevelContent(level1) === getLevelContent(level2);\n    };\n    var hasEqualCleanedContent = function (level1, level2) {\n      return getCleanLevelContent(level1) === getCleanLevelContent(level2);\n    };\n    var isEq$4 = function (level1, level2) {\n      if (!level1 || !level2) {\n        return false;\n      } else if (hasEqualContent(level1, level2)) {\n        return true;\n      } else {\n        return hasEqualCleanedContent(level1, level2);\n      }\n    };\n    var Levels = {\n      createFragmentedLevel: createFragmentedLevel,\n      createCompleteLevel: createCompleteLevel,\n      createFromEditor: createFromEditor,\n      applyToEditor: applyToEditor,\n      isEq: isEq$4\n    };\n\n    var isUnlocked = function (locks) {\n      return locks.get() === 0;\n    };\n\n    var setTyping = function (undoManager, typing, locks) {\n      if (isUnlocked(locks)) {\n        undoManager.typing = typing;\n      }\n    };\n    var endTyping = function (undoManager, locks) {\n      if (undoManager.typing) {\n        setTyping(undoManager, false, locks);\n        undoManager.add();\n      }\n    };\n    var endTypingLevelIgnoreLocks = function (undoManager) {\n      if (undoManager.typing) {\n        undoManager.typing = false;\n        undoManager.add();\n      }\n    };\n\n    var beforeChange = function (editor, locks, beforeBookmark) {\n      if (isUnlocked(locks)) {\n        beforeBookmark.set(Option.some(GetBookmark.getUndoBookmark(editor.selection)));\n      }\n    };\n    var addUndoLevel = function (editor, undoManager, index, locks, beforeBookmark, level, event) {\n      var settings = editor.settings;\n      var currentLevel = Levels.createFromEditor(editor);\n      level = level || {};\n      level = Tools.extend(level, currentLevel);\n      if (isUnlocked(locks) === false || editor.removed) {\n        return null;\n      }\n      var lastLevel = undoManager.data[index.get()];\n      if (editor.fire('BeforeAddUndo', {\n          level: level,\n          lastLevel: lastLevel,\n          originalEvent: event\n        }).isDefaultPrevented()) {\n        return null;\n      }\n      if (lastLevel && Levels.isEq(lastLevel, level)) {\n        return null;\n      }\n      if (undoManager.data[index.get()]) {\n        beforeBookmark.get().each(function (bm) {\n          undoManager.data[index.get()].beforeBookmark = bm;\n        });\n      }\n      if (settings.custom_undo_redo_levels) {\n        if (undoManager.data.length > settings.custom_undo_redo_levels) {\n          for (var i = 0; i < undoManager.data.length - 1; i++) {\n            undoManager.data[i] = undoManager.data[i + 1];\n          }\n          undoManager.data.length--;\n          index.set(undoManager.data.length);\n        }\n      }\n      level.bookmark = GetBookmark.getUndoBookmark(editor.selection);\n      if (index.get() < undoManager.data.length - 1) {\n        undoManager.data.length = index.get() + 1;\n      }\n      undoManager.data.push(level);\n      index.set(undoManager.data.length - 1);\n      var args = {\n        level: level,\n        lastLevel: lastLevel,\n        originalEvent: event\n      };\n      editor.fire('AddUndo', args);\n      if (index.get() > 0) {\n        editor.setDirty(true);\n        editor.fire('change', args);\n      }\n      return level;\n    };\n    var clear = function (editor, undoManager, index) {\n      undoManager.data = [];\n      index.set(0);\n      undoManager.typing = false;\n      editor.fire('ClearUndos');\n    };\n    var extra = function (editor, undoManager, index, callback1, callback2) {\n      if (undoManager.transact(callback1)) {\n        var bookmark = undoManager.data[index.get()].bookmark;\n        var lastLevel = undoManager.data[index.get() - 1];\n        Levels.applyToEditor(editor, lastLevel, true);\n        if (undoManager.transact(callback2)) {\n          undoManager.data[index.get() - 1].beforeBookmark = bookmark;\n        }\n      }\n    };\n    var redo = function (editor, index, data) {\n      var level;\n      if (index.get() < data.length - 1) {\n        index.set(index.get() + 1);\n        level = data[index.get()];\n        Levels.applyToEditor(editor, level, false);\n        editor.setDirty(true);\n        editor.fire('Redo', { level: level });\n      }\n      return level;\n    };\n    var undo = function (editor, undoManager, locks, index) {\n      var level;\n      if (undoManager.typing) {\n        undoManager.add();\n        undoManager.typing = false;\n        setTyping(undoManager, false, locks);\n      }\n      if (index.get() > 0) {\n        index.set(index.get() - 1);\n        level = undoManager.data[index.get()];\n        Levels.applyToEditor(editor, level, true);\n        editor.setDirty(true);\n        editor.fire('Undo', { level: level });\n      }\n      return level;\n    };\n    var reset = function (undoManager) {\n      undoManager.clear();\n      undoManager.add();\n    };\n    var hasUndo = function (editor, undoManager, index) {\n      return index.get() > 0 || undoManager.typing && undoManager.data[0] && !Levels.isEq(Levels.createFromEditor(editor), undoManager.data[0]);\n    };\n    var hasRedo = function (undoManager, index) {\n      return index.get() < undoManager.data.length - 1 && !undoManager.typing;\n    };\n    var transact = function (undoManager, locks, callback) {\n      endTyping(undoManager, locks);\n      undoManager.beforeChange();\n      undoManager.ignore(callback);\n      return undoManager.add();\n    };\n    var ignore = function (locks, callback) {\n      try {\n        locks.set(locks.get() + 1);\n        callback();\n      } finally {\n        locks.set(locks.get() - 1);\n      }\n    };\n\n    var registerEvents$1 = function (editor, undoManager, locks) {\n      var isFirstTypedCharacter = Cell(false);\n      var addNonTypingUndoLevel = function (e) {\n        setTyping(undoManager, false, locks);\n        undoManager.add({}, e);\n      };\n      editor.on('init', function () {\n        undoManager.add();\n      });\n      editor.on('BeforeExecCommand', function (e) {\n        var cmd = e.command;\n        if (cmd !== 'Undo' && cmd !== 'Redo' && cmd !== 'mceRepaint') {\n          endTyping(undoManager, locks);\n          undoManager.beforeChange();\n        }\n      });\n      editor.on('ExecCommand', function (e) {\n        var cmd = e.command;\n        if (cmd !== 'Undo' && cmd !== 'Redo' && cmd !== 'mceRepaint') {\n          addNonTypingUndoLevel(e);\n        }\n      });\n      editor.on('ObjectResizeStart cut', function () {\n        undoManager.beforeChange();\n      });\n      editor.on('SaveContent ObjectResized blur', addNonTypingUndoLevel);\n      editor.on('dragend', addNonTypingUndoLevel);\n      editor.on('keyup', function (e) {\n        var keyCode = e.keyCode;\n        if (e.isDefaultPrevented()) {\n          return;\n        }\n        if (keyCode >= 33 && keyCode <= 36 || keyCode >= 37 && keyCode <= 40 || keyCode === 45 || e.ctrlKey) {\n          addNonTypingUndoLevel();\n          editor.nodeChanged();\n        }\n        if (keyCode === 46 || keyCode === 8) {\n          editor.nodeChanged();\n        }\n        if (isFirstTypedCharacter.get() && undoManager.typing && Levels.isEq(Levels.createFromEditor(editor), undoManager.data[0]) === false) {\n          if (editor.isDirty() === false) {\n            editor.setDirty(true);\n            editor.fire('change', {\n              level: undoManager.data[0],\n              lastLevel: null\n            });\n          }\n          editor.fire('TypingUndo');\n          isFirstTypedCharacter.set(false);\n          editor.nodeChanged();\n        }\n      });\n      editor.on('keydown', function (e) {\n        var keyCode = e.keyCode;\n        if (e.isDefaultPrevented()) {\n          return;\n        }\n        if (keyCode >= 33 && keyCode <= 36 || keyCode >= 37 && keyCode <= 40 || keyCode === 45) {\n          if (undoManager.typing) {\n            addNonTypingUndoLevel(e);\n          }\n          return;\n        }\n        var modKey = e.ctrlKey && !e.altKey || e.metaKey;\n        if ((keyCode < 16 || keyCode > 20) && keyCode !== 224 && keyCode !== 91 && !undoManager.typing && !modKey) {\n          undoManager.beforeChange();\n          setTyping(undoManager, true, locks);\n          undoManager.add({}, e);\n          isFirstTypedCharacter.set(true);\n        }\n      });\n      editor.on('mousedown', function (e) {\n        if (undoManager.typing) {\n          addNonTypingUndoLevel(e);\n        }\n      });\n      var isInsertReplacementText = function (event) {\n        return event.inputType === 'insertReplacementText';\n      };\n      var isInsertTextDataNull = function (event) {\n        return event.inputType === 'insertText' && event.data === null;\n      };\n      editor.on('input', function (e) {\n        if (e.inputType && (isInsertReplacementText(e) || isInsertTextDataNull(e))) {\n          addNonTypingUndoLevel(e);\n        }\n      });\n      editor.on('AddUndo Undo Redo ClearUndos', function (e) {\n        if (!e.isDefaultPrevented()) {\n          editor.nodeChanged();\n        }\n      });\n    };\n    var addKeyboardShortcuts = function (editor) {\n      editor.addShortcut('meta+z', '', 'Undo');\n      editor.addShortcut('meta+y,meta+shift+z', '', 'Redo');\n    };\n\n    var UndoManager = function (editor) {\n      var beforeBookmark = Cell(Option.none());\n      var locks = Cell(0);\n      var index = Cell(0);\n      var undoManager = {\n        data: [],\n        typing: false,\n        beforeChange: function () {\n          beforeChange(editor, locks, beforeBookmark);\n        },\n        add: function (level, event) {\n          return addUndoLevel(editor, undoManager, index, locks, beforeBookmark, level, event);\n        },\n        undo: function () {\n          return undo(editor, undoManager, locks, index);\n        },\n        redo: function () {\n          return redo(editor, index, undoManager.data);\n        },\n        clear: function () {\n          clear(editor, undoManager, index);\n        },\n        reset: function () {\n          reset(undoManager);\n        },\n        hasUndo: function () {\n          return hasUndo(editor, undoManager, index);\n        },\n        hasRedo: function () {\n          return hasRedo(undoManager, index);\n        },\n        transact: function (callback) {\n          return transact(undoManager, locks, callback);\n        },\n        ignore: function (callback) {\n          ignore(locks, callback);\n        },\n        extra: function (callback1, callback2) {\n          extra(editor, undoManager, index, callback1, callback2);\n        }\n      };\n      registerEvents$1(editor, undoManager, locks);\n      addKeyboardShortcuts(editor);\n      return undoManager;\n    };\n\n    var nonTypingKeycodes = [\n      9,\n      27,\n      VK.HOME,\n      VK.END,\n      19,\n      20,\n      44,\n      144,\n      145,\n      33,\n      34,\n      45,\n      16,\n      17,\n      18,\n      91,\n      92,\n      93,\n      VK.DOWN,\n      VK.UP,\n      VK.LEFT,\n      VK.RIGHT\n    ].concat(Env.browser.isFirefox() ? [224] : []);\n    var placeholderAttr = 'data-mce-placeholder';\n    var isKeyboardEvent = function (e) {\n      return e.type === 'keydown' || e.type === 'keyup';\n    };\n    var isDeleteEvent = function (e) {\n      var keyCode = e.keyCode;\n      return keyCode === VK.BACKSPACE || keyCode === VK.DELETE;\n    };\n    var isNonTypingKeyboardEvent = function (e) {\n      if (isKeyboardEvent(e)) {\n        var keyCode = e.keyCode;\n        return !isDeleteEvent(e) && (VK.metaKeyPressed(e) || e.altKey || keyCode >= 112 && keyCode <= 123 || contains(nonTypingKeycodes, keyCode));\n      } else {\n        return false;\n      }\n    };\n    var isTypingKeyboardEvent = function (e) {\n      return isKeyboardEvent(e) && !(isDeleteEvent(e) || e.type === 'keyup' && e.keyCode === 229);\n    };\n    var isVisuallyEmpty = function (dom, rootElm, forcedRootBlock) {\n      if (Empty.isEmpty(Element.fromDom(rootElm), false)) {\n        var isForcedRootBlockFalse = forcedRootBlock === '';\n        var firstElement = rootElm.firstElementChild;\n        if (!firstElement) {\n          return true;\n        } else if (dom.getStyle(rootElm.firstElementChild, 'padding-left') || dom.getStyle(rootElm.firstElementChild, 'padding-right')) {\n          return false;\n        } else {\n          return isForcedRootBlockFalse ? !dom.isBlock(firstElement) : forcedRootBlock === firstElement.nodeName.toLowerCase();\n        }\n      } else {\n        return false;\n      }\n    };\n    var setup$6 = function (editor) {\n      var dom = editor.dom;\n      var rootBlock = Settings.getForcedRootBlock(editor);\n      var placeholder = Settings.getPlaceholder(editor);\n      var updatePlaceholder = function (e, initial) {\n        if (isNonTypingKeyboardEvent(e)) {\n          return;\n        }\n        var body = editor.getBody();\n        var showPlaceholder = isTypingKeyboardEvent(e) ? false : isVisuallyEmpty(dom, body, rootBlock);\n        var isPlaceholderShown = dom.getAttrib(body, placeholderAttr) !== '';\n        if (isPlaceholderShown !== showPlaceholder || initial) {\n          dom.setAttrib(body, placeholderAttr, showPlaceholder ? placeholder : null);\n          dom.setAttrib(body, 'aria-placeholder', showPlaceholder ? placeholder : null);\n          firePlaceholderToggle(editor, showPlaceholder);\n          editor.on(showPlaceholder ? 'keydown' : 'keyup', updatePlaceholder);\n          editor.off(showPlaceholder ? 'keyup' : 'keydown', updatePlaceholder);\n        }\n      };\n      if (placeholder) {\n        editor.on('init', function (e) {\n          updatePlaceholder(e, true);\n          editor.on('change SetContent ExecCommand', updatePlaceholder);\n          editor.on('remove', function () {\n            var body = editor.getBody();\n            dom.setAttrib(body, placeholderAttr, null);\n            dom.setAttrib(body, 'aria-placeholder', null);\n          });\n        });\n      }\n    };\n\n    var SIGNIFICANT_MOVE = 5;\n    var LONGPRESS_DELAY = 400;\n    var getTouch = function (event) {\n      if (event.touches === undefined || event.touches.length !== 1) {\n        return Option.none();\n      }\n      return Option.some(event.touches[0]);\n    };\n    var isFarEnough = function (touch, data) {\n      var distX = Math.abs(touch.clientX - data.x());\n      var distY = Math.abs(touch.clientY - data.y());\n      return distX > SIGNIFICANT_MOVE || distY > SIGNIFICANT_MOVE;\n    };\n    var setup$7 = function (editor) {\n      var startData = Cell(Option.none());\n      var longpressFired = Cell(false);\n      var debounceLongpress = last$2(function (e) {\n        editor.fire('longpress', __assign(__assign({}, e), { type: 'longpress' }));\n        longpressFired.set(true);\n      }, LONGPRESS_DELAY);\n      editor.on('touchstart', function (e) {\n        getTouch(e).each(function (touch) {\n          debounceLongpress.cancel();\n          var data = {\n            x: constant(touch.clientX),\n            y: constant(touch.clientY),\n            target: constant(e.target)\n          };\n          debounceLongpress.throttle(e);\n          longpressFired.set(false);\n          startData.set(Option.some(data));\n        });\n      }, true);\n      editor.on('touchmove', function (e) {\n        debounceLongpress.cancel();\n        getTouch(e).each(function (touch) {\n          startData.get().each(function (data) {\n            if (isFarEnough(touch, data)) {\n              startData.set(Option.none());\n              longpressFired.set(false);\n              editor.fire('longpresscancel');\n            }\n          });\n        });\n      }, true);\n      editor.on('touchend touchcancel', function (e) {\n        debounceLongpress.cancel();\n        if (e.type === 'touchcancel') {\n          return;\n        }\n        startData.get().filter(function (data) {\n          return data.target().isEqualNode(e.target);\n        }).each(function () {\n          if (longpressFired.get()) {\n            e.preventDefault();\n          } else {\n            editor.fire('tap', __assign(__assign({}, e), { type: 'tap' }));\n          }\n        });\n      }, true);\n    };\n    var TouchEvents = { setup: setup$7 };\n\n    var isBlockElement = function (blockElements, node) {\n      return blockElements.hasOwnProperty(node.nodeName);\n    };\n    var isValidTarget = function (blockElements, node) {\n      if (NodeType.isText(node)) {\n        return true;\n      } else if (NodeType.isElement(node)) {\n        return !isBlockElement(blockElements, node) && !Bookmarks.isBookmarkNode(node);\n      } else {\n        return false;\n      }\n    };\n    var hasBlockParent = function (blockElements, root, node) {\n      return exists(Parents.parents(Element.fromDom(node), Element.fromDom(root)), function (elm) {\n        return isBlockElement(blockElements, elm.dom());\n      });\n    };\n    var shouldRemoveTextNode = function (blockElements, node) {\n      if (NodeType.isText(node)) {\n        if (node.nodeValue.length === 0) {\n          return true;\n        } else if (/^\\s+$/.test(node.nodeValue) && (!node.nextSibling || isBlockElement(blockElements, node.nextSibling))) {\n          return true;\n        }\n      }\n      return false;\n    };\n    var addRootBlocks = function (editor) {\n      var dom = editor.dom, selection = editor.selection;\n      var schema = editor.schema, blockElements = schema.getBlockElements();\n      var node = selection.getStart();\n      var rootNode = editor.getBody();\n      var rng;\n      var startContainer, startOffset, endContainer, endOffset, rootBlockNode;\n      var tempNode, wrapped, restoreSelection;\n      var rootNodeName;\n      var forcedRootBlock = Settings.getForcedRootBlock(editor);\n      if (!node || !NodeType.isElement(node) || !forcedRootBlock) {\n        return;\n      }\n      rootNodeName = rootNode.nodeName.toLowerCase();\n      if (!schema.isValidChild(rootNodeName, forcedRootBlock.toLowerCase()) || hasBlockParent(blockElements, rootNode, node)) {\n        return;\n      }\n      rng = selection.getRng();\n      startContainer = rng.startContainer;\n      startOffset = rng.startOffset;\n      endContainer = rng.endContainer;\n      endOffset = rng.endOffset;\n      restoreSelection = EditorFocus.hasFocus(editor);\n      node = rootNode.firstChild;\n      while (node) {\n        if (isValidTarget(blockElements, node)) {\n          if (shouldRemoveTextNode(blockElements, node)) {\n            tempNode = node;\n            node = node.nextSibling;\n            dom.remove(tempNode);\n            continue;\n          }\n          if (!rootBlockNode) {\n            rootBlockNode = dom.create(forcedRootBlock, Settings.getForcedRootBlockAttrs(editor));\n            node.parentNode.insertBefore(rootBlockNode, node);\n            wrapped = true;\n          }\n          tempNode = node;\n          node = node.nextSibling;\n          rootBlockNode.appendChild(tempNode);\n        } else {\n          rootBlockNode = null;\n          node = node.nextSibling;\n        }\n      }\n      if (wrapped && restoreSelection) {\n        rng.setStart(startContainer, startOffset);\n        rng.setEnd(endContainer, endOffset);\n        selection.setRng(rng);\n        editor.nodeChanged();\n      }\n    };\n    var setup$8 = function (editor) {\n      if (Settings.getForcedRootBlock(editor)) {\n        editor.on('NodeChange', curry(addRootBlocks, editor));\n      }\n    };\n    var ForceBlocks = { setup: setup$8 };\n\n    var isText$8 = NodeType.isText;\n    var startsWithCaretContainer$1 = function (node) {\n      return isText$8(node) && node.data[0] === Zwsp.ZWSP;\n    };\n    var endsWithCaretContainer$1 = function (node) {\n      return isText$8(node) && node.data[node.data.length - 1] === Zwsp.ZWSP;\n    };\n    var createZwsp = function (node) {\n      return node.ownerDocument.createTextNode(Zwsp.ZWSP);\n    };\n    var insertBefore = function (node) {\n      if (isText$8(node.previousSibling)) {\n        if (endsWithCaretContainer$1(node.previousSibling)) {\n          return node.previousSibling;\n        } else {\n          node.previousSibling.appendData(Zwsp.ZWSP);\n          return node.previousSibling;\n        }\n      } else if (isText$8(node)) {\n        if (startsWithCaretContainer$1(node)) {\n          return node;\n        } else {\n          node.insertData(0, Zwsp.ZWSP);\n          return node;\n        }\n      } else {\n        var newNode = createZwsp(node);\n        node.parentNode.insertBefore(newNode, node);\n        return newNode;\n      }\n    };\n    var insertAfter = function (node) {\n      if (isText$8(node.nextSibling)) {\n        if (startsWithCaretContainer$1(node.nextSibling)) {\n          return node.nextSibling;\n        } else {\n          node.nextSibling.insertData(0, Zwsp.ZWSP);\n          return node.nextSibling;\n        }\n      } else if (isText$8(node)) {\n        if (endsWithCaretContainer$1(node)) {\n          return node;\n        } else {\n          node.appendData(Zwsp.ZWSP);\n          return node;\n        }\n      } else {\n        var newNode = createZwsp(node);\n        if (node.nextSibling) {\n          node.parentNode.insertBefore(newNode, node.nextSibling);\n        } else {\n          node.parentNode.appendChild(newNode);\n        }\n        return newNode;\n      }\n    };\n    var insertInline$1 = function (before, node) {\n      return before ? insertBefore(node) : insertAfter(node);\n    };\n    var insertInlineBefore = curry(insertInline$1, true);\n    var insertInlineAfter = curry(insertInline$1, false);\n\n    var insertInlinePos = function (pos, before) {\n      if (NodeType.isText(pos.container())) {\n        return insertInline$1(before, pos.container());\n      } else {\n        return insertInline$1(before, pos.getNode());\n      }\n    };\n    var isPosCaretContainer = function (pos, caret) {\n      var caretNode = caret.get();\n      return caretNode && pos.container() === caretNode && isCaretContainerInline(caretNode);\n    };\n    var renderCaret = function (caret, location) {\n      return location.fold(function (element) {\n        CaretContainerRemove.remove(caret.get());\n        var text = insertInlineBefore(element);\n        caret.set(text);\n        return Option.some(CaretPosition$1(text, text.length - 1));\n      }, function (element) {\n        return CaretFinder.firstPositionIn(element).map(function (pos) {\n          if (!isPosCaretContainer(pos, caret)) {\n            CaretContainerRemove.remove(caret.get());\n            var text = insertInlinePos(pos, true);\n            caret.set(text);\n            return CaretPosition$1(text, 1);\n          } else {\n            return CaretPosition$1(caret.get(), 1);\n          }\n        });\n      }, function (element) {\n        return CaretFinder.lastPositionIn(element).map(function (pos) {\n          if (!isPosCaretContainer(pos, caret)) {\n            CaretContainerRemove.remove(caret.get());\n            var text = insertInlinePos(pos, false);\n            caret.set(text);\n            return CaretPosition$1(text, text.length - 1);\n          } else {\n            return CaretPosition$1(caret.get(), caret.get().length - 1);\n          }\n        });\n      }, function (element) {\n        CaretContainerRemove.remove(caret.get());\n        var text = insertInlineAfter(element);\n        caret.set(text);\n        return Option.some(CaretPosition$1(text, 1));\n      });\n    };\n    var BoundaryCaret = { renderCaret: renderCaret };\n\n    var strongRtl = /[\\u0591-\\u07FF\\uFB1D-\\uFDFF\\uFE70-\\uFEFC]/;\n    var hasStrongRtl = function (text) {\n      return strongRtl.test(text);\n    };\n\n    var isInlineTarget = function (editor, elm) {\n      return is(Element.fromDom(elm), Settings.getInlineBoundarySelector(editor));\n    };\n    var isRtl$1 = function (element) {\n      return DOMUtils$1.DOM.getStyle(element, 'direction', true) === 'rtl' || hasStrongRtl(element.textContent);\n    };\n    var findInlineParents = function (isInlineTarget, rootNode, pos) {\n      return filter(DOMUtils$1.DOM.getParents(pos.container(), '*', rootNode), isInlineTarget);\n    };\n    var findRootInline = function (isInlineTarget, rootNode, pos) {\n      var parents = findInlineParents(isInlineTarget, rootNode, pos);\n      return Option.from(parents[parents.length - 1]);\n    };\n    var hasSameParentBlock = function (rootNode, node1, node2) {\n      var block1 = getParentBlock(node1, rootNode);\n      var block2 = getParentBlock(node2, rootNode);\n      return block1 && block1 === block2;\n    };\n    var isAtZwsp = function (pos) {\n      return isBeforeInline(pos) || isAfterInline(pos);\n    };\n    var normalizePosition = function (forward, pos) {\n      if (!pos) {\n        return pos;\n      }\n      var container = pos.container(), offset = pos.offset();\n      if (forward) {\n        if (isCaretContainerInline(container)) {\n          if (NodeType.isText(container.nextSibling)) {\n            return CaretPosition$1(container.nextSibling, 0);\n          } else {\n            return CaretPosition$1.after(container);\n          }\n        } else {\n          return isBeforeInline(pos) ? CaretPosition$1(container, offset + 1) : pos;\n        }\n      } else {\n        if (isCaretContainerInline(container)) {\n          if (NodeType.isText(container.previousSibling)) {\n            return CaretPosition$1(container.previousSibling, container.previousSibling.data.length);\n          } else {\n            return CaretPosition$1.before(container);\n          }\n        } else {\n          return isAfterInline(pos) ? CaretPosition$1(container, offset - 1) : pos;\n        }\n      }\n    };\n    var normalizeForwards = curry(normalizePosition, true);\n    var normalizeBackwards = curry(normalizePosition, false);\n    var InlineUtils = {\n      isInlineTarget: isInlineTarget,\n      findRootInline: findRootInline,\n      isRtl: isRtl$1,\n      isAtZwsp: isAtZwsp,\n      normalizePosition: normalizePosition,\n      normalizeForwards: normalizeForwards,\n      normalizeBackwards: normalizeBackwards,\n      hasSameParentBlock: hasSameParentBlock\n    };\n\n    var evaluateUntil = function (fns, args) {\n      for (var i = 0; i < fns.length; i++) {\n        var result = fns[i].apply(null, args);\n        if (result.isSome()) {\n          return result;\n        }\n      }\n      return Option.none();\n    };\n    var LazyEvaluator = { evaluateUntil: evaluateUntil };\n\n    var Location = Adt.generate([\n      { before: ['element'] },\n      { start: ['element'] },\n      { end: ['element'] },\n      { after: ['element'] }\n    ]);\n    var rescope = function (rootNode, node) {\n      var parentBlock = getParentBlock(node, rootNode);\n      return parentBlock ? parentBlock : rootNode;\n    };\n    var before$4 = function (isInlineTarget, rootNode, pos) {\n      var nPos = InlineUtils.normalizeForwards(pos);\n      var scope = rescope(rootNode, nPos.container());\n      return InlineUtils.findRootInline(isInlineTarget, scope, nPos).fold(function () {\n        return CaretFinder.nextPosition(scope, nPos).bind(curry(InlineUtils.findRootInline, isInlineTarget, scope)).map(function (inline) {\n          return Location.before(inline);\n        });\n      }, Option.none);\n    };\n    var isNotInsideFormatCaretContainer = function (rootNode, elm) {\n      return getParentCaretContainer(rootNode, elm) === null;\n    };\n    var findInsideRootInline = function (isInlineTarget, rootNode, pos) {\n      return InlineUtils.findRootInline(isInlineTarget, rootNode, pos).filter(curry(isNotInsideFormatCaretContainer, rootNode));\n    };\n    var start = function (isInlineTarget, rootNode, pos) {\n      var nPos = InlineUtils.normalizeBackwards(pos);\n      return findInsideRootInline(isInlineTarget, rootNode, nPos).bind(function (inline) {\n        var prevPos = CaretFinder.prevPosition(inline, nPos);\n        return prevPos.isNone() ? Option.some(Location.start(inline)) : Option.none();\n      });\n    };\n    var end = function (isInlineTarget, rootNode, pos) {\n      var nPos = InlineUtils.normalizeForwards(pos);\n      return findInsideRootInline(isInlineTarget, rootNode, nPos).bind(function (inline) {\n        var nextPos = CaretFinder.nextPosition(inline, nPos);\n        return nextPos.isNone() ? Option.some(Location.end(inline)) : Option.none();\n      });\n    };\n    var after$3 = function (isInlineTarget, rootNode, pos) {\n      var nPos = InlineUtils.normalizeBackwards(pos);\n      var scope = rescope(rootNode, nPos.container());\n      return InlineUtils.findRootInline(isInlineTarget, scope, nPos).fold(function () {\n        return CaretFinder.prevPosition(scope, nPos).bind(curry(InlineUtils.findRootInline, isInlineTarget, scope)).map(function (inline) {\n          return Location.after(inline);\n        });\n      }, Option.none);\n    };\n    var isValidLocation = function (location) {\n      return InlineUtils.isRtl(getElement(location)) === false;\n    };\n    var readLocation = function (isInlineTarget, rootNode, pos) {\n      var location = LazyEvaluator.evaluateUntil([\n        before$4,\n        start,\n        end,\n        after$3\n      ], [\n        isInlineTarget,\n        rootNode,\n        pos\n      ]);\n      return location.filter(isValidLocation);\n    };\n    var getElement = function (location) {\n      return location.fold(identity, identity, identity, identity);\n    };\n    var getName = function (location) {\n      return location.fold(constant('before'), constant('start'), constant('end'), constant('after'));\n    };\n    var outside = function (location) {\n      return location.fold(Location.before, Location.before, Location.after, Location.after);\n    };\n    var inside = function (location) {\n      return location.fold(Location.start, Location.start, Location.end, Location.end);\n    };\n    var isEq$5 = function (location1, location2) {\n      return getName(location1) === getName(location2) && getElement(location1) === getElement(location2);\n    };\n    var betweenInlines = function (forward, isInlineTarget, rootNode, from, to, location) {\n      return lift2(InlineUtils.findRootInline(isInlineTarget, rootNode, from), InlineUtils.findRootInline(isInlineTarget, rootNode, to), function (fromInline, toInline) {\n        if (fromInline !== toInline && InlineUtils.hasSameParentBlock(rootNode, fromInline, toInline)) {\n          return Location.after(forward ? fromInline : toInline);\n        } else {\n          return location;\n        }\n      }).getOr(location);\n    };\n    var skipNoMovement = function (fromLocation, toLocation) {\n      return fromLocation.fold(constant(true), function (fromLocation) {\n        return !isEq$5(fromLocation, toLocation);\n      });\n    };\n    var findLocationTraverse = function (forward, isInlineTarget, rootNode, fromLocation, pos) {\n      var from = InlineUtils.normalizePosition(forward, pos);\n      var to = CaretFinder.fromPosition(forward, rootNode, from).map(curry(InlineUtils.normalizePosition, forward));\n      var location = to.fold(function () {\n        return fromLocation.map(outside);\n      }, function (to) {\n        return readLocation(isInlineTarget, rootNode, to).map(curry(betweenInlines, forward, isInlineTarget, rootNode, from, to)).filter(curry(skipNoMovement, fromLocation));\n      });\n      return location.filter(isValidLocation);\n    };\n    var findLocationSimple = function (forward, location) {\n      if (forward) {\n        return location.fold(compose(Option.some, Location.start), Option.none, compose(Option.some, Location.after), Option.none);\n      } else {\n        return location.fold(Option.none, compose(Option.some, Location.before), Option.none, compose(Option.some, Location.end));\n      }\n    };\n    var findLocation = function (forward, isInlineTarget, rootNode, pos) {\n      var from = InlineUtils.normalizePosition(forward, pos);\n      var fromLocation = readLocation(isInlineTarget, rootNode, from);\n      return readLocation(isInlineTarget, rootNode, from).bind(curry(findLocationSimple, forward)).orThunk(function () {\n        return findLocationTraverse(forward, isInlineTarget, rootNode, fromLocation, pos);\n      });\n    };\n    var BoundaryLocation = {\n      readLocation: readLocation,\n      findLocation: findLocation,\n      prevLocation: curry(findLocation, false),\n      nextLocation: curry(findLocation, true),\n      getElement: getElement,\n      outside: outside,\n      inside: inside\n    };\n\n    var hasSelectionModifyApi = function (editor) {\n      return isFunction(editor.selection.getSel().modify);\n    };\n    var moveRel = function (forward, selection, pos) {\n      var delta = forward ? 1 : -1;\n      selection.setRng(CaretPosition$1(pos.container(), pos.offset() + delta).toRange());\n      selection.getSel().modify('move', forward ? 'forward' : 'backward', 'word');\n      return true;\n    };\n    var moveByWord = function (forward, editor) {\n      var rng = editor.selection.getRng();\n      var pos = forward ? CaretPosition$1.fromRangeEnd(rng) : CaretPosition$1.fromRangeStart(rng);\n      if (!hasSelectionModifyApi(editor)) {\n        return false;\n      } else if (forward && isBeforeInline(pos)) {\n        return moveRel(true, editor.selection, pos);\n      } else if (!forward && isAfterInline(pos)) {\n        return moveRel(false, editor.selection, pos);\n      } else {\n        return false;\n      }\n    };\n    var WordSelection = {\n      hasSelectionModifyApi: hasSelectionModifyApi,\n      moveByWord: moveByWord\n    };\n\n    var setCaretPosition = function (editor, pos) {\n      var rng = editor.dom.createRng();\n      rng.setStart(pos.container(), pos.offset());\n      rng.setEnd(pos.container(), pos.offset());\n      editor.selection.setRng(rng);\n    };\n    var isFeatureEnabled = function (editor) {\n      return editor.settings.inline_boundaries !== false;\n    };\n    var setSelected = function (state, elm) {\n      if (state) {\n        elm.setAttribute('data-mce-selected', 'inline-boundary');\n      } else {\n        elm.removeAttribute('data-mce-selected');\n      }\n    };\n    var renderCaretLocation = function (editor, caret, location) {\n      return BoundaryCaret.renderCaret(caret, location).map(function (pos) {\n        setCaretPosition(editor, pos);\n        return location;\n      });\n    };\n    var findLocation$1 = function (editor, caret, forward) {\n      var rootNode = editor.getBody();\n      var from = CaretPosition$1.fromRangeStart(editor.selection.getRng());\n      var isInlineTarget = curry(InlineUtils.isInlineTarget, editor);\n      var location = BoundaryLocation.findLocation(forward, isInlineTarget, rootNode, from);\n      return location.bind(function (location) {\n        return renderCaretLocation(editor, caret, location);\n      });\n    };\n    var toggleInlines = function (isInlineTarget, dom, elms) {\n      var selectedInlines = filter(dom.select('*[data-mce-selected=\"inline-boundary\"]'), isInlineTarget);\n      var targetInlines = filter(elms, isInlineTarget);\n      each(difference(selectedInlines, targetInlines), curry(setSelected, false));\n      each(difference(targetInlines, selectedInlines), curry(setSelected, true));\n    };\n    var safeRemoveCaretContainer = function (editor, caret) {\n      if (editor.selection.isCollapsed() && editor.composing !== true && caret.get()) {\n        var pos = CaretPosition$1.fromRangeStart(editor.selection.getRng());\n        if (CaretPosition$1.isTextPosition(pos) && InlineUtils.isAtZwsp(pos) === false) {\n          setCaretPosition(editor, CaretContainerRemove.removeAndReposition(caret.get(), pos));\n          caret.set(null);\n        }\n      }\n    };\n    var renderInsideInlineCaret = function (isInlineTarget, editor, caret, elms) {\n      if (editor.selection.isCollapsed()) {\n        var inlines = filter(elms, isInlineTarget);\n        each(inlines, function (inline) {\n          var pos = CaretPosition$1.fromRangeStart(editor.selection.getRng());\n          BoundaryLocation.readLocation(isInlineTarget, editor.getBody(), pos).bind(function (location) {\n            return renderCaretLocation(editor, caret, location);\n          });\n        });\n      }\n    };\n    var move = function (editor, caret, forward) {\n      return function () {\n        return isFeatureEnabled(editor) ? findLocation$1(editor, caret, forward).isSome() : false;\n      };\n    };\n    var moveWord = function (forward, editor, caret) {\n      return function () {\n        return isFeatureEnabled(editor) ? WordSelection.moveByWord(forward, editor) : false;\n      };\n    };\n    var setupSelectedState = function (editor) {\n      var caret = Cell(null);\n      var isInlineTarget = curry(InlineUtils.isInlineTarget, editor);\n      editor.on('NodeChange', function (e) {\n        if (isFeatureEnabled(editor)) {\n          toggleInlines(isInlineTarget, editor.dom, e.parents);\n          safeRemoveCaretContainer(editor, caret);\n          renderInsideInlineCaret(isInlineTarget, editor, caret, e.parents);\n        }\n      });\n      return caret;\n    };\n    var moveNextWord = curry(moveWord, true);\n    var movePrevWord = curry(moveWord, false);\n    var BoundarySelection = {\n      move: move,\n      moveNextWord: moveNextWord,\n      movePrevWord: movePrevWord,\n      setupSelectedState: setupSelectedState,\n      setCaretPosition: setCaretPosition\n    };\n\n    var getNodeClientRects = function (node) {\n      var toArrayWithNode = function (clientRects) {\n        return map(clientRects, function (clientRect) {\n          clientRect = clone$1(clientRect);\n          clientRect.node = node;\n          return clientRect;\n        });\n      };\n      if (NodeType.isElement(node)) {\n        return toArrayWithNode(node.getClientRects());\n      }\n      if (NodeType.isText(node)) {\n        var rng = node.ownerDocument.createRange();\n        rng.setStart(node, 0);\n        rng.setEnd(node, node.data.length);\n        return toArrayWithNode(rng.getClientRects());\n      }\n    };\n    var getClientRects = function (node) {\n      return foldl(node, function (result, node) {\n        return result.concat(getNodeClientRects(node));\n      }, []);\n    };\n\n    var VDirection;\n    (function (VDirection) {\n      VDirection[VDirection['Up'] = -1] = 'Up';\n      VDirection[VDirection['Down'] = 1] = 'Down';\n    }(VDirection || (VDirection = {})));\n    var findUntil = function (direction, root, predicateFn, node) {\n      while (node = findNode(node, direction, isEditableCaretCandidate, root)) {\n        if (predicateFn(node)) {\n          return;\n        }\n      }\n    };\n    var walkUntil = function (direction, isAboveFn, isBeflowFn, root, predicateFn, caretPosition) {\n      var line = 0, node;\n      var result = [];\n      var targetClientRect;\n      var add = function (node) {\n        var i, clientRect, clientRects;\n        clientRects = getClientRects([node]);\n        if (direction === -1) {\n          clientRects = clientRects.reverse();\n        }\n        for (i = 0; i < clientRects.length; i++) {\n          clientRect = clientRects[i];\n          if (isBeflowFn(clientRect, targetClientRect)) {\n            continue;\n          }\n          if (result.length > 0 && isAboveFn(clientRect, ArrUtils.last(result))) {\n            line++;\n          }\n          clientRect.line = line;\n          if (predicateFn(clientRect)) {\n            return true;\n          }\n          result.push(clientRect);\n        }\n      };\n      targetClientRect = ArrUtils.last(caretPosition.getClientRects());\n      if (!targetClientRect) {\n        return result;\n      }\n      node = caretPosition.getNode();\n      add(node);\n      findUntil(direction, root, add, node);\n      return result;\n    };\n    var aboveLineNumber = function (lineNumber, clientRect) {\n      return clientRect.line > lineNumber;\n    };\n    var isLineNumber = function (lineNumber, clientRect) {\n      return clientRect.line === lineNumber;\n    };\n    var upUntil = curry(walkUntil, VDirection.Up, isAbove, isBelow);\n    var downUntil = curry(walkUntil, VDirection.Down, isBelow, isAbove);\n    var positionsUntil = function (direction, root, predicateFn, node) {\n      var caretWalker = CaretWalker(root);\n      var walkFn, isBelowFn, isAboveFn, caretPosition;\n      var result = [];\n      var line = 0, clientRect, targetClientRect;\n      var getClientRect = function (caretPosition) {\n        if (direction === 1) {\n          return ArrUtils.last(caretPosition.getClientRects());\n        }\n        return ArrUtils.last(caretPosition.getClientRects());\n      };\n      if (direction === 1) {\n        walkFn = caretWalker.next;\n        isBelowFn = isBelow;\n        isAboveFn = isAbove;\n        caretPosition = CaretPosition$1.after(node);\n      } else {\n        walkFn = caretWalker.prev;\n        isBelowFn = isAbove;\n        isAboveFn = isBelow;\n        caretPosition = CaretPosition$1.before(node);\n      }\n      targetClientRect = getClientRect(caretPosition);\n      do {\n        if (!caretPosition.isVisible()) {\n          continue;\n        }\n        clientRect = getClientRect(caretPosition);\n        if (isAboveFn(clientRect, targetClientRect)) {\n          continue;\n        }\n        if (result.length > 0 && isBelowFn(clientRect, ArrUtils.last(result))) {\n          line++;\n        }\n        clientRect = clone$1(clientRect);\n        clientRect.position = caretPosition;\n        clientRect.line = line;\n        if (predicateFn(clientRect)) {\n          return result;\n        }\n        result.push(clientRect);\n      } while (caretPosition = walkFn(caretPosition));\n      return result;\n    };\n    var isAboveLine = function (lineNumber) {\n      return function (clientRect) {\n        return aboveLineNumber(lineNumber, clientRect);\n      };\n    };\n    var isLine = function (lineNumber) {\n      return function (clientRect) {\n        return isLineNumber(lineNumber, clientRect);\n      };\n    };\n\n    var isContentEditableFalse$7 = NodeType.isContentEditableFalse;\n    var findNode$1 = findNode;\n    var distanceToRectLeft = function (clientRect, clientX) {\n      return Math.abs(clientRect.left - clientX);\n    };\n    var distanceToRectRight = function (clientRect, clientX) {\n      return Math.abs(clientRect.right - clientX);\n    };\n    var isInside = function (clientX, clientRect) {\n      return clientX >= clientRect.left && clientX <= clientRect.right;\n    };\n    var findClosestClientRect = function (clientRects, clientX) {\n      return ArrUtils.reduce(clientRects, function (oldClientRect, clientRect) {\n        var oldDistance, newDistance;\n        oldDistance = Math.min(distanceToRectLeft(oldClientRect, clientX), distanceToRectRight(oldClientRect, clientX));\n        newDistance = Math.min(distanceToRectLeft(clientRect, clientX), distanceToRectRight(clientRect, clientX));\n        if (isInside(clientX, clientRect)) {\n          return clientRect;\n        }\n        if (isInside(clientX, oldClientRect)) {\n          return oldClientRect;\n        }\n        if (newDistance === oldDistance && isContentEditableFalse$7(clientRect.node)) {\n          return clientRect;\n        }\n        if (newDistance < oldDistance) {\n          return clientRect;\n        }\n        return oldClientRect;\n      });\n    };\n    var walkUntil$1 = function (direction, root, predicateFn, node) {\n      while (node = findNode$1(node, direction, isEditableCaretCandidate, root)) {\n        if (predicateFn(node)) {\n          return;\n        }\n      }\n    };\n    var findLineNodeRects = function (root, targetNodeRect) {\n      var clientRects = [];\n      var collect = function (checkPosFn, node) {\n        var lineRects;\n        lineRects = filter(getClientRects([node]), function (clientRect) {\n          return !checkPosFn(clientRect, targetNodeRect);\n        });\n        clientRects = clientRects.concat(lineRects);\n        return lineRects.length === 0;\n      };\n      clientRects.push(targetNodeRect);\n      walkUntil$1(VDirection.Up, root, curry(collect, isAbove), targetNodeRect.node);\n      walkUntil$1(VDirection.Down, root, curry(collect, isBelow), targetNodeRect.node);\n      return clientRects;\n    };\n    var getFakeCaretTargets = function (root) {\n      return filter(from$1(root.getElementsByTagName('*')), isFakeCaretTarget);\n    };\n    var caretInfo = function (clientRect, clientX) {\n      return {\n        node: clientRect.node,\n        before: distanceToRectLeft(clientRect, clientX) < distanceToRectRight(clientRect, clientX)\n      };\n    };\n    var closestCaret = function (root, clientX, clientY) {\n      var closestNodeRect;\n      var contentEditableFalseNodeRects = getClientRects(getFakeCaretTargets(root));\n      var targetNodeRects = filter(contentEditableFalseNodeRects, function (rect) {\n        return clientY >= rect.top && clientY <= rect.bottom;\n      });\n      closestNodeRect = findClosestClientRect(targetNodeRects, clientX);\n      if (closestNodeRect) {\n        closestNodeRect = findClosestClientRect(findLineNodeRects(root, closestNodeRect), clientX);\n        if (closestNodeRect && isFakeCaretTarget(closestNodeRect.node)) {\n          return caretInfo(closestNodeRect, clientX);\n        }\n      }\n      return null;\n    };\n\n    var isContentEditableTrue$3 = NodeType.isContentEditableTrue;\n    var isContentEditableFalse$8 = NodeType.isContentEditableFalse;\n    var showCaret = function (direction, editor, node, before, scrollIntoView) {\n      return editor._selectionOverrides.showCaret(direction, node, before, scrollIntoView);\n    };\n    var getNodeRange = function (node) {\n      var rng = node.ownerDocument.createRange();\n      rng.selectNode(node);\n      return rng;\n    };\n    var selectNode = function (editor, node) {\n      var e = editor.fire('BeforeObjectSelected', { target: node });\n      if (e.isDefaultPrevented()) {\n        return null;\n      }\n      return getNodeRange(node);\n    };\n    var renderCaretAtRange = function (editor, range, scrollIntoView) {\n      var normalizedRange = normalizeRange(1, editor.getBody(), range);\n      var caretPosition = CaretPosition$1.fromRangeStart(normalizedRange);\n      var caretPositionNode = caretPosition.getNode();\n      if (isContentEditableFalse$8(caretPositionNode)) {\n        return showCaret(1, editor, caretPositionNode, !caretPosition.isAtEnd(), false);\n      }\n      var caretPositionBeforeNode = caretPosition.getNode(true);\n      if (isContentEditableFalse$8(caretPositionBeforeNode)) {\n        return showCaret(1, editor, caretPositionBeforeNode, false, false);\n      }\n      var ceRoot = editor.dom.getParent(caretPosition.getNode(), function (node) {\n        return isContentEditableFalse$8(node) || isContentEditableTrue$3(node);\n      });\n      if (isContentEditableFalse$8(ceRoot)) {\n        return showCaret(1, editor, ceRoot, false, scrollIntoView);\n      }\n      return null;\n    };\n    var renderRangeCaret = function (editor, range, scrollIntoView) {\n      if (!range || !range.collapsed) {\n        return range;\n      }\n      var caretRange = renderCaretAtRange(editor, range, scrollIntoView);\n      if (caretRange) {\n        return caretRange;\n      }\n      return range;\n    };\n\n    var isChar = function (forward, predicate, pos) {\n      return Option.from(pos.container()).filter(NodeType.isText).exists(function (text) {\n        var delta = forward ? 0 : -1;\n        return predicate(text.data.charAt(pos.offset() + delta));\n      });\n    };\n    var isBeforeSpace = curry(isChar, true, isWhiteSpace$1);\n    var isAfterSpace = curry(isChar, false, isWhiteSpace$1);\n    var isEmptyText = function (pos) {\n      var container = pos.container();\n      return NodeType.isText(container) && container.data.length === 0;\n    };\n    var matchesElementPosition = function (before, predicate) {\n      return function (pos) {\n        return Option.from(getChildNodeAtRelativeOffset(before ? 0 : -1, pos)).filter(predicate).isSome();\n      };\n    };\n    var isImageBlock = function (node) {\n      return node.nodeName === 'IMG' && get$4(Element.fromDom(node), 'display') === 'block';\n    };\n    var isCefNode = function (node) {\n      return NodeType.isContentEditableFalse(node) && !NodeType.isBogusAll(node);\n    };\n    var isBeforeImageBlock = matchesElementPosition(true, isImageBlock);\n    var isAfterImageBlock = matchesElementPosition(false, isImageBlock);\n    var isBeforeTable = matchesElementPosition(true, NodeType.isTable);\n    var isAfterTable = matchesElementPosition(false, NodeType.isTable);\n    var isBeforeContentEditableFalse = matchesElementPosition(true, isCefNode);\n    var isAfterContentEditableFalse = matchesElementPosition(false, isCefNode);\n\n    var BreakType;\n    (function (BreakType) {\n      BreakType[BreakType['Br'] = 0] = 'Br';\n      BreakType[BreakType['Block'] = 1] = 'Block';\n      BreakType[BreakType['Wrap'] = 2] = 'Wrap';\n      BreakType[BreakType['Eol'] = 3] = 'Eol';\n    }(BreakType || (BreakType = {})));\n    var flip = function (direction, positions) {\n      return direction === HDirection.Backwards ? reverse(positions) : positions;\n    };\n    var walk$3 = function (direction, caretWalker, pos) {\n      return direction === HDirection.Forwards ? caretWalker.next(pos) : caretWalker.prev(pos);\n    };\n    var getBreakType = function (scope, direction, currentPos, nextPos) {\n      if (NodeType.isBr(nextPos.getNode(direction === HDirection.Forwards))) {\n        return BreakType.Br;\n      } else if (isInSameBlock(currentPos, nextPos) === false) {\n        return BreakType.Block;\n      } else {\n        return BreakType.Wrap;\n      }\n    };\n    var getPositionsUntil = function (predicate, direction, scope, start) {\n      var caretWalker = CaretWalker(scope);\n      var currentPos = start, nextPos;\n      var positions = [];\n      while (currentPos) {\n        nextPos = walk$3(direction, caretWalker, currentPos);\n        if (!nextPos) {\n          break;\n        }\n        if (NodeType.isBr(nextPos.getNode(false))) {\n          if (direction === HDirection.Forwards) {\n            return {\n              positions: flip(direction, positions).concat([nextPos]),\n              breakType: BreakType.Br,\n              breakAt: Option.some(nextPos)\n            };\n          } else {\n            return {\n              positions: flip(direction, positions),\n              breakType: BreakType.Br,\n              breakAt: Option.some(nextPos)\n            };\n          }\n        }\n        if (!nextPos.isVisible()) {\n          currentPos = nextPos;\n          continue;\n        }\n        if (predicate(currentPos, nextPos)) {\n          var breakType = getBreakType(scope, direction, currentPos, nextPos);\n          return {\n            positions: flip(direction, positions),\n            breakType: breakType,\n            breakAt: Option.some(nextPos)\n          };\n        }\n        positions.push(nextPos);\n        currentPos = nextPos;\n      }\n      return {\n        positions: flip(direction, positions),\n        breakType: BreakType.Eol,\n        breakAt: Option.none()\n      };\n    };\n    var getAdjacentLinePositions = function (direction, getPositionsUntilBreak, scope, start) {\n      return getPositionsUntilBreak(scope, start).breakAt.map(function (pos) {\n        var positions = getPositionsUntilBreak(scope, pos).positions;\n        return direction === HDirection.Backwards ? positions.concat(pos) : [pos].concat(positions);\n      }).getOr([]);\n    };\n    var findClosestHorizontalPositionFromPoint = function (positions, x) {\n      return foldl(positions, function (acc, newPos) {\n        return acc.fold(function () {\n          return Option.some(newPos);\n        }, function (lastPos) {\n          return lift2(head(lastPos.getClientRects()), head(newPos.getClientRects()), function (lastRect, newRect) {\n            var lastDist = Math.abs(x - lastRect.left);\n            var newDist = Math.abs(x - newRect.left);\n            return newDist <= lastDist ? newPos : lastPos;\n          }).or(acc);\n        });\n      }, Option.none());\n    };\n    var findClosestHorizontalPosition = function (positions, pos) {\n      return head(pos.getClientRects()).bind(function (targetRect) {\n        return findClosestHorizontalPositionFromPoint(positions, targetRect.left);\n      });\n    };\n    var getPositionsUntilPreviousLine = curry(getPositionsUntil, CaretPosition.isAbove, -1);\n    var getPositionsUntilNextLine = curry(getPositionsUntil, CaretPosition.isBelow, 1);\n    var isAtFirstLine = function (scope, pos) {\n      return getPositionsUntilPreviousLine(scope, pos).breakAt.isNone();\n    };\n    var isAtLastLine = function (scope, pos) {\n      return getPositionsUntilNextLine(scope, pos).breakAt.isNone();\n    };\n    var getPositionsAbove = curry(getAdjacentLinePositions, -1, getPositionsUntilPreviousLine);\n    var getPositionsBelow = curry(getAdjacentLinePositions, 1, getPositionsUntilNextLine);\n    var getFirstLinePositions = function (scope) {\n      return CaretFinder.firstPositionIn(scope).map(function (pos) {\n        return [pos].concat(getPositionsUntilNextLine(scope, pos).positions);\n      }).getOr([]);\n    };\n    var getLastLinePositions = function (scope) {\n      return CaretFinder.lastPositionIn(scope).map(function (pos) {\n        return getPositionsUntilPreviousLine(scope, pos).positions.concat(pos);\n      }).getOr([]);\n    };\n\n    var isContentEditableFalse$9 = NodeType.isContentEditableFalse;\n    var getSelectedNode$1 = getSelectedNode;\n    var moveToCeFalseHorizontally = function (direction, editor, getNextPosFn, range) {\n      var forwards = direction === HDirection.Forwards;\n      var isBeforeContentEditableFalseFn = forwards ? isBeforeContentEditableFalse : isAfterContentEditableFalse;\n      if (!range.collapsed) {\n        var node = getSelectedNode$1(range);\n        if (isContentEditableFalse$9(node)) {\n          return showCaret(direction, editor, node, direction === HDirection.Backwards, true);\n        }\n      }\n      var rangeIsInContainerBlock = isRangeInCaretContainerBlock(range);\n      var caretPosition = getNormalizedRangeEndPoint(direction, editor.getBody(), range);\n      if (isBeforeContentEditableFalseFn(caretPosition)) {\n        return selectNode(editor, caretPosition.getNode(!forwards));\n      }\n      var nextCaretPosition = InlineUtils.normalizePosition(forwards, getNextPosFn(caretPosition));\n      if (!nextCaretPosition) {\n        if (rangeIsInContainerBlock) {\n          return range;\n        }\n        return null;\n      }\n      if (isBeforeContentEditableFalseFn(nextCaretPosition)) {\n        return showCaret(direction, editor, nextCaretPosition.getNode(!forwards), forwards, true);\n      }\n      var peekCaretPosition = getNextPosFn(nextCaretPosition);\n      if (peekCaretPosition && isBeforeContentEditableFalseFn(peekCaretPosition)) {\n        if (isMoveInsideSameBlock(nextCaretPosition, peekCaretPosition)) {\n          return showCaret(direction, editor, peekCaretPosition.getNode(!forwards), forwards, true);\n        }\n      }\n      if (rangeIsInContainerBlock) {\n        return renderRangeCaret(editor, nextCaretPosition.toRange(), true);\n      }\n      return null;\n    };\n    var moveToCeFalseVertically = function (direction, editor, walkerFn, range) {\n      var caretPosition, linePositions, nextLinePositions;\n      var closestNextLineRect, caretClientRect, clientX;\n      var dist1, dist2, contentEditableFalseNode;\n      contentEditableFalseNode = getSelectedNode$1(range);\n      caretPosition = getNormalizedRangeEndPoint(direction, editor.getBody(), range);\n      linePositions = walkerFn(editor.getBody(), isAboveLine(1), caretPosition);\n      nextLinePositions = filter(linePositions, isLine(1));\n      caretClientRect = ArrUtils.last(caretPosition.getClientRects());\n      if (isBeforeContentEditableFalse(caretPosition) || isBeforeTable(caretPosition)) {\n        contentEditableFalseNode = caretPosition.getNode();\n      }\n      if (isAfterContentEditableFalse(caretPosition) || isAfterTable(caretPosition)) {\n        contentEditableFalseNode = caretPosition.getNode(true);\n      }\n      if (!caretClientRect) {\n        return null;\n      }\n      clientX = caretClientRect.left;\n      closestNextLineRect = findClosestClientRect(nextLinePositions, clientX);\n      if (closestNextLineRect) {\n        if (isContentEditableFalse$9(closestNextLineRect.node)) {\n          dist1 = Math.abs(clientX - closestNextLineRect.left);\n          dist2 = Math.abs(clientX - closestNextLineRect.right);\n          return showCaret(direction, editor, closestNextLineRect.node, dist1 < dist2, true);\n        }\n      }\n      if (contentEditableFalseNode) {\n        var caretPositions = positionsUntil(direction, editor.getBody(), isAboveLine(1), contentEditableFalseNode);\n        closestNextLineRect = findClosestClientRect(filter(caretPositions, isLine(1)), clientX);\n        if (closestNextLineRect) {\n          return renderRangeCaret(editor, closestNextLineRect.position.toRange(), true);\n        }\n        closestNextLineRect = ArrUtils.last(filter(caretPositions, isLine(0)));\n        if (closestNextLineRect) {\n          return renderRangeCaret(editor, closestNextLineRect.position.toRange(), true);\n        }\n      }\n    };\n    var createTextBlock = function (editor) {\n      var textBlock = editor.dom.create(Settings.getForcedRootBlock(editor));\n      if (!Env.ie || Env.ie >= 11) {\n        textBlock.innerHTML = '<br data-mce-bogus=\"1\">';\n      }\n      return textBlock;\n    };\n    var exitPreBlock = function (editor, direction, range) {\n      var pre, caretPos, newBlock;\n      var caretWalker = CaretWalker(editor.getBody());\n      var getNextVisualCaretPosition = curry(getVisualCaretPosition, caretWalker.next);\n      var getPrevVisualCaretPosition = curry(getVisualCaretPosition, caretWalker.prev);\n      if (range.collapsed && editor.settings.forced_root_block) {\n        pre = editor.dom.getParent(range.startContainer, 'PRE');\n        if (!pre) {\n          return;\n        }\n        if (direction === 1) {\n          caretPos = getNextVisualCaretPosition(CaretPosition$1.fromRangeStart(range));\n        } else {\n          caretPos = getPrevVisualCaretPosition(CaretPosition$1.fromRangeStart(range));\n        }\n        if (!caretPos) {\n          newBlock = createTextBlock(editor);\n          if (direction === 1) {\n            editor.$(pre).after(newBlock);\n          } else {\n            editor.$(pre).before(newBlock);\n          }\n          editor.selection.select(newBlock, true);\n          editor.selection.collapse();\n        }\n      }\n    };\n    var getHorizontalRange = function (editor, forward) {\n      var caretWalker = CaretWalker(editor.getBody());\n      var getNextVisualCaretPosition = curry(getVisualCaretPosition, caretWalker.next);\n      var getPrevVisualCaretPosition = curry(getVisualCaretPosition, caretWalker.prev);\n      var newRange;\n      var direction = forward ? HDirection.Forwards : HDirection.Backwards;\n      var getNextPosFn = forward ? getNextVisualCaretPosition : getPrevVisualCaretPosition;\n      var range = editor.selection.getRng();\n      newRange = moveToCeFalseHorizontally(direction, editor, getNextPosFn, range);\n      if (newRange) {\n        return newRange;\n      }\n      newRange = exitPreBlock(editor, direction, range);\n      if (newRange) {\n        return newRange;\n      }\n      return null;\n    };\n    var getVerticalRange = function (editor, down) {\n      var newRange;\n      var direction = down ? 1 : -1;\n      var walkerFn = down ? downUntil : upUntil;\n      var range = editor.selection.getRng();\n      newRange = moveToCeFalseVertically(direction, editor, walkerFn, range);\n      if (newRange) {\n        return newRange;\n      }\n      newRange = exitPreBlock(editor, direction, range);\n      if (newRange) {\n        return newRange;\n      }\n      return null;\n    };\n    var moveH = function (editor, forward) {\n      return function () {\n        var newRng = getHorizontalRange(editor, forward);\n        if (newRng) {\n          editor.selection.setRng(newRng);\n          return true;\n        } else {\n          return false;\n        }\n      };\n    };\n    var moveV = function (editor, down) {\n      return function () {\n        var newRng = getVerticalRange(editor, down);\n        if (newRng) {\n          editor.selection.setRng(newRng);\n          return true;\n        } else {\n          return false;\n        }\n      };\n    };\n    var isCefPosition = function (forward) {\n      return function (pos) {\n        return forward ? isAfterContentEditableFalse(pos) : isBeforeContentEditableFalse(pos);\n      };\n    };\n    var moveToLineEndPoint = function (editor, forward) {\n      return function () {\n        var from = forward ? CaretPosition$1.fromRangeEnd(editor.selection.getRng()) : CaretPosition$1.fromRangeStart(editor.selection.getRng());\n        var result = forward ? getPositionsUntilNextLine(editor.getBody(), from) : getPositionsUntilPreviousLine(editor.getBody(), from);\n        var to = forward ? last(result.positions) : head(result.positions);\n        return to.filter(isCefPosition(forward)).fold(constant(false), function (pos) {\n          editor.selection.setRng(pos.toRange());\n          return true;\n        });\n      };\n    };\n\n    var deflate = function (rect, delta) {\n      return {\n        left: rect.left - delta,\n        top: rect.top - delta,\n        right: rect.right + delta * 2,\n        bottom: rect.bottom + delta * 2,\n        width: rect.width + delta,\n        height: rect.height + delta\n      };\n    };\n    var getCorners = function (getYAxisValue, tds) {\n      return bind(tds, function (td) {\n        var rect = deflate(clone$1(td.getBoundingClientRect()), -1);\n        return [\n          {\n            x: rect.left,\n            y: getYAxisValue(rect),\n            cell: td\n          },\n          {\n            x: rect.right,\n            y: getYAxisValue(rect),\n            cell: td\n          }\n        ];\n      });\n    };\n    var findClosestCorner = function (corners, x, y) {\n      return foldl(corners, function (acc, newCorner) {\n        return acc.fold(function () {\n          return Option.some(newCorner);\n        }, function (oldCorner) {\n          var oldDist = Math.sqrt(Math.abs(oldCorner.x - x) + Math.abs(oldCorner.y - y));\n          var newDist = Math.sqrt(Math.abs(newCorner.x - x) + Math.abs(newCorner.y - y));\n          return Option.some(newDist < oldDist ? newCorner : oldCorner);\n        });\n      }, Option.none());\n    };\n    var getClosestCell = function (getYAxisValue, isTargetCorner, table, x, y) {\n      var cells = descendants$1(Element.fromDom(table), 'td,th,caption').map(function (e) {\n        return e.dom();\n      });\n      var corners = filter(getCorners(getYAxisValue, cells), function (corner) {\n        return isTargetCorner(corner, y);\n      });\n      return findClosestCorner(corners, x, y).map(function (corner) {\n        return corner.cell;\n      });\n    };\n    var getBottomValue = function (rect) {\n      return rect.bottom;\n    };\n    var getTopValue = function (rect) {\n      return rect.top;\n    };\n    var isAbove$1 = function (corner, y) {\n      return corner.y < y;\n    };\n    var isBelow$1 = function (corner, y) {\n      return corner.y > y;\n    };\n    var getClosestCellAbove = curry(getClosestCell, getBottomValue, isAbove$1);\n    var getClosestCellBelow = curry(getClosestCell, getTopValue, isBelow$1);\n    var findClosestPositionInAboveCell = function (table, pos) {\n      return head(pos.getClientRects()).bind(function (rect) {\n        return getClosestCellAbove(table, rect.left, rect.top);\n      }).bind(function (cell) {\n        return findClosestHorizontalPosition(getLastLinePositions(cell), pos);\n      });\n    };\n    var findClosestPositionInBelowCell = function (table, pos) {\n      return last(pos.getClientRects()).bind(function (rect) {\n        return getClosestCellBelow(table, rect.left, rect.top);\n      }).bind(function (cell) {\n        return findClosestHorizontalPosition(getFirstLinePositions(cell), pos);\n      });\n    };\n\n    var moveToRange = function (editor, rng) {\n      editor.selection.setRng(rng);\n      ScrollIntoView.scrollRangeIntoView(editor, rng);\n    };\n    var hasNextBreak = function (getPositionsUntil, scope, lineInfo) {\n      return lineInfo.breakAt.map(function (breakPos) {\n        return getPositionsUntil(scope, breakPos).breakAt.isSome();\n      }).getOr(false);\n    };\n    var startsWithWrapBreak = function (lineInfo) {\n      return lineInfo.breakType === BreakType.Wrap && lineInfo.positions.length === 0;\n    };\n    var startsWithBrBreak = function (lineInfo) {\n      return lineInfo.breakType === BreakType.Br && lineInfo.positions.length === 1;\n    };\n    var isAtTableCellLine = function (getPositionsUntil, scope, pos) {\n      var lineInfo = getPositionsUntil(scope, pos);\n      if (startsWithWrapBreak(lineInfo) || !NodeType.isBr(pos.getNode()) && startsWithBrBreak(lineInfo)) {\n        return !hasNextBreak(getPositionsUntil, scope, lineInfo);\n      } else {\n        return lineInfo.breakAt.isNone();\n      }\n    };\n    var isAtFirstTableCellLine = curry(isAtTableCellLine, getPositionsUntilPreviousLine);\n    var isAtLastTableCellLine = curry(isAtTableCellLine, getPositionsUntilNextLine);\n    var isCaretAtStartOrEndOfTable = function (forward, rng, table) {\n      var caretPos = CaretPosition$1.fromRangeStart(rng);\n      return CaretFinder.positionIn(!forward, table).map(function (pos) {\n        return pos.isEqual(caretPos);\n      }).getOr(false);\n    };\n    var navigateHorizontally = function (editor, forward, table, td) {\n      var rng = editor.selection.getRng();\n      var direction = forward ? 1 : -1;\n      if (isFakeCaretTableBrowser() && isCaretAtStartOrEndOfTable(forward, rng, table)) {\n        var newRng = showCaret(direction, editor, table, !forward, true);\n        moveToRange(editor, newRng);\n        return true;\n      }\n      return false;\n    };\n    var getClosestAbovePosition = function (root, table, start) {\n      return findClosestPositionInAboveCell(table, start).orThunk(function () {\n        return head(start.getClientRects()).bind(function (rect) {\n          return findClosestHorizontalPositionFromPoint(getPositionsAbove(root, CaretPosition$1.before(table)), rect.left);\n        });\n      }).getOr(CaretPosition$1.before(table));\n    };\n    var getClosestBelowPosition = function (root, table, start) {\n      return findClosestPositionInBelowCell(table, start).orThunk(function () {\n        return head(start.getClientRects()).bind(function (rect) {\n          return findClosestHorizontalPositionFromPoint(getPositionsBelow(root, CaretPosition$1.after(table)), rect.left);\n        });\n      }).getOr(CaretPosition$1.after(table));\n    };\n    var getTable = function (previous, pos) {\n      var node = pos.getNode(previous);\n      return NodeType.isElement(node) && node.nodeName === 'TABLE' ? Option.some(node) : Option.none();\n    };\n    var renderBlock = function (down, editor, table, pos) {\n      var forcedRootBlock = Settings.getForcedRootBlock(editor);\n      if (forcedRootBlock) {\n        editor.undoManager.transact(function () {\n          var element = Element.fromTag(forcedRootBlock);\n          setAll(element, Settings.getForcedRootBlockAttrs(editor));\n          append(element, Element.fromTag('br'));\n          if (down) {\n            after(Element.fromDom(table), element);\n          } else {\n            before(Element.fromDom(table), element);\n          }\n          var rng = editor.dom.createRng();\n          rng.setStart(element.dom(), 0);\n          rng.setEnd(element.dom(), 0);\n          moveToRange(editor, rng);\n        });\n      } else {\n        moveToRange(editor, pos.toRange());\n      }\n    };\n    var moveCaret = function (editor, down, pos) {\n      var table = down ? getTable(true, pos) : getTable(false, pos);\n      var last = down === false;\n      table.fold(function () {\n        return moveToRange(editor, pos.toRange());\n      }, function (table) {\n        return CaretFinder.positionIn(last, editor.getBody()).filter(function (lastPos) {\n          return lastPos.isEqual(pos);\n        }).fold(function () {\n          return moveToRange(editor, pos.toRange());\n        }, function (_) {\n          return renderBlock(down, editor, table, pos);\n        });\n      });\n    };\n    var navigateVertically = function (editor, down, table, td) {\n      var rng = editor.selection.getRng();\n      var pos = CaretPosition$1.fromRangeStart(rng);\n      var root = editor.getBody();\n      if (!down && isAtFirstTableCellLine(td, pos)) {\n        var newPos = getClosestAbovePosition(root, table, pos);\n        moveCaret(editor, down, newPos);\n        return true;\n      } else if (down && isAtLastTableCellLine(td, pos)) {\n        var newPos = getClosestBelowPosition(root, table, pos);\n        moveCaret(editor, down, newPos);\n        return true;\n      } else {\n        return false;\n      }\n    };\n    var moveH$1 = function (editor, forward) {\n      return function () {\n        return Option.from(editor.dom.getParent(editor.selection.getNode(), 'td,th')).bind(function (td) {\n          return Option.from(editor.dom.getParent(td, 'table')).map(function (table) {\n            return navigateHorizontally(editor, forward, table);\n          });\n        }).getOr(false);\n      };\n    };\n    var moveV$1 = function (editor, forward) {\n      return function () {\n        return Option.from(editor.dom.getParent(editor.selection.getNode(), 'td,th')).bind(function (td) {\n          return Option.from(editor.dom.getParent(td, 'table')).map(function (table) {\n            return navigateVertically(editor, forward, table, td);\n          });\n        }).getOr(false);\n      };\n    };\n\n    var isTarget = function (node) {\n      return contains(['figcaption'], name(node));\n    };\n    var rangeBefore = function (target) {\n      var rng = domGlobals.document.createRange();\n      rng.setStartBefore(target.dom());\n      rng.setEndBefore(target.dom());\n      return rng;\n    };\n    var insertElement = function (root, elm, forward) {\n      if (forward) {\n        append(root, elm);\n      } else {\n        prepend(root, elm);\n      }\n    };\n    var insertBr = function (root, forward) {\n      var br = Element.fromTag('br');\n      insertElement(root, br, forward);\n      return rangeBefore(br);\n    };\n    var insertBlock$1 = function (root, forward, blockName, attrs) {\n      var block = Element.fromTag(blockName);\n      var br = Element.fromTag('br');\n      setAll(block, attrs);\n      append(block, br);\n      insertElement(root, block, forward);\n      return rangeBefore(br);\n    };\n    var insertEmptyLine = function (root, rootBlockName, attrs, forward) {\n      if (rootBlockName === '') {\n        return insertBr(root, forward);\n      } else {\n        return insertBlock$1(root, forward, rootBlockName, attrs);\n      }\n    };\n    var getClosestTargetBlock = function (pos, root) {\n      var isRoot = curry(eq, root);\n      return closest(Element.fromDom(pos.container()), isBlock, isRoot).filter(isTarget);\n    };\n    var isAtFirstOrLastLine = function (root, forward, pos) {\n      return forward ? isAtLastLine(root.dom(), pos) : isAtFirstLine(root.dom(), pos);\n    };\n    var moveCaretToNewEmptyLine = function (editor, forward) {\n      var root = Element.fromDom(editor.getBody());\n      var pos = CaretPosition$1.fromRangeStart(editor.selection.getRng());\n      var rootBlock = Settings.getForcedRootBlock(editor);\n      var rootBlockAttrs = Settings.getForcedRootBlockAttrs(editor);\n      return getClosestTargetBlock(pos, root).exists(function () {\n        if (isAtFirstOrLastLine(root, forward, pos)) {\n          var rng = insertEmptyLine(root, rootBlock, rootBlockAttrs, forward);\n          editor.selection.setRng(rng);\n          return true;\n        } else {\n          return false;\n        }\n      });\n    };\n    var moveV$2 = function (editor, forward) {\n      return function () {\n        if (editor.selection.isCollapsed()) {\n          return moveCaretToNewEmptyLine(editor, forward);\n        } else {\n          return false;\n        }\n      };\n    };\n\n    var defaultPatterns = function (patterns) {\n      return map(patterns, function (pattern) {\n        return __assign({\n          shiftKey: false,\n          altKey: false,\n          ctrlKey: false,\n          metaKey: false,\n          keyCode: 0,\n          action: noop\n        }, pattern);\n      });\n    };\n    var matchesEvent = function (pattern, evt) {\n      return evt.keyCode === pattern.keyCode && evt.shiftKey === pattern.shiftKey && evt.altKey === pattern.altKey && evt.ctrlKey === pattern.ctrlKey && evt.metaKey === pattern.metaKey;\n    };\n    var match$1 = function (patterns, evt) {\n      return bind(defaultPatterns(patterns), function (pattern) {\n        return matchesEvent(pattern, evt) ? [pattern] : [];\n      });\n    };\n    var action = function (f) {\n      var x = [];\n      for (var _i = 1; _i < arguments.length; _i++) {\n        x[_i - 1] = arguments[_i];\n      }\n      var args = Array.prototype.slice.call(arguments, 1);\n      return function () {\n        return f.apply(null, args);\n      };\n    };\n    var execute = function (patterns, evt) {\n      return find(match$1(patterns, evt), function (pattern) {\n        return pattern.action();\n      });\n    };\n    var MatchKeys = {\n      match: match$1,\n      action: action,\n      execute: execute\n    };\n\n    var executeKeydownOverride = function (editor, caret, evt) {\n      var os = detect$3().os;\n      MatchKeys.execute([\n        {\n          keyCode: VK.RIGHT,\n          action: moveH(editor, true)\n        },\n        {\n          keyCode: VK.LEFT,\n          action: moveH(editor, false)\n        },\n        {\n          keyCode: VK.UP,\n          action: moveV(editor, false)\n        },\n        {\n          keyCode: VK.DOWN,\n          action: moveV(editor, true)\n        },\n        {\n          keyCode: VK.RIGHT,\n          action: moveH$1(editor, true)\n        },\n        {\n          keyCode: VK.LEFT,\n          action: moveH$1(editor, false)\n        },\n        {\n          keyCode: VK.UP,\n          action: moveV$1(editor, false)\n        },\n        {\n          keyCode: VK.DOWN,\n          action: moveV$1(editor, true)\n        },\n        {\n          keyCode: VK.RIGHT,\n          action: BoundarySelection.move(editor, caret, true)\n        },\n        {\n          keyCode: VK.LEFT,\n          action: BoundarySelection.move(editor, caret, false)\n        },\n        {\n          keyCode: VK.RIGHT,\n          ctrlKey: !os.isOSX(),\n          altKey: os.isOSX(),\n          action: BoundarySelection.moveNextWord(editor, caret)\n        },\n        {\n          keyCode: VK.LEFT,\n          ctrlKey: !os.isOSX(),\n          altKey: os.isOSX(),\n          action: BoundarySelection.movePrevWord(editor, caret)\n        },\n        {\n          keyCode: VK.UP,\n          action: moveV$2(editor, false)\n        },\n        {\n          keyCode: VK.DOWN,\n          action: moveV$2(editor, true)\n        }\n      ], evt).each(function (_) {\n        evt.preventDefault();\n      });\n    };\n    var setup$9 = function (editor, caret) {\n      editor.on('keydown', function (evt) {\n        if (evt.isDefaultPrevented() === false) {\n          executeKeydownOverride(editor, caret, evt);\n        }\n      });\n    };\n    var ArrowKeys = { setup: setup$9 };\n\n    var isBeforeRoot = function (rootNode) {\n      return function (elm) {\n        return eq(rootNode, Element.fromDom(elm.dom().parentNode));\n      };\n    };\n    var getParentBlock$1 = function (rootNode, elm) {\n      return contains$2(rootNode, elm) ? closest(elm, function (element) {\n        return isTextBlock(element) || isListItem(element);\n      }, isBeforeRoot(rootNode)) : Option.none();\n    };\n    var placeCaretInEmptyBody = function (editor) {\n      var body = editor.getBody();\n      var node = body.firstChild && editor.dom.isBlock(body.firstChild) ? body.firstChild : body;\n      editor.selection.setCursorLocation(node, 0);\n    };\n    var paddEmptyBody = function (editor) {\n      if (editor.dom.isEmpty(editor.getBody())) {\n        editor.setContent('');\n        placeCaretInEmptyBody(editor);\n      }\n    };\n    var willDeleteLastPositionInElement = function (forward, fromPos, elm) {\n      return lift2(CaretFinder.firstPositionIn(elm), CaretFinder.lastPositionIn(elm), function (firstPos, lastPos) {\n        var normalizedFirstPos = InlineUtils.normalizePosition(true, firstPos);\n        var normalizedLastPos = InlineUtils.normalizePosition(false, lastPos);\n        var normalizedFromPos = InlineUtils.normalizePosition(false, fromPos);\n        if (forward) {\n          return CaretFinder.nextPosition(elm, normalizedFromPos).map(function (nextPos) {\n            return nextPos.isEqual(normalizedLastPos) && fromPos.isEqual(normalizedFirstPos);\n          }).getOr(false);\n        } else {\n          return CaretFinder.prevPosition(elm, normalizedFromPos).map(function (prevPos) {\n            return prevPos.isEqual(normalizedFirstPos) && fromPos.isEqual(normalizedLastPos);\n          }).getOr(false);\n        }\n      }).getOr(true);\n    };\n    var DeleteUtils = {\n      getParentBlock: getParentBlock$1,\n      paddEmptyBody: paddEmptyBody,\n      willDeleteLastPositionInElement: willDeleteLastPositionInElement\n    };\n\n    var blockPosition = function (block, position) {\n      return {\n        block: constant(block),\n        position: constant(position)\n      };\n    };\n    var blockBoundary = function (from, to) {\n      return {\n        from: constant(from),\n        to: constant(to)\n      };\n    };\n    var getBlockPosition = function (rootNode, pos) {\n      var rootElm = Element.fromDom(rootNode);\n      var containerElm = Element.fromDom(pos.container());\n      return DeleteUtils.getParentBlock(rootElm, containerElm).map(function (block) {\n        return blockPosition(block, pos);\n      });\n    };\n    var isDifferentBlocks = function (blockBoundary) {\n      return eq(blockBoundary.from().block(), blockBoundary.to().block()) === false;\n    };\n    var hasSameParent = function (blockBoundary) {\n      return parent(blockBoundary.from().block()).bind(function (parent1) {\n        return parent(blockBoundary.to().block()).filter(function (parent2) {\n          return eq(parent1, parent2);\n        });\n      }).isSome();\n    };\n    var isEditable = function (blockBoundary) {\n      return NodeType.isContentEditableFalse(blockBoundary.from().block().dom()) === false && NodeType.isContentEditableFalse(blockBoundary.to().block().dom()) === false;\n    };\n    var skipLastBr = function (rootNode, forward, blockPosition) {\n      if (NodeType.isBr(blockPosition.position().getNode()) && Empty.isEmpty(blockPosition.block()) === false) {\n        return CaretFinder.positionIn(false, blockPosition.block().dom()).bind(function (lastPositionInBlock) {\n          if (lastPositionInBlock.isEqual(blockPosition.position())) {\n            return CaretFinder.fromPosition(forward, rootNode, lastPositionInBlock).bind(function (to) {\n              return getBlockPosition(rootNode, to);\n            });\n          } else {\n            return Option.some(blockPosition);\n          }\n        }).getOr(blockPosition);\n      } else {\n        return blockPosition;\n      }\n    };\n    var readFromRange = function (rootNode, forward, rng) {\n      var fromBlockPos = getBlockPosition(rootNode, CaretPosition$1.fromRangeStart(rng));\n      var toBlockPos = fromBlockPos.bind(function (blockPos) {\n        return CaretFinder.fromPosition(forward, rootNode, blockPos.position()).bind(function (to) {\n          return getBlockPosition(rootNode, to).map(function (blockPos) {\n            return skipLastBr(rootNode, forward, blockPos);\n          });\n        });\n      });\n      return lift2(fromBlockPos, toBlockPos, blockBoundary).filter(function (blockBoundary) {\n        return isDifferentBlocks(blockBoundary) && hasSameParent(blockBoundary) && isEditable(blockBoundary);\n      });\n    };\n    var read$3 = function (rootNode, forward, rng) {\n      return rng.collapsed ? readFromRange(rootNode, forward, rng) : Option.none();\n    };\n    var BlockMergeBoundary = { read: read$3 };\n\n    var getChildrenUntilBlockBoundary = function (block) {\n      var children$1 = children(block);\n      return findIndex(children$1, isBlock).fold(function () {\n        return children$1;\n      }, function (index) {\n        return children$1.slice(0, index);\n      });\n    };\n    var extractChildren = function (block) {\n      var children = getChildrenUntilBlockBoundary(block);\n      each(children, remove);\n      return children;\n    };\n    var removeEmptyRoot = function (rootNode, block) {\n      var parents = Parents.parentsAndSelf(block, rootNode);\n      return find(parents.reverse(), function (element) {\n        return Empty.isEmpty(element);\n      }).each(remove);\n    };\n    var isEmptyBefore = function (el) {\n      return filter(prevSiblings(el), function (el) {\n        return !Empty.isEmpty(el);\n      }).length === 0;\n    };\n    var nestedBlockMerge = function (rootNode, fromBlock, toBlock, insertionPoint) {\n      if (Empty.isEmpty(toBlock)) {\n        PaddingBr.fillWithPaddingBr(toBlock);\n        return CaretFinder.firstPositionIn(toBlock.dom());\n      }\n      if (isEmptyBefore(insertionPoint) && Empty.isEmpty(fromBlock)) {\n        before(insertionPoint, Element.fromTag('br'));\n      }\n      var position = CaretFinder.prevPosition(toBlock.dom(), CaretPosition$1.before(insertionPoint.dom()));\n      each(extractChildren(fromBlock), function (child) {\n        before(insertionPoint, child);\n      });\n      removeEmptyRoot(rootNode, fromBlock);\n      return position;\n    };\n    var sidelongBlockMerge = function (rootNode, fromBlock, toBlock) {\n      if (Empty.isEmpty(toBlock)) {\n        remove(toBlock);\n        if (Empty.isEmpty(fromBlock)) {\n          PaddingBr.fillWithPaddingBr(fromBlock);\n        }\n        return CaretFinder.firstPositionIn(fromBlock.dom());\n      }\n      var position = CaretFinder.lastPositionIn(toBlock.dom());\n      each(extractChildren(fromBlock), function (child) {\n        append(toBlock, child);\n      });\n      removeEmptyRoot(rootNode, fromBlock);\n      return position;\n    };\n    var findInsertionPoint = function (toBlock, block) {\n      var parentsAndSelf = Parents.parentsAndSelf(block, toBlock);\n      return Option.from(parentsAndSelf[parentsAndSelf.length - 1]);\n    };\n    var getInsertionPoint = function (fromBlock, toBlock) {\n      return contains$2(toBlock, fromBlock) ? findInsertionPoint(toBlock, fromBlock) : Option.none();\n    };\n    var trimBr = function (first, block) {\n      CaretFinder.positionIn(first, block.dom()).map(function (position) {\n        return position.getNode();\n      }).map(Element.fromDom).filter(isBr$1).each(remove);\n    };\n    var mergeBlockInto = function (rootNode, fromBlock, toBlock) {\n      trimBr(true, fromBlock);\n      trimBr(false, toBlock);\n      return getInsertionPoint(fromBlock, toBlock).fold(curry(sidelongBlockMerge, rootNode, fromBlock, toBlock), curry(nestedBlockMerge, rootNode, fromBlock, toBlock));\n    };\n    var mergeBlocks = function (rootNode, forward, block1, block2) {\n      return forward ? mergeBlockInto(rootNode, block2, block1) : mergeBlockInto(rootNode, block1, block2);\n    };\n    var MergeBlocks = { mergeBlocks: mergeBlocks };\n\n    var backspaceDelete = function (editor, forward) {\n      var rootNode = Element.fromDom(editor.getBody());\n      var position = BlockMergeBoundary.read(rootNode.dom(), forward, editor.selection.getRng()).bind(function (blockBoundary) {\n        return MergeBlocks.mergeBlocks(rootNode, forward, blockBoundary.from().block(), blockBoundary.to().block());\n      });\n      position.each(function (pos) {\n        editor.selection.setRng(pos.toRange());\n      });\n      return position.isSome();\n    };\n    var BlockBoundaryDelete = { backspaceDelete: backspaceDelete };\n\n    var deleteRangeMergeBlocks = function (rootNode, selection) {\n      var rng = selection.getRng();\n      return lift2(DeleteUtils.getParentBlock(rootNode, Element.fromDom(rng.startContainer)), DeleteUtils.getParentBlock(rootNode, Element.fromDom(rng.endContainer)), function (block1, block2) {\n        if (eq(block1, block2) === false) {\n          rng.deleteContents();\n          MergeBlocks.mergeBlocks(rootNode, true, block1, block2).each(function (pos) {\n            selection.setRng(pos.toRange());\n          });\n          return true;\n        } else {\n          return false;\n        }\n      }).getOr(false);\n    };\n    var isRawNodeInTable = function (root, rawNode) {\n      var node = Element.fromDom(rawNode);\n      var isRoot = curry(eq, root);\n      return ancestor(node, isTableCell, isRoot).isSome();\n    };\n    var isSelectionInTable = function (root, rng) {\n      return isRawNodeInTable(root, rng.startContainer) || isRawNodeInTable(root, rng.endContainer);\n    };\n    var isEverythingSelected = function (root, rng) {\n      var noPrevious = CaretFinder.prevPosition(root.dom(), CaretPosition$1.fromRangeStart(rng)).isNone();\n      var noNext = CaretFinder.nextPosition(root.dom(), CaretPosition$1.fromRangeEnd(rng)).isNone();\n      return !isSelectionInTable(root, rng) && noPrevious && noNext;\n    };\n    var emptyEditor = function (editor) {\n      editor.setContent('');\n      editor.selection.setCursorLocation();\n      return true;\n    };\n    var deleteRange = function (editor) {\n      var rootNode = Element.fromDom(editor.getBody());\n      var rng = editor.selection.getRng();\n      return isEverythingSelected(rootNode, rng) ? emptyEditor(editor) : deleteRangeMergeBlocks(rootNode, editor.selection);\n    };\n    var backspaceDelete$1 = function (editor, forward) {\n      return editor.selection.isCollapsed() ? false : deleteRange(editor);\n    };\n    var BlockRangeDelete = { backspaceDelete: backspaceDelete$1 };\n\n    var isBr$5 = function (pos) {\n      return getElementFromPosition(pos).exists(isBr$1);\n    };\n    var findBr = function (forward, root, pos) {\n      var parentBlocks = filter(Parents.parentsAndSelf(Element.fromDom(pos.container()), root), isBlock);\n      var scope = head(parentBlocks).getOr(root);\n      return CaretFinder.fromPosition(forward, scope.dom(), pos).filter(isBr$5);\n    };\n    var isBeforeBr = function (root, pos) {\n      return getElementFromPosition(pos).exists(isBr$1) || findBr(true, root, pos).isSome();\n    };\n    var isAfterBr = function (root, pos) {\n      return getElementFromPrevPosition(pos).exists(isBr$1) || findBr(false, root, pos).isSome();\n    };\n    var findPreviousBr = curry(findBr, false);\n    var findNextBr = curry(findBr, true);\n\n    var isCompoundElement = function (node) {\n      return isTableCell(Element.fromDom(node)) || isListItem(Element.fromDom(node));\n    };\n    var DeleteAction = Adt.generate([\n      { remove: ['element'] },\n      { moveToElement: ['element'] },\n      { moveToPosition: ['position'] }\n    ]);\n    var isAtContentEditableBlockCaret = function (forward, from) {\n      var elm = from.getNode(forward === false);\n      var caretLocation = forward ? 'after' : 'before';\n      return NodeType.isElement(elm) && elm.getAttribute('data-mce-caret') === caretLocation;\n    };\n    var isDeleteFromCefDifferentBlocks = function (root, forward, from, to) {\n      var inSameBlock = function (elm) {\n        return isInline(Element.fromDom(elm)) && !isInSameBlock(from, to, root);\n      };\n      return getRelativeCefElm(!forward, from).fold(function () {\n        return getRelativeCefElm(forward, to).fold(constant(false), inSameBlock);\n      }, inSameBlock);\n    };\n    var deleteEmptyBlockOrMoveToCef = function (root, forward, from, to) {\n      var toCefElm = to.getNode(forward === false);\n      return DeleteUtils.getParentBlock(Element.fromDom(root), Element.fromDom(from.getNode())).map(function (blockElm) {\n        return Empty.isEmpty(blockElm) ? DeleteAction.remove(blockElm.dom()) : DeleteAction.moveToElement(toCefElm);\n      }).orThunk(function () {\n        return Option.some(DeleteAction.moveToElement(toCefElm));\n      });\n    };\n    var findCefPosition = function (root, forward, from) {\n      return CaretFinder.fromPosition(forward, root, from).bind(function (to) {\n        if (isCompoundElement(to.getNode())) {\n          return Option.none();\n        } else if (isDeleteFromCefDifferentBlocks(root, forward, from, to)) {\n          return Option.none();\n        } else if (forward && NodeType.isContentEditableFalse(to.getNode())) {\n          return deleteEmptyBlockOrMoveToCef(root, forward, from, to);\n        } else if (forward === false && NodeType.isContentEditableFalse(to.getNode(true))) {\n          return deleteEmptyBlockOrMoveToCef(root, forward, from, to);\n        } else if (forward && isAfterContentEditableFalse(from)) {\n          return Option.some(DeleteAction.moveToPosition(to));\n        } else if (forward === false && isBeforeContentEditableFalse(from)) {\n          return Option.some(DeleteAction.moveToPosition(to));\n        } else {\n          return Option.none();\n        }\n      });\n    };\n    var getContentEditableBlockAction = function (forward, elm) {\n      if (forward && NodeType.isContentEditableFalse(elm.nextSibling)) {\n        return Option.some(DeleteAction.moveToElement(elm.nextSibling));\n      } else if (forward === false && NodeType.isContentEditableFalse(elm.previousSibling)) {\n        return Option.some(DeleteAction.moveToElement(elm.previousSibling));\n      } else {\n        return Option.none();\n      }\n    };\n    var skipMoveToActionFromInlineCefToContent = function (root, from, deleteAction) {\n      return deleteAction.fold(function (elm) {\n        return Option.some(DeleteAction.remove(elm));\n      }, function (elm) {\n        return Option.some(DeleteAction.moveToElement(elm));\n      }, function (to) {\n        if (isInSameBlock(from, to, root)) {\n          return Option.none();\n        } else {\n          return Option.some(DeleteAction.moveToPosition(to));\n        }\n      });\n    };\n    var getContentEditableAction = function (root, forward, from) {\n      if (isAtContentEditableBlockCaret(forward, from)) {\n        return getContentEditableBlockAction(forward, from.getNode(forward === false)).fold(function () {\n          return findCefPosition(root, forward, from);\n        }, Option.some);\n      } else {\n        return findCefPosition(root, forward, from).bind(function (deleteAction) {\n          return skipMoveToActionFromInlineCefToContent(root, from, deleteAction);\n        });\n      }\n    };\n    var read$4 = function (root, forward, rng) {\n      var normalizedRange = normalizeRange(forward ? 1 : -1, root, rng);\n      var from = CaretPosition$1.fromRangeStart(normalizedRange);\n      var rootElement = Element.fromDom(root);\n      if (forward === false && isAfterContentEditableFalse(from)) {\n        return Option.some(DeleteAction.remove(from.getNode(true)));\n      } else if (forward && isBeforeContentEditableFalse(from)) {\n        return Option.some(DeleteAction.remove(from.getNode()));\n      } else if (forward === false && isBeforeContentEditableFalse(from) && isAfterBr(rootElement, from)) {\n        return findPreviousBr(rootElement, from).map(function (br) {\n          return DeleteAction.remove(br.getNode());\n        });\n      } else if (forward && isAfterContentEditableFalse(from) && isBeforeBr(rootElement, from)) {\n        return findNextBr(rootElement, from).map(function (br) {\n          return DeleteAction.remove(br.getNode());\n        });\n      } else {\n        return getContentEditableAction(root, forward, from);\n      }\n    };\n\n    var deleteElement$1 = function (editor, forward) {\n      return function (element) {\n        editor._selectionOverrides.hideFakeCaret();\n        DeleteElement.deleteElement(editor, forward, Element.fromDom(element));\n        return true;\n      };\n    };\n    var moveToElement = function (editor, forward) {\n      return function (element) {\n        var pos = forward ? CaretPosition$1.before(element) : CaretPosition$1.after(element);\n        editor.selection.setRng(pos.toRange());\n        return true;\n      };\n    };\n    var moveToPosition = function (editor) {\n      return function (pos) {\n        editor.selection.setRng(pos.toRange());\n        return true;\n      };\n    };\n    var getAncestorCe = function (editor, node) {\n      return Option.from(getContentEditableRoot$1(editor.getBody(), node));\n    };\n    var backspaceDeleteCaret = function (editor, forward) {\n      var selectedNode = editor.selection.getNode();\n      return getAncestorCe(editor, selectedNode).filter(NodeType.isContentEditableFalse).fold(function () {\n        var result = read$4(editor.getBody(), forward, editor.selection.getRng()).map(function (deleteAction) {\n          return deleteAction.fold(deleteElement$1(editor, forward), moveToElement(editor, forward), moveToPosition(editor));\n        });\n        return result.getOr(false);\n      }, function () {\n        return true;\n      });\n    };\n    var deleteOffscreenSelection = function (rootElement) {\n      each(descendants$1(rootElement, '.mce-offscreen-selection'), remove);\n    };\n    var backspaceDeleteRange = function (editor, forward) {\n      var selectedNode = editor.selection.getNode();\n      if (NodeType.isContentEditableFalse(selectedNode)) {\n        var hasCefAncestor = getAncestorCe(editor, selectedNode.parentNode).filter(NodeType.isContentEditableFalse);\n        return hasCefAncestor.fold(function () {\n          deleteOffscreenSelection(Element.fromDom(editor.getBody()));\n          DeleteElement.deleteElement(editor, forward, Element.fromDom(editor.selection.getNode()));\n          DeleteUtils.paddEmptyBody(editor);\n          return true;\n        }, function () {\n          return true;\n        });\n      }\n      return false;\n    };\n    var getContentEditableRoot$1 = function (root, node) {\n      while (node && node !== root) {\n        if (NodeType.isContentEditableTrue(node) || NodeType.isContentEditableFalse(node)) {\n          return node;\n        }\n        node = node.parentNode;\n      }\n      return null;\n    };\n    var paddEmptyElement = function (editor) {\n      var br;\n      var ceRoot = getContentEditableRoot$1(editor.getBody(), editor.selection.getNode());\n      if (NodeType.isContentEditableTrue(ceRoot) && editor.dom.isBlock(ceRoot) && editor.dom.isEmpty(ceRoot)) {\n        br = editor.dom.create('br', { 'data-mce-bogus': '1' });\n        editor.dom.setHTML(ceRoot, '');\n        ceRoot.appendChild(br);\n        editor.selection.setRng(CaretPosition$1.before(br).toRange());\n      }\n      return true;\n    };\n    var backspaceDelete$2 = function (editor, forward) {\n      if (editor.selection.isCollapsed()) {\n        return backspaceDeleteCaret(editor, forward);\n      } else {\n        return backspaceDeleteRange(editor, forward);\n      }\n    };\n    var CefDelete = {\n      backspaceDelete: backspaceDelete$2,\n      paddEmptyElement: paddEmptyElement\n    };\n\n    var trimEmptyTextNode$1 = function (dom, node) {\n      if (NodeType.isText(node) && node.data.length === 0) {\n        dom.remove(node);\n      }\n    };\n    var deleteContentAndShowCaret = function (editor, range, node, direction, forward, peekCaretPosition) {\n      var caretRange = showCaret(direction, editor, peekCaretPosition.getNode(!forward), forward, true);\n      if (range.collapsed) {\n        var deleteRange = range.cloneRange();\n        if (forward) {\n          deleteRange.setEnd(caretRange.startContainer, caretRange.startOffset);\n        } else {\n          deleteRange.setStart(caretRange.endContainer, caretRange.endOffset);\n        }\n        deleteRange.deleteContents();\n      } else {\n        range.deleteContents();\n      }\n      editor.selection.setRng(caretRange);\n      trimEmptyTextNode$1(editor.dom, node);\n      return true;\n    };\n    var deleteCefBoundaryText = function (editor, forward) {\n      var range = editor.selection.getRng();\n      if (!NodeType.isText(range.commonAncestorContainer)) {\n        return false;\n      }\n      var direction = forward ? HDirection.Forwards : HDirection.Backwards;\n      var caretWalker = CaretWalker(editor.getBody());\n      var getNextVisualCaretPosition = curry(getVisualCaretPosition, caretWalker.next);\n      var getPrevVisualCaretPosition = curry(getVisualCaretPosition, caretWalker.prev);\n      var getNextPosFn = forward ? getNextVisualCaretPosition : getPrevVisualCaretPosition;\n      var isBeforeContentEditableFalseFn = forward ? isBeforeContentEditableFalse : isAfterContentEditableFalse;\n      var caretPosition = getNormalizedRangeEndPoint(direction, editor.getBody(), range);\n      var nextCaretPosition = InlineUtils.normalizePosition(forward, getNextPosFn(caretPosition));\n      if (!nextCaretPosition || !isMoveInsideSameBlock(caretPosition, nextCaretPosition)) {\n        return false;\n      } else if (isBeforeContentEditableFalseFn(nextCaretPosition)) {\n        return deleteContentAndShowCaret(editor, range, caretPosition.getNode(), direction, forward, nextCaretPosition);\n      }\n      var peekCaretPosition = getNextPosFn(nextCaretPosition);\n      if (peekCaretPosition && isBeforeContentEditableFalseFn(peekCaretPosition)) {\n        if (isMoveInsideSameBlock(nextCaretPosition, peekCaretPosition)) {\n          return deleteContentAndShowCaret(editor, range, caretPosition.getNode(), direction, forward, peekCaretPosition);\n        }\n      }\n      return false;\n    };\n    var backspaceDelete$3 = function (editor, forward) {\n      return deleteCefBoundaryText(editor, forward);\n    };\n    var CefBoundaryDelete = { backspaceDelete: backspaceDelete$3 };\n\n    var isFeatureEnabled$1 = function (editor) {\n      return editor.settings.inline_boundaries !== false;\n    };\n    var rangeFromPositions = function (from, to) {\n      var range = domGlobals.document.createRange();\n      range.setStart(from.container(), from.offset());\n      range.setEnd(to.container(), to.offset());\n      return range;\n    };\n    var hasOnlyTwoOrLessPositionsLeft = function (elm) {\n      return lift2(CaretFinder.firstPositionIn(elm), CaretFinder.lastPositionIn(elm), function (firstPos, lastPos) {\n        var normalizedFirstPos = InlineUtils.normalizePosition(true, firstPos);\n        var normalizedLastPos = InlineUtils.normalizePosition(false, lastPos);\n        return CaretFinder.nextPosition(elm, normalizedFirstPos).map(function (pos) {\n          return pos.isEqual(normalizedLastPos);\n        }).getOr(true);\n      }).getOr(true);\n    };\n    var setCaretLocation = function (editor, caret) {\n      return function (location) {\n        return BoundaryCaret.renderCaret(caret, location).map(function (pos) {\n          BoundarySelection.setCaretPosition(editor, pos);\n          return true;\n        }).getOr(false);\n      };\n    };\n    var deleteFromTo = function (editor, caret, from, to) {\n      var rootNode = editor.getBody();\n      var isInlineTarget = curry(InlineUtils.isInlineTarget, editor);\n      editor.undoManager.ignore(function () {\n        editor.selection.setRng(rangeFromPositions(from, to));\n        editor.execCommand('Delete');\n        BoundaryLocation.readLocation(isInlineTarget, rootNode, CaretPosition$1.fromRangeStart(editor.selection.getRng())).map(BoundaryLocation.inside).map(setCaretLocation(editor, caret));\n      });\n      editor.nodeChanged();\n    };\n    var rescope$1 = function (rootNode, node) {\n      var parentBlock = getParentBlock(node, rootNode);\n      return parentBlock ? parentBlock : rootNode;\n    };\n    var backspaceDeleteCollapsed = function (editor, caret, forward, from) {\n      var rootNode = rescope$1(editor.getBody(), from.container());\n      var isInlineTarget = curry(InlineUtils.isInlineTarget, editor);\n      var fromLocation = BoundaryLocation.readLocation(isInlineTarget, rootNode, from);\n      return fromLocation.bind(function (location) {\n        if (forward) {\n          return location.fold(constant(Option.some(BoundaryLocation.inside(location))), Option.none, constant(Option.some(BoundaryLocation.outside(location))), Option.none);\n        } else {\n          return location.fold(Option.none, constant(Option.some(BoundaryLocation.outside(location))), Option.none, constant(Option.some(BoundaryLocation.inside(location))));\n        }\n      }).map(setCaretLocation(editor, caret)).getOrThunk(function () {\n        var toPosition = CaretFinder.navigate(forward, rootNode, from);\n        var toLocation = toPosition.bind(function (pos) {\n          return BoundaryLocation.readLocation(isInlineTarget, rootNode, pos);\n        });\n        if (fromLocation.isSome() && toLocation.isSome()) {\n          return InlineUtils.findRootInline(isInlineTarget, rootNode, from).map(function (elm) {\n            if (hasOnlyTwoOrLessPositionsLeft(elm)) {\n              DeleteElement.deleteElement(editor, forward, Element.fromDom(elm));\n              return true;\n            } else {\n              return false;\n            }\n          }).getOr(false);\n        } else {\n          return toLocation.bind(function (_) {\n            return toPosition.map(function (to) {\n              if (forward) {\n                deleteFromTo(editor, caret, from, to);\n              } else {\n                deleteFromTo(editor, caret, to, from);\n              }\n              return true;\n            });\n          }).getOr(false);\n        }\n      });\n    };\n    var backspaceDelete$4 = function (editor, caret, forward) {\n      if (editor.selection.isCollapsed() && isFeatureEnabled$1(editor)) {\n        var from = CaretPosition$1.fromRangeStart(editor.selection.getRng());\n        return backspaceDeleteCollapsed(editor, caret, forward, from);\n      }\n      return false;\n    };\n    var BoundaryDelete = { backspaceDelete: backspaceDelete$4 };\n\n    var getParentInlines = function (rootElm, startElm) {\n      var parents = Parents.parentsAndSelf(startElm, rootElm);\n      return findIndex(parents, isBlock).fold(constant(parents), function (index) {\n        return parents.slice(0, index);\n      });\n    };\n    var hasOnlyOneChild = function (elm) {\n      return children(elm).length === 1;\n    };\n    var deleteLastPosition = function (forward, editor, target, parentInlines) {\n      var isFormatElement$1 = curry(isFormatElement, editor);\n      var formatNodes = map(filter(parentInlines, isFormatElement$1), function (elm) {\n        return elm.dom();\n      });\n      if (formatNodes.length === 0) {\n        DeleteElement.deleteElement(editor, forward, target);\n      } else {\n        var pos = replaceWithCaretFormat(target.dom(), formatNodes);\n        editor.selection.setRng(pos.toRange());\n      }\n    };\n    var deleteCaret = function (editor, forward) {\n      var rootElm = Element.fromDom(editor.getBody());\n      var startElm = Element.fromDom(editor.selection.getStart());\n      var parentInlines = filter(getParentInlines(rootElm, startElm), hasOnlyOneChild);\n      return last(parentInlines).map(function (target) {\n        var fromPos = CaretPosition$1.fromRangeStart(editor.selection.getRng());\n        if (DeleteUtils.willDeleteLastPositionInElement(forward, fromPos, target.dom()) && !isEmptyCaretFormatElement(target)) {\n          deleteLastPosition(forward, editor, target, parentInlines);\n          return true;\n        } else {\n          return false;\n        }\n      }).getOr(false);\n    };\n    var backspaceDelete$5 = function (editor, forward) {\n      return editor.selection.isCollapsed() ? deleteCaret(editor, forward) : false;\n    };\n    var InlineFormatDelete = { backspaceDelete: backspaceDelete$5 };\n\n    var tableCellRng = function (start, end) {\n      return {\n        start: constant(start),\n        end: constant(end)\n      };\n    };\n    var tableSelection = function (rng, table, cells) {\n      return {\n        rng: constant(rng),\n        table: constant(table),\n        cells: constant(cells)\n      };\n    };\n    var deleteAction = Adt.generate([\n      { removeTable: ['element'] },\n      { emptyCells: ['cells'] }\n    ]);\n    var isRootFromElement = function (root) {\n      return function (cur) {\n        return eq(root, cur);\n      };\n    };\n    var getClosestCell$1 = function (container, isRoot) {\n      return closest$1(Element.fromDom(container), 'td,th', isRoot);\n    };\n    var getClosestTable = function (cell, isRoot) {\n      return ancestor$1(cell, 'table', isRoot);\n    };\n    var isExpandedCellRng = function (cellRng) {\n      return eq(cellRng.start(), cellRng.end()) === false;\n    };\n    var getTableFromCellRng = function (cellRng, isRoot) {\n      return getClosestTable(cellRng.start(), isRoot).bind(function (startParentTable) {\n        return getClosestTable(cellRng.end(), isRoot).bind(function (endParentTable) {\n          return someIf(eq(startParentTable, endParentTable), startParentTable);\n        });\n      });\n    };\n    var getTableCells = function (table) {\n      return descendants$1(table, 'td,th');\n    };\n    var getCellRangeFromStartTable = function (cellRng, isRoot) {\n      return getClosestTable(cellRng.start(), isRoot).bind(function (table) {\n        return last(getTableCells(table)).map(function (endCell) {\n          return tableCellRng(cellRng.start(), endCell);\n        });\n      });\n    };\n    var partialSelection = function (isRoot, rng) {\n      var startCell = getClosestCell$1(rng.startContainer, isRoot);\n      var endCell = getClosestCell$1(rng.endContainer, isRoot);\n      return rng.collapsed ? Option.none() : lift2(startCell, endCell, tableCellRng).fold(function () {\n        return startCell.fold(function () {\n          return endCell.bind(function (endCell) {\n            return getClosestTable(endCell, isRoot).bind(function (table) {\n              return head(getTableCells(table)).map(function (startCell) {\n                return tableCellRng(startCell, endCell);\n              });\n            });\n          });\n        }, function (startCell) {\n          return getClosestTable(startCell, isRoot).bind(function (table) {\n            return last(getTableCells(table)).map(function (endCell) {\n              return tableCellRng(startCell, endCell);\n            });\n          });\n        });\n      }, function (cellRng) {\n        return isWithinSameTable(isRoot, cellRng) ? Option.none() : getCellRangeFromStartTable(cellRng, isRoot);\n      });\n    };\n    var isWithinSameTable = function (isRoot, cellRng) {\n      return getTableFromCellRng(cellRng, isRoot).isSome();\n    };\n    var getCellRng = function (rng, isRoot) {\n      var startCell = getClosestCell$1(rng.startContainer, isRoot);\n      var endCell = getClosestCell$1(rng.endContainer, isRoot);\n      return lift2(startCell, endCell, tableCellRng).filter(isExpandedCellRng).filter(function (cellRng) {\n        return isWithinSameTable(isRoot, cellRng);\n      }).orThunk(function () {\n        return partialSelection(isRoot, rng);\n      });\n    };\n    var getTableSelectionFromCellRng = function (cellRng, isRoot) {\n      return getTableFromCellRng(cellRng, isRoot).map(function (table) {\n        return tableSelection(cellRng, table, getTableCells(table));\n      });\n    };\n    var getTableSelectionFromRng = function (root, rng) {\n      var isRoot = isRootFromElement(root);\n      return getCellRng(rng, isRoot).bind(function (cellRng) {\n        return getTableSelectionFromCellRng(cellRng, isRoot);\n      });\n    };\n    var getCellIndex = function (cells, cell) {\n      return findIndex(cells, function (x) {\n        return eq(x, cell);\n      });\n    };\n    var getSelectedCells = function (tableSelection) {\n      return lift2(getCellIndex(tableSelection.cells(), tableSelection.rng().start()), getCellIndex(tableSelection.cells(), tableSelection.rng().end()), function (startIndex, endIndex) {\n        return tableSelection.cells().slice(startIndex, endIndex + 1);\n      });\n    };\n    var getAction = function (tableSelection) {\n      return getSelectedCells(tableSelection).map(function (selected) {\n        var cells = tableSelection.cells();\n        return selected.length === cells.length ? deleteAction.removeTable(tableSelection.table()) : deleteAction.emptyCells(selected);\n      });\n    };\n    var getActionFromRange = function (root, rng) {\n      return getTableSelectionFromRng(root, rng).bind(getAction);\n    };\n\n    var emptyCells = function (editor, cells) {\n      each(cells, PaddingBr.fillWithPaddingBr);\n      editor.selection.setCursorLocation(cells[0].dom(), 0);\n      return true;\n    };\n    var deleteTableElement = function (editor, table) {\n      DeleteElement.deleteElement(editor, false, table);\n      return true;\n    };\n    var deleteCellRange = function (editor, rootElm, rng) {\n      return getActionFromRange(rootElm, rng).map(function (action) {\n        return action.fold(curry(deleteTableElement, editor), curry(emptyCells, editor));\n      });\n    };\n    var deleteCaptionRange = function (editor, caption) {\n      return emptyElement(editor, caption);\n    };\n    var deleteTableRange = function (editor, rootElm, rng, startElm) {\n      return getParentCaption(rootElm, startElm).fold(function () {\n        return deleteCellRange(editor, rootElm, rng);\n      }, function (caption) {\n        return deleteCaptionRange(editor, caption);\n      }).getOr(false);\n    };\n    var deleteRange$1 = function (editor, startElm) {\n      var rootNode = Element.fromDom(editor.getBody());\n      var rng = editor.selection.getRng();\n      var selectedCells = TableCellSelection.getCellsFromEditor(editor);\n      return selectedCells.length !== 0 ? emptyCells(editor, selectedCells) : deleteTableRange(editor, rootNode, rng, startElm);\n    };\n    var getParentCell = function (rootElm, elm) {\n      return find(Parents.parentsAndSelf(elm, rootElm), isTableCell);\n    };\n    var getParentCaption = function (rootElm, elm) {\n      return find(Parents.parentsAndSelf(elm, rootElm), function (elm) {\n        return name(elm) === 'caption';\n      });\n    };\n    var deleteBetweenCells = function (editor, rootElm, forward, fromCell, from) {\n      return CaretFinder.navigate(forward, editor.getBody(), from).bind(function (to) {\n        return getParentCell(rootElm, Element.fromDom(to.getNode())).map(function (toCell) {\n          return eq(toCell, fromCell) === false;\n        });\n      });\n    };\n    var emptyElement = function (editor, elm) {\n      PaddingBr.fillWithPaddingBr(elm);\n      editor.selection.setCursorLocation(elm.dom(), 0);\n      return Option.some(true);\n    };\n    var isDeleteOfLastCharPos = function (fromCaption, forward, from, to) {\n      return CaretFinder.firstPositionIn(fromCaption.dom()).bind(function (first) {\n        return CaretFinder.lastPositionIn(fromCaption.dom()).map(function (last) {\n          return forward ? from.isEqual(first) && to.isEqual(last) : from.isEqual(last) && to.isEqual(first);\n        });\n      }).getOr(true);\n    };\n    var emptyCaretCaption = function (editor, elm) {\n      return emptyElement(editor, elm);\n    };\n    var validateCaretCaption = function (rootElm, fromCaption, to) {\n      return getParentCaption(rootElm, Element.fromDom(to.getNode())).map(function (toCaption) {\n        return eq(toCaption, fromCaption) === false;\n      });\n    };\n    var deleteCaretInsideCaption = function (editor, rootElm, forward, fromCaption, from) {\n      return CaretFinder.navigate(forward, editor.getBody(), from).bind(function (to) {\n        return isDeleteOfLastCharPos(fromCaption, forward, from, to) ? emptyCaretCaption(editor, fromCaption) : validateCaretCaption(rootElm, fromCaption, to);\n      }).or(Option.some(true));\n    };\n    var deleteCaretCells = function (editor, forward, rootElm, startElm) {\n      var from = CaretPosition$1.fromRangeStart(editor.selection.getRng());\n      return getParentCell(rootElm, startElm).bind(function (fromCell) {\n        return Empty.isEmpty(fromCell) ? emptyElement(editor, fromCell) : deleteBetweenCells(editor, rootElm, forward, fromCell, from);\n      }).getOr(false);\n    };\n    var deleteCaretCaption = function (editor, forward, rootElm, fromCaption) {\n      var from = CaretPosition$1.fromRangeStart(editor.selection.getRng());\n      return Empty.isEmpty(fromCaption) ? emptyElement(editor, fromCaption) : deleteCaretInsideCaption(editor, rootElm, forward, fromCaption, from);\n    };\n    var isNearTable = function (forward, pos) {\n      return forward ? isBeforeTable(pos) : isAfterTable(pos);\n    };\n    var isBeforeOrAfterTable = function (editor, forward) {\n      var fromPos = CaretPosition$1.fromRangeStart(editor.selection.getRng());\n      return isNearTable(forward, fromPos) || CaretFinder.fromPosition(forward, editor.getBody(), fromPos).map(function (pos) {\n        return isNearTable(forward, pos);\n      }).getOr(false);\n    };\n    var deleteCaret$1 = function (editor, forward, startElm) {\n      var rootElm = Element.fromDom(editor.getBody());\n      return getParentCaption(rootElm, startElm).fold(function () {\n        return deleteCaretCells(editor, forward, rootElm, startElm) || isBeforeOrAfterTable(editor, forward);\n      }, function (fromCaption) {\n        return deleteCaretCaption(editor, forward, rootElm, fromCaption).getOr(false);\n      });\n    };\n    var backspaceDelete$6 = function (editor, forward) {\n      var startElm = Element.fromDom(editor.selection.getStart(true));\n      var cells = TableCellSelection.getCellsFromEditor(editor);\n      return editor.selection.isCollapsed() && cells.length === 0 ? deleteCaret$1(editor, forward, startElm) : deleteRange$1(editor, startElm);\n    };\n    var TableDelete = { backspaceDelete: backspaceDelete$6 };\n\n    var deleteCaret$2 = function (editor, forward) {\n      var fromPos = CaretPosition$1.fromRangeStart(editor.selection.getRng());\n      return CaretFinder.fromPosition(forward, editor.getBody(), fromPos).filter(function (pos) {\n        return forward ? isBeforeImageBlock(pos) : isAfterImageBlock(pos);\n      }).bind(function (pos) {\n        return Option.from(getChildNodeAtRelativeOffset(forward ? 0 : -1, pos));\n      }).map(function (elm) {\n        editor.selection.select(elm);\n        return true;\n      }).getOr(false);\n    };\n    var backspaceDelete$7 = function (editor, forward) {\n      return editor.selection.isCollapsed() ? deleteCaret$2(editor, forward) : false;\n    };\n    var PageBreakDelete = { backspaceDelete: backspaceDelete$7 };\n\n    var isEditable$1 = function (target) {\n      return closest(target, function (elm) {\n        return NodeType.isContentEditableTrue(elm.dom()) || NodeType.isContentEditableFalse(elm.dom());\n      }).exists(function (elm) {\n        return NodeType.isContentEditableTrue(elm.dom());\n      });\n    };\n    var parseIndentValue = function (value) {\n      var number = parseInt(value, 10);\n      return isNaN(number) ? 0 : number;\n    };\n    var getIndentStyleName = function (useMargin, element) {\n      var indentStyleName = useMargin || isTable$1(element) ? 'margin' : 'padding';\n      var suffix = get$4(element, 'direction') === 'rtl' ? '-right' : '-left';\n      return indentStyleName + suffix;\n    };\n    var indentElement = function (dom, command, useMargin, value, unit, element) {\n      var indentStyleName = getIndentStyleName(useMargin, Element.fromDom(element));\n      if (command === 'outdent') {\n        var styleValue = Math.max(0, parseIndentValue(element.style[indentStyleName]) - value);\n        dom.setStyle(element, indentStyleName, styleValue ? styleValue + unit : '');\n      } else {\n        var styleValue = parseIndentValue(element.style[indentStyleName]) + value + unit;\n        dom.setStyle(element, indentStyleName, styleValue);\n      }\n    };\n    var validateBlocks = function (editor, blocks) {\n      return forall(blocks, function (block) {\n        var indentStyleName = getIndentStyleName(Settings.shouldIndentUseMargin(editor), block);\n        var intentValue = getRaw(block, indentStyleName).map(parseIndentValue).getOr(0);\n        var contentEditable = editor.dom.getContentEditable(block.dom());\n        return contentEditable !== 'false' && intentValue > 0;\n      });\n    };\n    var canOutdent = function (editor) {\n      var blocks = getBlocksToIndent(editor);\n      return editor.readonly !== true && (blocks.length > 1 || validateBlocks(editor, blocks));\n    };\n    var isListComponent = function (el) {\n      return isList(el) || isListItem(el);\n    };\n    var parentIsListComponent = function (el) {\n      return parent(el).map(isListComponent).getOr(false);\n    };\n    var getBlocksToIndent = function (editor) {\n      return filter(map(editor.selection.getSelectedBlocks(), Element.fromDom), function (el) {\n        return !isListComponent(el) && !parentIsListComponent(el) && isEditable$1(el);\n      });\n    };\n    var handle = function (editor, command) {\n      var dom = editor.dom, selection = editor.selection, formatter = editor.formatter;\n      var indentation = Settings.getIndentation(editor);\n      var indentUnit = /[a-z%]+$/i.exec(indentation)[0];\n      var indentValue = parseInt(indentation, 10);\n      var useMargin = Settings.shouldIndentUseMargin(editor);\n      var forcedRootBlock = Settings.getForcedRootBlock(editor);\n      if (!editor.queryCommandState('InsertUnorderedList') && !editor.queryCommandState('InsertOrderedList')) {\n        if (forcedRootBlock === '' && !dom.getParent(selection.getNode(), dom.isBlock)) {\n          formatter.apply('div');\n        }\n      }\n      each(getBlocksToIndent(editor), function (block) {\n        indentElement(dom, command, useMargin, indentValue, indentUnit, block.dom());\n      });\n    };\n\n    var navigateIgnoreEmptyTextNodes = function (forward, root, from) {\n      return CaretFinder.navigateIgnore(forward, root, from, isEmptyText);\n    };\n    var getClosestBlock = function (root, pos) {\n      return find(Parents.parentsAndSelf(Element.fromDom(pos.container()), root), isBlock);\n    };\n    var isAtBeforeAfterBlockBoundary = function (forward, root, pos) {\n      return navigateIgnoreEmptyTextNodes(forward, root.dom(), pos).forall(function (newPos) {\n        return getClosestBlock(root, pos).fold(function () {\n          return isInSameBlock(newPos, pos, root.dom()) === false;\n        }, function (fromBlock) {\n          return isInSameBlock(newPos, pos, root.dom()) === false && contains$2(fromBlock, Element.fromDom(newPos.container()));\n        });\n      });\n    };\n    var isAtBlockBoundary = function (forward, root, pos) {\n      return getClosestBlock(root, pos).fold(function () {\n        return navigateIgnoreEmptyTextNodes(forward, root.dom(), pos).forall(function (newPos) {\n          return isInSameBlock(newPos, pos, root.dom()) === false;\n        });\n      }, function (parent) {\n        return navigateIgnoreEmptyTextNodes(forward, parent.dom(), pos).isNone();\n      });\n    };\n    var isAtStartOfBlock = curry(isAtBlockBoundary, false);\n    var isAtEndOfBlock = curry(isAtBlockBoundary, true);\n    var isBeforeBlock = curry(isAtBeforeAfterBlockBoundary, false);\n    var isAfterBlock = curry(isAtBeforeAfterBlockBoundary, true);\n\n    var backspaceDelete$8 = function (editor, _caret, _forward) {\n      if (editor.selection.isCollapsed() && canOutdent(editor)) {\n        var dom = editor.dom;\n        var rng = editor.selection.getRng();\n        var pos = CaretPosition$1.fromRangeStart(rng);\n        var block = dom.getParent(rng.startContainer, dom.isBlock);\n        if (block !== null && isAtStartOfBlock(Element.fromDom(block), pos)) {\n          handle(editor, 'outdent');\n          return true;\n        }\n      }\n      return false;\n    };\n    var Outdent = { backspaceDelete: backspaceDelete$8 };\n\n    var executeKeydownOverride$1 = function (editor, caret, evt) {\n      MatchKeys.execute([\n        {\n          keyCode: VK.BACKSPACE,\n          action: MatchKeys.action(Outdent.backspaceDelete, editor, false)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: MatchKeys.action(CefDelete.backspaceDelete, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: MatchKeys.action(CefDelete.backspaceDelete, editor, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: MatchKeys.action(CefBoundaryDelete.backspaceDelete, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: MatchKeys.action(CefBoundaryDelete.backspaceDelete, editor, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: MatchKeys.action(BoundaryDelete.backspaceDelete, editor, caret, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: MatchKeys.action(BoundaryDelete.backspaceDelete, editor, caret, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: MatchKeys.action(TableDelete.backspaceDelete, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: MatchKeys.action(TableDelete.backspaceDelete, editor, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: MatchKeys.action(PageBreakDelete.backspaceDelete, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: MatchKeys.action(PageBreakDelete.backspaceDelete, editor, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: MatchKeys.action(BlockRangeDelete.backspaceDelete, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: MatchKeys.action(BlockRangeDelete.backspaceDelete, editor, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: MatchKeys.action(BlockBoundaryDelete.backspaceDelete, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: MatchKeys.action(BlockBoundaryDelete.backspaceDelete, editor, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: MatchKeys.action(InlineFormatDelete.backspaceDelete, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: MatchKeys.action(InlineFormatDelete.backspaceDelete, editor, true)\n        }\n      ], evt).each(function (_) {\n        evt.preventDefault();\n      });\n    };\n    var executeKeyupOverride = function (editor, evt) {\n      MatchKeys.execute([\n        {\n          keyCode: VK.BACKSPACE,\n          action: MatchKeys.action(CefDelete.paddEmptyElement, editor)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: MatchKeys.action(CefDelete.paddEmptyElement, editor)\n        }\n      ], evt);\n    };\n    var setup$a = function (editor, caret) {\n      editor.on('keydown', function (evt) {\n        if (evt.isDefaultPrevented() === false) {\n          executeKeydownOverride$1(editor, caret, evt);\n        }\n      });\n      editor.on('keyup', function (evt) {\n        if (evt.isDefaultPrevented() === false) {\n          executeKeyupOverride(editor, evt);\n        }\n      });\n    };\n    var DeleteBackspaceKeys = { setup: setup$a };\n\n    var firstNonWhiteSpaceNodeSibling = function (node) {\n      while (node) {\n        if (node.nodeType === 1 || node.nodeType === 3 && node.data && /[\\r\\n\\s]/.test(node.data)) {\n          return node;\n        }\n        node = node.nextSibling;\n      }\n    };\n    var moveToCaretPosition = function (editor, root) {\n      var node, rng, lastNode = root;\n      var dom = editor.dom;\n      var moveCaretBeforeOnEnterElementsMap = editor.schema.getMoveCaretBeforeOnEnterElements();\n      if (!root) {\n        return;\n      }\n      if (/^(LI|DT|DD)$/.test(root.nodeName)) {\n        var firstChild = firstNonWhiteSpaceNodeSibling(root.firstChild);\n        if (firstChild && /^(UL|OL|DL)$/.test(firstChild.nodeName)) {\n          root.insertBefore(dom.doc.createTextNode(nbsp), root.firstChild);\n        }\n      }\n      rng = dom.createRng();\n      root.normalize();\n      if (root.hasChildNodes()) {\n        var walker = new TreeWalker(root, root);\n        while (node = walker.current()) {\n          if (NodeType.isText(node)) {\n            rng.setStart(node, 0);\n            rng.setEnd(node, 0);\n            break;\n          }\n          if (moveCaretBeforeOnEnterElementsMap[node.nodeName.toLowerCase()]) {\n            rng.setStartBefore(node);\n            rng.setEndBefore(node);\n            break;\n          }\n          lastNode = node;\n          node = walker.next();\n        }\n        if (!node) {\n          rng.setStart(lastNode, 0);\n          rng.setEnd(lastNode, 0);\n        }\n      } else {\n        if (NodeType.isBr(root)) {\n          if (root.nextSibling && dom.isBlock(root.nextSibling)) {\n            rng.setStartBefore(root);\n            rng.setEndBefore(root);\n          } else {\n            rng.setStartAfter(root);\n            rng.setEndAfter(root);\n          }\n        } else {\n          rng.setStart(root, 0);\n          rng.setEnd(root, 0);\n        }\n      }\n      editor.selection.setRng(rng);\n      ScrollIntoView.scrollRangeIntoView(editor, rng);\n    };\n    var getEditableRoot = function (dom, node) {\n      var root = dom.getRoot();\n      var parent, editableRoot;\n      parent = node;\n      while (parent !== root && dom.getContentEditable(parent) !== 'false') {\n        if (dom.getContentEditable(parent) === 'true') {\n          editableRoot = parent;\n        }\n        parent = parent.parentNode;\n      }\n      return parent !== root ? editableRoot : root;\n    };\n    var getParentBlock$2 = function (editor) {\n      return Option.from(editor.dom.getParent(editor.selection.getStart(true), editor.dom.isBlock));\n    };\n    var getParentBlockName = function (editor) {\n      return getParentBlock$2(editor).fold(constant(''), function (parentBlock) {\n        return parentBlock.nodeName.toUpperCase();\n      });\n    };\n    var isListItemParentBlock = function (editor) {\n      return getParentBlock$2(editor).filter(function (elm) {\n        return isListItem(Element.fromDom(elm));\n      }).isSome();\n    };\n    var NewLineUtils = {\n      moveToCaretPosition: moveToCaretPosition,\n      getEditableRoot: getEditableRoot,\n      getParentBlock: getParentBlock$2,\n      getParentBlockName: getParentBlockName,\n      isListItemParentBlock: isListItemParentBlock\n    };\n\n    var hasFirstChild = function (elm, name) {\n      return elm.firstChild && elm.firstChild.nodeName === name;\n    };\n    var hasParent$1 = function (elm, parentName) {\n      return elm && elm.parentNode && elm.parentNode.nodeName === parentName;\n    };\n    var isListBlock = function (elm) {\n      return elm && /^(OL|UL|LI)$/.test(elm.nodeName);\n    };\n    var isNestedList = function (elm) {\n      return isListBlock(elm) && isListBlock(elm.parentNode);\n    };\n    var getContainerBlock = function (containerBlock) {\n      var containerBlockParent = containerBlock.parentNode;\n      if (/^(LI|DT|DD)$/.test(containerBlockParent.nodeName)) {\n        return containerBlockParent;\n      }\n      return containerBlock;\n    };\n    var isFirstOrLastLi = function (containerBlock, parentBlock, first) {\n      var node = containerBlock[first ? 'firstChild' : 'lastChild'];\n      while (node) {\n        if (NodeType.isElement(node)) {\n          break;\n        }\n        node = node[first ? 'nextSibling' : 'previousSibling'];\n      }\n      return node === parentBlock;\n    };\n    var insert = function (editor, createNewBlock, containerBlock, parentBlock, newBlockName) {\n      var dom = editor.dom;\n      var rng = editor.selection.getRng();\n      if (containerBlock === editor.getBody()) {\n        return;\n      }\n      if (isNestedList(containerBlock)) {\n        newBlockName = 'LI';\n      }\n      var newBlock = newBlockName ? createNewBlock(newBlockName) : dom.create('BR');\n      if (isFirstOrLastLi(containerBlock, parentBlock, true) && isFirstOrLastLi(containerBlock, parentBlock, false)) {\n        if (hasParent$1(containerBlock, 'LI')) {\n          dom.insertAfter(newBlock, getContainerBlock(containerBlock));\n        } else {\n          dom.replace(newBlock, containerBlock);\n        }\n      } else if (isFirstOrLastLi(containerBlock, parentBlock, true)) {\n        if (hasParent$1(containerBlock, 'LI')) {\n          dom.insertAfter(newBlock, getContainerBlock(containerBlock));\n          newBlock.appendChild(dom.doc.createTextNode(' '));\n          newBlock.appendChild(containerBlock);\n        } else {\n          containerBlock.parentNode.insertBefore(newBlock, containerBlock);\n        }\n      } else if (isFirstOrLastLi(containerBlock, parentBlock, false)) {\n        dom.insertAfter(newBlock, getContainerBlock(containerBlock));\n      } else {\n        containerBlock = getContainerBlock(containerBlock);\n        var tmpRng = rng.cloneRange();\n        tmpRng.setStartAfter(parentBlock);\n        tmpRng.setEndAfter(containerBlock);\n        var fragment = tmpRng.extractContents();\n        if (newBlockName === 'LI' && hasFirstChild(fragment, 'LI')) {\n          newBlock = fragment.firstChild;\n          dom.insertAfter(fragment, containerBlock);\n        } else {\n          dom.insertAfter(fragment, containerBlock);\n          dom.insertAfter(newBlock, containerBlock);\n        }\n      }\n      dom.remove(parentBlock);\n      NewLineUtils.moveToCaretPosition(editor, newBlock);\n    };\n    var InsertLi = { insert: insert };\n\n    var trimZwsp = function (fragment) {\n      each(descendants(Element.fromDom(fragment), isText), function (text) {\n        var rawNode = text.dom();\n        rawNode.nodeValue = Zwsp.trim(rawNode.nodeValue);\n      });\n    };\n    var isEmptyAnchor = function (dom, elm) {\n      return elm && elm.nodeName === 'A' && dom.isEmpty(elm);\n    };\n    var isTableCell$4 = function (node) {\n      return node && /^(TD|TH|CAPTION)$/.test(node.nodeName);\n    };\n    var emptyBlock = function (elm) {\n      elm.innerHTML = '<br data-mce-bogus=\"1\">';\n    };\n    var containerAndSiblingName = function (container, nodeName) {\n      return container.nodeName === nodeName || container.previousSibling && container.previousSibling.nodeName === nodeName;\n    };\n    var canSplitBlock = function (dom, node) {\n      return node && dom.isBlock(node) && !/^(TD|TH|CAPTION|FORM)$/.test(node.nodeName) && !/^(fixed|absolute)/i.test(node.style.position) && dom.getContentEditable(node) !== 'true';\n    };\n    var trimInlineElementsOnLeftSideOfBlock = function (dom, nonEmptyElementsMap, block) {\n      var node = block;\n      var firstChilds = [];\n      var i;\n      if (!node) {\n        return;\n      }\n      while (node = node.firstChild) {\n        if (dom.isBlock(node)) {\n          return;\n        }\n        if (NodeType.isElement(node) && !nonEmptyElementsMap[node.nodeName.toLowerCase()]) {\n          firstChilds.push(node);\n        }\n      }\n      i = firstChilds.length;\n      while (i--) {\n        node = firstChilds[i];\n        if (!node.hasChildNodes() || node.firstChild === node.lastChild && node.firstChild.nodeValue === '') {\n          dom.remove(node);\n        } else {\n          if (isEmptyAnchor(dom, node)) {\n            dom.remove(node);\n          }\n        }\n      }\n    };\n    var normalizeZwspOffset = function (start, container, offset) {\n      if (NodeType.isText(container) === false) {\n        return offset;\n      } else if (start) {\n        return offset === 1 && container.data.charAt(offset - 1) === Zwsp.ZWSP ? 0 : offset;\n      } else {\n        return offset === container.data.length - 1 && container.data.charAt(offset) === Zwsp.ZWSP ? container.data.length : offset;\n      }\n    };\n    var includeZwspInRange = function (rng) {\n      var newRng = rng.cloneRange();\n      newRng.setStart(rng.startContainer, normalizeZwspOffset(true, rng.startContainer, rng.startOffset));\n      newRng.setEnd(rng.endContainer, normalizeZwspOffset(false, rng.endContainer, rng.endOffset));\n      return newRng;\n    };\n    var trimLeadingLineBreaks = function (node) {\n      do {\n        if (NodeType.isText(node)) {\n          node.nodeValue = node.nodeValue.replace(/^[\\r\\n]+/, '');\n        }\n        node = node.firstChild;\n      } while (node);\n    };\n    var getEditableRoot$1 = function (dom, node) {\n      var root = dom.getRoot();\n      var parent, editableRoot;\n      parent = node;\n      while (parent !== root && dom.getContentEditable(parent) !== 'false') {\n        if (dom.getContentEditable(parent) === 'true') {\n          editableRoot = parent;\n        }\n        parent = parent.parentNode;\n      }\n      return parent !== root ? editableRoot : root;\n    };\n    var setForcedBlockAttrs = function (editor, node) {\n      var forcedRootBlockName = Settings.getForcedRootBlock(editor);\n      if (forcedRootBlockName && forcedRootBlockName.toLowerCase() === node.tagName.toLowerCase()) {\n        editor.dom.setAttribs(node, Settings.getForcedRootBlockAttrs(editor));\n      }\n    };\n    var wrapSelfAndSiblingsInDefaultBlock = function (editor, newBlockName, rng, container, offset) {\n      var newBlock, parentBlock, startNode, node, next, rootBlockName;\n      var blockName = newBlockName || 'P';\n      var dom = editor.dom, editableRoot = getEditableRoot$1(dom, container);\n      parentBlock = dom.getParent(container, dom.isBlock);\n      if (!parentBlock || !canSplitBlock(dom, parentBlock)) {\n        parentBlock = parentBlock || editableRoot;\n        if (parentBlock === editor.getBody() || isTableCell$4(parentBlock)) {\n          rootBlockName = parentBlock.nodeName.toLowerCase();\n        } else {\n          rootBlockName = parentBlock.parentNode.nodeName.toLowerCase();\n        }\n        if (!parentBlock.hasChildNodes()) {\n          newBlock = dom.create(blockName);\n          setForcedBlockAttrs(editor, newBlock);\n          parentBlock.appendChild(newBlock);\n          rng.setStart(newBlock, 0);\n          rng.setEnd(newBlock, 0);\n          return newBlock;\n        }\n        node = container;\n        while (node.parentNode !== parentBlock) {\n          node = node.parentNode;\n        }\n        while (node && !dom.isBlock(node)) {\n          startNode = node;\n          node = node.previousSibling;\n        }\n        if (startNode && editor.schema.isValidChild(rootBlockName, blockName.toLowerCase())) {\n          newBlock = dom.create(blockName);\n          setForcedBlockAttrs(editor, newBlock);\n          startNode.parentNode.insertBefore(newBlock, startNode);\n          node = startNode;\n          while (node && !dom.isBlock(node)) {\n            next = node.nextSibling;\n            newBlock.appendChild(node);\n            node = next;\n          }\n          rng.setStart(container, offset);\n          rng.setEnd(container, offset);\n        }\n      }\n      return container;\n    };\n    var addBrToBlockIfNeeded = function (dom, block) {\n      var lastChild;\n      block.normalize();\n      lastChild = block.lastChild;\n      if (!lastChild || /^(left|right)$/gi.test(dom.getStyle(lastChild, 'float', true))) {\n        dom.add(block, 'br');\n      }\n    };\n    var insert$1 = function (editor, evt) {\n      var tmpRng, editableRoot, container, offset, parentBlock, shiftKey;\n      var newBlock, fragment, containerBlock, parentBlockName, containerBlockName, newBlockName, isAfterLastNodeInContainer;\n      var dom = editor.dom;\n      var schema = editor.schema, nonEmptyElementsMap = schema.getNonEmptyElements();\n      var rng = editor.selection.getRng();\n      var createNewBlock = function (name) {\n        var node = container, block, clonedNode, caretNode;\n        var textInlineElements = schema.getTextInlineElements();\n        if (name || parentBlockName === 'TABLE' || parentBlockName === 'HR') {\n          block = dom.create(name || newBlockName);\n          setForcedBlockAttrs(editor, block);\n        } else {\n          block = parentBlock.cloneNode(false);\n        }\n        caretNode = block;\n        if (Settings.shouldKeepStyles(editor) === false) {\n          dom.setAttrib(block, 'style', null);\n          dom.setAttrib(block, 'class', null);\n        } else {\n          do {\n            if (textInlineElements[node.nodeName]) {\n              if (isCaretNode(node) || Bookmarks.isBookmarkNode(node)) {\n                continue;\n              }\n              clonedNode = node.cloneNode(false);\n              dom.setAttrib(clonedNode, 'id', '');\n              if (block.hasChildNodes()) {\n                clonedNode.appendChild(block.firstChild);\n                block.appendChild(clonedNode);\n              } else {\n                caretNode = clonedNode;\n                block.appendChild(clonedNode);\n              }\n            }\n          } while ((node = node.parentNode) && node !== editableRoot);\n        }\n        emptyBlock(caretNode);\n        return block;\n      };\n      var isCaretAtStartOrEndOfBlock = function (start) {\n        var node, name;\n        var normalizedOffset = normalizeZwspOffset(start, container, offset);\n        if (NodeType.isText(container) && (start ? normalizedOffset > 0 : normalizedOffset < container.nodeValue.length)) {\n          return false;\n        }\n        if (container.parentNode === parentBlock && isAfterLastNodeInContainer && !start) {\n          return true;\n        }\n        if (start && NodeType.isElement(container) && container === parentBlock.firstChild) {\n          return true;\n        }\n        if (containerAndSiblingName(container, 'TABLE') || containerAndSiblingName(container, 'HR')) {\n          return isAfterLastNodeInContainer && !start || !isAfterLastNodeInContainer && start;\n        }\n        var walker = new TreeWalker(container, parentBlock);\n        if (NodeType.isText(container)) {\n          if (start && normalizedOffset === 0) {\n            walker.prev();\n          } else if (!start && normalizedOffset === container.nodeValue.length) {\n            walker.next();\n          }\n        }\n        while (node = walker.current()) {\n          if (NodeType.isElement(node)) {\n            if (!node.getAttribute('data-mce-bogus')) {\n              name = node.nodeName.toLowerCase();\n              if (nonEmptyElementsMap[name] && name !== 'br') {\n                return false;\n              }\n            }\n          } else if (NodeType.isText(node) && !/^[ \\t\\r\\n]*$/.test(node.nodeValue)) {\n            return false;\n          }\n          if (start) {\n            walker.prev();\n          } else {\n            walker.next();\n          }\n        }\n        return true;\n      };\n      var insertNewBlockAfter = function () {\n        if (/^(H[1-6]|PRE|FIGURE)$/.test(parentBlockName) && containerBlockName !== 'HGROUP') {\n          newBlock = createNewBlock(newBlockName);\n        } else {\n          newBlock = createNewBlock();\n        }\n        if (Settings.shouldEndContainerOnEmptyBlock(editor) && canSplitBlock(dom, containerBlock) && dom.isEmpty(parentBlock)) {\n          newBlock = dom.split(containerBlock, parentBlock);\n        } else {\n          dom.insertAfter(newBlock, parentBlock);\n        }\n        NewLineUtils.moveToCaretPosition(editor, newBlock);\n      };\n      NormalizeRange.normalize(dom, rng).each(function (normRng) {\n        rng.setStart(normRng.startContainer, normRng.startOffset);\n        rng.setEnd(normRng.endContainer, normRng.endOffset);\n      });\n      container = rng.startContainer;\n      offset = rng.startOffset;\n      newBlockName = Settings.getForcedRootBlock(editor);\n      shiftKey = !!(evt && evt.shiftKey);\n      var ctrlKey = !!(evt && evt.ctrlKey);\n      if (NodeType.isElement(container) && container.hasChildNodes()) {\n        isAfterLastNodeInContainer = offset > container.childNodes.length - 1;\n        container = container.childNodes[Math.min(offset, container.childNodes.length - 1)] || container;\n        if (isAfterLastNodeInContainer && NodeType.isText(container)) {\n          offset = container.nodeValue.length;\n        } else {\n          offset = 0;\n        }\n      }\n      editableRoot = getEditableRoot$1(dom, container);\n      if (!editableRoot) {\n        return;\n      }\n      if (newBlockName && !shiftKey || !newBlockName && shiftKey) {\n        container = wrapSelfAndSiblingsInDefaultBlock(editor, newBlockName, rng, container, offset);\n      }\n      parentBlock = dom.getParent(container, dom.isBlock);\n      containerBlock = parentBlock ? dom.getParent(parentBlock.parentNode, dom.isBlock) : null;\n      parentBlockName = parentBlock ? parentBlock.nodeName.toUpperCase() : '';\n      containerBlockName = containerBlock ? containerBlock.nodeName.toUpperCase() : '';\n      if (containerBlockName === 'LI' && !ctrlKey) {\n        parentBlock = containerBlock;\n        containerBlock = containerBlock.parentNode;\n        parentBlockName = containerBlockName;\n      }\n      if (/^(LI|DT|DD)$/.test(parentBlockName)) {\n        if (dom.isEmpty(parentBlock)) {\n          InsertLi.insert(editor, createNewBlock, containerBlock, parentBlock, newBlockName);\n          return;\n        }\n      }\n      if (newBlockName && parentBlock === editor.getBody()) {\n        return;\n      }\n      newBlockName = newBlockName || 'P';\n      if (isCaretContainerBlock(parentBlock)) {\n        newBlock = showCaretContainerBlock(parentBlock);\n        if (dom.isEmpty(parentBlock)) {\n          emptyBlock(parentBlock);\n        }\n        NewLineUtils.moveToCaretPosition(editor, newBlock);\n      } else if (isCaretAtStartOrEndOfBlock()) {\n        insertNewBlockAfter();\n      } else if (isCaretAtStartOrEndOfBlock(true)) {\n        newBlock = parentBlock.parentNode.insertBefore(createNewBlock(), parentBlock);\n        NewLineUtils.moveToCaretPosition(editor, containerAndSiblingName(parentBlock, 'HR') ? newBlock : parentBlock);\n      } else {\n        tmpRng = includeZwspInRange(rng).cloneRange();\n        tmpRng.setEndAfter(parentBlock);\n        fragment = tmpRng.extractContents();\n        trimZwsp(fragment);\n        trimLeadingLineBreaks(fragment);\n        newBlock = fragment.firstChild;\n        dom.insertAfter(fragment, parentBlock);\n        trimInlineElementsOnLeftSideOfBlock(dom, nonEmptyElementsMap, newBlock);\n        addBrToBlockIfNeeded(dom, parentBlock);\n        if (dom.isEmpty(parentBlock)) {\n          emptyBlock(parentBlock);\n        }\n        newBlock.normalize();\n        if (dom.isEmpty(newBlock)) {\n          dom.remove(newBlock);\n          insertNewBlockAfter();\n        } else {\n          NewLineUtils.moveToCaretPosition(editor, newBlock);\n        }\n      }\n      dom.setAttrib(newBlock, 'id', '');\n      editor.fire('NewBlock', { newBlock: newBlock });\n    };\n    var InsertBlock = { insert: insert$1 };\n\n    var hasRightSideContent = function (schema, container, parentBlock) {\n      var walker = new TreeWalker(container, parentBlock);\n      var node;\n      var nonEmptyElementsMap = schema.getNonEmptyElements();\n      while (node = walker.next()) {\n        if (nonEmptyElementsMap[node.nodeName.toLowerCase()] || node.length > 0) {\n          return true;\n        }\n      }\n    };\n    var scrollToBr = function (dom, selection, brElm) {\n      var marker = dom.create('span', {}, '&nbsp;');\n      brElm.parentNode.insertBefore(marker, brElm);\n      selection.scrollIntoView(marker);\n      dom.remove(marker);\n    };\n    var moveSelectionToBr = function (dom, selection, brElm, extraBr) {\n      var rng = dom.createRng();\n      if (!extraBr) {\n        rng.setStartAfter(brElm);\n        rng.setEndAfter(brElm);\n      } else {\n        rng.setStartBefore(brElm);\n        rng.setEndBefore(brElm);\n      }\n      selection.setRng(rng);\n    };\n    var insertBrAtCaret = function (editor, evt) {\n      var selection = editor.selection;\n      var dom = editor.dom;\n      var rng = selection.getRng();\n      var brElm;\n      var extraBr;\n      NormalizeRange.normalize(dom, rng).each(function (normRng) {\n        rng.setStart(normRng.startContainer, normRng.startOffset);\n        rng.setEnd(normRng.endContainer, normRng.endOffset);\n      });\n      var offset = rng.startOffset;\n      var container = rng.startContainer;\n      if (container.nodeType === 1 && container.hasChildNodes()) {\n        var isAfterLastNodeInContainer = offset > container.childNodes.length - 1;\n        container = container.childNodes[Math.min(offset, container.childNodes.length - 1)] || container;\n        if (isAfterLastNodeInContainer && container.nodeType === 3) {\n          offset = container.nodeValue.length;\n        } else {\n          offset = 0;\n        }\n      }\n      var parentBlock = dom.getParent(container, dom.isBlock);\n      var containerBlock = parentBlock ? dom.getParent(parentBlock.parentNode, dom.isBlock) : null;\n      var containerBlockName = containerBlock ? containerBlock.nodeName.toUpperCase() : '';\n      var isControlKey = !!(evt && evt.ctrlKey);\n      if (containerBlockName === 'LI' && !isControlKey) {\n        parentBlock = containerBlock;\n      }\n      if (container && container.nodeType === 3 && offset >= container.nodeValue.length) {\n        if (!hasRightSideContent(editor.schema, container, parentBlock)) {\n          brElm = dom.create('br');\n          rng.insertNode(brElm);\n          rng.setStartAfter(brElm);\n          rng.setEndAfter(brElm);\n          extraBr = true;\n        }\n      }\n      brElm = dom.create('br');\n      rangeInsertNode(dom, rng, brElm);\n      scrollToBr(dom, selection, brElm);\n      moveSelectionToBr(dom, selection, brElm, extraBr);\n      editor.undoManager.add();\n    };\n    var insertBrBefore = function (editor, inline) {\n      var br = Element.fromTag('br');\n      before(Element.fromDom(inline), br);\n      editor.undoManager.add();\n    };\n    var insertBrAfter = function (editor, inline) {\n      if (!hasBrAfter(editor.getBody(), inline)) {\n        after(Element.fromDom(inline), Element.fromTag('br'));\n      }\n      var br = Element.fromTag('br');\n      after(Element.fromDom(inline), br);\n      scrollToBr(editor.dom, editor.selection, br.dom());\n      moveSelectionToBr(editor.dom, editor.selection, br.dom(), false);\n      editor.undoManager.add();\n    };\n    var isBeforeBr$1 = function (pos) {\n      return NodeType.isBr(pos.getNode());\n    };\n    var hasBrAfter = function (rootNode, startNode) {\n      if (isBeforeBr$1(CaretPosition$1.after(startNode))) {\n        return true;\n      } else {\n        return CaretFinder.nextPosition(rootNode, CaretPosition$1.after(startNode)).map(function (pos) {\n          return NodeType.isBr(pos.getNode());\n        }).getOr(false);\n      }\n    };\n    var isAnchorLink = function (elm) {\n      return elm && elm.nodeName === 'A' && 'href' in elm;\n    };\n    var isInsideAnchor = function (location) {\n      return location.fold(constant(false), isAnchorLink, isAnchorLink, constant(false));\n    };\n    var readInlineAnchorLocation = function (editor) {\n      var isInlineTarget = curry(InlineUtils.isInlineTarget, editor);\n      var position = CaretPosition$1.fromRangeStart(editor.selection.getRng());\n      return BoundaryLocation.readLocation(isInlineTarget, editor.getBody(), position).filter(isInsideAnchor);\n    };\n    var insertBrOutsideAnchor = function (editor, location) {\n      location.fold(noop, curry(insertBrBefore, editor), curry(insertBrAfter, editor), noop);\n    };\n    var insert$2 = function (editor, evt) {\n      var anchorLocation = readInlineAnchorLocation(editor);\n      if (anchorLocation.isSome()) {\n        anchorLocation.each(curry(insertBrOutsideAnchor, editor));\n      } else {\n        insertBrAtCaret(editor, evt);\n      }\n    };\n    var InsertBr = { insert: insert$2 };\n\n    var matchesSelector = function (editor, selector) {\n      return NewLineUtils.getParentBlock(editor).filter(function (parentBlock) {\n        return selector.length > 0 && is(Element.fromDom(parentBlock), selector);\n      }).isSome();\n    };\n    var shouldInsertBr = function (editor) {\n      return matchesSelector(editor, Settings.getBrNewLineSelector(editor));\n    };\n    var shouldBlockNewLine = function (editor) {\n      return matchesSelector(editor, Settings.getNoNewLineSelector(editor));\n    };\n    var ContextSelectors = {\n      shouldInsertBr: shouldInsertBr,\n      shouldBlockNewLine: shouldBlockNewLine\n    };\n\n    var newLineAction = Adt.generate([\n      { br: [] },\n      { block: [] },\n      { none: [] }\n    ]);\n    var shouldBlockNewLine$1 = function (editor, shiftKey) {\n      return ContextSelectors.shouldBlockNewLine(editor);\n    };\n    var isBrMode = function (requiredState) {\n      return function (editor, shiftKey) {\n        var brMode = Settings.getForcedRootBlock(editor) === '';\n        return brMode === requiredState;\n      };\n    };\n    var inListBlock = function (requiredState) {\n      return function (editor, shiftKey) {\n        return NewLineUtils.isListItemParentBlock(editor) === requiredState;\n      };\n    };\n    var inBlock = function (blockName, requiredState) {\n      return function (editor, shiftKey) {\n        var state = NewLineUtils.getParentBlockName(editor) === blockName.toUpperCase();\n        return state === requiredState;\n      };\n    };\n    var inPreBlock = function (requiredState) {\n      return inBlock('pre', requiredState);\n    };\n    var inSummaryBlock = function () {\n      return inBlock('summary', true);\n    };\n    var shouldPutBrInPre$1 = function (requiredState) {\n      return function (editor, shiftKey) {\n        return Settings.shouldPutBrInPre(editor) === requiredState;\n      };\n    };\n    var inBrContext = function (editor, shiftKey) {\n      return ContextSelectors.shouldInsertBr(editor);\n    };\n    var hasShiftKey = function (editor, shiftKey) {\n      return shiftKey;\n    };\n    var canInsertIntoEditableRoot = function (editor) {\n      var forcedRootBlock = Settings.getForcedRootBlock(editor);\n      var rootEditable = NewLineUtils.getEditableRoot(editor.dom, editor.selection.getStart());\n      return rootEditable && editor.schema.isValidChild(rootEditable.nodeName, forcedRootBlock ? forcedRootBlock : 'P');\n    };\n    var match$2 = function (predicates, action) {\n      return function (editor, shiftKey) {\n        var isMatch = foldl(predicates, function (res, p) {\n          return res && p(editor, shiftKey);\n        }, true);\n        return isMatch ? Option.some(action) : Option.none();\n      };\n    };\n    var getAction$1 = function (editor, evt) {\n      return LazyEvaluator.evaluateUntil([\n        match$2([shouldBlockNewLine$1], newLineAction.none()),\n        match$2([inSummaryBlock()], newLineAction.br()),\n        match$2([\n          inPreBlock(true),\n          shouldPutBrInPre$1(false),\n          hasShiftKey\n        ], newLineAction.br()),\n        match$2([\n          inPreBlock(true),\n          shouldPutBrInPre$1(false)\n        ], newLineAction.block()),\n        match$2([\n          inPreBlock(true),\n          shouldPutBrInPre$1(true),\n          hasShiftKey\n        ], newLineAction.block()),\n        match$2([\n          inPreBlock(true),\n          shouldPutBrInPre$1(true)\n        ], newLineAction.br()),\n        match$2([\n          inListBlock(true),\n          hasShiftKey\n        ], newLineAction.br()),\n        match$2([inListBlock(true)], newLineAction.block()),\n        match$2([\n          isBrMode(true),\n          hasShiftKey,\n          canInsertIntoEditableRoot\n        ], newLineAction.block()),\n        match$2([isBrMode(true)], newLineAction.br()),\n        match$2([inBrContext], newLineAction.br()),\n        match$2([\n          isBrMode(false),\n          hasShiftKey\n        ], newLineAction.br()),\n        match$2([canInsertIntoEditableRoot], newLineAction.block())\n      ], [\n        editor,\n        !!(evt && evt.shiftKey)\n      ]).getOr(newLineAction.none());\n    };\n    var NewLineAction = { getAction: getAction$1 };\n\n    var insert$3 = function (editor, evt) {\n      NewLineAction.getAction(editor, evt).fold(function () {\n        InsertBr.insert(editor, evt);\n      }, function () {\n        InsertBlock.insert(editor, evt);\n      }, noop);\n    };\n    var InsertNewLine = { insert: insert$3 };\n\n    var handleEnterKeyEvent = function (editor, event) {\n      if (event.isDefaultPrevented()) {\n        return;\n      }\n      event.preventDefault();\n      endTypingLevelIgnoreLocks(editor.undoManager);\n      editor.undoManager.transact(function () {\n        if (editor.selection.isCollapsed() === false) {\n          editor.execCommand('Delete');\n        }\n        InsertNewLine.insert(editor, event);\n      });\n    };\n    var setup$b = function (editor) {\n      editor.on('keydown', function (event) {\n        if (event.keyCode === VK.ENTER) {\n          handleEnterKeyEvent(editor, event);\n        }\n      });\n    };\n    var EnterKey = { setup: setup$b };\n\n    var insertTextAtPosition = function (text, pos) {\n      var container = pos.container();\n      var offset = pos.offset();\n      if (NodeType.isText(container)) {\n        container.insertData(offset, text);\n        return Option.some(CaretPosition(container, offset + text.length));\n      } else {\n        return getElementFromPosition(pos).map(function (elm) {\n          var textNode = Element.fromText(text);\n          if (pos.isAtEnd()) {\n            after(elm, textNode);\n          } else {\n            before(elm, textNode);\n          }\n          return CaretPosition(textNode.dom(), text.length);\n        });\n      }\n    };\n    var insertNbspAtPosition = curry(insertTextAtPosition, nbsp);\n    var insertSpaceAtPosition = curry(insertTextAtPosition, ' ');\n\n    var isInMiddleOfText = function (pos) {\n      return CaretPosition.isTextPosition(pos) && !pos.isAtStart() && !pos.isAtEnd();\n    };\n    var getClosestBlock$1 = function (root, pos) {\n      var parentBlocks = filter(Parents.parentsAndSelf(Element.fromDom(pos.container()), root), isBlock);\n      return head(parentBlocks).getOr(root);\n    };\n    var hasSpaceBefore = function (root, pos) {\n      if (isInMiddleOfText(pos)) {\n        return isAfterSpace(pos);\n      } else {\n        return isAfterSpace(pos) || CaretFinder.prevPosition(getClosestBlock$1(root, pos).dom(), pos).exists(isAfterSpace);\n      }\n    };\n    var hasSpaceAfter = function (root, pos) {\n      if (isInMiddleOfText(pos)) {\n        return isBeforeSpace(pos);\n      } else {\n        return isBeforeSpace(pos) || CaretFinder.nextPosition(getClosestBlock$1(root, pos).dom(), pos).exists(isBeforeSpace);\n      }\n    };\n    var isPreValue = function (value) {\n      return contains([\n        'pre',\n        'pre-wrap'\n      ], value);\n    };\n    var isInPre = function (pos) {\n      return getElementFromPosition(pos).bind(function (elm) {\n        return closest(elm, isElement);\n      }).exists(function (elm) {\n        return isPreValue(get$4(elm, 'white-space'));\n      });\n    };\n    var isAtBeginningOfBody = function (root, pos) {\n      return CaretFinder.prevPosition(root.dom(), pos).isNone();\n    };\n    var isAtEndOfBody = function (root, pos) {\n      return CaretFinder.nextPosition(root.dom(), pos).isNone();\n    };\n    var isAtLineBoundary = function (root, pos) {\n      return isAtBeginningOfBody(root, pos) || isAtEndOfBody(root, pos) || isAtStartOfBlock(root, pos) || isAtEndOfBlock(root, pos) || isAfterBr(root, pos) || isBeforeBr(root, pos);\n    };\n    var needsToHaveNbsp = function (root, pos) {\n      if (isInPre(pos)) {\n        return false;\n      } else {\n        return isAtLineBoundary(root, pos) || hasSpaceBefore(root, pos) || hasSpaceAfter(root, pos);\n      }\n    };\n    var needsToBeNbspLeft = function (root, pos) {\n      if (isInPre(pos)) {\n        return false;\n      } else {\n        return isAtStartOfBlock(root, pos) || isBeforeBlock(root, pos) || isAfterBr(root, pos) || hasSpaceBefore(root, pos);\n      }\n    };\n    var leanRight = function (pos) {\n      var container = pos.container();\n      var offset = pos.offset();\n      if (NodeType.isText(container) && offset < container.data.length) {\n        return CaretPosition(container, offset + 1);\n      } else {\n        return pos;\n      }\n    };\n    var needsToBeNbspRight = function (root, pos) {\n      var afterPos = leanRight(pos);\n      if (isInPre(afterPos)) {\n        return false;\n      } else {\n        return isAtEndOfBlock(root, afterPos) || isAfterBlock(root, afterPos) || isBeforeBr(root, afterPos) || hasSpaceAfter(root, afterPos);\n      }\n    };\n    var needsToBeNbsp = function (root, pos) {\n      return needsToBeNbspLeft(root, pos) || needsToBeNbspRight(root, pos);\n    };\n    var isNbspAt = function (text, offset) {\n      return isNbsp(text.charAt(offset));\n    };\n    var hasNbsp = function (pos) {\n      var container = pos.container();\n      return NodeType.isText(container) && contains$1(container.data, nbsp);\n    };\n    var normalizeNbspMiddle = function (text) {\n      var chars = text.split('');\n      return map(chars, function (chr, i) {\n        if (isNbsp(chr) && i > 0 && i < chars.length - 1 && isContent(chars[i - 1]) && isContent(chars[i + 1])) {\n          return ' ';\n        } else {\n          return chr;\n        }\n      }).join('');\n    };\n    var normalizeNbspAtStart = function (root, node) {\n      var text = node.data;\n      var firstPos = CaretPosition(node, 0);\n      if (isNbspAt(text, 0) && !needsToBeNbsp(root, firstPos)) {\n        node.data = ' ' + text.slice(1);\n        return true;\n      } else {\n        return false;\n      }\n    };\n    var normalizeNbspInMiddleOfTextNode = function (node) {\n      var text = node.data;\n      var newText = normalizeNbspMiddle(text);\n      if (newText !== text) {\n        node.data = newText;\n        return true;\n      } else {\n        return false;\n      }\n    };\n    var normalizeNbspAtEnd = function (root, node) {\n      var text = node.data;\n      var lastPos = CaretPosition(node, text.length - 1);\n      if (isNbspAt(text, text.length - 1) && !needsToBeNbsp(root, lastPos)) {\n        node.data = text.slice(0, -1) + ' ';\n        return true;\n      } else {\n        return false;\n      }\n    };\n    var normalizeNbsps = function (root, pos) {\n      return Option.some(pos).filter(hasNbsp).bind(function (pos) {\n        var container = pos.container();\n        var normalized = normalizeNbspAtStart(root, container) || normalizeNbspInMiddleOfTextNode(container) || normalizeNbspAtEnd(root, container);\n        return normalized ? Option.some(pos) : Option.none();\n      });\n    };\n    var normalizeNbspsInEditor = function (editor) {\n      var root = Element.fromDom(editor.getBody());\n      if (editor.selection.isCollapsed()) {\n        normalizeNbsps(root, CaretPosition.fromRangeStart(editor.selection.getRng())).each(function (pos) {\n          editor.selection.setRng(pos.toRange());\n        });\n      }\n    };\n\n    var locationToCaretPosition = function (root) {\n      return function (location) {\n        return location.fold(function (element) {\n          return CaretFinder.prevPosition(root.dom(), CaretPosition$1.before(element));\n        }, function (element) {\n          return CaretFinder.firstPositionIn(element);\n        }, function (element) {\n          return CaretFinder.lastPositionIn(element);\n        }, function (element) {\n          return CaretFinder.nextPosition(root.dom(), CaretPosition$1.after(element));\n        });\n      };\n    };\n    var insertInlineBoundarySpaceOrNbsp = function (root, pos) {\n      return function (checkPos) {\n        return needsToHaveNbsp(root, checkPos) ? insertNbspAtPosition(pos) : insertSpaceAtPosition(pos);\n      };\n    };\n    var setSelection$1 = function (editor) {\n      return function (pos) {\n        editor.selection.setRng(pos.toRange());\n        editor.nodeChanged();\n        return true;\n      };\n    };\n    var insertSpaceOrNbspAtSelection = function (editor) {\n      var pos = CaretPosition$1.fromRangeStart(editor.selection.getRng());\n      var root = Element.fromDom(editor.getBody());\n      if (editor.selection.isCollapsed()) {\n        var isInlineTarget = curry(InlineUtils.isInlineTarget, editor);\n        var caretPosition = CaretPosition$1.fromRangeStart(editor.selection.getRng());\n        return BoundaryLocation.readLocation(isInlineTarget, editor.getBody(), caretPosition).bind(locationToCaretPosition(root)).bind(insertInlineBoundarySpaceOrNbsp(root, pos)).exists(setSelection$1(editor));\n      } else {\n        return false;\n      }\n    };\n\n    var executeKeydownOverride$2 = function (editor, evt) {\n      MatchKeys.execute([{\n          keyCode: VK.SPACEBAR,\n          action: MatchKeys.action(insertSpaceOrNbspAtSelection, editor)\n        }], evt).each(function (_) {\n        evt.preventDefault();\n      });\n    };\n    var setup$c = function (editor) {\n      editor.on('keydown', function (evt) {\n        if (evt.isDefaultPrevented() === false) {\n          executeKeydownOverride$2(editor, evt);\n        }\n      });\n    };\n    var SpaceKey = { setup: setup$c };\n\n    var findBlockCaretContainer = function (editor) {\n      return descendant(Element.fromDom(editor.getBody()), '*[data-mce-caret]').fold(constant(null), function (elm) {\n        return elm.dom();\n      });\n    };\n    var removeIeControlRect = function (editor) {\n      editor.selection.setRng(editor.selection.getRng());\n    };\n    var showBlockCaretContainer = function (editor, blockCaretContainer) {\n      if (blockCaretContainer.hasAttribute('data-mce-caret')) {\n        showCaretContainerBlock(blockCaretContainer);\n        removeIeControlRect(editor);\n        editor.selection.scrollIntoView(blockCaretContainer);\n      }\n    };\n    var handleBlockContainer = function (editor, e) {\n      var blockCaretContainer = findBlockCaretContainer(editor);\n      if (!blockCaretContainer) {\n        return;\n      }\n      if (e.type === 'compositionstart') {\n        e.preventDefault();\n        e.stopPropagation();\n        showBlockCaretContainer(editor, blockCaretContainer);\n        return;\n      }\n      if (hasContent(blockCaretContainer)) {\n        showBlockCaretContainer(editor, blockCaretContainer);\n        editor.undoManager.add();\n      }\n    };\n    var setup$d = function (editor) {\n      editor.on('keyup compositionstart', curry(handleBlockContainer, editor));\n    };\n    var CaretContainerInput = { setup: setup$d };\n\n    var browser$5 = detect$3().browser;\n    var setupIeInput = function (editor) {\n      var keypressThrotter = first(function () {\n        if (!editor.composing) {\n          normalizeNbspsInEditor(editor);\n        }\n      }, 0);\n      if (browser$5.isIE()) {\n        editor.on('keypress', function (e) {\n          keypressThrotter.throttle();\n        });\n        editor.on('remove', function (e) {\n          keypressThrotter.cancel();\n        });\n      }\n    };\n    var setup$e = function (editor) {\n      setupIeInput(editor);\n      editor.on('input', function (e) {\n        if (e.isComposing === false) {\n          normalizeNbspsInEditor(editor);\n        }\n      });\n    };\n\n    var executeKeydownOverride$3 = function (editor, evt) {\n      MatchKeys.execute([\n        {\n          keyCode: VK.END,\n          action: moveToLineEndPoint(editor, true)\n        },\n        {\n          keyCode: VK.HOME,\n          action: moveToLineEndPoint(editor, false)\n        }\n      ], evt).each(function (_) {\n        evt.preventDefault();\n      });\n    };\n    var setup$f = function (editor) {\n      editor.on('keydown', function (evt) {\n        if (evt.isDefaultPrevented() === false) {\n          executeKeydownOverride$3(editor, evt);\n        }\n      });\n    };\n    var HomeEndKeys = { setup: setup$f };\n\n    var setup$g = function (editor) {\n      var caret = BoundarySelection.setupSelectedState(editor);\n      CaretContainerInput.setup(editor);\n      ArrowKeys.setup(editor, caret);\n      DeleteBackspaceKeys.setup(editor, caret);\n      EnterKey.setup(editor);\n      SpaceKey.setup(editor);\n      setup$e(editor);\n      HomeEndKeys.setup(editor);\n    };\n    var KeyboardOverrides = { setup: setup$g };\n\n    var NodeChange = function () {\n      function NodeChange(editor) {\n        this.lastPath = [];\n        this.editor = editor;\n        var lastRng;\n        var self = this;\n        if (!('onselectionchange' in editor.getDoc())) {\n          editor.on('NodeChange click mouseup keyup focus', function (e) {\n            var nativeRng, fakeRng;\n            nativeRng = editor.selection.getRng();\n            fakeRng = {\n              startContainer: nativeRng.startContainer,\n              startOffset: nativeRng.startOffset,\n              endContainer: nativeRng.endContainer,\n              endOffset: nativeRng.endOffset\n            };\n            if (e.type === 'nodechange' || !RangeCompare.isEq(fakeRng, lastRng)) {\n              editor.fire('SelectionChange');\n            }\n            lastRng = fakeRng;\n          });\n        }\n        editor.on('contextmenu', function () {\n          editor.fire('SelectionChange');\n        });\n        editor.on('SelectionChange', function () {\n          var startElm = editor.selection.getStart(true);\n          if (!startElm || !Env.range && editor.selection.isCollapsed()) {\n            return;\n          }\n          if (hasAnyRanges(editor) && !self.isSameElementPath(startElm) && editor.dom.isChildOf(startElm, editor.getBody())) {\n            editor.nodeChanged({ selectionChange: true });\n          }\n        });\n        editor.on('mouseup', function (e) {\n          if (!e.isDefaultPrevented() && hasAnyRanges(editor)) {\n            if (editor.selection.getNode().nodeName === 'IMG') {\n              Delay.setEditorTimeout(editor, function () {\n                editor.nodeChanged();\n              });\n            } else {\n              editor.nodeChanged();\n            }\n          }\n        });\n      }\n      NodeChange.prototype.nodeChanged = function (args) {\n        var selection = this.editor.selection;\n        var node, parents, root;\n        if (this.editor.initialized && selection && !this.editor.settings.disable_nodechange && !this.editor.readonly) {\n          root = this.editor.getBody();\n          node = selection.getStart(true) || root;\n          if (node.ownerDocument !== this.editor.getDoc() || !this.editor.dom.isChildOf(node, root)) {\n            node = root;\n          }\n          parents = [];\n          this.editor.dom.getParent(node, function (node) {\n            if (node === root) {\n              return true;\n            }\n            parents.push(node);\n          });\n          args = args || {};\n          args.element = node;\n          args.parents = parents;\n          this.editor.fire('NodeChange', args);\n        }\n      };\n      NodeChange.prototype.isSameElementPath = function (startElm) {\n        var i, currentPath;\n        currentPath = this.editor.$(startElm).parentsUntil(this.editor.getBody()).add(startElm);\n        if (currentPath.length === this.lastPath.length) {\n          for (i = currentPath.length; i >= 0; i--) {\n            if (currentPath[i] !== this.lastPath[i]) {\n              break;\n            }\n          }\n          if (i === -1) {\n            this.lastPath = currentPath;\n            return true;\n          }\n        }\n        this.lastPath = currentPath;\n        return false;\n      };\n      return NodeChange;\n    }();\n\n    var preventSummaryToggle = function (editor) {\n      editor.on('click', function (e) {\n        if (editor.dom.getParent(e.target, 'details')) {\n          e.preventDefault();\n        }\n      });\n    };\n    var filterDetails = function (editor) {\n      editor.parser.addNodeFilter('details', function (elms) {\n        each(elms, function (details) {\n          details.attr('data-mce-open', details.attr('open'));\n          details.attr('open', 'open');\n        });\n      });\n      editor.serializer.addNodeFilter('details', function (elms) {\n        each(elms, function (details) {\n          var open = details.attr('data-mce-open');\n          details.attr('open', isString(open) ? open : null);\n          details.attr('data-mce-open', null);\n        });\n      });\n    };\n    var setup$h = function (editor) {\n      preventSummaryToggle(editor);\n      filterDetails(editor);\n    };\n\n    var isTextBlockNode = function (node) {\n      return NodeType.isElement(node) && isTextBlock(Element.fromDom(node));\n    };\n    var normalizeSelection$1 = function (editor) {\n      var rng = editor.selection.getRng();\n      var startPos = CaretPosition.fromRangeStart(rng);\n      var endPos = CaretPosition.fromRangeEnd(rng);\n      if (CaretPosition.isElementPosition(startPos)) {\n        var container = startPos.container();\n        if (isTextBlockNode(container)) {\n          CaretFinder.firstPositionIn(container).each(function (pos) {\n            return rng.setStart(pos.container(), pos.offset());\n          });\n        }\n      }\n      if (CaretPosition.isElementPosition(endPos)) {\n        var container = startPos.container();\n        if (isTextBlockNode(container)) {\n          CaretFinder.lastPositionIn(container).each(function (pos) {\n            return rng.setEnd(pos.container(), pos.offset());\n          });\n        }\n      }\n      editor.selection.setRng(RangeNormalizer.normalize(rng));\n    };\n    var setup$i = function (editor) {\n      editor.on('click', function (e) {\n        if (e.detail >= 3) {\n          normalizeSelection$1(editor);\n        }\n      });\n    };\n\n    var getAbsolutePosition = function (elm) {\n      var doc, docElem, win, clientRect;\n      clientRect = elm.getBoundingClientRect();\n      doc = elm.ownerDocument;\n      docElem = doc.documentElement;\n      win = doc.defaultView;\n      return {\n        top: clientRect.top + win.pageYOffset - docElem.clientTop,\n        left: clientRect.left + win.pageXOffset - docElem.clientLeft\n      };\n    };\n    var getBodyPosition = function (editor) {\n      return editor.inline ? getAbsolutePosition(editor.getBody()) : {\n        left: 0,\n        top: 0\n      };\n    };\n    var getScrollPosition = function (editor) {\n      var body = editor.getBody();\n      return editor.inline ? {\n        left: body.scrollLeft,\n        top: body.scrollTop\n      } : {\n        left: 0,\n        top: 0\n      };\n    };\n    var getBodyScroll = function (editor) {\n      var body = editor.getBody(), docElm = editor.getDoc().documentElement;\n      var inlineScroll = {\n        left: body.scrollLeft,\n        top: body.scrollTop\n      };\n      var iframeScroll = {\n        left: body.scrollLeft || docElm.scrollLeft,\n        top: body.scrollTop || docElm.scrollTop\n      };\n      return editor.inline ? inlineScroll : iframeScroll;\n    };\n    var getMousePosition = function (editor, event) {\n      if (event.target.ownerDocument !== editor.getDoc()) {\n        var iframePosition = getAbsolutePosition(editor.getContentAreaContainer());\n        var scrollPosition = getBodyScroll(editor);\n        return {\n          left: event.pageX - iframePosition.left + scrollPosition.left,\n          top: event.pageY - iframePosition.top + scrollPosition.top\n        };\n      }\n      return {\n        left: event.pageX,\n        top: event.pageY\n      };\n    };\n    var calculatePosition = function (bodyPosition, scrollPosition, mousePosition) {\n      return {\n        pageX: mousePosition.left - bodyPosition.left + scrollPosition.left,\n        pageY: mousePosition.top - bodyPosition.top + scrollPosition.top\n      };\n    };\n    var calc = function (editor, event) {\n      return calculatePosition(getBodyPosition(editor), getScrollPosition(editor), getMousePosition(editor, event));\n    };\n    var MousePosition = { calc: calc };\n\n    var isContentEditableFalse$a = NodeType.isContentEditableFalse, isContentEditableTrue$4 = NodeType.isContentEditableTrue;\n    var isDraggable = function (rootElm, elm) {\n      return isContentEditableFalse$a(elm) && elm !== rootElm;\n    };\n    var isValidDropTarget = function (editor, targetElement, dragElement) {\n      if (targetElement === dragElement || editor.dom.isChildOf(targetElement, dragElement)) {\n        return false;\n      }\n      return !isContentEditableFalse$a(targetElement);\n    };\n    var cloneElement = function (elm) {\n      var cloneElm = elm.cloneNode(true);\n      cloneElm.removeAttribute('data-mce-selected');\n      return cloneElm;\n    };\n    var createGhost = function (editor, elm, width, height) {\n      var clonedElm = elm.cloneNode(true);\n      editor.dom.setStyles(clonedElm, {\n        width: width,\n        height: height\n      });\n      editor.dom.setAttrib(clonedElm, 'data-mce-selected', null);\n      var ghostElm = editor.dom.create('div', {\n        'class': 'mce-drag-container',\n        'data-mce-bogus': 'all',\n        'unselectable': 'on',\n        'contenteditable': 'false'\n      });\n      editor.dom.setStyles(ghostElm, {\n        position: 'absolute',\n        opacity: 0.5,\n        overflow: 'hidden',\n        border: 0,\n        padding: 0,\n        margin: 0,\n        width: width,\n        height: height\n      });\n      editor.dom.setStyles(clonedElm, {\n        margin: 0,\n        boxSizing: 'border-box'\n      });\n      ghostElm.appendChild(clonedElm);\n      return ghostElm;\n    };\n    var appendGhostToBody = function (ghostElm, bodyElm) {\n      if (ghostElm.parentNode !== bodyElm) {\n        bodyElm.appendChild(ghostElm);\n      }\n    };\n    var moveGhost = function (ghostElm, position, width, height, maxX, maxY) {\n      var overflowX = 0, overflowY = 0;\n      ghostElm.style.left = position.pageX + 'px';\n      ghostElm.style.top = position.pageY + 'px';\n      if (position.pageX + width > maxX) {\n        overflowX = position.pageX + width - maxX;\n      }\n      if (position.pageY + height > maxY) {\n        overflowY = position.pageY + height - maxY;\n      }\n      ghostElm.style.width = width - overflowX + 'px';\n      ghostElm.style.height = height - overflowY + 'px';\n    };\n    var removeElement = function (elm) {\n      if (elm && elm.parentNode) {\n        elm.parentNode.removeChild(elm);\n      }\n    };\n    var isLeftMouseButtonPressed = function (e) {\n      return e.button === 0;\n    };\n    var hasDraggableElement = function (state) {\n      return state.element;\n    };\n    var applyRelPos = function (state, position) {\n      return {\n        pageX: position.pageX - state.relX,\n        pageY: position.pageY + 5\n      };\n    };\n    var start$1 = function (state, editor) {\n      return function (e) {\n        if (isLeftMouseButtonPressed(e)) {\n          var ceElm = find(editor.dom.getParents(e.target), Predicate.or(isContentEditableFalse$a, isContentEditableTrue$4)).getOr(null);\n          if (isDraggable(editor.getBody(), ceElm)) {\n            var elmPos = editor.dom.getPos(ceElm);\n            var bodyElm = editor.getBody();\n            var docElm = editor.getDoc().documentElement;\n            state.element = ceElm;\n            state.screenX = e.screenX;\n            state.screenY = e.screenY;\n            state.maxX = (editor.inline ? bodyElm.scrollWidth : docElm.offsetWidth) - 2;\n            state.maxY = (editor.inline ? bodyElm.scrollHeight : docElm.offsetHeight) - 2;\n            state.relX = e.pageX - elmPos.x;\n            state.relY = e.pageY - elmPos.y;\n            state.width = ceElm.offsetWidth;\n            state.height = ceElm.offsetHeight;\n            state.ghost = createGhost(editor, ceElm, state.width, state.height);\n          }\n        }\n      };\n    };\n    var move$1 = function (state, editor) {\n      var throttledPlaceCaretAt = Delay.throttle(function (clientX, clientY) {\n        editor._selectionOverrides.hideFakeCaret();\n        editor.selection.placeCaretAt(clientX, clientY);\n      }, 0);\n      return function (e) {\n        var movement = Math.max(Math.abs(e.screenX - state.screenX), Math.abs(e.screenY - state.screenY));\n        if (hasDraggableElement(state) && !state.dragging && movement > 10) {\n          var args = editor.fire('dragstart', { target: state.element });\n          if (args.isDefaultPrevented()) {\n            return;\n          }\n          state.dragging = true;\n          editor.focus();\n        }\n        if (state.dragging) {\n          var targetPos = applyRelPos(state, MousePosition.calc(editor, e));\n          appendGhostToBody(state.ghost, editor.getBody());\n          moveGhost(state.ghost, targetPos, state.width, state.height, state.maxX, state.maxY);\n          throttledPlaceCaretAt(e.clientX, e.clientY);\n        }\n      };\n    };\n    var getRawTarget = function (selection) {\n      var rng = selection.getSel().getRangeAt(0);\n      var startContainer = rng.startContainer;\n      return startContainer.nodeType === 3 ? startContainer.parentNode : startContainer;\n    };\n    var drop = function (state, editor) {\n      return function (e) {\n        if (state.dragging) {\n          if (isValidDropTarget(editor, getRawTarget(editor.selection), state.element)) {\n            var targetClone_1 = cloneElement(state.element);\n            var args = editor.fire('drop', {\n              targetClone: targetClone_1,\n              clientX: e.clientX,\n              clientY: e.clientY\n            });\n            if (!args.isDefaultPrevented()) {\n              targetClone_1 = args.targetClone;\n              editor.undoManager.transact(function () {\n                removeElement(state.element);\n                editor.insertContent(editor.dom.getOuterHTML(targetClone_1));\n                editor._selectionOverrides.hideFakeCaret();\n              });\n            }\n          }\n        }\n        removeDragState(state);\n      };\n    };\n    var stop = function (state, editor) {\n      return function () {\n        if (state.dragging) {\n          editor.fire('dragend');\n        }\n        removeDragState(state);\n      };\n    };\n    var removeDragState = function (state) {\n      state.dragging = false;\n      state.element = null;\n      removeElement(state.ghost);\n    };\n    var bindFakeDragEvents = function (editor) {\n      var state = {};\n      var pageDom, dragStartHandler, dragHandler, dropHandler, dragEndHandler, rootDocument;\n      pageDom = DOMUtils$1.DOM;\n      rootDocument = domGlobals.document;\n      dragStartHandler = start$1(state, editor);\n      dragHandler = move$1(state, editor);\n      dropHandler = drop(state, editor);\n      dragEndHandler = stop(state, editor);\n      editor.on('mousedown', dragStartHandler);\n      editor.on('mousemove', dragHandler);\n      editor.on('mouseup', dropHandler);\n      pageDom.bind(rootDocument, 'mousemove', dragHandler);\n      pageDom.bind(rootDocument, 'mouseup', dragEndHandler);\n      editor.on('remove', function () {\n        pageDom.unbind(rootDocument, 'mousemove', dragHandler);\n        pageDom.unbind(rootDocument, 'mouseup', dragEndHandler);\n      });\n    };\n    var blockIeDrop = function (editor) {\n      editor.on('drop', function (e) {\n        var realTarget = typeof e.clientX !== 'undefined' ? editor.getDoc().elementFromPoint(e.clientX, e.clientY) : null;\n        if (isContentEditableFalse$a(realTarget) || isContentEditableFalse$a(editor.dom.getContentEditableParent(realTarget))) {\n          e.preventDefault();\n        }\n      });\n    };\n    var init = function (editor) {\n      bindFakeDragEvents(editor);\n      blockIeDrop(editor);\n    };\n    var DragDropOverrides = { init: init };\n\n    var setup$j = function (editor) {\n      var renderFocusCaret = first(function () {\n        if (!editor.removed && editor.getBody().contains(domGlobals.document.activeElement)) {\n          var rng = editor.selection.getRng();\n          if (rng.collapsed) {\n            var caretRange = renderRangeCaret(editor, editor.selection.getRng(), false);\n            editor.selection.setRng(caretRange);\n          }\n        }\n      }, 0);\n      editor.on('focus', function () {\n        renderFocusCaret.throttle();\n      });\n      editor.on('blur', function () {\n        renderFocusCaret.cancel();\n      });\n    };\n    var CefFocus = { setup: setup$j };\n\n    var isContentEditableTrue$5 = NodeType.isContentEditableTrue;\n    var isContentEditableFalse$b = NodeType.isContentEditableFalse;\n    var getContentEditableRoot$2 = function (editor, node) {\n      var root = editor.getBody();\n      while (node && node !== root) {\n        if (isContentEditableTrue$5(node) || isContentEditableFalse$b(node)) {\n          return node;\n        }\n        node = node.parentNode;\n      }\n      return null;\n    };\n    var SelectionOverrides = function (editor) {\n      var isBlock = function (node) {\n        return editor.dom.isBlock(node);\n      };\n      var rootNode = editor.getBody();\n      var fakeCaret = FakeCaret(editor, rootNode, isBlock, function () {\n        return EditorFocus.hasFocus(editor);\n      });\n      var realSelectionId = 'sel-' + editor.dom.uniqueId();\n      var selectedContentEditableNode;\n      var isFakeSelectionElement = function (elm) {\n        return editor.dom.hasClass(elm, 'mce-offscreen-selection');\n      };\n      var getRealSelectionElement = function () {\n        var container = editor.dom.get(realSelectionId);\n        return container ? container.getElementsByTagName('*')[0] : container;\n      };\n      var setRange = function (range) {\n        if (range) {\n          editor.selection.setRng(range);\n        }\n      };\n      var getRange = function () {\n        return editor.selection.getRng();\n      };\n      var showCaret = function (direction, node, before, scrollIntoView) {\n        if (scrollIntoView === void 0) {\n          scrollIntoView = true;\n        }\n        var e;\n        e = editor.fire('ShowCaret', {\n          target: node,\n          direction: direction,\n          before: before\n        });\n        if (e.isDefaultPrevented()) {\n          return null;\n        }\n        if (scrollIntoView) {\n          editor.selection.scrollIntoView(node, direction === -1);\n        }\n        return fakeCaret.show(before, node);\n      };\n      var showBlockCaretContainer = function (blockCaretContainer) {\n        if (blockCaretContainer.hasAttribute('data-mce-caret')) {\n          showCaretContainerBlock(blockCaretContainer);\n          setRange(getRange());\n          editor.selection.scrollIntoView(blockCaretContainer);\n        }\n      };\n      var registerEvents = function () {\n        editor.on('mouseup', function (e) {\n          var range = getRange();\n          if (range.collapsed && EditorView.isXYInContentArea(editor, e.clientX, e.clientY)) {\n            setRange(renderCaretAtRange(editor, range, false));\n          }\n        });\n        editor.on('click', function (e) {\n          var contentEditableRoot;\n          contentEditableRoot = getContentEditableRoot$2(editor, e.target);\n          if (contentEditableRoot) {\n            if (isContentEditableFalse$b(contentEditableRoot)) {\n              e.preventDefault();\n              editor.focus();\n            }\n            if (isContentEditableTrue$5(contentEditableRoot)) {\n              if (editor.dom.isChildOf(contentEditableRoot, editor.selection.getNode())) {\n                removeContentEditableSelection();\n              }\n            }\n          }\n        });\n        editor.on('blur NewBlock', function () {\n          removeContentEditableSelection();\n        });\n        editor.on('ResizeWindow FullscreenStateChanged', function () {\n          return fakeCaret.reposition();\n        });\n        var handleTouchSelect = function (editor) {\n          editor.on('tap', function (e) {\n            var contentEditableRoot = getContentEditableRoot$2(editor, e.target);\n            if (isContentEditableFalse$b(contentEditableRoot)) {\n              e.preventDefault();\n              setContentEditableSelection(selectNode(editor, contentEditableRoot));\n            }\n          }, true);\n        };\n        var hasNormalCaretPosition = function (elm) {\n          var caretWalker = CaretWalker(elm);\n          if (!elm.firstChild) {\n            return false;\n          }\n          var startPos = CaretPosition$1.before(elm.firstChild);\n          var newPos = caretWalker.next(startPos);\n          return newPos && !isBeforeContentEditableFalse(newPos) && !isAfterContentEditableFalse(newPos);\n        };\n        var isInSameBlock = function (node1, node2) {\n          var block1 = editor.dom.getParent(node1, editor.dom.isBlock);\n          var block2 = editor.dom.getParent(node2, editor.dom.isBlock);\n          return block1 === block2;\n        };\n        var hasBetterMouseTarget = function (targetNode, caretNode) {\n          var targetBlock = editor.dom.getParent(targetNode, editor.dom.isBlock);\n          var caretBlock = editor.dom.getParent(caretNode, editor.dom.isBlock);\n          if (targetBlock && editor.dom.isChildOf(targetBlock, caretBlock) && isContentEditableFalse$b(getContentEditableRoot$2(editor, targetBlock)) === false) {\n            return true;\n          }\n          return targetBlock && !isInSameBlock(targetBlock, caretBlock) && hasNormalCaretPosition(targetBlock);\n        };\n        handleTouchSelect(editor);\n        editor.on('mousedown', function (e) {\n          var contentEditableRoot;\n          var targetElm = e.target;\n          if (targetElm !== rootNode && targetElm.nodeName !== 'HTML' && !editor.dom.isChildOf(targetElm, rootNode)) {\n            return;\n          }\n          if (EditorView.isXYInContentArea(editor, e.clientX, e.clientY) === false) {\n            return;\n          }\n          contentEditableRoot = getContentEditableRoot$2(editor, targetElm);\n          if (contentEditableRoot) {\n            if (isContentEditableFalse$b(contentEditableRoot)) {\n              e.preventDefault();\n              setContentEditableSelection(selectNode(editor, contentEditableRoot));\n            } else {\n              removeContentEditableSelection();\n              if (!(isContentEditableTrue$5(contentEditableRoot) && e.shiftKey) && !RangePoint.isXYWithinRange(e.clientX, e.clientY, editor.selection.getRng())) {\n                hideFakeCaret();\n                editor.selection.placeCaretAt(e.clientX, e.clientY);\n              }\n            }\n          } else if (isFakeCaretTarget(targetElm) === false) {\n            removeContentEditableSelection();\n            hideFakeCaret();\n            var caretInfo = closestCaret(rootNode, e.clientX, e.clientY);\n            if (caretInfo) {\n              if (!hasBetterMouseTarget(e.target, caretInfo.node)) {\n                e.preventDefault();\n                var range = showCaret(1, caretInfo.node, caretInfo.before, false);\n                editor.getBody().focus();\n                setRange(range);\n              }\n            }\n          }\n        });\n        editor.on('keypress', function (e) {\n          if (VK.modifierPressed(e)) {\n            return;\n          }\n          switch (e.keyCode) {\n          default:\n            if (isContentEditableFalse$b(editor.selection.getNode())) {\n              e.preventDefault();\n            }\n            break;\n          }\n        });\n        editor.on('GetSelectionRange', function (e) {\n          var rng = e.range;\n          if (selectedContentEditableNode) {\n            if (!selectedContentEditableNode.parentNode) {\n              selectedContentEditableNode = null;\n              return;\n            }\n            rng = rng.cloneRange();\n            rng.selectNode(selectedContentEditableNode);\n            e.range = rng;\n          }\n        });\n        editor.on('SetSelectionRange', function (e) {\n          e.range = normalizeShortEndedElementSelection(e.range);\n          var rng = setContentEditableSelection(e.range, e.forward);\n          if (rng) {\n            e.range = rng;\n          }\n        });\n        var isPasteBin = function (node) {\n          return node.id === 'mcepastebin';\n        };\n        editor.on('AfterSetSelectionRange', function (e) {\n          var rng = e.range;\n          if (!isRangeInCaretContainer(rng) && !isPasteBin(rng.startContainer.parentNode)) {\n            hideFakeCaret();\n          }\n          if (!isFakeSelectionElement(rng.startContainer.parentNode)) {\n            removeContentEditableSelection();\n          }\n        });\n        editor.on('copy', function (e) {\n          var clipboardData = e.clipboardData;\n          if (!e.isDefaultPrevented() && e.clipboardData && !Env.ie) {\n            var realSelectionElement = getRealSelectionElement();\n            if (realSelectionElement) {\n              e.preventDefault();\n              clipboardData.clearData();\n              clipboardData.setData('text/html', realSelectionElement.outerHTML);\n              clipboardData.setData('text/plain', realSelectionElement.outerText);\n            }\n          }\n        });\n        DragDropOverrides.init(editor);\n        CefFocus.setup(editor);\n      };\n      var isWithinCaretContainer = function (node) {\n        return isCaretContainer(node) || startsWithCaretContainer(node) || endsWithCaretContainer(node);\n      };\n      var isRangeInCaretContainer = function (rng) {\n        return isWithinCaretContainer(rng.startContainer) || isWithinCaretContainer(rng.endContainer);\n      };\n      var normalizeShortEndedElementSelection = function (rng) {\n        var shortEndedElements = editor.schema.getShortEndedElements();\n        var newRng = editor.dom.createRng();\n        var startContainer = rng.startContainer;\n        var startOffset = rng.startOffset;\n        var endContainer = rng.endContainer;\n        var endOffset = rng.endOffset;\n        if (has(shortEndedElements, startContainer.nodeName.toLowerCase())) {\n          if (startOffset === 0) {\n            newRng.setStartBefore(startContainer);\n          } else {\n            newRng.setStartAfter(startContainer);\n          }\n        } else {\n          newRng.setStart(startContainer, startOffset);\n        }\n        if (has(shortEndedElements, endContainer.nodeName.toLowerCase())) {\n          if (endOffset === 0) {\n            newRng.setEndBefore(endContainer);\n          } else {\n            newRng.setEndAfter(endContainer);\n          }\n        } else {\n          newRng.setEnd(endContainer, endOffset);\n        }\n        return newRng;\n      };\n      var setContentEditableSelection = function (range, forward) {\n        var node;\n        var $ = editor.$;\n        var dom = editor.dom;\n        var $realSelectionContainer, sel, startContainer, startOffset, endOffset, e, caretPosition, targetClone, origTargetClone;\n        if (!range) {\n          return null;\n        }\n        if (range.collapsed) {\n          if (!isRangeInCaretContainer(range)) {\n            if (forward === false) {\n              caretPosition = getNormalizedRangeEndPoint(-1, rootNode, range);\n              if (isFakeCaretTarget(caretPosition.getNode(true))) {\n                return showCaret(-1, caretPosition.getNode(true), false, false);\n              }\n              if (isFakeCaretTarget(caretPosition.getNode())) {\n                return showCaret(-1, caretPosition.getNode(), !caretPosition.isAtEnd(), false);\n              }\n            } else {\n              caretPosition = getNormalizedRangeEndPoint(1, rootNode, range);\n              if (isFakeCaretTarget(caretPosition.getNode())) {\n                return showCaret(1, caretPosition.getNode(), !caretPosition.isAtEnd(), false);\n              }\n              if (isFakeCaretTarget(caretPosition.getNode(true))) {\n                return showCaret(1, caretPosition.getNode(true), false, false);\n              }\n            }\n          }\n          return null;\n        }\n        startContainer = range.startContainer;\n        startOffset = range.startOffset;\n        endOffset = range.endOffset;\n        if (startContainer.nodeType === 3 && startOffset === 0 && isContentEditableFalse$b(startContainer.parentNode)) {\n          startContainer = startContainer.parentNode;\n          startOffset = dom.nodeIndex(startContainer);\n          startContainer = startContainer.parentNode;\n        }\n        if (startContainer.nodeType !== 1) {\n          return null;\n        }\n        if (endOffset === startOffset + 1 && startContainer === range.endContainer) {\n          node = startContainer.childNodes[startOffset];\n        }\n        if (!isContentEditableFalse$b(node)) {\n          return null;\n        }\n        targetClone = origTargetClone = node.cloneNode(true);\n        e = editor.fire('ObjectSelected', {\n          target: node,\n          targetClone: targetClone\n        });\n        if (e.isDefaultPrevented()) {\n          return null;\n        }\n        $realSelectionContainer = descendant(Element.fromDom(editor.getBody()), '#' + realSelectionId).fold(function () {\n          return $([]);\n        }, function (elm) {\n          return $([elm.dom()]);\n        });\n        targetClone = e.targetClone;\n        if ($realSelectionContainer.length === 0) {\n          $realSelectionContainer = $('<div data-mce-bogus=\"all\" class=\"mce-offscreen-selection\"></div>').attr('id', realSelectionId);\n          $realSelectionContainer.appendTo(editor.getBody());\n        }\n        range = editor.dom.createRng();\n        if (targetClone === origTargetClone && Env.ie) {\n          $realSelectionContainer.empty().append('<p style=\"font-size: 0\" data-mce-bogus=\"all\">\\xA0</p>').append(targetClone);\n          range.setStartAfter($realSelectionContainer[0].firstChild.firstChild);\n          range.setEndAfter(targetClone);\n        } else {\n          $realSelectionContainer.empty().append(nbsp).append(targetClone).append(nbsp);\n          range.setStart($realSelectionContainer[0].firstChild, 1);\n          range.setEnd($realSelectionContainer[0].lastChild, 0);\n        }\n        $realSelectionContainer.css({ top: dom.getPos(node, editor.getBody()).y });\n        $realSelectionContainer[0].focus();\n        sel = editor.selection.getSel();\n        sel.removeAllRanges();\n        sel.addRange(range);\n        var nodeElm = Element.fromDom(node);\n        each(descendants$1(Element.fromDom(editor.getBody()), '*[data-mce-selected]'), function (elm) {\n          if (!eq(nodeElm, elm)) {\n            remove$1(elm, 'data-mce-selected');\n          }\n        });\n        if (!editor.dom.getAttrib(node, 'data-mce-selected')) {\n          node.setAttribute('data-mce-selected', '1');\n        }\n        selectedContentEditableNode = node;\n        hideFakeCaret();\n        return range;\n      };\n      var removeContentEditableSelection = function () {\n        if (selectedContentEditableNode) {\n          selectedContentEditableNode.removeAttribute('data-mce-selected');\n          descendant(Element.fromDom(editor.getBody()), '#' + realSelectionId).each(remove);\n          selectedContentEditableNode = null;\n        }\n        descendant(Element.fromDom(editor.getBody()), '#' + realSelectionId).each(remove);\n        selectedContentEditableNode = null;\n      };\n      var destroy = function () {\n        fakeCaret.destroy();\n        selectedContentEditableNode = null;\n      };\n      var hideFakeCaret = function () {\n        fakeCaret.hide();\n      };\n      if (Env.ceFalse) {\n        registerEvents();\n      }\n      return {\n        showCaret: showCaret,\n        showBlockCaretContainer: showBlockCaretContainer,\n        hideFakeCaret: hideFakeCaret,\n        destroy: destroy\n      };\n    };\n\n    var Quirks = function (editor) {\n      var each = Tools.each;\n      var BACKSPACE = VK.BACKSPACE, DELETE = VK.DELETE, dom = editor.dom, selection = editor.selection, settings = editor.settings, parser = editor.parser;\n      var isGecko = Env.gecko, isIE = Env.ie, isWebKit = Env.webkit;\n      var mceInternalUrlPrefix = 'data:text/mce-internal,';\n      var mceInternalDataType = isIE ? 'Text' : 'URL';\n      var setEditorCommandState = function (cmd, state) {\n        try {\n          editor.getDoc().execCommand(cmd, false, state);\n        } catch (ex) {\n        }\n      };\n      var isDefaultPrevented = function (e) {\n        return e.isDefaultPrevented();\n      };\n      var setMceInternalContent = function (e) {\n        var selectionHtml, internalContent;\n        if (e.dataTransfer) {\n          if (editor.selection.isCollapsed() && e.target.tagName === 'IMG') {\n            selection.select(e.target);\n          }\n          selectionHtml = editor.selection.getContent();\n          if (selectionHtml.length > 0) {\n            internalContent = mceInternalUrlPrefix + escape(editor.id) + ',' + escape(selectionHtml);\n            e.dataTransfer.setData(mceInternalDataType, internalContent);\n          }\n        }\n      };\n      var getMceInternalContent = function (e) {\n        var internalContent;\n        if (e.dataTransfer) {\n          internalContent = e.dataTransfer.getData(mceInternalDataType);\n          if (internalContent && internalContent.indexOf(mceInternalUrlPrefix) >= 0) {\n            internalContent = internalContent.substr(mceInternalUrlPrefix.length).split(',');\n            return {\n              id: unescape(internalContent[0]),\n              html: unescape(internalContent[1])\n            };\n          }\n        }\n        return null;\n      };\n      var insertClipboardContents = function (content, internal) {\n        if (editor.queryCommandSupported('mceInsertClipboardContent')) {\n          editor.execCommand('mceInsertClipboardContent', false, {\n            content: content,\n            internal: internal\n          });\n        } else {\n          editor.execCommand('mceInsertContent', false, content);\n        }\n      };\n      var emptyEditorWhenDeleting = function () {\n        var serializeRng = function (rng) {\n          var body = dom.create('body');\n          var contents = rng.cloneContents();\n          body.appendChild(contents);\n          return selection.serializer.serialize(body, { format: 'html' });\n        };\n        var allContentsSelected = function (rng) {\n          var selection = serializeRng(rng);\n          var allRng = dom.createRng();\n          allRng.selectNode(editor.getBody());\n          var allSelection = serializeRng(allRng);\n          return selection === allSelection;\n        };\n        editor.on('keydown', function (e) {\n          var keyCode = e.keyCode;\n          var isCollapsed, body;\n          if (!isDefaultPrevented(e) && (keyCode === DELETE || keyCode === BACKSPACE)) {\n            isCollapsed = editor.selection.isCollapsed();\n            body = editor.getBody();\n            if (isCollapsed && !dom.isEmpty(body)) {\n              return;\n            }\n            if (!isCollapsed && !allContentsSelected(editor.selection.getRng())) {\n              return;\n            }\n            e.preventDefault();\n            editor.setContent('');\n            if (body.firstChild && dom.isBlock(body.firstChild)) {\n              editor.selection.setCursorLocation(body.firstChild, 0);\n            } else {\n              editor.selection.setCursorLocation(body, 0);\n            }\n            editor.nodeChanged();\n          }\n        });\n      };\n      var selectAll = function () {\n        editor.shortcuts.add('meta+a', null, 'SelectAll');\n      };\n      var inputMethodFocus = function () {\n        if (!editor.inline) {\n          dom.bind(editor.getDoc(), 'mousedown mouseup', function (e) {\n            var rng;\n            if (e.target === editor.getDoc().documentElement) {\n              rng = selection.getRng();\n              editor.getBody().focus();\n              if (e.type === 'mousedown') {\n                if (isCaretContainer(rng.startContainer)) {\n                  return;\n                }\n                selection.placeCaretAt(e.clientX, e.clientY);\n              } else {\n                selection.setRng(rng);\n              }\n            }\n          });\n        }\n      };\n      var removeHrOnBackspace = function () {\n        editor.on('keydown', function (e) {\n          if (!isDefaultPrevented(e) && e.keyCode === BACKSPACE) {\n            if (!editor.getBody().getElementsByTagName('hr').length) {\n              return;\n            }\n            if (selection.isCollapsed() && selection.getRng().startOffset === 0) {\n              var node = selection.getNode();\n              var previousSibling = node.previousSibling;\n              if (node.nodeName === 'HR') {\n                dom.remove(node);\n                e.preventDefault();\n                return;\n              }\n              if (previousSibling && previousSibling.nodeName && previousSibling.nodeName.toLowerCase() === 'hr') {\n                dom.remove(previousSibling);\n                e.preventDefault();\n              }\n            }\n          }\n        });\n      };\n      var focusBody = function () {\n        if (!domGlobals.Range.prototype.getClientRects) {\n          editor.on('mousedown', function (e) {\n            if (!isDefaultPrevented(e) && e.target.nodeName === 'HTML') {\n              var body_1 = editor.getBody();\n              body_1.blur();\n              Delay.setEditorTimeout(editor, function () {\n                body_1.focus();\n              });\n            }\n          });\n        }\n      };\n      var selectControlElements = function () {\n        editor.on('click', function (e) {\n          var target = e.target;\n          if (/^(IMG|HR)$/.test(target.nodeName) && dom.getContentEditableParent(target) !== 'false') {\n            e.preventDefault();\n            editor.selection.select(target);\n            editor.nodeChanged();\n          }\n          if (target.nodeName === 'A' && dom.hasClass(target, 'mce-item-anchor')) {\n            e.preventDefault();\n            selection.select(target);\n          }\n        });\n      };\n      var removeStylesWhenDeletingAcrossBlockElements = function () {\n        var getAttributeApplyFunction = function () {\n          var template = dom.getAttribs(selection.getStart().cloneNode(false));\n          return function () {\n            var target = selection.getStart();\n            if (target !== editor.getBody()) {\n              dom.setAttrib(target, 'style', null);\n              each(template, function (attr) {\n                target.setAttributeNode(attr.cloneNode(true));\n              });\n            }\n          };\n        };\n        var isSelectionAcrossElements = function () {\n          return !selection.isCollapsed() && dom.getParent(selection.getStart(), dom.isBlock) !== dom.getParent(selection.getEnd(), dom.isBlock);\n        };\n        editor.on('keypress', function (e) {\n          var applyAttributes;\n          if (!isDefaultPrevented(e) && (e.keyCode === 8 || e.keyCode === 46) && isSelectionAcrossElements()) {\n            applyAttributes = getAttributeApplyFunction();\n            editor.getDoc().execCommand('delete', false, null);\n            applyAttributes();\n            e.preventDefault();\n            return false;\n          }\n        });\n        dom.bind(editor.getDoc(), 'cut', function (e) {\n          var applyAttributes;\n          if (!isDefaultPrevented(e) && isSelectionAcrossElements()) {\n            applyAttributes = getAttributeApplyFunction();\n            Delay.setEditorTimeout(editor, function () {\n              applyAttributes();\n            });\n          }\n        });\n      };\n      var disableBackspaceIntoATable = function () {\n        editor.on('keydown', function (e) {\n          if (!isDefaultPrevented(e) && e.keyCode === BACKSPACE) {\n            if (selection.isCollapsed() && selection.getRng().startOffset === 0) {\n              var previousSibling = selection.getNode().previousSibling;\n              if (previousSibling && previousSibling.nodeName && previousSibling.nodeName.toLowerCase() === 'table') {\n                e.preventDefault();\n                return false;\n              }\n            }\n          }\n        });\n      };\n      var removeBlockQuoteOnBackSpace = function () {\n        editor.on('keydown', function (e) {\n          var rng, container, offset, root, parent;\n          if (isDefaultPrevented(e) || e.keyCode !== VK.BACKSPACE) {\n            return;\n          }\n          rng = selection.getRng();\n          container = rng.startContainer;\n          offset = rng.startOffset;\n          root = dom.getRoot();\n          parent = container;\n          if (!rng.collapsed || offset !== 0) {\n            return;\n          }\n          while (parent && parent.parentNode && parent.parentNode.firstChild === parent && parent.parentNode !== root) {\n            parent = parent.parentNode;\n          }\n          if (parent.tagName === 'BLOCKQUOTE') {\n            editor.formatter.toggle('blockquote', null, parent);\n            rng = dom.createRng();\n            rng.setStart(container, 0);\n            rng.setEnd(container, 0);\n            selection.setRng(rng);\n          }\n        });\n      };\n      var setGeckoEditingOptions = function () {\n        var setOpts = function () {\n          setEditorCommandState('StyleWithCSS', false);\n          setEditorCommandState('enableInlineTableEditing', false);\n          if (!settings.object_resizing) {\n            setEditorCommandState('enableObjectResizing', false);\n          }\n        };\n        if (!settings.readonly) {\n          editor.on('BeforeExecCommand mousedown', setOpts);\n        }\n      };\n      var addBrAfterLastLinks = function () {\n        var fixLinks = function () {\n          each(dom.select('a'), function (node) {\n            var parentNode = node.parentNode;\n            var root = dom.getRoot();\n            if (parentNode.lastChild === node) {\n              while (parentNode && !dom.isBlock(parentNode)) {\n                if (parentNode.parentNode.lastChild !== parentNode || parentNode === root) {\n                  return;\n                }\n                parentNode = parentNode.parentNode;\n              }\n              dom.add(parentNode, 'br', { 'data-mce-bogus': 1 });\n            }\n          });\n        };\n        editor.on('SetContent ExecCommand', function (e) {\n          if (e.type === 'setcontent' || e.command === 'mceInsertLink') {\n            fixLinks();\n          }\n        });\n      };\n      var setDefaultBlockType = function () {\n        if (settings.forced_root_block) {\n          editor.on('init', function () {\n            setEditorCommandState('DefaultParagraphSeparator', Settings.getForcedRootBlock(editor));\n          });\n        }\n      };\n      var normalizeSelection = function () {\n        editor.on('keyup focusin mouseup', function (e) {\n          if (!VK.modifierPressed(e)) {\n            selection.normalize();\n          }\n        }, true);\n      };\n      var showBrokenImageIcon = function () {\n        editor.contentStyles.push('img:-moz-broken {' + '-moz-force-broken-image-icon:1;' + 'min-width:24px;' + 'min-height:24px' + '}');\n      };\n      var restoreFocusOnKeyDown = function () {\n        if (!editor.inline) {\n          editor.on('keydown', function () {\n            if (domGlobals.document.activeElement === domGlobals.document.body) {\n              editor.getWin().focus();\n            }\n          });\n        }\n      };\n      var bodyHeight = function () {\n        if (!editor.inline) {\n          editor.contentStyles.push('body {min-height: 150px}');\n          editor.on('click', function (e) {\n            var rng;\n            if (e.target.nodeName === 'HTML') {\n              if (Env.ie > 11) {\n                editor.getBody().focus();\n                return;\n              }\n              rng = editor.selection.getRng();\n              editor.getBody().focus();\n              editor.selection.setRng(rng);\n              editor.selection.normalize();\n              editor.nodeChanged();\n            }\n          });\n        }\n      };\n      var blockCmdArrowNavigation = function () {\n        if (Env.mac) {\n          editor.on('keydown', function (e) {\n            if (VK.metaKeyPressed(e) && !e.shiftKey && (e.keyCode === 37 || e.keyCode === 39)) {\n              e.preventDefault();\n              var selection_1 = editor.selection.getSel();\n              selection_1.modify('move', e.keyCode === 37 ? 'backward' : 'forward', 'lineboundary');\n            }\n          });\n        }\n      };\n      var disableAutoUrlDetect = function () {\n        setEditorCommandState('AutoUrlDetect', false);\n      };\n      var tapLinksAndImages = function () {\n        editor.on('click', function (e) {\n          var elm = e.target;\n          do {\n            if (elm.tagName === 'A') {\n              e.preventDefault();\n              return;\n            }\n          } while (elm = elm.parentNode);\n        });\n        editor.contentStyles.push('.mce-content-body {-webkit-touch-callout: none}');\n      };\n      var blockFormSubmitInsideEditor = function () {\n        editor.on('init', function () {\n          editor.dom.bind(editor.getBody(), 'submit', function (e) {\n            e.preventDefault();\n          });\n        });\n      };\n      var removeAppleInterchangeBrs = function () {\n        parser.addNodeFilter('br', function (nodes) {\n          var i = nodes.length;\n          while (i--) {\n            if (nodes[i].attr('class') === 'Apple-interchange-newline') {\n              nodes[i].remove();\n            }\n          }\n        });\n      };\n      var ieInternalDragAndDrop = function () {\n        editor.on('dragstart', function (e) {\n          setMceInternalContent(e);\n        });\n        editor.on('drop', function (e) {\n          if (!isDefaultPrevented(e)) {\n            var internalContent = getMceInternalContent(e);\n            if (internalContent && internalContent.id !== editor.id) {\n              e.preventDefault();\n              var rng = CaretRangeFromPoint.fromPoint(e.x, e.y, editor.getDoc());\n              selection.setRng(rng);\n              insertClipboardContents(internalContent.html, true);\n            }\n          }\n        });\n      };\n      var refreshContentEditable = function () {\n      };\n      var isHidden = function () {\n        var sel;\n        if (!isGecko || editor.removed) {\n          return false;\n        }\n        sel = editor.selection.getSel();\n        return !sel || !sel.rangeCount || sel.rangeCount === 0;\n      };\n      removeBlockQuoteOnBackSpace();\n      emptyEditorWhenDeleting();\n      if (!Env.windowsPhone) {\n        normalizeSelection();\n      }\n      if (isWebKit) {\n        inputMethodFocus();\n        selectControlElements();\n        setDefaultBlockType();\n        blockFormSubmitInsideEditor();\n        disableBackspaceIntoATable();\n        removeAppleInterchangeBrs();\n        if (Env.iOS) {\n          restoreFocusOnKeyDown();\n          bodyHeight();\n          tapLinksAndImages();\n        } else {\n          selectAll();\n        }\n      }\n      if (Env.ie >= 11) {\n        bodyHeight();\n        disableBackspaceIntoATable();\n      }\n      if (Env.ie) {\n        selectAll();\n        disableAutoUrlDetect();\n        ieInternalDragAndDrop();\n      }\n      if (isGecko) {\n        removeHrOnBackspace();\n        focusBody();\n        removeStylesWhenDeletingAcrossBlockElements();\n        setGeckoEditingOptions();\n        addBrAfterLastLinks();\n        showBrokenImageIcon();\n        blockCmdArrowNavigation();\n        disableBackspaceIntoATable();\n      }\n      return {\n        refreshContentEditable: refreshContentEditable,\n        isHidden: isHidden\n      };\n    };\n\n    var DOM$4 = DOMUtils$1.DOM;\n    var appendStyle = function (editor, text) {\n      var head = Element.fromDom(editor.getDoc().head);\n      var tag = Element.fromTag('style');\n      set(tag, 'type', 'text/css');\n      append(tag, Element.fromText(text));\n      append(head, tag);\n    };\n    var createParser = function (editor) {\n      var parser = DomParser(editor.settings, editor.schema);\n      parser.addAttributeFilter('src,href,style,tabindex', function (nodes, name) {\n        var i = nodes.length, node;\n        var dom = editor.dom;\n        var value, internalName;\n        while (i--) {\n          node = nodes[i];\n          value = node.attr(name);\n          internalName = 'data-mce-' + name;\n          if (!node.attr(internalName)) {\n            if (value.indexOf('data:') === 0 || value.indexOf('blob:') === 0) {\n              continue;\n            }\n            if (name === 'style') {\n              value = dom.serializeStyle(dom.parseStyle(value), node.name);\n              if (!value.length) {\n                value = null;\n              }\n              node.attr(internalName, value);\n              node.attr(name, value);\n            } else if (name === 'tabindex') {\n              node.attr(internalName, value);\n              node.attr(name, null);\n            } else {\n              node.attr(internalName, editor.convertURL(value, name, node.name));\n            }\n          }\n        }\n      });\n      parser.addNodeFilter('script', function (nodes) {\n        var i = nodes.length, node, type;\n        while (i--) {\n          node = nodes[i];\n          type = node.attr('type') || 'no/type';\n          if (type.indexOf('mce-') !== 0) {\n            node.attr('type', 'mce-' + type);\n          }\n        }\n      });\n      if (editor.settings.preserve_cdata) {\n        parser.addNodeFilter('#cdata', function (nodes) {\n          var i = nodes.length, node;\n          while (i--) {\n            node = nodes[i];\n            node.type = 8;\n            node.name = '#comment';\n            node.value = '[CDATA[' + editor.dom.encode(node.value) + ']]';\n          }\n        });\n      }\n      parser.addNodeFilter('p,h1,h2,h3,h4,h5,h6,div', function (nodes) {\n        var i = nodes.length, node;\n        var nonEmptyElements = editor.schema.getNonEmptyElements();\n        while (i--) {\n          node = nodes[i];\n          if (node.isEmpty(nonEmptyElements) && node.getAll('br').length === 0) {\n            node.append(new Node$1('br', 1)).shortEnded = true;\n          }\n        }\n      });\n      return parser;\n    };\n    var autoFocus = function (editor) {\n      if (editor.settings.auto_focus) {\n        Delay.setEditorTimeout(editor, function () {\n          var focusEditor;\n          if (editor.settings.auto_focus === true) {\n            focusEditor = editor;\n          } else {\n            focusEditor = editor.editorManager.get(editor.settings.auto_focus);\n          }\n          if (!focusEditor.destroyed) {\n            focusEditor.focus();\n          }\n        }, 100);\n      }\n    };\n    var moveSelectionToFirstCaretPosition = function (editor) {\n      var root = editor.dom.getRoot();\n      if (!editor.inline && (!hasAnyRanges(editor) || editor.selection.getStart(true) === root)) {\n        CaretFinder.firstPositionIn(root).each(function (pos) {\n          var node = pos.getNode();\n          var caretPos = NodeType.isTable(node) ? CaretFinder.firstPositionIn(node).getOr(pos) : pos;\n          editor.selection.setRng(caretPos.toRange());\n        });\n      }\n    };\n    var initEditor = function (editor) {\n      editor.bindPendingEventDelegates();\n      editor.initialized = true;\n      fireInit(editor);\n      editor.focus(true);\n      moveSelectionToFirstCaretPosition(editor);\n      editor.nodeChanged({ initial: true });\n      editor.execCallback('init_instance_callback', editor);\n      autoFocus(editor);\n    };\n    var getStyleSheetLoader = function (editor) {\n      return editor.inline ? DOM$4.styleSheetLoader : editor.dom.styleSheetLoader;\n    };\n    var initContentBody = function (editor, skipWrite) {\n      var settings = editor.settings;\n      var targetElm = editor.getElement();\n      var doc = editor.getDoc(), body, contentCssText;\n      if (!settings.inline) {\n        editor.getElement().style.visibility = editor.orgVisibility;\n      }\n      if (!skipWrite && !editor.inline) {\n        doc.open();\n        doc.write(editor.iframeHTML);\n        doc.close();\n      }\n      if (editor.inline) {\n        editor.on('remove', function () {\n          var bodyEl = this.getBody();\n          DOM$4.removeClass(bodyEl, 'mce-content-body');\n          DOM$4.removeClass(bodyEl, 'mce-edit-focus');\n          DOM$4.setAttrib(bodyEl, 'contentEditable', null);\n        });\n        DOM$4.addClass(targetElm, 'mce-content-body');\n        editor.contentDocument = doc = domGlobals.document;\n        editor.contentWindow = domGlobals.window;\n        editor.bodyElement = targetElm;\n        editor.contentAreaContainer = targetElm;\n        settings.root_name = targetElm.nodeName.toLowerCase();\n      }\n      body = editor.getBody();\n      body.disabled = true;\n      editor.readonly = settings.readonly;\n      if (!editor.readonly) {\n        if (editor.inline && DOM$4.getStyle(body, 'position', true) === 'static') {\n          body.style.position = 'relative';\n        }\n        body.contentEditable = editor.getParam('content_editable_state', true);\n      }\n      body.disabled = false;\n      editor.editorUpload = EditorUpload(editor);\n      editor.schema = Schema(settings);\n      editor.dom = DOMUtils$1(doc, {\n        keep_values: true,\n        url_converter: editor.convertURL,\n        url_converter_scope: editor,\n        hex_colors: settings.force_hex_style_colors,\n        update_styles: true,\n        root_element: editor.inline ? editor.getBody() : null,\n        collect: function () {\n          return editor.inline;\n        },\n        schema: editor.schema,\n        contentCssCors: Settings.shouldUseContentCssCors(editor),\n        referrerPolicy: Settings.getReferrerPolicy(editor),\n        onSetAttrib: function (e) {\n          editor.fire('SetAttrib', e);\n        }\n      });\n      editor.parser = createParser(editor);\n      editor.serializer = Serializer$1(settings, editor);\n      editor.selection = Selection$1(editor.dom, editor.getWin(), editor.serializer, editor);\n      editor.annotator = Annotator(editor);\n      editor.formatter = Formatter(editor);\n      editor.undoManager = UndoManager(editor);\n      editor._nodeChangeDispatcher = new NodeChange(editor);\n      editor._selectionOverrides = SelectionOverrides(editor);\n      TouchEvents.setup(editor);\n      setup$h(editor);\n      setup$i(editor);\n      KeyboardOverrides.setup(editor);\n      ForceBlocks.setup(editor);\n      setup$6(editor);\n      firePreInit(editor);\n      if (!settings.browser_spellcheck && !settings.gecko_spellcheck) {\n        doc.body.spellcheck = false;\n        DOM$4.setAttrib(body, 'spellcheck', 'false');\n      }\n      editor.quirks = Quirks(editor);\n      firePostRender(editor);\n      var directionality = Settings.getDirectionality(editor);\n      if (directionality !== undefined) {\n        body.dir = directionality;\n      }\n      if (settings.protect) {\n        editor.on('BeforeSetContent', function (e) {\n          Tools.each(settings.protect, function (pattern) {\n            e.content = e.content.replace(pattern, function (str) {\n              return '<!--mce:protected ' + escape(str) + '-->';\n            });\n          });\n        });\n      }\n      editor.on('SetContent', function () {\n        editor.addVisual(editor.getBody());\n      });\n      editor.load({\n        initial: true,\n        format: 'html'\n      });\n      editor.startContent = editor.getContent({ format: 'raw' });\n      editor.on('compositionstart compositionend', function (e) {\n        editor.composing = e.type === 'compositionstart';\n      });\n      if (editor.contentStyles.length > 0) {\n        contentCssText = '';\n        Tools.each(editor.contentStyles, function (style) {\n          contentCssText += style + '\\r\\n';\n        });\n        editor.dom.addStyle(contentCssText);\n      }\n      getStyleSheetLoader(editor).loadAll(editor.contentCSS, function (_) {\n        initEditor(editor);\n      }, function (urls) {\n        initEditor(editor);\n      });\n      if (settings.content_style) {\n        appendStyle(editor, settings.content_style);\n      }\n    };\n    var InitContentBody = { initContentBody: initContentBody };\n\n    var DOM$5 = DOMUtils$1.DOM;\n    var relaxDomain = function (editor, ifr) {\n      if (domGlobals.document.domain !== domGlobals.window.location.hostname && Env.browser.isIE()) {\n        var bodyUuid = Uuid.uuid('mce');\n        editor[bodyUuid] = function () {\n          InitContentBody.initContentBody(editor);\n        };\n        var domainRelaxUrl = 'javascript:(function(){' + 'document.open();document.domain=\"' + domGlobals.document.domain + '\";' + 'var ed = window.parent.tinymce.get(\"' + editor.id + '\");document.write(ed.iframeHTML);' + 'document.close();ed.' + bodyUuid + '(true);})()';\n        DOM$5.setAttrib(ifr, 'src', domainRelaxUrl);\n        return true;\n      }\n      return false;\n    };\n    var createIframeElement = function (id, title, height, customAttrs) {\n      var iframe = Element.fromTag('iframe');\n      setAll(iframe, customAttrs);\n      setAll(iframe, {\n        id: id + '_ifr',\n        frameBorder: '0',\n        allowTransparency: 'true',\n        title: title\n      });\n      add$3(iframe, 'tox-edit-area__iframe');\n      return iframe;\n    };\n    var getIframeHtml = function (editor) {\n      var bodyId, bodyClass, iframeHTML;\n      iframeHTML = Settings.getDocType(editor) + '<html><head>';\n      if (Settings.getDocumentBaseUrl(editor) !== editor.documentBaseUrl) {\n        iframeHTML += '<base href=\"' + editor.documentBaseURI.getURI() + '\" />';\n      }\n      iframeHTML += '<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />';\n      bodyId = Settings.getBodyId(editor);\n      bodyClass = Settings.getBodyClass(editor);\n      if (Settings.getContentSecurityPolicy(editor)) {\n        iframeHTML += '<meta http-equiv=\"Content-Security-Policy\" content=\"' + Settings.getContentSecurityPolicy(editor) + '\" />';\n      }\n      iframeHTML += '</head><body id=\"' + bodyId + '\" class=\"mce-content-body ' + bodyClass + '\" data-id=\"' + editor.id + '\"><br></body></html>';\n      return iframeHTML;\n    };\n    var createIframe = function (editor, o) {\n      var title = editor.editorManager.translate('Rich Text Area. Press ALT-0 for help.');\n      var ifr = createIframeElement(editor.id, title, o.height, Settings.getIframeAttrs(editor)).dom();\n      ifr.onload = function () {\n        ifr.onload = null;\n        editor.fire('load');\n      };\n      var isDomainRelaxed = relaxDomain(editor, ifr);\n      editor.contentAreaContainer = o.iframeContainer;\n      editor.iframeElement = ifr;\n      editor.iframeHTML = getIframeHtml(editor);\n      DOM$5.add(o.iframeContainer, ifr);\n      return isDomainRelaxed;\n    };\n    var init$1 = function (editor, boxInfo) {\n      var isDomainRelaxed = createIframe(editor, boxInfo);\n      if (boxInfo.editorContainer) {\n        DOM$5.get(boxInfo.editorContainer).style.display = editor.orgDisplay;\n        editor.hidden = DOM$5.isHidden(boxInfo.editorContainer);\n      }\n      editor.getElement().style.display = 'none';\n      DOM$5.setAttrib(editor.id, 'aria-hidden', 'true');\n      if (!isDomainRelaxed) {\n        InitContentBody.initContentBody(editor);\n      }\n    };\n    var InitIframe = { init: init$1 };\n\n    var DOM$6 = DOMUtils$1.DOM;\n    var initPlugin = function (editor, initializedPlugins, plugin) {\n      var Plugin = PluginManager.get(plugin);\n      var pluginUrl = PluginManager.urls[plugin] || editor.documentBaseUrl.replace(/\\/$/, '');\n      plugin = Tools.trim(plugin);\n      if (Plugin && Tools.inArray(initializedPlugins, plugin) === -1) {\n        Tools.each(PluginManager.dependencies(plugin), function (dep) {\n          initPlugin(editor, initializedPlugins, dep);\n        });\n        if (editor.plugins[plugin]) {\n          return;\n        }\n        try {\n          var pluginInstance = new Plugin(editor, pluginUrl, editor.$);\n          editor.plugins[plugin] = pluginInstance;\n          if (pluginInstance.init) {\n            pluginInstance.init(editor, pluginUrl);\n            initializedPlugins.push(plugin);\n          }\n        } catch (e) {\n          ErrorReporter.pluginInitError(editor, plugin, e);\n        }\n      }\n    };\n    var trimLegacyPrefix = function (name) {\n      return name.replace(/^\\-/, '');\n    };\n    var initPlugins = function (editor) {\n      var initializedPlugins = [];\n      Tools.each(editor.settings.plugins.split(/[ ,]/), function (name) {\n        initPlugin(editor, initializedPlugins, trimLegacyPrefix(name));\n      });\n    };\n    var initIcons = function (editor) {\n      var iconPackName = Tools.trim(editor.settings.icons);\n      var currentIcons = editor.ui.registry.getAll().icons;\n      var defaultIcons = getAll();\n      var loadIcons = __assign(__assign({}, defaultIcons), IconManager.get(iconPackName).icons);\n      each$1(loadIcons, function (svgData, icon) {\n        if (!has(currentIcons, icon)) {\n          editor.ui.registry.addIcon(icon, svgData);\n        }\n      });\n    };\n    var initTheme = function (editor) {\n      var theme = editor.settings.theme;\n      if (isString(theme)) {\n        editor.settings.theme = trimLegacyPrefix(theme);\n        var Theme = ThemeManager.get(theme);\n        editor.theme = new Theme(editor, ThemeManager.urls[theme]);\n        if (editor.theme.init) {\n          editor.theme.init(editor, ThemeManager.urls[theme] || editor.documentBaseUrl.replace(/\\/$/, ''), editor.$);\n        }\n      } else {\n        editor.theme = {};\n      }\n    };\n    var renderFromLoadedTheme = function (editor) {\n      return editor.theme.renderUI();\n    };\n    var renderFromThemeFunc = function (editor) {\n      var elm = editor.getElement();\n      var theme = editor.settings.theme;\n      var info = theme(editor, elm);\n      if (info.editorContainer.nodeType) {\n        info.editorContainer.id = info.editorContainer.id || editor.id + '_parent';\n      }\n      if (info.iframeContainer && info.iframeContainer.nodeType) {\n        info.iframeContainer.id = info.iframeContainer.id || editor.id + '_iframecontainer';\n      }\n      info.height = info.iframeHeight ? info.iframeHeight : elm.offsetHeight;\n      return info;\n    };\n    var createThemeFalseResult = function (element) {\n      return {\n        editorContainer: element,\n        iframeContainer: element\n      };\n    };\n    var renderThemeFalseIframe = function (targetElement) {\n      var iframeContainer = DOM$6.create('div');\n      DOM$6.insertAfter(iframeContainer, targetElement);\n      return createThemeFalseResult(iframeContainer);\n    };\n    var renderThemeFalse = function (editor) {\n      var targetElement = editor.getElement();\n      return editor.inline ? createThemeFalseResult(null) : renderThemeFalseIframe(targetElement);\n    };\n    var renderThemeUi = function (editor) {\n      var elm = editor.getElement();\n      editor.orgDisplay = elm.style.display;\n      if (isString(editor.settings.theme)) {\n        return renderFromLoadedTheme(editor);\n      } else if (isFunction(editor.settings.theme)) {\n        return renderFromThemeFunc(editor);\n      } else {\n        return renderThemeFalse(editor);\n      }\n    };\n    var init$2 = function (editor) {\n      editor.fire('ScriptsLoaded');\n      initIcons(editor);\n      initTheme(editor);\n      initPlugins(editor);\n      var boxInfo = renderThemeUi(editor);\n      editor.editorContainer = boxInfo.editorContainer ? boxInfo.editorContainer : null;\n      appendContentCssFromSettings(editor);\n      if (editor.inline) {\n        return InitContentBody.initContentBody(editor);\n      } else {\n        return InitIframe.init(editor, boxInfo);\n      }\n    };\n    var Init = { init: init$2 };\n\n    var DOM$7 = DOMUtils$1.DOM;\n    var hasSkipLoadPrefix = function (name) {\n      return name.charAt(0) === '-';\n    };\n    var loadLanguage = function (scriptLoader, editor) {\n      var languageCode = Settings.getLanguageCode(editor);\n      var languageUrl = Settings.getLanguageUrl(editor);\n      if (I18n.hasCode(languageCode) === false && languageCode !== 'en') {\n        var url_1 = languageUrl !== '' ? languageUrl : editor.editorManager.baseURL + '/langs/' + languageCode + '.js';\n        scriptLoader.add(url_1, noop, undefined, function () {\n          ErrorReporter.languageLoadError(editor, url_1, languageCode);\n        });\n      }\n    };\n    var loadTheme = function (scriptLoader, editor, suffix, callback) {\n      var settings = editor.settings, theme = settings.theme;\n      if (isString(theme)) {\n        if (!hasSkipLoadPrefix(theme) && !ThemeManager.urls.hasOwnProperty(theme)) {\n          var themeUrl = settings.theme_url;\n          if (themeUrl) {\n            ThemeManager.load(theme, editor.documentBaseURI.toAbsolute(themeUrl));\n          } else {\n            ThemeManager.load(theme, 'themes/' + theme + '/theme' + suffix + '.js');\n          }\n        }\n        scriptLoader.loadQueue(function () {\n          ThemeManager.waitFor(theme, callback);\n        });\n      } else {\n        callback();\n      }\n    };\n    var getIconsUrlMetaFromUrl = function (editor) {\n      return Option.from(Settings.getIconsUrl(editor)).filter(function (url) {\n        return url.length > 0;\n      }).map(function (url) {\n        return {\n          url: url,\n          name: Option.none()\n        };\n      });\n    };\n    var getIconsUrlMetaFromName = function (editor) {\n      return Option.from(Settings.getIconPackName(editor)).filter(function (name) {\n        return name.length > 0 && !IconManager.has(name);\n      }).map(function (name) {\n        return {\n          url: editor.editorManager.baseURL + '/icons/' + name + '/icons.js',\n          name: Option.some(name)\n        };\n      });\n    };\n    var loadIcons = function (scriptLoader, editor) {\n      getIconsUrlMetaFromUrl(editor).orThunk(function () {\n        return getIconsUrlMetaFromName(editor);\n      }).each(function (urlMeta) {\n        scriptLoader.add(urlMeta.url, noop, undefined, function () {\n          ErrorReporter.iconsLoadError(editor, urlMeta.url, urlMeta.name.getOrUndefined());\n        });\n      });\n    };\n    var loadPlugins = function (editor, settings, suffix) {\n      if (isArray(settings.plugins)) {\n        settings.plugins = settings.plugins.join(' ');\n      }\n      Tools.each(settings.external_plugins, function (url, name) {\n        PluginManager.load(name, url, noop, undefined, function () {\n          ErrorReporter.pluginLoadError(editor, url, name);\n        });\n        settings.plugins += ' ' + name;\n      });\n      Tools.each(settings.plugins.split(/[ ,]/), function (plugin) {\n        plugin = Tools.trim(plugin);\n        if (plugin && !PluginManager.urls[plugin]) {\n          if (hasSkipLoadPrefix(plugin)) {\n            plugin = plugin.substr(1, plugin.length);\n            var dependencies = PluginManager.dependencies(plugin);\n            Tools.each(dependencies, function (depPlugin) {\n              var defaultSettings = {\n                prefix: 'plugins/',\n                resource: depPlugin,\n                suffix: '/plugin' + suffix + '.js'\n              };\n              var dep = PluginManager.createUrl(defaultSettings, depPlugin);\n              PluginManager.load(dep.resource, dep, noop, undefined, function () {\n                ErrorReporter.pluginLoadError(editor, dep.prefix + dep.resource + dep.suffix, dep.resource);\n              });\n            });\n          } else {\n            var url_2 = {\n              prefix: 'plugins/',\n              resource: plugin,\n              suffix: '/plugin' + suffix + '.js'\n            };\n            PluginManager.load(plugin, url_2, noop, undefined, function () {\n              ErrorReporter.pluginLoadError(editor, url_2.prefix + url_2.resource + url_2.suffix, plugin);\n            });\n          }\n        }\n      });\n    };\n    var loadScripts = function (editor, suffix) {\n      var scriptLoader = ScriptLoader.ScriptLoader;\n      loadTheme(scriptLoader, editor, suffix, function () {\n        loadLanguage(scriptLoader, editor);\n        loadIcons(scriptLoader, editor);\n        loadPlugins(editor, editor.settings, suffix);\n        scriptLoader.loadQueue(function () {\n          if (!editor.removed) {\n            Init.init(editor);\n          }\n        }, editor, function () {\n          if (!editor.removed) {\n            Init.init(editor);\n          }\n        });\n      });\n    };\n    var render = function (editor) {\n      var settings = editor.settings, id = editor.id;\n      I18n.setCode(Settings.getLanguageCode(editor));\n      var readyHandler = function () {\n        DOM$7.unbind(domGlobals.window, 'ready', readyHandler);\n        editor.render();\n      };\n      if (!EventUtils.Event.domLoaded) {\n        DOM$7.bind(domGlobals.window, 'ready', readyHandler);\n        return;\n      }\n      if (!editor.getElement()) {\n        return;\n      }\n      if (!Env.contentEditable) {\n        return;\n      }\n      if (!settings.inline) {\n        editor.orgVisibility = editor.getElement().style.visibility;\n        editor.getElement().style.visibility = 'hidden';\n      } else {\n        editor.inline = true;\n      }\n      var form = editor.getElement().form || DOM$7.getParent(id, 'form');\n      if (form) {\n        editor.formElement = form;\n        if (settings.hidden_input && !NodeType.isTextareaOrInput(editor.getElement())) {\n          DOM$7.insertAfter(DOM$7.create('input', {\n            type: 'hidden',\n            name: id\n          }), id);\n          editor.hasHiddenInput = true;\n        }\n        editor.formEventDelegate = function (e) {\n          editor.fire(e.type, e);\n        };\n        DOM$7.bind(form, 'submit reset', editor.formEventDelegate);\n        editor.on('reset', function () {\n          editor.resetContent();\n        });\n        if (settings.submit_patch && !form.submit.nodeType && !form.submit.length && !form._mceOldSubmit) {\n          form._mceOldSubmit = form.submit;\n          form.submit = function () {\n            editor.editorManager.triggerSave();\n            editor.setDirty(false);\n            return form._mceOldSubmit(form);\n          };\n        }\n      }\n      editor.windowManager = WindowManager(editor);\n      editor.notificationManager = NotificationManager(editor);\n      if (settings.encoding === 'xml') {\n        editor.on('GetContent', function (e) {\n          if (e.save) {\n            e.content = DOM$7.encode(e.content);\n          }\n        });\n      }\n      if (settings.add_form_submit_trigger) {\n        editor.on('submit', function () {\n          if (editor.initialized) {\n            editor.save();\n          }\n        });\n      }\n      if (settings.add_unload_trigger) {\n        editor._beforeUnload = function () {\n          if (editor.initialized && !editor.destroyed && !editor.isHidden()) {\n            editor.save({\n              format: 'raw',\n              no_events: true,\n              set_dirty: false\n            });\n          }\n        };\n        editor.editorManager.on('BeforeUnload', editor._beforeUnload);\n      }\n      editor.editorManager.add(editor);\n      loadScripts(editor, editor.suffix);\n    };\n    var Render = { render: render };\n\n    var hasOnlyOneChild$1 = function (node) {\n      return node.firstChild && node.firstChild === node.lastChild;\n    };\n    var isPaddingNode = function (node) {\n      return node.name === 'br' || node.value === nbsp;\n    };\n    var isPaddedEmptyBlock = function (schema, node) {\n      var blockElements = schema.getBlockElements();\n      return blockElements[node.name] && hasOnlyOneChild$1(node) && isPaddingNode(node.firstChild);\n    };\n    var isEmptyFragmentElement = function (schema, node) {\n      var nonEmptyElements = schema.getNonEmptyElements();\n      return node && (node.isEmpty(nonEmptyElements) || isPaddedEmptyBlock(schema, node));\n    };\n    var isListFragment = function (schema, fragment) {\n      var firstChild = fragment.firstChild;\n      var lastChild = fragment.lastChild;\n      if (firstChild && firstChild.name === 'meta') {\n        firstChild = firstChild.next;\n      }\n      if (lastChild && lastChild.attr('id') === 'mce_marker') {\n        lastChild = lastChild.prev;\n      }\n      if (isEmptyFragmentElement(schema, lastChild)) {\n        lastChild = lastChild.prev;\n      }\n      if (!firstChild || firstChild !== lastChild) {\n        return false;\n      }\n      return firstChild.name === 'ul' || firstChild.name === 'ol';\n    };\n    var cleanupDomFragment = function (domFragment) {\n      var firstChild = domFragment.firstChild;\n      var lastChild = domFragment.lastChild;\n      if (firstChild && firstChild.nodeName === 'META') {\n        firstChild.parentNode.removeChild(firstChild);\n      }\n      if (lastChild && lastChild.id === 'mce_marker') {\n        lastChild.parentNode.removeChild(lastChild);\n      }\n      return domFragment;\n    };\n    var toDomFragment = function (dom, serializer, fragment) {\n      var html = serializer.serialize(fragment);\n      var domFragment = dom.createFragment(html);\n      return cleanupDomFragment(domFragment);\n    };\n    var listItems$1 = function (elm) {\n      return Tools.grep(elm.childNodes, function (child) {\n        return child.nodeName === 'LI';\n      });\n    };\n    var isPadding = function (node) {\n      return node.data === nbsp || NodeType.isBr(node);\n    };\n    var isListItemPadded = function (node) {\n      return node && node.firstChild && node.firstChild === node.lastChild && isPadding(node.firstChild);\n    };\n    var isEmptyOrPadded = function (elm) {\n      return !elm.firstChild || isListItemPadded(elm);\n    };\n    var trimListItems = function (elms) {\n      return elms.length > 0 && isEmptyOrPadded(elms[elms.length - 1]) ? elms.slice(0, -1) : elms;\n    };\n    var getParentLi = function (dom, node) {\n      var parentBlock = dom.getParent(node, dom.isBlock);\n      return parentBlock && parentBlock.nodeName === 'LI' ? parentBlock : null;\n    };\n    var isParentBlockLi = function (dom, node) {\n      return !!getParentLi(dom, node);\n    };\n    var getSplit = function (parentNode, rng) {\n      var beforeRng = rng.cloneRange();\n      var afterRng = rng.cloneRange();\n      beforeRng.setStartBefore(parentNode);\n      afterRng.setEndAfter(parentNode);\n      return [\n        beforeRng.cloneContents(),\n        afterRng.cloneContents()\n      ];\n    };\n    var findFirstIn = function (node, rootNode) {\n      var caretPos = CaretPosition$1.before(node);\n      var caretWalker = CaretWalker(rootNode);\n      var newCaretPos = caretWalker.next(caretPos);\n      return newCaretPos ? newCaretPos.toRange() : null;\n    };\n    var findLastOf = function (node, rootNode) {\n      var caretPos = CaretPosition$1.after(node);\n      var caretWalker = CaretWalker(rootNode);\n      var newCaretPos = caretWalker.prev(caretPos);\n      return newCaretPos ? newCaretPos.toRange() : null;\n    };\n    var insertMiddle = function (target, elms, rootNode, rng) {\n      var parts = getSplit(target, rng);\n      var parentElm = target.parentNode;\n      parentElm.insertBefore(parts[0], target);\n      Tools.each(elms, function (li) {\n        parentElm.insertBefore(li, target);\n      });\n      parentElm.insertBefore(parts[1], target);\n      parentElm.removeChild(target);\n      return findLastOf(elms[elms.length - 1], rootNode);\n    };\n    var insertBefore$1 = function (target, elms, rootNode) {\n      var parentElm = target.parentNode;\n      Tools.each(elms, function (elm) {\n        parentElm.insertBefore(elm, target);\n      });\n      return findFirstIn(target, rootNode);\n    };\n    var insertAfter$1 = function (target, elms, rootNode, dom) {\n      dom.insertAfter(elms.reverse(), target);\n      return findLastOf(elms[0], rootNode);\n    };\n    var insertAtCaret = function (serializer, dom, rng, fragment) {\n      var domFragment = toDomFragment(dom, serializer, fragment);\n      var liTarget = getParentLi(dom, rng.startContainer);\n      var liElms = trimListItems(listItems$1(domFragment.firstChild));\n      var BEGINNING = 1, END = 2;\n      var rootNode = dom.getRoot();\n      var isAt = function (location) {\n        var caretPos = CaretPosition$1.fromRangeStart(rng);\n        var caretWalker = CaretWalker(dom.getRoot());\n        var newPos = location === BEGINNING ? caretWalker.prev(caretPos) : caretWalker.next(caretPos);\n        return newPos ? getParentLi(dom, newPos.getNode()) !== liTarget : true;\n      };\n      if (isAt(BEGINNING)) {\n        return insertBefore$1(liTarget, liElms, rootNode);\n      } else if (isAt(END)) {\n        return insertAfter$1(liTarget, liElms, rootNode, dom);\n      }\n      return insertMiddle(liTarget, liElms, rootNode, rng);\n    };\n    var InsertList = {\n      isListFragment: isListFragment,\n      insertAtCaret: insertAtCaret,\n      isParentBlockLi: isParentBlockLi,\n      trimListItems: trimListItems,\n      listItems: listItems$1\n    };\n\n    var isAfterNbsp = function (container, offset) {\n      return NodeType.isText(container) && container.nodeValue[offset - 1] === nbsp;\n    };\n    var trimOrPadLeftRight = function (rng, html) {\n      var container, offset;\n      container = rng.startContainer;\n      offset = rng.startOffset;\n      var hasSiblingText = function (siblingName) {\n        return container[siblingName] && container[siblingName].nodeType === 3;\n      };\n      if (container.nodeType === 3) {\n        if (offset > 0) {\n          html = html.replace(/^&nbsp;/, ' ');\n        } else if (!hasSiblingText('previousSibling')) {\n          html = html.replace(/^ /, '&nbsp;');\n        }\n        if (offset < container.length) {\n          html = html.replace(/&nbsp;(<br>|)$/, ' ');\n        } else if (!hasSiblingText('nextSibling')) {\n          html = html.replace(/(&nbsp;| )(<br>|)$/, '&nbsp;');\n        }\n      }\n      return html;\n    };\n    var trimNbspAfterDeleteAndPadValue = function (rng, value) {\n      var container, offset;\n      container = rng.startContainer;\n      offset = rng.startOffset;\n      if (container.nodeType === 3 && rng.collapsed) {\n        if (container.data[offset] === nbsp) {\n          container.deleteData(offset, 1);\n          if (!/[\\u00a0| ]$/.test(value)) {\n            value += ' ';\n          }\n        } else if (container.data[offset - 1] === nbsp) {\n          container.deleteData(offset - 1, 1);\n          if (!/[\\u00a0| ]$/.test(value)) {\n            value = ' ' + value;\n          }\n        }\n      }\n      return value;\n    };\n\n    var isTableCell$5 = NodeType.matchNodeNames([\n      'td',\n      'th'\n    ]);\n    var selectionSetContent = function (editor, content) {\n      var rng = editor.selection.getRng();\n      var container = rng.startContainer;\n      var offset = rng.startOffset;\n      if (rng.collapsed && isAfterNbsp(container, offset) && NodeType.isText(container)) {\n        container.insertData(offset - 1, ' ');\n        container.deleteData(offset, 1);\n        rng.setStart(container, offset);\n        rng.setEnd(container, offset);\n        editor.selection.setRng(rng);\n      }\n      editor.selection.setContent(content);\n    };\n    var validInsertion = function (editor, value, parentNode) {\n      if (parentNode.getAttribute('data-mce-bogus') === 'all') {\n        parentNode.parentNode.insertBefore(editor.dom.createFragment(value), parentNode);\n      } else {\n        var node = parentNode.firstChild;\n        var node2 = parentNode.lastChild;\n        if (!node || node === node2 && node.nodeName === 'BR') {\n          editor.dom.setHTML(parentNode, value);\n        } else {\n          selectionSetContent(editor, value);\n        }\n      }\n    };\n    var trimBrsFromTableCell = function (dom, elm) {\n      Option.from(dom.getParent(elm, 'td,th')).map(Element.fromDom).each(PaddingBr.trimBlockTrailingBr);\n    };\n    var reduceInlineTextElements = function (editor, merge) {\n      var textInlineElements = editor.schema.getTextInlineElements();\n      var dom = editor.dom;\n      if (merge) {\n        var root_1 = editor.getBody(), elementUtils_1 = new ElementUtils(dom);\n        Tools.each(dom.select('*[data-mce-fragment]'), function (node) {\n          for (var testNode = node.parentNode; testNode && testNode !== root_1; testNode = testNode.parentNode) {\n            if (textInlineElements[node.nodeName.toLowerCase()] && elementUtils_1.compare(testNode, node)) {\n              dom.remove(node, true);\n            }\n          }\n        });\n      }\n    };\n    var markFragmentElements = function (fragment) {\n      var node = fragment;\n      while (node = node.walk()) {\n        if (node.type === 1) {\n          node.attr('data-mce-fragment', '1');\n        }\n      }\n    };\n    var umarkFragmentElements = function (elm) {\n      Tools.each(elm.getElementsByTagName('*'), function (elm) {\n        elm.removeAttribute('data-mce-fragment');\n      });\n    };\n    var isPartOfFragment = function (node) {\n      return !!node.getAttribute('data-mce-fragment');\n    };\n    var canHaveChildren = function (editor, node) {\n      return node && !editor.schema.getShortEndedElements()[node.nodeName];\n    };\n    var moveSelectionToMarker = function (editor, marker) {\n      var parentEditableFalseElm, parentBlock, nextRng;\n      var dom = editor.dom, selection = editor.selection;\n      var node, node2;\n      var getContentEditableFalseParent = function (node) {\n        var root = editor.getBody();\n        for (; node && node !== root; node = node.parentNode) {\n          if (editor.dom.getContentEditable(node) === 'false') {\n            return node;\n          }\n        }\n        return null;\n      };\n      if (!marker) {\n        return;\n      }\n      editor.selection.scrollIntoView(marker);\n      parentEditableFalseElm = getContentEditableFalseParent(marker);\n      if (parentEditableFalseElm) {\n        dom.remove(marker);\n        selection.select(parentEditableFalseElm);\n        return;\n      }\n      var rng = dom.createRng();\n      node = marker.previousSibling;\n      if (node && node.nodeType === 3) {\n        rng.setStart(node, node.nodeValue.length);\n        if (!Env.ie) {\n          node2 = marker.nextSibling;\n          if (node2 && node2.nodeType === 3) {\n            node.appendData(node2.data);\n            node2.parentNode.removeChild(node2);\n          }\n        }\n      } else {\n        rng.setStartBefore(marker);\n        rng.setEndBefore(marker);\n      }\n      var findNextCaretRng = function (rng) {\n        var caretPos = CaretPosition$1.fromRangeStart(rng);\n        var caretWalker = CaretWalker(editor.getBody());\n        caretPos = caretWalker.next(caretPos);\n        if (caretPos) {\n          return caretPos.toRange();\n        }\n      };\n      parentBlock = dom.getParent(marker, dom.isBlock);\n      dom.remove(marker);\n      if (parentBlock && dom.isEmpty(parentBlock)) {\n        editor.$(parentBlock).empty();\n        rng.setStart(parentBlock, 0);\n        rng.setEnd(parentBlock, 0);\n        if (!isTableCell$5(parentBlock) && !isPartOfFragment(parentBlock) && (nextRng = findNextCaretRng(rng))) {\n          rng = nextRng;\n          dom.remove(parentBlock);\n        } else {\n          dom.add(parentBlock, dom.create('br', { 'data-mce-bogus': '1' }));\n        }\n      }\n      selection.setRng(rng);\n    };\n    var insertHtmlAtCaret = function (editor, value, details) {\n      var parser, serializer, parentNode, rootNode, fragment, args;\n      var marker, rng, node, bookmarkHtml, merge;\n      var selection = editor.selection, dom = editor.dom;\n      if (/^ | $/.test(value)) {\n        value = trimOrPadLeftRight(selection.getRng(), value);\n      }\n      parser = editor.parser;\n      merge = details.merge;\n      serializer = Serializer({ validate: editor.settings.validate }, editor.schema);\n      bookmarkHtml = '<span id=\"mce_marker\" data-mce-type=\"bookmark\">&#xFEFF;&#x200B;</span>';\n      args = {\n        content: value,\n        format: 'html',\n        selection: true,\n        paste: details.paste\n      };\n      args = editor.fire('BeforeSetContent', args);\n      if (args.isDefaultPrevented()) {\n        editor.fire('SetContent', {\n          content: args.content,\n          format: 'html',\n          selection: true,\n          paste: details.paste\n        });\n        return;\n      }\n      value = args.content;\n      if (value.indexOf('{$caret}') === -1) {\n        value += '{$caret}';\n      }\n      value = value.replace(/\\{\\$caret\\}/, bookmarkHtml);\n      rng = selection.getRng();\n      var caretElement = rng.startContainer || (rng.parentElement ? rng.parentElement() : null);\n      var body = editor.getBody();\n      if (caretElement === body && selection.isCollapsed()) {\n        if (dom.isBlock(body.firstChild) && canHaveChildren(editor, body.firstChild) && dom.isEmpty(body.firstChild)) {\n          rng = dom.createRng();\n          rng.setStart(body.firstChild, 0);\n          rng.setEnd(body.firstChild, 0);\n          selection.setRng(rng);\n        }\n      }\n      if (!selection.isCollapsed()) {\n        editor.selection.setRng(RangeNormalizer.normalize(editor.selection.getRng()));\n        editor.getDoc().execCommand('Delete', false, null);\n        value = trimNbspAfterDeleteAndPadValue(editor.selection.getRng(), value);\n      }\n      parentNode = selection.getNode();\n      var parserArgs = {\n        context: parentNode.nodeName.toLowerCase(),\n        data: details.data,\n        insert: true\n      };\n      fragment = parser.parse(value, parserArgs);\n      if (details.paste === true && InsertList.isListFragment(editor.schema, fragment) && InsertList.isParentBlockLi(dom, parentNode)) {\n        rng = InsertList.insertAtCaret(serializer, dom, editor.selection.getRng(), fragment);\n        editor.selection.setRng(rng);\n        editor.fire('SetContent', args);\n        return;\n      }\n      markFragmentElements(fragment);\n      node = fragment.lastChild;\n      if (node.attr('id') === 'mce_marker') {\n        marker = node;\n        for (node = node.prev; node; node = node.walk(true)) {\n          if (node.type === 3 || !dom.isBlock(node.name)) {\n            if (editor.schema.isValidChild(node.parent.name, 'span')) {\n              node.parent.insert(marker, node, node.name === 'br');\n            }\n            break;\n          }\n        }\n      }\n      editor._selectionOverrides.showBlockCaretContainer(parentNode);\n      if (!parserArgs.invalid) {\n        value = serializer.serialize(fragment);\n        validInsertion(editor, value, parentNode);\n      } else {\n        selectionSetContent(editor, bookmarkHtml);\n        parentNode = selection.getNode();\n        rootNode = editor.getBody();\n        if (parentNode.nodeType === 9) {\n          parentNode = node = rootNode;\n        } else {\n          node = parentNode;\n        }\n        while (node !== rootNode) {\n          parentNode = node;\n          node = node.parentNode;\n        }\n        value = parentNode === rootNode ? rootNode.innerHTML : dom.getOuterHTML(parentNode);\n        value = serializer.serialize(parser.parse(value.replace(/<span (id=\"mce_marker\"|id=mce_marker).+?<\\/span>/i, function () {\n          return serializer.serialize(fragment);\n        })));\n        if (parentNode === rootNode) {\n          dom.setHTML(rootNode, value);\n        } else {\n          dom.setOuterHTML(parentNode, value);\n        }\n      }\n      reduceInlineTextElements(editor, merge);\n      moveSelectionToMarker(editor, dom.get('mce_marker'));\n      umarkFragmentElements(editor.getBody());\n      trimBrsFromTableCell(editor.dom, editor.selection.getStart());\n      editor.fire('SetContent', args);\n      editor.addVisual();\n    };\n    var processValue = function (value) {\n      var details;\n      if (typeof value !== 'string') {\n        details = Tools.extend({\n          paste: value.paste,\n          data: { paste: value.paste }\n        }, value);\n        return {\n          content: value.content,\n          details: details\n        };\n      }\n      return {\n        content: value,\n        details: {}\n      };\n    };\n    var insertAtCaret$1 = function (editor, value) {\n      var result = processValue(value);\n      insertHtmlAtCaret(editor, result.content, result.details);\n    };\n    var InsertContent = { insertAtCaret: insertAtCaret$1 };\n\n    var nativeCommand = function (editor, command) {\n      editor.getDoc().execCommand(command, false, null);\n    };\n    var deleteCommand = function (editor) {\n      if (Outdent.backspaceDelete(editor, false)) {\n        return;\n      } else if (CefDelete.backspaceDelete(editor, false)) {\n        return;\n      } else if (CefBoundaryDelete.backspaceDelete(editor, false)) {\n        return;\n      } else if (BoundaryDelete.backspaceDelete(editor, false)) {\n        return;\n      } else if (BlockBoundaryDelete.backspaceDelete(editor, false)) {\n        return;\n      } else if (TableDelete.backspaceDelete(editor)) {\n        return;\n      } else if (BlockRangeDelete.backspaceDelete(editor, false)) {\n        return;\n      } else if (InlineFormatDelete.backspaceDelete(editor, false)) {\n        return;\n      } else {\n        nativeCommand(editor, 'Delete');\n        DeleteUtils.paddEmptyBody(editor);\n      }\n    };\n    var forwardDeleteCommand = function (editor) {\n      if (CefDelete.backspaceDelete(editor, true)) {\n        return;\n      } else if (CefBoundaryDelete.backspaceDelete(editor, true)) {\n        return;\n      } else if (BoundaryDelete.backspaceDelete(editor, true)) {\n        return;\n      } else if (BlockBoundaryDelete.backspaceDelete(editor, true)) {\n        return;\n      } else if (TableDelete.backspaceDelete(editor)) {\n        return;\n      } else if (BlockRangeDelete.backspaceDelete(editor, true)) {\n        return;\n      } else if (InlineFormatDelete.backspaceDelete(editor, true)) {\n        return;\n      } else {\n        nativeCommand(editor, 'ForwardDelete');\n      }\n    };\n    var DeleteCommands = {\n      deleteCommand: deleteCommand,\n      forwardDeleteCommand: forwardDeleteCommand\n    };\n\n    var ancestor$3 = function (scope, transform, isRoot) {\n      var element = scope.dom();\n      var stop = isFunction(isRoot) ? isRoot : constant(false);\n      while (element.parentNode) {\n        element = element.parentNode;\n        var el = Element.fromDom(element);\n        var transformed = transform(el);\n        if (transformed.isSome()) {\n          return transformed;\n        } else if (stop(el)) {\n          break;\n        }\n      }\n      return Option.none();\n    };\n    var closest$2 = function (scope, transform, isRoot) {\n      var current = transform(scope);\n      return current.orThunk(function () {\n        return isRoot(scope) ? Option.none() : ancestor$3(scope, transform, isRoot);\n      });\n    };\n\n    var legacyPropNames = {\n      'font-size': 'size',\n      'font-family': 'face'\n    };\n    var getSpecifiedFontProp = function (propName, rootElm, elm) {\n      var getProperty = function (elm) {\n        return getRaw(elm, propName).orThunk(function () {\n          if (name(elm) === 'font') {\n            return get(legacyPropNames, propName).bind(function (legacyPropName) {\n              return getOpt(elm, legacyPropName);\n            });\n          } else {\n            return Option.none();\n          }\n        });\n      };\n      var isRoot = function (elm) {\n        return eq(Element.fromDom(rootElm), elm);\n      };\n      return closest$2(Element.fromDom(elm), function (elm) {\n        return getProperty(elm);\n      }, isRoot);\n    };\n    var round$1 = function (number, precision) {\n      var factor = Math.pow(10, precision);\n      return Math.round(number * factor) / factor;\n    };\n    var toPt = function (fontSize, precision) {\n      if (/[0-9.]+px$/.test(fontSize)) {\n        return round$1(parseInt(fontSize, 10) * 72 / 96, precision || 0) + 'pt';\n      }\n      return fontSize;\n    };\n    var normalizeFontFamily = function (fontFamily) {\n      return fontFamily.replace(/[\\'\\\"\\\\]/g, '').replace(/,\\s+/g, ',');\n    };\n    var getComputedFontProp = function (propName, elm) {\n      return Option.from(DOMUtils$1.DOM.getStyle(elm, propName, true));\n    };\n    var getFontProp = function (propName) {\n      return function (rootElm, elm) {\n        return Option.from(elm).map(Element.fromDom).filter(isElement).bind(function (element) {\n          return getSpecifiedFontProp(propName, rootElm, element.dom()).or(getComputedFontProp(propName, element.dom()));\n        }).getOr('');\n      };\n    };\n    var FontInfo = {\n      getFontSize: getFontProp('font-size'),\n      getFontFamily: compose(normalizeFontFamily, getFontProp('font-family')),\n      toPt: toPt\n    };\n\n    var findFirstCaretElement = function (editor) {\n      return CaretFinder.firstPositionIn(editor.getBody()).map(function (caret) {\n        var container = caret.container();\n        return NodeType.isText(container) ? container.parentNode : container;\n      });\n    };\n    var isRangeAtStartOfNode = function (rng, root) {\n      return rng.startContainer === root && rng.startOffset === 0;\n    };\n    var getCaretElement = function (editor) {\n      return Option.from(editor.selection.getRng()).bind(function (rng) {\n        var root = editor.getBody();\n        return isRangeAtStartOfNode(rng, root) ? Option.none() : Option.from(editor.selection.getStart(true));\n      });\n    };\n    var fromFontSizeNumber = function (editor, value) {\n      if (/^[0-9\\.]+$/.test(value)) {\n        var fontSizeNumber = parseInt(value, 10);\n        if (fontSizeNumber >= 1 && fontSizeNumber <= 7) {\n          var fontSizes = Settings.getFontStyleValues(editor);\n          var fontClasses = Settings.getFontSizeClasses(editor);\n          if (fontClasses) {\n            return fontClasses[fontSizeNumber - 1] || value;\n          } else {\n            return fontSizes[fontSizeNumber - 1] || value;\n          }\n        } else {\n          return value;\n        }\n      } else {\n        return value;\n      }\n    };\n    var normalizeFontNames = function (font) {\n      var fonts = font.split(/\\s*,\\s*/);\n      return map(fonts, function (font) {\n        if (font.indexOf(' ') !== -1 && !(startsWith(font, '\"') || startsWith(font, '\\''))) {\n          return '\\'' + font + '\\'';\n        } else {\n          return font;\n        }\n      }).join(',');\n    };\n    var fontNameAction = function (editor, value) {\n      var font = fromFontSizeNumber(editor, value);\n      editor.formatter.toggle('fontname', { value: normalizeFontNames(font) });\n      editor.nodeChanged();\n    };\n    var fontNameQuery = function (editor) {\n      return getCaretElement(editor).fold(function () {\n        return findFirstCaretElement(editor).map(function (caretElement) {\n          return FontInfo.getFontFamily(editor.getBody(), caretElement);\n        }).getOr('');\n      }, function (caretElement) {\n        return FontInfo.getFontFamily(editor.getBody(), caretElement);\n      });\n    };\n    var fontSizeAction = function (editor, value) {\n      editor.formatter.toggle('fontsize', { value: fromFontSizeNumber(editor, value) });\n      editor.nodeChanged();\n    };\n    var fontSizeQuery = function (editor) {\n      return getCaretElement(editor).fold(function () {\n        return findFirstCaretElement(editor).map(function (caretElement) {\n          return FontInfo.getFontSize(editor.getBody(), caretElement);\n        }).getOr('');\n      }, function (caretElement) {\n        return FontInfo.getFontSize(editor.getBody(), caretElement);\n      });\n    };\n\n    var each$f = Tools.each;\n    var map$3 = Tools.map, inArray$2 = Tools.inArray;\n    var EditorCommands = function () {\n      function EditorCommands(editor) {\n        this.commands = {\n          state: {},\n          exec: {},\n          value: {}\n        };\n        this.editor = editor;\n        this.setupCommands(editor);\n      }\n      EditorCommands.prototype.execCommand = function (command, ui, value, args) {\n        var func, customCommand, state = false;\n        var self = this;\n        if (self.editor.removed) {\n          return;\n        }\n        if (!/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(command) && (!args || !args.skip_focus)) {\n          self.editor.focus();\n        } else {\n          SelectionBookmark.restore(self.editor);\n        }\n        args = self.editor.fire('BeforeExecCommand', {\n          command: command,\n          ui: ui,\n          value: value\n        });\n        if (args.isDefaultPrevented()) {\n          return false;\n        }\n        customCommand = command.toLowerCase();\n        if (func = self.commands.exec[customCommand]) {\n          func(customCommand, ui, value);\n          self.editor.fire('ExecCommand', {\n            command: command,\n            ui: ui,\n            value: value\n          });\n          return true;\n        }\n        each$f(this.editor.plugins, function (p) {\n          if (p.execCommand && p.execCommand(command, ui, value)) {\n            self.editor.fire('ExecCommand', {\n              command: command,\n              ui: ui,\n              value: value\n            });\n            state = true;\n            return false;\n          }\n        });\n        if (state) {\n          return state;\n        }\n        if (self.editor.theme && self.editor.theme.execCommand && self.editor.theme.execCommand(command, ui, value)) {\n          self.editor.fire('ExecCommand', {\n            command: command,\n            ui: ui,\n            value: value\n          });\n          return true;\n        }\n        try {\n          state = self.editor.getDoc().execCommand(command, ui, value);\n        } catch (ex) {\n        }\n        if (state) {\n          self.editor.fire('ExecCommand', {\n            command: command,\n            ui: ui,\n            value: value\n          });\n          return true;\n        }\n        return false;\n      };\n      EditorCommands.prototype.queryCommandState = function (command) {\n        var func;\n        if (this.editor.quirks.isHidden() || this.editor.removed) {\n          return;\n        }\n        command = command.toLowerCase();\n        if (func = this.commands.state[command]) {\n          return func(command);\n        }\n        try {\n          return this.editor.getDoc().queryCommandState(command);\n        } catch (ex) {\n        }\n        return false;\n      };\n      EditorCommands.prototype.queryCommandValue = function (command) {\n        var func;\n        if (this.editor.quirks.isHidden() || this.editor.removed) {\n          return;\n        }\n        command = command.toLowerCase();\n        if (func = this.commands.value[command]) {\n          return func(command);\n        }\n        try {\n          return this.editor.getDoc().queryCommandValue(command);\n        } catch (ex) {\n        }\n      };\n      EditorCommands.prototype.addCommands = function (commandList, type) {\n        var self = this;\n        type = type || 'exec';\n        each$f(commandList, function (callback, command) {\n          each$f(command.toLowerCase().split(','), function (command) {\n            self.commands[type][command] = callback;\n          });\n        });\n      };\n      EditorCommands.prototype.addCommand = function (command, callback, scope) {\n        var _this = this;\n        command = command.toLowerCase();\n        this.commands.exec[command] = function (command, ui, value, args) {\n          return callback.call(scope || _this.editor, ui, value, args);\n        };\n      };\n      EditorCommands.prototype.queryCommandSupported = function (command) {\n        command = command.toLowerCase();\n        if (this.commands.exec[command]) {\n          return true;\n        }\n        try {\n          return this.editor.getDoc().queryCommandSupported(command);\n        } catch (ex) {\n        }\n        return false;\n      };\n      EditorCommands.prototype.addQueryStateHandler = function (command, callback, scope) {\n        var _this = this;\n        command = command.toLowerCase();\n        this.commands.state[command] = function () {\n          return callback.call(scope || _this.editor);\n        };\n      };\n      EditorCommands.prototype.addQueryValueHandler = function (command, callback, scope) {\n        var _this = this;\n        command = command.toLowerCase();\n        this.commands.value[command] = function () {\n          return callback.call(scope || _this.editor);\n        };\n      };\n      EditorCommands.prototype.hasCustomCommand = function (command) {\n        command = command.toLowerCase();\n        return !!this.commands.exec[command];\n      };\n      EditorCommands.prototype.execNativeCommand = function (command, ui, value) {\n        if (ui === undefined) {\n          ui = false;\n        }\n        if (value === undefined) {\n          value = null;\n        }\n        return this.editor.getDoc().execCommand(command, ui, value);\n      };\n      EditorCommands.prototype.isFormatMatch = function (name) {\n        return this.editor.formatter.match(name);\n      };\n      EditorCommands.prototype.toggleFormat = function (name, value) {\n        this.editor.formatter.toggle(name, value ? { value: value } : undefined);\n        this.editor.nodeChanged();\n      };\n      EditorCommands.prototype.storeSelection = function (type) {\n        this.selectionBookmark = this.editor.selection.getBookmark(type);\n      };\n      EditorCommands.prototype.restoreSelection = function () {\n        this.editor.selection.moveToBookmark(this.selectionBookmark);\n      };\n      EditorCommands.prototype.setupCommands = function (editor) {\n        var self = this;\n        this.addCommands({\n          'mceResetDesignMode,mceBeginUndoLevel': function () {\n          },\n          'mceEndUndoLevel,mceAddUndoLevel': function () {\n            editor.undoManager.add();\n          },\n          'Cut,Copy,Paste': function (command) {\n            var doc = editor.getDoc();\n            var failed;\n            try {\n              self.execNativeCommand(command);\n            } catch (ex) {\n              failed = true;\n            }\n            if (command === 'paste' && !doc.queryCommandEnabled(command)) {\n              failed = true;\n            }\n            if (failed || !doc.queryCommandSupported(command)) {\n              var msg = editor.translate('Your browser doesn\\'t support direct access to the clipboard. ' + 'Please use the Ctrl+X/C/V keyboard shortcuts instead.');\n              if (Env.mac) {\n                msg = msg.replace(/Ctrl\\+/g, '\\u2318+');\n              }\n              editor.notificationManager.open({\n                text: msg,\n                type: 'error'\n              });\n            }\n          },\n          'unlink': function () {\n            if (editor.selection.isCollapsed()) {\n              var elm = editor.dom.getParent(editor.selection.getStart(), 'a');\n              if (elm) {\n                editor.dom.remove(elm, true);\n              }\n              return;\n            }\n            editor.formatter.remove('link');\n          },\n          'JustifyLeft,JustifyCenter,JustifyRight,JustifyFull,JustifyNone': function (command) {\n            var align = command.substring(7);\n            if (align === 'full') {\n              align = 'justify';\n            }\n            each$f('left,center,right,justify'.split(','), function (name) {\n              if (align !== name) {\n                editor.formatter.remove('align' + name);\n              }\n            });\n            if (align !== 'none') {\n              self.toggleFormat('align' + align);\n            }\n          },\n          'InsertUnorderedList,InsertOrderedList': function (command) {\n            var listElm, listParent;\n            self.execNativeCommand(command);\n            listElm = editor.dom.getParent(editor.selection.getNode(), 'ol,ul');\n            if (listElm) {\n              listParent = listElm.parentNode;\n              if (/^(H[1-6]|P|ADDRESS|PRE)$/.test(listParent.nodeName)) {\n                self.storeSelection();\n                editor.dom.split(listParent, listElm);\n                self.restoreSelection();\n              }\n            }\n          },\n          'Bold,Italic,Underline,Strikethrough,Superscript,Subscript': function (command) {\n            self.toggleFormat(command);\n          },\n          'ForeColor,HiliteColor': function (command, ui, value) {\n            self.toggleFormat(command, value);\n          },\n          'FontName': function (command, ui, value) {\n            fontNameAction(editor, value);\n          },\n          'FontSize': function (command, ui, value) {\n            fontSizeAction(editor, value);\n          },\n          'RemoveFormat': function (command) {\n            editor.formatter.remove(command);\n          },\n          'mceBlockQuote': function () {\n            self.toggleFormat('blockquote');\n          },\n          'FormatBlock': function (command, ui, value) {\n            return self.toggleFormat(value || 'p');\n          },\n          'mceCleanup': function () {\n            var bookmark = editor.selection.getBookmark();\n            editor.setContent(editor.getContent());\n            editor.selection.moveToBookmark(bookmark);\n          },\n          'mceRemoveNode': function (command, ui, value) {\n            var node = value || editor.selection.getNode();\n            if (node !== editor.getBody()) {\n              self.storeSelection();\n              editor.dom.remove(node, true);\n              self.restoreSelection();\n            }\n          },\n          'mceSelectNodeDepth': function (command, ui, value) {\n            var counter = 0;\n            editor.dom.getParent(editor.selection.getNode(), function (node) {\n              if (node.nodeType === 1 && counter++ === value) {\n                editor.selection.select(node);\n                return false;\n              }\n            }, editor.getBody());\n          },\n          'mceSelectNode': function (command, ui, value) {\n            editor.selection.select(value);\n          },\n          'mceInsertContent': function (command, ui, value) {\n            InsertContent.insertAtCaret(editor, value);\n          },\n          'mceInsertRawHTML': function (command, ui, value) {\n            editor.selection.setContent('tiny_mce_marker');\n            var content = editor.getContent();\n            editor.setContent(content.replace(/tiny_mce_marker/g, function () {\n              return value;\n            }));\n          },\n          'mceInsertNewLine': function (command, ui, value) {\n            InsertNewLine.insert(editor, value);\n          },\n          'mceToggleFormat': function (command, ui, value) {\n            self.toggleFormat(value);\n          },\n          'mceSetContent': function (command, ui, value) {\n            editor.setContent(value);\n          },\n          'Indent,Outdent': function (command) {\n            handle(editor, command);\n          },\n          'mceRepaint': function () {\n          },\n          'InsertHorizontalRule': function () {\n            editor.execCommand('mceInsertContent', false, '<hr />');\n          },\n          'mceToggleVisualAid': function () {\n            editor.hasVisual = !editor.hasVisual;\n            editor.addVisual();\n          },\n          'mceReplaceContent': function (command, ui, value) {\n            editor.execCommand('mceInsertContent', false, value.replace(/\\{\\$selection\\}/g, editor.selection.getContent({ format: 'text' })));\n          },\n          'mceInsertLink': function (command, ui, value) {\n            var anchor;\n            if (typeof value === 'string') {\n              value = { href: value };\n            }\n            anchor = editor.dom.getParent(editor.selection.getNode(), 'a');\n            value.href = value.href.replace(/ /g, '%20');\n            if (!anchor || !value.href) {\n              editor.formatter.remove('link');\n            }\n            if (value.href) {\n              editor.formatter.apply('link', value, anchor);\n            }\n          },\n          'selectAll': function () {\n            var editingHost = editor.dom.getParent(editor.selection.getStart(), NodeType.isContentEditableTrue);\n            if (editingHost) {\n              var rng = editor.dom.createRng();\n              rng.selectNodeContents(editingHost);\n              editor.selection.setRng(rng);\n            }\n          },\n          'delete': function () {\n            DeleteCommands.deleteCommand(editor);\n          },\n          'forwardDelete': function () {\n            DeleteCommands.forwardDeleteCommand(editor);\n          },\n          'mceNewDocument': function () {\n            editor.setContent('');\n          },\n          'InsertLineBreak': function (command, ui, value) {\n            InsertBr.insert(editor, value);\n            return true;\n          }\n        });\n        var alignStates = function (name) {\n          return function () {\n            var nodes = editor.selection.isCollapsed() ? [editor.dom.getParent(editor.selection.getNode(), editor.dom.isBlock)] : editor.selection.getSelectedBlocks();\n            var matches = map$3(nodes, function (node) {\n              return !!editor.formatter.matchNode(node, name);\n            });\n            return inArray$2(matches, true) !== -1;\n          };\n        };\n        self.addCommands({\n          'JustifyLeft': alignStates('alignleft'),\n          'JustifyCenter': alignStates('aligncenter'),\n          'JustifyRight': alignStates('alignright'),\n          'JustifyFull': alignStates('alignjustify'),\n          'Bold,Italic,Underline,Strikethrough,Superscript,Subscript': function (command) {\n            return self.isFormatMatch(command);\n          },\n          'mceBlockQuote': function () {\n            return self.isFormatMatch('blockquote');\n          },\n          'Outdent': function () {\n            return canOutdent(editor);\n          },\n          'InsertUnorderedList,InsertOrderedList': function (command) {\n            var list = editor.dom.getParent(editor.selection.getNode(), 'ul,ol');\n            return list && (command === 'insertunorderedlist' && list.tagName === 'UL' || command === 'insertorderedlist' && list.tagName === 'OL');\n          }\n        }, 'state');\n        self.addCommands({\n          Undo: function () {\n            editor.undoManager.undo();\n          },\n          Redo: function () {\n            editor.undoManager.redo();\n          }\n        });\n        self.addQueryValueHandler('FontName', function () {\n          return fontNameQuery(editor);\n        }, this);\n        self.addQueryValueHandler('FontSize', function () {\n          return fontSizeQuery(editor);\n        }, this);\n      };\n      return EditorCommands;\n    }();\n\n    var nativeEvents = Tools.makeMap('focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange ' + 'mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover ' + 'draggesture dragdrop drop drag submit ' + 'compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel', ' ');\n    var EventDispatcher = function () {\n      function EventDispatcher(settings) {\n        this.bindings = {};\n        this.settings = settings || {};\n        this.scope = this.settings.scope || this;\n        this.toggleEvent = this.settings.toggleEvent || never;\n      }\n      EventDispatcher.isNative = function (name) {\n        return !!nativeEvents[name.toLowerCase()];\n      };\n      EventDispatcher.prototype.fire = function (name, args) {\n        var handlers, i, l, callback;\n        name = name.toLowerCase();\n        args = args || {};\n        args.type = name;\n        if (!args.target) {\n          args.target = this.scope;\n        }\n        if (!args.preventDefault) {\n          args.preventDefault = function () {\n            args.isDefaultPrevented = always;\n          };\n          args.stopPropagation = function () {\n            args.isPropagationStopped = always;\n          };\n          args.stopImmediatePropagation = function () {\n            args.isImmediatePropagationStopped = always;\n          };\n          args.isDefaultPrevented = never;\n          args.isPropagationStopped = never;\n          args.isImmediatePropagationStopped = never;\n        }\n        if (this.settings.beforeFire) {\n          this.settings.beforeFire(args);\n        }\n        handlers = this.bindings[name];\n        if (handlers) {\n          for (i = 0, l = handlers.length; i < l; i++) {\n            callback = handlers[i];\n            if (callback.once) {\n              this.off(name, callback.func);\n            }\n            if (args.isImmediatePropagationStopped()) {\n              args.stopPropagation();\n              return args;\n            }\n            if (callback.func.call(this.scope, args) === false) {\n              args.preventDefault();\n              return args;\n            }\n          }\n        }\n        return args;\n      };\n      EventDispatcher.prototype.on = function (name, callback, prepend, extra) {\n        var handlers, names, i;\n        if (callback === false) {\n          callback = never;\n        }\n        if (callback) {\n          var wrappedCallback = { func: callback };\n          if (extra) {\n            Tools.extend(wrappedCallback, extra);\n          }\n          names = name.toLowerCase().split(' ');\n          i = names.length;\n          while (i--) {\n            name = names[i];\n            handlers = this.bindings[name];\n            if (!handlers) {\n              handlers = this.bindings[name] = [];\n              this.toggleEvent(name, true);\n            }\n            if (prepend) {\n              handlers.unshift(wrappedCallback);\n            } else {\n              handlers.push(wrappedCallback);\n            }\n          }\n        }\n        return this;\n      };\n      EventDispatcher.prototype.off = function (name, callback) {\n        var i, handlers, bindingName, names, hi;\n        if (name) {\n          names = name.toLowerCase().split(' ');\n          i = names.length;\n          while (i--) {\n            name = names[i];\n            handlers = this.bindings[name];\n            if (!name) {\n              for (bindingName in this.bindings) {\n                this.toggleEvent(bindingName, false);\n                delete this.bindings[bindingName];\n              }\n              return this;\n            }\n            if (handlers) {\n              if (!callback) {\n                handlers.length = 0;\n              } else {\n                hi = handlers.length;\n                while (hi--) {\n                  if (handlers[hi].func === callback) {\n                    handlers = handlers.slice(0, hi).concat(handlers.slice(hi + 1));\n                    this.bindings[name] = handlers;\n                  }\n                }\n              }\n              if (!handlers.length) {\n                this.toggleEvent(name, false);\n                delete this.bindings[name];\n              }\n            }\n          }\n        } else {\n          for (name in this.bindings) {\n            this.toggleEvent(name, false);\n          }\n          this.bindings = {};\n        }\n        return this;\n      };\n      EventDispatcher.prototype.once = function (name, callback, prepend) {\n        return this.on(name, callback, prepend, { once: true });\n      };\n      EventDispatcher.prototype.has = function (name) {\n        name = name.toLowerCase();\n        return !(!this.bindings[name] || this.bindings[name].length === 0);\n      };\n      return EventDispatcher;\n    }();\n\n    var getEventDispatcher = function (obj) {\n      if (!obj._eventDispatcher) {\n        obj._eventDispatcher = new EventDispatcher({\n          scope: obj,\n          toggleEvent: function (name, state) {\n            if (EventDispatcher.isNative(name) && obj.toggleNativeEvent) {\n              obj.toggleNativeEvent(name, state);\n            }\n          }\n        });\n      }\n      return obj._eventDispatcher;\n    };\n    var Observable = {\n      fire: function (name, args, bubble) {\n        var self = this;\n        if (self.removed && name !== 'remove' && name !== 'detach') {\n          return args;\n        }\n        var dispatcherArgs = getEventDispatcher(self).fire(name, args);\n        if (bubble !== false && self.parent) {\n          var parent_1 = self.parent();\n          while (parent_1 && !dispatcherArgs.isPropagationStopped()) {\n            parent_1.fire(name, dispatcherArgs, false);\n            parent_1 = parent_1.parent();\n          }\n        }\n        return dispatcherArgs;\n      },\n      on: function (name, callback, prepend) {\n        return getEventDispatcher(this).on(name, callback, prepend);\n      },\n      off: function (name, callback) {\n        return getEventDispatcher(this).off(name, callback);\n      },\n      once: function (name, callback) {\n        return getEventDispatcher(this).once(name, callback);\n      },\n      hasEventListeners: function (name) {\n        return getEventDispatcher(this).has(name);\n      }\n    };\n\n    var internalContentEditableAttr = 'data-mce-contenteditable';\n    var toggleClass = function (elm, cls, state) {\n      if (has$2(elm, cls) && state === false) {\n        remove$4(elm, cls);\n      } else if (state) {\n        add$3(elm, cls);\n      }\n    };\n    var setEditorCommandState = function (editor, cmd, state) {\n      try {\n        editor.getDoc().execCommand(cmd, false, state);\n      } catch (ex) {\n      }\n    };\n    var setContentEditable = function (elm, state) {\n      elm.dom().contentEditable = state ? 'true' : 'false';\n    };\n    var switchOffContentEditableTrue = function (elm) {\n      each(descendants$1(elm, '*[contenteditable=\"true\"]'), function (elm) {\n        set(elm, internalContentEditableAttr, 'true');\n        setContentEditable(elm, false);\n      });\n    };\n    var switchOnContentEditableTrue = function (elm) {\n      each(descendants$1(elm, '*[' + internalContentEditableAttr + '=\"true\"]'), function (elm) {\n        remove$1(elm, internalContentEditableAttr);\n        setContentEditable(elm, true);\n      });\n    };\n    var removeFakeSelection = function (editor) {\n      Option.from(editor.selection.getNode()).each(function (elm) {\n        elm.removeAttribute('data-mce-selected');\n      });\n    };\n    var restoreFakeSelection = function (editor) {\n      editor.selection.setRng(editor.selection.getRng());\n    };\n    var toggleReadOnly = function (editor, state) {\n      var body = Element.fromDom(editor.getBody());\n      toggleClass(body, 'mce-content-readonly', state);\n      if (state) {\n        editor.selection.controlSelection.hideResizeRect();\n        editor._selectionOverrides.hideFakeCaret();\n        removeFakeSelection(editor);\n        editor.readonly = true;\n        setContentEditable(body, false);\n        switchOffContentEditableTrue(body);\n      } else {\n        editor.readonly = false;\n        setContentEditable(body, true);\n        switchOnContentEditableTrue(body);\n        setEditorCommandState(editor, 'StyleWithCSS', false);\n        setEditorCommandState(editor, 'enableInlineTableEditing', false);\n        setEditorCommandState(editor, 'enableObjectResizing', false);\n        if (EditorFocus.hasEditorOrUiFocus(editor)) {\n          editor.focus();\n        }\n        restoreFakeSelection(editor);\n        editor.nodeChanged();\n      }\n    };\n    var isReadOnly = function (editor) {\n      return editor.readonly === true;\n    };\n    var registerFilters = function (editor) {\n      editor.parser.addAttributeFilter('contenteditable', function (nodes) {\n        if (isReadOnly(editor)) {\n          each(nodes, function (node) {\n            node.attr(internalContentEditableAttr, node.attr('contenteditable'));\n            node.attr('contenteditable', 'false');\n          });\n        }\n      });\n      editor.serializer.addAttributeFilter(internalContentEditableAttr, function (nodes) {\n        if (isReadOnly(editor)) {\n          each(nodes, function (node) {\n            node.attr('contenteditable', node.attr(internalContentEditableAttr));\n          });\n        }\n      });\n      editor.serializer.addTempAttr(internalContentEditableAttr);\n    };\n    var registerReadOnlyContentFilters = function (editor) {\n      if (editor.serializer) {\n        registerFilters(editor);\n      } else {\n        editor.on('PreInit', function () {\n          registerFilters(editor);\n        });\n      }\n    };\n    var isClickEvent = function (e) {\n      return e.type === 'click';\n    };\n    var isInAnchor = function (editor, target) {\n      return editor.dom.getParent(target, 'a') !== null;\n    };\n    var preventReadOnlyEvents = function (editor, e) {\n      var target = e.target;\n      if (isClickEvent(e) && !VK.metaKeyPressed(e) && isInAnchor(editor, target)) {\n        e.preventDefault();\n      }\n    };\n    var registerReadOnlySelectionBlockers = function (editor) {\n      editor.on('ShowCaret', function (e) {\n        if (isReadOnly(editor)) {\n          e.preventDefault();\n        }\n      });\n      editor.on('ObjectSelected', function (e) {\n        if (isReadOnly(editor)) {\n          e.preventDefault();\n        }\n      });\n    };\n\n    var DOM$8 = DOMUtils$1.DOM;\n    var customEventRootDelegates;\n    var getEventTarget = function (editor, eventName) {\n      if (eventName === 'selectionchange') {\n        return editor.getDoc();\n      }\n      if (!editor.inline && /^mouse|touch|click|contextmenu|drop|dragover|dragend/.test(eventName)) {\n        return editor.getDoc().documentElement;\n      }\n      if (editor.settings.event_root) {\n        if (!editor.eventRoot) {\n          editor.eventRoot = DOM$8.select(editor.settings.event_root)[0];\n        }\n        return editor.eventRoot;\n      }\n      return editor.getBody();\n    };\n    var isListening = function (editor) {\n      return !editor.hidden && !isReadOnly(editor);\n    };\n    var fireEvent = function (editor, eventName, e) {\n      if (isListening(editor)) {\n        editor.fire(eventName, e);\n      } else if (isReadOnly(editor)) {\n        preventReadOnlyEvents(editor, e);\n      }\n    };\n    var bindEventDelegate = function (editor, eventName) {\n      var eventRootElm, delegate;\n      if (!editor.delegates) {\n        editor.delegates = {};\n      }\n      if (editor.delegates[eventName] || editor.removed) {\n        return;\n      }\n      eventRootElm = getEventTarget(editor, eventName);\n      if (editor.settings.event_root) {\n        if (!customEventRootDelegates) {\n          customEventRootDelegates = {};\n          editor.editorManager.on('removeEditor', function () {\n            var name;\n            if (!editor.editorManager.activeEditor) {\n              if (customEventRootDelegates) {\n                for (name in customEventRootDelegates) {\n                  editor.dom.unbind(getEventTarget(editor, name));\n                }\n                customEventRootDelegates = null;\n              }\n            }\n          });\n        }\n        if (customEventRootDelegates[eventName]) {\n          return;\n        }\n        delegate = function (e) {\n          var target = e.target;\n          var editors = editor.editorManager.get();\n          var i = editors.length;\n          while (i--) {\n            var body = editors[i].getBody();\n            if (body === target || DOM$8.isChildOf(target, body)) {\n              fireEvent(editors[i], eventName, e);\n            }\n          }\n        };\n        customEventRootDelegates[eventName] = delegate;\n        DOM$8.bind(eventRootElm, eventName, delegate);\n      } else {\n        delegate = function (e) {\n          fireEvent(editor, eventName, e);\n        };\n        DOM$8.bind(eventRootElm, eventName, delegate);\n        editor.delegates[eventName] = delegate;\n      }\n    };\n    var EditorObservable = __assign(__assign({}, Observable), {\n      bindPendingEventDelegates: function () {\n        var self = this;\n        Tools.each(self._pendingNativeEvents, function (name) {\n          bindEventDelegate(self, name);\n        });\n      },\n      toggleNativeEvent: function (name, state) {\n        var self = this;\n        if (name === 'focus' || name === 'blur') {\n          return;\n        }\n        if (state) {\n          if (self.initialized) {\n            bindEventDelegate(self, name);\n          } else {\n            if (!self._pendingNativeEvents) {\n              self._pendingNativeEvents = [name];\n            } else {\n              self._pendingNativeEvents.push(name);\n            }\n          }\n        } else if (self.initialized) {\n          self.dom.unbind(getEventTarget(self, name), name, self.delegates[name]);\n          delete self.delegates[name];\n        }\n      },\n      unbindAllNativeEvents: function () {\n        var self = this;\n        var body = self.getBody();\n        var dom = self.dom;\n        var name;\n        if (self.delegates) {\n          for (name in self.delegates) {\n            self.dom.unbind(getEventTarget(self, name), name, self.delegates[name]);\n          }\n          delete self.delegates;\n        }\n        if (!self.inline && body && dom) {\n          body.onload = null;\n          dom.unbind(self.getWin());\n          dom.unbind(self.getDoc());\n        }\n        if (dom) {\n          dom.unbind(body);\n          dom.unbind(self.getContainer());\n        }\n      }\n    });\n\n    var defaultModes = [\n      'design',\n      'readonly'\n    ];\n    var switchToMode = function (editor, activeMode, availableModes, mode) {\n      var oldMode = availableModes[activeMode.get()];\n      var newMode = availableModes[mode];\n      try {\n        newMode.activate();\n      } catch (e) {\n        domGlobals.console.error('problem while activating editor mode ' + mode + ':', e);\n        return;\n      }\n      oldMode.deactivate();\n      if (oldMode.editorReadOnly !== newMode.editorReadOnly) {\n        toggleReadOnly(editor, newMode.editorReadOnly);\n      }\n      activeMode.set(mode);\n      fireSwitchMode(editor, mode);\n    };\n    var setMode = function (editor, availableModes, activeMode, mode) {\n      if (mode === activeMode.get()) {\n        return;\n      } else if (!has(availableModes, mode)) {\n        throw new Error('Editor mode \\'' + mode + '\\' is invalid');\n      }\n      if (editor.initialized) {\n        switchToMode(editor, activeMode, availableModes, mode);\n      } else {\n        editor.on('init', function () {\n          return switchToMode(editor, activeMode, availableModes, mode);\n        });\n      }\n    };\n    var registerMode = function (availableModes, mode, api) {\n      var _a;\n      if (contains(defaultModes, mode)) {\n        throw new Error('Cannot override default mode ' + mode);\n      }\n      return __assign(__assign({}, availableModes), (_a = {}, _a[mode] = __assign(__assign({}, api), {\n        deactivate: function () {\n          try {\n            api.deactivate();\n          } catch (e) {\n            domGlobals.console.error('problem while deactivating editor mode ' + mode + ':', e);\n          }\n        }\n      }), _a));\n    };\n\n    var create$4 = function (editor) {\n      var activeMode = Cell('design');\n      var availableModes = Cell({\n        design: {\n          activate: noop,\n          deactivate: noop,\n          editorReadOnly: false\n        },\n        readonly: {\n          activate: noop,\n          deactivate: noop,\n          editorReadOnly: true\n        }\n      });\n      registerReadOnlyContentFilters(editor);\n      registerReadOnlySelectionBlockers(editor);\n      return {\n        isReadOnly: function () {\n          return isReadOnly(editor);\n        },\n        set: function (mode) {\n          return setMode(editor, availableModes.get(), activeMode, mode);\n        },\n        get: function () {\n          return activeMode.get();\n        },\n        register: function (mode, api) {\n          availableModes.set(registerMode(availableModes.get(), mode, api));\n        }\n      };\n    };\n\n    var each$g = Tools.each, explode$3 = Tools.explode;\n    var keyCodeLookup = {\n      f1: 112,\n      f2: 113,\n      f3: 114,\n      f4: 115,\n      f5: 116,\n      f6: 117,\n      f7: 118,\n      f8: 119,\n      f9: 120,\n      f10: 121,\n      f11: 122,\n      f12: 123\n    };\n    var modifierNames = Tools.makeMap('alt,ctrl,shift,meta,access');\n    var Shortcuts = function () {\n      function Shortcuts(editor) {\n        this.shortcuts = {};\n        this.pendingPatterns = [];\n        this.editor = editor;\n        var self = this;\n        editor.on('keyup keypress keydown', function (e) {\n          if ((self.hasModifier(e) || self.isFunctionKey(e)) && !e.isDefaultPrevented()) {\n            each$g(self.shortcuts, function (shortcut) {\n              if (self.matchShortcut(e, shortcut)) {\n                self.pendingPatterns = shortcut.subpatterns.slice(0);\n                if (e.type === 'keydown') {\n                  self.executeShortcutAction(shortcut);\n                }\n                return true;\n              }\n            });\n            if (self.matchShortcut(e, self.pendingPatterns[0])) {\n              if (self.pendingPatterns.length === 1) {\n                if (e.type === 'keydown') {\n                  self.executeShortcutAction(self.pendingPatterns[0]);\n                }\n              }\n              self.pendingPatterns.shift();\n            }\n          }\n        });\n      }\n      Shortcuts.prototype.add = function (pattern, desc, cmdFunc, scope) {\n        var self = this;\n        var cmd;\n        cmd = cmdFunc;\n        if (typeof cmdFunc === 'string') {\n          cmdFunc = function () {\n            self.editor.execCommand(cmd, false, null);\n          };\n        } else if (Tools.isArray(cmd)) {\n          cmdFunc = function () {\n            self.editor.execCommand(cmd[0], cmd[1], cmd[2]);\n          };\n        }\n        each$g(explode$3(Tools.trim(pattern)), function (pattern) {\n          var shortcut = self.createShortcut(pattern, desc, cmdFunc, scope);\n          self.shortcuts[shortcut.id] = shortcut;\n        });\n        return true;\n      };\n      Shortcuts.prototype.remove = function (pattern) {\n        var shortcut = this.createShortcut(pattern);\n        if (this.shortcuts[shortcut.id]) {\n          delete this.shortcuts[shortcut.id];\n          return true;\n        }\n        return false;\n      };\n      Shortcuts.prototype.parseShortcut = function (pattern) {\n        var id, key;\n        var shortcut = {};\n        each$g(explode$3(pattern.toLowerCase(), '+'), function (value) {\n          if (value in modifierNames) {\n            shortcut[value] = true;\n          } else {\n            if (/^[0-9]{2,}$/.test(value)) {\n              shortcut.keyCode = parseInt(value, 10);\n            } else {\n              shortcut.charCode = value.charCodeAt(0);\n              shortcut.keyCode = keyCodeLookup[value] || value.toUpperCase().charCodeAt(0);\n            }\n          }\n        });\n        id = [shortcut.keyCode];\n        for (key in modifierNames) {\n          if (shortcut[key]) {\n            id.push(key);\n          } else {\n            shortcut[key] = false;\n          }\n        }\n        shortcut.id = id.join(',');\n        if (shortcut.access) {\n          shortcut.alt = true;\n          if (Env.mac) {\n            shortcut.ctrl = true;\n          } else {\n            shortcut.shift = true;\n          }\n        }\n        if (shortcut.meta) {\n          if (Env.mac) {\n            shortcut.meta = true;\n          } else {\n            shortcut.ctrl = true;\n            shortcut.meta = false;\n          }\n        }\n        return shortcut;\n      };\n      Shortcuts.prototype.createShortcut = function (pattern, desc, cmdFunc, scope) {\n        var shortcuts;\n        shortcuts = Tools.map(explode$3(pattern, '>'), this.parseShortcut);\n        shortcuts[shortcuts.length - 1] = Tools.extend(shortcuts[shortcuts.length - 1], {\n          func: cmdFunc,\n          scope: scope || this.editor\n        });\n        return Tools.extend(shortcuts[0], {\n          desc: this.editor.translate(desc),\n          subpatterns: shortcuts.slice(1)\n        });\n      };\n      Shortcuts.prototype.hasModifier = function (e) {\n        return e.altKey || e.ctrlKey || e.metaKey;\n      };\n      Shortcuts.prototype.isFunctionKey = function (e) {\n        return e.type === 'keydown' && e.keyCode >= 112 && e.keyCode <= 123;\n      };\n      Shortcuts.prototype.matchShortcut = function (e, shortcut) {\n        if (!shortcut) {\n          return false;\n        }\n        if (shortcut.ctrl !== e.ctrlKey || shortcut.meta !== e.metaKey) {\n          return false;\n        }\n        if (shortcut.alt !== e.altKey || shortcut.shift !== e.shiftKey) {\n          return false;\n        }\n        if (e.keyCode === shortcut.keyCode || e.charCode && e.charCode === shortcut.charCode) {\n          e.preventDefault();\n          return true;\n        }\n        return false;\n      };\n      Shortcuts.prototype.executeShortcutAction = function (shortcut) {\n        return shortcut.func ? shortcut.func.call(shortcut.scope) : null;\n      };\n      return Shortcuts;\n    }();\n\n    var create$5 = function () {\n      var buttons = {};\n      var menuItems = {};\n      var popups = {};\n      var icons = {};\n      var contextMenus = {};\n      var contextToolbars = {};\n      var sidebars = {};\n      var add = function (collection, type) {\n        return function (name, spec) {\n          return collection[name.toLowerCase()] = __assign(__assign({}, spec), { type: type });\n        };\n      };\n      var addIcon = function (name, svgData) {\n        return icons[name.toLowerCase()] = svgData;\n      };\n      return {\n        addButton: add(buttons, 'button'),\n        addGroupToolbarButton: add(buttons, 'grouptoolbarbutton'),\n        addToggleButton: add(buttons, 'togglebutton'),\n        addMenuButton: add(buttons, 'menubutton'),\n        addSplitButton: add(buttons, 'splitbutton'),\n        addMenuItem: add(menuItems, 'menuitem'),\n        addNestedMenuItem: add(menuItems, 'nestedmenuitem'),\n        addToggleMenuItem: add(menuItems, 'togglemenuitem'),\n        addAutocompleter: add(popups, 'autocompleter'),\n        addContextMenu: add(contextMenus, 'contextmenu'),\n        addContextToolbar: add(contextToolbars, 'contexttoolbar'),\n        addContextForm: add(contextToolbars, 'contextform'),\n        addSidebar: add(sidebars, 'sidebar'),\n        addIcon: addIcon,\n        getAll: function () {\n          return {\n            buttons: buttons,\n            menuItems: menuItems,\n            icons: icons,\n            popups: popups,\n            contextMenus: contextMenus,\n            contextToolbars: contextToolbars,\n            sidebars: sidebars\n          };\n        }\n      };\n    };\n\n    var registry = function () {\n      var bridge = create$5();\n      return {\n        addAutocompleter: bridge.addAutocompleter,\n        addButton: bridge.addButton,\n        addContextForm: bridge.addContextForm,\n        addContextMenu: bridge.addContextMenu,\n        addContextToolbar: bridge.addContextToolbar,\n        addIcon: bridge.addIcon,\n        addMenuButton: bridge.addMenuButton,\n        addMenuItem: bridge.addMenuItem,\n        addNestedMenuItem: bridge.addNestedMenuItem,\n        addSidebar: bridge.addSidebar,\n        addSplitButton: bridge.addSplitButton,\n        addToggleButton: bridge.addToggleButton,\n        addGroupToolbarButton: bridge.addGroupToolbarButton,\n        addToggleMenuItem: bridge.addToggleMenuItem,\n        getAll: bridge.getAll\n      };\n    };\n\n    var each$h = Tools.each, trim$4 = Tools.trim;\n    var queryParts = 'source protocol authority userInfo user password host port relative path directory file query anchor'.split(' ');\n    var DEFAULT_PORTS = {\n      ftp: 21,\n      http: 80,\n      https: 443,\n      mailto: 25\n    };\n    var URI = function () {\n      function URI(url, settings) {\n        url = trim$4(url);\n        this.settings = settings || {};\n        var baseUri = this.settings.base_uri;\n        var self = this;\n        if (/^([\\w\\-]+):([^\\/]{2})/i.test(url) || /^\\s*#/.test(url)) {\n          self.source = url;\n          return;\n        }\n        var isProtocolRelative = url.indexOf('//') === 0;\n        if (url.indexOf('/') === 0 && !isProtocolRelative) {\n          url = (baseUri ? baseUri.protocol || 'http' : 'http') + '://mce_host' + url;\n        }\n        if (!/^[\\w\\-]*:?\\/\\//.test(url)) {\n          var baseUrl = this.settings.base_uri ? this.settings.base_uri.path : new URI(domGlobals.document.location.href).directory;\n          if (this.settings.base_uri && this.settings.base_uri.protocol == '') {\n            url = '//mce_host' + self.toAbsPath(baseUrl, url);\n          } else {\n            var match = /([^#?]*)([#?]?.*)/.exec(url);\n            url = (baseUri && baseUri.protocol || 'http') + '://mce_host' + self.toAbsPath(baseUrl, match[1]) + match[2];\n          }\n        }\n        url = url.replace(/@@/g, '(mce_at)');\n        var urlMatch = /^(?:(?![^:@]+:[^:@\\/]*@)([^:\\/?#.]+):)?(?:\\/\\/)?((?:(([^:@\\/]*):?([^:@\\/]*))?@)?([^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/.exec(url);\n        each$h(queryParts, function (v, i) {\n          var part = urlMatch[i];\n          if (part) {\n            part = part.replace(/\\(mce_at\\)/g, '@@');\n          }\n          self[v] = part;\n        });\n        if (baseUri) {\n          if (!self.protocol) {\n            self.protocol = baseUri.protocol;\n          }\n          if (!self.userInfo) {\n            self.userInfo = baseUri.userInfo;\n          }\n          if (!self.port && self.host === 'mce_host') {\n            self.port = baseUri.port;\n          }\n          if (!self.host || self.host === 'mce_host') {\n            self.host = baseUri.host;\n          }\n          self.source = '';\n        }\n        if (isProtocolRelative) {\n          self.protocol = '';\n        }\n      }\n      URI.parseDataUri = function (uri) {\n        var type;\n        var uriComponents = decodeURIComponent(uri).split(',');\n        var matches = /data:([^;]+)/.exec(uriComponents[0]);\n        if (matches) {\n          type = matches[1];\n        }\n        return {\n          type: type,\n          data: uriComponents[1]\n        };\n      };\n      URI.getDocumentBaseUrl = function (loc) {\n        var baseUrl;\n        if (loc.protocol.indexOf('http') !== 0 && loc.protocol !== 'file:') {\n          baseUrl = loc.href;\n        } else {\n          baseUrl = loc.protocol + '//' + loc.host + loc.pathname;\n        }\n        if (/^[^:]+:\\/\\/\\/?[^\\/]+\\//.test(baseUrl)) {\n          baseUrl = baseUrl.replace(/[\\?#].*$/, '').replace(/[\\/\\\\][^\\/]+$/, '');\n          if (!/[\\/\\\\]$/.test(baseUrl)) {\n            baseUrl += '/';\n          }\n        }\n        return baseUrl;\n      };\n      URI.prototype.setPath = function (path) {\n        var pathMatch = /^(.*?)\\/?(\\w+)?$/.exec(path);\n        this.path = pathMatch[0];\n        this.directory = pathMatch[1];\n        this.file = pathMatch[2];\n        this.source = '';\n        this.getURI();\n      };\n      URI.prototype.toRelative = function (uri) {\n        var output;\n        if (uri === './') {\n          return uri;\n        }\n        var relativeUri = new URI(uri, { base_uri: this });\n        if (relativeUri.host !== 'mce_host' && this.host !== relativeUri.host && relativeUri.host || this.port !== relativeUri.port || this.protocol !== relativeUri.protocol && relativeUri.protocol !== '') {\n          return relativeUri.getURI();\n        }\n        var tu = this.getURI(), uu = relativeUri.getURI();\n        if (tu === uu || tu.charAt(tu.length - 1) === '/' && tu.substr(0, tu.length - 1) === uu) {\n          return tu;\n        }\n        output = this.toRelPath(this.path, relativeUri.path);\n        if (relativeUri.query) {\n          output += '?' + relativeUri.query;\n        }\n        if (relativeUri.anchor) {\n          output += '#' + relativeUri.anchor;\n        }\n        return output;\n      };\n      URI.prototype.toAbsolute = function (uri, noHost) {\n        var absoluteUri = new URI(uri, { base_uri: this });\n        return absoluteUri.getURI(noHost && this.isSameOrigin(absoluteUri));\n      };\n      URI.prototype.isSameOrigin = function (uri) {\n        if (this.host == uri.host && this.protocol == uri.protocol) {\n          if (this.port == uri.port) {\n            return true;\n          }\n          var defaultPort = DEFAULT_PORTS[this.protocol];\n          if (defaultPort && (this.port || defaultPort) == (uri.port || defaultPort)) {\n            return true;\n          }\n        }\n        return false;\n      };\n      URI.prototype.toRelPath = function (base, path) {\n        var items, breakPoint = 0, out = '', i, l;\n        var normalizedBase = base.substring(0, base.lastIndexOf('/')).split('/');\n        items = path.split('/');\n        if (normalizedBase.length >= items.length) {\n          for (i = 0, l = normalizedBase.length; i < l; i++) {\n            if (i >= items.length || normalizedBase[i] !== items[i]) {\n              breakPoint = i + 1;\n              break;\n            }\n          }\n        }\n        if (normalizedBase.length < items.length) {\n          for (i = 0, l = items.length; i < l; i++) {\n            if (i >= normalizedBase.length || normalizedBase[i] !== items[i]) {\n              breakPoint = i + 1;\n              break;\n            }\n          }\n        }\n        if (breakPoint === 1) {\n          return path;\n        }\n        for (i = 0, l = normalizedBase.length - (breakPoint - 1); i < l; i++) {\n          out += '../';\n        }\n        for (i = breakPoint - 1, l = items.length; i < l; i++) {\n          if (i !== breakPoint - 1) {\n            out += '/' + items[i];\n          } else {\n            out += items[i];\n          }\n        }\n        return out;\n      };\n      URI.prototype.toAbsPath = function (base, path) {\n        var i, nb = 0, o = [], tr, outPath;\n        tr = /\\/$/.test(path) ? '/' : '';\n        var normalizedBase = base.split('/');\n        var normalizedPath = path.split('/');\n        each$h(normalizedBase, function (k) {\n          if (k) {\n            o.push(k);\n          }\n        });\n        normalizedBase = o;\n        for (i = normalizedPath.length - 1, o = []; i >= 0; i--) {\n          if (normalizedPath[i].length === 0 || normalizedPath[i] === '.') {\n            continue;\n          }\n          if (normalizedPath[i] === '..') {\n            nb++;\n            continue;\n          }\n          if (nb > 0) {\n            nb--;\n            continue;\n          }\n          o.push(normalizedPath[i]);\n        }\n        i = normalizedBase.length - nb;\n        if (i <= 0) {\n          outPath = reverse(o).join('/');\n        } else {\n          outPath = normalizedBase.slice(0, i).join('/') + '/' + reverse(o).join('/');\n        }\n        if (outPath.indexOf('/') !== 0) {\n          outPath = '/' + outPath;\n        }\n        if (tr && outPath.lastIndexOf('/') !== outPath.length - 1) {\n          outPath += tr;\n        }\n        return outPath;\n      };\n      URI.prototype.getURI = function (noProtoHost) {\n        if (noProtoHost === void 0) {\n          noProtoHost = false;\n        }\n        var s;\n        if (!this.source || noProtoHost) {\n          s = '';\n          if (!noProtoHost) {\n            if (this.protocol) {\n              s += this.protocol + '://';\n            } else {\n              s += '//';\n            }\n            if (this.userInfo) {\n              s += this.userInfo + '@';\n            }\n            if (this.host) {\n              s += this.host;\n            }\n            if (this.port) {\n              s += ':' + this.port;\n            }\n          }\n          if (this.path) {\n            s += this.path;\n          }\n          if (this.query) {\n            s += '?' + this.query;\n          }\n          if (this.anchor) {\n            s += '#' + this.anchor;\n          }\n          this.source = s;\n        }\n        return this.source;\n      };\n      return URI;\n    }();\n\n    var DOM$9 = DOMUtils$1.DOM;\n    var extend$3 = Tools.extend, each$i = Tools.each;\n    var resolve$3 = Tools.resolve;\n    var ie$1 = Env.ie;\n    var Editor = function () {\n      function Editor(id, settings, editorManager) {\n        var _this = this;\n        this.plugins = {};\n        this.contentCSS = [];\n        this.contentStyles = [];\n        this.loadedCSS = {};\n        this.isNotDirty = false;\n        this.editorManager = editorManager;\n        this.documentBaseUrl = editorManager.documentBaseURL;\n        extend$3(this, EditorObservable);\n        this.settings = getEditorSettings(this, id, this.documentBaseUrl, editorManager.defaultSettings, settings);\n        if (this.settings.suffix) {\n          editorManager.suffix = this.settings.suffix;\n        }\n        this.suffix = editorManager.suffix;\n        if (this.settings.base_url) {\n          editorManager._setBaseUrl(this.settings.base_url);\n        }\n        this.baseUri = editorManager.baseURI;\n        if (this.settings.referrer_policy) {\n          ScriptLoader.ScriptLoader._setReferrerPolicy(this.settings.referrer_policy);\n          DOMUtils$1.DOM.styleSheetLoader._setReferrerPolicy(this.settings.referrer_policy);\n        }\n        AddOnManager$1.languageLoad = this.settings.language_load;\n        AddOnManager$1.baseURL = editorManager.baseURL;\n        this.id = id;\n        this.setDirty(false);\n        this.documentBaseURI = new URI(this.settings.document_base_url, { base_uri: this.baseUri });\n        this.baseURI = this.baseUri;\n        this.inline = !!this.settings.inline;\n        this.shortcuts = new Shortcuts(this);\n        this.editorCommands = new EditorCommands(this);\n        if (this.settings.cache_suffix) {\n          Env.cacheSuffix = this.settings.cache_suffix.replace(/^[\\?\\&]+/, '');\n        }\n        this.ui = { registry: registry() };\n        var self = this;\n        var modeInstance = create$4(self);\n        this.mode = modeInstance;\n        this.setMode = modeInstance.set;\n        editorManager.fire('SetupEditor', { editor: this });\n        this.execCallback('setup', this);\n        this.$ = DomQuery.overrideDefaults(function () {\n          return {\n            context: _this.inline ? _this.getBody() : _this.getDoc(),\n            element: _this.getBody()\n          };\n        });\n      }\n      Editor.prototype.render = function () {\n        Render.render(this);\n      };\n      Editor.prototype.focus = function (skipFocus) {\n        EditorFocus.focus(this, skipFocus);\n      };\n      Editor.prototype.hasFocus = function () {\n        return EditorFocus.hasFocus(this);\n      };\n      Editor.prototype.execCallback = function (name) {\n        var x = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n          x[_i - 1] = arguments[_i];\n        }\n        var self = this;\n        var callback = self.settings[name], scope;\n        if (!callback) {\n          return;\n        }\n        if (self.callbackLookup && (scope = self.callbackLookup[name])) {\n          callback = scope.func;\n          scope = scope.scope;\n        }\n        if (typeof callback === 'string') {\n          scope = callback.replace(/\\.\\w+$/, '');\n          scope = scope ? resolve$3(scope) : 0;\n          callback = resolve$3(callback);\n          self.callbackLookup = self.callbackLookup || {};\n          self.callbackLookup[name] = {\n            func: callback,\n            scope: scope\n          };\n        }\n        return callback.apply(scope || self, Array.prototype.slice.call(arguments, 1));\n      };\n      Editor.prototype.translate = function (text) {\n        return I18n.translate(text);\n      };\n      Editor.prototype.getParam = function (name, defaultVal, type) {\n        return getParam(this, name, defaultVal, type);\n      };\n      Editor.prototype.nodeChanged = function (args) {\n        this._nodeChangeDispatcher.nodeChanged(args);\n      };\n      Editor.prototype.addCommand = function (name, callback, scope) {\n        this.editorCommands.addCommand(name, callback, scope);\n      };\n      Editor.prototype.addQueryStateHandler = function (name, callback, scope) {\n        this.editorCommands.addQueryStateHandler(name, callback, scope);\n      };\n      Editor.prototype.addQueryValueHandler = function (name, callback, scope) {\n        this.editorCommands.addQueryValueHandler(name, callback, scope);\n      };\n      Editor.prototype.addShortcut = function (pattern, desc, cmdFunc, scope) {\n        this.shortcuts.add(pattern, desc, cmdFunc, scope);\n      };\n      Editor.prototype.execCommand = function (cmd, ui, value, args) {\n        return this.editorCommands.execCommand(cmd, ui, value, args);\n      };\n      Editor.prototype.queryCommandState = function (cmd) {\n        return this.editorCommands.queryCommandState(cmd);\n      };\n      Editor.prototype.queryCommandValue = function (cmd) {\n        return this.editorCommands.queryCommandValue(cmd);\n      };\n      Editor.prototype.queryCommandSupported = function (cmd) {\n        return this.editorCommands.queryCommandSupported(cmd);\n      };\n      Editor.prototype.show = function () {\n        var self = this;\n        if (self.hidden) {\n          self.hidden = false;\n          if (self.inline) {\n            self.getBody().contentEditable = 'true';\n          } else {\n            DOM$9.show(self.getContainer());\n            DOM$9.hide(self.id);\n          }\n          self.load();\n          self.fire('show');\n        }\n      };\n      Editor.prototype.hide = function () {\n        var self = this, doc = self.getDoc();\n        if (!self.hidden) {\n          if (ie$1 && doc && !self.inline) {\n            doc.execCommand('SelectAll');\n          }\n          self.save();\n          if (self.inline) {\n            self.getBody().contentEditable = 'false';\n            if (self === self.editorManager.focusedEditor) {\n              self.editorManager.focusedEditor = null;\n            }\n          } else {\n            DOM$9.hide(self.getContainer());\n            DOM$9.setStyle(self.id, 'display', self.orgDisplay);\n          }\n          self.hidden = true;\n          self.fire('hide');\n        }\n      };\n      Editor.prototype.isHidden = function () {\n        return !!this.hidden;\n      };\n      Editor.prototype.setProgressState = function (state, time) {\n        this.fire('ProgressState', {\n          state: state,\n          time: time\n        });\n      };\n      Editor.prototype.load = function (args) {\n        var self = this;\n        var elm = self.getElement(), html;\n        if (self.removed) {\n          return '';\n        }\n        if (elm) {\n          args = args || {};\n          args.load = true;\n          var value = NodeType.isTextareaOrInput(elm) ? elm.value : elm.innerHTML;\n          html = self.setContent(value, args);\n          args.element = elm;\n          if (!args.no_events) {\n            self.fire('LoadContent', args);\n          }\n          args.element = elm = null;\n          return html;\n        }\n      };\n      Editor.prototype.save = function (args) {\n        var self = this;\n        var elm = self.getElement(), html, form;\n        if (!elm || !self.initialized || self.removed) {\n          return;\n        }\n        args = args || {};\n        args.save = true;\n        args.element = elm;\n        html = args.content = self.getContent(args);\n        if (!args.no_events) {\n          self.fire('SaveContent', args);\n        }\n        if (args.format === 'raw') {\n          self.fire('RawSaveContent', args);\n        }\n        html = args.content;\n        if (!NodeType.isTextareaOrInput(elm)) {\n          if (args.is_removing || !self.inline) {\n            elm.innerHTML = html;\n          }\n          if (form = DOM$9.getParent(self.id, 'form')) {\n            each$i(form.elements, function (elm) {\n              if (elm.name === self.id) {\n                elm.value = html;\n                return false;\n              }\n            });\n          }\n        } else {\n          elm.value = html;\n        }\n        args.element = elm = null;\n        if (args.set_dirty !== false) {\n          self.setDirty(false);\n        }\n        return html;\n      };\n      Editor.prototype.setContent = function (content, args) {\n        return setContent(this, content, args);\n      };\n      Editor.prototype.getContent = function (args) {\n        return getContent(this, args);\n      };\n      Editor.prototype.insertContent = function (content, args) {\n        if (args) {\n          content = extend$3({ content: content }, args);\n        }\n        this.execCommand('mceInsertContent', false, content);\n      };\n      Editor.prototype.resetContent = function (initialContent) {\n        if (initialContent === undefined) {\n          setContent(this, this.startContent, { format: 'raw' });\n        } else {\n          setContent(this, initialContent);\n        }\n        this.undoManager.reset();\n        this.setDirty(false);\n        this.nodeChanged();\n      };\n      Editor.prototype.isDirty = function () {\n        return !this.isNotDirty;\n      };\n      Editor.prototype.setDirty = function (state) {\n        var oldState = !this.isNotDirty;\n        this.isNotDirty = !state;\n        if (state && state !== oldState) {\n          this.fire('dirty');\n        }\n      };\n      Editor.prototype.getContainer = function () {\n        var self = this;\n        if (!self.container) {\n          self.container = DOM$9.get(self.editorContainer || self.id + '_parent');\n        }\n        return self.container;\n      };\n      Editor.prototype.getContentAreaContainer = function () {\n        return this.contentAreaContainer;\n      };\n      Editor.prototype.getElement = function () {\n        if (!this.targetElm) {\n          this.targetElm = DOM$9.get(this.id);\n        }\n        return this.targetElm;\n      };\n      Editor.prototype.getWin = function () {\n        var self = this;\n        var elm;\n        if (!self.contentWindow) {\n          elm = self.iframeElement;\n          if (elm) {\n            self.contentWindow = elm.contentWindow;\n          }\n        }\n        return self.contentWindow;\n      };\n      Editor.prototype.getDoc = function () {\n        var self = this;\n        var win;\n        if (!self.contentDocument) {\n          win = self.getWin();\n          if (win) {\n            self.contentDocument = win.document;\n          }\n        }\n        return self.contentDocument;\n      };\n      Editor.prototype.getBody = function () {\n        var doc = this.getDoc();\n        return this.bodyElement || (doc ? doc.body : null);\n      };\n      Editor.prototype.convertURL = function (url, name, elm) {\n        var self = this, settings = self.settings;\n        if (settings.urlconverter_callback) {\n          return self.execCallback('urlconverter_callback', url, elm, true, name);\n        }\n        if (!settings.convert_urls || elm && elm.nodeName === 'LINK' || url.indexOf('file:') === 0 || url.length === 0) {\n          return url;\n        }\n        if (settings.relative_urls) {\n          return self.documentBaseURI.toRelative(url);\n        }\n        url = self.documentBaseURI.toAbsolute(url, settings.remove_script_host);\n        return url;\n      };\n      Editor.prototype.addVisual = function (elm) {\n        var self = this;\n        var settings = self.settings;\n        var dom = self.dom;\n        var cls;\n        elm = elm || self.getBody();\n        if (self.hasVisual === undefined) {\n          self.hasVisual = settings.visual;\n        }\n        each$i(dom.select('table,a', elm), function (elm) {\n          var value;\n          switch (elm.nodeName) {\n          case 'TABLE':\n            cls = settings.visual_table_class || 'mce-item-table';\n            value = dom.getAttrib(elm, 'border');\n            if ((!value || value === '0') && self.hasVisual) {\n              dom.addClass(elm, cls);\n            } else {\n              dom.removeClass(elm, cls);\n            }\n            return;\n          case 'A':\n            if (!dom.getAttrib(elm, 'href')) {\n              value = dom.getAttrib(elm, 'name') || elm.id;\n              cls = settings.visual_anchor_class || 'mce-item-anchor';\n              if (value && self.hasVisual) {\n                dom.addClass(elm, cls);\n              } else {\n                dom.removeClass(elm, cls);\n              }\n            }\n            return;\n          }\n        });\n        self.fire('VisualAid', {\n          element: elm,\n          hasVisual: self.hasVisual\n        });\n      };\n      Editor.prototype.remove = function () {\n        remove$6(this);\n      };\n      Editor.prototype.destroy = function (automatic) {\n        destroy(this, automatic);\n      };\n      Editor.prototype.uploadImages = function (callback) {\n        return this.editorUpload.uploadImages(callback);\n      };\n      Editor.prototype._scanForImages = function () {\n        return this.editorUpload.scanForImages();\n      };\n      Editor.prototype.addButton = function () {\n        throw new Error('editor.addButton has been removed in tinymce 5x, use editor.ui.registry.addButton or editor.ui.registry.addToggleButton or editor.ui.registry.addSplitButton instead');\n      };\n      Editor.prototype.addSidebar = function () {\n        throw new Error('editor.addSidebar has been removed in tinymce 5x, use editor.ui.registry.addSidebar instead');\n      };\n      Editor.prototype.addMenuItem = function () {\n        throw new Error('editor.addMenuItem has been removed in tinymce 5x, use editor.ui.registry.addMenuItem instead');\n      };\n      Editor.prototype.addContextToolbar = function () {\n        throw new Error('editor.addContextToolbar has been removed in tinymce 5x, use editor.ui.registry.addContextToolbar instead');\n      };\n      return Editor;\n    }();\n\n    var DOM$a = DOMUtils$1.DOM;\n    var explode$4 = Tools.explode, each$j = Tools.each, extend$4 = Tools.extend;\n    var instanceCounter = 0, boundGlobalEvents = false;\n    var beforeUnloadDelegate;\n    var legacyEditors = [];\n    var editors = [];\n    var isValidLegacyKey = function (id) {\n      return id !== 'length';\n    };\n    var globalEventDelegate = function (e) {\n      var type = e.type;\n      each$j(EditorManager.get(), function (editor) {\n        switch (type) {\n        case 'scroll':\n          editor.fire('ScrollWindow', e);\n          break;\n        case 'resize':\n          editor.fire('ResizeWindow', e);\n          break;\n        }\n      });\n    };\n    var toggleGlobalEvents = function (state) {\n      if (state !== boundGlobalEvents) {\n        if (state) {\n          DomQuery(window).on('resize scroll', globalEventDelegate);\n        } else {\n          DomQuery(window).off('resize scroll', globalEventDelegate);\n        }\n        boundGlobalEvents = state;\n      }\n    };\n    var removeEditorFromList = function (targetEditor) {\n      var oldEditors = editors;\n      delete legacyEditors[targetEditor.id];\n      for (var i = 0; i < legacyEditors.length; i++) {\n        if (legacyEditors[i] === targetEditor) {\n          legacyEditors.splice(i, 1);\n          break;\n        }\n      }\n      editors = filter(editors, function (editor) {\n        return targetEditor !== editor;\n      });\n      if (EditorManager.activeEditor === targetEditor) {\n        EditorManager.activeEditor = editors.length > 0 ? editors[0] : null;\n      }\n      if (EditorManager.focusedEditor === targetEditor) {\n        EditorManager.focusedEditor = null;\n      }\n      return oldEditors.length !== editors.length;\n    };\n    var purgeDestroyedEditor = function (editor) {\n      if (editor && editor.initialized && !(editor.getContainer() || editor.getBody()).parentNode) {\n        removeEditorFromList(editor);\n        editor.unbindAllNativeEvents();\n        editor.destroy(true);\n        editor.removed = true;\n        editor = null;\n      }\n      return editor;\n    };\n    var isQuirksMode = domGlobals.document.compatMode !== 'CSS1Compat';\n    var EditorManager = __assign(__assign({}, Observable), {\n      baseURI: null,\n      baseURL: null,\n      defaultSettings: {},\n      documentBaseURL: null,\n      suffix: null,\n      $: DomQuery,\n      majorVersion: '5',\n      minorVersion: '2.0',\n      releaseDate: '2020-02-13',\n      editors: legacyEditors,\n      i18n: I18n,\n      activeEditor: null,\n      focusedEditor: null,\n      settings: {},\n      setup: function () {\n        var self = this;\n        var baseURL, documentBaseURL, suffix = '';\n        documentBaseURL = URI.getDocumentBaseUrl(domGlobals.document.location);\n        if (/^[^:]+:\\/\\/\\/?[^\\/]+\\//.test(documentBaseURL)) {\n          documentBaseURL = documentBaseURL.replace(/[\\?#].*$/, '').replace(/[\\/\\\\][^\\/]+$/, '');\n          if (!/[\\/\\\\]$/.test(documentBaseURL)) {\n            documentBaseURL += '/';\n          }\n        }\n        var preInit = window.tinymce || window.tinyMCEPreInit;\n        if (preInit) {\n          baseURL = preInit.base || preInit.baseURL;\n          suffix = preInit.suffix;\n        } else {\n          var scripts = domGlobals.document.getElementsByTagName('script');\n          for (var i = 0; i < scripts.length; i++) {\n            var src = scripts[i].src || '';\n            if (src === '') {\n              continue;\n            }\n            var srcScript = src.substring(src.lastIndexOf('/'));\n            if (/tinymce(\\.full|\\.jquery|)(\\.min|\\.dev|)\\.js/.test(src)) {\n              if (srcScript.indexOf('.min') !== -1) {\n                suffix = '.min';\n              }\n              baseURL = src.substring(0, src.lastIndexOf('/'));\n              break;\n            }\n          }\n          if (!baseURL && domGlobals.document.currentScript) {\n            var src = domGlobals.document.currentScript.src;\n            if (src.indexOf('.min') !== -1) {\n              suffix = '.min';\n            }\n            baseURL = src.substring(0, src.lastIndexOf('/'));\n          }\n        }\n        self.baseURL = new URI(documentBaseURL).toAbsolute(baseURL);\n        self.documentBaseURL = documentBaseURL;\n        self.baseURI = new URI(self.baseURL);\n        self.suffix = suffix;\n        FocusController.setup(self);\n      },\n      overrideDefaults: function (defaultSettings) {\n        var baseUrl, suffix;\n        baseUrl = defaultSettings.base_url;\n        if (baseUrl) {\n          this._setBaseUrl(baseUrl);\n        }\n        suffix = defaultSettings.suffix;\n        if (defaultSettings.suffix) {\n          this.suffix = suffix;\n        }\n        this.defaultSettings = defaultSettings;\n        var pluginBaseUrls = defaultSettings.plugin_base_urls;\n        for (var name_1 in pluginBaseUrls) {\n          AddOnManager$1.PluginManager.urls[name_1] = pluginBaseUrls[name_1];\n        }\n      },\n      init: function (settings) {\n        var self = this;\n        var result, invalidInlineTargets;\n        invalidInlineTargets = Tools.makeMap('area base basefont br col frame hr img input isindex link meta param embed source wbr track ' + 'colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu', ' ');\n        var isInvalidInlineTarget = function (settings, elm) {\n          return settings.inline && elm.tagName.toLowerCase() in invalidInlineTargets;\n        };\n        var createId = function (elm) {\n          var id = elm.id;\n          if (!id) {\n            id = elm.name;\n            if (id && !DOM$a.get(id)) {\n              id = elm.name;\n            } else {\n              id = DOM$a.uniqueId();\n            }\n            elm.setAttribute('id', id);\n          }\n          return id;\n        };\n        var execCallback = function (name) {\n          var callback = settings[name];\n          if (!callback) {\n            return;\n          }\n          return callback.apply(self, Array.prototype.slice.call(arguments, 2));\n        };\n        var hasClass = function (elm, className) {\n          return className.constructor === RegExp ? className.test(elm.className) : DOM$a.hasClass(elm, className);\n        };\n        var findTargets = function (settings) {\n          var l, targets = [];\n          if (Env.browser.isIE() && Env.browser.version.major < 11) {\n            ErrorReporter.initError('TinyMCE does not support the browser you are using. For a list of supported' + ' browsers please see: https://www.tinymce.com/docs/get-started/system-requirements/');\n            return [];\n          } else if (isQuirksMode) {\n            ErrorReporter.initError('Failed to initialize the editor as the document is not in standards mode. ' + 'TinyMCE requires standards mode.');\n            return [];\n          }\n          if (settings.types) {\n            each$j(settings.types, function (type) {\n              targets = targets.concat(DOM$a.select(type.selector));\n            });\n            return targets;\n          } else if (settings.selector) {\n            return DOM$a.select(settings.selector);\n          } else if (settings.target) {\n            return [settings.target];\n          }\n          switch (settings.mode) {\n          case 'exact':\n            l = settings.elements || '';\n            if (l.length > 0) {\n              each$j(explode$4(l), function (id) {\n                var elm;\n                if (elm = DOM$a.get(id)) {\n                  targets.push(elm);\n                } else {\n                  each$j(domGlobals.document.forms, function (f) {\n                    each$j(f.elements, function (e) {\n                      if (e.name === id) {\n                        id = 'mce_editor_' + instanceCounter++;\n                        DOM$a.setAttrib(e, 'id', id);\n                        targets.push(e);\n                      }\n                    });\n                  });\n                }\n              });\n            }\n            break;\n          case 'textareas':\n          case 'specific_textareas':\n            each$j(DOM$a.select('textarea'), function (elm) {\n              if (settings.editor_deselector && hasClass(elm, settings.editor_deselector)) {\n                return;\n              }\n              if (!settings.editor_selector || hasClass(elm, settings.editor_selector)) {\n                targets.push(elm);\n              }\n            });\n            break;\n          }\n          return targets;\n        };\n        var provideResults = function (editors) {\n          result = editors;\n        };\n        var initEditors = function () {\n          var initCount = 0;\n          var editors = [];\n          var targets;\n          var createEditor = function (id, settings, targetElm) {\n            var editor = new Editor(id, settings, self);\n            editors.push(editor);\n            editor.on('init', function () {\n              if (++initCount === targets.length) {\n                provideResults(editors);\n              }\n            });\n            editor.targetElm = editor.targetElm || targetElm;\n            editor.render();\n          };\n          DOM$a.unbind(window, 'ready', initEditors);\n          execCallback('onpageload');\n          targets = DomQuery.unique(findTargets(settings));\n          if (settings.types) {\n            each$j(settings.types, function (type) {\n              Tools.each(targets, function (elm) {\n                if (DOM$a.is(elm, type.selector)) {\n                  createEditor(createId(elm), extend$4({}, settings, type), elm);\n                  return false;\n                }\n                return true;\n              });\n            });\n            return;\n          }\n          Tools.each(targets, function (elm) {\n            purgeDestroyedEditor(self.get(elm.id));\n          });\n          targets = Tools.grep(targets, function (elm) {\n            return !self.get(elm.id);\n          });\n          if (targets.length === 0) {\n            provideResults([]);\n          } else {\n            each$j(targets, function (elm) {\n              if (isInvalidInlineTarget(settings, elm)) {\n                ErrorReporter.initError('Could not initialize inline editor on invalid inline target element', elm);\n              } else {\n                createEditor(createId(elm), settings, elm);\n              }\n            });\n          }\n        };\n        self.settings = settings;\n        DOM$a.bind(window, 'ready', initEditors);\n        return new promiseObj(function (resolve) {\n          if (result) {\n            resolve(result);\n          } else {\n            provideResults = function (editors) {\n              resolve(editors);\n            };\n          }\n        });\n      },\n      get: function (id) {\n        if (arguments.length === 0) {\n          return editors.slice(0);\n        } else if (isString(id)) {\n          return find(editors, function (editor) {\n            return editor.id === id;\n          }).getOr(null);\n        } else if (isNumber(id)) {\n          return editors[id] ? editors[id] : null;\n        } else {\n          return null;\n        }\n      },\n      add: function (editor) {\n        var self = this;\n        var existingEditor;\n        existingEditor = legacyEditors[editor.id];\n        if (existingEditor === editor) {\n          return editor;\n        }\n        if (self.get(editor.id) === null) {\n          if (isValidLegacyKey(editor.id)) {\n            legacyEditors[editor.id] = editor;\n          }\n          legacyEditors.push(editor);\n          editors.push(editor);\n        }\n        toggleGlobalEvents(true);\n        self.activeEditor = editor;\n        self.fire('AddEditor', { editor: editor });\n        if (!beforeUnloadDelegate) {\n          beforeUnloadDelegate = function (e) {\n            var event = self.fire('BeforeUnload');\n            if (event.returnValue) {\n              e.preventDefault();\n              e.returnValue = event.returnValue;\n              return event.returnValue;\n            }\n          };\n          window.addEventListener('beforeunload', beforeUnloadDelegate);\n        }\n        return editor;\n      },\n      createEditor: function (id, settings) {\n        return this.add(new Editor(id, settings, this));\n      },\n      remove: function (selector) {\n        var self = this;\n        var i, editor;\n        if (!selector) {\n          for (i = editors.length - 1; i >= 0; i--) {\n            self.remove(editors[i]);\n          }\n          return;\n        }\n        if (isString(selector)) {\n          each$j(DOM$a.select(selector), function (elm) {\n            editor = self.get(elm.id);\n            if (editor) {\n              self.remove(editor);\n            }\n          });\n          return;\n        }\n        editor = selector;\n        if (isNull(self.get(editor.id))) {\n          return null;\n        }\n        if (removeEditorFromList(editor)) {\n          self.fire('RemoveEditor', { editor: editor });\n        }\n        if (editors.length === 0) {\n          window.removeEventListener('beforeunload', beforeUnloadDelegate);\n        }\n        editor.remove();\n        toggleGlobalEvents(editors.length > 0);\n        return editor;\n      },\n      execCommand: function (cmd, ui, value) {\n        var self = this, editor = self.get(value);\n        switch (cmd) {\n        case 'mceAddEditor':\n          if (!self.get(value)) {\n            new Editor(value, self.settings, self).render();\n          }\n          return true;\n        case 'mceRemoveEditor':\n          if (editor) {\n            editor.remove();\n          }\n          return true;\n        case 'mceToggleEditor':\n          if (!editor) {\n            self.execCommand('mceAddEditor', 0, value);\n            return true;\n          }\n          if (editor.isHidden()) {\n            editor.show();\n          } else {\n            editor.hide();\n          }\n          return true;\n        }\n        if (self.activeEditor) {\n          return self.activeEditor.execCommand(cmd, ui, value);\n        }\n        return false;\n      },\n      triggerSave: function () {\n        each$j(editors, function (editor) {\n          editor.save();\n        });\n      },\n      addI18n: function (code, items) {\n        I18n.add(code, items);\n      },\n      translate: function (text) {\n        return I18n.translate(text);\n      },\n      setActive: function (editor) {\n        var activeEditor = this.activeEditor;\n        if (this.activeEditor !== editor) {\n          if (activeEditor) {\n            activeEditor.fire('deactivate', { relatedTarget: editor });\n          }\n          editor.fire('activate', { relatedTarget: activeEditor });\n        }\n        this.activeEditor = editor;\n      },\n      _setBaseUrl: function (baseUrl) {\n        this.baseURL = new URI(this.documentBaseURL).toAbsolute(baseUrl.replace(/\\/+$/, ''));\n        this.baseURI = new URI(this.baseURL);\n      }\n    });\n    EditorManager.setup();\n\n    function RangeUtils(dom) {\n      var walk = function (rng, callback) {\n        return RangeWalk.walk(dom, rng, callback);\n      };\n      var split = split$1;\n      var normalize = function (rng) {\n        return NormalizeRange.normalize(dom, rng).fold(constant(false), function (normalizedRng) {\n          rng.setStart(normalizedRng.startContainer, normalizedRng.startOffset);\n          rng.setEnd(normalizedRng.endContainer, normalizedRng.endOffset);\n          return true;\n        });\n      };\n      return {\n        walk: walk,\n        split: split,\n        normalize: normalize\n      };\n    }\n    (function (RangeUtils) {\n      RangeUtils.compareRanges = RangeCompare.isEq;\n      RangeUtils.getCaretRangeFromPoint = CaretRangeFromPoint.fromPoint;\n      RangeUtils.getSelectedNode = getSelectedNode;\n      RangeUtils.getNode = getNode;\n    }(RangeUtils || (RangeUtils = {})));\n    var RangeUtils$1 = RangeUtils;\n\n    var awaiter = function (resolveCb, rejectCb, timeout) {\n      if (timeout === void 0) {\n        timeout = 1000;\n      }\n      var done = false;\n      var timer = null;\n      var complete = function (completer) {\n        return function () {\n          var args = [];\n          for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n          }\n          if (!done) {\n            done = true;\n            if (timer !== null) {\n              domGlobals.clearTimeout(timer);\n              timer = null;\n            }\n            completer.apply(null, args);\n          }\n        };\n      };\n      var resolve = complete(resolveCb);\n      var reject = complete(rejectCb);\n      var start = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (!done && timer === null) {\n          timer = domGlobals.setTimeout(function () {\n            return reject.apply(null, args);\n          }, timeout);\n        }\n      };\n      return {\n        start: start,\n        resolve: resolve,\n        reject: reject\n      };\n    };\n    var create$6 = function () {\n      var tasks = {};\n      var resultFns = {};\n      var load = function (id, url) {\n        var loadErrMsg = 'Script at URL \"' + url + '\" failed to load';\n        var runErrMsg = 'Script at URL \"' + url + '\" did not call `tinymce.Resource.add(\\'' + id + '\\', data)` within 1 second';\n        if (tasks[id] !== undefined) {\n          return tasks[id];\n        } else {\n          var task = new promiseObj(function (resolve, reject) {\n            var waiter = awaiter(resolve, reject);\n            resultFns[id] = waiter.resolve;\n            ScriptLoader.ScriptLoader.loadScript(url, function () {\n              return waiter.start(runErrMsg);\n            }, function () {\n              return waiter.reject(loadErrMsg);\n            });\n          });\n          tasks[id] = task;\n          return task;\n        }\n      };\n      var add = function (id, data) {\n        if (resultFns[id] !== undefined) {\n          resultFns[id](data);\n          delete resultFns[id];\n        }\n        tasks[id] = promiseObj.resolve(data);\n      };\n      return {\n        load: load,\n        add: add\n      };\n    };\n    var Resource = create$6();\n\n    var min = Math.min, max = Math.max, round$2 = Math.round;\n    var relativePosition = function (rect, targetRect, rel) {\n      var x, y, w, h, targetW, targetH;\n      x = targetRect.x;\n      y = targetRect.y;\n      w = rect.w;\n      h = rect.h;\n      targetW = targetRect.w;\n      targetH = targetRect.h;\n      rel = (rel || '').split('');\n      if (rel[0] === 'b') {\n        y += targetH;\n      }\n      if (rel[1] === 'r') {\n        x += targetW;\n      }\n      if (rel[0] === 'c') {\n        y += round$2(targetH / 2);\n      }\n      if (rel[1] === 'c') {\n        x += round$2(targetW / 2);\n      }\n      if (rel[3] === 'b') {\n        y -= h;\n      }\n      if (rel[4] === 'r') {\n        x -= w;\n      }\n      if (rel[3] === 'c') {\n        y -= round$2(h / 2);\n      }\n      if (rel[4] === 'c') {\n        x -= round$2(w / 2);\n      }\n      return create$7(x, y, w, h);\n    };\n    var findBestRelativePosition = function (rect, targetRect, constrainRect, rels) {\n      var pos, i;\n      for (i = 0; i < rels.length; i++) {\n        pos = relativePosition(rect, targetRect, rels[i]);\n        if (pos.x >= constrainRect.x && pos.x + pos.w <= constrainRect.w + constrainRect.x && pos.y >= constrainRect.y && pos.y + pos.h <= constrainRect.h + constrainRect.y) {\n          return rels[i];\n        }\n      }\n      return null;\n    };\n    var inflate = function (rect, w, h) {\n      return create$7(rect.x - w, rect.y - h, rect.w + w * 2, rect.h + h * 2);\n    };\n    var intersect = function (rect, cropRect) {\n      var x1, y1, x2, y2;\n      x1 = max(rect.x, cropRect.x);\n      y1 = max(rect.y, cropRect.y);\n      x2 = min(rect.x + rect.w, cropRect.x + cropRect.w);\n      y2 = min(rect.y + rect.h, cropRect.y + cropRect.h);\n      if (x2 - x1 < 0 || y2 - y1 < 0) {\n        return null;\n      }\n      return create$7(x1, y1, x2 - x1, y2 - y1);\n    };\n    var clamp$1 = function (rect, clampRect, fixedSize) {\n      var underflowX1, underflowY1, overflowX2, overflowY2, x1, y1, x2, y2, cx2, cy2;\n      x1 = rect.x;\n      y1 = rect.y;\n      x2 = rect.x + rect.w;\n      y2 = rect.y + rect.h;\n      cx2 = clampRect.x + clampRect.w;\n      cy2 = clampRect.y + clampRect.h;\n      underflowX1 = max(0, clampRect.x - x1);\n      underflowY1 = max(0, clampRect.y - y1);\n      overflowX2 = max(0, x2 - cx2);\n      overflowY2 = max(0, y2 - cy2);\n      x1 += underflowX1;\n      y1 += underflowY1;\n      if (fixedSize) {\n        x2 += underflowX1;\n        y2 += underflowY1;\n        x1 -= overflowX2;\n        y1 -= overflowY2;\n      }\n      x2 -= overflowX2;\n      y2 -= overflowY2;\n      return create$7(x1, y1, x2 - x1, y2 - y1);\n    };\n    var create$7 = function (x, y, w, h) {\n      return {\n        x: x,\n        y: y,\n        w: w,\n        h: h\n      };\n    };\n    var fromClientRect = function (clientRect) {\n      return create$7(clientRect.left, clientRect.top, clientRect.width, clientRect.height);\n    };\n    var Rect = {\n      inflate: inflate,\n      relativePosition: relativePosition,\n      findBestRelativePosition: findBestRelativePosition,\n      intersect: intersect,\n      clamp: clamp$1,\n      create: create$7,\n      fromClientRect: fromClientRect\n    };\n\n    var each$k = Tools.each, extend$5 = Tools.extend;\n    var extendClass, initializing;\n    var Class = function () {\n    };\n    Class.extend = extendClass = function (prop) {\n      var self = this;\n      var _super = self.prototype;\n      var prototype, name, member;\n      var Class = function () {\n        var i, mixins, mixin;\n        var self = this;\n        if (!initializing) {\n          if (self.init) {\n            self.init.apply(self, arguments);\n          }\n          mixins = self.Mixins;\n          if (mixins) {\n            i = mixins.length;\n            while (i--) {\n              mixin = mixins[i];\n              if (mixin.init) {\n                mixin.init.apply(self, arguments);\n              }\n            }\n          }\n        }\n      };\n      var dummy = function () {\n        return this;\n      };\n      var createMethod = function (name, fn) {\n        return function () {\n          var self = this;\n          var tmp = self._super;\n          var ret;\n          self._super = _super[name];\n          ret = fn.apply(self, arguments);\n          self._super = tmp;\n          return ret;\n        };\n      };\n      initializing = true;\n      prototype = new self();\n      initializing = false;\n      if (prop.Mixins) {\n        each$k(prop.Mixins, function (mixin) {\n          for (var name_1 in mixin) {\n            if (name_1 !== 'init') {\n              prop[name_1] = mixin[name_1];\n            }\n          }\n        });\n        if (_super.Mixins) {\n          prop.Mixins = _super.Mixins.concat(prop.Mixins);\n        }\n      }\n      if (prop.Methods) {\n        each$k(prop.Methods.split(','), function (name) {\n          prop[name] = dummy;\n        });\n      }\n      if (prop.Properties) {\n        each$k(prop.Properties.split(','), function (name) {\n          var fieldName = '_' + name;\n          prop[name] = function (value) {\n            var self = this;\n            if (value !== undefined) {\n              self[fieldName] = value;\n              return self;\n            }\n            return self[fieldName];\n          };\n        });\n      }\n      if (prop.Statics) {\n        each$k(prop.Statics, function (func, name) {\n          Class[name] = func;\n        });\n      }\n      if (prop.Defaults && _super.Defaults) {\n        prop.Defaults = extend$5({}, _super.Defaults, prop.Defaults);\n      }\n      for (name in prop) {\n        member = prop[name];\n        if (typeof member === 'function' && _super[name]) {\n          prototype[name] = createMethod(name, member);\n        } else {\n          prototype[name] = member;\n        }\n      }\n      Class.prototype = prototype;\n      Class.constructor = Class;\n      Class.extend = extendClass;\n      return Class;\n    };\n\n    var min$1 = Math.min, max$1 = Math.max, round$3 = Math.round;\n    var Color = function (value) {\n      var self = {};\n      var r = 0, g = 0, b = 0;\n      var rgb2hsv = function (r, g, b) {\n        var h, s, v, d, minRGB, maxRGB;\n        h = 0;\n        s = 0;\n        v = 0;\n        r = r / 255;\n        g = g / 255;\n        b = b / 255;\n        minRGB = min$1(r, min$1(g, b));\n        maxRGB = max$1(r, max$1(g, b));\n        if (minRGB === maxRGB) {\n          v = minRGB;\n          return {\n            h: 0,\n            s: 0,\n            v: v * 100\n          };\n        }\n        d = r === minRGB ? g - b : b === minRGB ? r - g : b - r;\n        h = r === minRGB ? 3 : b === minRGB ? 1 : 5;\n        h = 60 * (h - d / (maxRGB - minRGB));\n        s = (maxRGB - minRGB) / maxRGB;\n        v = maxRGB;\n        return {\n          h: round$3(h),\n          s: round$3(s * 100),\n          v: round$3(v * 100)\n        };\n      };\n      var hsvToRgb = function (hue, saturation, brightness) {\n        var side, chroma, x, match;\n        hue = (parseInt(hue, 10) || 0) % 360;\n        saturation = parseInt(saturation, 10) / 100;\n        brightness = parseInt(brightness, 10) / 100;\n        saturation = max$1(0, min$1(saturation, 1));\n        brightness = max$1(0, min$1(brightness, 1));\n        if (saturation === 0) {\n          r = g = b = round$3(255 * brightness);\n          return;\n        }\n        side = hue / 60;\n        chroma = brightness * saturation;\n        x = chroma * (1 - Math.abs(side % 2 - 1));\n        match = brightness - chroma;\n        switch (Math.floor(side)) {\n        case 0:\n          r = chroma;\n          g = x;\n          b = 0;\n          break;\n        case 1:\n          r = x;\n          g = chroma;\n          b = 0;\n          break;\n        case 2:\n          r = 0;\n          g = chroma;\n          b = x;\n          break;\n        case 3:\n          r = 0;\n          g = x;\n          b = chroma;\n          break;\n        case 4:\n          r = x;\n          g = 0;\n          b = chroma;\n          break;\n        case 5:\n          r = chroma;\n          g = 0;\n          b = x;\n          break;\n        default:\n          r = g = b = 0;\n        }\n        r = round$3(255 * (r + match));\n        g = round$3(255 * (g + match));\n        b = round$3(255 * (b + match));\n      };\n      var toHex = function () {\n        var hex = function (val) {\n          val = parseInt(val, 10).toString(16);\n          return val.length > 1 ? val : '0' + val;\n        };\n        return '#' + hex(r) + hex(g) + hex(b);\n      };\n      var toRgb = function () {\n        return {\n          r: r,\n          g: g,\n          b: b\n        };\n      };\n      var toHsv = function () {\n        return rgb2hsv(r, g, b);\n      };\n      var parse = function (value) {\n        var matches;\n        if (typeof value === 'object') {\n          if ('r' in value) {\n            r = value.r;\n            g = value.g;\n            b = value.b;\n          } else if ('v' in value) {\n            hsvToRgb(value.h, value.s, value.v);\n          }\n        } else {\n          if (matches = /rgb\\s*\\(\\s*([0-9]+)\\s*,\\s*([0-9]+)\\s*,\\s*([0-9]+)[^\\)]*\\)/gi.exec(value)) {\n            r = parseInt(matches[1], 10);\n            g = parseInt(matches[2], 10);\n            b = parseInt(matches[3], 10);\n          } else if (matches = /#([0-F]{2})([0-F]{2})([0-F]{2})/gi.exec(value)) {\n            r = parseInt(matches[1], 16);\n            g = parseInt(matches[2], 16);\n            b = parseInt(matches[3], 16);\n          } else if (matches = /#([0-F])([0-F])([0-F])/gi.exec(value)) {\n            r = parseInt(matches[1] + matches[1], 16);\n            g = parseInt(matches[2] + matches[2], 16);\n            b = parseInt(matches[3] + matches[3], 16);\n          }\n        }\n        r = r < 0 ? 0 : r > 255 ? 255 : r;\n        g = g < 0 ? 0 : g > 255 ? 255 : g;\n        b = b < 0 ? 0 : b > 255 ? 255 : b;\n        return self;\n      };\n      if (value) {\n        parse(value);\n      }\n      self.toRgb = toRgb;\n      self.toHsv = toHsv;\n      self.toHex = toHex;\n      self.parse = parse;\n      return self;\n    };\n\n    var serialize = function (obj) {\n      var data = JSON.stringify(obj);\n      if (!isString(data)) {\n        return data;\n      }\n      return data.replace(/[\\u0080-\\uFFFF]/g, function (match) {\n        var hexCode = match.charCodeAt(0).toString(16);\n        return '\\\\u' + '0000'.substring(hexCode.length) + hexCode;\n      });\n    };\n    var JSONUtils = {\n      serialize: serialize,\n      parse: function (text) {\n        try {\n          return JSON.parse(text);\n        } catch (ex) {\n        }\n      }\n    };\n\n    var JSONP = {\n      callbacks: {},\n      count: 0,\n      send: function (settings) {\n        var self = this, dom = DOMUtils$1.DOM, count = settings.count !== undefined ? settings.count : self.count;\n        var id = 'tinymce_jsonp_' + count;\n        self.callbacks[count] = function (json) {\n          dom.remove(id);\n          delete self.callbacks[count];\n          settings.callback(json);\n        };\n        dom.add(dom.doc.body, 'script', {\n          id: id,\n          src: settings.url,\n          type: 'text/javascript'\n        });\n        self.count++;\n      }\n    };\n\n    var XHR = __assign(__assign({}, Observable), {\n      send: function (settings) {\n        var xhr, count = 0;\n        var ready = function () {\n          if (!settings.async || xhr.readyState === 4 || count++ > 10000) {\n            if (settings.success && count < 10000 && xhr.status === 200) {\n              settings.success.call(settings.success_scope, '' + xhr.responseText, xhr, settings);\n            } else if (settings.error) {\n              settings.error.call(settings.error_scope, count > 10000 ? 'TIMED_OUT' : 'GENERAL', xhr, settings);\n            }\n            xhr = null;\n          } else {\n            Delay.setTimeout(ready, 10);\n          }\n        };\n        settings.scope = settings.scope || this;\n        settings.success_scope = settings.success_scope || settings.scope;\n        settings.error_scope = settings.error_scope || settings.scope;\n        settings.async = settings.async !== false;\n        settings.data = settings.data || '';\n        XHR.fire('beforeInitialize', { settings: settings });\n        xhr = new domGlobals.XMLHttpRequest();\n        if (xhr) {\n          if (xhr.overrideMimeType) {\n            xhr.overrideMimeType(settings.content_type);\n          }\n          xhr.open(settings.type || (settings.data ? 'POST' : 'GET'), settings.url, settings.async);\n          if (settings.crossDomain) {\n            xhr.withCredentials = true;\n          }\n          if (settings.content_type) {\n            xhr.setRequestHeader('Content-Type', settings.content_type);\n          }\n          if (settings.requestheaders) {\n            Tools.each(settings.requestheaders, function (header) {\n              xhr.setRequestHeader(header.key, header.value);\n            });\n          }\n          xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n          xhr = XHR.fire('beforeSend', {\n            xhr: xhr,\n            settings: settings\n          }).xhr;\n          xhr.send(settings.data);\n          if (!settings.async) {\n            return ready();\n          }\n          Delay.setTimeout(ready, 10);\n        }\n      }\n    });\n\n    var extend$6 = Tools.extend;\n    var JSONRequest = function () {\n      function JSONRequest(settings) {\n        this.settings = extend$6({}, settings);\n        this.count = 0;\n      }\n      JSONRequest.sendRPC = function (o) {\n        return new JSONRequest().send(o);\n      };\n      JSONRequest.prototype.send = function (args) {\n        var ecb = args.error, scb = args.success;\n        var xhrArgs = extend$6(this.settings, args);\n        xhrArgs.success = function (c, x) {\n          c = JSONUtils.parse(c);\n          if (typeof c === 'undefined') {\n            c = { error: 'JSON Parse error.' };\n          }\n          if (c.error) {\n            ecb.call(xhrArgs.error_scope || xhrArgs.scope, c.error, x);\n          } else {\n            scb.call(xhrArgs.success_scope || xhrArgs.scope, c.result);\n          }\n        };\n        xhrArgs.error = function (ty, x) {\n          if (ecb) {\n            ecb.call(xhrArgs.error_scope || xhrArgs.scope, ty, x);\n          }\n        };\n        xhrArgs.data = JSONUtils.serialize({\n          id: args.id || 'c' + this.count++,\n          method: args.method,\n          params: args.params\n        });\n        xhrArgs.content_type = 'application/json';\n        XHR.send(xhrArgs);\n      };\n      return JSONRequest;\n    }();\n\n    var create$8 = function () {\n      return function () {\n        var data = {};\n        var keys = [];\n        var storage = {\n          getItem: function (key) {\n            var item = data[key];\n            return item ? item : null;\n          },\n          setItem: function (key, value) {\n            keys.push(key);\n            data[key] = String(value);\n          },\n          key: function (index) {\n            return keys[index];\n          },\n          removeItem: function (key) {\n            keys = keys.filter(function (k) {\n              return k === key;\n            });\n            delete data[key];\n          },\n          clear: function () {\n            keys = [];\n            data = {};\n          },\n          length: 0\n        };\n        Object.defineProperty(storage, 'length', {\n          get: function () {\n            return keys.length;\n          },\n          configurable: false,\n          enumerable: false\n        });\n        return storage;\n      }();\n    };\n\n    var localStorage;\n    try {\n      localStorage = domGlobals.window.localStorage;\n    } catch (e) {\n      localStorage = create$8();\n    }\n    var LocalStorage = localStorage;\n\n    var publicApi = {\n      geom: { Rect: Rect },\n      util: {\n        Promise: promiseObj,\n        Delay: Delay,\n        Tools: Tools,\n        VK: VK,\n        URI: URI,\n        Class: Class,\n        EventDispatcher: EventDispatcher,\n        Observable: Observable,\n        I18n: I18n,\n        XHR: XHR,\n        JSON: JSONUtils,\n        JSONRequest: JSONRequest,\n        JSONP: JSONP,\n        LocalStorage: LocalStorage,\n        Color: Color\n      },\n      dom: {\n        EventUtils: EventUtils,\n        Sizzle: Sizzle,\n        DomQuery: DomQuery,\n        TreeWalker: TreeWalker,\n        TextSeeker: TextSeeker,\n        DOMUtils: DOMUtils$1,\n        ScriptLoader: ScriptLoader,\n        RangeUtils: RangeUtils$1,\n        Serializer: Serializer$1,\n        ControlSelection: ControlSelection,\n        BookmarkManager: BookmarkManager$1,\n        Selection: Selection$1,\n        Event: EventUtils.Event\n      },\n      html: {\n        Styles: Styles,\n        Entities: Entities,\n        Node: Node$1,\n        Schema: Schema,\n        SaxParser: SaxParser$1,\n        DomParser: DomParser,\n        Writer: Writer,\n        Serializer: Serializer\n      },\n      Env: Env,\n      AddOnManager: AddOnManager$1,\n      Annotator: Annotator,\n      Formatter: Formatter,\n      UndoManager: UndoManager,\n      EditorCommands: EditorCommands,\n      WindowManager: WindowManager,\n      NotificationManager: NotificationManager,\n      EditorObservable: EditorObservable,\n      Shortcuts: Shortcuts,\n      Editor: Editor,\n      FocusManager: FocusManager,\n      EditorManager: EditorManager,\n      DOM: DOMUtils$1.DOM,\n      ScriptLoader: ScriptLoader.ScriptLoader,\n      PluginManager: AddOnManager$1.PluginManager,\n      ThemeManager: AddOnManager$1.ThemeManager,\n      IconManager: IconManager,\n      Resource: Resource,\n      trim: Tools.trim,\n      isArray: Tools.isArray,\n      is: Tools.is,\n      toArray: Tools.toArray,\n      makeMap: Tools.makeMap,\n      each: Tools.each,\n      map: Tools.map,\n      grep: Tools.grep,\n      inArray: Tools.inArray,\n      extend: Tools.extend,\n      create: Tools.create,\n      walk: Tools.walk,\n      createNS: Tools.createNS,\n      resolve: Tools.resolve,\n      explode: Tools.explode,\n      _addCacheSuffix: Tools._addCacheSuffix,\n      isOpera: Env.opera,\n      isWebKit: Env.webkit,\n      isIE: Env.ie,\n      isGecko: Env.gecko,\n      isMac: Env.mac\n    };\n    var tinymce = Tools.extend(EditorManager, publicApi);\n\n    var exportToModuleLoaders = function (tinymce) {\n      if (typeof module === 'object') {\n        try {\n          module.exports = tinymce;\n        } catch (_) {\n        }\n      }\n    };\n    var exportToWindowGlobal = function (tinymce) {\n      window.tinymce = tinymce;\n      window.tinyMCE = tinymce;\n    };\n    exportToWindowGlobal(tinymce);\n    exportToModuleLoaders(tinymce);\n\n}(window));\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/tinymce/tinymce.js\n// module id = 312\n// module chunks = 3","!function(globals) {\n'use strict'\n\nvar _imports = {}\n\nif (typeof module !== 'undefined' && module.exports) { //CommonJS\n  _imports.bytesToHex = require('convert-hex').bytesToHex\n  _imports.convertString = require('convert-string')\n  module.exports = sha256\n} else {\n  _imports.bytesToHex = globals.convertHex.bytesToHex\n  _imports.convertString = globals.convertString\n  globals.sha256 = sha256\n}\n\n/*\nCryptoJS v3.1.2\ncode.google.com/p/crypto-js\n(c) 2009-2013 by Jeff Mott. All rights reserved.\ncode.google.com/p/crypto-js/wiki/License\n*/\n\n// Initialization round constants tables\nvar K = []\n\n// Compute constants\n!function () {\n  function isPrime(n) {\n    var sqrtN = Math.sqrt(n);\n    for (var factor = 2; factor <= sqrtN; factor++) {\n      if (!(n % factor)) return false\n    }\n\n    return true\n  }\n\n  function getFractionalBits(n) {\n    return ((n - (n | 0)) * 0x100000000) | 0\n  }\n\n  var n = 2\n  var nPrime = 0\n  while (nPrime < 64) {\n    if (isPrime(n)) {\n      K[nPrime] = getFractionalBits(Math.pow(n, 1 / 3))\n      nPrime++\n    }\n\n    n++\n  }\n}()\n\nvar bytesToWords = function (bytes) {\n  var words = []\n  for (var i = 0, b = 0; i < bytes.length; i++, b += 8) {\n    words[b >>> 5] |= bytes[i] << (24 - b % 32)\n  }\n  return words\n}\n\nvar wordsToBytes = function (words) {\n  var bytes = []\n  for (var b = 0; b < words.length * 32; b += 8) {\n    bytes.push((words[b >>> 5] >>> (24 - b % 32)) & 0xFF)\n  }\n  return bytes\n}\n\n// Reusable object\nvar W = []\n\nvar processBlock = function (H, M, offset) {\n  // Working variables\n  var a = H[0], b = H[1], c = H[2], d = H[3]\n  var e = H[4], f = H[5], g = H[6], h = H[7]\n\n    // Computation\n  for (var i = 0; i < 64; i++) {\n    if (i < 16) {\n      W[i] = M[offset + i] | 0\n    } else {\n      var gamma0x = W[i - 15]\n      var gamma0  = ((gamma0x << 25) | (gamma0x >>> 7))  ^\n                    ((gamma0x << 14) | (gamma0x >>> 18)) ^\n                    (gamma0x >>> 3)\n\n      var gamma1x = W[i - 2];\n      var gamma1  = ((gamma1x << 15) | (gamma1x >>> 17)) ^\n                    ((gamma1x << 13) | (gamma1x >>> 19)) ^\n                    (gamma1x >>> 10)\n\n      W[i] = gamma0 + W[i - 7] + gamma1 + W[i - 16];\n    }\n\n    var ch  = (e & f) ^ (~e & g);\n    var maj = (a & b) ^ (a & c) ^ (b & c);\n\n    var sigma0 = ((a << 30) | (a >>> 2)) ^ ((a << 19) | (a >>> 13)) ^ ((a << 10) | (a >>> 22));\n    var sigma1 = ((e << 26) | (e >>> 6)) ^ ((e << 21) | (e >>> 11)) ^ ((e << 7)  | (e >>> 25));\n\n    var t1 = h + sigma1 + ch + K[i] + W[i];\n    var t2 = sigma0 + maj;\n\n    h = g;\n    g = f;\n    f = e;\n    e = (d + t1) | 0;\n    d = c;\n    c = b;\n    b = a;\n    a = (t1 + t2) | 0;\n  }\n\n  // Intermediate hash value\n  H[0] = (H[0] + a) | 0;\n  H[1] = (H[1] + b) | 0;\n  H[2] = (H[2] + c) | 0;\n  H[3] = (H[3] + d) | 0;\n  H[4] = (H[4] + e) | 0;\n  H[5] = (H[5] + f) | 0;\n  H[6] = (H[6] + g) | 0;\n  H[7] = (H[7] + h) | 0;\n}\n\nfunction sha256(message, options) {;\n  if (message.constructor === String) {\n    message = _imports.convertString.UTF8.stringToBytes(message);\n  }\n\n  var H =[ 0x6A09E667, 0xBB67AE85, 0x3C6EF372, 0xA54FF53A,\n           0x510E527F, 0x9B05688C, 0x1F83D9AB, 0x5BE0CD19 ];\n\n  var m = bytesToWords(message);\n  var l = message.length * 8;\n\n  m[l >> 5] |= 0x80 << (24 - l % 32);\n  m[((l + 64 >> 9) << 4) + 15] = l;\n\n  for (var i=0 ; i<m.length; i += 16) {\n    processBlock(H, m, i);\n  }\n\n  var digestbytes = wordsToBytes(H);\n  return options && options.asBytes ? digestbytes :\n         options && options.asString ? _imports.convertString.bytesToString(digestbytes) :\n         _imports.bytesToHex(digestbytes)\n}\n\nsha256.x2 = function(message, options) {\n  return sha256(sha256(message, { asBytes:true }), options)\n}\n\n}(this);\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/sha256/lib/sha256.js\n// module id = 7\n// module chunks = 3","!function(globals) {\n'use strict'\n\nvar convertHex = {\n  bytesToHex: function(bytes) {\n    /*if (typeof bytes.byteLength != 'undefined') {\n      var newBytes = []\n\n      if (typeof bytes.buffer != 'undefined')\n        bytes = new DataView(bytes.buffer)\n      else\n        bytes = new DataView(bytes)\n\n      for (var i = 0; i < bytes.byteLength; ++i) {\n        newBytes.push(bytes.getUint8(i))\n      }\n      bytes = newBytes\n    }*/\n    return arrBytesToHex(bytes)\n  },\n  hexToBytes: function(hex) {\n    if (hex.length % 2 === 1) throw new Error(\"hexToBytes can't have a string with an odd number of characters.\")\n    if (hex.indexOf('0x') === 0) hex = hex.slice(2)\n    return hex.match(/../g).map(function(x) { return parseInt(x,16) })\n  }\n}\n\n\n// PRIVATE\n\nfunction arrBytesToHex(bytes) {\n  return bytes.map(function(x) { return padLeft(x.toString(16),2) }).join('')\n}\n\nfunction padLeft(orig, len) {\n  if (orig.length > len) return orig\n  return Array(len - orig.length + 1).join('0') + orig\n}\n\n\nif (typeof module !== 'undefined' && module.exports) { //CommonJS\n  module.exports = convertHex\n} else {\n  globals.convertHex = convertHex\n}\n\n}(this);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/convert-hex/convert-hex.js\n// module id = 98\n// module chunks = 3","!function(globals) {\n'use strict'\n\nvar convertString = {\n  bytesToString: function(bytes) {\n    return bytes.map(function(x){ return String.fromCharCode(x) }).join('')\n  },\n  stringToBytes: function(str) {\n    return str.split('').map(function(x) { return x.charCodeAt(0) })\n  }\n}\n\n//http://hossa.in/2012/07/20/utf-8-in-javascript.html\nconvertString.UTF8 = {\n   bytesToString: function(bytes) {\n    return decodeURIComponent(escape(convertString.bytesToString(bytes)))\n  },\n  stringToBytes: function(str) {\n   return convertString.stringToBytes(unescape(encodeURIComponent(str)))\n  }\n}\n\nif (typeof module !== 'undefined' && module.exports) { //CommonJS\n  module.exports = convertString\n} else {\n  globals.convertString = convertString\n}\n\n}(this);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/convert-string/convert-string.js\n// module id = 99\n// module chunks = 3"],"sourceRoot":""}