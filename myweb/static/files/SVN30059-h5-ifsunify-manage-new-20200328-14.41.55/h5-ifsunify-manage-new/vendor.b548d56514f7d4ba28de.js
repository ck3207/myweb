/*! current version: Sat Mar 28 2020 14:42:04 GMT+0800 (GMT+08:00) */
webpackJsonp([3],{3:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__;!function(global){"use strict";var ExcellentExport=function(){function b64toBlob(b64Data,contentType,sliceSize){contentType=contentType||"",sliceSize=sliceSize||512;var offset,byteCharacters=window.atob(b64Data),byteArrays=[];for(offset=0;offset<byteCharacters.length;offset+=sliceSize){var i,slice=byteCharacters.slice(offset,offset+sliceSize),byteNumbers=new Array(slice.length);for(i=0;i<slice.length;i+=1)byteNumbers[i]=slice.charCodeAt(i);var byteArray=new window.Uint8Array(byteNumbers);byteArrays.push(byteArray)}return new window.Blob(byteArrays,{type:contentType})}function createDownloadLink(anchor,base64data,exporttype,filename){var blob;if(window.navigator.msSaveBlob)return blob=b64toBlob(base64data,exporttype),window.navigator.msSaveBlob(blob,filename),!1;if(window.URL.createObjectURL){blob=b64toBlob(base64data,exporttype);var blobUrl=window.URL.createObjectURL(blob,exporttype,filename);anchor.href=blobUrl}else{var hrefvalue="data:"+exporttype+";base64,"+base64data;anchor.download=filename,anchor.href=hrefvalue}return!0}var template={excel:'<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta name=ProgId content=Excel.Sheet> <meta name=Generator content="Microsoft Excel 11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body><table border="1">{table}</table></body></html>'},csvDelimiter=",",csvNewLine="\r\n",base64=function(s){return window.btoa(window.unescape(encodeURIComponent(s)))},format=function(s,c){return s.replace(new RegExp("{(\\w+)}","g"),function(m,p){return c[p]})},get=function(element){return element.nodeType?element:document.getElementById(element)},fixCSVField=function(value){var fixedValue=value,addQuotes=-1!==value.indexOf(csvDelimiter)||-1!==value.indexOf("\r")||-1!==value.indexOf("\n"),replaceDoubleQuotes=-1!==value.indexOf('"');return replaceDoubleQuotes&&(fixedValue=fixedValue.replace(/"/g,'""')),(addQuotes||replaceDoubleQuotes)&&(fixedValue='"'+fixedValue+'"'),fixedValue},tableToCSV=function(table){var i,j,row,col,data="SEP="+csvDelimiter+csvNewLine,columnStart=0;for(i=0;i<table.rows.length;i+=1){row=table.rows[i];var rowData="";if(-1===row.className.indexOf("ng-table-filters")){for(columnStart=""===table.rows[0].cells[0].textContent.trim()?1:0,j=columnStart;j<row.cells.length;j+=1)col=row.cells[j],rowData=rowData+fixCSVField(col.textContent.trim())+(j?csvDelimiter:" ");rowData=rowData.slice(0,rowData.length-1),data+=rowData+csvNewLine}}return data},tableToHTML=function(table){var i,j,row,col,data="",columnStart=0;for(i=0;i<table.rows.length;i+=1){row=table.rows[i];var rowData="";if(-1===row.className.indexOf("ng-table-filters")){for(columnStart=""===table.rows[0].cells[0].textContent.trim()?1:0,j=columnStart;j<row.cells.length;j+=1)col=row.cells[j],rowData+=0===i?"<th>"+col.textContent.trim()+"</th>":"<td>"+col.textContent.trim()+"</td>";data+="<tr>"+rowData+"</tr>"}}return data};return{excel:function(anchor,table,name){table=get(table);var htmlTableData=tableToHTML(table);return createDownloadLink(anchor,base64(format(template.excel,{worksheet:name||"Worksheet",table:htmlTableData})),"application/vnd.ms-excel","export.xls")},csv:function(anchor,table,delimiter,newLine){void 0!==delimiter&&delimiter&&(csvDelimiter=delimiter),void 0!==newLine&&newLine&&(csvNewLine=newLine),table=get(table);var csvData=tableToCSV(table);return createDownloadLink(anchor,base64(csvData),"application/csv","export.csv")}}}();void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(){return ExcellentExport}.call(exports,__webpack_require__,exports,module))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}()},309:function(module,exports){module.exports="/**\n * ngTableExcelExport 1.0.0\n * JavaScript export to Excel or CSV from HTML tables automatically in the browser and also compatible with all browsers.\n *\n * @author: Murugavel Ramachandran (blsrm@yahoo.com)\n * @url: https://github.com/blsrm/ngTableExcelExport\n *\n */\n/*jslint browser: true, bitwise: true, vars: true, white: true */\n/*global define, exports, module */\n\n(function (global) {\n    'use strict';\n\nvar ExcellentExport = (function() {\n\n    function b64toBlob(b64Data, contentType, sliceSize) {\n        // function taken from http://stackoverflow.com/a/16245768/2591950\n        // author Jeremy Banks http://stackoverflow.com/users/1114/jeremy-banks\n        contentType = contentType || '';\n        sliceSize = sliceSize || 512;\n\n        var byteCharacters = window.atob(b64Data);\n        var byteArrays = [];\n\n        var offset;\n        for (offset = 0; offset < byteCharacters.length; offset += sliceSize) {\n            var slice = byteCharacters.slice(offset, offset + sliceSize);\n\n            var byteNumbers = new Array(slice.length);\n            var i;\n            for (i = 0; i < slice.length; i = i + 1) {\n                byteNumbers[i] = slice.charCodeAt(i);\n            }\n\n            var byteArray = new window.Uint8Array(byteNumbers);\n\n            byteArrays.push(byteArray);\n        }\n\n        var blob = new window.Blob(byteArrays, {\n            type: contentType\n        });\n        return blob;\n    }\n\n    var version = \"1.5.0\";\n    var uri = {excel: 'data:application/vnd.ms-excel;base64,', csv: 'data:application/csv;base64,'};\n    var template = {excel: '<html xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:x=\"urn:schemas-microsoft-com:office:excel\" xmlns=\"http://www.w3.org/TR/REC-html40\"><head><meta name=ProgId content=Excel.Sheet> <meta name=Generator content=\"Microsoft Excel 11\"><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body><table border=\"1\">{table}</table></body></html>'};\n    var csvDelimiter = \",\";\n    var csvNewLine = \"\\r\\n\";\n    var base64 = function(s) {\n        return window.btoa(window.unescape(encodeURIComponent(s)));\n    };\n    var format = function(s, c) {\n        return s.replace(new RegExp(\"{(\\\\w+)}\", \"g\"), function(m, p) {\n            return c[p];\n        });\n    };\n\n    var get = function(element) {\n        if (!element.nodeType) {\n            return document.getElementById(element);\n        }\n        return element;\n    };\n\n    var fixCSVField = function(value) {\n        var fixedValue = value;\n        var addQuotes = (value.indexOf(csvDelimiter) !== -1) || (value.indexOf('\\r') !== -1) || (value.indexOf('\\n') !== -1);\n        var replaceDoubleQuotes = (value.indexOf('\"') !== -1);\n\n        if (replaceDoubleQuotes) {\n            fixedValue = fixedValue.replace(/\"/g, '\"\"');\n        }\n        if (addQuotes || replaceDoubleQuotes) {\n            fixedValue = '\"' + fixedValue + '\"';\n        }\n\n        return fixedValue;\n    };\n\n    var tableToCSV = function(table) {\n        var data = \"SEP=\"+csvDelimiter+csvNewLine;\n        var i, j, row, col;\n        var columnStart = 0;\n        for (i = 0; i < table.rows.length; i=i+1) {\n            row = table.rows[i];\n            var rowData = '';\n            \n            //Checking ng table style for filters\n            if(row.className.indexOf('ng-table-filters') !== -1) {\n\t\t\t\tcontinue;\n            }\n            \n            //remove first column having check box in angular JS, in future will provide option from UI to control\n            if(table.rows[0].cells[0].textContent.trim() === '') {\n            \tcolumnStart = 1;\n            }else {\n            \tcolumnStart = 0;\n            }\n\n            for (j = columnStart; j < row.cells.length; j=j+1) {\n                col = row.cells[j];\n                rowData = rowData + fixCSVField(col.textContent.trim()) + (j ? csvDelimiter : ' ');\n            }\n            rowData = rowData.slice(0, rowData.length - 1); //remove last semicolon\n            data += rowData + csvNewLine;\n        }\n        return data;\n    };\n\n    var tableToHTML = function(table) {\n        var data = \"\";\n        var i, j, row, col;\n        var columnStart = 0;\n        for (i = 0; i < table.rows.length; i=i+1) {\n            row = table.rows[i];\n            var rowData = '';\n            \n            //Checking ng table style for filters\n            if(row.className.indexOf('ng-table-filters') !== -1) {\n\t\t\t\tcontinue;\n            }\n            \n            //remove first column having check box in angular JS, in future will provide option from UI to control\n            if(table.rows[0].cells[0].textContent.trim() === '') {\n            \tcolumnStart = 1;\n            }else {\n            \tcolumnStart = 0;\n            }\n\n            for (j = columnStart; j < row.cells.length; j=j+1) {\n                col = row.cells[j];\n                if (i === 0) {\n                \trowData += '<th>' + col.textContent.trim() + '</th>';\n                } else {\n                \trowData += '<td>' + col.textContent.trim() + '</td>';\n                }\n            }\n            data += '<tr>' + rowData + '</tr>';\n        }\n        return data;\n    };\n\n    function createDownloadLink(anchor, base64data, exporttype, filename) {\n        var blob;\n        if (window.navigator.msSaveBlob) {\n            blob = b64toBlob(base64data, exporttype);\n            window.navigator.msSaveBlob(blob, filename);\n            return false;\n        } else if(window.URL.createObjectURL) {\n            blob = b64toBlob(base64data, exporttype);\n            var blobUrl = window.URL.createObjectURL(blob, exporttype, filename);\n            anchor.href = blobUrl;\n        } else {\n            var hrefvalue = \"data:\" + exporttype + \";base64,\" + base64data;\n            anchor.download = filename;\n            anchor.href = hrefvalue;\n        }\n\n        // Return true to allow the link to work\n        return true;\n    }\n\n    var ee = {\n        /** @export */\n        excel: function(anchor, table, name) {\n            table = get(table);\n\n            var htmlTableData = tableToHTML(table);\n            \n            var ctx = {worksheet: name || 'Worksheet', table: htmlTableData};\n            var b64 = base64(format(template.excel, ctx));\n            return createDownloadLink(anchor, b64, 'application/vnd.ms-excel','export.xls');\n        },\n        /** @export */\n        csv: function(anchor, table, delimiter, newLine) {\n            if (delimiter !== undefined && delimiter) {\n                csvDelimiter = delimiter;\n            }\n            if (newLine !== undefined && newLine) {\n                csvNewLine = newLine;\n            }\n\n            table = get(table);\n            var csvData = tableToCSV(table);\n            var b64 = base64(csvData);\n            return createDownloadLink(anchor,b64,'application/csv','export.csv');\n        }\n    };\n\n    return ee;\n}());\n\n    // AMD support\n    if (typeof define === 'function' && define.amd) {\n        define(function () { return ExcellentExport; });\n    // CommonJS and Node.js module support.\n    } else if (typeof exports !== 'undefined') {\n        // Support Node.js specific `module.exports` (which can be a function)\n        if (typeof module !== 'undefined' && module.exports) {\n            exports = module.exports = ExcellentExport;\n        }\n        // But always support CommonJS module 1.1.1 spec (`exports` cannot be a function)\n        exports.ExcellentExport = ExcellentExport;\n    } else {\n        global.ExcellentExport = ExcellentExport;\n    }\n})(this);\n\n"},310:function(module,exports){module.exports=function(src){function log(error){"undefined"!=typeof console&&(console.error||console.log)("[Script Loader]",error)}try{"undefined"!=typeof execScript&&function(){return"undefined"!=typeof attachEvent&&"undefined"==typeof addEventListener}()?execScript(src):"undefined"!=typeof eval?eval.call(null,src):log("EvalError: No eval function available")}catch(error){log(error)}}},311:function(module,exports,__webpack_require__){__webpack_require__(310)(__webpack_require__(309))},312:function(module,exports,__webpack_require__){(function(global){!function(domGlobals){"use strict";function curry(fn){for(var initialArgs=[],_i=1;_i<arguments.length;_i++)initialArgs[_i-1]=arguments[_i];return function(){for(var restArgs=[],_i=0;_i<arguments.length;_i++)restArgs[_i]=arguments[_i];var all=initialArgs.concat(restArgs);return fn.apply(null,all)}}function __rest(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]]);return t}function StyleSheetLoader(document,settings){void 0===settings&&(settings={});var maxLoadTime,idCount=0,loadedStates={};maxLoadTime=settings.maxLoadTime||5e3;var _setReferrerPolicy=function(referrerPolicy){settings.referrerPolicy=referrerPolicy},appendToHead=function(node){document.getElementsByTagName("head")[0].appendChild(node)},load=function(url,loadedCallback,errorCallback){var link,style,startTime,state,resolve=function(status){state.status=status,state.passed=[],state.failed=[],link&&(link.onload=null,link.onerror=null,link=null)},passed=function(){for(var callbacks=state.passed,i=callbacks.length;i--;)callbacks[i]();resolve(2)},failed=function(){for(var callbacks=state.failed,i=callbacks.length;i--;)callbacks[i]();resolve(3)},wait=function(testCallback,waitCallback){testCallback()||((new Date).getTime()-startTime<maxLoadTime?Delay.setTimeout(waitCallback):failed())},waitForWebKitLinkLoaded=function(){wait(function(){for(var styleSheet,owner,styleSheets=document.styleSheets,i=styleSheets.length;i--;)if(styleSheet=styleSheets[i],(owner=styleSheet.ownerNode?styleSheet.ownerNode:styleSheet.owningElement)&&owner.id===link.id)return passed(),!0},waitForWebKitLinkLoaded)},waitForGeckoLinkLoaded=function(){wait(function(){try{var cssRules=style.sheet.cssRules;return passed(),!!cssRules}catch(ex){}},waitForGeckoLinkLoaded)};if(url=Tools._addCacheSuffix(url),loadedStates[url]?state=loadedStates[url]:(state={passed:[],failed:[]},loadedStates[url]=state),loadedCallback&&state.passed.push(loadedCallback),errorCallback&&state.failed.push(errorCallback),1!==state.status){if(2===state.status)return void passed();if(3===state.status)return void failed();if(state.status=1,link=document.createElement("link"),link.rel="stylesheet",link.type="text/css",link.id="u"+idCount++,link.async=!1,link.defer=!1,startTime=(new Date).getTime(),settings.contentCssCors&&(link.crossOrigin="anonymous"),settings.referrerPolicy&&set(Element.fromDom(link),"referrerpolicy",settings.referrerPolicy),"onload"in link&&!function(){var webKitChunks=domGlobals.navigator.userAgent.match(/WebKit\/(\d*)/);return!!(webKitChunks&&parseInt(webKitChunks[1],10)<536)}())link.onload=waitForWebKitLinkLoaded,link.onerror=failed;else{if(domGlobals.navigator.userAgent.indexOf("Firefox")>0)return style=document.createElement("style"),style.textContent='@import "'+url+'"',waitForGeckoLinkLoaded(),void appendToHead(style);waitForWebKitLinkLoaded()}appendToHead(link),link.href=url}},loadF=function(url){return Future.nu(function(resolve){load(url,compose(resolve,constant(Result.value(url))),compose(resolve,constant(Result.error(url))))})},unbox=function(result){return result.fold(identity,identity)};return{load:load,loadAll:function(urls,success,failure){par$1(map(urls,loadF)).get(function(result){var parts=partition(result,function(r){return r.isValue()});parts.fail.length>0?failure(parts.fail.map(unbox)):success(parts.pass.map(unbox))})},_setReferrerPolicy:_setReferrerPolicy}}function Schema(settings){var validStyles,invalidStyles,schemaItems,whiteSpaceElementsMap,selfClosingElementsMap,shortEndedElementsMap,boolAttrMap,validClasses,blockElementsMap,nonEmptyElementsMap,moveCaretBeforeOnEnterElementsMap,textBlockElementsMap,textInlineElementsMap,elements={},children={},patternElements=[],customElementsMap={},specialElements={},createLookupTable=function(option,defaultValue,extendWith){var value=settings[option];return value?value=makeMap$2(value,/[, ]/,makeMap$2(value.toUpperCase(),/[, ]/)):(value=mapCache[option])||(value=makeMap$2(defaultValue," ",makeMap$2(defaultValue.toUpperCase()," ")),value=extend$1(value,extendWith),mapCache[option]=value),value};settings=settings||{},schemaItems=compileSchema(settings.schema),!1===settings.verify_html&&(settings.valid_elements="*[*]"),validStyles=compileElementMap(settings.valid_styles),invalidStyles=compileElementMap(settings.invalid_styles,"map"),validClasses=compileElementMap(settings.valid_classes,"map"),whiteSpaceElementsMap=createLookupTable("whitespace_elements","pre script noscript style textarea video audio iframe object code"),selfClosingElementsMap=createLookupTable("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr"),shortEndedElementsMap=createLookupTable("short_ended_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track"),boolAttrMap=createLookupTable("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls"),nonEmptyElementsMap=createLookupTable("non_empty_elements","td th iframe video audio object script pre code",shortEndedElementsMap),moveCaretBeforeOnEnterElementsMap=createLookupTable("move_caret_before_on_enter_elements","table",nonEmptyElementsMap),textBlockElementsMap=createLookupTable("text_block_elements","h1 h2 h3 h4 h5 h6 p div address pre form blockquote center dir fieldset header footer article section hgroup aside main nav figure"),blockElementsMap=createLookupTable("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup figcaption details summary",textBlockElementsMap),textInlineElementsMap=createLookupTable("text_inline_elements","span strong b em i font strike u var cite dfn code mark q sup sub samp"),each$3((settings.special||"script noscript noframes noembed title style textarea xmp").split(" "),function(name){specialElements[name]=new RegExp("</"+name+"[^>]*>","gi")});var patternToRegExp=function(str){return new RegExp("^"+str.replace(/([?+*])/g,".$1")+"$")},addValidElements=function(validElements){var ei,el,ai,al,matches,element,attr,attrData,elementName,attrName,attrType,attributes,attributesOrder,prefix,outputName,globalAttributes,globalAttributesOrder,key,value,elementRuleRegExp=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)\])?$/,attrRuleRegExp=/^([!\-])?(\w+[\\:]:\w+|[^=:<]+)?(?:([=:<])(.*))?$/,hasPatternsRegExp=/[*?+]/;if(validElements)for(validElements=split(validElements,","),elements["@"]&&(globalAttributes=elements["@"].attributes,globalAttributesOrder=elements["@"].attributesOrder),ei=0,el=validElements.length;ei<el;ei++)if(matches=elementRuleRegExp.exec(validElements[ei])){if(prefix=matches[1],elementName=matches[2],outputName=matches[3],attrData=matches[5],attributes={},attributesOrder=[],element={attributes:attributes,attributesOrder:attributesOrder},"#"===prefix&&(element.paddEmpty=!0),"-"===prefix&&(element.removeEmpty=!0),"!"===matches[4]&&(element.removeEmptyAttrs=!0),globalAttributes){for(key in globalAttributes)attributes[key]=globalAttributes[key];attributesOrder.push.apply(attributesOrder,globalAttributesOrder)}if(attrData)for(attrData=split(attrData,"|"),ai=0,al=attrData.length;ai<al;ai++)if(matches=attrRuleRegExp.exec(attrData[ai])){if(attr={},attrType=matches[1],attrName=matches[2].replace(/[\\:]:/g,":"),prefix=matches[3],value=matches[4],"!"===attrType&&(element.attributesRequired=element.attributesRequired||[],element.attributesRequired.push(attrName),attr.required=!0),"-"===attrType){delete attributes[attrName],attributesOrder.splice(inArray(attributesOrder,attrName),1);continue}prefix&&("="===prefix&&(element.attributesDefault=element.attributesDefault||[],element.attributesDefault.push({name:attrName,value:value}),attr.defaultValue=value),":"===prefix&&(element.attributesForced=element.attributesForced||[],element.attributesForced.push({name:attrName,value:value}),attr.forcedValue=value),"<"===prefix&&(attr.validValues=makeMap$2(value,"?"))),hasPatternsRegExp.test(attrName)?(element.attributePatterns=element.attributePatterns||[],attr.pattern=patternToRegExp(attrName),element.attributePatterns.push(attr)):(attributes[attrName]||attributesOrder.push(attrName),attributes[attrName]=attr)}globalAttributes||"@"!==elementName||(globalAttributes=attributes,globalAttributesOrder=attributesOrder),outputName&&(element.outputName=elementName,elements[outputName]=element),hasPatternsRegExp.test(elementName)?(element.pattern=patternToRegExp(elementName),patternElements.push(element)):elements[elementName]=element}},setValidElements=function(validElements){elements={},patternElements=[],addValidElements(validElements),each$3(schemaItems,function(element,name){children[name]=element.children})},addCustomElements=function(customElements){var customElementRegExp=/^(~)?(.+)$/;customElements&&(mapCache.text_block_elements=mapCache.block_elements=null,each$3(split(customElements,","),function(rule){var matches=customElementRegExp.exec(rule),inline="~"===matches[1],cloneName=inline?"span":"div",name=matches[2];if(children[name]=children[cloneName],customElementsMap[name]=cloneName,inline||(blockElementsMap[name.toUpperCase()]={},blockElementsMap[name]={}),!elements[name]){var customRule=elements[cloneName];customRule=extend$1({},customRule),delete customRule.removeEmptyAttrs,delete customRule.removeEmpty,elements[name]=customRule}each$3(children,function(element,elmName){element[cloneName]&&(children[elmName]=element=extend$1({},children[elmName]),element[name]=element[cloneName])})}))},addValidChildren=function(validChildren){var childRuleRegExp=/^([+\-]?)(\w+)\[([^\]]+)\]$/;mapCache[settings.schema]=null,validChildren&&each$3(split(validChildren,","),function(rule){var parent,prefix,matches=childRuleRegExp.exec(rule);matches&&(prefix=matches[1],parent=prefix?children[matches[2]]:children[matches[2]]={"#comment":{}},parent=children[matches[2]],each$3(split(matches[3],"|"),function(child){"-"===prefix?delete parent[child]:parent[child]={}}))})},getElementRule=function(name){var i,element=elements[name];if(element)return element;for(i=patternElements.length;i--;)if(element=patternElements[i],element.pattern.test(name))return element};settings.valid_elements?setValidElements(settings.valid_elements):(each$3(schemaItems,function(element,name){elements[name]={attributes:element.attributes,attributesOrder:element.attributesOrder},children[name]=element.children}),"html5"!==settings.schema&&each$3(split("strong/b em/i"),function(item){item=split(item,"/"),elements[item[1]].outputName=item[0]}),each$3(split("ol ul sub sup blockquote span font a table tbody tr strong em b i"),function(name){elements[name]&&(elements[name].removeEmpty=!0)}),each$3(split("p h1 h2 h3 h4 h5 h6 th td pre div address caption li"),function(name){elements[name].paddEmpty=!0}),each$3(split("span"),function(name){elements[name].removeEmptyAttrs=!0})),addCustomElements(settings.custom_elements),addValidChildren(settings.valid_children),addValidElements(settings.extended_valid_elements),addValidChildren("+ol[ul|ol],+ul[ul|ol]"),each$3({dd:"dl",dt:"dl",li:"ul ol",td:"tr",th:"tr",tr:"tbody thead tfoot",tbody:"table",thead:"table",tfoot:"table",legend:"fieldset",area:"map",param:"video audio object"},function(parents,item){elements[item]&&(elements[item].parentsRequired=split(parents))}),settings.invalid_elements&&each$3(explode$1(settings.invalid_elements),function(item){elements[item]&&delete elements[item]}),getElementRule("span")||addValidElements("span[!data-mce-type|*]");var getValidStyles=function(){return validStyles},getInvalidStyles=function(){return invalidStyles},getValidClasses=function(){return validClasses},getBoolAttrs=function(){return boolAttrMap},getBlockElements=function(){return blockElementsMap},getTextBlockElements=function(){return textBlockElementsMap},getTextInlineElements=function(){return textInlineElementsMap};return{children:children,elements:elements,getValidStyles:getValidStyles,getValidClasses:getValidClasses,getBlockElements:getBlockElements,getInvalidStyles:getInvalidStyles,getShortEndedElements:function(){return shortEndedElementsMap},getTextBlockElements:getTextBlockElements,getTextInlineElements:getTextInlineElements,getBoolAttrs:getBoolAttrs,getElementRule:getElementRule,getSelfClosingElements:function(){return selfClosingElementsMap},getNonEmptyElements:function(){return nonEmptyElementsMap},getMoveCaretBeforeOnEnterElements:function(){return moveCaretBeforeOnEnterElementsMap},getWhiteSpaceElements:function(){return whiteSpaceElementsMap},getSpecialElements:function(){return specialElements},isValidChild:function(name,child){var parent=children[name.toLowerCase()];return!(!parent||!parent[child.toLowerCase()])},isValid:function(name,attr){var attrPatterns,i,rule=getElementRule(name);if(rule){if(!attr)return!0;if(rule.attributes[attr])return!0;if(attrPatterns=rule.attributePatterns)for(i=attrPatterns.length;i--;)if(attrPatterns[i].pattern.test(name))return!0}return!1},getCustomElements:function(){return customElementsMap},addValidElements:addValidElements,setValidElements:setValidElements,addCustomElements:addCustomElements,addValidChildren:addValidChildren}}function createCache(){function cache(key,value){return keys.push(key+" ")>Expr.cacheLength&&delete cache[keys.shift()],cache[key+" "]=value}var keys=[];return cache}function markFunction(fn){return fn[expando]=!0,fn}function siblingCheck(a,b){var cur=b&&a,diff=cur&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);if(diff)return diff;if(cur)for(;cur=cur.nextSibling;)if(cur===b)return-1;return a?1:-1}function createPositionalPseudo(fn){return markFunction(function(argument){return argument=+argument,markFunction(function(seed,matches){for(var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;i--;)seed[j=matchIndexes[i]]&&(seed[j]=!(matches[j]=seed[j]))})})}function testContext(context){return context&&typeof context.getElementsByTagName!==strundefined&&context}function setFilters(){}function toSelector(tokens){for(var i=0,len=tokens.length,selector="";i<len;i++)selector+=tokens[i].value;return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&"parentNode"===dir,doneName=done++;return combinator.first?function(elem,context,xml){for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)return matcher(elem,context,xml)}:function(elem,context,xml){var oldCache,outerCache,newCache=[dirruns,doneName];if(xml){for(;elem=elem[dir];)if((1===elem.nodeType||checkNonElements)&&matcher(elem,context,xml))return!0}else for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements){if(outerCache=elem[expando]||(elem[expando]={}),(oldCache=outerCache[dir])&&oldCache[0]===dirruns&&oldCache[1]===doneName)return newCache[2]=oldCache[2];if(outerCache[dir]=newCache,newCache[2]=matcher(elem,context,xml))return!0}}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){for(var i=matchers.length;i--;)if(!matchers[i](elem,context,xml))return!1;return!0}:matchers[0]}function multipleContexts(selector,contexts,results){for(var i=0,len=contexts.length;i<len;i++)Sizzle(selector,contexts[i],results);return results}function condense(unmatched,map,filter,context,xml){for(var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=null!=map;i<len;i++)(elem=unmatched[i])&&(filter&&!filter(elem,context,xml)||(newUnmatched.push(elem),mapped&&map.push(i)));return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){return postFilter&&!postFilter[expando]&&(postFilter=setMatcher(postFilter)),postFinder&&!postFinder[expando]&&(postFinder=setMatcher(postFinder,postSelector)),markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=!preFilter||!seed&&selector?elems:condense(elems,preMap,preFilter,context,xml),matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher&&matcher(matcherIn,matcherOut,context,xml),postFilter)for(temp=condense(matcherOut,postMap),postFilter(temp,[],context,xml),i=temp.length;i--;)(elem=temp[i])&&(matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem));if(seed){if(postFinder||preFilter){if(postFinder){for(temp=[],i=matcherOut.length;i--;)(elem=matcherOut[i])&&temp.push(matcherIn[i]=elem);postFinder(null,matcherOut=[],temp,xml)}for(i=matcherOut.length;i--;)(elem=matcherOut[i])&&(temp=postFinder?indexOf$2.call(seed,elem):preMap[i])>-1&&(seed[temp]=!(results[temp]=elem))}}else matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut),postFinder?postFinder(null,results,matcherOut,xml):push.apply(results,matcherOut)})}function matcherFromTokens(tokens){for(var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,!0),matchAnyContext=addCombinator(function(elem){return indexOf$2.call(checkContext,elem)>-1},implicitRelative,!0),matchers=[function(elem,context,xml){return!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml))}];i<len;i++)if(matcher=Expr.relative[tokens[i].type])matchers=[addCombinator(elementMatcher(matchers),matcher)];else{if(matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches),matcher[expando]){for(j=++i;j<len&&!Expr.relative[tokens[j].type];j++);return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:" "===tokens[i-2].type?"*":""})).replace(rtrim,"$1"),matcher,i<j&&matcherFromTokens(tokens.slice(i,j)),j<len&&matcherFromTokens(tokens=tokens.slice(j)),j<len&&toSelector(tokens))}matchers.push(matcher)}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find.TAG("*",outermost),dirrunsUnique=dirruns+=null==contextBackup?1:Math.random()||.1,len=elems.length;for(outermost&&(outermostContext=context!==document&&context);i!==len&&null!=(elem=elems[i]);i++){if(byElement&&elem){for(j=0;matcher=elementMatchers[j++];)if(matcher(elem,context,xml)){results.push(elem);break}outermost&&(dirruns=dirrunsUnique)}bySet&&((elem=!matcher&&elem)&&matchedCount--,seed&&unmatched.push(elem))}if(matchedCount+=i,bySet&&i!==matchedCount){for(j=0;matcher=setMatchers[j++];)matcher(unmatched,setMatched,context,xml);if(seed){if(matchedCount>0)for(;i--;)unmatched[i]||setMatched[i]||(setMatched[i]=pop.call(results));setMatched=condense(setMatched)}push.apply(results,setMatched),outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1&&Sizzle.uniqueSort(results)}return outermost&&(dirruns=dirrunsUnique,outermostContext=contextBackup),unmatched};return bySet?markFunction(superMatcher):superMatcher}function DOMUtils(doc,settings){var _this=this;void 0===settings&&(settings={});var attrHooks,addedStyles={},win=domGlobals.window,files={},counter=0,styleSheetLoader=StyleSheetLoader(doc,{contentCssCors:settings.contentCssCors,referrerPolicy:settings.referrerPolicy}),boundEvents=[],schema=settings.schema?settings.schema:Schema({}),styles=Styles({url_converter:settings.url_converter,url_converter_scope:settings.url_converter_scope},settings.schema),events=settings.ownEvents?new EventUtils:EventUtils.Event,blockElementsMap=schema.getBlockElements(),$=DomQuery.overrideDefaults(function(){return{context:doc,element:self.getRoot()}}),isBlock=function(node){if("string"==typeof node)return!!blockElementsMap[node];if(node){var type=node.nodeType;if(type)return!(1!==type||!blockElementsMap[node.nodeName])}return!1},get=function(elm){if(elm&&doc&&"string"==typeof elm){var node=doc.getElementById(elm);return node&&node.id!==elm?doc.getElementsByName(elm)[1]:node}return elm},$$=function(elm){return"string"==typeof elm&&(elm=get(elm)),$(elm)},getAttrib=function(elm,name,defaultVal){var hook,value,$elm=$$(elm);return $elm.length&&(hook=attrHooks[name],value=hook&&hook.get?hook.get($elm,name):$elm.attr(name)),void 0===value&&(value=defaultVal||""),value},getAttribs=function(elm){var node=get(elm);return node?node.attributes:[]},setAttrib=function(elm,name,value){var originalValue,hook;""===value&&(value=null);var $elm=$$(elm);originalValue=$elm.attr(name),$elm.length&&(hook=attrHooks[name],hook&&hook.set?hook.set($elm,value,name):$elm.attr(name,value),originalValue!==value&&settings.onSetAttrib&&settings.onSetAttrib({attrElm:$elm,attrName:name,attrValue:value}))},clone=function(node,deep){if(!isIE||1!==node.nodeType||deep)return node.cloneNode(deep);if(!deep){var clone_1=doc.createElement(node.nodeName);return each$5(getAttribs(node),function(attr){setAttrib(clone_1,attr.nodeName,getAttrib(node,attr.nodeName))}),clone_1}return null},getRoot=function(){return settings.root_element||doc.body},getViewPort=function(argWin){var vp=getBounds(argWin);return{x:vp.x(),y:vp.y(),w:vp.width(),h:vp.height()}},getPos=function(elm,rootElm){return Position$1.getPos(doc.body,get(elm),rootElm)},setStyle=function(elm,name,value){var $elm=isString(name)?$$(elm).css(name,value):$$(elm).css(name);settings.update_styles&&updateInternalStyleAttr(styles,$elm)},setStyles=function(elm,stylesArg){var $elm=$$(elm).css(stylesArg);settings.update_styles&&updateInternalStyleAttr(styles,$elm)},getStyle=function(elm,name,computed){var $elm=$$(elm);return computed?$elm.css(name):(name=name.replace(/-(\D)/g,function(a,b){return b.toUpperCase()}),"float"===name&&(name=Env.browser.isIE()?"styleFloat":"cssFloat"),$elm[0]&&$elm[0].style?$elm[0].style[name]:void 0)},getSize=function(elm){var w,h;return elm=get(elm),w=getStyle(elm,"width"),h=getStyle(elm,"height"),-1===w.indexOf("px")&&(w=0),-1===h.indexOf("px")&&(h=0),{w:parseInt(w,10)||elm.offsetWidth||elm.clientWidth,h:parseInt(h,10)||elm.offsetHeight||elm.clientHeight}},getRect=function(elm){var pos,size;return elm=get(elm),pos=getPos(elm),size=getSize(elm),{x:pos.x,y:pos.y,w:size.w,h:size.h}},is=function(elm,selector){var i;if(!elm)return!1;if(!Array.isArray(elm)){if("*"===selector)return 1===elm.nodeType;if(simpleSelectorRe.test(selector)){var selectors=selector.toLowerCase().split(/,/),elmName=elm.nodeName.toLowerCase();for(i=selectors.length-1;i>=0;i--)if(selectors[i]===elmName)return!0;return!1}if(elm.nodeType&&1!==elm.nodeType)return!1}var elms=Array.isArray(elm)?elm:[elm];return Sizzle(selector,elms[0].ownerDocument||elms[0],null,elms).length>0},getParents=function(elm,selector,root,collect){var selectorVal,result=[],node=get(elm);for(collect=void 0===collect,root=root||("BODY"!==getRoot().nodeName?getRoot().parentNode:null),Tools.is(selector,"string")&&(selectorVal=selector,selector="*"===selector?function(node){return 1===node.nodeType}:function(node){return is(node,selectorVal)});node&&node!==root&&node.nodeType&&9!==node.nodeType;){if(!selector||"function"==typeof selector&&selector(node)){if(!collect)return[node];result.push(node)}node=node.parentNode}return collect?result:null},getParent=function(node,selector,root){var parents=getParents(node,selector,root,!1);return parents&&parents.length>0?parents[0]:null},_findSib=function(node,selector,name){var func=selector;if(node)for("string"==typeof selector&&(func=function(node){return is(node,selector)}),node=node[name];node;node=node[name])if("function"==typeof func&&func(node))return node;return null},getNext=function(node,selector){return _findSib(node,selector,"nextSibling")},getPrev=function(node,selector){return _findSib(node,selector,"previousSibling")},select=function(selector,scope){return Sizzle(selector,get(scope)||settings.root_element||doc,[])},run=function(elm,func,scope){var result,node="string"==typeof elm?get(elm):elm;if(!node)return!1;if(Tools.isArray(node)&&(node.length||0===node.length))return result=[],each$5(node,function(elm,i){elm&&("string"==typeof elm&&(elm=get(elm)),result.push(func.call(scope,elm,i)))}),result;var context=scope||_this;return func.call(context,node)},setAttribs=function(elm,attrs){$$(elm).each(function(i,node){each$5(attrs,function(value,name){setAttrib(node,name,value)})})},setHTML=function(elm,html){var $elm=$$(elm);isIE?$elm.each(function(i,target){if(!1!==target.canHaveHTML){for(;target.firstChild;)target.removeChild(target.firstChild);try{target.innerHTML="<br>"+html,target.removeChild(target.firstChild)}catch(ex){DomQuery("<div></div>").html("<br>"+html).contents().slice(1).appendTo(target)}return html}}):$elm.html(html)},add=function(parentElm,name,attrs,html,create){return run(parentElm,function(parentElm){var newElm="string"==typeof name?doc.createElement(name):name;return setAttribs(newElm,attrs),html&&("string"!=typeof html&&html.nodeType?newElm.appendChild(html):"string"==typeof html&&setHTML(newElm,html)),create?newElm:parentElm.appendChild(newElm)})},create=function(name,attrs,html){return add(doc.createElement(name),name,attrs,html,!0)},decode=Entities.decode,encode=Entities.encodeAllRaw,createHTML=function(name,attrs,html){var key,outHtml="";outHtml+="<"+name;for(key in attrs)attrs.hasOwnProperty(key)&&null!==attrs[key]&&void 0!==attrs[key]&&(outHtml+=" "+key+'="'+encode(attrs[key])+'"');return void 0!==html?outHtml+">"+html+"</"+name+">":outHtml+" />"},createFragment=function(html){var node,container=doc.createElement("div"),frag=doc.createDocumentFragment();for(html&&(container.innerHTML=html);node=container.firstChild;)frag.appendChild(node);return frag},remove=function(node,keepChildren){var $node=$$(node);return keepChildren?$node.each(function(){for(var child;child=this.firstChild;)3===child.nodeType&&0===child.data.length?this.removeChild(child):this.parentNode.insertBefore(child,this)}).remove():$node.remove(),$node.length>1?$node.toArray():$node[0]},removeAllAttribs=function(e){return run(e,function(e){var i,attrs=e.attributes;for(i=attrs.length-1;i>=0;i--)e.removeAttributeNode(attrs.item(i))})},parseStyle=function(cssText){return styles.parse(cssText)},serializeStyle=function(stylesArg,name){return styles.serialize(stylesArg,name)},addStyle=function(cssText){var head,styleElm;if(self!==DOMUtils.DOM&&doc===domGlobals.document){if(addedStyles[cssText])return;addedStyles[cssText]=!0}styleElm=doc.getElementById("mceDefaultStyles"),styleElm||(styleElm=doc.createElement("style"),styleElm.id="mceDefaultStyles",styleElm.type="text/css",head=doc.getElementsByTagName("head")[0],head.firstChild?head.insertBefore(styleElm,head.firstChild):head.appendChild(styleElm)),styleElm.styleSheet?styleElm.styleSheet.cssText+=cssText:styleElm.appendChild(doc.createTextNode(cssText))},loadCSS=function(url){var head;if(self!==DOMUtils.DOM&&doc===domGlobals.document)return void DOMUtils.DOM.loadCSS(url);url||(url=""),head=doc.getElementsByTagName("head")[0],each$5(url.split(","),function(url){var link;url=Tools._addCacheSuffix(url),files[url]||(files[url]=!0,link=create("link",__assign(__assign({rel:"stylesheet",type:"text/css",href:url},settings.contentCssCors?{crossOrigin:"anonymous"}:{}),settings.referrerPolicy?{referrerPolicy:settings.referrerPolicy}:{})),head.appendChild(link))})},toggleClass=function(elm,cls,state){$$(elm).toggleClass(cls,state).each(function(){""===this.className&&DomQuery(this).attr("class",null)})},addClass=function(elm,cls){$$(elm).addClass(cls)},removeClass=function(elm,cls){toggleClass(elm,cls,!1)},hasClass=function(elm,cls){return $$(elm).hasClass(cls)},show=function(elm){$$(elm).show()},hide=function(elm){$$(elm).hide()},isHidden=function(elm){return"none"===$$(elm).css("display")},uniqueId=function(prefix){return(prefix||"mce_")+counter++},getOuterHTML=function(elm){var node="string"==typeof elm?get(elm):elm;return NodeType.isElement(node)?node.outerHTML:DomQuery("<div></div>").append(DomQuery(node).clone()).html()},setOuterHTML=function(elm,html){$$(elm).each(function(){try{if("outerHTML"in this)return void(this.outerHTML=html)}catch(ex){}remove(DomQuery(this).html(html),!0)})},insertAfter=function(node,reference){var referenceNode=get(reference);return run(node,function(node){var parent,nextSibling;return parent=referenceNode.parentNode,nextSibling=referenceNode.nextSibling,nextSibling?parent.insertBefore(node,nextSibling):parent.appendChild(node),node})},replace=function(newElm,oldElm,keepChildren){return run(oldElm,function(oldElm){return Tools.is(oldElm,"array")&&(newElm=newElm.cloneNode(!0)),keepChildren&&each$5(grep$1(oldElm.childNodes),function(node){newElm.appendChild(node)}),oldElm.parentNode.replaceChild(newElm,oldElm)})},rename=function(elm,name){var newElm;return elm.nodeName!==name.toUpperCase()&&(newElm=create(name),each$5(getAttribs(elm),function(attrNode){setAttrib(newElm,attrNode.nodeName,getAttrib(elm,attrNode.nodeName))}),replace(newElm,elm,!0)),newElm||elm},findCommonAncestor=function(a,b){for(var pe,ps=a;ps;){for(pe=b;pe&&ps!==pe;)pe=pe.parentNode;if(ps===pe)break;ps=ps.parentNode}return!ps&&a.ownerDocument?a.ownerDocument.documentElement:ps},toHex=function(rgbVal){return styles.toHex(Tools.trim(rgbVal))},isEmpty=function(node,elements){var i,attributes,type,name,brCount=0;if(node=node.firstChild){var walker=new TreeWalker(node,node.parentNode),whitespace=schema?schema.getWhiteSpaceElements():{};elements=elements||(schema?schema.getNonEmptyElements():null);do{if(type=node.nodeType,NodeType.isElement(node)){var bogusVal=node.getAttribute("data-mce-bogus");if(bogusVal){node=walker.next("all"===bogusVal);continue}if(name=node.nodeName.toLowerCase(),elements&&elements[name]){if("br"===name){brCount++,node=walker.next();continue}return!1}for(attributes=getAttribs(node),i=attributes.length;i--;)if("name"===(name=attributes[i].nodeName)||"data-mce-bookmark"===name)return!1}if(8===type)return!1;if(3===type&&!whiteSpaceRegExp$2.test(node.nodeValue))return!1;if(3===type&&node.parentNode&&whitespace[node.parentNode.nodeName]&&whiteSpaceRegExp$2.test(node.nodeValue))return!1;node=walker.next()}while(node)}return brCount<=1},createRng=function(){return doc.createRange()},split=function(parentElm,splitElm,replacementElm){var bef,aft,pa,r=createRng();if(parentElm&&splitElm)return r.setStart(parentElm.parentNode,findNodeIndex(parentElm)),r.setEnd(splitElm.parentNode,findNodeIndex(splitElm)),bef=r.extractContents(),r=createRng(),r.setStart(splitElm.parentNode,findNodeIndex(splitElm)+1),r.setEnd(parentElm.parentNode,findNodeIndex(parentElm)+1),aft=r.extractContents(),pa=parentElm.parentNode,pa.insertBefore(TrimNode.trimNode(self,bef),parentElm),replacementElm?pa.insertBefore(replacementElm,parentElm):pa.insertBefore(splitElm,parentElm),pa.insertBefore(TrimNode.trimNode(self,aft),parentElm),remove(parentElm),replacementElm||splitElm},bind=function(target,name,func,scope){if(Tools.isArray(target)){for(var i=target.length,rv=[];i--;)rv[i]=bind(target[i],name,func,scope);return rv}return!settings.collect||target!==doc&&target!==win||boundEvents.push([target,name,func,scope]),events.bind(target,name,func,scope||self)},unbind=function(target,name,func){var i;if(Tools.isArray(target)){i=target.length;for(var rv=[];i--;)rv[i]=unbind(target[i],name,func);return rv}if(boundEvents&&(target===doc||target===win))for(i=boundEvents.length;i--;){var item=boundEvents[i];target!==item[0]||name&&name!==item[1]||func&&func!==item[2]||events.unbind(item[0],item[1],item[2])}return events.unbind(target,name,func)},fire=function(target,name,evt){return events.fire(target,name,evt)},getContentEditable=function(node){if(node&&NodeType.isElement(node)){var contentEditable=node.getAttribute("data-mce-contenteditable");return contentEditable&&"inherit"!==contentEditable?contentEditable:"inherit"!==node.contentEditable?node.contentEditable:null}return null},getContentEditableParent=function(node){for(var root=getRoot(),state=null;node&&node!==root&&null===(state=getContentEditable(node));node=node.parentNode);return state},destroy=function(){if(boundEvents)for(var i=boundEvents.length;i--;){var item=boundEvents[i];events.unbind(item[0],item[1],item[2])}Sizzle.setDocument&&Sizzle.setDocument()},isChildOf=function(node,parent){for(;node;){if(parent===node)return!0;node=node.parentNode}return!1},dumpRng=function(r){return"startContainer: "+r.startContainer.nodeName+", startOffset: "+r.startOffset+", endContainer: "+r.endContainer.nodeName+", endOffset: "+r.endOffset},self={doc:doc,settings:settings,win:win,files:files,stdMode:!0,boxModel:!0,styleSheetLoader:styleSheetLoader,boundEvents:boundEvents,styles:styles,schema:schema,events:events,isBlock:isBlock,$:$,$$:$$,root:null,clone:clone,getRoot:getRoot,getViewPort:getViewPort,getRect:getRect,getSize:getSize,getParent:getParent,getParents:getParents,get:get,getNext:getNext,getPrev:getPrev,select:select,is:is,add:add,create:create,createHTML:createHTML,createFragment:createFragment,remove:remove,setStyle:setStyle,getStyle:getStyle,setStyles:setStyles,removeAllAttribs:removeAllAttribs,setAttrib:setAttrib,setAttribs:setAttribs,getAttrib:getAttrib,getPos:getPos,parseStyle:parseStyle,serializeStyle:serializeStyle,addStyle:addStyle,loadCSS:loadCSS,addClass:addClass,removeClass:removeClass,hasClass:hasClass,toggleClass:toggleClass,show:show,hide:hide,isHidden:isHidden,uniqueId:uniqueId,setHTML:setHTML,getOuterHTML:getOuterHTML,setOuterHTML:setOuterHTML,decode:decode,encode:encode,insertAfter:insertAfter,replace:replace,rename:rename,findCommonAncestor:findCommonAncestor,toHex:toHex,run:run,getAttribs:getAttribs,isEmpty:isEmpty,createRng:createRng,nodeIndex:findNodeIndex,split:split,bind:bind,unbind:unbind,fire:fire,getContentEditable:getContentEditable,getContentEditableParent:getContentEditableParent,destroy:destroy,isChildOf:isChildOf,dumpRng:dumpRng};return attrHooks=setupAttrHooks(styles,settings,function(){return self}),self}function AddOnManager(){var _this=this,items=[],urls={},lookup={},_listeners=[],runListeners=function(name,state){var matchedListeners=filter(_listeners,function(listener){return listener.name===name&&listener.state===state});each(matchedListeners,function(listener){return listener.callback()})},get=function(name){if(lookup[name])return lookup[name].instance},dependencies=function(name){var result;return lookup[name]&&(result=lookup[name].dependencies),result||[]},requireLangPack=function(name,languages){!1!==AddOnManager.languageLoad&&waitFor(name,function(){var language=I18n.getCode(),wrappedLanguages=","+(languages||"")+",";!language||languages&&-1===wrappedLanguages.indexOf(","+language+",")||ScriptLoader.ScriptLoader.add(urls[name]+"/langs/"+language+".js")},"loaded")},add=function(id,addOn,dependencies){var addOnConstructor=addOn;return items.push(addOnConstructor),lookup[id]={instance:addOnConstructor,dependencies:dependencies},runListeners(id,"added"),addOnConstructor},remove=function(name){delete urls[name],delete lookup[name]},createUrl=function(baseUrl,dep){return"object"==typeof dep?dep:"string"==typeof baseUrl?{prefix:"",resource:dep,suffix:""}:{prefix:baseUrl.prefix,resource:dep,suffix:baseUrl.suffix}},addComponents=function(pluginName,scripts){var pluginUrl=_this.urls[pluginName];each(scripts,function(script){ScriptLoader.ScriptLoader.add(pluginUrl+"/"+script)})},loadDependencies=function(name,addOnUrl,success,scope){var deps=dependencies(name);each(deps,function(dep){var newUrl=createUrl(addOnUrl,dep);load(newUrl.resource,newUrl,void 0,void 0)}),success&&(scope?success.call(scope):success.call(ScriptLoader))},load=function(name,addOnUrl,success,scope,failure){if(!urls[name]){var urlString="string"==typeof addOnUrl?addOnUrl:addOnUrl.prefix+addOnUrl.resource+addOnUrl.suffix;0!==urlString.indexOf("/")&&-1===urlString.indexOf("://")&&(urlString=AddOnManager.baseURL+"/"+urlString),urls[name]=urlString.substring(0,urlString.lastIndexOf("/"));var done=function(){runListeners(name,"loaded"),loadDependencies(name,addOnUrl,success,scope)};lookup[name]?done():ScriptLoader.ScriptLoader.add(urlString,done,scope,failure)}},waitFor=function(name,callback,state){void 0===state&&(state="added"),has(lookup,name)&&"added"===state?callback():has(urls,name)&&"loaded"===state?callback():_listeners.push({name:name,state:state,callback:callback})};return{items:items,urls:urls,lookup:lookup,_listeners:_listeners,get:get,dependencies:dependencies,requireLangPack:requireLangPack,add:add,remove:remove,createUrl:createUrl,addComponents:addComponents,load:load,waitFor:waitFor}}function ClosestOrAncestor(is,ancestor,scope,a,isRoot){return is(scope,a)?Option.some(scope):isFunction(isRoot)&&isRoot(scope)?Option.none():ancestor(scope,a,isRoot)}function CaretPosition(container,offset,clientRects){var isAtStart=function(){return isText$4(container),0===offset},isAtEnd=function(){return isText$4(container)?offset>=container.data.length:offset>=container.childNodes.length},toRange=function(){var range;return range=createRange(container.ownerDocument),range.setStart(container,offset),range.setEnd(container,offset),range},getClientRects=function(){return clientRects||(clientRects=getCaretPositionClientRects(CaretPosition(container,offset))),clientRects},isVisible=function(){return getClientRects().length>0},isEqual=function(caretPosition){return caretPosition&&container===caretPosition.container()&&offset===caretPosition.offset()},getNode=function(before){return resolveIndex(container,before?offset-1:offset)};return{container:constant(container),offset:constant(offset),toRange:toRange,getClientRects:getClientRects,isVisible:isVisible,isAtStart:isAtStart,isAtEnd:isAtEnd,isEqual:isEqual,getNode:getNode}}function SaxParser(settings,schema){void 0===schema&&(schema=Schema());var noop=function(){};settings=settings||{},!1!==settings.fix_self_closing&&(settings.fix_self_closing=!0);var comment=settings.comment?settings.comment:noop,cdata=settings.cdata?settings.cdata:noop,text=settings.text?settings.text:noop,start=settings.start?settings.start:noop,end=settings.end?settings.end:noop,pi=settings.pi?settings.pi:noop,doctype=settings.doctype?settings.doctype:noop;return{parse:function(html,format){void 0===format&&(format="html");var matches,value,endRegExp,attrList,i,textData,name,isInternalElement,removeInternalElements,shortEndedElements,fillAttrsMap,isShortEnded,validate,elementRule,isValidElement,attr,attribsValue,validAttributesMap,validAttributePatterns,attributesRequired,attributesDefault,attributesForced,processHtml,anyAttributesRequired,selfClosing,tokenRegExp,attrRegExp,specialElements,attrValue,fixSelfClosing,index=0,stack=[],idCount=0,decode=Entities.decode,filteredUrlAttrs=Tools.makeMap("src,href,data,background,formaction,poster,xlink:href"),scriptUriRegExp=/((java|vb)script|mhtml):/i,parsingMode="html"===format?0:1,processEndTag=function(name){var pos,i;for(pos=stack.length;pos--&&stack[pos].name!==name;);if(pos>=0){for(i=stack.length-1;i>=pos;i--)name=stack[i],name.valid&&end(name.name);stack.length=pos}},processComment=function(value){""!==value&&(">"===value.charAt(0)&&(value=" "+value),settings.allow_conditional_comments||"[if"!==value.substr(0,3).toLowerCase()||(value=" "+value),comment(value))},processMalformedComment=function(value,startIndex){var startTag=value||"",isBogus=!startsWith(startTag,"--"),endIndex=findCommentEndIndex(html,isBogus,startIndex);return value=html.substr(startIndex,endIndex-startIndex),processComment(isBogus?startTag+value:value),endIndex+1},parseAttribute=function(match,name,value,val2,val3){var attrRule,i,trimRegExp=/[\s\u0000-\u001F]+/g;if(name=name.toLowerCase(),value=name in fillAttrsMap?name:decode(value||val2||val3||""),validate&&!isInternalElement&&!1===isValidPrefixAttrName(name)){if(!(attrRule=validAttributesMap[name])&&validAttributePatterns){for(i=validAttributePatterns.length;i--&&(attrRule=validAttributePatterns[i],!attrRule.pattern.test(name)););-1===i&&(attrRule=null)}if(!attrRule)return;if(attrRule.validValues&&!(value in attrRule.validValues))return}if(filteredUrlAttrs[name]&&!settings.allow_script_urls){var uri=value.replace(trimRegExp,"");try{uri=decodeURIComponent(uri)}catch(ex){uri=unescape(uri)}if(scriptUriRegExp.test(uri))return;if(isInvalidUri(settings,uri))return}isInternalElement&&(name in filteredUrlAttrs||0===name.indexOf("on"))||(attrList.map[name]=value,attrList.push({name:name,value:value}))};for(tokenRegExp=new RegExp("<(?:(?:!--([\\w\\W]*?)--!?>)|(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|(?:![Dd][Oo][Cc][Tt][Yy][Pp][Ee]([\\w\\W]*?)>)|(?:!(--)?)|(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|(?:\\/([A-Za-z][A-Za-z0-9\\-_\\:\\.]*)>)|(?:([A-Za-z][A-Za-z0-9\\-_\\:\\.]*)((?:\\s+[^\"'>]+(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>]*))*|\\/|\\s+)>))","g"),attrRegExp=/([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:[^\"])*)\")|(?:\'((?:[^\'])*)\')|([^>\s]+)))?/g,shortEndedElements=schema.getShortEndedElements(),selfClosing=settings.self_closing_elements||schema.getSelfClosingElements(),fillAttrsMap=schema.getBoolAttrs(),validate=settings.validate,removeInternalElements=settings.remove_internals,fixSelfClosing=settings.fix_self_closing,specialElements=schema.getSpecialElements(),processHtml=html+">";matches=tokenRegExp.exec(processHtml);){var matchText=matches[0];if(index<matches.index&&text(decode(html.substr(index,matches.index-index))),value=matches[7])value=value.toLowerCase(),":"===value.charAt(0)&&(value=value.substr(1)),processEndTag(value);else if(value=matches[8]){if(matches.index+matchText.length>html.length){text(decode(html.substr(matches.index))),index=matches.index+matchText.length;continue}value=value.toLowerCase(),":"===value.charAt(0)&&(value=value.substr(1)),isShortEnded=value in shortEndedElements,fixSelfClosing&&selfClosing[value]&&stack.length>0&&stack[stack.length-1].name===value&&processEndTag(value);var bogusValue=checkBogusAttribute(attrRegExp,matches[9]);if(null!==bogusValue){if("all"===bogusValue){index=findEndTagIndex(schema,html,tokenRegExp.lastIndex),tokenRegExp.lastIndex=index;continue}isValidElement=!1}if(!validate||(elementRule=schema.getElementRule(value))){if(isValidElement=!0,validate&&(validAttributesMap=elementRule.attributes,validAttributePatterns=elementRule.attributePatterns),(attribsValue=matches[9])?(isInternalElement=-1!==attribsValue.indexOf("data-mce-type"),isInternalElement&&removeInternalElements&&(isValidElement=!1),attrList=[],attrList.map={},attribsValue.replace(attrRegExp,parseAttribute)):(attrList=[],attrList.map={}),validate&&!isInternalElement){if(attributesRequired=elementRule.attributesRequired,attributesDefault=elementRule.attributesDefault,attributesForced=elementRule.attributesForced,anyAttributesRequired=elementRule.removeEmptyAttrs,anyAttributesRequired&&!attrList.length&&(isValidElement=!1),attributesForced)for(i=attributesForced.length;i--;)attr=attributesForced[i],name=attr.name,attrValue=attr.value,"{$uid}"===attrValue&&(attrValue="mce_"+idCount++),attrList.map[name]=attrValue,attrList.push({name:name,value:attrValue});if(attributesDefault)for(i=attributesDefault.length;i--;)attr=attributesDefault[i],(name=attr.name)in attrList.map||(attrValue=attr.value,"{$uid}"===attrValue&&(attrValue="mce_"+idCount++),attrList.map[name]=attrValue,attrList.push({name:name,value:attrValue}));if(attributesRequired){for(i=attributesRequired.length;i--&&!(attributesRequired[i]in attrList.map););-1===i&&(isValidElement=!1)}if(attr=attrList.map["data-mce-bogus"]){if("all"===attr){index=findEndTagIndex(schema,html,tokenRegExp.lastIndex),tokenRegExp.lastIndex=index;continue}isValidElement=!1}}isValidElement&&start(value,attrList,isShortEnded)}else isValidElement=!1;if(endRegExp=specialElements[value]){endRegExp.lastIndex=index=matches.index+matchText.length,(matches=endRegExp.exec(html))?(isValidElement&&(textData=html.substr(index,matches.index-index)),index=matches.index+matches[0].length):(textData=html.substr(index),index=html.length),isValidElement&&(textData.length>0&&text(textData,!0),end(value)),tokenRegExp.lastIndex=index;continue}isShortEnded||(attribsValue&&attribsValue.indexOf("/")===attribsValue.length-1?isValidElement&&end(value):stack.push({name:value,valid:isValidElement}))}else if(value=matches[1])processComment(value);else if(value=matches[2]){var isValidCdataSection=1===parsingMode||settings.preserve_cdata||stack.length>0&&schema.isValidChild(stack[stack.length-1].name,"#cdata");if(!isValidCdataSection){index=processMalformedComment("",matches.index+2),tokenRegExp.lastIndex=index;continue}cdata(value)}else if(value=matches[3])doctype(value);else{if((value=matches[4])||"<!"===matchText){index=processMalformedComment(value,matches.index+matchText.length),tokenRegExp.lastIndex=index;continue}if(value=matches[5]){if(1!==parsingMode){index=processMalformedComment("?",matches.index+2),tokenRegExp.lastIndex=index;continue}pi(value,matches[6])}}index=matches.index+matchText.length}for(index<html.length&&text(decode(html.substr(index))),i=stack.length-1;i>=0;i--)value=stack[i],value.valid&&end(value.name)}}}function NotificationManagerImpl(){var unimplemented=function(){throw new Error("Theme did not provide a NotificationManager implementation.")};return{open:unimplemented,close:unimplemented,reposition:unimplemented,getArgs:unimplemented}}function NotificationManager(editor){var notifications=[],getImplementation=function(){var theme=editor.theme;return theme&&theme.getNotificationManagerImpl?theme.getNotificationManagerImpl():NotificationManagerImpl()},getTopNotification=function(){return Option.from(notifications[0])},isEqual=function(a,b){return!(a.type!==b.type||a.text!==b.text||a.progressBar||a.timeout||b.progressBar||b.timeout)},reposition=function(){notifications.length>0&&getImplementation().reposition(notifications)},addNotification=function(notification){notifications.push(notification)},closeNotification=function(notification){findIndex(notifications,function(otherNotification){return otherNotification===notification}).each(function(index){notifications.splice(index,1)})},open=function(spec){if(!editor.removed&&EditorView.isEditorAttachedToDom(editor))return find(notifications,function(notification){return isEqual(getImplementation().getArgs(notification),spec)}).getOrThunk(function(){editor.editorManager.setActive(editor);var notification=getImplementation().open(spec,function(){closeNotification(notification),reposition()});return addNotification(notification),reposition(),notification})},close=function(){getTopNotification().each(function(notification){getImplementation().close(notification),closeNotification(notification),reposition()})},getNotifications=function(){return notifications};return function(editor){editor.on("SkinLoaded",function(){var serviceMessage=editor.settings.service_message;serviceMessage&&open({text:serviceMessage,type:"warning",timeout:0})}),editor.on("ResizeEditor ResizeWindow NodeChange",function(){Delay.requestAnimationFrame(reposition)}),editor.on("remove",function(){each(notifications.slice(),function(notification){getImplementation().close(notification)})})}(editor),{open:open,close:close,getNotifications:getNotifications}}function WindowManagerImpl(){var unimplemented=function(){throw new Error("Theme did not provide a WindowManager implementation.")};return{open:unimplemented,openUrl:unimplemented,alert:unimplemented,confirm:unimplemented,close:unimplemented,getParams:unimplemented,setParams:unimplemented}}function BookmarkManager(selection){return{getBookmark:curry(Bookmarks.getBookmark,selection),moveToBookmark:curry(Bookmarks.moveToBookmark,selection)}}function SelectorChanged(dom,editor){var selectorChangedData,currentSelectors;return{selectorChangedWithUnbind:function(selector,callback){return selectorChangedData||(selectorChangedData={},currentSelectors={},editor.on("NodeChange",function(e){var node=e.element,parents=dom.getParents(node,null,dom.getRoot()),matchedSelectors={};Tools.each(selectorChangedData,function(callbacks,selector){Tools.each(parents,function(node){if(dom.is(node,selector))return currentSelectors[selector]||(Tools.each(callbacks,function(callback){callback(!0,{node:node,selector:selector,parents:parents})}),currentSelectors[selector]=callbacks),matchedSelectors[selector]=callbacks,!1})}),Tools.each(currentSelectors,function(callbacks,selector){matchedSelectors[selector]||(delete currentSelectors[selector],Tools.each(callbacks,function(callback){callback(!1,{node:node,selector:selector,parents:parents})}))})})),selectorChangedData[selector]||(selectorChangedData[selector]=[]),selectorChangedData[selector].push(callback),{unbind:function(){deleteFromCallbackMap(selectorChangedData,selector,callback),deleteFromCallbackMap(currentSelectors,selector,callback)}}}}}function ImageScanner(uploadStatus,blobCache){var cachedPromises={};return{findAll:function(elm,predicate){var images;predicate||(predicate=constant(!0)),images=filter(getAllImages(elm),function(img){var src=img.src;return!!Env.fileApi&&(!img.hasAttribute("data-mce-bogus")&&(!img.hasAttribute("data-mce-placeholder")&&(!(!src||src===Env.transparentSrc)&&(0===src.indexOf("blob:")?!uploadStatus.isUploaded(src)&&predicate(img):0===src.indexOf("data:")&&predicate(img)))))});var promises=map(images,function(img){if(cachedPromises[img.src])return new promiseObj(function(resolve){cachedPromises[img.src].then(function(imageInfo){if("string"==typeof imageInfo)return imageInfo;resolve({image:img,blobInfo:imageInfo.blobInfo})})});var newPromise=new promiseObj(function(resolve,reject){imageToBlobInfo(blobCache,img,resolve,reject)}).then(function(result){return delete cachedPromises[result.image.src],result}).catch(function(error){return delete cachedPromises[img.src],error});return cachedPromises[img.src]=newPromise,newPromise});return promiseObj.all(promises)}}}function Uploader(uploadStatus,settings){var pendingPromises={},pathJoin=function(path1,path2){return path1?path1.replace(/\/$/,"")+"/"+path2.replace(/^\//,""):path2},defaultHandler=function(blobInfo,success,failure,progress){var xhr,formData;xhr=new domGlobals.XMLHttpRequest,xhr.open("POST",settings.url),xhr.withCredentials=settings.credentials,xhr.upload.onprogress=function(e){progress(e.loaded/e.total*100)},xhr.onerror=function(){failure("Image upload failed due to a XHR Transport error. Code: "+xhr.status)},xhr.onload=function(){var json;return xhr.status<200||xhr.status>=300?void failure("HTTP Error: "+xhr.status):(json=JSON.parse(xhr.responseText))&&"string"==typeof json.location?void success(pathJoin(settings.basePath,json.location)):void failure("Invalid JSON: "+xhr.responseText)},formData=new domGlobals.FormData,formData.append("file",blobInfo.blob(),blobInfo.filename()),xhr.send(formData)},noUpload=function(){return new promiseObj(function(resolve){resolve([])})},handlerSuccess=function(blobInfo,url){return{url:url,blobInfo:blobInfo,status:!0}},handlerFailure=function(blobInfo,error){return{url:"",blobInfo:blobInfo,status:!1,error:error}},resolvePending=function(blobUri,result){Tools.each(pendingPromises[blobUri],function(resolve){resolve(result)}),delete pendingPromises[blobUri]},uploadBlobInfo=function(blobInfo,handler,openNotification){return uploadStatus.markPending(blobInfo.blobUri()),new promiseObj(function(resolve){var notification,progress,noop=function(){};try{var closeNotification_1=function(){notification&&(notification.close(),progress=noop)},success=function(url){closeNotification_1(),uploadStatus.markUploaded(blobInfo.blobUri(),url),resolvePending(blobInfo.blobUri(),handlerSuccess(blobInfo,url)),resolve(handlerSuccess(blobInfo,url))},failure=function(error){closeNotification_1(),uploadStatus.removeFailed(blobInfo.blobUri()),resolvePending(blobInfo.blobUri(),handlerFailure(blobInfo,error)),resolve(handlerFailure(blobInfo,error))};progress=function(percent){percent<0||percent>100||(notification||(notification=openNotification()),notification.progressBar.value(percent))},handler(blobInfo,success,failure,progress)}catch(ex){resolve(handlerFailure(blobInfo,ex.message))}})},isDefaultHandler=function(handler){return handler===defaultHandler},pendingUploadBlobInfo=function(blobInfo){var blobUri=blobInfo.blobUri();return new promiseObj(function(resolve){pendingPromises[blobUri]=pendingPromises[blobUri]||[],pendingPromises[blobUri].push(resolve)})},uploadBlobs=function(blobInfos,openNotification){return blobInfos=Tools.grep(blobInfos,function(blobInfo){return!uploadStatus.isUploaded(blobInfo.blobUri())}),promiseObj.all(Tools.map(blobInfos,function(blobInfo){return uploadStatus.isPending(blobInfo.blobUri())?pendingUploadBlobInfo(blobInfo):uploadBlobInfo(blobInfo,settings.handler,openNotification)}))},upload=function(blobInfos,openNotification){return!settings.url&&isDefaultHandler(settings.handler)?noUpload():uploadBlobs(blobInfos,openNotification)};return!1===isFunction(settings.handler)&&(settings.handler=defaultHandler),{upload:upload}}function UploadStatus(){var blobUriStatuses={},createStatus=function(status,resultUri){return{status:status,resultUri:resultUri}},hasBlobUri=function(blobUri){return blobUri in blobUriStatuses};return{hasBlobUri:hasBlobUri,getResultUri:function(blobUri){var result=blobUriStatuses[blobUri];return result?result.resultUri:null},isPending:function(blobUri){return!!hasBlobUri(blobUri)&&1===blobUriStatuses[blobUri].status},isUploaded:function(blobUri){return!!hasBlobUri(blobUri)&&2===blobUriStatuses[blobUri].status},markPending:function(blobUri){blobUriStatuses[blobUri]=createStatus(1,null)},markUploaded:function(blobUri,resultUri){blobUriStatuses[blobUri]=createStatus(2,resultUri)},removeFailed:function(blobUri){delete blobUriStatuses[blobUri]},destroy:function(){blobUriStatuses={}}}}function FormatRegistry(editor){var formats={},get=function(name){return name?formats[name]:formats},has$1=function(name){return has(formats,name)},register=function(name,format){name&&("string"!=typeof name?Tools.each(name,function(format,name){register(name,format)}):(isArray(format)||(format=[format]),Tools.each(format,function(format){void 0===format.deep&&(format.deep=!format.selector),void 0===format.split&&(format.split=!format.selector||format.inline),void 0===format.remove&&format.selector&&!format.inline&&(format.remove="none"),format.selector&&format.inline&&(format.mixed=!0,format.block_expand=!0),"string"==typeof format.classes&&(format.classes=format.classes.split(/\s+/))}),formats[name]=format))},unregister=function(name){return name&&formats[name]&&delete formats[name],formats};return register(DefaultFormats.get(editor.dom)),register(editor.settings.formats),{get:get,has:has$1,register:register,unregister:unregister}}function RangeUtils(dom){return{walk:function(rng,callback){return RangeWalk.walk(dom,rng,callback)},split:split$1,normalize:function(rng){return NormalizeRange.normalize(dom,rng).fold(constant(!1),function(normalizedRng){return rng.setStart(normalizedRng.startContainer,normalizedRng.startOffset),rng.setEnd(normalizedRng.endContainer,normalizedRng.endOffset),!0})}}}var noop=function(){},compose=function(fa,fb){return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];return fa(fb.apply(null,args))}},constant=function(value){return function(){return value}},identity=function(x){return x},not=function(f){return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];return!f.apply(null,args)}},die=function(msg){return function(){throw new Error(msg)}},never=constant(!1),always=constant(!0),none=function(){return NONE},NONE=function(){var eq=function(o){return o.isNone()},call=function(thunk){return thunk()},id=function(n){return n},me={fold:function(n,s){return n()},is:never,isSome:never,isNone:always,getOr:id,getOrThunk:call,getOrDie:function(msg){throw new Error(msg||"error: getOrDie called on none.")},getOrNull:constant(null),getOrUndefined:constant(void 0),or:id,orThunk:call,map:none,each:noop,bind:none,exists:never,forall:always,filter:none,equals:eq,equals_:eq,toArray:function(){return[]},toString:constant("none()")};return Object.freeze&&Object.freeze(me),me}(),some=function(a){var constant_a=constant(a),self=function(){return me},bind=function(f){return f(a)},me={fold:function(n,s){return s(a)},is:function(v){return a===v},isSome:always,isNone:never,getOr:constant_a,getOrThunk:constant_a,getOrDie:constant_a,getOrNull:constant_a,getOrUndefined:constant_a,or:self,orThunk:self,map:function(f){return some(f(a))},each:function(f){f(a)},bind:bind,exists:bind,forall:bind,filter:function(f){return f(a)?me:NONE},toArray:function(){return[a]},toString:function(){return"some("+a+")"},equals:function(o){return o.is(a)},equals_:function(o,elementEq){return o.fold(never,function(b){return elementEq(a,b)})}};return me},from=function(value){return null===value||void 0===value?NONE:some(value)},Option={some:some,none:none,from:from},typeOf=function(x){if(null===x)return"null";var t=typeof x;return"object"===t&&(Array.prototype.isPrototypeOf(x)||x.constructor&&"Array"===x.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(x)||x.constructor&&"String"===x.constructor.name)?"string":t},isType=function(type){return function(value){return typeOf(value)===type}},isString=isType("string"),isObject=isType("object"),isArray=isType("array"),isNull=isType("null"),isBoolean=isType("boolean"),isFunction=isType("function"),isNumber=isType("number"),nativeSlice=Array.prototype.slice,nativeIndexOf=Array.prototype.indexOf,nativePush=Array.prototype.push,rawIndexOf=function(ts,t){return nativeIndexOf.call(ts,t)},indexOf=function(xs,x){var r=rawIndexOf(xs,x);return-1===r?Option.none():Option.some(r)},contains=function(xs,x){return rawIndexOf(xs,x)>-1},exists=function(xs,pred){for(var i=0,len=xs.length;i<len;i++){if(pred(xs[i],i))return!0}return!1},map=function(xs,f){for(var len=xs.length,r=new Array(len),i=0;i<len;i++){var x=xs[i];r[i]=f(x,i)}return r},each=function(xs,f){for(var i=0,len=xs.length;i<len;i++){f(xs[i],i)}},eachr=function(xs,f){for(var i=xs.length-1;i>=0;i--){f(xs[i],i)}},partition=function(xs,pred){for(var pass=[],fail=[],i=0,len=xs.length;i<len;i++){var x=xs[i];(pred(x,i)?pass:fail).push(x)}return{pass:pass,fail:fail}},filter=function(xs,pred){for(var r=[],i=0,len=xs.length;i<len;i++){var x=xs[i];pred(x,i)&&r.push(x)}return r},foldr=function(xs,f,acc){return eachr(xs,function(x){acc=f(acc,x)}),acc},foldl=function(xs,f,acc){return each(xs,function(x){acc=f(acc,x)}),acc},find=function(xs,pred){for(var i=0,len=xs.length;i<len;i++){var x=xs[i];if(pred(x,i))return Option.some(x)}return Option.none()},findIndex=function(xs,pred){for(var i=0,len=xs.length;i<len;i++){if(pred(xs[i],i))return Option.some(i)}return Option.none()},flatten=function(xs){for(var r=[],i=0,len=xs.length;i<len;++i){if(!isArray(xs[i]))throw new Error("Arr.flatten item "+i+" was not an array, input: "+xs);nativePush.apply(r,xs[i])}return r},bind=function(xs,f){return flatten(map(xs,f))},forall=function(xs,pred){for(var i=0,len=xs.length;i<len;++i){if(!0!==pred(xs[i],i))return!1}return!0},reverse=function(xs){var r=nativeSlice.call(xs,0);return r.reverse(),r},difference=function(a1,a2){return filter(a1,function(x){return!contains(a2,x)})},mapToObject=function(xs,f){for(var r={},i=0,len=xs.length;i<len;i++){var x=xs[i];r[String(x)]=f(x,i)}return r},sort=function(xs,comparator){var copy=nativeSlice.call(xs,0);return copy.sort(comparator),copy},head=function(xs){return 0===xs.length?Option.none():Option.some(xs[0])},last=function(xs){return 0===xs.length?Option.none():Option.some(xs[xs.length-1])},from$1=isFunction(Array.from)?Array.from:function(x){return nativeSlice.call(x)},keys=Object.keys,hasOwnProperty=Object.hasOwnProperty,each$1=function(obj,f){for(var props=keys(obj),k=0,len=props.length;k<len;k++){var i=props[k];f(obj[i],i)}},map$1=function(obj,f){return tupleMap(obj,function(x,i){return{k:i,v:f(x,i)}})},tupleMap=function(obj,f){var r={};return each$1(obj,function(x,i){var tuple=f(x,i);r[tuple.k]=tuple.v}),r},objAcc=function(r){return function(x,i){r[i]=x}},internalFilter=function(obj,pred,onTrue,onFalse){var r={};return each$1(obj,function(x,i){(pred(x,i)?onTrue:onFalse)(x,i)}),r},bifilter=function(obj,pred){var t={},f={};return internalFilter(obj,pred,objAcc(t),objAcc(f)),{t:t,f:f}},get=function(obj,key){return has(obj,key)?Option.from(obj[key]):Option.none()},has=function(obj,key){return hasOwnProperty.call(obj,key)},__assign=function(){return __assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p])}return t},__assign.apply(this,arguments)},fromHtml=function(html,scope){var doc=scope||domGlobals.document,div=doc.createElement("div");if(div.innerHTML=html,!div.hasChildNodes()||div.childNodes.length>1)throw domGlobals.console.error("HTML does not have a single root node",html),new Error("HTML must have a single root node");return fromDom(div.childNodes[0])},fromTag=function(tag,scope){var doc=scope||domGlobals.document,node=doc.createElement(tag);return fromDom(node)},fromText=function(text,scope){var doc=scope||domGlobals.document,node=doc.createTextNode(text);return fromDom(node)},fromDom=function(node){if(null===node||void 0===node)throw new Error("Node cannot be null or undefined");return{dom:constant(node)}},fromPoint=function(docElm,x,y){var doc=docElm.dom();return Option.from(doc.elementFromPoint(x,y)).map(fromDom)},Element={fromHtml:fromHtml,fromTag:fromTag,fromText:fromText,fromDom:fromDom,fromPoint:fromPoint},Cell=function(initial){var value=initial,get=function(){return value};return{get:get,set:function(v){value=v},clone:function(){return Cell(get())}}},firstMatch=function(regexes,s){for(var i=0;i<regexes.length;i++){var x=regexes[i];if(x.test(s))return x}},find$1=function(regexes,agent){var r=firstMatch(regexes,agent);if(!r)return{major:0,minor:0};var group=function(i){return Number(agent.replace(r,"$"+i))};return nu(group(1),group(2))},detect=function(versionRegexes,agent){var cleanedAgent=String(agent).toLowerCase();return 0===versionRegexes.length?unknown():find$1(versionRegexes,cleanedAgent)},unknown=function(){return nu(0,0)},nu=function(major,minor){return{major:major,minor:minor}},Version={nu:nu,detect:detect,unknown:unknown},isBrowser=function(name,current){return function(){return current===name}},unknown$1=function(){return nu$1({current:void 0,version:Version.unknown()})},nu$1=function(info){var current=info.current;return{current:current,version:info.version,isEdge:isBrowser("Edge",current),isChrome:isBrowser("Chrome",current),isIE:isBrowser("IE",current),isOpera:isBrowser("Opera",current),isFirefox:isBrowser("Firefox",current),isSafari:isBrowser("Safari",current)}},Browser={unknown:unknown$1,nu:nu$1,edge:constant("Edge"),chrome:constant("Chrome"),ie:constant("IE"),opera:constant("Opera"),firefox:constant("Firefox"),safari:constant("Safari")},isOS=function(name,current){return function(){return current===name}},unknown$2=function(){return nu$2({current:void 0,version:Version.unknown()})},nu$2=function(info){var current=info.current;return{current:current,version:info.version,isWindows:isOS("Windows",current),isiOS:isOS("iOS",current),isAndroid:isOS("Android",current),isOSX:isOS("OSX",current),isLinux:isOS("Linux",current),isSolaris:isOS("Solaris",current),isFreeBSD:isOS("FreeBSD",current),isChromeOS:isOS("ChromeOS",current)}},OperatingSystem={unknown:unknown$2,nu:nu$2,windows:constant("Windows"),ios:constant("iOS"),android:constant("Android"),linux:constant("Linux"),osx:constant("OSX"),solaris:constant("Solaris"),freebsd:constant("FreeBSD"),chromeos:constant("ChromeOS")},DeviceType=function(os,browser,userAgent,mediaMatch){var isiPad=os.isiOS()&&!0===/ipad/i.test(userAgent),isiPhone=os.isiOS()&&!isiPad,isMobile=os.isiOS()||os.isAndroid(),isTouch=isMobile||mediaMatch("(pointer:coarse)"),isTablet=isiPad||!isiPhone&&isMobile&&mediaMatch("(min-device-width:768px)"),isPhone=isiPhone||isMobile&&!isTablet,iOSwebview=browser.isSafari()&&os.isiOS()&&!1===/safari/i.test(userAgent),isDesktop=!isPhone&&!isTablet&&!iOSwebview;return{isiPad:constant(isiPad),isiPhone:constant(isiPhone),isTablet:constant(isTablet),isPhone:constant(isPhone),isTouch:constant(isTouch),isAndroid:os.isAndroid,isiOS:os.isiOS,isWebView:constant(iOSwebview),isDesktop:constant(isDesktop)}},detect$1=function(candidates,userAgent){var agent=String(userAgent).toLowerCase();return find(candidates,function(candidate){return candidate.search(agent)})},detectBrowser=function(browsers,userAgent){return detect$1(browsers,userAgent).map(function(browser){var version=Version.detect(browser.versionRegexes,userAgent);return{current:browser.name,version:version}})},detectOs=function(oses,userAgent){return detect$1(oses,userAgent).map(function(os){var version=Version.detect(os.versionRegexes,userAgent);return{current:os.name,version:version}})},UaString={detectBrowser:detectBrowser,detectOs:detectOs},checkRange=function(str,substr,start){return""===substr||!(str.length<substr.length)&&str.substr(start,start+substr.length)===substr},contains$1=function(str,substr){return-1!==str.indexOf(substr)},startsWith=function(str,prefix){return checkRange(str,prefix,0)},trim=function(str){return str.replace(/^\s+|\s+$/g,"")},lTrim=function(str){return str.replace(/^\s+/g,"")},rTrim=function(str){return str.replace(/\s+$/g,"")},normalVersionRegex=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,checkContains=function(target){return function(uastring){return contains$1(uastring,target)}},browsers=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(uastring){return contains$1(uastring,"edge/")&&contains$1(uastring,"chrome")&&contains$1(uastring,"safari")&&contains$1(uastring,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,normalVersionRegex],search:function(uastring){return contains$1(uastring,"chrome")&&!contains$1(uastring,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(uastring){return contains$1(uastring,"msie")||contains$1(uastring,"trident")}},{name:"Opera",versionRegexes:[normalVersionRegex,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:checkContains("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:checkContains("firefox")},{name:"Safari",versionRegexes:[normalVersionRegex,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(uastring){return(contains$1(uastring,"safari")||contains$1(uastring,"mobile/"))&&contains$1(uastring,"applewebkit")}}],oses=[{name:"Windows",search:checkContains("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(uastring){return contains$1(uastring,"iphone")||contains$1(uastring,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:checkContains("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:checkContains("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:checkContains("linux"),versionRegexes:[]},{name:"Solaris",search:checkContains("sunos"),versionRegexes:[]},{name:"FreeBSD",search:checkContains("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:checkContains("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],PlatformInfo={browsers:constant(browsers),oses:constant(oses)},detect$2=function(userAgent,mediaMatch){var browsers=PlatformInfo.browsers(),oses=PlatformInfo.oses(),browser=UaString.detectBrowser(browsers,userAgent).fold(Browser.unknown,Browser.nu),os=UaString.detectOs(oses,userAgent).fold(OperatingSystem.unknown,OperatingSystem.nu);return{browser:browser,os:os,deviceType:DeviceType(os,browser,userAgent,mediaMatch)}},PlatformDetection={detect:detect$2},mediaMatch=function(query){return domGlobals.window.matchMedia(query).matches},platform=Cell(PlatformDetection.detect(domGlobals.navigator.userAgent,mediaMatch)),detect$3=function(){return platform.get()},Immutable=function(){for(var fields=[],_i=0;_i<arguments.length;_i++)fields[_i]=arguments[_i];return function(){for(var values=[],_i=0;_i<arguments.length;_i++)values[_i]=arguments[_i];if(fields.length!==values.length)throw new Error('Wrong number of arguments to struct. Expected "['+fields.length+']", got '+values.length+" arguments");var struct={};return each(fields,function(name,i){struct[name]=constant(values[i])}),struct}},toArray=function(target,f){var r=[],recurse=function(e){return r.push(e),f(e)},cur=f(target);do{cur=cur.bind(recurse)}while(cur.isSome());return r},Recurse={toArray:toArray},compareDocumentPosition=function(a,b,match){return 0!=(a.compareDocumentPosition(b)&match)},documentPositionPreceding=function(a,b){return compareDocumentPosition(a,b,domGlobals.Node.DOCUMENT_POSITION_PRECEDING)},documentPositionContainedBy=function(a,b){return compareDocumentPosition(a,b,domGlobals.Node.DOCUMENT_POSITION_CONTAINED_BY)},Node={documentPositionPreceding:documentPositionPreceding,documentPositionContainedBy:documentPositionContainedBy},DOCUMENT=(domGlobals.Node.ATTRIBUTE_NODE,domGlobals.Node.CDATA_SECTION_NODE,domGlobals.Node.COMMENT_NODE,domGlobals.Node.DOCUMENT_NODE),ELEMENT=(domGlobals.Node.DOCUMENT_TYPE_NODE,domGlobals.Node.DOCUMENT_FRAGMENT_NODE,domGlobals.Node.ELEMENT_NODE),TEXT=domGlobals.Node.TEXT_NODE,ELEMENT$1=(domGlobals.Node.PROCESSING_INSTRUCTION_NODE,domGlobals.Node.ENTITY_REFERENCE_NODE,domGlobals.Node.ENTITY_NODE,domGlobals.Node.NOTATION_NODE,ELEMENT),DOCUMENT$1=DOCUMENT,is=function(element,selector){var dom=element.dom();if(dom.nodeType!==ELEMENT$1)return!1;var elem=dom;if(void 0!==elem.matches)return elem.matches(selector);if(void 0!==elem.msMatchesSelector)return elem.msMatchesSelector(selector);if(void 0!==elem.webkitMatchesSelector)return elem.webkitMatchesSelector(selector);if(void 0!==elem.mozMatchesSelector)return elem.mozMatchesSelector(selector);throw new Error("Browser lacks native selectors")},bypassSelector=function(dom){return dom.nodeType!==ELEMENT$1&&dom.nodeType!==DOCUMENT$1||0===dom.childElementCount},all=function(selector,scope){var base=void 0===scope?domGlobals.document:scope.dom();return bypassSelector(base)?[]:map(base.querySelectorAll(selector),Element.fromDom)},one=function(selector,scope){var base=void 0===scope?domGlobals.document:scope.dom();return bypassSelector(base)?Option.none():Option.from(base.querySelector(selector)).map(Element.fromDom)},eq=function(e1,e2){return e1.dom()===e2.dom()},regularContains=function(e1,e2){var d1=e1.dom(),d2=e2.dom();return d1!==d2&&d1.contains(d2)},ieContains=function(e1,e2){return Node.documentPositionContainedBy(e1.dom(),e2.dom())},browser=detect$3().browser,contains$2=browser.isIE()?ieContains:regularContains,owner=function(element){return Element.fromDom(element.dom().ownerDocument)},documentElement=function(element){return Element.fromDom(element.dom().ownerDocument.documentElement)},defaultView=function(element){return Element.fromDom(element.dom().ownerDocument.defaultView)},parent=function(element){return Option.from(element.dom().parentNode).map(Element.fromDom)},parents=function(element,isRoot){for(var stop=isFunction(isRoot)?isRoot:never,dom=element.dom(),ret=[];null!==dom.parentNode&&void 0!==dom.parentNode;){var rawParent=dom.parentNode,p=Element.fromDom(rawParent);if(ret.push(p),!0===stop(p))break;dom=rawParent}return ret},prevSibling=function(element){return Option.from(element.dom().previousSibling).map(Element.fromDom)},nextSibling=function(element){return Option.from(element.dom().nextSibling).map(Element.fromDom)},prevSiblings=function(element){return reverse(Recurse.toArray(element,prevSibling))},nextSiblings=function(element){return Recurse.toArray(element,nextSibling)},children=function(element){return map(element.dom().childNodes,Element.fromDom)},child=function(element,index){var cs=element.dom().childNodes;return Option.from(cs[index]).map(Element.fromDom)},firstChild=function(element){return child(element,0)},lastChild=function(element){return child(element,element.dom().childNodes.length-1)},childNodesCount=function(element){return element.dom().childNodes.length},before=(Immutable("element","offset"),function(marker,element){parent(marker).each(function(v){v.dom().insertBefore(element.dom(),marker.dom())})}),after=function(marker,element){nextSibling(marker).fold(function(){parent(marker).each(function(v){append(v,element)})},function(v){before(v,element)})},prepend=function(parent,element){firstChild(parent).fold(function(){append(parent,element)},function(v){parent.dom().insertBefore(element.dom(),v.dom())})},append=function(parent,element){parent.dom().appendChild(element.dom())},wrap=function(element,wrapper){before(element,wrapper),append(wrapper,element)},before$1=function(marker,elements){each(elements,function(x){before(marker,x)})},append$1=function(parent,elements){each(elements,function(x){append(parent,x)})},empty=function(element){element.dom().textContent="",each(children(element),function(rogue){remove(rogue)})},remove=function(element){var dom=element.dom();null!==dom.parentNode&&dom.parentNode.removeChild(dom)},unwrap=function(wrapper){var children$1=children(wrapper);children$1.length>0&&before$1(wrapper,children$1),remove(wrapper)},name=(void 0!==domGlobals.window?domGlobals.window:Function("return this;")(),function(element){return element.dom().nodeName.toLowerCase()}),type=function(element){return element.dom().nodeType},isType$1=function(t){return function(element){return type(element)===t}},isElement=isType$1(ELEMENT),isText=isType$1(TEXT),inBody=function(element){var dom=isText(element)?element.dom().parentNode:element.dom();return void 0!==dom&&null!==dom&&dom.ownerDocument.body.contains(dom)},r=function(left,top){var translate=function(x,y){return r(left+x,top+y)};return{left:constant(left),top:constant(top),translate:translate}},Position=r,boxPosition=function(dom){var box=dom.getBoundingClientRect();return Position(box.left,box.top)},firstDefinedOrZero=function(a,b){return void 0!==a?a:void 0!==b?b:0},absolute=function(element){var doc=element.dom().ownerDocument,body=doc.body,win=doc.defaultView,html=doc.documentElement;if(body===element.dom())return Position(body.offsetLeft,body.offsetTop);var scrollTop=firstDefinedOrZero(win.pageYOffset,html.scrollTop),scrollLeft=firstDefinedOrZero(win.pageXOffset,html.scrollLeft),clientTop=firstDefinedOrZero(html.clientTop,body.clientTop),clientLeft=firstDefinedOrZero(html.clientLeft,body.clientLeft);return viewport(element).translate(scrollLeft-clientLeft,scrollTop-clientTop)},viewport=function(element){var dom=element.dom(),doc=dom.ownerDocument,body=doc.body;return body===dom?Position(body.offsetLeft,body.offsetTop):inBody(element)?boxPosition(dom):Position(0,0)},isSafari=detect$3().browser.isSafari(),get$1=function(_DOC){var doc=void 0!==_DOC?_DOC.dom():domGlobals.document,x=doc.body.scrollLeft||doc.documentElement.scrollLeft,y=doc.body.scrollTop||doc.documentElement.scrollTop;return Position(x,y)},to=function(x,y,_DOC){(void 0!==_DOC?_DOC.dom():domGlobals.document).defaultView.scrollTo(x,y)},intoView=function(element,alignToTop){isSafari&&isFunction(element.dom().scrollIntoViewIfNeeded)?element.dom().scrollIntoViewIfNeeded(!1):element.dom().scrollIntoView(alignToTop)},get$2=function(_win){var win=void 0===_win?domGlobals.window:_win;return Option.from(win.visualViewport)},bounds=function(x,y,width,height){return{x:constant(x),y:constant(y),width:constant(width),height:constant(height),right:constant(x+width),bottom:constant(y+height)}},getBounds=function(_win){var win=void 0===_win?domGlobals.window:_win,doc=win.document,scroll=get$1(Element.fromDom(doc));return get$2(win).fold(function(){var html=win.document.documentElement,width=html.clientWidth,height=html.clientHeight;return bounds(scroll.left(),scroll.top(),width,height)},function(visualViewport){return bounds(Math.max(visualViewport.pageLeft,scroll.left()),Math.max(visualViewport.pageTop,scroll.top()),visualViewport.width,visualViewport.height)})},isNodeType=function(type){return function(node){return!!node&&node.nodeType===type}},isRestrictedNode=function(node){return!!node&&!Object.getPrototypeOf(node)},isElement$1=isNodeType(1),matchNodeNames=function(names){var lowercasedNames=names.map(function(s){return s.toLowerCase()});return function(node){if(node&&node.nodeName){var nodeName=node.nodeName.toLowerCase();return contains(lowercasedNames,nodeName)}return!1}},matchStyleValues=function(name,values){var items=values.toLowerCase().split(" ");return function(node){var i;if(isElement$1(node))for(i=0;i<items.length;i++){var computed=node.ownerDocument.defaultView.getComputedStyle(node,null);if((computed?computed.getPropertyValue(name):null)===items[i])return!0}return!1}},hasPropValue=function(propName,propValue){return function(node){return isElement$1(node)&&node[propName]===propValue}},hasAttribute=function(attrName,attrValue){return function(node){return isElement$1(node)&&node.hasAttribute(attrName)}},hasAttributeValue=function(attrName,attrValue){return function(node){return isElement$1(node)&&node.getAttribute(attrName)===attrValue}},isBogus=function(node){return isElement$1(node)&&node.hasAttribute("data-mce-bogus")},isBogusAll=function(node){return isElement$1(node)&&"all"===node.getAttribute("data-mce-bogus")},isTable=function(node){return isElement$1(node)&&"TABLE"===node.tagName},hasContentEditableState=function(value){return function(node){if(isElement$1(node)){if(node.contentEditable===value)return!0;if(node.getAttribute("data-mce-contenteditable")===value)return!0}return!1}},isTextareaOrInput=matchNodeNames(["textarea","input"]),isText$1=isNodeType(3),isComment=isNodeType(8),isDocument=isNodeType(9),isDocumentFragment=isNodeType(11),isBr=matchNodeNames(["br"]),isContentEditableTrue=hasContentEditableState("true"),isContentEditableFalse=hasContentEditableState("false"),NodeType={isText:isText$1,isElement:isElement$1,isComment:isComment,isDocument:isDocument,isDocumentFragment:isDocumentFragment,isBr:isBr,isContentEditableTrue:isContentEditableTrue,isContentEditableFalse:isContentEditableFalse,isRestrictedNode:isRestrictedNode,matchNodeNames:matchNodeNames,hasPropValue:hasPropValue,hasAttribute:hasAttribute,hasAttributeValue:hasAttributeValue,matchStyleValues:matchStyleValues,isBogus:isBogus,isBogusAll:isBogusAll,isTable:isTable,isTextareaOrInput:isTextareaOrInput},isSupported=function(dom){return void 0!==dom.style&&isFunction(dom.style.getPropertyValue)},rawSet=function(dom,key,value){if(!(isString(value)||isBoolean(value)||isNumber(value)))throw domGlobals.console.error("Invalid call to Attr.set. Key ",key,":: Value ",value,":: Element ",dom),new Error("Attribute value was not simple");dom.setAttribute(key,value+"")},set=function(element,key,value){rawSet(element.dom(),key,value)},setAll=function(element,attrs){var dom=element.dom();each$1(attrs,function(v,k){rawSet(dom,k,v)})},get$3=function(element,key){var v=element.dom().getAttribute(key);return null===v?void 0:v},getOpt=function(element,key){return Option.from(get$3(element,key))},has$1=function(element,key){var dom=element.dom();return!(!dom||!dom.hasAttribute)&&dom.hasAttribute(key)},remove$1=function(element,key){element.dom().removeAttribute(key)},get$4=function(element,property){var dom=element.dom(),styles=domGlobals.window.getComputedStyle(dom),r=styles.getPropertyValue(property),v=""!==r||inBody(element)?r:getUnsafeProperty(dom,property);return null===v?void 0:v},getUnsafeProperty=function(dom,property){return isSupported(dom)?dom.style.getPropertyValue(property):""},getRaw=function(element,property){var dom=element.dom(),raw=getUnsafeProperty(dom,property);return Option.from(raw).filter(function(r){return r.length>0})},reflow=function(e){return e.dom().offsetWidth},browser$1=detect$3().browser,firstElement=function(nodes){return find(nodes,isElement)},getTableCaptionDeltaY=function(elm){return browser$1.isFirefox()&&"table"===name(elm)?firstElement(children(elm)).filter(function(elm){return"caption"===name(elm)}).bind(function(caption){return firstElement(nextSiblings(caption)).map(function(body){var bodyTop=body.dom().offsetTop,captionTop=caption.dom().offsetTop,captionHeight=caption.dom().offsetHeight;return bodyTop<=captionTop?-captionHeight:0})}).getOr(0):0},hasChild=function(elm,child){return elm.children&&contains(elm.children,child)},getPos=function(body,elm,rootElm){var offsetParent,pos,x=0,y=0,doc=body.ownerDocument;if(rootElm=rootElm||body,elm){if(rootElm===body&&elm.getBoundingClientRect&&"static"===get$4(Element.fromDom(body),"position"))return pos=elm.getBoundingClientRect(),x=pos.left+(doc.documentElement.scrollLeft||body.scrollLeft)-doc.documentElement.clientLeft,y=pos.top+(doc.documentElement.scrollTop||body.scrollTop)-doc.documentElement.clientTop,{x:x,y:y};for(offsetParent=elm;offsetParent&&offsetParent!==rootElm&&offsetParent.nodeType&&!hasChild(offsetParent,rootElm);)x+=offsetParent.offsetLeft||0,y+=offsetParent.offsetTop||0,offsetParent=offsetParent.offsetParent;for(offsetParent=elm.parentNode;offsetParent&&offsetParent!==rootElm&&offsetParent.nodeType&&!hasChild(offsetParent,rootElm);)x-=offsetParent.scrollLeft||0,y-=offsetParent.scrollTop||0,offsetParent=offsetParent.parentNode;y+=getTableCaptionDeltaY(Element.fromDom(elm))}return{x:x,y:y}},Position$1={getPos:getPos},exports$1={},module$1={exports:exports$1};!function(define,exports,module,require){!function(f){if("object"==typeof exports&&void 0!==module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{var g;g="undefined"!=typeof window?window:void 0!==global?global:"undefined"!=typeof self?self:this,g.EphoxContactWrapper=f()}}(function(){return function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){return o(e[i][1][r]||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r}()({1:[function(require,module,exports){function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(fun,0);try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(marker);try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var timeout=runTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,runClearTimeout(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}var cachedSetTimeout,cachedClearTimeout,process=module.exports={};!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var currentQueue,queue=[],draining=!1,queueIndex=-1;process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.prependListener=noop,process.prependOnceListener=noop,process.listeners=function(name){return[]},process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},{}],2:[function(require,module,exports){(function(setImmediate){!function(root){function noop(){}function bind(fn,thisArg){return function(){fn.apply(thisArg,arguments)}}function Promise(fn){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof fn)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],doResolve(fn,this)}function handle(self,deferred){for(;3===self._state;)self=self._value;if(0===self._state)return void self._deferreds.push(deferred);self._handled=!0,Promise._immediateFn(function(){var cb=1===self._state?deferred.onFulfilled:deferred.onRejected;if(null===cb)return void(1===self._state?resolve:reject)(deferred.promise,self._value);var ret;try{ret=cb(self._value)}catch(e){return void reject(deferred.promise,e)}resolve(deferred.promise,ret)})}function resolve(self,newValue){try{if(newValue===self)throw new TypeError("A promise cannot be resolved with itself.");if(newValue&&("object"==typeof newValue||"function"==typeof newValue)){var then=newValue.then;if(newValue instanceof Promise)return self._state=3,self._value=newValue,void finale(self);if("function"==typeof then)return void doResolve(bind(then,newValue),self)}self._state=1,self._value=newValue,finale(self)}catch(e){reject(self,e)}}function reject(self,newValue){self._state=2,self._value=newValue,finale(self)}function finale(self){2===self._state&&0===self._deferreds.length&&Promise._immediateFn(function(){self._handled||Promise._unhandledRejectionFn(self._value)});for(var i=0,len=self._deferreds.length;i<len;i++)handle(self,self._deferreds[i]);self._deferreds=null}function Handler(onFulfilled,onRejected,promise){this.onFulfilled="function"==typeof onFulfilled?onFulfilled:null,this.onRejected="function"==typeof onRejected?onRejected:null,this.promise=promise}function doResolve(fn,self){var done=!1;try{fn(function(value){done||(done=!0,resolve(self,value))},function(reason){done||(done=!0,reject(self,reason))})}catch(ex){if(done)return;done=!0,reject(self,ex)}}var setTimeoutFunc=setTimeout;Promise.prototype.catch=function(onRejected){return this.then(null,onRejected)},Promise.prototype.then=function(onFulfilled,onRejected){var prom=new this.constructor(noop);return handle(this,new Handler(onFulfilled,onRejected,prom)),prom},Promise.all=function(arr){var args=Array.prototype.slice.call(arr);return new Promise(function(resolve,reject){function res(i,val){try{if(val&&("object"==typeof val||"function"==typeof val)){var then=val.then;if("function"==typeof then)return void then.call(val,function(val){res(i,val)},reject)}args[i]=val,0==--remaining&&resolve(args)}catch(ex){reject(ex)}}if(0===args.length)return resolve([]);for(var remaining=args.length,i=0;i<args.length;i++)res(i,args[i])})},Promise.resolve=function(value){return value&&"object"==typeof value&&value.constructor===Promise?value:new Promise(function(resolve){resolve(value)})},Promise.reject=function(value){return new Promise(function(resolve,reject){reject(value)})},Promise.race=function(values){return new Promise(function(resolve,reject){for(var i=0,len=values.length;i<len;i++)values[i].then(resolve,reject)})},Promise._immediateFn="function"==typeof setImmediate?function(fn){setImmediate(fn)}:function(fn){setTimeoutFunc(fn,0)},Promise._unhandledRejectionFn=function(err){"undefined"!=typeof console&&console},Promise._setImmediateFn=function(fn){Promise._immediateFn=fn},Promise._setUnhandledRejectionFn=function(fn){Promise._unhandledRejectionFn=fn},void 0!==module&&module.exports?module.exports=Promise:root.Promise||(root.Promise=Promise)}(this)}).call(this,require("timers").setImmediate)},{timers:3}],3:[function(require,module,exports){(function(setImmediate,clearImmediate){function Timeout(id,clearFn){this._id=id,this._clearFn=clearFn}var nextTick=require("process/browser.js").nextTick,apply=Function.prototype.apply,slice=Array.prototype.slice,immediateIds={},nextImmediateId=0;exports.setTimeout=function(){return new Timeout(apply.call(setTimeout,window,arguments),clearTimeout)},exports.setInterval=function(){return new Timeout(apply.call(setInterval,window,arguments),clearInterval)},exports.clearTimeout=exports.clearInterval=function(timeout){timeout.close()},Timeout.prototype.unref=Timeout.prototype.ref=function(){},Timeout.prototype.close=function(){this._clearFn.call(window,this._id)},exports.enroll=function(item,msecs){clearTimeout(item._idleTimeoutId),item._idleTimeout=msecs},exports.unenroll=function(item){clearTimeout(item._idleTimeoutId),item._idleTimeout=-1},exports._unrefActive=exports.active=function(item){clearTimeout(item._idleTimeoutId);var msecs=item._idleTimeout;msecs>=0&&(item._idleTimeoutId=setTimeout(function(){item._onTimeout&&item._onTimeout()},msecs))},exports.setImmediate="function"==typeof setImmediate?setImmediate:function(fn){var id=nextImmediateId++,args=!(arguments.length<2)&&slice.call(arguments,1);return immediateIds[id]=!0,nextTick(function(){immediateIds[id]&&(args?fn.apply(null,args):fn.call(null),exports.clearImmediate(id))}),id},exports.clearImmediate="function"==typeof clearImmediate?clearImmediate:function(id){delete immediateIds[id]}}).call(this,require("timers").setImmediate,require("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(require,module,exports){var promisePolyfill=require("promise-polyfill"),Global=function(){return"undefined"!=typeof window?window:Function("return this;")()}();module.exports={boltExport:Global.Promise||promisePolyfill}},{"promise-polyfill":2}]},{},[4])(4)})}(void 0,exports$1,module$1,void 0);var requestAnimationFramePromise,namedEntities,baseEntities,reverseEntities,Promise=module$1.exports.boltExport,nu$3=function(baseFn){var data=Option.none(),callbacks=[],map=function(f){return nu$3(function(nCallback){get(function(data){nCallback(f(data))})})},get=function(nCallback){isReady()?call(nCallback):callbacks.push(nCallback)},set=function(x){data=Option.some(x),run(callbacks),callbacks=[]},isReady=function(){return data.isSome()},run=function(cbs){each(cbs,call)},call=function(cb){data.each(function(x){domGlobals.setTimeout(function(){cb(x)},0)})};return baseFn(set),{get:get,map:map,isReady:isReady}},pure=function(a){return nu$3(function(callback){callback(a)})},LazyValue={nu:nu$3,pure:pure},errorReporter=function(err){domGlobals.setTimeout(function(){throw err},0)},make=function(run){var get=function(callback){run().then(callback,errorReporter)};return{map:function(fab){return make(function(){return run().then(fab)})},bind:function(aFutureB){return make(function(){return run().then(function(v){return aFutureB(v).toPromise()})})},anonBind:function(futureB){return make(function(){return run().then(function(){return futureB.toPromise()})})},toLazy:function(){return LazyValue.nu(get)},toCached:function(){var cache=null;return make(function(){return null===cache&&(cache=run()),cache})},toPromise:run,get:get}},nu$4=function(baseFn){return make(function(){return new Promise(baseFn)})},pure$1=function(a){return make(function(){return Promise.resolve(a)})},Future={nu:nu$4,pure:pure$1},par=function(asyncValues,nu){return nu(function(callback){var r=[],count=0,cb=function(i){return function(value){r[i]=value,++count>=asyncValues.length&&callback(r)}};0===asyncValues.length?callback([]):each(asyncValues,function(asyncValue,i){asyncValue.get(cb(i))})})},par$1=function(futures){return par(futures,Future.nu)},value=function(o){var is=function(v){return o===v},or=function(opt){return value(o)},orThunk=function(f){return value(o)},map=function(f){return value(f(o))},mapError=function(f){return value(o)},each=function(f){f(o)},bind=function(f){return f(o)},fold=function(_,onValue){return onValue(o)},exists=function(f){return f(o)},forall=function(f){return f(o)},toOption=function(){return Option.some(o)};return{is:is,isValue:always,isError:never,getOr:constant(o),getOrThunk:constant(o),getOrDie:constant(o),or:or,orThunk:orThunk,fold:fold,map:map,mapError:mapError,each:each,bind:bind,exists:exists,forall:forall,toOption:toOption}},error=function(message){var getOrThunk=function(f){return f()},getOrDie=function(){return die(String(message))()},or=function(opt){return opt},orThunk=function(f){return f()},map=function(f){return error(message)},mapError=function(f){return error(f(message))},bind=function(f){return error(message)};return{is:never,isValue:never,isError:always,getOr:identity,getOrThunk:getOrThunk,getOrDie:getOrDie,or:or,orThunk:orThunk,fold:function(onError,_){return onError(message)},map:map,mapError:mapError,each:noop,bind:bind,exists:never,forall:always,toOption:Option.none}},fromOption=function(opt,err){return opt.fold(function(){return error(err)},value)},Result={value:value,error:error,fromOption:fromOption},promiseObj=window.Promise?window.Promise:function(){function bind(fn,thisArg){return function(){fn.apply(thisArg,arguments)}}function handle(deferred){var me=this;if(null===this._state)return void this._deferreds.push(deferred);asap(function(){var cb=me._state?deferred.onFulfilled:deferred.onRejected;if(null===cb)return void(me._state?deferred.resolve:deferred.reject)(me._value);var ret;try{ret=cb(me._value)}catch(e){return void deferred.reject(e)}deferred.resolve(ret)})}function resolve(newValue){try{if(newValue===this)throw new TypeError("A promise cannot be resolved with itself.");if(newValue&&("object"==typeof newValue||"function"==typeof newValue)){var then=newValue.then;if("function"==typeof then)return void doResolve(bind(then,newValue),bind(resolve,this),bind(reject,this))}this._state=!0,this._value=newValue,finale.call(this)}catch(e){reject.call(this,e)}}function reject(newValue){this._state=!1,this._value=newValue,finale.call(this)}function finale(){for(var i=0,len=this._deferreds.length;i<len;i++)handle.call(this,this._deferreds[i]);this._deferreds=null}function Handler(onFulfilled,onRejected,resolve,reject){this.onFulfilled="function"==typeof onFulfilled?onFulfilled:null,this.onRejected="function"==typeof onRejected?onRejected:null,this.resolve=resolve,this.reject=reject}function doResolve(fn,onFulfilled,onRejected){var done=!1;try{fn(function(value){done||(done=!0,onFulfilled(value))},function(reason){done||(done=!0,onRejected(reason))})}catch(ex){if(done)return;done=!0,onRejected(ex)}}var isArray=Array.isArray||function(value){return"[object Array]"===Object.prototype.toString.call(value)},Promise=function(fn){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof fn)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],doResolve(fn,bind(resolve,this),bind(reject,this))},asap=Promise.immediateFn||"function"==typeof domGlobals.setImmediate&&domGlobals.setImmediate||function(fn){domGlobals.setTimeout(fn,1)};return Promise.prototype.catch=function(onRejected){return this.then(null,onRejected)},Promise.prototype.then=function(onFulfilled,onRejected){var me=this;return new Promise(function(resolve,reject){handle.call(me,new Handler(onFulfilled,onRejected,resolve,reject))})},Promise.all=function(){var args=Array.prototype.slice.call(1===arguments.length&&isArray(arguments[0])?arguments[0]:arguments);return new Promise(function(resolve,reject){function res(i,val){try{if(val&&("object"==typeof val||"function"==typeof val)){var then=val.then;if("function"==typeof then)return void then.call(val,function(val){res(i,val)},reject)}args[i]=val,0==--remaining&&resolve(args)}catch(ex){reject(ex)}}if(0===args.length)return resolve([]);for(var remaining=args.length,i=0;i<args.length;i++)res(i,args[i])})},Promise.resolve=function(value){return value&&"object"==typeof value&&value.constructor===Promise?value:new Promise(function(resolve){resolve(value)})},Promise.reject=function(value){return new Promise(function(resolve,reject){reject(value)})},Promise.race=function(values){return new Promise(function(resolve,reject){for(var i=0,len=values.length;i<len;i++)values[i].then(resolve,reject)})},Promise}(),requestAnimationFrame=function(callback,element){var i,requestAnimationFrameFunc=domGlobals.window.requestAnimationFrame,vendors=["ms","moz","webkit"],featurefill=function(callback){domGlobals.window.setTimeout(callback,0)};for(i=0;i<vendors.length&&!requestAnimationFrameFunc;i++)requestAnimationFrameFunc=domGlobals.window[vendors[i]+"RequestAnimationFrame"];requestAnimationFrameFunc||(requestAnimationFrameFunc=featurefill),requestAnimationFrameFunc(callback,element)},wrappedSetTimeout=function(callback,time){return"number"!=typeof time&&(time=0),domGlobals.setTimeout(callback,time)},wrappedSetInterval=function(callback,time){return"number"!=typeof time&&(time=1),domGlobals.setInterval(callback,time)},wrappedClearTimeout=function(id){return domGlobals.clearTimeout(id)},wrappedClearInterval=function(id){return domGlobals.clearInterval(id)},debounce=function(callback,time){var timer,func;return func=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];domGlobals.clearTimeout(timer),timer=wrappedSetTimeout(function(){callback.apply(this,args)},time)},func.stop=function(){domGlobals.clearTimeout(timer)},func},Delay={requestAnimationFrame:function(callback,element){if(requestAnimationFramePromise)return void requestAnimationFramePromise.then(callback);requestAnimationFramePromise=new promiseObj(function(resolve){element||(element=domGlobals.document.body),requestAnimationFrame(resolve,element)}).then(callback)},setTimeout:wrappedSetTimeout,setInterval:wrappedSetInterval,setEditorTimeout:function(editor,callback,time){return wrappedSetTimeout(function(){editor.removed||callback()},time)},setEditorInterval:function(editor,callback,time){var timer;return timer=wrappedSetInterval(function(){editor.removed?domGlobals.clearInterval(timer):callback()},time)},debounce:debounce,throttle:debounce,clearInterval:wrappedClearInterval,clearTimeout:wrappedClearTimeout},userAgent=domGlobals.navigator.userAgent,platform$1=detect$3(),browser$2=platform$1.browser,os=platform$1.os,deviceType=platform$1.deviceType,webkit=/WebKit/.test(userAgent)&&!browser$2.isEdge(),fileApi="FormData"in domGlobals.window&&"FileReader"in domGlobals.window&&"URL"in domGlobals.window&&!!domGlobals.URL.createObjectURL,windowsPhone=-1!==userAgent.indexOf("Windows Phone"),Env={opera:browser$2.isOpera(),webkit:webkit,ie:!(!browser$2.isIE()&&!browser$2.isEdge())&&browser$2.version.major,gecko:browser$2.isFirefox(),mac:os.isOSX()||os.isiOS(),iOS:deviceType.isiPad()||deviceType.isiPhone(),android:os.isAndroid(),contentEditable:!0,transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",caretAfter:!0,range:domGlobals.window.getSelection&&"Range"in domGlobals.window,documentMode:browser$2.isIE()?domGlobals.document.documentMode||7:10,fileApi:fileApi,ceFalse:!0,cacheSuffix:null,container:null,experimentalShadowDom:!1,canHaveCSP:!browser$2.isIE(),desktop:deviceType.isDesktop(),windowsPhone:windowsPhone,browser:{current:browser$2.current,version:browser$2.version,isChrome:browser$2.isChrome,isEdge:browser$2.isEdge,isFirefox:browser$2.isFirefox,isIE:browser$2.isIE,isOpera:browser$2.isOpera,isSafari:browser$2.isSafari},os:{current:os.current,version:os.version,isAndroid:os.isAndroid,isChromeOS:os.isChromeOS,isFreeBSD:os.isFreeBSD,isiOS:os.isiOS,isLinux:os.isLinux,isOSX:os.isOSX,isSolaris:os.isSolaris,isWindows:os.isWindows},deviceType:{isDesktop:deviceType.isDesktop,isiPad:deviceType.isiPad,isiPhone:deviceType.isiPhone,isPhone:deviceType.isPhone,isTablet:deviceType.isTablet,isTouch:deviceType.isTouch,isWebView:deviceType.isWebView}},isArray$1=Array.isArray,toArray$1=function(obj){var i,l,array=obj;if(!isArray$1(obj))for(array=[],i=0,l=obj.length;i<l;i++)array[i]=obj[i];return array},each$2=function(o,cb,s){var n,l;if(!o)return 0;if(s=s||o,void 0!==o.length){for(n=0,l=o.length;n<l;n++)if(!1===cb.call(s,o[n],n,o))return 0}else for(n in o)if(o.hasOwnProperty(n)&&!1===cb.call(s,o[n],n,o))return 0;return 1},map$2=function(array,callback){var out=[];return each$2(array,function(item,index){out.push(callback(item,index,array))}),out},filter$1=function(a,f){var o=[];return each$2(a,function(v,index){f&&!f(v,index,a)||o.push(v)}),o},indexOf$1=function(a,v){var i,l;if(a)for(i=0,l=a.length;i<l;i++)if(a[i]===v)return i;return-1},reduce=function(collection,iteratee,accumulator,thisArg){var i=0;for(arguments.length<3&&(accumulator=collection[0]);i<collection.length;i++)accumulator=iteratee.call(thisArg,accumulator,collection[i],i);return accumulator},findIndex$1=function(array,predicate,thisArg){var i,l;for(i=0,l=array.length;i<l;i++)if(predicate.call(thisArg,array[i],i,array))return i;return-1},find$2=function(array,predicate,thisArg){var idx=findIndex$1(array,predicate,thisArg);if(-1!==idx)return array[idx]},last$1=function(collection){return collection[collection.length-1]},ArrUtils={isArray:isArray$1,toArray:toArray$1,each:each$2,map:map$2,filter:filter$1,indexOf:indexOf$1,reduce:reduce,findIndex:findIndex$1,find:find$2,last:last$1},whiteSpaceRegExp=/^\s*|\s*$/g,trim$1=function(str){return null===str||void 0===str?"":(""+str).replace(whiteSpaceRegExp,"")},is$1=function(obj,type){return type?!("array"!==type||!ArrUtils.isArray(obj))||typeof obj===type:void 0!==obj},makeMap=function(items,delim,map){var i;for(items=items||[],delim=delim||",","string"==typeof items&&(items=items.split(delim)),map=map||{},i=items.length;i--;)map[items[i]]={};return map},hasOwnProperty$1=function(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)},create=function(s,p,root){var sp,ns,cn,scn,c,self=this,de=0;if(s=/^((static) )?([\w.]+)(:([\w.]+))?/.exec(s),cn=s[3].match(/(^|\.)(\w+)$/i)[2],ns=self.createNS(s[3].replace(/\.\w+$/,""),root),!ns[cn]){if("static"===s[2])return ns[cn]=p,void(this.onCreate&&this.onCreate(s[2],s[3],ns[cn]));p[cn]||(p[cn]=function(){},de=1),ns[cn]=p[cn],self.extend(ns[cn].prototype,p),s[5]&&(sp=self.resolve(s[5]).prototype,scn=s[5].match(/\.(\w+)$/i)[1],c=ns[cn],ns[cn]=de?function(){return sp[scn].apply(this,arguments)}:function(){return this.parent=sp[scn],c.apply(this,arguments)},ns[cn].prototype[cn]=ns[cn],self.each(sp,function(f,n){ns[cn].prototype[n]=sp[n]}),self.each(p,function(f,n){sp[n]?ns[cn].prototype[n]=function(){return this.parent=sp[n],f.apply(this,arguments)}:n!==cn&&(ns[cn].prototype[n]=f)})),self.each(p.static,function(f,n){ns[cn][n]=f})}},extend=function(obj,ext){for(var x=[],_i=2;_i<arguments.length;_i++)x[_i-2]=arguments[_i];var i,l,name,value,args=arguments;for(i=1,l=args.length;i<l;i++){ext=args[i];for(name in ext)ext.hasOwnProperty(name)&&void 0!==(value=ext[name])&&(obj[name]=value)}return obj},walk=function(o,f,n,s){s=s||this,o&&(n&&(o=o[n]),ArrUtils.each(o,function(o,i){if(!1===f.call(s,o,i,n))return!1;walk(o,f,n,s)}))},createNS=function(n,o){var i,v;for(o=o||domGlobals.window,n=n.split("."),i=0;i<n.length;i++)v=n[i],o[v]||(o[v]={}),o=o[v];return o},resolve=function(n,o){var i,l;for(o=o||domGlobals.window,n=n.split("."),i=0,l=n.length;i<l&&(o=o[n[i]]);i++);return o},explode=function(s,d){return!s||is$1(s,"array")?s:ArrUtils.map(s.split(d||","),trim$1)},_addCacheSuffix=function(url){var cacheSuffix=Env.cacheSuffix;return cacheSuffix&&(url+=(-1===url.indexOf("?")?"?":"&")+cacheSuffix),url},Tools={trim:trim$1,isArray:ArrUtils.isArray,is:is$1,toArray:ArrUtils.toArray,makeMap:makeMap,each:ArrUtils.each,map:ArrUtils.map,grep:ArrUtils.filter,inArray:ArrUtils.indexOf,hasOwn:hasOwnProperty$1,extend:extend,create:create,walk:walk,createNS:createNS,resolve:resolve,explode:explode,_addCacheSuffix:_addCacheSuffix},blocks=["article","aside","details","div","dt","figcaption","footer","form","fieldset","header","hgroup","html","main","nav","section","summary","body","p","dl","multicol","dd","figure","address","center","blockquote","h1","h2","h3","h4","h5","h6","listing","xmp","pre","plaintext","menu","dir","ul","ol","li","hr","table","tbody","thead","tfoot","th","tr","td","caption"],voids=["area","base","basefont","br","col","frame","hr","img","input","isindex","link","meta","param","embed","source","wbr","track"],tableCells=["td","th"],tableSections=["thead","tbody","tfoot"],textBlocks=["h1","h2","h3","h4","h5","h6","p","div","address","pre","form","blockquote","center","dir","fieldset","header","footer","article","section","hgroup","aside","nav","figure"],headings=["h1","h2","h3","h4","h5","h6"],listItems=["li","dd","dt"],lists=["ul","ol","dl"],wsElements=["pre","script","textarea","style"],lazyLookup=function(items){var lookup;return function(node){return lookup=lookup||mapToObject(items,constant(!0)),lookup.hasOwnProperty(name(node))}},isHeading=lazyLookup(headings),isBlock=lazyLookup(blocks),isTable$1=function(node){return"table"===name(node)},isInline=function(node){return isElement(node)&&!isBlock(node)},isBr$1=function(node){return isElement(node)&&"br"===name(node)},isTextBlock=lazyLookup(textBlocks),isList=lazyLookup(lists),isListItem=lazyLookup(listItems),isVoid=lazyLookup(voids),isTableSection=lazyLookup(tableSections),isTableCell=lazyLookup(tableCells),isWsPreserveElement=lazyLookup(wsElements),surroundedBySpans=function(node){var previousIsSpan=node.previousSibling&&"SPAN"===node.previousSibling.nodeName,nextIsSpan=node.nextSibling&&"SPAN"===node.nextSibling.nodeName;return previousIsSpan&&nextIsSpan},isBookmarkNode=function(node){return node&&"SPAN"===node.tagName&&"bookmark"===node.getAttribute("data-mce-type")},trimNode=function(dom,node){var i,children=node.childNodes;if(!NodeType.isElement(node)||!isBookmarkNode(node)){for(i=children.length-1;i>=0;i--)trimNode(dom,children[i]);if(!1===NodeType.isDocument(node)){if(NodeType.isText(node)&&node.nodeValue.length>0){var trimmedLength=Tools.trim(node.nodeValue).length;if(dom.isBlock(node.parentNode)||trimmedLength>0)return;if(0===trimmedLength&&surroundedBySpans(node))return}else if(NodeType.isElement(node)&&(children=node.childNodes,1===children.length&&isBookmarkNode(children[0])&&node.parentNode.insertBefore(children[0],node),children.length||isVoid(Element.fromDom(node))))return;dom.remove(node)}return node}},TrimNode={trimNode:trimNode},makeMap$1=Tools.makeMap,attrsCharsRegExp=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,textCharsRegExp=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,rawCharsRegExp=/[<>&\"\']/g,entityRegExp=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi,asciiMap={128:"€",130:"‚",131:"ƒ",132:"„",133:"…",134:"†",135:"‡",136:"ˆ",137:"‰",138:"Š",139:"‹",140:"Œ",142:"Ž",145:"‘",146:"’",147:"“",148:"”",149:"•",150:"–",151:"—",152:"˜",153:"™",154:"š",155:"›",156:"œ",158:"ž",159:"Ÿ"};baseEntities={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;","`":"&#96;"},reverseEntities={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"};var nativeDecode=function(text){var elm;return elm=Element.fromTag("div").dom(),elm.innerHTML=text,elm.textContent||elm.innerText||text},buildEntitiesLookup=function(items,radix){var i,chr,entity,lookup={};if(items){for(items=items.split(","),radix=radix||10,i=0;i<items.length;i+=2)chr=String.fromCharCode(parseInt(items[i],radix)),baseEntities[chr]||(entity="&"+items[i+1]+";",lookup[chr]=entity,lookup[entity]=chr);return lookup}};namedEntities=buildEntitiesLookup("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32);var i,support,Expr,getText,isXML,tokenize,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains$3,encodeRaw=function(text,attr){return text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){return baseEntities[chr]||chr})},encodeAllRaw=function(text){return(""+text).replace(rawCharsRegExp,function(chr){return baseEntities[chr]||chr})},encodeNumeric=function(text,attr){return text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){return chr.length>1?"&#"+(1024*(chr.charCodeAt(0)-55296)+(chr.charCodeAt(1)-56320)+65536)+";":baseEntities[chr]||"&#"+chr.charCodeAt(0)+";"})},encodeNamed=function(text,attr,entities){return entities=entities||namedEntities,text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){return baseEntities[chr]||entities[chr]||chr})},getEncodeFunc=function(name,entities){var entitiesMap=buildEntitiesLookup(entities)||namedEntities,encodeNamedAndNumeric=function(text,attr){return text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){return void 0!==baseEntities[chr]?baseEntities[chr]:void 0!==entitiesMap[chr]?entitiesMap[chr]:chr.length>1?"&#"+(1024*(chr.charCodeAt(0)-55296)+(chr.charCodeAt(1)-56320)+65536)+";":"&#"+chr.charCodeAt(0)+";"})},encodeCustomNamed=function(text,attr){return encodeNamed(text,attr,entitiesMap)},nameMap=makeMap$1(name.replace(/\+/g,","));return nameMap.named&&nameMap.numeric?encodeNamedAndNumeric:nameMap.named?entities?encodeCustomNamed:encodeNamed:nameMap.numeric?encodeNumeric:encodeRaw},decode=function(text){return text.replace(entityRegExp,function(all,numeric){return numeric?(numeric="x"===numeric.charAt(0).toLowerCase()?parseInt(numeric.substr(1),16):parseInt(numeric,10),numeric>65535?(numeric-=65536,String.fromCharCode(55296+(numeric>>10),56320+(1023&numeric))):asciiMap[numeric]||String.fromCharCode(numeric)):reverseEntities[all]||namedEntities[all]||nativeDecode(all)})},Entities={encodeRaw:encodeRaw,encodeAllRaw:encodeAllRaw,encodeNumeric:encodeNumeric,encodeNamed:encodeNamed,getEncodeFunc:getEncodeFunc,decode:decode},mapCache={},dummyObj={},makeMap$2=Tools.makeMap,each$3=Tools.each,extend$1=Tools.extend,explode$1=Tools.explode,inArray=Tools.inArray,split=function(items,delim){return items=Tools.trim(items),items?items.split(delim||" "):[]},compileSchema=function(type){var globalAttributes,blockContent,phrasingContent,flowContent,html4BlockContent,html4PhrasingContent,schema={},add=function(name,attributes,children){var ni,attributesOrder,element,arrayToMap=function(array,obj){var i,l,map={};for(i=0,l=array.length;i<l;i++)map[array[i]]=obj||{};return map};for(children=children||[],attributes=attributes||"","string"==typeof children&&(children=split(children)),name=split(name),ni=name.length;ni--;)attributesOrder=split([globalAttributes,attributes].join(" ")),element={attributes:arrayToMap(attributesOrder),attributesOrder:attributesOrder,children:arrayToMap(children,dummyObj)},schema[name[ni]]=element},addAttrs=function(name,attributes){var ni,schemaItem,i,l;for(name=split(name),ni=name.length,attributes=split(attributes);ni--;)for(schemaItem=schema[name[ni]],i=0,l=attributes.length;i<l;i++)schemaItem.attributes[attributes[i]]={},schemaItem.attributesOrder.push(attributes[i])};return mapCache[type]?mapCache[type]:(globalAttributes="id accesskey class dir lang style tabindex title role",blockContent="address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul",phrasingContent="a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment","html4"!==type&&(globalAttributes+=" contenteditable contextmenu draggable dropzone hidden spellcheck translate",blockContent+=" article aside details dialog figure main header footer hgroup section nav",phrasingContent+=" audio canvas command datalist mark meter output picture progress time wbr video ruby bdi keygen"),"html5-strict"!==type&&(globalAttributes+=" xml:lang",html4PhrasingContent="acronym applet basefont big font strike tt",phrasingContent=[phrasingContent,html4PhrasingContent].join(" "),each$3(split(html4PhrasingContent),function(name){add(name,"",phrasingContent)}),html4BlockContent="center dir isindex noframes",blockContent=[blockContent,html4BlockContent].join(" "),flowContent=[blockContent,phrasingContent].join(" "),each$3(split(html4BlockContent),function(name){add(name,"",flowContent)})),flowContent=flowContent||[blockContent,phrasingContent].join(" "),add("html","manifest","head body"),add("head","","base command link meta noscript script style title"),add("title hr noscript br"),add("base","href target"),add("link","href rel media hreflang type sizes hreflang"),add("meta","name http-equiv content charset"),add("style","media type scoped"),add("script","src async defer type charset"),add("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",flowContent),add("address dt dd div caption","",flowContent),add("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",phrasingContent),add("blockquote","cite",flowContent),add("ol","reversed start type","li"),add("ul","","li"),add("li","value",flowContent),add("dl","","dt dd"),add("a","href target rel media hreflang type",phrasingContent),add("q","cite",phrasingContent),add("ins del","cite datetime",flowContent),add("img","src sizes srcset alt usemap ismap width height"),add("iframe","src name width height",flowContent),add("embed","src type width height"),add("object","data type typemustmatch name usemap form width height",[flowContent,"param"].join(" ")),add("param","name value"),add("map","name",[flowContent,"area"].join(" ")),add("area","alt coords shape href target rel media hreflang type"),add("table","border","caption colgroup thead tfoot tbody tr"+("html4"===type?" col":"")),add("colgroup","span","col"),add("col","span"),add("tbody thead tfoot","","tr"),add("tr","","td th"),add("td","colspan rowspan headers",flowContent),add("th","colspan rowspan headers scope abbr",flowContent),add("form","accept-charset action autocomplete enctype method name novalidate target",flowContent),add("fieldset","disabled form name",[flowContent,"legend"].join(" ")),add("label","form for",phrasingContent),add("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"),add("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value","html4"===type?flowContent:phrasingContent),add("select","disabled form multiple name required size","option optgroup"),add("optgroup","disabled label","option"),add("option","disabled label selected value"),add("textarea","cols dirname disabled form maxlength name readonly required rows wrap"),add("menu","type label",[flowContent,"li"].join(" ")),add("noscript","",flowContent),"html4"!==type&&(add("wbr"),add("ruby","",[phrasingContent,"rt rp"].join(" ")),add("figcaption","",flowContent),add("mark rt rp summary bdi","",phrasingContent),add("canvas","width height",flowContent),add("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered",[flowContent,"track source"].join(" ")),add("audio","src crossorigin preload autoplay mediagroup loop muted controls buffered volume",[flowContent,"track source"].join(" ")),add("picture","","img source"),add("source","src srcset type media sizes"),add("track","kind src srclang label default"),add("datalist","",[phrasingContent,"option"].join(" ")),add("article section nav aside main header footer","",flowContent),add("hgroup","","h1 h2 h3 h4 h5 h6"),add("figure","",[flowContent,"figcaption"].join(" ")),add("time","datetime",phrasingContent),add("dialog","open",flowContent),add("command","type label icon disabled checked radiogroup command"),add("output","for form name",phrasingContent),add("progress","value max",phrasingContent),add("meter","value min max low high optimum",phrasingContent),add("details","open",[flowContent,"summary"].join(" ")),add("keygen","autofocus challenge disabled form keytype name")),"html5-strict"!==type&&(addAttrs("script","language xml:space"),addAttrs("style","xml:space"),addAttrs("object","declare classid code codebase codetype archive standby align border hspace vspace"),addAttrs("embed","align name hspace vspace"),addAttrs("param","valuetype type"),addAttrs("a","charset name rev shape coords"),addAttrs("br","clear"),addAttrs("applet","codebase archive code object alt name width height align hspace vspace"),addAttrs("img","name longdesc align border hspace vspace"),addAttrs("iframe","longdesc frameborder marginwidth marginheight scrolling align"),addAttrs("font basefont","size color face"),addAttrs("input","usemap align"),addAttrs("select"),addAttrs("textarea"),addAttrs("h1 h2 h3 h4 h5 h6 div p legend caption","align"),addAttrs("ul","type compact"),addAttrs("li","type"),addAttrs("ol dl menu dir","compact"),addAttrs("pre","width xml:space"),addAttrs("hr","align noshade size width"),addAttrs("isindex","prompt"),addAttrs("table","summary width frame rules cellspacing cellpadding align bgcolor"),addAttrs("col","width align char charoff valign"),addAttrs("colgroup","width align char charoff valign"),addAttrs("thead","align char charoff valign"),addAttrs("tr","align char charoff valign bgcolor"),addAttrs("th","axis align char charoff valign nowrap bgcolor width height"),addAttrs("form","accept"),addAttrs("td","abbr axis scope align char charoff valign nowrap bgcolor width height"),addAttrs("tfoot","align char charoff valign"),addAttrs("tbody","align char charoff valign"),addAttrs("area","nohref"),addAttrs("body","background bgcolor text link vlink alink")),"html4"!==type&&(addAttrs("input button select textarea","autofocus"),addAttrs("input textarea","placeholder"),addAttrs("a","download"),addAttrs("link script img","crossorigin"),addAttrs("img","loading"),addAttrs("iframe","sandbox seamless allowfullscreen loading")),each$3(split("a form meter progress dfn"),function(name){schema[name]&&delete schema[name].children[name]}),delete schema.caption.children.table,delete schema.script,mapCache[type]=schema,schema)},compileElementMap=function(value,mode){var styles;return value&&(styles={},"string"==typeof value&&(value={"*":value}),each$3(value,function(value,key){styles[key]=styles[key.toUpperCase()]="map"===mode?makeMap$2(value,/[, ]/):explode$1(value,/[, ]/)})),styles},toHex=function(match,r,g,b){var hex=function(val){return val=parseInt(val,10).toString(16),val.length>1?val:"0"+val};return"#"+hex(r)+hex(g)+hex(b)},Styles=function(settings,schema){var i,encodingItems,validStyles,invalidStyles,rgbRegExp=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,urlOrStrRegExp=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,styleRegExp=/\s*([^:]+):\s*([^;]+);?/g,trimRightRegExp=/\s+$/,encodingLookup={};for(settings=settings||{},schema&&(validStyles=schema.getValidStyles(),invalidStyles=schema.getInvalidStyles()),encodingItems="\\\" \\' \\; \\: ; : \ufeff".split(" "),i=0;i<encodingItems.length;i++)encodingLookup[encodingItems[i]]="\ufeff"+i,encodingLookup["\ufeff"+i]=encodingItems[i];return{toHex:function(color){return color.replace(rgbRegExp,toHex)},parse:function(css){var matches,name,value,isEncoded,styles={},urlConverter=settings.url_converter,urlConverterScope=settings.url_converter_scope||this,compress=function(prefix,suffix,noJoin){var top,right,bottom,left;if((top=styles[prefix+"-top"+suffix])&&(right=styles[prefix+"-right"+suffix])&&(bottom=styles[prefix+"-bottom"+suffix])&&(left=styles[prefix+"-left"+suffix])){var box=[top,right,bottom,left];for(i=box.length-1;i--&&box[i]===box[i+1];);i>-1&&noJoin||(styles[prefix+suffix]=-1===i?box[0]:box.join(" "),delete styles[prefix+"-top"+suffix],delete styles[prefix+"-right"+suffix],delete styles[prefix+"-bottom"+suffix],delete styles[prefix+"-left"+suffix])}},canCompress=function(key){var i,value=styles[key];if(value){for(value=value.split(" "),i=value.length;i--;)if(value[i]!==value[0])return!1;return styles[key]=value[0],!0}},encode=function(str){return isEncoded=!0,encodingLookup[str]},decode=function(str,keepSlashes){return isEncoded&&(str=str.replace(/\uFEFF[0-9]/g,function(str){return encodingLookup[str]})),keepSlashes||(str=str.replace(/\\([\'\";:])/g,"$1")),str},decodeSingleHexSequence=function(escSeq){return String.fromCharCode(parseInt(escSeq.slice(1),16))},decodeHexSequences=function(value){return value.replace(/\\[0-9a-f]+/gi,decodeSingleHexSequence)},processUrl=function(match,url,url2,url3,str,str2){if(str=str||str2)return str=decode(str),"'"+str.replace(/\'/g,"\\'")+"'";if(url=decode(url||url2||url3),!settings.allow_script_urls){var scriptUrl=url.replace(/[\s\r\n]+/g,"");if(/(java|vb)script:/i.test(scriptUrl))return"";if(!settings.allow_svg_data_urls&&/^data:image\/svg/i.test(scriptUrl))return""}return urlConverter&&(url=urlConverter.call(urlConverterScope,url,"style")),"url('"+url.replace(/\'/g,"\\'")+"')"};if(css){for(css=css.replace(/[\u0000-\u001F]/g,""),css=css.replace(/\\[\"\';:\uFEFF]/g,encode).replace(/\"[^\"]+\"|\'[^\']+\'/g,function(str){return str.replace(/[;:]/g,encode)});matches=styleRegExp.exec(css);)if(styleRegExp.lastIndex=matches.index+matches[0].length,name=matches[1].replace(trimRightRegExp,"").toLowerCase(),value=matches[2].replace(trimRightRegExp,""),name&&value){if(name=decodeHexSequences(name),value=decodeHexSequences(value),-1!==name.indexOf("\ufeff")||-1!==name.indexOf('"'))continue;if(!settings.allow_script_urls&&("behavior"===name||/expression\s*\(|\/\*|\*\//.test(value)))continue;"font-weight"===name&&"700"===value?value="bold":"color"!==name&&"background-color"!==name||(value=value.toLowerCase()),value=value.replace(rgbRegExp,toHex),value=value.replace(urlOrStrRegExp,processUrl),styles[name]=isEncoded?decode(value,!0):value}compress("border","",!0),compress("border","-width"),compress("border","-color"),compress("border","-style"),compress("padding",""),compress("margin",""),function(target,a,b,c){canCompress(a)&&canCompress(b)&&canCompress(c)&&(styles[target]=styles[a]+" "+styles[b]+" "+styles[c],delete styles[a],delete styles[b],delete styles[c])}("border","border-width","border-style","border-color"),"medium none"===styles.border&&delete styles.border,"none"===styles["border-image"]&&delete styles["border-image"]}return styles},serialize:function(styles,elementName){var name,value,css="",serializeStyles=function(name){var styleList,i,l,value;if(styleList=validStyles[name])for(i=0,l=styleList.length;i<l;i++)name=styleList[i],(value=styles[name])&&(css+=(css.length>0?" ":"")+name+": "+value+";")};if(elementName&&validStyles)serializeStyles("*"),serializeStyles(elementName);else for(name in styles)!(value=styles[name])||invalidStyles&&!function(name,elementName){var styleMap;return(!(styleMap=invalidStyles["*"])||!styleMap[name])&&(!(styleMap=invalidStyles[elementName])||!styleMap[name])}(name,elementName)||(css+=(css.length>0?" ":"")+name+": "+value+";");return css}}},eventExpandoPrefix="mce-data-",mouseEventRe=/^(?:mouse|contextmenu)|click/,deprecated={keyLocation:1,layerX:1,layerY:1,returnValue:1,webkitMovementX:1,webkitMovementY:1,keyIdentifier:1,mozPressure:1},hasIsDefaultPrevented=function(event){return event.isDefaultPrevented===returnTrue||event.isDefaultPrevented===returnFalse},returnFalse=function(){return!1},returnTrue=function(){return!0},addEvent=function(target,name,callback,capture){target.addEventListener?target.addEventListener(name,callback,capture||!1):target.attachEvent&&target.attachEvent("on"+name,callback)},removeEvent=function(target,name,callback,capture){target.removeEventListener?target.removeEventListener(name,callback,capture||!1):target.detachEvent&&target.detachEvent("on"+name,callback)},getTargetFromShadowDom=function(event,defaultTarget){if(event.composedPath){var composedPath=event.composedPath();if(composedPath&&composedPath.length>0)return composedPath[0]}return defaultTarget},fix=function(originalEvent,data){var name,event=data||{};for(name in originalEvent)deprecated[name]||(event[name]=originalEvent[name]);if(event.target||(event.target=event.srcElement||domGlobals.document),Env.experimentalShadowDom&&(event.target=getTargetFromShadowDom(originalEvent,event.target)),originalEvent&&mouseEventRe.test(originalEvent.type)&&void 0===originalEvent.pageX&&void 0!==originalEvent.clientX){var eventDoc=event.target.ownerDocument||domGlobals.document,doc=eventDoc.documentElement,body=eventDoc.body;event.pageX=originalEvent.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0),event.pageY=originalEvent.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)}return event.preventDefault=function(){event.isDefaultPrevented=returnTrue,originalEvent&&(originalEvent.preventDefault?originalEvent.preventDefault():originalEvent.returnValue=!1)},event.stopPropagation=function(){event.isPropagationStopped=returnTrue,originalEvent&&(originalEvent.stopPropagation?originalEvent.stopPropagation():originalEvent.cancelBubble=!0)},event.stopImmediatePropagation=function(){event.isImmediatePropagationStopped=returnTrue,event.stopPropagation()},!1===hasIsDefaultPrevented(event)&&(event.isDefaultPrevented=returnFalse,event.isPropagationStopped=returnFalse,event.isImmediatePropagationStopped=returnFalse),void 0===event.metaKey&&(event.metaKey=!1),event},bindOnReady=function(win,callback,eventUtils){var doc=win.document,event={type:"ready"};if(eventUtils.domLoaded)return void callback(event);var readyHandler=function(){removeEvent(win,"DOMContentLoaded",readyHandler),removeEvent(win,"load",readyHandler),eventUtils.domLoaded||(eventUtils.domLoaded=!0,callback(event))};!function(){return"complete"===doc.readyState||"interactive"===doc.readyState&&doc.body}()?addEvent(win,"DOMContentLoaded",readyHandler):readyHandler(),addEvent(win,"load",readyHandler)},EventUtils=function(){function EventUtils(){this.domLoaded=!1,this.events={},this.count=1,this.expando=eventExpandoPrefix+(+new Date).toString(32),this.hasMouseEnterLeave="onmouseenter"in domGlobals.document.documentElement,this.hasFocusIn="onfocusin"in domGlobals.document.documentElement,this.count=1}return EventUtils.prototype.bind=function(target,names,callback,scope){var id,callbackList,i,name,fakeName,nativeHandler,capture,self=this,win=domGlobals.window,defaultNativeHandler=function(evt){self.executeHandlers(fix(evt||win.event),id)};if(target&&3!==target.nodeType&&8!==target.nodeType){target[self.expando]?id=target[self.expando]:(id=self.count++,target[self.expando]=id,self.events[id]={}),scope=scope||target;var namesList=names.split(" ");for(i=namesList.length;i--;)name=namesList[i],nativeHandler=defaultNativeHandler,fakeName=capture=!1,"DOMContentLoaded"===name&&(name="ready"),self.domLoaded&&"ready"===name&&"complete"===target.readyState?callback.call(scope,fix({type:name})):(self.hasMouseEnterLeave||(fakeName=self.mouseEnterLeave[name])&&(nativeHandler=function(evt){var current,related;if(current=evt.currentTarget,(related=evt.relatedTarget)&&current.contains)related=current.contains(related);else for(;related&&related!==current;)related=related.parentNode;related||(evt=fix(evt||win.event),evt.type="mouseout"===evt.type?"mouseleave":"mouseenter",evt.target=current,self.executeHandlers(evt,id))}),self.hasFocusIn||"focusin"!==name&&"focusout"!==name||(capture=!0,fakeName="focusin"===name?"focus":"blur",nativeHandler=function(evt){evt=fix(evt||win.event),evt.type="focus"===evt.type?"focusin":"focusout",self.executeHandlers(evt,id)}),callbackList=self.events[id][name],callbackList?"ready"===name&&self.domLoaded?callback(fix({type:name})):callbackList.push({func:callback,scope:scope}):(self.events[id][name]=callbackList=[{func:callback,scope:scope}],callbackList.fakeName=fakeName,callbackList.capture=capture,callbackList.nativeHandler=nativeHandler,"ready"===name?bindOnReady(target,nativeHandler,self):addEvent(target,fakeName||name,nativeHandler,capture)));return target=callbackList=0,callback}},EventUtils.prototype.unbind=function(target,names,callback){var id,callbackList,i,ci,name,eventMap;if(!target||3===target.nodeType||8===target.nodeType)return this;if(id=target[this.expando]){if(eventMap=this.events[id],names){var namesList=names.split(" ");for(i=namesList.length;i--;)if(name=namesList[i],callbackList=eventMap[name]){if(callback)for(ci=callbackList.length;ci--;)if(callbackList[ci].func===callback){var nativeHandler=callbackList.nativeHandler,fakeName=callbackList.fakeName,capture=callbackList.capture;callbackList=callbackList.slice(0,ci).concat(callbackList.slice(ci+1)),callbackList.nativeHandler=nativeHandler,callbackList.fakeName=fakeName,callbackList.capture=capture,eventMap[name]=callbackList}callback&&0!==callbackList.length||(delete eventMap[name],removeEvent(target,callbackList.fakeName||name,callbackList.nativeHandler,callbackList.capture))}}else{for(name in eventMap)callbackList=eventMap[name],removeEvent(target,callbackList.fakeName||name,callbackList.nativeHandler,callbackList.capture);eventMap={}}for(name in eventMap)return this;delete this.events[id];try{delete target[this.expando]}catch(ex){target[this.expando]=null}}return this},EventUtils.prototype.fire=function(target,name,args){var id;if(!target||3===target.nodeType||8===target.nodeType)return this;var event=fix(null,args);event.type=name,event.target=target;do{id=target[this.expando],id&&this.executeHandlers(event,id),target=target.parentNode||target.ownerDocument||target.defaultView||target.parentWindow}while(target&&!event.isPropagationStopped());return this},EventUtils.prototype.clean=function(target){var i,children;if(!target||3===target.nodeType||8===target.nodeType)return this;if(target[this.expando]&&this.unbind(target),target.getElementsByTagName||(target=target.document),target&&target.getElementsByTagName)for(this.unbind(target),children=target.getElementsByTagName("*"),i=children.length;i--;)target=children[i],target[this.expando]&&this.unbind(target);return this},EventUtils.prototype.destroy=function(){this.events={}},EventUtils.prototype.cancel=function(e){return e&&(e.preventDefault(),e.stopImmediatePropagation()),!1},EventUtils.prototype.executeHandlers=function(evt,id){var callbackList,i,l,callback,container=this.events[id];if(callbackList=container&&container[evt.type])for(i=0,l=callbackList.length;i<l;i++)if(callback=callbackList[i],callback&&!1===callback.func.call(callback.scope,evt)&&evt.preventDefault(),evt.isImmediatePropagationStopped())return},EventUtils.Event=new EventUtils,EventUtils}(),expando="sizzle"+-new Date,preferredDoc=domGlobals.window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function(a,b){return a===b&&(hasDuplicate=!0),0},strundefined="undefined",MAX_NEGATIVE=1<<31,hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf$2=arr.indexOf||function(elem){for(var i=0,len=this.length;i<len;i++)if(this[i]===elem)return i;return-1},whitespace="[\\x20\\t\\r\\n\\f]",identifier="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",attributes="\\["+whitespace+"*("+identifier+")(?:"+whitespace+"*([*^$|!~]?=)"+whitespace+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+identifier+"))|)"+whitespace+"*\\]",pseudos=":("+identifier+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+attributes+")*)|.*)\\)|)",rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*?)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+identifier+")"),CLASS:new RegExp("^\\.("+identifier+")"),TAG:new RegExp("^("+identifier+"|[*])"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:new RegExp("^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,rescape=/'|\\/g,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;return high!==high||escapedWhitespace?escaped:high<0?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,1023&high|56320)};try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes),arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){for(var j=target.length,i=0;target[j++]=els[i++];);target.length=j-1}}}var Sizzle=function(selector,context,results,seed){var match,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;if((context?context.ownerDocument||context:preferredDoc)!==document&&setDocument(context),context=context||document,results=results||[],!selector||"string"!=typeof selector)return results;if(1!==(nodeType=context.nodeType)&&9!==nodeType)return[];if(documentIsHTML&&!seed){if(match=rquickExpr.exec(selector))if(m=match[1]){if(9===nodeType){if(!(elem=context.getElementById(m))||!elem.parentNode)return results;if(elem.id===m)return results.push(elem),results}else if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains$3(context,elem)&&elem.id===m)return results.push(elem),results}else{if(match[2])return push.apply(results,context.getElementsByTagName(selector)),results;if((m=match[3])&&support.getElementsByClassName)return push.apply(results,context.getElementsByClassName(m)),results}if(support.qsa&&(!rbuggyQSA||!rbuggyQSA.test(selector))){if(nid=old=expando,newContext=context,newSelector=9===nodeType&&selector,1===nodeType&&"object"!==context.nodeName.toLowerCase()){for(groups=tokenize(selector),(old=context.getAttribute("id"))?nid=old.replace(rescape,"\\$&"):context.setAttribute("id",nid),nid="[id='"+nid+"'] ",i=groups.length;i--;)groups[i]=nid+toSelector(groups[i]);newContext=rsibling.test(selector)&&testContext(context.parentNode)||context,newSelector=groups.join(",")}if(newSelector)try{return push.apply(results,newContext.querySelectorAll(newSelector)),results}catch(qsaError){}finally{old||context.removeAttribute("id")}}}return select(selector.replace(rtrim,"$1"),context,results,seed)};support=Sizzle.support={},isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return!!documentElement&&"HTML"!==documentElement.nodeName},setDocument=Sizzle.setDocument=function(node){var hasCompare,doc=node?node.ownerDocument||node:preferredDoc,parent=doc.defaultView;return doc!==document&&9===doc.nodeType&&doc.documentElement?(document=doc,docElem=doc.documentElement,documentIsHTML=!isXML(doc),parent&&parent!==function(win){try{return win.top}catch(ex){}return null}(parent)&&(parent.addEventListener?parent.addEventListener("unload",function(){setDocument()},!1):parent.attachEvent&&parent.attachEvent("onunload",function(){setDocument()})),support.attributes=!0,support.getElementsByTagName=!0,support.getElementsByClassName=rnative.test(doc.getElementsByClassName),support.getById=!0,Expr.find.ID=function(id,context){if(typeof context.getElementById!==strundefined&&documentIsHTML){var m=context.getElementById(id);return m&&m.parentNode?[m]:[]}},Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}},Expr.find.TAG=support.getElementsByTagName?function(tag,context){if(typeof context.getElementsByTagName!==strundefined)return context.getElementsByTagName(tag)}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if("*"===tag){for(;elem=results[i++];)1===elem.nodeType&&tmp.push(elem);return tmp}return results},Expr.find.CLASS=support.getElementsByClassName&&function(className,context){if(documentIsHTML)return context.getElementsByClassName(className)},rbuggyMatches=[],rbuggyQSA=[],support.disconnectedMatch=!0,rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|")),rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|")),hasCompare=rnative.test(docElem.compareDocumentPosition),contains$3=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},sortOrder=hasCompare?function(a,b){if(a===b)return hasDuplicate=!0,0;var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;return compare||(compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&compare||!support.sortDetached&&b.compareDocumentPosition(a)===compare?a===doc||a.ownerDocument===preferredDoc&&contains$3(preferredDoc,a)?-1:b===doc||b.ownerDocument===preferredDoc&&contains$3(preferredDoc,b)?1:sortInput?indexOf$2.call(sortInput,a)-indexOf$2.call(sortInput,b):0:4&compare?-1:1)}:function(a,b){if(a===b)return hasDuplicate=!0,0;var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup)return a===doc?-1:b===doc?1:aup?-1:bup?1:sortInput?indexOf$2.call(sortInput,a)-indexOf$2.call(sortInput,b):0;if(aup===bup)return siblingCheck(a,b);for(cur=a;cur=cur.parentNode;)ap.unshift(cur);for(cur=b;cur=cur.parentNode;)bp.unshift(cur);for(;ap[i]===bp[i];)i++;return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0},doc):document},Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)},Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document&&setDocument(elem),expr=expr.replace(rattributeQuotes,"='$1']"),support.matchesSelector&&documentIsHTML&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr)))try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&11!==elem.document.nodeType)return ret}catch(e){}return Sizzle(expr,document,null,[elem]).length>0},Sizzle.contains=function(context,elem){return(context.ownerDocument||context)!==document&&setDocument(context),contains$3(context,elem)},Sizzle.attr=function(elem,name){(elem.ownerDocument||elem)!==document&&setDocument(elem);var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):void 0;return void 0!==val?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null},Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)},Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;if(hasDuplicate=!support.detectDuplicates,sortInput=!support.sortStable&&results.slice(0),results.sort(sortOrder),hasDuplicate){for(;elem=results[i++];)elem===results[i]&&(j=duplicates.push(i));for(;j--;)results.splice(duplicates[j],1)}return sortInput=null,results},getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(nodeType){if(1===nodeType||9===nodeType||11===nodeType){if("string"==typeof elem.textContent)return elem.textContent;for(elem=elem.firstChild;elem;elem=elem.nextSibling)ret+=getText(elem)}else if(3===nodeType||4===nodeType)return elem.nodeValue}else for(;node=elem[i++];)ret+=getText(node);return ret},Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){return match[1]=match[1].replace(runescape,funescape),match[3]=(match[3]||match[4]||match[5]||"").replace(runescape,funescape),"~="===match[2]&&(match[3]=" "+match[3]+" "),match.slice(0,4)},CHILD:function(match){return match[1]=match[1].toLowerCase(),"nth"===match[1].slice(0,3)?(match[3]||Sizzle.error(match[0]),match[4]=+(match[4]?match[5]+(match[6]||1):2*("even"===match[3]||"odd"===match[3])),match[5]=+(match[7]+match[8]||"odd"===match[3])):match[3]&&Sizzle.error(match[0]),match},PSEUDO:function(match){var excess,unquoted=!match[6]&&match[2];return matchExpr.CHILD.test(match[0])?null:(match[3]?match[2]=match[4]||match[5]||"":unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,!0))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)&&(match[0]=match[0].slice(0,excess),match[2]=unquoted.slice(0,excess)),match.slice(0,3))}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return"*"===nodeNameSelector?function(){return!0}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test("string"==typeof elem.className&&elem.className||typeof elem.getAttribute!==strundefined&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);return null==result?"!="===operator:!operator||(result+="","="===operator?result===check:"!="===operator?result!==check:"^="===operator?check&&0===result.indexOf(check):"*="===operator?check&&result.indexOf(check)>-1:"$="===operator?check&&result.slice(-check.length)===check:"~="===operator?(" "+result+" ").indexOf(check)>-1:"|="===operator&&(result===check||result.slice(0,check.length+1)===check+"-"))}},CHILD:function(type,what,argument,first,last){var simple="nth"!==type.slice(0,3),forward="last"!==type.slice(-4),ofType="of-type"===what;return 1===first&&0===last?function(elem){return!!elem.parentNode}:function(elem,context,xml){var cache,outerCache,node,diff,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType;if(parent){if(simple){for(;dir;){for(node=elem;node=node[dir];)if(ofType?node.nodeName.toLowerCase()===name:1===node.nodeType)return!1;start=dir="only"===type&&!start&&"nextSibling"}return!0}if(start=[forward?parent.firstChild:parent.lastChild],forward&&useCache){for(outerCache=parent[expando]||(parent[expando]={}),cache=outerCache[type]||[],nodeIndex=cache[0]===dirruns&&cache[1],diff=cache[0]===dirruns&&cache[2],node=nodeIndex&&parent.childNodes[nodeIndex];node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop();)if(1===node.nodeType&&++diff&&node===elem){outerCache[type]=[dirruns,nodeIndex,diff];break}}else if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns)diff=cache[1];else for(;(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())&&((ofType?node.nodeName.toLowerCase()!==name:1!==node.nodeType)||!++diff||(useCache&&((node[expando]||(node[expando]={}))[type]=[dirruns,diff]),node!==elem)););return(diff-=last)===first||diff%first==0&&diff/first>=0}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);return fn[expando]?fn(argument):fn.length>1?(args=[pseudo,pseudo,"",argument],Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){for(var idx,matched=fn(seed,argument),i=matched.length;i--;)idx=indexOf$2.call(seed,matched[i]),seed[idx]=!(matches[idx]=matched[i])}):function(elem){return fn(elem,0,args)}):fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){for(var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;i--;)(elem=unmatched[i])&&(seed[i]=!(matches[i]=elem))}):function(elem,context,xml){return input[0]=elem,matcher(input,null,xml,results),!results.pop()}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),contains:markFunction(function(text){return text=text.replace(runescape,funescape),function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),lang:markFunction(function(lang){return ridentifier.test(lang||"")||Sizzle.error("unsupported lang: "+lang),lang=lang.replace(runescape,funescape).toLowerCase(),function(elem){var elemLang;do{if(elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))return(elemLang=elemLang.toLowerCase())===lang||0===elemLang.indexOf(lang+"-")}while((elem=elem.parentNode)&&1===elem.nodeType);return!1}}),target:function(elem){var hash=domGlobals.window.location&&domGlobals.window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:function(elem){return!1===elem.disabled},disabled:function(elem){return!0===elem.disabled},checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return"input"===nodeName&&!!elem.checked||"option"===nodeName&&!!elem.selected},selected:function(elem){return elem.parentNode&&elem.parentNode.selectedIndex,!0===elem.selected},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling)if(elem.nodeType<6)return!1;return!0},parent:function(elem){return!Expr.pseudos.empty(elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&"button"===elem.type||"button"===name},text:function(elem){var attr;return"input"===elem.nodeName.toLowerCase()&&"text"===elem.type&&(null==(attr=elem.getAttribute("type"))||"text"===attr.toLowerCase())},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[argument<0?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){for(var i=0;i<length;i+=2)matchIndexes.push(i);return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){for(var i=1;i<length;i+=2)matchIndexes.push(i);return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=argument<0?argument+length:argument;--i>=0;)matchIndexes.push(i);return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=argument<0?argument+length:argument;++i<length;)matchIndexes.push(i);return matchIndexes})}},Expr.pseudos.nth=Expr.pseudos.eq;for(i in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Expr.pseudos[i]=function(type){return function(elem){return"input"===elem.nodeName.toLowerCase()&&elem.type===type}}(i);for(i in{submit:!0,reset:!0})Expr.pseudos[i]=function(type){return function(elem){var name=elem.nodeName.toLowerCase();return("input"===name||"button"===name)&&elem.type===type}}(i);setFilters.prototype=Expr.filters=Expr.pseudos,Expr.setFilters=new setFilters,tokenize=Sizzle.tokenize=function(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached)return parseOnly?0:cached.slice(0);for(soFar=selector,groups=[],preFilters=Expr.preFilter;soFar;){matched&&!(match=rcomma.exec(soFar))||(match&&(soFar=soFar.slice(match[0].length)||soFar),groups.push(tokens=[])),matched=!1,(match=rcombinators.exec(soFar))&&(matched=match.shift(),tokens.push({value:matched,type:match[0].replace(rtrim," ")}),soFar=soFar.slice(matched.length));for(type in Expr.filter)Expr.filter.hasOwnProperty(type)&&(!(match=matchExpr[type].exec(soFar))||preFilters[type]&&!(match=preFilters[type](match))||(matched=match.shift(),tokens.push({value:matched,type:type,matches:match}),soFar=soFar.slice(matched.length)));if(!matched)break}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)},compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){for(match||(match=tokenize(selector)),i=match.length;i--;)cached=matcherFromTokens(match[i]),cached[expando]?setMatchers.push(cached):elementMatchers.push(cached);cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers)),cached.selector=selector}return cached},select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled="function"==typeof selector&&selector,match=!seed&&tokenize(selector=compiled.selector||selector);if(results=results||[],1===match.length){if(tokens=match[0]=match[0].slice(0),tokens.length>2&&"ID"===(token=tokens[0]).type&&support.getById&&9===context.nodeType&&documentIsHTML&&Expr.relative[tokens[1].type]){if(!(context=(Expr.find.ID(token.matches[0].replace(runescape,funescape),context)||[])[0]))return results;compiled&&(context=context.parentNode),selector=selector.slice(tokens.shift().value.length)}for(i=matchExpr.needsContext.test(selector)?0:tokens.length;i--&&(token=tokens[i],!Expr.relative[type=token.type]);)if((find=Expr.find[type])&&(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context))){if(tokens.splice(i,1),!(selector=seed.length&&toSelector(tokens)))return push.apply(results,seed),results;break}}return(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,rsibling.test(selector)&&testContext(context.parentNode)||context),results},support.sortStable=expando.split("").sort(sortOrder).join("")===expando,support.detectDuplicates=!!hasDuplicate,setDocument(),support.sortDetached=!0;var doc=domGlobals.document,push$1=Array.prototype.push,slice$1=Array.prototype.slice,rquickExpr$1=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,Event=EventUtils.Event,skipUniques=Tools.makeMap("children,contents,next,prev"),isDefined=function(obj){return void 0!==obj},isString$1=function(obj){return"string"==typeof obj},isWindow=function(obj){return obj&&obj===obj.window},createFragment=function(html,fragDoc){var frag,node,container;for(fragDoc=fragDoc||doc,container=fragDoc.createElement("div"),frag=fragDoc.createDocumentFragment(),container.innerHTML=html;node=container.firstChild;)frag.appendChild(node);return frag},domManipulate=function(targetNodes,sourceItem,callback,reverse){var i;if(isString$1(sourceItem))sourceItem=createFragment(sourceItem,getElementDocument(targetNodes[0]));else if(sourceItem.length&&!sourceItem.nodeType){if(sourceItem=DomQuery.makeArray(sourceItem),reverse)for(i=sourceItem.length-1;i>=0;i--)domManipulate(targetNodes,sourceItem[i],callback,reverse);else for(i=0;i<sourceItem.length;i++)domManipulate(targetNodes,sourceItem[i],callback,reverse);return targetNodes}if(sourceItem.nodeType)for(i=targetNodes.length;i--;)callback.call(targetNodes[i],sourceItem);return targetNodes},hasClass=function(node,className){return node&&className&&-1!==(" "+node.className+" ").indexOf(" "+className+" ")},wrap$1=function(elements,wrapper,all){var lastParent,newWrapper;return wrapper=DomQuery(wrapper)[0],elements.each(function(){var self=this;all&&lastParent===self.parentNode?newWrapper.appendChild(self):(lastParent=self.parentNode,newWrapper=wrapper.cloneNode(!1),self.parentNode.insertBefore(newWrapper,self),newWrapper.appendChild(self))}),elements},numericCssMap=Tools.makeMap("fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom"," "),booleanMap=Tools.makeMap("checked compact declare defer disabled ismap multiple nohref noshade nowrap readonly selected"," "),propFix={for:"htmlFor",class:"className",readonly:"readOnly"},cssFix={float:"cssFloat"},attrHooks={},cssHooks={},DomQueryConstructor=function(selector,context){return new DomQuery.fn.init(selector,context)},inArray$1=function(item,array){var i;if(array.indexOf)return array.indexOf(item);for(i=array.length;i--;)if(array[i]===item)return i;return-1},whiteSpaceRegExp$1=/^\s*|\s*$/g,trim$2=function(str){return null===str||void 0===str?"":(""+str).replace(whiteSpaceRegExp$1,"")},each$4=function(obj,callback){var length,key,i,value;if(obj)if(void 0===(length=obj.length)){for(key in obj)if(obj.hasOwnProperty(key)&&(value=obj[key],!1===callback.call(value,key,value)))break}else for(i=0;i<length&&(value=obj[i],!1!==callback.call(value,i,value));i++);return obj},grep=function(array,callback){var out=[];return each$4(array,function(i,item){callback(item,i)&&out.push(item)}),out},getElementDocument=function(element){return element?9===element.nodeType?element:element.ownerDocument:doc};DomQueryConstructor.fn=DomQueryConstructor.prototype={constructor:DomQueryConstructor,selector:"",context:null,length:0,init:function(selector,context){var match,node,self=this;if(!selector)return self;if(selector.nodeType)return self.context=self[0]=selector,self.length=1,self;if(context&&context.nodeType)self.context=context;else{if(context)return DomQuery(selector).attr(context);self.context=context=domGlobals.document}if(isString$1(selector)){if(self.selector=selector,!(match="<"===selector.charAt(0)&&">"===selector.charAt(selector.length-1)&&selector.length>=3?[null,selector,null]:rquickExpr$1.exec(selector)))return DomQuery(context).find(selector);if(match[1])for(node=createFragment(selector,getElementDocument(context)).firstChild;node;)push$1.call(self,node),node=node.nextSibling;else{if(!(node=getElementDocument(context).getElementById(match[2])))return self;if(node.id!==match[2])return self.find(selector);self.length=1,self[0]=node}}else this.add(selector,!1);return self},toArray:function(){return Tools.toArray(this)},add:function(items,sort){var nodes,i,self=this;if(isString$1(items))return self.add(DomQuery(items));if(!1!==sort)for(nodes=DomQuery.unique(self.toArray().concat(DomQuery.makeArray(items))),self.length=nodes.length,i=0;i<nodes.length;i++)self[i]=nodes[i];else push$1.apply(self,DomQuery.makeArray(items));return self},attr:function(name,value){var hook,self=this;if("object"==typeof name)each$4(name,function(name,value){self.attr(name,value)});else{if(!isDefined(value)){if(self[0]&&1===self[0].nodeType){if((hook=attrHooks[name])&&hook.get)return hook.get(self[0],name);if(booleanMap[name])return self.prop(name)?name:void 0;value=self[0].getAttribute(name,2),null===value&&(value=void 0)}return value}this.each(function(){var hook;if(1===this.nodeType){if((hook=attrHooks[name])&&hook.set)return void hook.set(this,value);null===value?this.removeAttribute(name,2):this.setAttribute(name,value,2)}})}return self},removeAttr:function(name){return this.attr(name,null)},prop:function(name,value){var self=this;if("object"==typeof(name=propFix[name]||name))each$4(name,function(name,value){self.prop(name,value)});else{if(!isDefined(value))return self[0]&&self[0].nodeType&&name in self[0]?self[0][name]:value;this.each(function(){1===this.nodeType&&(this[name]=value)})}return self},css:function(name,value){var elm,hook,self=this,camel=function(name){return name.replace(/-(\D)/g,function(a,b){return b.toUpperCase()})},dashed=function(name){return name.replace(/[A-Z]/g,function(a){return"-"+a})};if("object"==typeof name)each$4(name,function(name,value){self.css(name,value)});else if(isDefined(value))name=camel(name),"number"!=typeof value||numericCssMap[name]||(value=value.toString()+"px"),self.each(function(){var style=this.style;if((hook=cssHooks[name])&&hook.set)return void hook.set(this,value);try{this.style[cssFix[name]||name]=value}catch(ex){}null!==value&&""!==value||(style.removeProperty?style.removeProperty(dashed(name)):style.removeAttribute(name))});else{if(elm=self[0],(hook=cssHooks[name])&&hook.get)return hook.get(elm);if(!elm.ownerDocument.defaultView)return elm.currentStyle?elm.currentStyle[camel(name)]:"";try{return elm.ownerDocument.defaultView.getComputedStyle(elm,null).getPropertyValue(dashed(name))}catch(ex){return}}return self},remove:function(){for(var node,self=this,i=this.length;i--;)node=self[i],Event.clean(node),node.parentNode&&node.parentNode.removeChild(node);return this},empty:function(){for(var node,self=this,i=this.length;i--;)for(node=self[i];node.firstChild;)node.removeChild(node.firstChild);return this},html:function(value){var i,self=this;if(isDefined(value)){i=self.length;try{for(;i--;)self[i].innerHTML=value}catch(ex){DomQuery(self[i]).empty().append(value)}return self}return self[0]?self[0].innerHTML:""},text:function(value){var i,self=this;if(isDefined(value)){for(i=self.length;i--;)"innerText"in self[i]?self[i].innerText=value:self[0].textContent=value;return self}return self[0]?self[0].innerText||self[0].textContent:""},append:function(){return domManipulate(this,arguments,function(node){(1===this.nodeType||this.host&&1===this.host.nodeType)&&this.appendChild(node)})},prepend:function(){return domManipulate(this,arguments,function(node){(1===this.nodeType||this.host&&1===this.host.nodeType)&&this.insertBefore(node,this.firstChild)},!0)},before:function(){var self=this;return self[0]&&self[0].parentNode?domManipulate(self,arguments,function(node){this.parentNode.insertBefore(node,this)}):self},after:function(){var self=this;return self[0]&&self[0].parentNode?domManipulate(self,arguments,function(node){this.parentNode.insertBefore(node,this.nextSibling)},!0):self},appendTo:function(val){return DomQuery(val).append(this),this},prependTo:function(val){return DomQuery(val).prepend(this),this},replaceWith:function(content){return this.before(content).remove()},wrap:function(content){return wrap$1(this,content)},wrapAll:function(content){return wrap$1(this,content,!0)},wrapInner:function(content){return this.each(function(){DomQuery(this).contents().wrapAll(content)}),this},unwrap:function(){return this.parent().each(function(){DomQuery(this).replaceWith(this.childNodes)})},clone:function(){var result=[];return this.each(function(){result.push(this.cloneNode(!0))}),DomQuery(result)},addClass:function(className){return this.toggleClass(className,!0)},removeClass:function(className){return this.toggleClass(className,!1)},toggleClass:function(className,state){var self=this;return"string"!=typeof className?self:(-1!==className.indexOf(" ")?each$4(className.split(" "),function(){self.toggleClass(this,state)}):self.each(function(index,node){var existingClassName,classState;(classState=hasClass(node,className))!==state&&(existingClassName=node.className,classState?node.className=trim$2((" "+existingClassName+" ").replace(" "+className+" "," ")):node.className+=existingClassName?" "+className:className)}),self)},hasClass:function(className){return hasClass(this[0],className)},each:function(callback){return each$4(this,callback)},on:function(name,callback){return this.each(function(){Event.bind(this,name,callback)})},off:function(name,callback){return this.each(function(){Event.unbind(this,name,callback)})},trigger:function(name){return this.each(function(){"object"==typeof name?Event.fire(this,name.type,name):Event.fire(this,name)})},show:function(){return this.css("display","")},hide:function(){return this.css("display","none")},slice:function(){return new DomQuery(slice$1.apply(this,arguments))},eq:function(index){return-1===index?this.slice(index):this.slice(index,+index+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},find:function(selector){var i,l,ret=[];for(i=0,l=this.length;i<l;i++)DomQuery.find(selector,this[i],ret);return DomQuery(ret)},filter:function(selector){return DomQuery("function"==typeof selector?grep(this.toArray(),function(item,i){return selector(i,item)}):DomQuery.filter(selector,this.toArray()))},closest:function(selector){var result=[];return selector instanceof DomQuery&&(selector=selector[0]),this.each(function(i,node){for(;node;){if("string"==typeof selector&&DomQuery(node).is(selector)){result.push(node);break}if(node===selector){result.push(node);break}node=node.parentNode}}),DomQuery(result)},offset:function(offset){var elm,doc,docElm,pos,x=0,y=0;return offset?this.css(offset):(elm=this[0],elm&&(doc=elm.ownerDocument,docElm=doc.documentElement,elm.getBoundingClientRect&&(pos=elm.getBoundingClientRect(),x=pos.left+(docElm.scrollLeft||doc.body.scrollLeft)-docElm.clientLeft,y=pos.top+(docElm.scrollTop||doc.body.scrollTop)-docElm.clientTop)),{left:x,top:y})},push:push$1,sort:Array.prototype.sort,splice:Array.prototype.splice},Tools.extend(DomQueryConstructor,{extend:Tools.extend,makeArray:function(object){return isWindow(object)||object.nodeType?[object]:Tools.toArray(object)},inArray:inArray$1,isArray:Tools.isArray,each:each$4,trim:trim$2,grep:grep,find:Sizzle,expr:Sizzle.selectors,unique:Sizzle.uniqueSort,text:Sizzle.getText,contains:Sizzle.contains,filter:function(expr,elems,not){var i=elems.length;for(not&&(expr=":not("+expr+")");i--;)1!==elems[i].nodeType&&elems.splice(i,1);return elems=1===elems.length?DomQuery.find.matchesSelector(elems[0],expr)?[elems[0]]:[]:DomQuery.find.matches(expr,elems)}});var dir=function(el,prop,until){var matched=[],cur=el[prop];for("string"!=typeof until&&until instanceof DomQuery&&(until=until[0]);cur&&9!==cur.nodeType;){if(void 0!==until){if(cur===until)break;if("string"==typeof until&&DomQuery(cur).is(until))break}1===cur.nodeType&&matched.push(cur),cur=cur[prop]}return matched},sibling=function(node,siblingName,nodeType,until){var result=[];for(until instanceof DomQuery&&(until=until[0]);node;node=node[siblingName])if(!nodeType||node.nodeType===nodeType){if(void 0!==until){if(node===until)break;if("string"==typeof until&&DomQuery(node).is(until))break}result.push(node)}return result},firstSibling=function(node,siblingName,nodeType){for(node=node[siblingName];node;node=node[siblingName])if(node.nodeType===nodeType)return node;return null};each$4({parent:function(node){var parent=node.parentNode;return parent&&11!==parent.nodeType?parent:null},parents:function(node){return dir(node,"parentNode")},next:function(node){return firstSibling(node,"nextSibling",1)},prev:function(node){return firstSibling(node,"previousSibling",1)},children:function(node){return sibling(node.firstChild,"nextSibling",1)},contents:function(node){return Tools.toArray(("iframe"===node.nodeName?node.contentDocument||node.contentWindow.document:node).childNodes)}},function(name,fn){DomQueryConstructor.fn[name]=function(selector){var self=this,result=[];self.each(function(){var nodes=fn.call(result,this,selector,result);nodes&&(DomQuery.isArray(nodes)?result.push.apply(result,nodes):result.push(nodes))}),this.length>1&&(skipUniques[name]||(result=DomQuery.unique(result)),0===name.indexOf("parents")&&(result=result.reverse()));var wrappedResult=DomQuery(result);return selector?wrappedResult.filter(selector):wrappedResult}}),each$4({parentsUntil:function(node,until){return dir(node,"parentNode",until)},nextUntil:function(node,until){return sibling(node,"nextSibling",1,until).slice(1)},prevUntil:function(node,until){return sibling(node,"previousSibling",1,until).slice(1)}},function(name,fn){DomQueryConstructor.fn[name]=function(selector,filter){var self=this,result=[];self.each(function(){var nodes=fn.call(result,this,selector,result);nodes&&(DomQuery.isArray(nodes)?result.push.apply(result,nodes):result.push(nodes))}),this.length>1&&(result=DomQuery.unique(result),0!==name.indexOf("parents")&&"prevUntil"!==name||(result=result.reverse()));var wrappedResult=DomQuery(result);return filter?wrappedResult.filter(filter):wrappedResult}}),DomQueryConstructor.fn.is=function(selector){return!!selector&&this.filter(selector).length>0},DomQueryConstructor.fn.init.prototype=DomQueryConstructor.fn,DomQueryConstructor.overrideDefaults=function(callback){var defaults,sub=function(selector,context){return defaults=defaults||callback(),0===arguments.length&&(selector=defaults.element),context||(context=defaults.context),new sub.fn.init(selector,context)};return DomQuery.extend(sub,this),sub},DomQueryConstructor.attrHooks=attrHooks,DomQueryConstructor.cssHooks=cssHooks;var DomQuery=DomQueryConstructor,TreeWalker=function(){function TreeWalker(startNode,rootNode){this.node=startNode,this.rootNode=rootNode,this.current=this.current.bind(this),this.next=this.next.bind(this),this.prev=this.prev.bind(this),this.prev2=this.prev2.bind(this)}return TreeWalker.prototype.current=function(){return this.node},TreeWalker.prototype.next=function(shallow){return this.node=this.findSibling(this.node,"firstChild","nextSibling",shallow),this.node},TreeWalker.prototype.prev=function(shallow){return this.node=this.findSibling(this.node,"lastChild","previousSibling",shallow),this.node},TreeWalker.prototype.prev2=function(shallow){return this.node=this.findPreviousNode(this.node,"lastChild","previousSibling",shallow),this.node},TreeWalker.prototype.findSibling=function(node,startName,siblingName,shallow){var sibling,parent;if(node){if(!shallow&&node[startName])return node[startName];if(node!==this.rootNode){if(sibling=node[siblingName])return sibling;for(parent=node.parentNode;parent&&parent!==this.rootNode;parent=parent.parentNode)if(sibling=parent[siblingName])return sibling}}},TreeWalker.prototype.findPreviousNode=function(node,startName,siblingName,shallow){var sibling,parent,child;if(node){if(sibling=node[siblingName],this.rootNode&&sibling===this.rootNode)return;if(sibling){if(!shallow)for(child=sibling[startName];child;child=child[startName])if(!child[startName])return child;return sibling}if((parent=node.parentNode)&&parent!==this.rootNode)return parent}},TreeWalker}(),each$5=Tools.each,grep$1=Tools.grep,isIE=Env.ie,simpleSelectorRe=/^([a-z0-9],?)+$/i,whiteSpaceRegExp$2=/^[ \t\r\n]*$/,setupAttrHooks=function(styles,settings,getContext){var keepValues=settings.keep_values,keepUrlHook={set:function($elm,value,name){settings.url_converter&&(value=settings.url_converter.call(settings.url_converter_scope||getContext(),value,name,$elm[0])),$elm.attr("data-mce-"+name,value).attr(name,value)},get:function($elm,name){return $elm.attr("data-mce-"+name)||$elm.attr(name)}},attrHooks={style:{set:function($elm,value){if(null!==value&&"object"==typeof value)return void $elm.css(value);keepValues&&$elm.attr("data-mce-style",value),null!==value&&"string"==typeof value?($elm.removeAttr("style"),$elm.css(styles.parse(value))):$elm.attr("style",value)},get:function($elm){var value=$elm.attr("data-mce-style")||$elm.attr("style");return value=styles.serialize(styles.parse(value),$elm[0].nodeName)}}};return keepValues&&(attrHooks.href=attrHooks.src=keepUrlHook),attrHooks},updateInternalStyleAttr=function(styles,$elm){var rawValue=$elm.attr("style"),value=styles.serialize(styles.parse(rawValue),$elm[0].nodeName);value||(value=null),$elm.attr("data-mce-style",value)},findNodeIndex=function(node,normalized){var lastNodeType,nodeType,idx=0;if(node)for(lastNodeType=node.nodeType,node=node.previousSibling;node;node=node.previousSibling)nodeType=node.nodeType,(!normalized||3!==nodeType||nodeType!==lastNodeType&&node.nodeValue.length)&&(idx++,lastNodeType=nodeType);return idx};!function(DOMUtils){DOMUtils.DOM=DOMUtils(domGlobals.document),DOMUtils.nodeIndex=findNodeIndex}(DOMUtils||(DOMUtils={}));var DOMUtils$1=DOMUtils,DOM=DOMUtils$1.DOM,each$6=Tools.each,grep$2=Tools.grep,ScriptLoader=function(){function ScriptLoader(settings){void 0===settings&&(settings={}),this.states={},this.queue=[],this.scriptLoadedCallbacks={},this.queueLoadedCallbacks=[],this.loading=0,this.settings=settings}return ScriptLoader.prototype._setReferrerPolicy=function(referrerPolicy){this.settings.referrerPolicy=referrerPolicy},ScriptLoader.prototype.loadScript=function(url,success,failure){var elm,id,dom=DOM,done=function(){dom.remove(id),elm&&(elm.onreadystatechange=elm.onload=elm=null),success()},error=function(){isFunction(failure)?failure():void 0!==domGlobals.console&&domGlobals.console.log&&domGlobals.console.log("Failed to load script: "+url)};id=dom.uniqueId(),elm=domGlobals.document.createElement("script"),elm.id=id,elm.type="text/javascript",elm.src=Tools._addCacheSuffix(url),this.settings.referrerPolicy&&dom.setAttrib(elm,"referrerpolicy",this.settings.referrerPolicy),elm.onload=done,elm.onerror=error,(domGlobals.document.getElementsByTagName("head")[0]||domGlobals.document.body).appendChild(elm)},ScriptLoader.prototype.isDone=function(url){return 2===this.states[url]},ScriptLoader.prototype.markDone=function(url){this.states[url]=2},ScriptLoader.prototype.add=function(url,success,scope,failure){void 0===this.states[url]&&(this.queue.push(url),this.states[url]=0),success&&(this.scriptLoadedCallbacks[url]||(this.scriptLoadedCallbacks[url]=[]),this.scriptLoadedCallbacks[url].push({success:success,failure:failure,scope:scope||this}))},ScriptLoader.prototype.load=function(url,success,scope,failure){return this.add(url,success,scope,failure)},ScriptLoader.prototype.remove=function(url){delete this.states[url],delete this.scriptLoadedCallbacks[url]},ScriptLoader.prototype.loadQueue=function(success,scope,failure){this.loadScripts(this.queue,success,scope,failure)},ScriptLoader.prototype.loadScripts=function(scripts,success,scope,failure){var loadScripts,self=this,failures=[],execCallbacks=function(name,url){each$6(self.scriptLoadedCallbacks[url],function(callback){isFunction(callback[name])&&callback[name].call(callback.scope)}),self.scriptLoadedCallbacks[url]=void 0};self.queueLoadedCallbacks.push({success:success,failure:failure,scope:scope||this}),(loadScripts=function(){var loadingScripts=grep$2(scripts);if(scripts.length=0,each$6(loadingScripts,function(url){return 2===self.states[url]?void execCallbacks("success",url):3===self.states[url]?void execCallbacks("failure",url):void(1!==self.states[url]&&(self.states[url]=1,self.loading++,self.loadScript(url,function(){self.states[url]=2,self.loading--,execCallbacks("success",url),loadScripts()},function(){self.states[url]=3,self.loading--,failures.push(url),execCallbacks("failure",url),loadScripts()})))}),!self.loading){var notifyCallbacks=self.queueLoadedCallbacks.slice(0);self.queueLoadedCallbacks.length=0,each$6(notifyCallbacks,function(callback){0===failures.length?isFunction(callback.success)&&callback.success.call(callback.scope):isFunction(callback.failure)&&callback.failure.call(callback.scope,failures)})}})()},ScriptLoader.ScriptLoader=new ScriptLoader,ScriptLoader}(),isRaw=function(str){return isObject(str)&&has(str,"raw")},isTokenised=function(str){return isArray(str)&&str.length>1},data={},currentCode=Cell("en"),getLanguageData=function(){return get(data,currentCode.get())},getData=function(){return map$1(data,function(value){return __assign({},value)})},setCode=function(newCode){newCode&&currentCode.set(newCode)},getCode=function(){return currentCode.get()},add=function(code,items){var langData=data[code];langData||(data[code]=langData={}),each$1(items,function(translation,name){langData[name.toLowerCase()]=translation})},translate=function(text){var langData=getLanguageData().getOr({}),toString=function(obj){return isFunction(obj)?Object.prototype.toString.call(obj):isEmpty(obj)?"":""+obj},isEmpty=function(text){return""===text||null===text||void 0===text},getLangData=function(text){var textstr=toString(text);return get(langData,textstr.toLowerCase()).map(toString).getOr(textstr)},removeContext=function(str){return str.replace(/{context:\w+}$/,"")},translated=function(text){return text};if(isEmpty(text))return translated("");if(isRaw(text))return translated(toString(text.raw));if(isTokenised(text)){var values_1=text.slice(1);return translated(removeContext(getLangData(text[0]).replace(/\{([0-9]+)\}/g,function($1,$2){return has(values_1,$2)?toString(values_1[$2]):$1})))}return translated(removeContext(getLangData(text)))},isRtl=function(){return getLanguageData().bind(function(items){return get(items,"_dir")}).exists(function(dir){return"rtl"===dir})},hasCode=function(code){return has(data,code)},I18n={getData:getData,setCode:setCode,getCode:getCode,add:add,translate:translate,isRtl:isRtl,hasCode:hasCode};!function(AddOnManager){AddOnManager.PluginManager=AddOnManager(),AddOnManager.ThemeManager=AddOnManager()}(AddOnManager||(AddOnManager={}));var AddOnManager$1=AddOnManager,first=function(fn,rate){var timer=null;return{cancel:function(){null!==timer&&(domGlobals.clearTimeout(timer),timer=null)},throttle:function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];null===timer&&(timer=domGlobals.setTimeout(function(){fn.apply(null,args),timer=null},rate))}}},last$2=function(fn,rate){var timer=null;return{cancel:function(){null!==timer&&(domGlobals.clearTimeout(timer),timer=null)},throttle:function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];null!==timer&&domGlobals.clearTimeout(timer),timer=domGlobals.setTimeout(function(){fn.apply(null,args),timer=null},rate)}}},read=function(element,attr){var value=get$3(element,attr);return void 0===value||""===value?[]:value.split(" ")},add$1=function(element,attr,id){var old=read(element,attr),nu=old.concat([id]);return set(element,attr,nu.join(" ")),!0},remove$2=function(element,attr,id){var nu=filter(read(element,attr),function(v){return v!==id});return nu.length>0?set(element,attr,nu.join(" ")):remove$1(element,attr),!1},supports=function(element){return void 0!==element.dom().classList},get$5=function(element){return read(element,"class")},add$2=function(element,clazz){return add$1(element,"class",clazz)},remove$3=function(element,clazz){return remove$2(element,"class",clazz)},add$3=function(element,clazz){supports(element)?element.dom().classList.add(clazz):add$2(element,clazz)},cleanClass=function(element){0===(supports(element)?element.dom().classList:get$5(element)).length&&remove$1(element,"class")},remove$4=function(element,clazz){if(supports(element)){element.dom().classList.remove(clazz)}else remove$3(element,clazz);cleanClass(element)},has$2=function(element,clazz){return supports(element)&&element.dom().classList.contains(clazz)},descendants=function(scope,predicate){var result=[];return each(children(scope),function(x){predicate(x)&&(result=result.concat([x])),result=result.concat(descendants(x,predicate))}),result},descendants$1=function(scope,selector){return all(selector,scope)},ancestor=function(scope,predicate,isRoot){for(var element=scope.dom(),stop=isFunction(isRoot)?isRoot:constant(!1);element.parentNode;){element=element.parentNode;var el=Element.fromDom(element);if(predicate(el))return Option.some(el);if(stop(el))break}return Option.none()},closest=function(scope,predicate,isRoot){return ClosestOrAncestor(function(s,test){return test(s)},ancestor,scope,predicate,isRoot)},ancestor$1=function(scope,selector,isRoot){return ancestor(scope,function(e){return is(e,selector)},isRoot)},descendant=function(scope,selector){return one(selector,scope)},closest$1=function(scope,selector,isRoot){return ClosestOrAncestor(is,ancestor$1,scope,selector,isRoot)},annotation=constant("mce-annotation"),dataAnnotation=constant("data-mce-annotation"),dataAnnotationId=constant("data-mce-annotation-uid"),identify=function(editor,annotationName){var rng=editor.selection.getRng(),start=Element.fromDom(rng.startContainer),root=Element.fromDom(editor.getBody()),selector=annotationName.fold(function(){return"."+annotation()},function(an){return"["+dataAnnotation()+'="'+an+'"]'}),newStart=child(start,rng.startOffset).getOr(start),closest=closest$1(newStart,selector,function(n){return eq(n,root)}),getAttr=function(c,property){return has$1(c,property)?Option.some(get$3(c,property)):Option.none()};return closest.bind(function(c){return getAttr(c,""+dataAnnotationId()).bind(function(uid){return getAttr(c,""+dataAnnotation()).map(function(name){var elements=findMarkers(editor,uid);return{uid:uid,name:name,elements:elements}})})})},isAnnotation=function(elem){return isElement(elem)&&has$2(elem,annotation())},findMarkers=function(editor,uid){var body=Element.fromDom(editor.getBody());return descendants$1(body,"["+dataAnnotationId()+'="'+uid+'"]')},findAll=function(editor,name){var body=Element.fromDom(editor.getBody()),markers=descendants$1(body,"["+dataAnnotation()+'="'+name+'"]'),directory={};return each(markers,function(m){var uid=get$3(m,dataAnnotationId()),nodesAlready=directory.hasOwnProperty(uid)?directory[uid]:[];directory[uid]=nodesAlready.concat([m])}),directory},setup=function(editor,registry){var changeCallbacks=Cell({}),initData=function(){return{listeners:[],previous:Cell(Option.none())}},withCallbacks=function(name,f){updateCallbacks(name,function(data){return f(data),data})},updateCallbacks=function(name,f){var callbackMap=changeCallbacks.get(),data=callbackMap.hasOwnProperty(name)?callbackMap[name]:initData(),outputData=f(data);callbackMap[name]=outputData,changeCallbacks.set(callbackMap)},fireCallbacks=function(name,uid,elements){withCallbacks(name,function(data){each(data.listeners,function(f){return f(!0,name,{uid:uid,nodes:map(elements,function(elem){return elem.dom()})})})})},fireNoAnnotation=function(name){withCallbacks(name,function(data){each(data.listeners,function(f){return f(!1,name)})})},onNodeChange=last$2(function(){var callbackMap=changeCallbacks.get(),annotations=sort(keys(callbackMap));each(annotations,function(name){updateCallbacks(name,function(data){var prev=data.previous.get();return identify(editor,Option.some(name)).fold(function(){prev.isSome()&&(fireNoAnnotation(name),data.previous.set(Option.none()))},function(_a){var uid=_a.uid,name=_a.name,elements=_a.elements;prev.is(uid)||(fireCallbacks(name,uid,elements),data.previous.set(Option.some(uid)))}),{previous:data.previous,listeners:data.listeners}})})},30);return editor.on("remove",function(){onNodeChange.cancel()}),editor.on("NodeChange",function(){onNodeChange.throttle()}),{addListener:function(name,f){updateCallbacks(name,function(data){return{previous:data.previous,listeners:data.listeners.concat([f])}})}}},setup$1=function(editor,registry){var identifyParserNode=function(span){return Option.from(span.attr(dataAnnotation())).bind(registry.lookup)};editor.on("init",function(){editor.serializer.addNodeFilter("span",function(spans){each(spans,function(span){identifyParserNode(span).each(function(settings){!1===settings.persistent&&span.unwrap()})})})})},create$1=function(){var annotations={};return{register:function(name,settings){annotations[name]={name:name,settings:settings}},lookup:function(name){return annotations.hasOwnProperty(name)?Option.from(annotations[name]).map(function(a){return a.settings}):Option.none()}}},unique=0,generate=function(prefix){var date=new Date,time=date.getTime(),random=Math.floor(1e9*Math.random());return unique++,prefix+"_"+random+unique+String(time)},add$4=function(element,classes){each(classes,function(x){add$3(element,x)})},fromHtml$1=function(html,scope){var doc=scope||domGlobals.document,div=doc.createElement("div");return div.innerHTML=html,children(Element.fromDom(div))},get$6=function(element){return element.dom().innerHTML},set$1=function(element,content){var owner$1=owner(element),docDom=owner$1.dom(),fragment=Element.fromDom(docDom.createDocumentFragment()),contentElements=fromHtml$1(content,docDom);append$1(fragment,contentElements),empty(element),append(element,fragment)},clone=function(original,isDeep){return Element.fromDom(original.dom().cloneNode(isDeep))},shallow=function(original){return clone(original,!1)},deep=function(original){return clone(original,!0)},isZwsp=function(chr){return"\ufeff"===chr},trim$3=function(text){return text.replace(new RegExp("\ufeff","g"),"")},Zwsp={isZwsp:isZwsp,ZWSP:"\ufeff",trim:trim$3},isElement$2=NodeType.isElement,isText$2=NodeType.isText,isCaretContainerBlock=function(node){return isText$2(node)&&(node=node.parentNode),isElement$2(node)&&node.hasAttribute("data-mce-caret")},isCaretContainerInline=function(node){return isText$2(node)&&Zwsp.isZwsp(node.data)},isCaretContainer=function(node){return isCaretContainerBlock(node)||isCaretContainerInline(node)},hasContent=function(node){return node.firstChild!==node.lastChild||!NodeType.isBr(node.firstChild)},insertInline=function(node,before){var doc,sibling,textNode,parentNode;if(doc=node.ownerDocument,textNode=doc.createTextNode(Zwsp.ZWSP),parentNode=node.parentNode,before){if(sibling=node.previousSibling,isText$2(sibling)){if(isCaretContainer(sibling))return sibling;if(endsWithCaretContainer(sibling))return sibling.splitText(sibling.data.length-1)}parentNode.insertBefore(textNode,node)}else{if(sibling=node.nextSibling,isText$2(sibling)){if(isCaretContainer(sibling))return sibling;if(startsWithCaretContainer(sibling))return sibling.splitText(1),sibling}node.nextSibling?parentNode.insertBefore(textNode,node.nextSibling):parentNode.appendChild(textNode)}return textNode},isBeforeInline=function(pos){var container=pos.container();return!(!pos||!NodeType.isText(container))&&(container.data.charAt(pos.offset())===Zwsp.ZWSP||pos.isAtStart()&&isCaretContainerInline(container.previousSibling))},isAfterInline=function(pos){var container=pos.container();return!(!pos||!NodeType.isText(container))&&(container.data.charAt(pos.offset()-1)===Zwsp.ZWSP||pos.isAtEnd()&&isCaretContainerInline(container.nextSibling))},createBogusBr=function(){var br=domGlobals.document.createElement("br");return br.setAttribute("data-mce-bogus","1"),br},insertBlock=function(blockName,node,before){var doc,blockNode,parentNode;return doc=node.ownerDocument,blockNode=doc.createElement(blockName),blockNode.setAttribute("data-mce-caret",before?"before":"after"),blockNode.setAttribute("data-mce-bogus","all"),blockNode.appendChild(createBogusBr()),parentNode=node.parentNode,before?parentNode.insertBefore(blockNode,node):node.nextSibling?parentNode.insertBefore(blockNode,node.nextSibling):parentNode.appendChild(blockNode),blockNode},startsWithCaretContainer=function(node){return isText$2(node)&&node.data[0]===Zwsp.ZWSP},endsWithCaretContainer=function(node){return isText$2(node)&&node.data[node.data.length-1]===Zwsp.ZWSP},trimBogusBr=function(elm){var brs=elm.getElementsByTagName("br"),lastBr=brs[brs.length-1];NodeType.isBogus(lastBr)&&lastBr.parentNode.removeChild(lastBr)},showCaretContainerBlock=function(caretContainer){return caretContainer&&caretContainer.hasAttribute("data-mce-caret")?(trimBogusBr(caretContainer),caretContainer.removeAttribute("data-mce-caret"),caretContainer.removeAttribute("data-mce-bogus"),caretContainer.removeAttribute("style"),caretContainer.removeAttribute("_moz_abspos"),caretContainer):null},isRangeInCaretContainerBlock=function(range){return isCaretContainerBlock(range.startContainer)},isContentEditableTrue$1=NodeType.isContentEditableTrue,isContentEditableFalse$1=NodeType.isContentEditableFalse,isBr$2=NodeType.isBr,isText$3=NodeType.isText,isInvalidTextElement=NodeType.matchNodeNames(["script","style","textarea"]),isAtomicInline=NodeType.matchNodeNames(["img","input","textarea","hr","iframe","video","audio","object"]),isTable$2=NodeType.matchNodeNames(["table"]),isCaretContainer$1=isCaretContainer,isCaretCandidate=function(node){return!isCaretContainer$1(node)&&(isText$3(node)?!isInvalidTextElement(node.parentNode):isAtomicInline(node)||isBr$2(node)||isTable$2(node)||isNonUiContentEditableFalse(node))},isUnselectable=function(node){return NodeType.isElement(node)&&"true"===node.getAttribute("unselectable")},isNonUiContentEditableFalse=function(node){return!1===isUnselectable(node)&&isContentEditableFalse$1(node)},isInEditable=function(node,root){for(node=node.parentNode;node&&node!==root;node=node.parentNode){if(isNonUiContentEditableFalse(node))return!1;if(isContentEditableTrue$1(node))return!0}return!0},isAtomicContentEditableFalse=function(node){return!!isNonUiContentEditableFalse(node)&&!0!==foldl(from$1(node.getElementsByTagName("*")),function(result,elm){return result||isContentEditableTrue$1(elm)},!1)},isAtomic=function(node){return isAtomicInline(node)||isAtomicContentEditableFalse(node)},isEditableCaretCandidate=function(node,root){return isCaretCandidate(node)&&isInEditable(node,root)},round=Math.round,clone$1=function(rect){return rect?{left:round(rect.left),top:round(rect.top),bottom:round(rect.bottom),right:round(rect.right),width:round(rect.width),height:round(rect.height)}:{left:0,top:0,bottom:0,right:0,width:0,height:0}},collapse=function(rect,toStart){return rect=clone$1(rect),toStart?rect.right=rect.left:(rect.left=rect.left+rect.width,rect.right=rect.left),rect.width=0,rect},isEqual=function(rect1,rect2){return rect1.left===rect2.left&&rect1.top===rect2.top&&rect1.bottom===rect2.bottom&&rect1.right===rect2.right},isValidOverflow=function(overflowY,rect1,rect2){return overflowY>=0&&overflowY<=Math.min(rect1.height,rect2.height)/2},isAbove=function(rect1,rect2){return rect1.bottom-rect1.height/2<rect2.top||!(rect1.top>rect2.bottom)&&isValidOverflow(rect2.top-rect1.bottom,rect1,rect2)},isBelow=function(rect1,rect2){return rect1.top>rect2.bottom||!(rect1.bottom<rect2.top)&&isValidOverflow(rect2.bottom-rect1.top,rect1,rect2)},containsXY=function(rect,clientX,clientY){return clientX>=rect.left&&clientX<=rect.right&&clientY>=rect.top&&clientY<=rect.bottom},getSelectedNode=function(range){var startContainer=range.startContainer,startOffset=range.startOffset;return startContainer.hasChildNodes()&&range.endOffset===startOffset+1?startContainer.childNodes[startOffset]:null},getNode=function(container,offset){return 1===container.nodeType&&container.hasChildNodes()&&(offset>=container.childNodes.length&&(offset=container.childNodes.length-1),container=container.childNodes[offset]),container},extendingChars=new RegExp("[̀-ͯ҃-҇҈-҉֑-ֽֿׁ-ׂׄ-ׇׅؐ-ًؚ-ٰٟۖ-ۜ۟-ۤۧ-۪ۨ-ܑۭܰ-݊ަ-ް߫-߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࣣ-ंऺ़ु-ै्॑-ॗॢ-ॣঁ়াু-ৄ্ৗৢ-ৣਁ-ਂ਼ੁ-ੂੇ-ੈੋ-੍ੑੰ-ੱੵઁ-ં઼ુ-ૅે-ૈ્ૢ-ૣଁ଼ାିୁ-ୄ୍ୖୗୢ-ୣஂாீ்ௗఀా-ీె-ైొ-్ౕ-ౖౢ-ౣಁ಼ಿೂೆೌ-್ೕ-ೖೢ-ೣഁാു-ൄ്ൗൢ-ൣ්ාි-ුූෟัิ-ฺ็-๎ັິ-ູົ-ຼ່-ໍ༘-ཱ༹༙༵༷-ཾྀ-྄྆-྇ྍ-ྗྙ-ྼ࿆ိ-ူဲ-့္-်ွ-ှၘ-ၙၞ-ၠၱ-ၴႂႅ-ႆႍႝ፝-፟ᜒ-᜔ᜲ-᜴ᝒ-ᝓᝲ-ᝳ឴-឵ិ-ួំ៉-៓៝᠋-᠍ᢩᤠ-ᤢᤧ-ᤨᤲ᤹-᤻ᨗ-ᨘᨛᩖᩘ-ᩞ᩠ᩢᩥ-ᩬᩳ-᩿᩼᪰-᪽᪾ᬀ-ᬃ᬴ᬶ-ᬺᬼᭂ᭫-᭳ᮀ-ᮁᮢ-ᮥᮨ-ᮩ᮫-ᮭ᯦ᯨ-ᯩᯭᯯ-ᯱᰬ-ᰳᰶ-᰷᳐-᳔᳒-᳢᳠-᳨᳭᳴᳸-᳹᷀-᷵᷼-᷿‌-‍⃐-⃜⃝-⃠⃡⃢-⃤⃥-⃰⳯-⵿⳱ⷠ-〪ⷿ-〭〮-゙〯-゚꙯꙰-꙲ꙴ-꙽ꚞ-ꚟ꛰-꛱ꠂ꠆ꠋꠥ-ꠦ꣄꣠-꣱ꤦ-꤭ꥇ-ꥑꦀ-ꦂ꦳ꦶ-ꦹꦼꧥꨩ-ꨮꨱ-ꨲꨵ-ꨶꩃꩌꩼꪰꪲ-ꪴꪷ-ꪸꪾ-꪿꫁ꫬ-ꫭ꫶ꯥꯨ꯭ﬞ︀-️︠-︯ﾞ-ﾟ]"),isExtendingChar=function(ch){return"string"==typeof ch&&ch.charCodeAt(0)>=768&&extendingChars.test(ch)},lift2=function(oa,ob,f){return oa.isSome()&&ob.isSome()?Option.some(f(oa.getOrDie(),ob.getOrDie())):Option.none()},lift3=function(oa,ob,oc,f){return oa.isSome()&&ob.isSome()&&oc.isSome()?Option.some(f(oa.getOrDie(),ob.getOrDie(),oc.getOrDie())):Option.none()},someIf=function(b,a){return b?Option.some(a):Option.none()},slice$2=[].slice,or=function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i];var args=slice$2.call(arguments);return function(x){for(var i=0;i<args.length;i++)if(args[i](x))return!0;return!1}},and=function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i];var args=slice$2.call(arguments);return function(x){for(var i=0;i<args.length;i++)if(!args[i](x))return!1;return!0}},Predicate={and:and,or:or},isElement$3=NodeType.isElement,isCaretCandidate$1=isCaretCandidate,isBlock$1=NodeType.matchStyleValues("display","block table"),isFloated=NodeType.matchStyleValues("float","left right"),isValidElementCaretCandidate=Predicate.and(isElement$3,isCaretCandidate$1,not(isFloated)),isNotPre=not(NodeType.matchStyleValues("white-space","pre pre-line pre-wrap")),isText$4=NodeType.isText,isBr$3=NodeType.isBr,nodeIndex=DOMUtils$1.nodeIndex,resolveIndex=getNode,createRange=function(doc){return"createRange"in doc?doc.createRange():DOMUtils$1.DOM.createRng()},isWhiteSpace=function(chr){return chr&&/[\r\n\t ]/.test(chr)},isRange=function(rng){return!!rng.setStart&&!!rng.setEnd},isHiddenWhiteSpaceRange=function(range){var text,container=range.startContainer,offset=range.startOffset;return!!(isWhiteSpace(range.toString())&&isNotPre(container.parentNode)&&NodeType.isText(container)&&(text=container.data,isWhiteSpace(text[offset-1])||isWhiteSpace(text[offset+1])))},getBrClientRect=function(brNode){var clientRect,doc=brNode.ownerDocument,rng=createRange(doc),nbsp$1=doc.createTextNode(" "),parentNode=brNode.parentNode;return parentNode.insertBefore(nbsp$1,brNode),rng.setStart(nbsp$1,0),rng.setEnd(nbsp$1,1),clientRect=clone$1(rng.getBoundingClientRect()),parentNode.removeChild(nbsp$1),clientRect},getBoundingClientRectWebKitText=function(rng){var sc=rng.startContainer,ec=rng.endContainer,so=rng.startOffset,eo=rng.endOffset;if(sc===ec&&NodeType.isText(ec)&&0===so&&1===eo){var newRng=rng.cloneRange();return newRng.setEndAfter(ec),getBoundingClientRect(newRng)}return null},isZeroRect=function(r){return 0===r.left&&0===r.right&&0===r.top&&0===r.bottom},getBoundingClientRect=function(item){var clientRect,clientRects;return clientRects=item.getClientRects(),clientRect=clone$1(clientRects.length>0?clientRects[0]:item.getBoundingClientRect()),!isRange(item)&&isBr$3(item)&&isZeroRect(clientRect)?getBrClientRect(item):isZeroRect(clientRect)&&isRange(item)?getBoundingClientRectWebKitText(item):clientRect},collapseAndInflateWidth=function(clientRect,toStart){var newClientRect=collapse(clientRect,toStart);return newClientRect.width=1,newClientRect.right=newClientRect.left+1,newClientRect},getCaretPositionClientRects=function(caretPosition){var beforeNode,node,clientRects=[],addUniqueAndValidRect=function(clientRect){0!==clientRect.height&&(clientRects.length>0&&isEqual(clientRect,clientRects[clientRects.length-1])||clientRects.push(clientRect))},addCharacterOffset=function(container,offset){var range=createRange(container.ownerDocument);if(offset<container.data.length){if(isExtendingChar(container.data[offset]))return clientRects;if(isExtendingChar(container.data[offset-1])&&(range.setStart(container,offset),range.setEnd(container,offset+1),!isHiddenWhiteSpaceRange(range)))return addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(range),!1)),clientRects}offset>0&&(range.setStart(container,offset-1),range.setEnd(container,offset),isHiddenWhiteSpaceRange(range)||addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(range),!1))),offset<container.data.length&&(range.setStart(container,offset),range.setEnd(container,offset+1),isHiddenWhiteSpaceRange(range)||addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(range),!0)))};if(isText$4(caretPosition.container()))return addCharacterOffset(caretPosition.container(),caretPosition.offset()),clientRects;if(isElement$3(caretPosition.container()))if(caretPosition.isAtEnd())node=resolveIndex(caretPosition.container(),caretPosition.offset()),isText$4(node)&&addCharacterOffset(node,node.data.length),isValidElementCaretCandidate(node)&&!isBr$3(node)&&addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(node),!1));else{if(node=resolveIndex(caretPosition.container(),caretPosition.offset()),isText$4(node)&&addCharacterOffset(node,0),isValidElementCaretCandidate(node)&&caretPosition.isAtEnd())return addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(node),!1)),clientRects;beforeNode=resolveIndex(caretPosition.container(),caretPosition.offset()-1),isValidElementCaretCandidate(beforeNode)&&!isBr$3(beforeNode)&&(isBlock$1(beforeNode)||isBlock$1(node)||!isValidElementCaretCandidate(node))&&addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(beforeNode),!1)),isValidElementCaretCandidate(node)&&addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(node),!0))}return clientRects};!function(CaretPosition){CaretPosition.fromRangeStart=function(range){return CaretPosition(range.startContainer,range.startOffset)},CaretPosition.fromRangeEnd=function(range){return CaretPosition(range.endContainer,range.endOffset)},CaretPosition.after=function(node){return CaretPosition(node.parentNode,nodeIndex(node)+1)},CaretPosition.before=function(node){return CaretPosition(node.parentNode,nodeIndex(node))},CaretPosition.isAbove=function(pos1,pos2){return lift2(head(pos2.getClientRects()),last(pos1.getClientRects()),isAbove).getOr(!1)},CaretPosition.isBelow=function(pos1,pos2){return lift2(last(pos2.getClientRects()),head(pos1.getClientRects()),isBelow).getOr(!1)},CaretPosition.isAtStart=function(pos){return!!pos&&pos.isAtStart()},CaretPosition.isAtEnd=function(pos){return!!pos&&pos.isAtEnd()},CaretPosition.isTextPosition=function(pos){return!!pos&&NodeType.isText(pos.container())},CaretPosition.isElementPosition=function(pos){return!1===CaretPosition.isTextPosition(pos)}}(CaretPosition||(CaretPosition={}));var HDirection,CaretPosition$1=CaretPosition,isText$5=NodeType.isText,isBogus$1=NodeType.isBogus,nodeIndex$1=DOMUtils$1.nodeIndex,normalizedParent=function(node){var parentNode=node.parentNode;return isBogus$1(parentNode)?normalizedParent(parentNode):parentNode},getChildNodes=function(node){return node?ArrUtils.reduce(node.childNodes,function(result,node){return isBogus$1(node)&&"BR"!==node.nodeName?result=result.concat(getChildNodes(node)):result.push(node),result},[]):[]},normalizedTextOffset=function(node,offset){for(;(node=node.previousSibling)&&isText$5(node);)offset+=node.data.length;return offset},equal=function(a){return function(b){return a===b}},normalizedNodeIndex=function(node){var nodes,index,numTextFragments;return nodes=getChildNodes(normalizedParent(node)),index=ArrUtils.findIndex(nodes,equal(node),node),nodes=nodes.slice(0,index+1),numTextFragments=ArrUtils.reduce(nodes,function(result,node,i){return isText$5(node)&&isText$5(nodes[i-1])&&result++,result},0),nodes=ArrUtils.filter(nodes,NodeType.matchNodeNames([node.nodeName])),(index=ArrUtils.findIndex(nodes,equal(node),node))-numTextFragments},createPathItem=function(node){return(isText$5(node)?"text()":node.nodeName.toLowerCase())+"["+normalizedNodeIndex(node)+"]"},parentsUntil=function(root,node,predicate){var parents=[];for(node=node.parentNode;node!==root&&(!predicate||!predicate(node));node=node.parentNode)parents.push(node);return parents},create$2=function(root,caretPosition){var container,offset,outputOffset,childNodes,parents,path=[];return container=caretPosition.container(),offset=caretPosition.offset(),isText$5(container)?outputOffset=normalizedTextOffset(container,offset):(childNodes=container.childNodes,offset>=childNodes.length?(outputOffset="after",offset=childNodes.length-1):outputOffset="before",container=childNodes[offset]),path.push(createPathItem(container)),parents=parentsUntil(root,container),parents=ArrUtils.filter(parents,not(NodeType.isBogus)),path=path.concat(ArrUtils.map(parents,function(node){return createPathItem(node)})),path.reverse().join("/")+","+outputOffset},resolvePathItem=function(node,name,index){var nodes=getChildNodes(node);return nodes=ArrUtils.filter(nodes,function(node,index){return!isText$5(node)||!isText$5(nodes[index-1])}),nodes=ArrUtils.filter(nodes,NodeType.matchNodeNames([name])),nodes[index]},findTextPosition=function(container,offset){for(var dataLen,node=container,targetOffset=0;isText$5(node);){if(dataLen=node.data.length,offset>=targetOffset&&offset<=targetOffset+dataLen){container=node,offset-=targetOffset;break}if(!isText$5(node.nextSibling)){container=node,offset=dataLen;break}targetOffset+=dataLen,node=node.nextSibling}return isText$5(container)&&offset>container.data.length&&(offset=container.data.length),CaretPosition$1(container,offset)},resolve$1=function(root,path){var parts,container,offset;return path?(parts=path.split(","),path=parts[0].split("/"),offset=parts.length>1?parts[1]:"before",container=ArrUtils.reduce(path,function(result,value){return(value=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(value))?("text()"===value[1]&&(value[1]="#text"),resolvePathItem(result,value[1],parseInt(value[2],10))):null},root),container?isText$5(container)?findTextPosition(container,parseInt(offset,10)):(offset="after"===offset?nodeIndex$1(container)+1:nodeIndex$1(container),CaretPosition$1(container.parentNode,offset)):null):null},trimEmptyTextNode=function(dom,node){NodeType.isText(node)&&0===node.data.length&&dom.remove(node)},insertNode=function(dom,rng,node){rng.insertNode(node),trimEmptyTextNode(dom,node.previousSibling),trimEmptyTextNode(dom,node.nextSibling)},insertFragment=function(dom,rng,frag){var firstChild=Option.from(frag.firstChild),lastChild=Option.from(frag.lastChild);rng.insertNode(frag),firstChild.each(function(child){return trimEmptyTextNode(dom,child.previousSibling)}),lastChild.each(function(child){return trimEmptyTextNode(dom,child.nextSibling)})},rangeInsertNode=function(dom,rng,node){NodeType.isDocumentFragment(node)?insertFragment(dom,rng,node):insertNode(dom,rng,node)},isContentEditableFalse$2=NodeType.isContentEditableFalse,getNormalizedTextOffset=function(trim,container,offset){var node,trimmedOffset;for(trimmedOffset=trim(container.data.slice(0,offset)).length,node=container.previousSibling;node&&NodeType.isText(node);node=node.previousSibling)trimmedOffset+=trim(node.data).length;return trimmedOffset},getPoint=function(dom,trim,normalized,rng,start){var childNodes,container=rng[start?"startContainer":"endContainer"],offset=rng[start?"startOffset":"endOffset"],point=[],after=0,root=dom.getRoot();for(NodeType.isText(container)?point.push(normalized?getNormalizedTextOffset(trim,container,offset):offset):(childNodes=container.childNodes,offset>=childNodes.length&&childNodes.length&&(after=1,offset=Math.max(0,childNodes.length-1)),point.push(dom.nodeIndex(childNodes[offset],normalized)+after));container&&container!==root;container=container.parentNode)point.push(dom.nodeIndex(container,normalized));return point},getLocation=function(trim,selection,normalized,rng){var dom=selection.dom,bookmark={};return bookmark.start=getPoint(dom,trim,normalized,rng,!0),selection.isCollapsed()||(bookmark.end=getPoint(dom,trim,normalized,rng,!1)),bookmark},findIndex$2=function(dom,name,element){var count=0;return Tools.each(dom.select(name),function(node){if("all"!==node.getAttribute("data-mce-bogus"))return node!==element&&void count++}),count},moveEndPoint=function(rng,start){var container,offset,childNodes,prefix=start?"start":"end";container=rng[prefix+"Container"],offset=rng[prefix+"Offset"],NodeType.isElement(container)&&"TR"===container.nodeName&&(childNodes=container.childNodes,(container=childNodes[Math.min(start?offset:offset-1,childNodes.length-1)])&&(offset=start?0:container.childNodes.length,rng["set"+(start?"Start":"End")](container,offset)))},normalizeTableCellSelection=function(rng){return moveEndPoint(rng,!0),moveEndPoint(rng,!1),rng},findSibling=function(node,offset){var sibling;if(NodeType.isElement(node)&&(node=getNode(node,offset),isContentEditableFalse$2(node)))return node;if(isCaretContainer(node)){if(NodeType.isText(node)&&isCaretContainerBlock(node)&&(node=node.parentNode),sibling=node.previousSibling,isContentEditableFalse$2(sibling))return sibling;if(sibling=node.nextSibling,isContentEditableFalse$2(sibling))return sibling}},findAdjacentContentEditableFalseElm=function(rng){return findSibling(rng.startContainer,rng.startOffset)||findSibling(rng.endContainer,rng.endOffset)},getOffsetBookmark=function(trim,normalized,selection){var element=selection.getNode(),name=element?element.nodeName:null,rng=selection.getRng();if(isContentEditableFalse$2(element)||"IMG"===name)return{name:name,index:findIndex$2(selection.dom,name,element)};var sibling=findAdjacentContentEditableFalseElm(rng);return sibling?(name=sibling.tagName,{name:name,index:findIndex$2(selection.dom,name,sibling)}):getLocation(trim,selection,normalized,rng)},getCaretBookmark=function(selection){var rng=selection.getRng();return{start:create$2(selection.dom.getRoot(),CaretPosition$1.fromRangeStart(rng)),end:create$2(selection.dom.getRoot(),CaretPosition$1.fromRangeEnd(rng))}},getRangeBookmark=function(selection){return{rng:selection.getRng()}},createBookmarkSpan=function(dom,id,filled){var args={"data-mce-type":"bookmark",id:id,style:"overflow:hidden;line-height:0px"};return filled?dom.create("span",args,"&#xFEFF;"):dom.create("span",args)},getPersistentBookmark=function(selection,filled){var dom=selection.dom,rng=selection.getRng(),id=dom.uniqueId(),collapsed=selection.isCollapsed(),element=selection.getNode(),name=element.nodeName;if("IMG"===name)return{name:name,index:findIndex$2(dom,name,element)};var rng2=normalizeTableCellSelection(rng.cloneRange());if(!collapsed){rng2.collapse(!1);var endBookmarkNode=createBookmarkSpan(dom,id+"_end",filled);rangeInsertNode(dom,rng2,endBookmarkNode)}rng=normalizeTableCellSelection(rng),rng.collapse(!0);var startBookmarkNode=createBookmarkSpan(dom,id+"_start",filled);return rangeInsertNode(dom,rng,startBookmarkNode),selection.moveToBookmark({id:id,keep:1}),{id:id}},getBookmark=function(selection,type,normalized){return 2===type?getOffsetBookmark(Zwsp.trim,normalized,selection):3===type?getCaretBookmark(selection):type?getRangeBookmark(selection):getPersistentBookmark(selection,!1)},GetBookmark={getBookmark:getBookmark,getUndoBookmark:curry(getOffsetBookmark,identity,!0),getPersistentBookmark:getPersistentBookmark},TextWalker=function(startNode,rootNode,isBoundary){void 0===isBoundary&&(isBoundary=never);var walker=new TreeWalker(startNode,rootNode),walk=function(direction){var next;do{next=walker[direction]()}while(next&&!NodeType.isText(next)&&!isBoundary(next));return Option.from(next).filter(NodeType.isText)};return{current:function(){return Option.from(walker.current()).filter(NodeType.isText)},next:function(){return walk("next")},prev:function(){return walk("prev")},prev2:function(){return walk("prev2")}}},TextSeeker=function(dom,isBoundary){var isBlockBoundary=isBoundary||function(node){return dom.isBlock(node)||NodeType.isBr(node)||NodeType.isContentEditableFalse(node)},walk=function(node,offset,walker,process){if(NodeType.isText(node)){var newOffset=process(node,offset,node.data);if(-1!==newOffset)return Option.some({container:node,offset:newOffset})}return walker().bind(function(next){return walk(next.container,next.offset,walker,process)})};return{backwards:function(node,offset,process,root){var walker=TextWalker(node,root,isBlockBoundary);return walk(node,offset,function(){return walker.prev().map(function(prev){return{container:prev,offset:prev.length}})},process).getOrNull()},forwards:function(node,offset,process,root){var walker=TextWalker(node,root,isBlockBoundary);return walk(node,offset,function(){return walker.next().map(function(next){return{container:next,offset:0}})},process).getOrNull()}}},isCaretNode=function(node){return NodeType.isElement(node)&&"_mce_caret"===node.id},getParentCaretContainer=function(body,node){for(;node&&node!==body;){if("_mce_caret"===node.id)return node;node=node.parentNode}return null},isElement$4=NodeType.isElement,isText$6=NodeType.isText,removeNode=function(node){var parentNode=node.parentNode;parentNode&&parentNode.removeChild(node)},getNodeValue=function(node){try{return node.nodeValue}catch(ex){return""}},setNodeValue=function(node,text){0===text.length?removeNode(node):node.nodeValue=text},trimCount=function(text){var trimmedText=Zwsp.trim(text);return{count:text.length-trimmedText.length,text:trimmedText}},removeUnchanged=function(caretContainer,pos){return remove$5(caretContainer),pos},removeTextAndReposition=function(caretContainer,pos){var before=trimCount(caretContainer.data.substr(0,pos.offset())),after=trimCount(caretContainer.data.substr(pos.offset())),text=before.text+after.text;return text.length>0?(setNodeValue(caretContainer,text),CaretPosition$1(caretContainer,pos.offset()-before.count)):pos},removeElementAndReposition=function(caretContainer,pos){var parentNode=pos.container(),newPosition=indexOf(from$1(parentNode.childNodes),caretContainer).map(function(index){return index<pos.offset()?CaretPosition$1(parentNode,pos.offset()-1):pos}).getOr(pos);return remove$5(caretContainer),newPosition},removeTextCaretContainer=function(caretContainer,pos){return isText$6(caretContainer)&&pos.container()===caretContainer?removeTextAndReposition(caretContainer,pos):removeUnchanged(caretContainer,pos)},removeElementCaretContainer=function(caretContainer,pos){return pos.container()===caretContainer.parentNode?removeElementAndReposition(caretContainer,pos):removeUnchanged(caretContainer,pos)},removeAndReposition=function(container,pos){return CaretPosition$1.isTextPosition(pos)?removeTextCaretContainer(container,pos):removeElementCaretContainer(container,pos)},remove$5=function(caretContainerNode){if(isElement$4(caretContainerNode)&&isCaretContainer(caretContainerNode)&&(hasContent(caretContainerNode)?caretContainerNode.removeAttribute("data-mce-caret"):removeNode(caretContainerNode)),isText$6(caretContainerNode)){var text=Zwsp.trim(getNodeValue(caretContainerNode));setNodeValue(caretContainerNode,text)}},CaretContainerRemove={removeAndReposition:removeAndReposition,remove:remove$5},DOM$1=DOMUtils$1.DOM,getBodySetting=function(editor,name,defaultValue){var value=editor.getParam(name,defaultValue);if(-1!==value.indexOf("=")){var bodyObj=editor.getParam(name,"","hash");return bodyObj.hasOwnProperty(editor.id)?bodyObj[editor.id]:defaultValue}return value},getIframeAttrs=function(editor){return editor.getParam("iframe_attrs",{})},getDocType=function(editor){return editor.getParam("doctype","<!DOCTYPE html>")},getDocumentBaseUrl=function(editor){return editor.getParam("document_base_url","")},getBodyId=function(editor){return getBodySetting(editor,"body_id","tinymce")},getBodyClass=function(editor){return getBodySetting(editor,"body_class","")},getContentSecurityPolicy=function(editor){return editor.getParam("content_security_policy","")},shouldPutBrInPre=function(editor){return editor.getParam("br_in_pre",!0)},getForcedRootBlock=function(editor){if(editor.getParam("force_p_newlines",!1))return"p";var block=editor.getParam("forced_root_block","p");return!1===block?"":!0===block?"p":block},getForcedRootBlockAttrs=function(editor){return editor.getParam("forced_root_block_attrs",{})},getBrNewLineSelector=function(editor){return editor.getParam("br_newline_selector",".mce-toc h2,figcaption,caption")},getNoNewLineSelector=function(editor){return editor.getParam("no_newline_selector","")},shouldKeepStyles=function(editor){return editor.getParam("keep_styles",!0)},shouldEndContainerOnEmptyBlock=function(editor){return editor.getParam("end_container_on_empty_block",!1)},getFontStyleValues=function(editor){return Tools.explode(editor.getParam("font_size_style_values","xx-small,x-small,small,medium,large,x-large,xx-large"))},getFontSizeClasses=function(editor){return Tools.explode(editor.getParam("font_size_classes",""))},getImagesDataImgFilter=function(editor){return editor.getParam("images_dataimg_filter",constant(!0),"function")},isAutomaticUploadsEnabled=function(editor){return editor.getParam("automatic_uploads",!0,"boolean")},shouldReuseFileName=function(editor){return editor.getParam("images_reuse_filename",!1,"boolean")},shouldReplaceBlobUris=function(editor){return editor.getParam("images_replace_blob_uris",!0,"boolean")},getIconPackName=function(editor){return editor.getParam("icons","","string")},getIconsUrl=function(editor){return editor.getParam("icons_url","","string")},getImageUploadUrl=function(editor){return editor.getParam("images_upload_url","","string")},getImageUploadBasePath=function(editor){return editor.getParam("images_upload_base_path","","string")},getImagesUploadCredentials=function(editor){return editor.getParam("images_upload_credentials",!1,"boolean")},getImagesUploadHandler=function(editor){return editor.getParam("images_upload_handler",null,"function")},shouldUseContentCssCors=function(editor){return editor.getParam("content_css_cors",!1,"boolean")},getReferrerPolicy=function(editor){return editor.getParam("referrer_policy","","string")},getLanguageCode=function(editor){return editor.getParam("language","en","string")},getLanguageUrl=function(editor){return editor.getParam("language_url","","string")},shouldIndentUseMargin=function(editor){return editor.getParam("indent_use_margin",!1)},getIndentation=function(editor){return editor.getParam("indentation","40px","string")},getContentCss=function(editor){var contentCss=editor.settings.content_css;return isString(contentCss)?map(contentCss.split(","),trim):isArray(contentCss)?contentCss:!1===contentCss||editor.inline?[]:["default"]},getDirectionality=function(editor){return editor.getParam("directionality",I18n.isRtl()?"rtl":void 0)},getInlineBoundarySelector=function(editor){return editor.getParam("inline_boundaries_selector","a[href],code,.mce-annotation","string")},getObjectResizing=function(editor){return editor.getParam("object_resizing")},getResizeImgProportional=function(editor){return editor.getParam("resize_img_proportional",!0,"boolean")},getPlaceholder=function(editor){return editor.getParam("placeholder",DOM$1.getAttrib(editor.getElement(),"placeholder"),"string")},Settings={getIframeAttrs:getIframeAttrs,getDocType:getDocType,getDocumentBaseUrl:getDocumentBaseUrl,getBodyId:getBodyId,getBodyClass:getBodyClass,getContentSecurityPolicy:getContentSecurityPolicy,shouldPutBrInPre:shouldPutBrInPre,getForcedRootBlock:getForcedRootBlock,getForcedRootBlockAttrs:getForcedRootBlockAttrs,getBrNewLineSelector:getBrNewLineSelector,getNoNewLineSelector:getNoNewLineSelector,shouldKeepStyles:shouldKeepStyles,shouldEndContainerOnEmptyBlock:shouldEndContainerOnEmptyBlock,getFontStyleValues:getFontStyleValues,getFontSizeClasses:getFontSizeClasses,getIconPackName:getIconPackName,getIconsUrl:getIconsUrl,getImagesDataImgFilter:getImagesDataImgFilter,isAutomaticUploadsEnabled:isAutomaticUploadsEnabled,shouldReuseFileName:shouldReuseFileName,shouldReplaceBlobUris:shouldReplaceBlobUris,getImageUploadUrl:getImageUploadUrl,getImageUploadBasePath:getImageUploadBasePath,getImagesUploadCredentials:getImagesUploadCredentials,getImagesUploadHandler:getImagesUploadHandler,shouldUseContentCssCors:shouldUseContentCssCors,getReferrerPolicy:getReferrerPolicy,getLanguageCode:getLanguageCode,getLanguageUrl:getLanguageUrl,shouldIndentUseMargin:shouldIndentUseMargin,getIndentation:getIndentation,getContentCss:getContentCss,getDirectionality:getDirectionality,getInlineBoundarySelector:getInlineBoundarySelector,getObjectResizing:getObjectResizing,getResizeImgProportional:getResizeImgProportional,getPlaceholder:getPlaceholder},browser$3=detect$3().browser,isContentEditableFalse$3=NodeType.isContentEditableFalse,isTableCell$1=function(node){return NodeType.isElement(node)&&/^(TD|TH)$/i.test(node.tagName)},getAbsoluteClientRect=function(root,element,before){var docElm,scrollX,scrollY,margin,rootRect,clientRect=collapse(element.getBoundingClientRect(),before);return"BODY"===root.tagName?(docElm=root.ownerDocument.documentElement,scrollX=root.scrollLeft||docElm.scrollLeft,scrollY=root.scrollTop||docElm.scrollTop):(rootRect=root.getBoundingClientRect(),scrollX=root.scrollLeft-rootRect.left,scrollY=root.scrollTop-rootRect.top),clientRect.left+=scrollX,clientRect.right+=scrollX,clientRect.top+=scrollY,clientRect.bottom+=scrollY,clientRect.width=1,margin=element.offsetWidth-element.clientWidth,margin>0&&(before&&(margin*=-1),clientRect.left+=margin,clientRect.right+=margin),clientRect},trimInlineCaretContainers=function(root){var contentEditableFalseNodes,node,sibling,i,data;for(contentEditableFalseNodes=DomQuery("*[contentEditable=false]",root),i=0;i<contentEditableFalseNodes.length;i++)node=contentEditableFalseNodes[i],sibling=node.previousSibling,endsWithCaretContainer(sibling)&&(data=sibling.data,1===data.length?sibling.parentNode.removeChild(sibling):sibling.deleteData(data.length-1,1)),sibling=node.nextSibling,startsWithCaretContainer(sibling)&&(data=sibling.data,1===data.length?sibling.parentNode.removeChild(sibling):sibling.deleteData(0,1))},FakeCaret=function(editor,root,isBlock,hasFocus){var cursorInterval,caretContainerNode,lastVisualCaret=Cell(Option.none()),rootBlock=Settings.getForcedRootBlock(editor),caretBlock=rootBlock.length>0?rootBlock:"p",show=function(before,element){var clientRect,rng;if(hide(),isTableCell$1(element))return null;if(!isBlock(element))return caretContainerNode=insertInline(element,before),rng=element.ownerDocument.createRange(),isContentEditableFalse$3(caretContainerNode.nextSibling)?(rng.setStart(caretContainerNode,0),rng.setEnd(caretContainerNode,0)):(rng.setStart(caretContainerNode,1),rng.setEnd(caretContainerNode,1)),rng;caretContainerNode=insertBlock(caretBlock,element,before),clientRect=getAbsoluteClientRect(root,element,before),DomQuery(caretContainerNode).css("top",clientRect.top);var caret=DomQuery('<div class="mce-visual-caret" data-mce-bogus="all"></div>').css(clientRect).appendTo(root)[0];return lastVisualCaret.set(Option.some({caret:caret,element:element,before:before})),lastVisualCaret.get().each(function(caretState){before&&DomQuery(caretState.caret).addClass("mce-visual-caret-before")}),startBlink(),rng=element.ownerDocument.createRange(),rng.setStart(caretContainerNode,0),rng.setEnd(caretContainerNode,0),rng},hide=function(){trimInlineCaretContainers(root),caretContainerNode&&(CaretContainerRemove.remove(caretContainerNode),caretContainerNode=null),lastVisualCaret.get().each(function(caretState){DomQuery(caretState.caret).remove(),lastVisualCaret.set(Option.none())}),Delay.clearInterval(cursorInterval)},startBlink=function(){cursorInterval=Delay.setInterval(function(){hasFocus()?DomQuery("div.mce-visual-caret",root).toggleClass("mce-visual-caret-hidden"):DomQuery("div.mce-visual-caret",root).addClass("mce-visual-caret-hidden")},500)},reposition=function(){lastVisualCaret.get().each(function(caretState){var clientRect=getAbsoluteClientRect(root,caretState.element,caretState.before);DomQuery(caretState.caret).css(__assign({},clientRect))})},destroy=function(){return Delay.clearInterval(cursorInterval)};return{show:show,hide:hide,getCss:function(){return".mce-visual-caret {position: absolute;background-color: black;background-color: currentcolor;}.mce-visual-caret-hidden {display: none;}*[data-mce-caret] {position: absolute;left: -1000px;right: auto;top: 0;margin: 0;padding: 0;}"},reposition:reposition,destroy:destroy}},isFakeCaretTableBrowser=function(){return browser$3.isIE()||browser$3.isEdge()||browser$3.isFirefox()},isFakeCaretTarget=function(node){return isContentEditableFalse$3(node)||NodeType.isTable(node)&&isFakeCaretTableBrowser()},isContentEditableFalse$4=NodeType.isContentEditableFalse,isBlockLike=NodeType.matchStyleValues("display","block table table-cell table-caption list-item"),isCaretContainer$2=isCaretContainer,isCaretContainerBlock$1=isCaretContainerBlock,isElement$5=NodeType.isElement,isCaretCandidate$2=isCaretCandidate,isForwards=function(direction){return direction>0},isBackwards=function(direction){return direction<0},skipCaretContainers=function(walk,shallow){for(var node;node=walk(shallow);)if(!isCaretContainerBlock$1(node))return node;return null},findNode=function(node,direction,predicateFn,rootNode,shallow){var walker=new TreeWalker(node,rootNode);if(isBackwards(direction)){if((isContentEditableFalse$4(node)||isCaretContainerBlock$1(node))&&(node=skipCaretContainers(walker.prev,!0),predicateFn(node)))return node;for(;node=skipCaretContainers(walker.prev,shallow);)if(predicateFn(node))return node}if(isForwards(direction)){if((isContentEditableFalse$4(node)||isCaretContainerBlock$1(node))&&(node=skipCaretContainers(walker.next,!0),predicateFn(node)))return node;for(;node=skipCaretContainers(walker.next,shallow);)if(predicateFn(node))return node}return null},getParentBlock=function(node,rootNode){for(;node&&node!==rootNode;){if(isBlockLike(node))return node;node=node.parentNode}return null},isInSameBlock=function(caretPosition1,caretPosition2,rootNode){return getParentBlock(caretPosition1.container(),rootNode)===getParentBlock(caretPosition2.container(),rootNode)},getChildNodeAtRelativeOffset=function(relativeOffset,caretPosition){var container,offset;return caretPosition?(container=caretPosition.container(),offset=caretPosition.offset(),isElement$5(container)?container.childNodes[offset+relativeOffset]:null):null},beforeAfter=function(before,node){var range=node.ownerDocument.createRange();return before?(range.setStartBefore(node),range.setEndBefore(node)):(range.setStartAfter(node),range.setEndAfter(node)),range},isNodesInSameBlock=function(root,node1,node2){return getParentBlock(node1,root)===getParentBlock(node2,root)},lean=function(left,root,node){var sibling,siblingName;for(siblingName=left?"previousSibling":"nextSibling";node&&node!==root;){if(sibling=node[siblingName],isCaretContainer$2(sibling)&&(sibling=sibling[siblingName]),isContentEditableFalse$4(sibling)){if(isNodesInSameBlock(root,sibling,node))return sibling;break}if(isCaretCandidate$2(sibling))break;node=node.parentNode}return null},before$2=curry(beforeAfter,!0),after$1=curry(beforeAfter,!1),normalizeRange=function(direction,root,range){var node,container,offset,location,leanLeft=curry(lean,!0,root),leanRight=curry(lean,!1,root);if(container=range.startContainer,offset=range.startOffset,isCaretContainerBlock(container)){if(isElement$5(container)||(container=container.parentNode),"before"===(location=container.getAttribute("data-mce-caret"))&&(node=container.nextSibling,isFakeCaretTarget(node)))return before$2(node);if("after"===location&&(node=container.previousSibling,isFakeCaretTarget(node)))return after$1(node)}if(!range.collapsed)return range;if(NodeType.isText(container)){if(isCaretContainer$2(container)){if(1===direction){if(node=leanRight(container))return before$2(node);if(node=leanLeft(container))return after$1(node)}if(-1===direction){if(node=leanLeft(container))return after$1(node);if(node=leanRight(container))return before$2(node)}return range}if(endsWithCaretContainer(container)&&offset>=container.data.length-1)return 1===direction&&(node=leanRight(container))?before$2(node):range;if(startsWithCaretContainer(container)&&offset<=1)return-1===direction&&(node=leanLeft(container))?after$1(node):range;if(offset===container.data.length)return node=leanRight(container),node?before$2(node):range;if(0===offset)return node=leanLeft(container),node?after$1(node):range}return range},getRelativeCefElm=function(forward,caretPosition){return Option.from(getChildNodeAtRelativeOffset(forward?0:-1,caretPosition)).filter(isContentEditableFalse$4)},getNormalizedRangeEndPoint=function(direction,root,range){var normalizedRange=normalizeRange(direction,root,range);return-1===direction?CaretPosition.fromRangeStart(normalizedRange):CaretPosition.fromRangeEnd(normalizedRange)},getElementFromPosition=function(pos){return Option.from(pos.getNode()).map(Element.fromDom)},getElementFromPrevPosition=function(pos){return Option.from(pos.getNode(!0)).map(Element.fromDom)},getVisualCaretPosition=function(walkFn,caretPosition){for(;caretPosition=walkFn(caretPosition);)if(caretPosition.isVisible())return caretPosition;return caretPosition},isMoveInsideSameBlock=function(from,to){var inSameBlock=isInSameBlock(from,to);return!(inSameBlock||!NodeType.isBr(from.getNode()))||inSameBlock};!function(HDirection){HDirection[HDirection.Backwards=-1]="Backwards",HDirection[HDirection.Forwards=1]="Forwards"}(HDirection||(HDirection={}));var isContentEditableFalse$5=NodeType.isContentEditableFalse,isText$7=NodeType.isText,isElement$6=NodeType.isElement,isBr$4=NodeType.isBr,isCaretCandidate$3=isCaretCandidate,isAtomic$1=isAtomic,isEditableCaretCandidate$1=isEditableCaretCandidate,getParents=function(node,root){for(var parents=[];node&&node!==root;)parents.push(node),node=node.parentNode;return parents},nodeAtIndex=function(container,offset){return container.hasChildNodes()&&offset<container.childNodes.length?container.childNodes[offset]:null},getCaretCandidatePosition=function(direction,node){if(isForwards(direction)){if(isCaretCandidate$3(node.previousSibling)&&!isText$7(node.previousSibling))return CaretPosition$1.before(node);if(isText$7(node))return CaretPosition$1(node,0)}if(isBackwards(direction)){if(isCaretCandidate$3(node.nextSibling)&&!isText$7(node.nextSibling))return CaretPosition$1.after(node);if(isText$7(node))return CaretPosition$1(node,node.data.length)}return isBackwards(direction)?isBr$4(node)?CaretPosition$1.before(node):CaretPosition$1.after(node):CaretPosition$1.before(node)},moveForwardFromBr=function(root,nextNode){var nextSibling=nextNode.nextSibling;return nextSibling&&isCaretCandidate$3(nextSibling)?isText$7(nextSibling)?CaretPosition$1(nextSibling,0):CaretPosition$1.before(nextSibling):findCaretPosition(HDirection.Forwards,CaretPosition$1.after(nextNode),root)},findCaretPosition=function(direction,startPos,root){var node,nextNode,innerNode,rootContentEditableFalseElm,caretPosition;if(!isElement$6(root)||!startPos)return null;if(startPos.isEqual(CaretPosition$1.after(root))&&root.lastChild){if(caretPosition=CaretPosition$1.after(root.lastChild),isBackwards(direction)&&isCaretCandidate$3(root.lastChild)&&isElement$6(root.lastChild))return isBr$4(root.lastChild)?CaretPosition$1.before(root.lastChild):caretPosition}else caretPosition=startPos;var container=caretPosition.container(),offset=caretPosition.offset();if(isText$7(container)){if(isBackwards(direction)&&offset>0)return CaretPosition$1(container,--offset);if(isForwards(direction)&&offset<container.length)return CaretPosition$1(container,++offset);node=container}else{if(isBackwards(direction)&&offset>0&&(nextNode=nodeAtIndex(container,offset-1),isCaretCandidate$3(nextNode)))return!isAtomic$1(nextNode)&&(innerNode=findNode(nextNode,direction,isEditableCaretCandidate$1,nextNode))?isText$7(innerNode)?CaretPosition$1(innerNode,innerNode.data.length):CaretPosition$1.after(innerNode):isText$7(nextNode)?CaretPosition$1(nextNode,nextNode.data.length):CaretPosition$1.before(nextNode);if(isForwards(direction)&&offset<container.childNodes.length&&(nextNode=nodeAtIndex(container,offset),isCaretCandidate$3(nextNode)))return isBr$4(nextNode)?moveForwardFromBr(root,nextNode):!isAtomic$1(nextNode)&&(innerNode=findNode(nextNode,direction,isEditableCaretCandidate$1,nextNode))?isText$7(innerNode)?CaretPosition$1(innerNode,0):CaretPosition$1.before(innerNode):isText$7(nextNode)?CaretPosition$1(nextNode,0):CaretPosition$1.after(nextNode);node=nextNode||caretPosition.getNode()}return(isForwards(direction)&&caretPosition.isAtEnd()||isBackwards(direction)&&caretPosition.isAtStart())&&(node=findNode(node,direction,constant(!0),root,!0),isEditableCaretCandidate$1(node,root))?getCaretCandidatePosition(direction,node):(nextNode=findNode(node,direction,isEditableCaretCandidate$1,root),rootContentEditableFalseElm=ArrUtils.last(filter(getParents(container,root),isContentEditableFalse$5)),!rootContentEditableFalseElm||nextNode&&rootContentEditableFalseElm.contains(nextNode)?nextNode?getCaretCandidatePosition(direction,nextNode):null:caretPosition=isForwards(direction)?CaretPosition$1.after(rootContentEditableFalseElm):CaretPosition$1.before(rootContentEditableFalseElm))},CaretWalker=function(root){return{next:function(caretPosition){return findCaretPosition(HDirection.Forwards,caretPosition,root)},prev:function(caretPosition){return findCaretPosition(HDirection.Backwards,caretPosition,root)}}},walkToPositionIn=function(forward,root,start){var position=forward?CaretPosition$1.before(start):CaretPosition$1.after(start);return fromPosition(forward,root,position)},afterElement=function(node){return NodeType.isBr(node)?CaretPosition$1.before(node):CaretPosition$1.after(node)},isBeforeOrStart=function(position){return CaretPosition$1.isTextPosition(position)?0===position.offset():isCaretCandidate(position.getNode())},isAfterOrEnd=function(position){if(CaretPosition$1.isTextPosition(position)){var container=position.container();return position.offset()===container.data.length}return isCaretCandidate(position.getNode(!0))},isBeforeAfterSameElement=function(from,to){return!CaretPosition$1.isTextPosition(from)&&!CaretPosition$1.isTextPosition(to)&&from.getNode()===to.getNode(!0)},isAtBr=function(position){return!CaretPosition$1.isTextPosition(position)&&NodeType.isBr(position.getNode())},shouldSkipPosition=function(forward,from,to){return forward?!isBeforeAfterSameElement(from,to)&&!isAtBr(from)&&isAfterOrEnd(from)&&isBeforeOrStart(to):!isBeforeAfterSameElement(to,from)&&isBeforeOrStart(from)&&isAfterOrEnd(to)},fromPosition=function(forward,root,pos){var walker=CaretWalker(root);return Option.from(forward?walker.next(pos):walker.prev(pos))},navigate=function(forward,root,from){return fromPosition(forward,root,from).bind(function(to){return isInSameBlock(from,to,root)&&shouldSkipPosition(forward,from,to)?fromPosition(forward,root,to):Option.some(to)})},navigateIgnore=function(forward,root,from,ignoreFilter){return navigate(forward,root,from).bind(function(pos){return ignoreFilter(pos)?navigateIgnore(forward,root,pos,ignoreFilter):Option.some(pos)})},positionIn=function(forward,element){var startNode=forward?element.firstChild:element.lastChild;return NodeType.isText(startNode)?Option.some(CaretPosition$1(startNode,forward?0:startNode.data.length)):startNode?isCaretCandidate(startNode)?Option.some(forward?CaretPosition$1.before(startNode):afterElement(startNode)):walkToPositionIn(forward,element,startNode):Option.none()},nextPosition=curry(fromPosition,!0),prevPosition=curry(fromPosition,!1),CaretFinder={fromPosition:fromPosition,nextPosition:nextPosition,prevPosition:prevPosition,navigate:navigate,navigateIgnore:navigateIgnore,positionIn:positionIn,firstPositionIn:curry(positionIn,!0),lastPositionIn:curry(positionIn,!1)},isStringPathBookmark=function(bookmark){return"string"==typeof bookmark.start},isRangeBookmark=function(bookmark){return bookmark.hasOwnProperty("rng")},isIdBookmark=function(bookmark){return bookmark.hasOwnProperty("id")},isIndexBookmark=function(bookmark){return bookmark.hasOwnProperty("name")},isPathBookmark=function(bookmark){return Tools.isArray(bookmark.start)},addBogus=function(dom,node){return NodeType.isElement(node)&&dom.isBlock(node)&&!node.innerHTML&&!Env.ie&&(node.innerHTML='<br data-mce-bogus="1" />'),node},resolveCaretPositionBookmark=function(dom,bookmark){var rng,pos;return rng=dom.createRng(),pos=resolve$1(dom.getRoot(),bookmark.start),rng.setStart(pos.container(),pos.offset()),pos=resolve$1(dom.getRoot(),bookmark.end),rng.setEnd(pos.container(),pos.offset()),rng},insertZwsp=function(node,rng){var textNode=node.ownerDocument.createTextNode(Zwsp.ZWSP);node.appendChild(textNode),rng.setStart(textNode,0),rng.setEnd(textNode,0)},isEmpty=function(node){return!1===node.hasChildNodes()},tryFindRangePosition=function(node,rng){return CaretFinder.lastPositionIn(node).fold(function(){return!1},function(pos){return rng.setStart(pos.container(),pos.offset()),rng.setEnd(pos.container(),pos.offset()),!0})},padEmptyCaretContainer=function(root,node,rng){return!(!isEmpty(node)||!getParentCaretContainer(root,node))&&(insertZwsp(node,rng),!0)},setEndPoint=function(dom,start,bookmark,rng){var i,node,offset,children,point=bookmark[start?"start":"end"],root=dom.getRoot();if(point){for(offset=point[0],node=root,i=point.length-1;i>=1;i--){if(children=node.childNodes,padEmptyCaretContainer(root,node,rng))return!0;if(point[i]>children.length-1)return!!padEmptyCaretContainer(root,node,rng)||tryFindRangePosition(node,rng);node=children[point[i]]}3===node.nodeType&&(offset=Math.min(point[0],node.nodeValue.length)),1===node.nodeType&&(offset=Math.min(point[0],node.childNodes.length)),start?rng.setStart(node,offset):rng.setEnd(node,offset)}return!0},isValidTextNode=function(node){return NodeType.isText(node)&&node.data.length>0},restoreEndPoint=function(dom,suffix,bookmark){var node,idx,next,prev,container,offset,marker=dom.get(bookmark.id+"_"+suffix),keep=bookmark.keep;if(marker){if(node=marker.parentNode,"start"===suffix?(keep?marker.hasChildNodes()?(node=marker.firstChild,idx=1):isValidTextNode(marker.nextSibling)?(node=marker.nextSibling,idx=0):isValidTextNode(marker.previousSibling)?(node=marker.previousSibling,idx=marker.previousSibling.data.length):(node=marker.parentNode,idx=dom.nodeIndex(marker)+1):idx=dom.nodeIndex(marker),container=node,offset=idx):(keep?marker.hasChildNodes()?(node=marker.firstChild,idx=1):isValidTextNode(marker.previousSibling)?(node=marker.previousSibling,idx=marker.previousSibling.data.length):(node=marker.parentNode,idx=dom.nodeIndex(marker)):idx=dom.nodeIndex(marker),container=node,offset=idx),!keep){for(prev=marker.previousSibling,next=marker.nextSibling,Tools.each(Tools.grep(marker.childNodes),function(node){NodeType.isText(node)&&(node.nodeValue=node.nodeValue.replace(/\uFEFF/g,""))});marker=dom.get(bookmark.id+"_"+suffix);)dom.remove(marker,!0);prev&&next&&prev.nodeType===next.nodeType&&NodeType.isText(prev)&&!Env.opera&&(idx=prev.nodeValue.length,prev.appendData(next.nodeValue),dom.remove(next),container=prev,offset=idx)}return Option.some(CaretPosition$1(container,offset))}return Option.none()},resolvePaths=function(dom,bookmark){var rng=dom.createRng();return setEndPoint(dom,!0,bookmark,rng)&&setEndPoint(dom,!1,bookmark,rng)?Option.some(rng):Option.none()},resolveId=function(dom,bookmark){var startPos=restoreEndPoint(dom,"start",bookmark),endPos=restoreEndPoint(dom,"end",bookmark);return lift2(startPos,endPos.or(startPos),function(spos,epos){var rng=dom.createRng();return rng.setStart(addBogus(dom,spos.container()),spos.offset()),rng.setEnd(addBogus(dom,epos.container()),epos.offset()),rng})},resolveIndex$1=function(dom,bookmark){return Option.from(dom.select(bookmark.name)[bookmark.index]).map(function(elm){var rng=dom.createRng();return rng.selectNode(elm),rng})},resolve$2=function(selection,bookmark){var dom=selection.dom;if(bookmark){if(isPathBookmark(bookmark))return resolvePaths(dom,bookmark);if(isStringPathBookmark(bookmark))return Option.some(resolveCaretPositionBookmark(dom,bookmark));if(isIdBookmark(bookmark))return resolveId(dom,bookmark);if(isIndexBookmark(bookmark))return resolveIndex$1(dom,bookmark);if(isRangeBookmark(bookmark))return Option.some(bookmark.rng)}return Option.none()},ResolveBookmark={resolve:resolve$2},getBookmark$1=function(selection,type,normalized){return GetBookmark.getBookmark(selection,type,normalized)},moveToBookmark=function(selection,bookmark){ResolveBookmark.resolve(selection,bookmark).each(function(rng){selection.setRng(rng)})},isBookmarkNode$1=function(node){return NodeType.isElement(node)&&"SPAN"===node.tagName&&"bookmark"===node.getAttribute("data-mce-type")},Bookmarks={getBookmark:getBookmark$1,moveToBookmark:moveToBookmark,isBookmarkNode:isBookmarkNode$1},isNbsp=function(expected){return function(actual){return expected===actual}}(" "),isWhiteSpace$1=function(chr){return""!==chr&&-1!==" \f\n\r\t\v".indexOf(chr)},isContent=function(chr){return!isWhiteSpace$1(chr)&&!isNbsp(chr)},isNode=function(node){return!!node.nodeType},isInlineBlock=function(node){return node&&/^(IMG)$/.test(node.nodeName)},moveStart=function(dom,selection,rng){var walker,node,nodes,offset=rng.startOffset,container=rng.startContainer;if((rng.startContainer!==rng.endContainer||!isInlineBlock(rng.startContainer.childNodes[rng.startOffset]))&&1===container.nodeType)for(nodes=container.childNodes,offset<nodes.length?(container=nodes[offset],walker=new TreeWalker(container,dom.getParent(container,dom.isBlock))):(container=nodes[nodes.length-1],walker=new TreeWalker(container,dom.getParent(container,dom.isBlock)),walker.next(!0)),node=walker.current();node;node=walker.next())if(3===node.nodeType&&!isWhiteSpaceNode(node))return rng.setStart(node,0),void selection.setRng(rng)},getNonWhiteSpaceSibling=function(node,next,inc){if(node){var nextName=next?"nextSibling":"previousSibling";for(node=inc?node:node[nextName];node;node=node[nextName])if(1===node.nodeType||!isWhiteSpaceNode(node))return node}},isTextBlock$1=function(editor,name){return isNode(name)&&(name=name.nodeName),!!editor.schema.getTextBlockElements()[name.toLowerCase()]},isValid=function(ed,parent,child){return ed.schema.isValidChild(parent,child)},isWhiteSpaceNode=function(node){return node&&NodeType.isText(node)&&/^([\t \r\n]+|)$/.test(node.nodeValue)},isEmptyTextNode=function(node){return node&&NodeType.isText(node)&&0===node.length},replaceVars=function(value,vars){return"string"!=typeof value?value=value(vars):vars&&(value=value.replace(/%(\w+)/g,function(str,name){return vars[name]||str})),value},isEq=function(str1,str2){return str1=str1||"",str2=str2||"",str1=""+(str1.nodeName||str1),str2=""+(str2.nodeName||str2),str1.toLowerCase()===str2.toLowerCase()},normalizeStyleValue=function(dom,value,name){return"color"!==name&&"backgroundColor"!==name||(value=dom.toHex(value)),"fontWeight"===name&&700===value&&(value="bold"),"fontFamily"===name&&(value=value.replace(/[\'\"]/g,"").replace(/,\s+/g,",")),""+value},getStyle=function(dom,node,name){return normalizeStyleValue(dom,dom.getStyle(node,name),name)},getTextDecoration=function(dom,node){var decoration;return dom.getParent(node,function(n){return(decoration=dom.getStyle(n,"text-decoration"))&&"none"!==decoration}),decoration},getParents$1=function(dom,node,selector){return dom.getParents(node,selector,dom.getRoot())},isBookmarkNode$2=Bookmarks.isBookmarkNode,getParents$2=getParents$1,isWhiteSpaceNode$1=isWhiteSpaceNode,isTextBlock$2=isTextBlock$1,isBogusBr=function(node){return"BR"===node.nodeName&&node.getAttribute("data-mce-bogus")&&!node.nextSibling},findParentContentEditable=function(dom,node){for(var parent=node;parent;){if(NodeType.isElement(parent)&&dom.getContentEditable(parent))return"false"===dom.getContentEditable(parent)?parent:node;parent=parent.parentNode}return node},walkText=function(start,node,offset,predicate){for(var str=node.data,i=offset;start?i>=0:i<str.length;start?i--:i++)if(predicate(str.charAt(i)))return start?i+1:i;return-1},findSpace=function(start,node,offset){return walkText(start,node,offset,function(c){return isNbsp(c)||isWhiteSpace$1(c)})},findContent=function(start,node,offset){return walkText(start,node,offset,isContent)},findWordEndPoint=function(dom,body,container,offset,start,includeTrailingSpaces){var lastTextNode,rootNode=dom.getParent(container,dom.isBlock)||body,walk=function(container,offset,pred){var textSeeker=TextSeeker(dom),walker=start?textSeeker.backwards:textSeeker.forwards;return Option.from(walker(container,offset,function(text,textOffset){return isBookmarkNode$2(text.parentNode)?-1:(lastTextNode=text,pred(start,text,textOffset))},rootNode))};return walk(container,offset,findSpace).bind(function(result){return includeTrailingSpaces?walk(result.container,result.offset+(start?-1:0),findContent):Option.some(result)}).orThunk(function(){return lastTextNode?Option.some({container:lastTextNode,offset:start?0:lastTextNode.length}):Option.none()})},findSelectorEndPoint=function(dom,format,rng,container,siblingName){NodeType.isText(container)&&0===container.nodeValue.length&&container[siblingName]&&(container=container[siblingName]);for(var parents=getParents$2(dom,container),i=0;i<parents.length;i++)for(var y=0;y<format.length;y++){var curFormat=format[y];if(!("collapsed"in curFormat&&curFormat.collapsed!==rng.collapsed)&&dom.is(parents[i],curFormat.selector))return parents[i]}return container},findBlockEndPoint=function(editor,format,container,siblingName){var node,dom=editor.dom,root=dom.getRoot();if(format[0].wrapper||(node=dom.getParent(container,format[0].block,root)),!node){var scopeRoot=dom.getParent(container,"LI,TD,TH");node=dom.getParent(NodeType.isText(container)?container.parentNode:container,function(node){return node!==root&&isTextBlock$2(editor,node)},scopeRoot)}if(node&&format[0].wrapper&&(node=getParents$2(dom,node,"ul,ol").reverse()[0]||node),!node)for(node=container;node[siblingName]&&!dom.isBlock(node[siblingName])&&(node=node[siblingName],!isEq(node,"br")););return node||container},findParentContainer=function(dom,format,startContainer,startOffset,endContainer,endOffset,start){var container,parent,sibling,siblingName,root;if(container=parent=start?startContainer:endContainer,siblingName=start?"previousSibling":"nextSibling",root=dom.getRoot(),NodeType.isText(container)&&!isWhiteSpaceNode$1(container)&&(start?startOffset>0:endOffset<container.nodeValue.length))return container;for(;;){if(!format[0].block_expand&&dom.isBlock(parent))return parent;for(sibling=parent[siblingName];sibling;sibling=sibling[siblingName])if(!isBookmarkNode$2(sibling)&&!isWhiteSpaceNode$1(sibling)&&!isBogusBr(sibling))return parent;if(parent===root||parent.parentNode===root){container=parent;break}parent=parent.parentNode}return container},expandRng=function(editor,rng,format,includeTrailingSpace){void 0===includeTrailingSpace&&(includeTrailingSpace=!1);var startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset,dom=editor.dom;if(NodeType.isElement(startContainer)&&startContainer.hasChildNodes()&&(startContainer=getNode(startContainer,startOffset),NodeType.isText(startContainer)&&(startOffset=0)),NodeType.isElement(endContainer)&&endContainer.hasChildNodes()&&(endContainer=getNode(endContainer,rng.collapsed?endOffset:endOffset-1),NodeType.isText(endContainer)&&(endOffset=endContainer.nodeValue.length)),startContainer=findParentContentEditable(dom,startContainer),endContainer=findParentContentEditable(dom,endContainer),(isBookmarkNode$2(startContainer.parentNode)||isBookmarkNode$2(startContainer))&&(startContainer=isBookmarkNode$2(startContainer)?startContainer:startContainer.parentNode,startContainer=rng.collapsed?startContainer.previousSibling||startContainer:startContainer.nextSibling||startContainer,NodeType.isText(startContainer)&&(startOffset=rng.collapsed?startContainer.length:0)),(isBookmarkNode$2(endContainer.parentNode)||isBookmarkNode$2(endContainer))&&(endContainer=isBookmarkNode$2(endContainer)?endContainer:endContainer.parentNode,endContainer=rng.collapsed?endContainer.nextSibling||endContainer:endContainer.previousSibling||endContainer,NodeType.isText(endContainer)&&(endOffset=rng.collapsed?0:endContainer.length)),rng.collapsed){findWordEndPoint(dom,editor.getBody(),startContainer,startOffset,!0,includeTrailingSpace).each(function(_a){var container=_a.container,offset=_a.offset;startContainer=container,startOffset=offset});findWordEndPoint(dom,editor.getBody(),endContainer,endOffset,!1,includeTrailingSpace).each(function(_a){var container=_a.container,offset=_a.offset;endContainer=container,endOffset=offset})}return(format[0].inline||format[0].block_expand)&&(format[0].inline&&NodeType.isText(startContainer)&&0!==startOffset||(startContainer=findParentContainer(dom,format,startContainer,startOffset,endContainer,endOffset,!0)),format[0].inline&&NodeType.isText(endContainer)&&endOffset!==endContainer.nodeValue.length||(endContainer=findParentContainer(dom,format,startContainer,startOffset,endContainer,endOffset,!1))),format[0].selector&&!1!==format[0].expand&&!format[0].inline&&(startContainer=findSelectorEndPoint(dom,format,rng,startContainer,"previousSibling"),endContainer=findSelectorEndPoint(dom,format,rng,endContainer,"nextSibling")),(format[0].block||format[0].selector)&&(startContainer=findBlockEndPoint(editor,format,startContainer,"previousSibling"),endContainer=findBlockEndPoint(editor,format,endContainer,"nextSibling"),format[0].block&&(dom.isBlock(startContainer)||(startContainer=findParentContainer(dom,format,startContainer,startOffset,endContainer,endOffset,!0)),dom.isBlock(endContainer)||(endContainer=findParentContainer(dom,format,startContainer,startOffset,endContainer,endOffset,!1)))),NodeType.isElement(startContainer)&&(startOffset=dom.nodeIndex(startContainer),startContainer=startContainer.parentNode),NodeType.isElement(endContainer)&&(endOffset=dom.nodeIndex(endContainer)+1,endContainer=endContainer.parentNode),{startContainer:startContainer,startOffset:startOffset,endContainer:endContainer,endOffset:endOffset}},each$7=Tools.each,getEndChild=function(container,index){var childNodes=container.childNodes;return index--,index>childNodes.length-1?index=childNodes.length-1:index<0&&(index=0),childNodes[index]||container},walk$1=function(dom,rng,callback){var startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset,nodes=dom.select("td[data-mce-selected],th[data-mce-selected]");if(nodes.length>0)return void each$7(nodes,function(node){callback([node])});var exclude=function(nodes){var node;return node=nodes[0],3===node.nodeType&&node===startContainer&&startOffset>=node.nodeValue.length&&nodes.splice(0,1),node=nodes[nodes.length-1],0===endOffset&&nodes.length>0&&node===endContainer&&3===node.nodeType&&nodes.splice(nodes.length-1,1),nodes},collectSiblings=function(node,name,endNode){for(var siblings=[];node&&node!==endNode;node=node[name])siblings.push(node);return siblings},findEndPoint=function(node,root){do{if(node.parentNode===root)return node;node=node.parentNode}while(node)},walkBoundary=function(startNode,endNode,next){for(var siblingName=next?"nextSibling":"previousSibling",node=startNode,parent_1=node.parentNode;node&&node!==endNode;node=parent_1){parent_1=node.parentNode;var siblings_1=collectSiblings(node===startNode?node:node[siblingName],siblingName);siblings_1.length&&(next||siblings_1.reverse(),callback(exclude(siblings_1)))}};if(1===startContainer.nodeType&&startContainer.hasChildNodes()&&(startContainer=startContainer.childNodes[startOffset]),1===endContainer.nodeType&&endContainer.hasChildNodes()&&(endContainer=getEndChild(endContainer,endOffset)),startContainer===endContainer)return callback(exclude([startContainer]));for(var ancestor=dom.findCommonAncestor(startContainer,endContainer),node=startContainer;node;node=node.parentNode){if(node===endContainer)return walkBoundary(startContainer,ancestor,!0);if(node===ancestor)break}for(var node=endContainer;node;node=node.parentNode){if(node===startContainer)return walkBoundary(endContainer,ancestor);if(node===ancestor)break}var startPoint=findEndPoint(startContainer,ancestor)||startContainer,endPoint=findEndPoint(endContainer,ancestor)||endContainer;walkBoundary(startContainer,startPoint,!0);var siblings=collectSiblings(startPoint===startContainer?startPoint:startPoint.nextSibling,"nextSibling",endPoint===endContainer?endPoint.nextSibling:endPoint);siblings.length&&callback(exclude(siblings)),walkBoundary(endContainer,endPoint)},RangeWalk={walk:walk$1},api=function(is,name){var get=function(element){if(!is(element))throw new Error("Can only get "+name+" value of a "+name+" node");return getOption(element).getOr("")},getOption=function(element){return is(element)?Option.from(element.dom().nodeValue):Option.none()};return{get:get,getOption:getOption,set:function(element,value){if(!is(element))throw new Error("Can only set raw "+name+" value of a "+name+" node");element.dom().nodeValue=value}}}(isText,"text"),get$7=function(element){return api.get(element)},isZeroWidth=function(elem){return isText(elem)&&"\ufeff"===get$7(elem)},context=function(editor,elem,wrapName,nodeName){return parent(elem).fold(function(){return"skipping"},function(parent){return"br"===nodeName||isZeroWidth(elem)?"valid":isAnnotation(elem)?"existing":isCaretNode(elem)?"caret":isValid(editor,wrapName,nodeName)&&isValid(editor,name(parent),wrapName)?"valid":"invalid-child"})},applyWordGrab=function(editor,rng){var r=expandRng(editor,rng,[{inline:!0}]);rng.setStart(r.startContainer,r.startOffset),rng.setEnd(r.endContainer,r.endOffset),editor.selection.setRng(rng)},makeAnnotation=function(eDoc,_a,annotationName,decorate){var _b=_a.uid,uid=void 0===_b?generate("mce-annotation"):_b,data=__rest(_a,["uid"]),master=Element.fromTag("span",eDoc);add$3(master,annotation()),set(master,""+dataAnnotationId(),uid),set(master,""+dataAnnotation(),annotationName);var _c=decorate(uid,data),_d=_c.attributes,attributes=void 0===_d?{}:_d,_e=_c.classes,classes=void 0===_e?[]:_e;return setAll(master,attributes),add$4(master,classes),master},annotate=function(editor,rng,annotationName,decorate,data){var newWrappers=[],master=makeAnnotation(editor.getDoc(),data,annotationName,decorate),wrapper=Cell(Option.none()),finishWrapper=function(){wrapper.set(Option.none())},getOrOpenWrapper=function(){return wrapper.get().getOrThunk(function(){var nu=shallow(master);return newWrappers.push(nu),wrapper.set(Option.some(nu)),nu})},processElements=function(elems){each(elems,processElement)},processElement=function(elem){switch(context(editor,elem,"span",name(elem))){case"invalid-child":finishWrapper();var children$1=children(elem);processElements(children$1),finishWrapper();break;case"valid":var w=getOrOpenWrapper();wrap(elem,w)}},processNodes=function(nodes){var elems=map(nodes,Element.fromDom);processElements(elems)};return RangeWalk.walk(editor.dom,rng,function(nodes){finishWrapper(),processNodes(nodes)}),newWrappers},annotateWithBookmark=function(editor,name,settings,data){editor.undoManager.transact(function(){var initialRng=editor.selection.getRng();if(initialRng.collapsed&&applyWordGrab(editor,initialRng),editor.selection.getRng().collapsed){var wrapper=makeAnnotation(editor.getDoc(),data,name,settings.decorate);set$1(wrapper," "),editor.selection.getRng().insertNode(wrapper.dom()),editor.selection.select(wrapper.dom())}else{var bookmark=GetBookmark.getPersistentBookmark(editor.selection,!1),rng=editor.selection.getRng();annotate(editor,rng,name,settings.decorate,data),editor.selection.moveToBookmark(bookmark)}})},Annotator=function(editor){var registry=create$1();setup$1(editor,registry);var changes=setup(editor);return{register:function(name,settings){registry.register(name,settings)},annotate:function(name,data){registry.lookup(name).each(function(settings){annotateWithBookmark(editor,name,settings,data)})},annotationChanged:function(name,callback){changes.addListener(name,callback)},remove:function(name){identify(editor,Option.some(name)).each(function(_a){var elements=_a.elements;each(elements,unwrap)})},getAll:function(name){var directory=findAll(editor,name);return map$1(directory,function(elems){return map(elems,function(elem){return elem.dom()})})}}},whiteSpaceRegExp$3=/^[ \t\r\n]*$/,typeLookup={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11},walk$2=function(node,root,prev){var startName=prev?"lastChild":"firstChild",siblingName=prev?"prev":"next";if(node[startName])return node[startName];if(node!==root){var sibling=node[siblingName];if(sibling)return sibling;for(var parent_1=node.parent;parent_1&&parent_1!==root;parent_1=parent_1.parent)if(sibling=parent_1[siblingName])return sibling}},isEmptyTextNode$1=function(node){if(!whiteSpaceRegExp$3.test(node.value))return!1;var parentNode=node.parent;return!parentNode||"span"===parentNode.name&&!parentNode.attr("style")||!/^[ ]+$/.test(node.value)},Node$1=function(){function Node(name,type){this.name=name,this.type=type,1===type&&(this.attributes=[],this.attributes.map={})}return Node.create=function(name,attrs){var node=new Node(name,typeLookup[name]||1);if(attrs)for(var attrName in attrs)node.attr(attrName,attrs[attrName]);return node},Node.prototype.replace=function(node){var self=this;return node.parent&&node.remove(),self.insert(node,self),self.remove(),self},Node.prototype.attr=function(name,value){var attrs,self=this;if("string"!=typeof name){for(var key in name)self.attr(key,name[key]);return self}if(attrs=self.attributes){if(void 0!==value){if(null===value){if(name in attrs.map){delete attrs.map[name];for(var i=attrs.length;i--;)if(attrs[i].name===name)return attrs.splice(i,1),self}return self}if(name in attrs.map){for(var i=attrs.length;i--;)if(attrs[i].name===name){attrs[i].value=value;break}}else attrs.push({name:name,value:value});return attrs.map[name]=value,self}return attrs.map[name]}},Node.prototype.clone=function(){var selfAttrs,self=this,clone=new Node(self.name,self.type);if(selfAttrs=self.attributes){var cloneAttrs=[];cloneAttrs.map={};for(var i=0,l=selfAttrs.length;i<l;i++){var selfAttr=selfAttrs[i];"id"!==selfAttr.name&&(cloneAttrs[cloneAttrs.length]={name:selfAttr.name,value:selfAttr.value},cloneAttrs.map[selfAttr.name]=selfAttr.value)}clone.attributes=cloneAttrs}return clone.value=self.value,clone.shortEnded=self.shortEnded,clone},Node.prototype.wrap=function(wrapper){var self=this;return self.parent.insert(wrapper,self),wrapper.append(self),self},Node.prototype.unwrap=function(){for(var self=this,node=self.firstChild;node;){var next=node.next;self.insert(node,self,!0),node=next}self.remove()},Node.prototype.remove=function(){var self=this,parent=self.parent,next=self.next,prev=self.prev;return parent&&(parent.firstChild===self?(parent.firstChild=next,next&&(next.prev=null)):prev.next=next,parent.lastChild===self?(parent.lastChild=prev,prev&&(prev.next=null)):next.prev=prev,self.parent=self.next=self.prev=null),self},Node.prototype.append=function(node){var self=this;node.parent&&node.remove();var last=self.lastChild;return last?(last.next=node,node.prev=last,self.lastChild=node):self.lastChild=self.firstChild=node,node.parent=self,node},Node.prototype.insert=function(node,refNode,before){node.parent&&node.remove();var parent=refNode.parent||this;return before?(refNode===parent.firstChild?parent.firstChild=node:refNode.prev.next=node,node.prev=refNode.prev,node.next=refNode,refNode.prev=node):(refNode===parent.lastChild?parent.lastChild=node:refNode.next.prev=node,node.next=refNode.next,node.prev=refNode,refNode.next=node),node.parent=parent,node},Node.prototype.getAll=function(name){for(var self=this,collection=[],node=self.firstChild;node;node=walk$2(node,self))node.name===name&&collection.push(node);return collection},Node.prototype.empty=function(){var self=this;if(self.firstChild){for(var nodes=[],node=self.firstChild;node;node=walk$2(node,self))nodes.push(node);for(var i=nodes.length;i--;){var node=nodes[i];node.parent=node.firstChild=node.lastChild=node.next=node.prev=null}}return self.firstChild=self.lastChild=null,self},Node.prototype.isEmpty=function(elements,whitespace,predicate){void 0===whitespace&&(whitespace={});var self=this,node=self.firstChild;if(node)do{if(1===node.type){if(node.attr("data-mce-bogus"))continue;if(elements[node.name])return!1;for(var i=node.attributes.length;i--;){var name_1=node.attributes[i].name;if("name"===name_1||0===name_1.indexOf("data-mce-bookmark"))return!1}}if(8===node.type)return!1;if(3===node.type&&!isEmptyTextNode$1(node))return!1;if(3===node.type&&node.parent&&whitespace[node.parent.name]&&whiteSpaceRegExp$3.test(node.value))return!1;if(predicate&&predicate(node))return!1}while(node=walk$2(node,self));return!0},Node.prototype.walk=function(prev){return walk$2(this,null,prev)},Node}(),isValidPrefixAttrName=function(name){return 0===name.indexOf("data-")||0===name.indexOf("aria-")},isInvalidUri=function(settings,uri){return!settings.allow_html_data_urls&&(/^data:image\//i.test(uri)?!1===settings.allow_svg_data_urls&&/^data:image\/svg\+xml/i.test(uri):/^data:/i.test(uri))},findEndTagIndex=function(schema,html,startIndex){var index,matches,tokenRegExp,shortEndedElements,count=1;for(shortEndedElements=schema.getShortEndedElements(),tokenRegExp=/<([!?\/])?([A-Za-z0-9\-_\:\.]+)((?:\s+[^"\'>]+(?:(?:"[^"]*")|(?:\'[^\']*\')|[^>]*))*|\/|\s+)>/g,tokenRegExp.lastIndex=index=startIndex;matches=tokenRegExp.exec(html);){if(index=tokenRegExp.lastIndex,"/"===matches[1])count--;else if(!matches[1]){if(matches[2]in shortEndedElements)continue;count++}if(0===count)break}return index},isConditionalComment=function(html,startIndex){return/^\s*\[if [\w\W]+\]>.*<!\[endif\](--!?)?>/.test(html.substr(startIndex))},findCommentEndIndex=function(html,isBogus,startIndex){void 0===startIndex&&(startIndex=0);var lcHtml=html.toLowerCase();if(-1!==lcHtml.indexOf("[if ",startIndex)&&isConditionalComment(lcHtml,startIndex)){var endIfIndex=lcHtml.indexOf("[endif]",startIndex);return lcHtml.indexOf(">",endIfIndex)}if(isBogus){var endIndex=lcHtml.indexOf(">",startIndex);return-1!==endIndex?endIndex:lcHtml.length}var endCommentRegexp=/--!?>/;endCommentRegexp.lastIndex=startIndex;var match=endCommentRegexp.exec(html);return match?match.index+match[0].length:lcHtml.length},checkBogusAttribute=function(regExp,attrString){var matches=regExp.exec(attrString);if(matches){var name_1=matches[1],value=matches[2];return"string"==typeof name_1&&"data-mce-bogus"===name_1.toLowerCase()?value:null}return null};!function(SaxParser){SaxParser.findEndTag=findEndTagIndex}(SaxParser||(SaxParser={}));var documentFocusInHandler,SaxParser$1=SaxParser,trimHtml=function(tempAttrs,html){var trimContentRegExp=new RegExp(["\\s?("+tempAttrs.join("|")+')="[^"]+"'].join("|"),"gi");return html.replace(trimContentRegExp,"")},trimInternal=function(serializer,html){var endTagIndex,index,matchLength,matches,shortEndedElements,content=html,bogusAllRegExp=/<(\w+) [^>]*data-mce-bogus="all"[^>]*>/g,schema=serializer.schema;for(content=trimHtml(serializer.getTempAttrs(),content),shortEndedElements=schema.getShortEndedElements();matches=bogusAllRegExp.exec(content);)index=bogusAllRegExp.lastIndex,matchLength=matches[0].length,endTagIndex=shortEndedElements[matches[1]]?index:SaxParser$1.findEndTag(schema,content,index),content=content.substring(0,index-matchLength)+content.substring(endTagIndex),bogusAllRegExp.lastIndex=index-matchLength;return Zwsp.trim(content)},trimExternal=trimInternal,TrimHtml={trimExternal:trimExternal,trimInternal:trimInternal},trimEmptyContents=function(editor,html){var blockName=Settings.getForcedRootBlock(editor),emptyRegExp=new RegExp("^(<"+blockName+"[^>]*>(&nbsp;|&#160;|\\s| |<br \\/>|)<\\/"+blockName+">[\r\n]*|<br \\/>[\r\n]*)$");return html.replace(emptyRegExp,"")},getContentFromBody=function(editor,args,body){var content;if(args.format=args.format?args.format:"html",args.get=!0,args.getInner=!0,args.no_events||editor.fire("BeforeGetContent",args),"raw"===args.format)content=Tools.trim(TrimHtml.trimExternal(editor.serializer,body.innerHTML));else if("text"===args.format)content=Zwsp.trim(body.innerText||body.textContent);else{if("tree"===args.format)return editor.serializer.serialize(body,args);content=trimEmptyContents(editor,editor.serializer.serialize(body,args))}return"text"===args.format||isWsPreserveElement(Element.fromDom(body))?args.content=content:args.content=Tools.trim(content),args.no_events||editor.fire("GetContent",args),args.content},getContent=function(editor,args){return void 0===args&&(args={}),Option.from(editor.getBody()).fold(constant("tree"===args.format?new Node$1("body",11):""),function(body){return getContentFromBody(editor,args,body)})},makeMap$3=Tools.makeMap,Writer=function(settings){var indent,indentBefore,indentAfter,encode,htmlOutput,html=[];return settings=settings||{},indent=settings.indent,indentBefore=makeMap$3(settings.indent_before||""),indentAfter=makeMap$3(settings.indent_after||""),encode=Entities.getEncodeFunc(settings.entity_encoding||"raw",settings.entities),htmlOutput="html"===settings.element_format,{start:function(name,attrs,empty){var i,l,attr,value;if(indent&&indentBefore[name]&&html.length>0&&(value=html[html.length-1],value.length>0&&"\n"!==value&&html.push("\n")),html.push("<",name),attrs)for(i=0,l=attrs.length;i<l;i++)attr=attrs[i],html.push(" ",attr.name,'="',encode(attr.value,!0),'"');html[html.length]=!empty||htmlOutput?">":" />",empty&&indent&&indentAfter[name]&&html.length>0&&(value=html[html.length-1],value.length>0&&"\n"!==value&&html.push("\n"))},end:function(name){var value;html.push("</",name,">"),indent&&indentAfter[name]&&html.length>0&&(value=html[html.length-1],value.length>0&&"\n"!==value&&html.push("\n"))},text:function(text,raw){text.length>0&&(html[html.length]=raw?text:encode(text))},cdata:function(text){html.push("<![CDATA[",text,"]]>")},comment:function(text){html.push("\x3c!--",text,"--\x3e")},pi:function(name,text){text?html.push("<?",name," ",encode(text),"?>"):html.push("<?",name,"?>"),indent&&html.push("\n")},doctype:function(text){html.push("<!DOCTYPE",text,">",indent?"\n":"")},reset:function(){html.length=0},getContent:function(){return html.join("").replace(/\n$/,"")}}},Serializer=function(settings,schema){void 0===schema&&(schema=Schema());var writer=Writer(settings);return settings=settings||{},settings.validate=!("validate"in settings)||settings.validate,{serialize:function(node){var handlers,validate;validate=settings.validate,handlers={3:function(node){writer.text(node.value,node.raw)},8:function(node){writer.comment(node.value)},7:function(node){writer.pi(node.name,node.value)},10:function(node){writer.doctype(node.value)},4:function(node){writer.cdata(node.value)},11:function(node){if(node=node.firstChild)do{walk(node)}while(node=node.next)}},writer.reset();var walk=function(node){var name,isEmpty,attrs,attrName,attrValue,sortedAttrs,i,l,elementRule,handler=handlers[node.type];if(handler)handler(node);else{if(name=node.name,isEmpty=node.shortEnded,attrs=node.attributes,validate&&attrs&&attrs.length>1&&(sortedAttrs=[],sortedAttrs.map={},elementRule=schema.getElementRule(node.name))){for(i=0,l=elementRule.attributesOrder.length;i<l;i++)(attrName=elementRule.attributesOrder[i])in attrs.map&&(attrValue=attrs.map[attrName],sortedAttrs.map[attrName]=attrValue,sortedAttrs.push({name:attrName,value:attrValue}));for(i=0,l=attrs.length;i<l;i++)(attrName=attrs[i].name)in sortedAttrs.map||(attrValue=attrs.map[attrName],sortedAttrs.map[attrName]=attrValue,sortedAttrs.push({name:attrName,value:attrValue}));attrs=sortedAttrs}if(writer.start(node.name,attrs,isEmpty),!isEmpty){if(node=node.firstChild)do{walk(node)}while(node=node.next);writer.end(name)}}};return 1!==node.type||settings.inner?handlers[11](node):walk(node),writer.getContent()}}},traverse=function(node,fn){fn(node),node.firstChild&&traverse(node.firstChild,fn),node.next&&traverse(node.next,fn)},findMatchingNodes=function(nodeFilters,attributeFilters,node){var nodeMatches={},attrMatches={},matches=[];node.firstChild&&traverse(node.firstChild,function(node){each(nodeFilters,function(filter){filter.name===node.name&&(nodeMatches[filter.name]?nodeMatches[filter.name].nodes.push(node):nodeMatches[filter.name]={filter:filter,nodes:[node]})}),each(attributeFilters,function(filter){"string"==typeof node.attr(filter.name)&&(attrMatches[filter.name]?attrMatches[filter.name].nodes.push(node):attrMatches[filter.name]={filter:filter,nodes:[node]})})});for(var name_1 in nodeMatches)nodeMatches.hasOwnProperty(name_1)&&matches.push(nodeMatches[name_1]);for(var name_2 in attrMatches)attrMatches.hasOwnProperty(name_2)&&matches.push(attrMatches[name_2]);return matches},filter$2=function(nodeFilters,attributeFilters,node){var matches=findMatchingNodes(nodeFilters,attributeFilters,node);each(matches,function(match){each(match.filter.callbacks,function(callback){callback(match.nodes,match.filter.name,{})})})},hasFocus=function(element){var doc=owner(element).dom();return element.dom()===doc.activeElement},active=function(_doc){var doc=void 0!==_doc?_doc.dom():domGlobals.document;return Option.from(doc.activeElement).map(Element.fromDom)},search=function(element){return active(owner(element)).filter(function(e){return element.dom().contains(e.dom())})},generate$1=function(cases){if(!isArray(cases))throw new Error("cases must be an array");if(0===cases.length)throw new Error("there must be at least one case");var constructors=[],adt={};return each(cases,function(acase,count){var keys$1=keys(acase);if(1!==keys$1.length)throw new Error("one and only one name per case");var key=keys$1[0],value=acase[key];if(void 0!==adt[key])throw new Error("duplicate key detected:"+key);if("cata"===key)throw new Error("cannot have a case named cata (sorry)");if(!isArray(value))throw new Error("case arguments must be an array");constructors.push(key),adt[key]=function(){var argLength=arguments.length;if(argLength!==value.length)throw new Error("Wrong number of arguments to case "+key+". Expected "+value.length+" ("+value+"), got "+argLength);for(var args=new Array(argLength),i=0;i<args.length;i++)args[i]=arguments[i];var match=function(branches){var branchKeys=keys(branches);if(constructors.length!==branchKeys.length)throw new Error("Wrong number of arguments to match. Expected: "+constructors.join(",")+"\nActual: "+branchKeys.join(","));if(!forall(constructors,function(reqKey){return contains(branchKeys,reqKey)}))throw new Error("Not all branches were specified when using match. Specified: "+branchKeys.join(", ")+"\nRequired: "+constructors.join(", "));return branches[key].apply(null,args)};return{fold:function(){if(arguments.length!==cases.length)throw new Error("Wrong number of arguments to fold. Expected "+cases.length+", got "+arguments.length);return arguments[count].apply(null,args)},match:match,log:function(label){domGlobals.console.log(label,{constructors:constructors,constructor:key,params:args})}}}}),adt},Adt={generate:generate$1},create$3=Immutable("start","soffset","finish","foffset"),SimRange={create:create$3},adt=Adt.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),cata=function(subject,onBefore,onOn,onAfter){return subject.fold(onBefore,onOn,onAfter)},getStart=function(situ){return situ.fold(identity,identity,identity)},before$3=adt.before,on=adt.on,after$2=adt.after,Situ={before:before$3,on:on,after:after$2,cata:cata,getStart:getStart},adt$1=Adt.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),exactFromRange=function(simRange){return adt$1.exact(simRange.start(),simRange.soffset(),simRange.finish(),simRange.foffset())},getStart$1=function(selection){return selection.match({domRange:function(rng){return Element.fromDom(rng.startContainer)},relative:function(startSitu,finishSitu){return Situ.getStart(startSitu)},exact:function(start,soffset,finish,foffset){return start}})},domRange=adt$1.domRange,relative=adt$1.relative,exact=adt$1.exact,getWin=function(selection){var start=getStart$1(selection);return defaultView(start)},range=SimRange.create,Selection={domRange:domRange,relative:relative,exact:exact,exactFromRange:exactFromRange,getWin:getWin,range:range},browser$4=detect$3().browser,clamp=function(offset,element){var max=isText(element)?get$7(element).length:children(element).length+1;return offset>max?max:offset<0?0:offset},normalizeRng=function(rng){return Selection.range(rng.start(),clamp(rng.soffset(),rng.start()),rng.finish(),clamp(rng.foffset(),rng.finish()))},isOrContains=function(root,elm){return!NodeType.isRestrictedNode(elm.dom())&&(contains$2(root,elm)||eq(root,elm))},isRngInRoot=function(root){return function(rng){return isOrContains(root,rng.start())&&isOrContains(root,rng.finish())}},shouldStore=function(editor){return!0===editor.inline||browser$4.isIE()},nativeRangeToSelectionRange=function(r){return Selection.range(Element.fromDom(r.startContainer),r.startOffset,Element.fromDom(r.endContainer),r.endOffset)},readRange=function(win){var selection=win.getSelection();return(selection&&0!==selection.rangeCount?Option.from(selection.getRangeAt(0)):Option.none()).map(nativeRangeToSelectionRange)},getBookmark$2=function(root){var win=defaultView(root);return readRange(win.dom()).filter(isRngInRoot(root))},validate=function(root,bookmark){return Option.from(bookmark).filter(isRngInRoot(root)).map(normalizeRng)},bookmarkToNativeRng=function(bookmark){var rng=domGlobals.document.createRange();try{return rng.setStart(bookmark.start().dom(),bookmark.soffset()),rng.setEnd(bookmark.finish().dom(),bookmark.foffset()),Option.some(rng)}catch(_){return Option.none()}},store=function(editor){var newBookmark=shouldStore(editor)?getBookmark$2(Element.fromDom(editor.getBody())):Option.none();editor.bookmark=newBookmark.isSome()?newBookmark:editor.bookmark},storeNative=function(editor,rng){var root=Element.fromDom(editor.getBody()),range=shouldStore(editor)?Option.from(rng):Option.none(),newBookmark=range.map(nativeRangeToSelectionRange).filter(isRngInRoot(root));editor.bookmark=newBookmark.isSome()?newBookmark:editor.bookmark},getRng=function(editor){return(editor.bookmark?editor.bookmark:Option.none()).bind(function(x){return validate(Element.fromDom(editor.getBody()),x)}).bind(bookmarkToNativeRng)},restore=function(editor){getRng(editor).each(function(rng){editor.selection.setRng(rng)})},SelectionBookmark={store:store,storeNative:storeNative,readRange:readRange,restore:restore,getRng:getRng,getBookmark:getBookmark$2,validate:validate},isEditorUIElement=function(elm){var className=elm.className.toString();return-1!==className.indexOf("tox-")||-1!==className.indexOf("mce-")},FocusManager={isEditorUIElement:isEditorUIElement},isManualNodeChange=function(e){return"nodechange"===e.type&&e.selectionChange},registerPageMouseUp=function(editor,throttledStore){var mouseUpPage=function(){throttledStore.throttle()};DOMUtils$1.DOM.bind(domGlobals.document,"mouseup",mouseUpPage),editor.on("remove",function(){DOMUtils$1.DOM.unbind(domGlobals.document,"mouseup",mouseUpPage)})},registerFocusOut=function(editor){editor.on("focusout",function(){SelectionBookmark.store(editor)})},registerMouseUp=function(editor,throttledStore){editor.on("mouseup touchend",function(e){throttledStore.throttle()})},registerEditorEvents=function(editor,throttledStore){detect$3().browser.isIE()?registerFocusOut(editor):registerMouseUp(editor,throttledStore),editor.on("keyup NodeChange",function(e){isManualNodeChange(e)||SelectionBookmark.store(editor)})},register=function(editor){var throttledStore=first(function(){SelectionBookmark.store(editor)},0);editor.on("init",function(){editor.inline&&registerPageMouseUp(editor,throttledStore),registerEditorEvents(editor,throttledStore)}),editor.on("remove",function(){throttledStore.cancel()})},SelectionRestore={register:register},DOM$2=DOMUtils$1.DOM,isEditorUIElement$1=function(elm){return FocusManager.isEditorUIElement(elm)},isEditorContentAreaElement=function(elm){var classList=elm.classList;return void 0!==classList&&(classList.contains("tox-edit-area")||classList.contains("tox-edit-area__iframe")||classList.contains("mce-content-body"))},isUIElement=function(editor,elm){var customSelector=editor?editor.settings.custom_ui_selector:"";return null!==DOM$2.getParent(elm,function(elm){return isEditorUIElement$1(elm)||!!customSelector&&editor.dom.is(elm,customSelector)})},getActiveElement=function(){try{return domGlobals.document.activeElement}catch(ex){return domGlobals.document.body}},registerEvents=function(editorManager,e){var editor=e.editor;SelectionRestore.register(editor),editor.on("focusin",function(){var self=this,focusedEditor=editorManager.focusedEditor;focusedEditor!==self&&(focusedEditor&&focusedEditor.fire("blur",{focusedEditor:self}),editorManager.setActive(self),editorManager.focusedEditor=self,self.fire("focus",{blurredEditor:focusedEditor}),self.focus(!0))}),editor.on("focusout",function(){var self=this;Delay.setEditorTimeout(self,function(){var focusedEditor=editorManager.focusedEditor;isUIElement(self,getActiveElement())||focusedEditor!==self||(self.fire("blur",{focusedEditor:null}),editorManager.focusedEditor=null)})}),documentFocusInHandler||(documentFocusInHandler=function(e){var target,activeEditor=editorManager.activeEditor;target=e.target,activeEditor&&target.ownerDocument===domGlobals.document&&(target===domGlobals.document.body||isUIElement(activeEditor,target)||editorManager.focusedEditor!==activeEditor||(activeEditor.fire("blur",{focusedEditor:null}),editorManager.focusedEditor=null))},DOM$2.bind(domGlobals.document,"focusin",documentFocusInHandler))},unregisterDocumentEvents=function(editorManager,e){editorManager.focusedEditor===e.editor&&(editorManager.focusedEditor=null),editorManager.activeEditor||(DOM$2.unbind(domGlobals.document,"focusin",documentFocusInHandler),documentFocusInHandler=null)},setup$2=function(editorManager){editorManager.on("AddEditor",curry(registerEvents,editorManager)),editorManager.on("RemoveEditor",curry(unregisterDocumentEvents,editorManager))},FocusController={setup:setup$2,isEditorUIElement:isEditorUIElement$1,isEditorContentAreaElement:isEditorContentAreaElement,isUIElement:isUIElement},getContentEditableHost=function(editor,node){return editor.dom.getParent(node,function(node){return"true"===editor.dom.getContentEditable(node)})},getCollapsedNode=function(rng){return rng.collapsed?Option.from(getNode(rng.startContainer,rng.startOffset)).map(Element.fromDom):Option.none()},getFocusInElement=function(root,rng){return getCollapsedNode(rng).bind(function(node){return isTableSection(node)?Option.some(node):!1===contains$2(root,node)?Option.some(root):Option.none()})},normalizeSelection=function(editor,rng){getFocusInElement(Element.fromDom(editor.getBody()),rng).bind(function(elm){return CaretFinder.firstPositionIn(elm.dom())}).fold(function(){editor.selection.normalize()},function(caretPos){return editor.selection.setRng(caretPos.toRange())})},focusBody=function(body){if(body.setActive)try{body.setActive()}catch(ex){body.focus()}else body.focus()},hasElementFocus=function(elm){return hasFocus(elm)||search(elm).isSome()},hasIframeFocus=function(editor){return editor.iframeElement&&hasFocus(Element.fromDom(editor.iframeElement))},hasInlineFocus=function(editor){var rawBody=editor.getBody();return rawBody&&hasElementFocus(Element.fromDom(rawBody))},hasUiFocus=function(editor){return active().filter(function(elem){return!FocusController.isEditorContentAreaElement(elem.dom())&&FocusController.isUIElement(editor,elem.dom())}).isSome()},hasFocus$1=function(editor){return editor.inline?hasInlineFocus(editor):hasIframeFocus(editor)},hasEditorOrUiFocus=function(editor){return hasFocus$1(editor)||hasUiFocus(editor)},focusEditor=function(editor){var selection=editor.selection,body=editor.getBody(),rng=selection.getRng();editor.quirks.refreshContentEditable(),void 0!==editor.bookmark&&!1===hasFocus$1(editor)&&SelectionBookmark.getRng(editor).each(function(bookmarkRng){editor.selection.setRng(bookmarkRng),rng=bookmarkRng});var contentEditableHost=getContentEditableHost(editor,selection.getNode());if(editor.$.contains(body,contentEditableHost))return focusBody(contentEditableHost),normalizeSelection(editor,rng),void activateEditor(editor);editor.inline||(Env.opera||focusBody(body),editor.getWin().focus()),(Env.gecko||editor.inline)&&(focusBody(body),normalizeSelection(editor,rng)),activateEditor(editor)},activateEditor=function(editor){return editor.editorManager.setActive(editor)},focus=function(editor,skipFocus){editor.removed||(skipFocus?activateEditor(editor):focusEditor(editor))},EditorFocus={focus:focus,hasFocus:hasFocus$1,hasEditorOrUiFocus:hasEditorOrUiFocus},isTreeNode=function(content){return content instanceof Node$1},moveSelection=function(editor){EditorFocus.hasFocus(editor)&&CaretFinder.firstPositionIn(editor.getBody()).each(function(pos){var node=pos.getNode(),caretPos=NodeType.isTable(node)?CaretFinder.firstPositionIn(node).getOr(pos):pos;editor.selection.setRng(caretPos.toRange())})},setEditorHtml=function(editor,html){editor.dom.setHTML(editor.getBody(),html),moveSelection(editor)},setContentString=function(editor,body,content,args){var forcedRootBlockName,padd;return 0===content.length||/^\s+$/.test(content)?(padd='<br data-mce-bogus="1">',"TABLE"===body.nodeName?content="<tr><td>"+padd+"</td></tr>":/^(UL|OL)$/.test(body.nodeName)&&(content="<li>"+padd+"</li>"),forcedRootBlockName=Settings.getForcedRootBlock(editor),forcedRootBlockName&&editor.schema.isValidChild(body.nodeName.toLowerCase(),forcedRootBlockName.toLowerCase())?(content=padd,content=editor.dom.createHTML(forcedRootBlockName,editor.settings.forced_root_block_attrs,content)):content||(content='<br data-mce-bogus="1">'),setEditorHtml(editor,content),editor.fire("SetContent",args)):("raw"!==args.format&&(content=Serializer({validate:editor.validate},editor.schema).serialize(editor.parser.parse(content,{isRootContent:!0,insert:!0}))),args.content=isWsPreserveElement(Element.fromDom(body))?content:Tools.trim(content),setEditorHtml(editor,args.content),args.no_events||editor.fire("SetContent",args)),args.content},setContentTree=function(editor,body,content,args){filter$2(editor.parser.getNodeFilters(),editor.parser.getAttributeFilters(),content);var html=Serializer({validate:editor.validate},editor.schema).serialize(content);return args.content=isWsPreserveElement(Element.fromDom(body))?html:Tools.trim(html),setEditorHtml(editor,args.content),args.no_events||editor.fire("SetContent",args),content},setContent=function(editor,content,args){return void 0===args&&(args={}),args.format=args.format?args.format:"html",args.set=!0,args.content=isTreeNode(content)?"":content,isTreeNode(content)||args.no_events||(editor.fire("BeforeSetContent",args),content=args.content),Option.from(editor.getBody()).fold(constant(content),function(body){return isTreeNode(content)?setContentTree(editor,body,content,args):setContentString(editor,body,content,args)})},firePreProcess=function(editor,args){return editor.fire("PreProcess",args)},firePostProcess=function(editor,args){return editor.fire("PostProcess",args)},fireRemove=function(editor){return editor.fire("remove")},fireDetach=function(editor){return editor.fire("detach")},fireSwitchMode=function(editor,mode){return editor.fire("SwitchMode",{mode:mode})},fireObjectResizeStart=function(editor,target,width,height){editor.fire("ObjectResizeStart",{target:target,width:width,height:height})},fireObjectResized=function(editor,target,width,height){editor.fire("ObjectResized",{target:target,width:width,height:height})},firePreInit=function(editor){return editor.fire("PreInit")},firePostRender=function(editor){return editor.fire("PostRender")},fireInit=function(editor){return editor.fire("Init")},firePlaceholderToggle=function(editor,state){return editor.fire("PlaceholderToggle",{state:state})},fireError=function(editor,errorType,error){return editor.fire(errorType,error)},DOM$3=DOMUtils$1.DOM,restoreOriginalStyles=function(editor){DOM$3.setStyle(editor.id,"display",editor.orgDisplay)},safeDestroy=function(x){return Option.from(x).each(function(x){return x.destroy()})},clearDomReferences=function(editor){editor.contentAreaContainer=editor.formElement=editor.container=editor.editorContainer=null,editor.bodyElement=editor.contentDocument=editor.contentWindow=null,editor.iframeElement=editor.targetElm=null,editor.selection&&(editor.selection=editor.selection.win=editor.selection.dom=editor.selection.dom.doc=null)},restoreForm=function(editor){var form=editor.formElement;form&&(form._mceOldSubmit&&(form.submit=form._mceOldSubmit,form._mceOldSubmit=null),DOM$3.unbind(form,"submit reset",editor.formEventDelegate))},remove$6=function(editor){if(!editor.removed){var _selectionOverrides=editor._selectionOverrides,editorUpload=editor.editorUpload,body=editor.getBody(),element=editor.getElement();body&&editor.save({is_removing:!0}),editor.removed=!0,editor.unbindAllNativeEvents(),editor.hasHiddenInput&&element&&DOM$3.remove(element.nextSibling),fireRemove(editor),editor.editorManager.remove(editor),!editor.inline&&body&&restoreOriginalStyles(editor),fireDetach(editor),DOM$3.remove(editor.getContainer()),safeDestroy(_selectionOverrides),safeDestroy(editorUpload),editor.destroy()}},destroy=function(editor,automatic){var selection=editor.selection,dom=editor.dom;if(!editor.destroyed){if(!automatic&&!editor.removed)return void editor.remove();automatic||(editor.editorManager.off("beforeunload",editor._beforeUnload),editor.theme&&editor.theme.destroy&&editor.theme.destroy(),safeDestroy(selection),safeDestroy(dom)),restoreForm(editor),clearDomReferences(editor),editor.destroyed=!0}},hasOwnProperty$2=Object.prototype.hasOwnProperty,deep$1=function(old,nu){return isObject(old)&&isObject(nu)?deepMerge(old,nu):nu},deepMerge=function(merger){return function(){for(var objects=new Array(arguments.length),i=0;i<objects.length;i++)objects[i]=arguments[i];if(0===objects.length)throw new Error("Can't merge zero objects");for(var ret={},j=0;j<objects.length;j++){var curObject=objects[j];for(var key in curObject)hasOwnProperty$2.call(curObject,key)&&(ret[key]=merger(ret[key],curObject[key]))}return ret}}(deep$1),sectionResult=Immutable("sections","settings"),deviceDetection=detect$3().deviceType,isTouch=deviceDetection.isTouch(),isPhone=deviceDetection.isPhone(),isTablet=deviceDetection.isTablet(),legacyMobilePlugins=["lists","autolink","autosave"],defaultTouchSettings={table_grid:!1,object_resizing:!1,resize:!1},normalizePlugins=function(plugins){var pluginNames=isArray(plugins)?plugins.join(" "):plugins,trimmedPlugins=map(isString(pluginNames)?pluginNames.split(" "):[],trim);return filter(trimmedPlugins,function(item){return item.length>0})},filterLegacyMobilePlugins=function(plugins){return filter(plugins,curry(contains,legacyMobilePlugins))},extractSections=function(keys,settings){var result=bifilter(settings,function(value,key){return contains(keys,key)});return sectionResult(result.t,result.f)},getSection=function(sectionResult,name,defaults){void 0===defaults&&(defaults={});var sections=sectionResult.sections(),sectionSettings=sections.hasOwnProperty(name)?sections[name]:{};return Tools.extend({},defaults,sectionSettings)},hasSection=function(sectionResult,name){return sectionResult.sections().hasOwnProperty(name)},isSectionTheme=function(sectionResult,name,theme){var section=sectionResult.sections();return hasSection(sectionResult,name)&&section[name].theme===theme},getSectionConfig=function(sectionResult,name){return hasSection(sectionResult,name)?sectionResult.sections()[name]:{}},getToolbarMode=function(settings,defaultVal){return get(settings,"toolbar_mode").orThunk(function(){return get(settings,"toolbar_drawer").map(function(val){return!1===val?"wrap":val})}).getOr(defaultVal)},getDefaultSettings=function(settings,id,documentBaseUrl,isTouch,editor){var baseDefaults={id:id,theme:"silver",toolbar_mode:getToolbarMode(settings,"floating"),plugins:"",document_base_url:documentBaseUrl,add_form_submit_trigger:!0,submit_patch:!0,add_unload_trigger:!0,convert_urls:!0,relative_urls:!0,remove_script_host:!0,object_resizing:!0,doctype:"<!DOCTYPE html>",visual:!0,font_size_legacy_values:"xx-small,small,medium,large,x-large,xx-large,300%",forced_root_block:"p",hidden_input:!0,inline_styles:!0,convert_fonts_to_spans:!0,indent:!0,indent_before:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",indent_after:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",entity_encoding:"named",url_converter:editor.convertURL,url_converter_scope:editor};return __assign(__assign({},baseDefaults),isTouch?defaultTouchSettings:{})},getDefaultMobileSettings=function(settings,isPhone){var defaultMobileSettings={resize:!1,toolbar_mode:getToolbarMode(settings,"scrolling"),toolbar_sticky:!1},defaultPhoneSettings={menubar:!1};return __assign(__assign(__assign({},defaultTouchSettings),defaultMobileSettings),isPhone?defaultPhoneSettings:{})},getExternalPlugins=function(overrideSettings,settings){var userDefinedExternalPlugins=settings.external_plugins?settings.external_plugins:{};return overrideSettings&&overrideSettings.external_plugins?Tools.extend({},overrideSettings.external_plugins,userDefinedExternalPlugins):userDefinedExternalPlugins},combinePlugins=function(forcedPlugins,plugins){return[].concat(normalizePlugins(forcedPlugins)).concat(normalizePlugins(plugins))},processPlugins=function(isMobileDevice,sectionResult,defaultOverrideSettings,settings){var forcedPlugins=normalizePlugins(defaultOverrideSettings.forced_plugins),desktopPlugins=normalizePlugins(settings.plugins),mobileConfig=getSectionConfig(sectionResult,"mobile"),mobilePlugins=mobileConfig.plugins?normalizePlugins(mobileConfig.plugins):desktopPlugins,platformPlugins=isMobileDevice&&isSectionTheme(sectionResult,"mobile","mobile")?filterLegacyMobilePlugins(mobilePlugins):isMobileDevice&&hasSection(sectionResult,"mobile")?mobilePlugins:desktopPlugins,combinedPlugins=combinePlugins(forcedPlugins,platformPlugins);return Tools.extend(settings,{plugins:combinedPlugins.join(" ")})},isOnMobile=function(isMobileDevice,sectionResult){return isMobileDevice&&hasSection(sectionResult,"mobile")},combineSettings=function(isMobileDevice,isPhone,defaultSettings,defaultOverrideSettings,settings){var defaultDeviceSettings=isMobileDevice?{mobile:getDefaultMobileSettings(settings,isPhone)}:{},sectionResult=extractSections(["mobile"],deepMerge(defaultDeviceSettings,settings)),extendedSettings=Tools.extend(defaultSettings,defaultOverrideSettings,sectionResult.settings(),isOnMobile(isMobileDevice,sectionResult)?getSection(sectionResult,"mobile"):{},{validate:!0,external_plugins:getExternalPlugins(defaultOverrideSettings,sectionResult.settings())});return processPlugins(isMobileDevice,sectionResult,defaultOverrideSettings,extendedSettings)},getEditorSettings=function(editor,id,documentBaseUrl,defaultOverrideSettings,settings){var defaultSettings=getDefaultSettings(settings,id,documentBaseUrl,isTouch,editor);return combineSettings(isPhone||isTablet,isPhone,defaultSettings,defaultOverrideSettings,settings)},getFiltered=function(predicate,editor,name){return Option.from(editor.settings[name]).filter(predicate)},getParamObject=function(value){var output={};return"string"==typeof value?each(value.indexOf("=")>0?value.split(/[;,](?![^=;,]*(?:[;,]|$))/):value.split(","),function(val){var arr=val.split("=");arr.length>1?output[Tools.trim(arr[0])]=Tools.trim(arr[1]):output[Tools.trim(arr[0])]=Tools.trim(arr[0])}):output=value,output},isArrayOf=function(p){return function(a){return isArray(a)&&forall(a,p)}},getParam=function(editor,name,defaultVal,type){var value=name in editor.settings?editor.settings[name]:defaultVal;return"hash"===type?getParamObject(value):"string"===type?getFiltered(isString,editor,name).getOr(defaultVal):"number"===type?getFiltered(isNumber,editor,name).getOr(defaultVal):"boolean"===type?getFiltered(isBoolean,editor,name).getOr(defaultVal):"object"===type?getFiltered(isObject,editor,name).getOr(defaultVal):"array"===type?getFiltered(isArray,editor,name).getOr(defaultVal):"string[]"===type?getFiltered(isArrayOf(isString),editor,name).getOr(defaultVal):"function"===type?getFiltered(isFunction,editor,name).getOr(defaultVal):value},IconManager=function(){var lookup={};return{add:function(id,iconPack){lookup[id]=iconPack},get:function(id){return lookup[id]?lookup[id]:{icons:{}}},has:function(id){return has(lookup,id)}}}(),getProp=function(propName,elm){return elm.dom()[propName]},getComputedSizeProp=function(propName,elm){return parseInt(get$4(elm,propName),10)},getClientWidth=curry(getProp,"clientWidth"),getClientHeight=curry(getProp,"clientHeight"),getMarginTop=curry(getComputedSizeProp,"margin-top"),getMarginLeft=curry(getComputedSizeProp,"margin-left"),getBoundingClientRect$1=function(elm){return elm.dom().getBoundingClientRect()},isInsideElementContentArea=function(bodyElm,clientX,clientY){var clientWidth=getClientWidth(bodyElm),clientHeight=getClientHeight(bodyElm);return clientX>=0&&clientY>=0&&clientX<=clientWidth&&clientY<=clientHeight},transpose=function(inline,elm,clientX,clientY){var clientRect=getBoundingClientRect$1(elm);return{x:clientX-(inline?clientRect.left+elm.dom().clientLeft+getMarginLeft(elm):0),y:clientY-(inline?clientRect.top+elm.dom().clientTop+getMarginTop(elm):0)}},isXYInContentArea=function(editor,clientX,clientY){var bodyElm=Element.fromDom(editor.getBody()),targetElm=editor.inline?bodyElm:documentElement(bodyElm),transposedPoint=transpose(editor.inline,targetElm,clientX,clientY);return isInsideElementContentArea(targetElm,transposedPoint.x,transposedPoint.y)},fromDomSafe=function(node){return Option.from(node).map(Element.fromDom)},isEditorAttachedToDom=function(editor){var rawContainer=editor.inline?editor.getBody():editor.getContentAreaContainer();return fromDomSafe(rawContainer).map(function(container){return contains$2(owner(container),container)}).getOr(!1)},EditorView={isXYInContentArea:isXYInContentArea,isEditorAttachedToDom:isEditorAttachedToDom},PluginManager=AddOnManager$1.PluginManager,ThemeManager=AddOnManager$1.ThemeManager,WindowManager=function(editor){var dialogs=[],getImplementation=function(){var theme=editor.theme;return theme&&theme.getWindowManagerImpl?theme.getWindowManagerImpl():WindowManagerImpl()},funcBind=function(scope,f){return function(){return f?f.apply(scope,arguments):void 0}},fireOpenEvent=function(dialog){editor.fire("OpenWindow",{dialog:dialog})},fireCloseEvent=function(dialog){editor.fire("CloseWindow",{dialog:dialog})},addDialog=function(dialog){dialogs.push(dialog),fireOpenEvent(dialog)},closeDialog=function(dialog){fireCloseEvent(dialog),dialogs=filter(dialogs,function(otherDialog){return otherDialog!==dialog}),0===dialogs.length&&editor.focus()},getTopDialog=function(){return Option.from(dialogs[dialogs.length-1])},storeSelectionAndOpenDialog=function(openDialog){editor.editorManager.setActive(editor),SelectionBookmark.store(editor);var dialog=openDialog();return addDialog(dialog),dialog},open=function(args,params){return storeSelectionAndOpenDialog(function(){return getImplementation().open(args,params,closeDialog)})},openUrl=function(args){return storeSelectionAndOpenDialog(function(){return getImplementation().openUrl(args,closeDialog)})},alert=function(message,callback,scope){getImplementation().alert(message,funcBind(scope||this,callback))},confirm=function(message,callback,scope){getImplementation().confirm(message,funcBind(scope||this,callback))},close=function(){getTopDialog().each(function(dialog){getImplementation().close(dialog),closeDialog(dialog)})};return editor.on("remove",function(){each(dialogs,function(dialog){getImplementation().close(dialog)})}),{open:open,openUrl:openUrl,alert:alert,confirm:confirm,close:close}},displayNotification=function(editor,message){editor.notificationManager.open({type:"error",text:message})},displayError=function(editor,message){editor._skinLoaded?displayNotification(editor,message):editor.on("SkinLoaded",function(){displayNotification(editor,message)})},uploadError=function(editor,message){displayError(editor,I18n.translate(["Failed to upload image: {0}",message]))},logError=function(editor,errorType,msg){fireError(editor,errorType,{message:msg}),domGlobals.console.error(msg)},createLoadError=function(type,url,name){return name?"Failed to load "+type+": "+name+" from url "+url:"Failed to load "+type+" url: "+url},pluginLoadError=function(editor,url,name){logError(editor,"PluginLoadError",createLoadError("plugin",url,name))},iconsLoadError=function(editor,url,name){logError(editor,"IconsLoadError",createLoadError("icons",url,name))},languageLoadError=function(editor,url,name){logError(editor,"LanguageLoadError",createLoadError("language",url,name))},pluginInitError=function(editor,name,err){var message=I18n.translate(["Failed to initialize plugin: {0}",name]);initError(message,err),displayError(editor,message)},initError=function(message){for(var x=[],_i=1;_i<arguments.length;_i++)x[_i-1]=arguments[_i];var console=domGlobals.window.console;console&&(console.error?console.error.apply(console,arguments):console.log.apply(console,arguments))},ErrorReporter={pluginLoadError:pluginLoadError,iconsLoadError:iconsLoadError,languageLoadError:languageLoadError,pluginInitError:pluginInitError,uploadError:uploadError,displayError:displayError,initError:initError},getAll=function(){return{"accessibility-check":'<svg width="24" height="24"><path d="M12 2a2 2 0 0 1 2 2 2 2 0 0 1-2 2 2 2 0 0 1-2-2c0-1.1.9-2 2-2zm8 7h-5v12c0 .6-.4 1-1 1a1 1 0 0 1-1-1v-5c0-.6-.4-1-1-1a1 1 0 0 0-1 1v5c0 .6-.4 1-1 1a1 1 0 0 1-1-1V9H4a1 1 0 1 1 0-2h16c.6 0 1 .4 1 1s-.4 1-1 1z" fill-rule="nonzero"/></svg>',"action-next":'<svg width="24" height="24"><path fill-rule="nonzero" d="M5.7 7.3a1 1 0 0 0-1.4 1.4l7.7 7.7 7.7-7.7a1 1 0 1 0-1.4-1.4L12 13.6 5.7 7.3z"/></svg>',"action-prev":'<svg width="24" height="24"><path fill-rule="nonzero" d="M18.3 15.7a1 1 0 0 0 1.4-1.4L12 6.6l-7.7 7.7a1 1 0 0 0 1.4 1.4L12 9.4l6.3 6.3z"/></svg>',"align-center":'<svg width="24" height="24"><path d="M5 5h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 1 1 0-2zm3 4h8c.6 0 1 .4 1 1s-.4 1-1 1H8a1 1 0 1 1 0-2zm0 8h8c.6 0 1 .4 1 1s-.4 1-1 1H8a1 1 0 0 1 0-2zm-3-4h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 0 1 0-2z" fill-rule="evenodd"/></svg>',"align-justify":'<svg width="24" height="24"><path d="M5 5h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 1 1 0-2zm0 4h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 1 1 0-2zm0 4h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 0 1 0-2zm0 4h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 0 1 0-2z" fill-rule="evenodd"/></svg>',"align-left":'<svg width="24" height="24"><path d="M5 5h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 1 1 0-2zm0 4h8c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 1 1 0-2zm0 8h8c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 0 1 0-2zm0-4h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 0 1 0-2z" fill-rule="evenodd"/></svg>',"align-none":'<svg width="24" height="24"><path d="M14.2 5L13 7H5a1 1 0 1 1 0-2h9.2zm4 0h.8a1 1 0 0 1 0 2h-2l1.2-2zm-6.4 4l-1.2 2H5a1 1 0 0 1 0-2h6.8zm4 0H19a1 1 0 0 1 0 2h-4.4l1.2-2zm-6.4 4l-1.2 2H5a1 1 0 0 1 0-2h4.4zm4 0H19a1 1 0 0 1 0 2h-6.8l1.2-2zM7 17l-1.2 2H5a1 1 0 0 1 0-2h2zm4 0h8a1 1 0 0 1 0 2H9.8l1.2-2zm5.2-13.5l1.3.7-9.7 16.3-1.3-.7 9.7-16.3z" fill-rule="evenodd"/></svg>',"align-right":'<svg width="24" height="24"><path d="M5 5h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 1 1 0-2zm6 4h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zm0 8h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zm-6-4h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 0 1 0-2z" fill-rule="evenodd"/></svg>',"arrow-left":'<svg width="24" height="24"><path d="M5.6 13l12 6a1 1 0 0 0 1.4-1V6a1 1 0 0 0-1.4-.9l-12 6a1 1 0 0 0 0 1.8z" fill-rule="evenodd"/></svg>',"arrow-right":'<svg width="24" height="24"><path d="M18.5 13l-12 6A1 1 0 0 1 5 18V6a1 1 0 0 1 1.4-.9l12 6a1 1 0 0 1 0 1.8z" fill-rule="evenodd"/></svg>',bold:'<svg width="24" height="24"><path d="M7.8 19c-.3 0-.5 0-.6-.2l-.2-.5V5.7c0-.2 0-.4.2-.5l.6-.2h5c1.5 0 2.7.3 3.5 1 .7.6 1.1 1.4 1.1 2.5a3 3 0 0 1-.6 1.9c-.4.6-1 1-1.6 1.2.4.1.9.3 1.3.6s.8.7 1 1.2c.4.4.5 1 .5 1.6 0 1.3-.4 2.3-1.3 3-.8.7-2.1 1-3.8 1H7.8zm5-8.3c.6 0 1.2-.1 1.6-.5.4-.3.6-.7.6-1.3 0-1.1-.8-1.7-2.3-1.7H9.3v3.5h3.4zm.5 6c.7 0 1.3-.1 1.7-.4.4-.4.6-.9.6-1.5s-.2-1-.7-1.4c-.4-.3-1-.4-2-.4H9.4v3.8h4z" fill-rule="evenodd"/></svg>',bookmark:'<svg width="24" height="24"><path d="M6 4v17l6-4 6 4V4c0-.6-.4-1-1-1H7a1 1 0 0 0-1 1z" fill-rule="nonzero"/></svg>',"border-width":'<svg width="24" height="24"><path d="M5 14.8h14a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2zm-.5 3.7h15c.3 0 .5.2.5.5s-.2.5-.5.5h-15a.5.5 0 1 1 0-1zm.5-8.3h14c.6 0 1 .4 1 1v1c0 .5-.4 1-1 1H5a1 1 0 0 1-1-1v-1c0-.6.4-1 1-1zm0-5.7h14c.6 0 1 .4 1 1v2c0 .6-.4 1-1 1H5a1 1 0 0 1-1-1v-2c0-.6.4-1 1-1z" fill-rule="evenodd"/></svg>',brightness:'<svg width="24" height="24"><path d="M12 17c.3 0 .5.1.7.3.2.2.3.4.3.7v1c0 .3-.1.5-.3.7a1 1 0 0 1-.7.3 1 1 0 0 1-.7-.3 1 1 0 0 1-.3-.7v-1c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3zm0-10a1 1 0 0 1-.7-.3A1 1 0 0 1 11 6V5c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3.3 0 .5.1.7.3.2.2.3.4.3.7v1c0 .3-.1.5-.3.7a1 1 0 0 1-.7.3zm7 4c.3 0 .5.1.7.3.2.2.3.4.3.7 0 .3-.1.5-.3.7a1 1 0 0 1-.7.3h-1a1 1 0 0 1-.7-.3 1 1 0 0 1-.3-.7c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3h1zM7 12c0 .3-.1.5-.3.7a1 1 0 0 1-.7.3H5a1 1 0 0 1-.7-.3A1 1 0 0 1 4 12c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3h1c.3 0 .5.1.7.3.2.2.3.4.3.7zm10 3.5l.7.8c.2.1.3.4.3.6 0 .3-.1.6-.3.8a1 1 0 0 1-.8.3 1 1 0 0 1-.6-.3l-.8-.7a1 1 0 0 1-.3-.8c0-.2.1-.5.3-.7a1 1 0 0 1 1.4 0zm-10-7l-.7-.8a1 1 0 0 1-.3-.6c0-.3.1-.6.3-.8.2-.2.5-.3.8-.3.2 0 .5.1.7.3l.7.7c.2.2.3.5.3.8 0 .2-.1.5-.3.7a1 1 0 0 1-.7.3 1 1 0 0 1-.8-.3zm10 0a1 1 0 0 1-.8.3 1 1 0 0 1-.7-.3 1 1 0 0 1-.3-.7c0-.3.1-.6.3-.8l.8-.7c.1-.2.4-.3.6-.3.3 0 .6.1.8.3.2.2.3.5.3.8 0 .2-.1.5-.3.7l-.7.7zm-10 7c.2-.2.5-.3.8-.3.2 0 .5.1.7.3a1 1 0 0 1 0 1.4l-.8.8a1 1 0 0 1-.6.3 1 1 0 0 1-.8-.3 1 1 0 0 1-.3-.8c0-.2.1-.5.3-.6l.7-.8zM12 8a4 4 0 0 1 3.7 2.4 4 4 0 0 1 0 3.2A4 4 0 0 1 12 16a4 4 0 0 1-3.7-2.4 4 4 0 0 1 0-3.2A4 4 0 0 1 12 8zm0 6.5c.7 0 1.3-.2 1.8-.7.5-.5.7-1.1.7-1.8s-.2-1.3-.7-1.8c-.5-.5-1.1-.7-1.8-.7s-1.3.2-1.8.7c-.5.5-.7 1.1-.7 1.8s.2 1.3.7 1.8c.5.5 1.1.7 1.8.7z" fill-rule="evenodd"/></svg>',browse:'<svg width="24" height="24"><path d="M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2h-4v-2h4V8H5v10h4v2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zm-8 9.4l-2.3 2.3a1 1 0 1 1-1.4-1.4l4-4a1 1 0 0 1 1.4 0l4 4a1 1 0 0 1-1.4 1.4L13 13.4V20a1 1 0 0 1-2 0v-6.6z" fill-rule="nonzero"/></svg>',cancel:'<svg width="24" height="24"><path d="M12 4.6a7.4 7.4 0 1 1 0 14.8 7.4 7.4 0 0 1 0-14.8zM12 3a9 9 0 1 0 0 18 9 9 0 0 0 0-18zm0 8L14.8 8l1 1.1-2.7 2.8 2.7 2.7-1.1 1.1-2.7-2.7-2.7 2.7-1-1.1 2.6-2.7-2.7-2.7 1-1.1 2.8 2.7z" fill-rule="nonzero"/></svg>',"change-case":'<svg width="24" height="24"><path d="M18.4 18.2v-.6c-.5.8-1.3 1.2-2.4 1.2-2.2 0-3.3-1.6-3.3-4.8 0-3.1 1-4.7 3.3-4.7 1.1 0 1.8.3 2.4 1.1v-.6c0-.5.4-.8.8-.8s.8.3.8.8v8.4c0 .5-.4.8-.8.8a.8.8 0 0 1-.8-.8zm-2-7.4c-1.3 0-1.8.9-1.8 3.2 0 2.4.5 3.3 1.7 3.3 1.3 0 1.8-.9 1.8-3.2 0-2.4-.5-3.3-1.7-3.3zM10 15.7H5.5l-.8 2.6a1 1 0 0 1-1 .7h-.2a.7.7 0 0 1-.7-1l4-12a1 1 0 1 1 2 0l4 12a.7.7 0 0 1-.8 1h-.2a1 1 0 0 1-1-.7l-.8-2.6zm-.3-1.5l-2-6.5-1.9 6.5h3.9z" fill-rule="evenodd"/></svg>',"character-count":'<svg width="24" height="24"><path d="M4 11.5h16v1H4v-1zm4.8-6.8V10H7.7V5.8h-1v-1h2zM11 8.3V9h2v1h-3V7.7l2-1v-.9h-2v-1h3v2.4l-2 1zm6.3-3.4V10h-3.1V9h2.1V8h-2.1V6.8h2.1v-1h-2.1v-1h3.1zM5.8 16.4c0-.5.2-.8.5-1 .2-.2.6-.3 1.2-.3l.8.1c.2 0 .4.2.5.3l.4.4v2.8l.2.3H8.2v-.1-.2l-.6.3H7c-.4 0-.7 0-1-.2a1 1 0 0 1-.3-.9c0-.3 0-.6.3-.8.3-.2.7-.4 1.2-.4l.6-.2h.3v-.2l-.1-.2a.8.8 0 0 0-.5-.1 1 1 0 0 0-.4 0l-.3.4h-1zm2.3.8h-.2l-.2.1-.4.1a1 1 0 0 0-.4.2l-.2.2.1.3.5.1h.4l.4-.4v-.6zm2-3.4h1.2v1.7l.5-.3h.5c.5 0 .9.1 1.2.5.3.4.5.8.5 1.4 0 .6-.2 1.1-.5 1.5-.3.4-.7.6-1.3.6l-.6-.1-.4-.4v.4h-1.1v-5.4zm1.1 3.3c0 .3 0 .6.2.8a.7.7 0 0 0 1.2 0l.2-.8c0-.4 0-.6-.2-.8a.7.7 0 0 0-.6-.3l-.6.3-.2.8zm6.1-.5c0-.2 0-.3-.2-.4a.8.8 0 0 0-.5-.2c-.3 0-.5.1-.6.3l-.2.9c0 .3 0 .6.2.8.1.2.3.3.6.3.2 0 .4 0 .5-.2l.2-.4h1.1c0 .5-.3.8-.6 1.1a2 2 0 0 1-1.3.4c-.5 0-1-.2-1.3-.6a2 2 0 0 1-.5-1.4c0-.6.1-1.1.5-1.5.3-.4.8-.5 1.4-.5.5 0 1 0 1.2.3.4.3.5.7.5 1.2h-1v-.1z" fill-rule="evenodd"/></svg>',"checklist-rtl":'<svg width="24" height="24"><path d="M5 17h8c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 0 1 0-2zm0-6h8c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 0 1 0-2zm0-6h8c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 1 1 0-2zm14.2 11c.2-.4.6-.5.9-.3.3.2.4.6.2 1L18 20c-.2.3-.7.4-1 0l-1.3-1.3a.7.7 0 0 1 0-1c.3-.2.7-.2 1 0l.7.9 1.7-2.8zm0-6c.2-.4.6-.5.9-.3.3.2.4.6.2 1L18 14c-.2.3-.7.4-1 0l-1.3-1.3a.7.7 0 0 1 0-1c.3-.2.7-.2 1 0l.7.9 1.7-2.8zm0-6c.2-.4.6-.5.9-.3.3.2.4.6.2 1L18 8c-.2.3-.7.4-1 0l-1.3-1.3a.7.7 0 0 1 0-1c.3-.2.7-.2 1 0l.7.9 1.7-2.8z" fill-rule="evenodd"/></svg>',checklist:'<svg width="24" height="24"><path d="M11 17h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zm0-6h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zm0-6h8a1 1 0 0 1 0 2h-8a1 1 0 0 1 0-2zM7.2 16c.2-.4.6-.5.9-.3.3.2.4.6.2 1L6 20c-.2.3-.7.4-1 0l-1.3-1.3a.7.7 0 0 1 0-1c.3-.2.7-.2 1 0l.7.9 1.7-2.8zm0-6c.2-.4.6-.5.9-.3.3.2.4.6.2 1L6 14c-.2.3-.7.4-1 0l-1.3-1.3a.7.7 0 0 1 0-1c.3-.2.7-.2 1 0l.7.9 1.7-2.8zm0-6c.2-.4.6-.5.9-.3.3.2.4.6.2 1L6 8c-.2.3-.7.4-1 0L3.8 6.9a.7.7 0 0 1 0-1c.3-.2.7-.2 1 0l.7.9 1.7-2.8z" fill-rule="evenodd"/></svg>',checkmark:'<svg width="24" height="24"><path d="M18.2 5.4a1 1 0 0 1 1.6 1.2l-8 12a1 1 0 0 1-1.5.1l-5-5a1 1 0 1 1 1.4-1.4l4.1 4.1 7.4-11z" fill-rule="nonzero"/></svg>',"chevron-down":'<svg width="10" height="10"><path d="M8.7 2.2c.3-.3.8-.3 1 0 .4.4.4.9 0 1.2L5.7 7.8c-.3.3-.9.3-1.2 0L.2 3.4a.8.8 0 0 1 0-1.2c.3-.3.8-.3 1.1 0L5 6l3.7-3.8z" fill-rule="nonzero"/></svg>',"chevron-left":'<svg width="10" height="10"><path d="M7.8 1.3L4 5l3.8 3.7c.3.3.3.8 0 1-.4.4-.9.4-1.2 0L2.2 5.7a.8.8 0 0 1 0-1.2L6.6.2C7 0 7.4 0 7.8.2c.3.3.3.8 0 1.1z" fill-rule="nonzero"/></svg>',"chevron-right":'<svg width="10" height="10"><path d="M2.2 1.3a.8.8 0 0 1 0-1c.4-.4.9-.4 1.2 0l4.4 4.1c.3.4.3.9 0 1.2L3.4 9.8c-.3.3-.8.3-1.2 0a.8.8 0 0 1 0-1.1L6 5 2.2 1.3z" fill-rule="nonzero"/></svg>',"chevron-up":'<svg width="10" height="10"><path d="M8.7 7.8L5 4 1.3 7.8c-.3.3-.8.3-1 0a.8.8 0 0 1 0-1.2l4.1-4.4c.3-.3.9-.3 1.2 0l4.2 4.4c.3.3.3.9 0 1.2-.3.3-.8.3-1.1 0z" fill-rule="nonzero"/></svg>',close:'<svg width="24" height="24"><path d="M17.3 8.2L13.4 12l3.9 3.8a1 1 0 0 1-1.5 1.5L12 13.4l-3.8 3.9a1 1 0 0 1-1.5-1.5l3.9-3.8-3.9-3.8a1 1 0 0 1 1.5-1.5l3.8 3.9 3.8-3.9a1 1 0 0 1 1.5 1.5z" fill-rule="evenodd"/></svg>',"code-sample":'<svg width="24" height="26"><path d="M7.1 11a2.8 2.8 0 0 1-.8 2 2.8 2.8 0 0 1 .8 2v1.7c0 .3.1.6.4.8.2.3.5.4.8.4.3 0 .4.2.4.4v.8c0 .2-.1.4-.4.4-.7 0-1.4-.3-2-.8-.5-.6-.8-1.3-.8-2V15c0-.3-.1-.6-.4-.8-.2-.3-.5-.4-.8-.4a.4.4 0 0 1-.4-.4v-.8c0-.2.2-.4.4-.4.3 0 .6-.1.8-.4.3-.2.4-.5.4-.8V9.3c0-.7.3-1.4.8-2 .6-.5 1.3-.8 2-.8.3 0 .4.2.4.4v.8c0 .2-.1.4-.4.4-.3 0-.6.1-.8.4-.3.2-.4.5-.4.8V11zm9.8 0V9.3c0-.3-.1-.6-.4-.8-.2-.3-.5-.4-.8-.4a.4.4 0 0 1-.4-.4V7c0-.2.1-.4.4-.4.7 0 1.4.3 2 .8.5.6.8 1.3.8 2V11c0 .3.1.6.4.8.2.3.5.4.8.4.2 0 .4.2.4.4v.8c0 .2-.2.4-.4.4-.3 0-.6.1-.8.4-.3.2-.4.5-.4.8v1.7c0 .7-.3 1.4-.8 2-.6.5-1.3.8-2 .8a.4.4 0 0 1-.4-.4v-.8c0-.2.1-.4.4-.4.3 0 .6-.1.8-.4.3-.2.4-.5.4-.8V15a2.8 2.8 0 0 1 .8-2 2.8 2.8 0 0 1-.8-2zm-3.3-.4c0 .4-.1.8-.5 1.1-.3.3-.7.5-1.1.5-.4 0-.8-.2-1.1-.5-.4-.3-.5-.7-.5-1.1 0-.5.1-.9.5-1.2.3-.3.7-.4 1.1-.4.4 0 .8.1 1.1.4.4.3.5.7.5 1.2zM12 13c.4 0 .8.1 1.1.5.4.3.5.7.5 1.1 0 1-.1 1.6-.5 2a3 3 0 0 1-1.1 1c-.4.3-.8.4-1.1.4a.5.5 0 0 1-.5-.5V17a3 3 0 0 0 1-.2l.6-.6c-.6 0-1-.2-1.3-.5-.2-.3-.3-.7-.3-1 0-.5.1-1 .5-1.2.3-.4.7-.5 1.1-.5z" fill-rule="evenodd"/></svg>',"color-levels":'<svg width="24" height="24"><path d="M17.5 11.4A9 9 0 0 1 18 14c0 .5 0 1-.2 1.4 0 .4-.3.9-.5 1.3a6.2 6.2 0 0 1-3.7 3 5.7 5.7 0 0 1-3.2 0A5.9 5.9 0 0 1 7.6 18a6.2 6.2 0 0 1-1.4-2.6 6.7 6.7 0 0 1 0-2.8c0-.4.1-.9.3-1.3a13.6 13.6 0 0 1 2.3-4A20 20 0 0 1 12 4a26.4 26.4 0 0 1 3.2 3.4 18.2 18.2 0 0 1 2.3 4zm-2 4.5c.4-.7.5-1.4.5-2a7.3 7.3 0 0 0-1-3.2c.2.6.2 1.2.2 1.9a4.5 4.5 0 0 1-1.3 3 5.3 5.3 0 0 1-2.3 1.5 4.9 4.9 0 0 1-2 .1 4.3 4.3 0 0 0 2.4.8 4 4 0 0 0 2-.6 4 4 0 0 0 1.5-1.5z" fill-rule="evenodd"/></svg>',"color-picker":'<svg width="24" height="24"><path d="M12 3a9 9 0 0 0 0 18 1.5 1.5 0 0 0 1.1-2.5c-.2-.3-.4-.6-.4-1 0-.8.7-1.5 1.5-1.5H16a5 5 0 0 0 5-5c0-4.4-4-8-9-8zm-5.5 9a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm3-4a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm3 4a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z" fill-rule="nonzero"/></svg>',"color-swatch-remove-color":'<svg width="24" height="24"><path stroke="#000" stroke-width="2" d="M21 3L3 21" fill-rule="evenodd"/></svg>',"color-swatch":'<svg width="24" height="24"><rect x="3" y="3" width="18" height="18" rx="1" fill-rule="evenodd"/></svg>',"comment-add":'<svg width="24" height="24"><g fill-rule="nonzero"><path d="M9 19l3-2h7c.6 0 1-.4 1-1V6c0-.6-.4-1-1-1H5a1 1 0 0 0-1 1v10c0 .6.4 1 1 1h4v2zm-2 4v-4H5a3 3 0 0 1-3-3V6a3 3 0 0 1 3-3h14a3 3 0 0 1 3 3v10a3 3 0 0 1-3 3h-6.4L7 23z"/><path d="M13 10h2a1 1 0 0 1 0 2h-2v2a1 1 0 0 1-2 0v-2H9a1 1 0 0 1 0-2h2V8a1 1 0 0 1 2 0v2z"/></g></svg>',comment:'<svg width="24" height="24"><path fill-rule="nonzero" d="M9 19l3-2h7c.6 0 1-.4 1-1V6c0-.6-.4-1-1-1H5a1 1 0 0 0-1 1v10c0 .6.4 1 1 1h4v2zm-2 4v-4H5a3 3 0 0 1-3-3V6a3 3 0 0 1 3-3h14a3 3 0 0 1 3 3v10a3 3 0 0 1-3 3h-6.4L7 23z"/></svg>',contrast:'<svg width="24" height="24"><path d="M12 4a7.8 7.8 0 0 1 5.7 2.3A8 8 0 1 1 12 4zm-6 8a6 6 0 0 0 6 6V6a6 6 0 0 0-6 6z" fill-rule="evenodd"/></svg>',copy:'<svg width="24" height="24"><path d="M16 3H6a2 2 0 0 0-2 2v11h2V5h10V3zm1 4a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-7a2 2 0 0 1-2-2V9c0-1.2.9-2 2-2h7zm0 12V9h-7v10h7z" fill-rule="nonzero"/></svg>',crop:'<svg width="24" height="24"><path d="M17 8v7h2c.6 0 1 .4 1 1s-.4 1-1 1h-2v2c0 .6-.4 1-1 1a1 1 0 0 1-1-1v-2H7V9H5a1 1 0 1 1 0-2h2V5c0-.6.4-1 1-1s1 .4 1 1v2h7l3-3 1 1-3 3zM9 9v5l5-5H9zm1 6h5v-5l-5 5z" fill-rule="evenodd"/></svg>',cut:'<svg width="24" height="24"><path d="M18 15c.6.7 1 1.4 1 2.3 0 .8-.2 1.5-.7 2l-.8.5-1 .2c-.4 0-.8 0-1.2-.3a3.9 3.9 0 0 1-2.1-2.2c-.2-.5-.3-1-.2-1.5l-1-1-1 1c0 .5 0 1-.2 1.5-.1.5-.4 1-.9 1.4-.3.4-.7.6-1.2.8l-1.2.3c-.4 0-.7 0-1-.2-.3 0-.6-.3-.8-.5-.5-.5-.8-1.2-.7-2 0-.9.4-1.6 1-2.2A3.7 3.7 0 0 1 8.6 14H9l1-1-4-4-.5-1a3.3 3.3 0 0 1 0-2c0-.4.3-.7.5-1l6 6 6-6 .5 1a3.3 3.3 0 0 1 0 2c0 .4-.3.7-.5 1l-4 4 1 1h.5c.4 0 .8 0 1.2.3.5.2.9.4 1.2.8zm-8.5 2.2l.1-.4v-.3-.4a1 1 0 0 0-.2-.5 1 1 0 0 0-.4-.2 1.6 1.6 0 0 0-.8 0 2.6 2.6 0 0 0-.8.3 2.5 2.5 0 0 0-.9 1.1l-.1.4v.7l.2.5.5.2h.7a2.5 2.5 0 0 0 .8-.3 2.8 2.8 0 0 0 1-1zm2.5-2.8c.4 0 .7-.1 1-.4.3-.3.4-.6.4-1s-.1-.7-.4-1c-.3-.3-.6-.4-1-.4s-.7.1-1 .4c-.3.3-.4.6-.4 1s.1.7.4 1c.3.3.6.4 1 .4zm5.4 4l.2-.5v-.4-.3a2.6 2.6 0 0 0-.3-.8 2.4 2.4 0 0 0-.7-.7 2.5 2.5 0 0 0-.8-.3 1.5 1.5 0 0 0-.8 0 1 1 0 0 0-.4.2 1 1 0 0 0-.2.5 1.5 1.5 0 0 0 0 .7v.4l.3.4.3.4a2.8 2.8 0 0 0 .8.5l.4.1h.7l.5-.2z" fill-rule="evenodd"/></svg>',"document-properties":'<svg width="24" height="24"><path d="M14.4 3H7a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h10a2 2 0 0 0 2-2V7.6L14.4 3zM17 19H7V5h6v4h4v10z" fill-rule="nonzero"/></svg>',drag:'<svg width="24" height="24"><path d="M13 5h2v2h-2V5zm0 4h2v2h-2V9zM9 9h2v2H9V9zm4 4h2v2h-2v-2zm-4 0h2v2H9v-2zm0 4h2v2H9v-2zm4 0h2v2h-2v-2zM9 5h2v2H9V5z" fill-rule="evenodd"/></svg>',duplicate:'<svg width="24" height="24"><g fill-rule="nonzero"><path d="M16 3v2H6v11H4V5c0-1.1.9-2 2-2h10zm3 8h-2V9h-7v10h9a2 2 0 0 1-2 2h-7a2 2 0 0 1-2-2V9c0-1.2.9-2 2-2h7a2 2 0 0 1 2 2v2z"/><path d="M17 14h1a1 1 0 0 1 0 2h-1v1a1 1 0 0 1-2 0v-1h-1a1 1 0 0 1 0-2h1v-1a1 1 0 0 1 2 0v1z"/></g></svg>',"edit-block":'<svg width="24" height="24"><path fill-rule="nonzero" d="M19.8 8.8l-9.4 9.4c-.2.2-.5.4-.9.4l-5.4 1.2 1.2-5.4.5-.8 9.4-9.4c.7-.7 1.8-.7 2.5 0l2.1 2.1c.7.7.7 1.8 0 2.5zm-2-.2l1-.9v-.3l-2.2-2.2a.3.3 0 0 0-.3 0l-1 1L18 8.5zm-1 1l-2.5-2.4-6 6 2.5 2.5 6-6zm-7 7.1l-2.6-2.4-.3.3-.1.2-.7 3 3.1-.6h.1l.4-.5z"/></svg>',"edit-image":'<svg width="24" height="24"><path d="M18 16h2V7a2 2 0 0 0-2-2H7v2h11v9zM6 17h15a1 1 0 0 1 0 2h-1v1a1 1 0 0 1-2 0v-1H6a2 2 0 0 1-2-2V7H3a1 1 0 1 1 0-2h1V4a1 1 0 1 1 2 0v13zm3-5.3l1.3 2 3-4.7 3.7 6H7l2-3.3z" fill-rule="nonzero"/></svg>',"embed-page":'<svg width="24" height="24"><path d="M19 6V5H5v14h2A13 13 0 0 1 19 6zm0 1.4c-.8.8-1.6 2.4-2.2 4.6H19V7.4zm0 5.6h-2.4c-.4 1.8-.6 3.8-.6 6h3v-6zm-4 6c0-2.2.2-4.2.6-6H13c-.7 1.8-1.1 3.8-1.1 6h3zm-4 0c0-2.2.4-4.2 1-6H9.6A12 12 0 0 0 8 19h3zM4 3h16c.6 0 1 .4 1 1v16c0 .6-.4 1-1 1H4a1 1 0 0 1-1-1V4c0-.6.4-1 1-1zm11.8 9c.4-1.9 1-3.4 1.8-4.5a9.2 9.2 0 0 0-4 4.5h2.2zm-3.4 0a12 12 0 0 1 2.8-4 12 12 0 0 0-5 4h2.2z" fill-rule="nonzero"/></svg>',embed:'<svg width="24" height="24"><path d="M4 3h16c.6 0 1 .4 1 1v16c0 .6-.4 1-1 1H4a1 1 0 0 1-1-1V4c0-.6.4-1 1-1zm1 2v14h14V5H5zm4.8 2.6l5.6 4a.5.5 0 0 1 0 .8l-5.6 4A.5.5 0 0 1 9 16V8a.5.5 0 0 1 .8-.4z" fill-rule="nonzero"/></svg>',emoji:'<svg width="24" height="24"><path d="M9 11c.6 0 1-.4 1-1s-.4-1-1-1a1 1 0 0 0-1 1c0 .6.4 1 1 1zm6 0c.6 0 1-.4 1-1s-.4-1-1-1a1 1 0 0 0-1 1c0 .6.4 1 1 1zm-3 5.5c2.1 0 4-1.5 4.4-3.5H7.6c.5 2 2.3 3.5 4.4 3.5zM12 4a8 8 0 1 0 0 16 8 8 0 0 0 0-16zm0 14.5a6.5 6.5 0 1 1 0-13 6.5 6.5 0 0 1 0 13z" fill-rule="nonzero"/></svg>',fill:'<svg width="24" height="26"><path d="M16.6 12l-9-9-1.4 1.4 2.4 2.4-5.2 5.1c-.5.6-.5 1.6 0 2.2L9 19.6a1.5 1.5 0 0 0 2.2 0l5.5-5.5c.5-.6.5-1.6 0-2.2zM5.2 13L10 8.2l4.8 4.8H5.2zM19 14.5s-2 2.2-2 3.5c0 1.1.9 2 2 2a2 2 0 0 0 2-2c0-1.3-2-3.5-2-3.5z" fill-rule="nonzero"/></svg>',"flip-horizontally":'<svg width="24" height="24"><path d="M14 19h2v-2h-2v2zm4-8h2V9h-2v2zM4 7v10c0 1.1.9 2 2 2h3v-2H6V7h3V5H6a2 2 0 0 0-2 2zm14-2v2h2a2 2 0 0 0-2-2zm-7 16h2V3h-2v18zm7-6h2v-2h-2v2zm-4-8h2V5h-2v2zm4 12a2 2 0 0 0 2-2h-2v2z" fill-rule="nonzero"/></svg>',"flip-vertically":'<svg width="24" height="24"><path d="M5 14v2h2v-2H5zm8 4v2h2v-2h-2zm4-14H7a2 2 0 0 0-2 2v3h2V6h10v3h2V6a2 2 0 0 0-2-2zm2 14h-2v2a2 2 0 0 0 2-2zM3 11v2h18v-2H3zm6 7v2h2v-2H9zm8-4v2h2v-2h-2zM5 18c0 1.1.9 2 2 2v-2H5z" fill-rule="nonzero"/></svg>',"format-painter":'<svg width="24" height="24"><path d="M18 5V4c0-.5-.4-1-1-1H5a1 1 0 0 0-1 1v4c0 .6.5 1 1 1h12c.6 0 1-.4 1-1V7h1v4H9v9c0 .6.4 1 1 1h2c.6 0 1-.4 1-1v-7h8V5h-3z" fill-rule="nonzero"/></svg>',format:'<svg width="24" height="24"><path fill-rule="evenodd" d="M17 5a1 1 0 0 1 0 2h-4v11a1 1 0 0 1-2 0V7H7a1 1 0 1 1 0-2h10z"/></svg>',fullscreen:'<svg width="24" height="24"><path d="M15.3 10l-1.2-1.3 2.9-3h-2.3a.9.9 0 1 1 0-1.7H19c.5 0 .9.4.9.9v4.4a.9.9 0 1 1-1.8 0V7l-2.9 3zm0 4l3 3v-2.3a.9.9 0 1 1 1.7 0V19c0 .5-.4.9-.9.9h-4.4a.9.9 0 1 1 0-1.8H17l-3-2.9 1.3-1.2zM10 15.4l-2.9 3h2.3a.9.9 0 1 1 0 1.7H5a.9.9 0 0 1-.9-.9v-4.4a.9.9 0 1 1 1.8 0V17l2.9-3 1.2 1.3zM8.7 10L5.7 7v2.3a.9.9 0 0 1-1.7 0V5c0-.5.4-.9.9-.9h4.4a.9.9 0 0 1 0 1.8H7l3 2.9-1.3 1.2z" fill-rule="nonzero"/></svg>',gallery:'<svg width="24" height="24"><path fill-rule="nonzero" d="M5 15.7l2.3-2.2c.3-.3.7-.3 1 0L11 16l5.1-5c.3-.4.8-.4 1 0l2 1.9V8H5v7.7zM5 18V19h3l1.8-1.9-2-2L5 17.9zm14-3l-2.5-2.4-6.4 6.5H19v-4zM4 6h16c.6 0 1 .4 1 1v13c0 .6-.4 1-1 1H4a1 1 0 0 1-1-1V7c0-.6.4-1 1-1zm6 7a2 2 0 1 1 0-4 2 2 0 0 1 0 4zM4.5 4h15a.5.5 0 1 1 0 1h-15a.5.5 0 0 1 0-1zm2-2h11a.5.5 0 1 1 0 1h-11a.5.5 0 0 1 0-1z"/></svg>',gamma:'<svg width="24" height="24"><path d="M4 3h16c.6 0 1 .4 1 1v16c0 .6-.4 1-1 1H4a1 1 0 0 1-1-1V4c0-.6.4-1 1-1zm1 2v14h14V5H5zm6.5 11.8V14L9.2 8.7a5.1 5.1 0 0 0-.4-.8l-.1-.2H8 8v-1l.3-.1.3-.1h.7a1 1 0 0 1 .6.5l.1.3a8.5 8.5 0 0 1 .3.6l1.9 4.6 2-5.2a1 1 0 0 1 1-.6.5.5 0 0 1 .5.6L13 14v2.8a.7.7 0 0 1-1.4 0z" fill-rule="nonzero"/></svg>',help:'<svg width="24" height="24"><g fill-rule="evenodd"><path d="M12 5.5a6.5 6.5 0 0 0-6 9 6.3 6.3 0 0 0 1.4 2l1 1a6.3 6.3 0 0 0 3.6 1 6.5 6.5 0 0 0 6-9 6.3 6.3 0 0 0-1.4-2l-1-1a6.3 6.3 0 0 0-3.6-1zM12 4a7.8 7.8 0 0 1 5.7 2.3A8 8 0 1 1 12 4z"/><path d="M9.6 9.7a.7.7 0 0 1-.7-.8c0-1.1 1.5-1.8 3.2-1.8 1.8 0 3.2.8 3.2 2.4 0 1.4-.4 2.1-1.5 2.8-.2 0-.3.1-.3.2a2 2 0 0 0-.8.8.8.8 0 0 1-1.4-.6c.3-.7.8-1 1.3-1.5l.4-.2c.7-.4.8-.6.8-1.5 0-.5-.6-.9-1.7-.9-.5 0-1 .1-1.4.3-.2 0-.3.1-.3.2v-.2c0 .4-.4.8-.8.8z" fill-rule="nonzero"/><circle cx="12" cy="16" r="1"/></g></svg>',"highlight-bg-color":'<svg width="24" height="24"><g fill-rule="evenodd"><path id="tox-icon-highlight-bg-color__color" d="M3 18h18v3H3z"/><path fill-rule="nonzero" d="M7.7 16.7H3l3.3-3.3-.7-.8L10.2 8l4 4.1-4 4.2c-.2.2-.6.2-.8 0l-.6-.7-1.1 1.1zm5-7.5L11 7.4l3-2.9a2 2 0 0 1 2.6 0L18 6c.7.7.7 2 0 2.7l-2.9 2.9-1.8-1.8-.5-.6"/></g></svg>',home:'<svg width="24" height="24"><path fill-rule="nonzero" d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>',"horizontal-rule":'<svg width="24" height="24"><path d="M4 11h16v2H4z" fill-rule="evenodd"/></svg>',"image-options":'<svg width="24" height="24"><path d="M6 10a2 2 0 0 0-2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2 2 2 0 0 0-2-2zm12 0a2 2 0 0 0-2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2 2 2 0 0 0-2-2zm-6 0a2 2 0 0 0-2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2 2 2 0 0 0-2-2z" fill-rule="nonzero"/></svg>',image:'<svg width="24" height="24"><path d="M5 15.7l3.3-3.2c.3-.3.7-.3 1 0L12 15l4.1-4c.3-.4.8-.4 1 0l2 1.9V5H5v10.7zM5 18V19h3l2.8-2.9-2-2L5 17.9zm14-3l-2.5-2.4-6.4 6.5H19v-4zM4 3h16c.6 0 1 .4 1 1v16c0 .6-.4 1-1 1H4a1 1 0 0 1-1-1V4c0-.6.4-1 1-1zm6 8a2 2 0 1 0 0-4 2 2 0 0 0 0 4z" fill-rule="nonzero"/></svg>',indent:'<svg width="24" height="24"><path d="M7 5h12c.6 0 1 .4 1 1s-.4 1-1 1H7a1 1 0 1 1 0-2zm5 4h7c.6 0 1 .4 1 1s-.4 1-1 1h-7a1 1 0 0 1 0-2zm0 4h7c.6 0 1 .4 1 1s-.4 1-1 1h-7a1 1 0 0 1 0-2zm-5 4h12a1 1 0 0 1 0 2H7a1 1 0 0 1 0-2zm-2.6-3.8L6.2 12l-1.8-1.2a1 1 0 0 1 1.2-1.6l3 2a1 1 0 0 1 0 1.6l-3 2a1 1 0 1 1-1.2-1.6z" fill-rule="evenodd"/></svg>',info:'<svg width="24" height="24"><path d="M12 4a7.8 7.8 0 0 1 5.7 2.3A8 8 0 1 1 12 4zm-1 3v2h2V7h-2zm3 10v-1h-1v-5h-3v1h1v4h-1v1h4z" fill-rule="evenodd"/></svg>',"insert-character":'<svg width="24" height="24"><path d="M15 18h4l1-2v4h-6v-3.3l1.4-1a6 6 0 0 0 1.8-2.9 6.3 6.3 0 0 0-.1-4.1 5.8 5.8 0 0 0-3-3.2c-.6-.3-1.3-.5-2.1-.5a5.1 5.1 0 0 0-3.9 1.8 6.3 6.3 0 0 0-1.3 6 6.2 6.2 0 0 0 1.8 3l1.4.9V20H4v-4l1 2h4v-.5l-2-1L5.4 15A6.5 6.5 0 0 1 4 11c0-1 .2-1.9.6-2.7A7 7 0 0 1 6.3 6C7.1 5.4 8 5 9 4.5c1-.3 2-.5 3.1-.5a8.8 8.8 0 0 1 5.7 2 7 7 0 0 1 1.7 2.3 6 6 0 0 1 .2 4.8c-.2.7-.6 1.3-1 1.9a7.6 7.6 0 0 1-3.6 2.5v.5z" fill-rule="evenodd"/></svg>',"insert-time":'<svg width="24" height="24"><g fill-rule="nonzero"><path d="M12 19a7 7 0 1 0 0-14 7 7 0 0 0 0 14zm0 2a9 9 0 1 1 0-18 9 9 0 0 1 0 18z"/><path d="M16 12h-3V7c0-.6-.4-1-1-1a1 1 0 0 0-1 1v7h5c.6 0 1-.4 1-1s-.4-1-1-1z"/></g></svg>',invert:'<svg width="24" height="24"><path d="M18 19.3L16.5 18a5.8 5.8 0 0 1-3.1 1.9 6.1 6.1 0 0 1-5.5-1.6A5.8 5.8 0 0 1 6 14v-.3l.1-1.2A13.9 13.9 0 0 1 7.7 9l-3-3 .7-.8 2.8 2.9 9 8.9 1.5 1.6-.7.6zm0-5.5v.3l-.1 1.1-.4 1-1.2-1.2a4.3 4.3 0 0 0 .2-1v-.2c0-.4 0-.8-.2-1.3l-.5-1.4a14.8 14.8 0 0 0-3-4.2L12 6a26.1 26.1 0 0 0-2.2 2.5l-1-1a20.9 20.9 0 0 1 2.9-3.3L12 4l1 .8a22.2 22.2 0 0 1 4 5.4c.6 1.2 1 2.4 1 3.6z" fill-rule="evenodd"/></svg>',italic:'<svg width="24" height="24"><path d="M16.7 4.7l-.1.9h-.3c-.6 0-1 0-1.4.3-.3.3-.4.6-.5 1.1l-2.1 9.8v.6c0 .5.4.8 1.4.8h.2l-.2.8H8l.2-.8h.2c1.1 0 1.8-.5 2-1.5l2-9.8.1-.5c0-.6-.4-.8-1.4-.8h-.3l.2-.9h5.8z" fill-rule="evenodd"/></svg>',line:'<svg width="24" height="24"><path d="M15 9l-8 8H4v-3l8-8 3 3zm1-1l-3-3 1-1h1c-.2 0 0 0 0 0l2 2s0 .2 0 0v1l-1 1zM4 18h16v2H4v-2z" fill-rule="evenodd"/></svg>',link:'<svg width="24" height="24"><path d="M6.2 12.3a1 1 0 0 1 1.4 1.4l-2.1 2a2 2 0 1 0 2.7 2.8l4.8-4.8a1 1 0 0 0 0-1.4 1 1 0 1 1 1.4-1.3 2.9 2.9 0 0 1 0 4L9.6 20a3.9 3.9 0 0 1-5.5-5.5l2-2zm11.6-.6a1 1 0 0 1-1.4-1.4l2-2a2 2 0 1 0-2.6-2.8L11 10.3a1 1 0 0 0 0 1.4A1 1 0 1 1 9.6 13a2.9 2.9 0 0 1 0-4L14.4 4a3.9 3.9 0 0 1 5.5 5.5l-2 2z" fill-rule="nonzero"/></svg>',"list-bull-circle":'<svg width="48" height="48"><g fill-rule="evenodd"><path d="M11 16a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm0 1a3 3 0 1 1 0-6 3 3 0 0 1 0 6zM11 26a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm0 1a3 3 0 1 1 0-6 3 3 0 0 1 0 6zM11 36a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm0 1a3 3 0 1 1 0-6 3 3 0 0 1 0 6z" fill-rule="nonzero"/><path opacity=".2" d="M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z"/></g></svg>',"list-bull-default":'<svg width="48" height="48"><g fill-rule="evenodd"><circle cx="11" cy="14" r="3"/><circle cx="11" cy="24" r="3"/><circle cx="11" cy="34" r="3"/><path opacity=".2" d="M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z"/></g></svg>',"list-bull-square":'<svg width="48" height="48"><g fill-rule="evenodd"><path d="M8 11h6v6H8zM8 21h6v6H8zM8 31h6v6H8z"/><path opacity=".2" d="M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z"/></g></svg>',"list-num-default-rtl":'<svg width="48" height="48"><g fill-rule="evenodd"><path opacity=".2" d="M8 12h22v4H8zM8 22h22v4H8zM8 32h22v4H8z"/><path d="M37.4 17v-4.8l-1.6 1v-1.1l1.6-1h1.2V17zM33.3 17.1c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zm1.7 5.7c0-1.2 1-2 2.2-2 1.3 0 2.1.8 2.1 1.8 0 .7-.3 1.2-1.3 2.2l-1.2 1v.2h2.6v1h-4.3v-.9l2-1.9c.8-.8 1-1.1 1-1.5 0-.5-.4-.8-1-.8-.5 0-.9.3-.9.9H35zm-1.7 4.3c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zm3.2 7.3v-1h.7c.6 0 1-.3 1-.8 0-.4-.4-.7-1-.7s-1 .3-1 .8H35c0-1.1 1-1.8 2.2-1.8 1.2 0 2.1.6 2.1 1.6 0 .7-.4 1.2-1 1.3v.1c.7.1 1.3.7 1.3 1.4 0 1-1 1.9-2.4 1.9-1.3 0-2.2-.8-2.3-2h1.2c0 .6.5 1 1.1 1 .6 0 1-.4 1-1 0-.5-.3-.8-1-.8h-.7zm-3.3 2.7c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .8.3.8.7 0 .4-.3.7-.8.7z"/></g></svg>',"list-num-default":'<svg width="48" height="48"><g fill-rule="evenodd"><path opacity=".2" d="M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z"/><path d="M10 17v-4.8l-1.5 1v-1.1l1.6-1h1.2V17h-1.2zm3.6.1c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .7.3.7.7 0 .4-.2.7-.7.7zm-5 5.7c0-1.2.8-2 2.1-2s2.1.8 2.1 1.8c0 .7-.3 1.2-1.4 2.2l-1.1 1v.2h2.6v1H8.6v-.9l2-1.9c.8-.8 1-1.1 1-1.5 0-.5-.4-.8-1-.8-.5 0-.9.3-.9.9H8.5zm6.3 4.3c-.5 0-.7-.3-.7-.7 0-.4.2-.7.7-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zM10 34.4v-1h.7c.6 0 1-.3 1-.8 0-.4-.4-.7-1-.7s-1 .3-1 .8H8.6c0-1.1 1-1.8 2.2-1.8 1.3 0 2.1.6 2.1 1.6 0 .7-.4 1.2-1 1.3v.1c.8.1 1.3.7 1.3 1.4 0 1-1 1.9-2.4 1.9-1.3 0-2.2-.8-2.3-2h1.2c0 .6.5 1 1.1 1 .7 0 1-.4 1-1 0-.5-.3-.8-1-.8h-.7zm4.7 2.7c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .8.3.8.7 0 .4-.3.7-.8.7z"/></g></svg>',"list-num-lower-alpha-rtl":'<svg width="48" height="48"><g fill-rule="evenodd"><path opacity=".2" d="M8 12h22v4H8zM8 22h22v4H8zM8 32h22v4H8z"/><path d="M36.5 16c-.9 0-1.5-.5-1.5-1.3s.6-1.3 1.8-1.4h1v-.4c0-.4-.2-.6-.7-.6-.4 0-.7.1-.8.4h-1.1c0-.8.8-1.4 2-1.4S39 12 39 13V16h-1.2v-.6c-.3.4-.8.7-1.4.7zm.4-.8c.6 0 1-.4 1-.9V14h-1c-.5.1-.7.3-.7.6 0 .4.3.6.7.6zM33.1 16.1c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .8.3.8.7 0 .4-.3.7-.8.7zM37.7 26c-.7 0-1.2-.2-1.5-.7v.7H35v-6.3h1.2v2.5c.3-.5.8-.9 1.5-.9 1.1 0 1.8 1 1.8 2.4 0 1.5-.7 2.4-1.8 2.4zm-.5-3.6c-.6 0-1 .5-1 1.3s.4 1.4 1 1.4c.7 0 1-.6 1-1.4 0-.8-.3-1.3-1-1.3zM33.2 26.1c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .8.3.8.7 0 .4-.3.7-.8.7zm6 7h-1c-.1-.5-.4-.8-1-.8s-1 .5-1 1.4c0 1 .4 1.4 1 1.4.5 0 .9-.2 1-.7h1c0 1-.8 1.7-2 1.7-1.4 0-2.2-.9-2.2-2.4s.8-2.4 2.2-2.4c1.2 0 2 .7 2 1.7zm-6.1 3c-.5 0-.7-.3-.7-.7 0-.4.2-.7.7-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7z"/></g></svg>',"list-num-lower-alpha":'<svg width="48" height="48"><g fill-rule="evenodd"><path opacity=".2" d="M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z"/><path d="M10.3 15.2c.5 0 1-.4 1-.9V14h-1c-.5.1-.8.3-.8.6 0 .4.3.6.8.6zm-.4.9c-1 0-1.5-.6-1.5-1.4 0-.8.6-1.3 1.7-1.4h1.1v-.4c0-.4-.2-.6-.7-.6-.5 0-.8.1-.9.4h-1c0-.8.8-1.4 2-1.4 1.1 0 1.8.6 1.8 1.6V16h-1.1v-.6h-.1c-.2.4-.7.7-1.3.7zm4.6 0c-.5 0-.7-.3-.7-.7 0-.4.2-.7.7-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zm-3.2 10c-.6 0-1.2-.3-1.4-.8v.7H8.5v-6.3H10v2.5c.3-.5.8-.9 1.4-.9 1.2 0 1.9 1 1.9 2.4 0 1.5-.7 2.4-1.9 2.4zm-.4-3.7c-.7 0-1 .5-1 1.3s.3 1.4 1 1.4c.6 0 1-.6 1-1.4 0-.8-.4-1.3-1-1.3zm4 3.7c-.5 0-.7-.3-.7-.7 0-.4.2-.7.7-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zm-2.2 7h-1.2c0-.5-.4-.8-.9-.8-.6 0-1 .5-1 1.4 0 1 .4 1.4 1 1.4.5 0 .8-.2 1-.7h1c0 1-.8 1.7-2 1.7-1.4 0-2.2-.9-2.2-2.4s.8-2.4 2.2-2.4c1.2 0 2 .7 2 1.7zm1.8 3c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7z"/></g></svg>',"list-num-lower-greek-rtl":'<svg width="48" height="48"><g fill-rule="evenodd"><path opacity=".2" d="M8 12h22v4H8zM8 22h22v4H8zM8 32h22v4H8z"/><path d="M37.4 16c-1.2 0-2-.8-2-2.3 0-1.5.8-2.4 2-2.4.6 0 1 .4 1.3 1v-.9H40v3.2c0 .4.1.5.4.5h.2v.9h-.6c-.6 0-1-.2-1-.7h-.2c-.2.4-.7.8-1.3.8zm.3-1c.6 0 1-.5 1-1.3s-.4-1.3-1-1.3-1 .5-1 1.3.4 1.4 1 1.4zM33.3 16.1c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zM36 21.9c0-1.5.8-2.3 2.1-2.3 1.2 0 2 .6 2 1.6 0 .6-.3 1-.9 1.3.9.3 1.3.8 1.3 1.7 0 1.2-.7 1.9-1.8 1.9-.6 0-1.1-.3-1.4-.8v2.2H36V22zm1.8 1.2v-1h.3c.5 0 .9-.2.9-.7 0-.5-.3-.8-.9-.8-.5 0-.8.3-.8 1v2.2c0 .8.4 1.3 1 1.3s1-.4 1-1-.4-1-1.2-1h-.3zM33.3 26.1c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zM37.1 34.6L34.8 30h1.4l1.7 3.5 1.7-3.5h1.1l-2.2 4.6v.1c.5.8.7 1.4.7 1.8 0 .4-.2.8-.4 1-.2.2-.6.3-1 .3-.9 0-1.3-.4-1.3-1.2 0-.5.2-1 .5-1.7l.1-.2zm.7 1a2 2 0 0 0-.4.9c0 .3.1.4.4.4.3 0 .4-.1.4-.4 0-.2-.1-.6-.4-1zM33.3 36.1c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7z"/></g></svg>',"list-num-lower-greek":'<svg width="48" height="48"><g fill-rule="evenodd"><path opacity=".2" d="M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z"/><path d="M10.5 15c.7 0 1-.5 1-1.3s-.3-1.3-1-1.3c-.5 0-.9.5-.9 1.3s.4 1.4 1 1.4zm-.3 1c-1.1 0-1.8-.8-1.8-2.3 0-1.5.7-2.4 1.8-2.4.7 0 1.1.4 1.3 1h.1v-.9h1.2v3.2c0 .4.1.5.4.5h.2v.9h-.6c-.6 0-1-.2-1.1-.7h-.1c-.2.4-.7.8-1.4.8zm5 .1c-.5 0-.8-.3-.8-.7 0-.4.3-.7.7-.7.5 0 .8.3.8.7 0 .4-.3.7-.8.7zm-4.9 7v-1h.3c.6 0 1-.2 1-.7 0-.5-.4-.8-1-.8-.5 0-.8.3-.8 1v2.2c0 .8.4 1.3 1.1 1.3.6 0 1-.4 1-1s-.5-1-1.3-1h-.3zM8.6 22c0-1.5.7-2.3 2-2.3 1.2 0 2 .6 2 1.6 0 .6-.3 1-.8 1.3.8.3 1.3.8 1.3 1.7 0 1.2-.8 1.9-1.9 1.9-.6 0-1.1-.3-1.3-.8v2.2H8.5V22zm6.2 4.2c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .7.3.7.7 0 .4-.2.7-.7.7zm-4.5 8.5L8 30h1.4l1.7 3.5 1.7-3.5h1.1l-2.2 4.6v.1c.5.8.7 1.4.7 1.8 0 .4-.1.8-.4 1-.2.2-.6.3-1 .3-.9 0-1.3-.4-1.3-1.2 0-.5.2-1 .5-1.7l.1-.2zm.7 1a2 2 0 0 0-.4.9c0 .3.1.4.4.4.3 0 .4-.1.4-.4 0-.2-.1-.6-.4-1zm4.5.5c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7z"/></g></svg>',"list-num-lower-roman-rtl":'<svg width="48" height="48"><g fill-rule="evenodd"><path opacity=".2" d="M8 12h22v4H8zM8 22h22v4H8zM8 32h22v4H8z"/><path d="M32.9 16v-1.2h-1.3V16H33zm0 10v-1.2h-1.3V26H33zm0 10v-1.2h-1.3V36H33z"/><path fill-rule="nonzero" d="M36 21h-1.5v5H36zM36 31h-1.5v5H36zM39 21h-1.5v5H39zM39 31h-1.5v5H39zM42 31h-1.5v5H42zM36 11h-1.5v5H36zM36 19h-1.5v1H36zM36 29h-1.5v1H36zM39 19h-1.5v1H39zM39 29h-1.5v1H39zM42 29h-1.5v1H42zM36 9h-1.5v1H36z"/></g></svg>',"list-num-lower-roman":'<svg width="48" height="48"><g fill-rule="evenodd"><path opacity=".2" d="M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z"/><path d="M15.1 16v-1.2h1.3V16H15zm0 10v-1.2h1.3V26H15zm0 10v-1.2h1.3V36H15z"/><path fill-rule="nonzero" d="M12 21h1.5v5H12zM12 31h1.5v5H12zM9 21h1.5v5H9zM9 31h1.5v5H9zM6 31h1.5v5H6zM12 11h1.5v5H12zM12 19h1.5v1H12zM12 29h1.5v1H12zM9 19h1.5v1H9zM9 29h1.5v1H9zM6 29h1.5v1H6zM12 9h1.5v1H12z"/></g></svg>',"list-num-upper-alpha-rtl":'<svg width="48" height="48"><g fill-rule="evenodd"><path opacity=".2" d="M8 12h22v4H8zM8 22h22v4H8zM8 32h22v4H8z"/><path d="M39.3 17l-.5-1.4h-2l-.5 1.4H35l2-6h1.6l2 6h-1.3zm-1.6-4.7l-.7 2.3h1.6l-.8-2.3zM33.4 17c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .7.3.7.7 0 .4-.2.7-.7.7zm4.7 9.9h-2.7v-6H38c1.2 0 1.9.6 1.9 1.5 0 .6-.5 1.2-1 1.3.7.1 1.3.7 1.3 1.5 0 1-.8 1.7-2 1.7zm-1.4-5v1.5h1c.6 0 1-.3 1-.8 0-.4-.4-.7-1-.7h-1zm0 4h1.1c.7 0 1.1-.3 1.1-.8 0-.6-.4-.9-1.1-.9h-1.1V26zM33 27.1c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zm4.9 10c-1.8 0-2.8-1.1-2.8-3.1s1-3.1 2.8-3.1c1.4 0 2.5.9 2.6 2.2h-1.3c0-.7-.6-1.1-1.3-1.1-1 0-1.6.7-1.6 2s.6 2 1.6 2c.7 0 1.2-.4 1.4-1h1.2c-.1 1.3-1.2 2.2-2.6 2.2zm-4.5 0c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7z"/></g></svg>',"list-num-upper-alpha":'<svg width="48" height="48"><g fill-rule="evenodd"><path opacity=".2" d="M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z"/><path d="M12.6 17l-.5-1.4h-2L9.5 17H8.3l2-6H12l2 6h-1.3zM11 12.3l-.7 2.3h1.6l-.8-2.3zm4.7 4.8c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .7.3.7.7 0 .4-.2.7-.7.7zM11.4 27H8.7v-6h2.6c1.2 0 1.9.6 1.9 1.5 0 .6-.5 1.2-1 1.3.7.1 1.3.7 1.3 1.5 0 1-.8 1.7-2 1.7zM10 22v1.5h1c.6 0 1-.3 1-.8 0-.4-.4-.7-1-.7h-1zm0 4H11c.7 0 1.1-.3 1.1-.8 0-.6-.4-.9-1.1-.9H10V26zm5.4 1.1c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zm-4.1 10c-1.8 0-2.8-1.1-2.8-3.1s1-3.1 2.8-3.1c1.4 0 2.5.9 2.6 2.2h-1.3c0-.7-.6-1.1-1.3-1.1-1 0-1.6.7-1.6 2s.6 2 1.6 2c.7 0 1.2-.4 1.4-1h1.2c-.1 1.3-1.2 2.2-2.6 2.2zm4.5 0c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7z"/></g></svg>',"list-num-upper-roman-rtl":'<svg width="48" height="48"><g fill-rule="evenodd"><path opacity=".2" d="M8 12h22v4H8zM8 22h22v4H8zM8 32h22v4H8z"/><path d="M31.6 17v-1.2H33V17h-1.3zm0 10v-1.2H33V27h-1.3zm0 10v-1.2H33V37h-1.3z"/><path fill-rule="nonzero" d="M34.5 20H36v7h-1.5zM34.5 30H36v7h-1.5zM37.5 20H39v7h-1.5zM37.5 30H39v7h-1.5zM40.5 30H42v7h-1.5zM34.5 10H36v7h-1.5z"/></g></svg>',"list-num-upper-roman":'<svg width="48" height="48"><g fill-rule="evenodd"><path opacity=".2" d="M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z"/><path d="M15.1 17v-1.2h1.3V17H15zm0 10v-1.2h1.3V27H15zm0 10v-1.2h1.3V37H15z"/><path fill-rule="nonzero" d="M12 20h1.5v7H12zM12 30h1.5v7H12zM9 20h1.5v7H9zM9 30h1.5v7H9zM6 30h1.5v7H6zM12 10h1.5v7H12z"/></g></svg>',lock:'<svg width="24" height="24"><path d="M16.3 11c.2 0 .3 0 .5.2l.2.6v7.4c0 .3 0 .4-.2.6l-.6.2H7.8c-.3 0-.4 0-.6-.2a.7.7 0 0 1-.2-.6v-7.4c0-.3 0-.4.2-.6l.5-.2H8V8c0-.8.3-1.5.9-2.1.6-.6 1.3-.9 2.1-.9h2c.8 0 1.5.3 2.1.9.6.6.9 1.3.9 2.1v3h.3zM10 8v3h4V8a1 1 0 0 0-.3-.7A1 1 0 0 0 13 7h-2a1 1 0 0 0-.7.3 1 1 0 0 0-.3.7z" fill-rule="evenodd"/></svg>',ltr:'<svg width="24" height="24"><path d="M11 5h7a1 1 0 0 1 0 2h-1v11a1 1 0 0 1-2 0V7h-2v11a1 1 0 0 1-2 0v-6c-.5 0-1 0-1.4-.3A3.4 3.4 0 0 1 7.8 10a3.3 3.3 0 0 1 0-2.8 3.4 3.4 0 0 1 1.8-1.8L11 5zM4.4 16.2L6.2 15l-1.8-1.2a1 1 0 0 1 1.2-1.6l3 2a1 1 0 0 1 0 1.6l-3 2a1 1 0 1 1-1.2-1.6z" fill-rule="evenodd"/></svg>',"more-drawer":'<svg width="24" height="24"><path d="M6 10a2 2 0 0 0-2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2 2 2 0 0 0-2-2zm12 0a2 2 0 0 0-2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2 2 2 0 0 0-2-2zm-6 0a2 2 0 0 0-2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2 2 2 0 0 0-2-2z" fill-rule="nonzero"/></svg>',"new-document":'<svg width="24" height="24"><path d="M14.4 3H7a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h10a2 2 0 0 0 2-2V7.6L14.4 3zM17 19H7V5h6v4h4v10z" fill-rule="nonzero"/></svg>',"new-tab":'<svg width="24" height="24"><path d="M15 13l2-2v8H5V7h8l-2 2H7v8h8v-4zm4-8v5.5l-2-2-5.6 5.5H10v-1.4L15.5 7l-2-2H19z" fill-rule="evenodd"/></svg>',"non-breaking":'<svg width="24" height="24"><path d="M11 11H8a1 1 0 1 1 0-2h3V6c0-.6.4-1 1-1s1 .4 1 1v3h3c.6 0 1 .4 1 1s-.4 1-1 1h-3v3c0 .6-.4 1-1 1a1 1 0 0 1-1-1v-3zm10 4v5H3v-5c0-.6.4-1 1-1s1 .4 1 1v3h14v-3c0-.6.4-1 1-1s1 .4 1 1z" fill-rule="evenodd"/></svg>',notice:'<svg width="24" height="24"><path d="M17.8 9.8L15.4 4 20 8.5v7L15.5 20h-7L4 15.5v-7L8.5 4h7l2.3 5.8zm0 0l2.2 5.7-2.3-5.8zM13 17v-2h-2v2h2zm0-4V7h-2v6h2z" fill-rule="evenodd"/></svg>',"ordered-list-rtl":'<svg width="24" height="24"><path d="M6 17h8a1 1 0 0 1 0 2H6a1 1 0 0 1 0-2zm0-6h8a1 1 0 0 1 0 2H6a1 1 0 0 1 0-2zm0-6h8a1 1 0 0 1 0 2H6a1 1 0 1 1 0-2zm13-1v3.5a.5.5 0 1 1-1 0V5h-.5a.5.5 0 1 1 0-1H19zm-1 8.8l.2.2h1.3a.5.5 0 1 1 0 1h-1.6a1 1 0 0 1-.9-1V13c0-.4.3-.8.6-1l1.2-.4.2-.3a.2.2 0 0 0-.2-.2h-1.3a.5.5 0 0 1-.5-.5c0-.3.2-.5.5-.5h1.6c.5 0 .9.4.9 1v.1c0 .4-.3.8-.6 1l-1.2.4-.2.3zm2 4.2v2c0 .6-.4 1-1 1h-1.5a.5.5 0 0 1 0-1h1.2a.3.3 0 1 0 0-.6h-1.3a.4.4 0 1 1 0-.8h1.3a.3.3 0 0 0 0-.6h-1.2a.5.5 0 1 1 0-1H19c.6 0 1 .4 1 1z" fill-rule="evenodd"/></svg>',"ordered-list":'<svg width="24" height="24"><path d="M10 17h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zm0-6h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zm0-6h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 1 1 0-2zM6 4v3.5c0 .3-.2.5-.5.5a.5.5 0 0 1-.5-.5V5h-.5a.5.5 0 0 1 0-1H6zm-1 8.8l.2.2h1.3c.3 0 .5.2.5.5s-.2.5-.5.5H4.9a1 1 0 0 1-.9-1V13c0-.4.3-.8.6-1l1.2-.4.2-.3a.2.2 0 0 0-.2-.2H4.5a.5.5 0 0 1-.5-.5c0-.3.2-.5.5-.5h1.6c.5 0 .9.4.9 1v.1c0 .4-.3.8-.6 1l-1.2.4-.2.3zM7 17v2c0 .6-.4 1-1 1H4.5a.5.5 0 0 1 0-1h1.2c.2 0 .3-.1.3-.3 0-.2-.1-.3-.3-.3H4.4a.4.4 0 1 1 0-.8h1.3c.2 0 .3-.1.3-.3 0-.2-.1-.3-.3-.3H4.5a.5.5 0 1 1 0-1H6c.6 0 1 .4 1 1z" fill-rule="evenodd"/></svg>',orientation:'<svg width="24" height="24"><path d="M7.3 6.4L1 13l6.4 6.5 6.5-6.5-6.5-6.5zM3.7 13l3.6-3.7L11 13l-3.7 3.7-3.6-3.7zM12 6l2.8 2.7c.3.3.3.8 0 1-.3.4-.9.4-1.2 0L9.2 5.7a.8.8 0 0 1 0-1.2L13.6.2c.3-.3.9-.3 1.2 0 .3.3.3.8 0 1.1L12 4h1a9 9 0 1 1-4.3 16.9l1.5-1.5A7 7 0 1 0 13 6h-1z" fill-rule="nonzero"/></svg>',outdent:'<svg width="24" height="24"><path d="M7 5h12c.6 0 1 .4 1 1s-.4 1-1 1H7a1 1 0 1 1 0-2zm5 4h7c.6 0 1 .4 1 1s-.4 1-1 1h-7a1 1 0 0 1 0-2zm0 4h7c.6 0 1 .4 1 1s-.4 1-1 1h-7a1 1 0 0 1 0-2zm-5 4h12a1 1 0 0 1 0 2H7a1 1 0 0 1 0-2zm1.6-3.8a1 1 0 0 1-1.2 1.6l-3-2a1 1 0 0 1 0-1.6l3-2a1 1 0 0 1 1.2 1.6L6.8 12l1.8 1.2z" fill-rule="evenodd"/></svg>',"page-break":'<svg width="24" height="24"><g fill-rule="evenodd"><path d="M5 11c.6 0 1 .4 1 1s-.4 1-1 1a1 1 0 0 1 0-2zm3 0h1c.6 0 1 .4 1 1s-.4 1-1 1H8a1 1 0 0 1 0-2zm4 0c.6 0 1 .4 1 1s-.4 1-1 1a1 1 0 0 1 0-2zm3 0h1c.6 0 1 .4 1 1s-.4 1-1 1h-1a1 1 0 0 1 0-2zm4 0c.6 0 1 .4 1 1s-.4 1-1 1a1 1 0 0 1 0-2zM7 3v5h10V3c0-.6.4-1 1-1s1 .4 1 1v7H5V3c0-.6.4-1 1-1s1 .4 1 1zM6 22a1 1 0 0 1-1-1v-7h14v7c0 .6-.4 1-1 1a1 1 0 0 1-1-1v-5H7v5c0 .6-.4 1-1 1z"/></g></svg>',paragraph:'<svg width="24" height="24"><path fill-rule="evenodd" d="M10 5h7a1 1 0 0 1 0 2h-1v11a1 1 0 0 1-2 0V7h-2v11a1 1 0 0 1-2 0v-6c-.5 0-1 0-1.4-.3A3.4 3.4 0 0 1 6.8 10a3.3 3.3 0 0 1 0-2.8 3.4 3.4 0 0 1 1.8-1.8L10 5z"/></svg>',"paste-text":'<svg width="24" height="24"><path d="M18 9V5h-2v1c0 .6-.4 1-1 1H9a1 1 0 0 1-1-1V5H6v13h3V9h9zM9 20H6a2 2 0 0 1-2-2V5c0-1.1.9-2 2-2h3.2A3 3 0 0 1 12 1a3 3 0 0 1 2.8 2H18a2 2 0 0 1 2 2v4h1v12H9v-1zm1.5-9.5v9h9v-9h-9zM12 3a1 1 0 0 0-1 1c0 .5.4 1 1 1s1-.5 1-1-.4-1-1-1zm0 9h6v2h-.5l-.5-1h-1v4h.8v1h-3.6v-1h.8v-4h-1l-.5 1H12v-2z" fill-rule="nonzero"/></svg>',paste:'<svg width="24" height="24"><path d="M18 9V5h-2v1c0 .6-.4 1-1 1H9a1 1 0 0 1-1-1V5H6v13h3V9h9zM9 20H6a2 2 0 0 1-2-2V5c0-1.1.9-2 2-2h3.2A3 3 0 0 1 12 1a3 3 0 0 1 2.8 2H18a2 2 0 0 1 2 2v4h1v12H9v-1zm1.5-9.5v9h9v-9h-9zM12 3a1 1 0 0 0-1 1c0 .5.4 1 1 1s1-.5 1-1-.4-1-1-1z" fill-rule="nonzero"/></svg>',"permanent-pen":'<svg width="24" height="24"><path d="M10.5 17.5L8 20H3v-3l3.5-3.5a2 2 0 0 1 0-3L14 3l1 1-7.3 7.3a1 1 0 0 0 0 1.4l3.6 3.6c.4.4 1 .4 1.4 0L20 9l1 1-7.6 7.6a2 2 0 0 1-2.8 0l-.1-.1z" fill-rule="nonzero"/></svg>',plus:'<svg width="24" height="24"><path d="M12 4c.5 0 1 .4 1 .9V11h6a1 1 0 0 1 .1 2H13v6a1 1 0 0 1-2 .1V13H5a1 1 0 0 1-.1-2H11V5c0-.6.4-1 1-1z"/></svg>',preferences:'<svg width="24" height="24"><path d="M20.1 13.5l-1.9.2a5.8 5.8 0 0 1-.6 1.5l1.2 1.5c.4.4.3 1 0 1.4l-.7.7a1 1 0 0 1-1.4 0l-1.5-1.2a6.2 6.2 0 0 1-1.5.6l-.2 1.9c0 .5-.5.9-1 .9h-1a1 1 0 0 1-1-.9l-.2-1.9a5.8 5.8 0 0 1-1.5-.6l-1.5 1.2a1 1 0 0 1-1.4 0l-.7-.7a1 1 0 0 1 0-1.4l1.2-1.5a6.2 6.2 0 0 1-.6-1.5l-1.9-.2a1 1 0 0 1-.9-1v-1c0-.5.4-1 .9-1l1.9-.2a5.8 5.8 0 0 1 .6-1.5L5.2 7.3a1 1 0 0 1 0-1.4l.7-.7a1 1 0 0 1 1.4 0l1.5 1.2a6.2 6.2 0 0 1 1.5-.6l.2-1.9c0-.5.5-.9 1-.9h1c.5 0 1 .4 1 .9l.2 1.9a5.8 5.8 0 0 1 1.5.6l1.5-1.2a1 1 0 0 1 1.4 0l.7.7c.3.4.4 1 0 1.4l-1.2 1.5a6.2 6.2 0 0 1 .6 1.5l1.9.2c.5 0 .9.5.9 1v1c0 .5-.4 1-.9 1zM12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6z" fill-rule="evenodd"/></svg>',preview:'<svg width="24" height="24"><path d="M3.5 12.5c.5.8 1.1 1.6 1.8 2.3 2 2 4.2 3.2 6.7 3.2s4.7-1.2 6.7-3.2a16.2 16.2 0 0 0 2.1-2.8 15.7 15.7 0 0 0-2.1-2.8c-2-2-4.2-3.2-6.7-3.2a9.3 9.3 0 0 0-6.7 3.2A16.2 16.2 0 0 0 3.2 12c0 .2.2.3.3.5zm-2.4-1l.7-1.2L4 7.8C6.2 5.4 8.9 4 12 4c3 0 5.8 1.4 8.1 3.8a18.2 18.2 0 0 1 2.8 3.7v1l-.7 1.2-2.1 2.5c-2.3 2.4-5 3.8-8.1 3.8-3 0-5.8-1.4-8.1-3.8a18.2 18.2 0 0 1-2.8-3.7 1 1 0 0 1 0-1zm12-3.3a2 2 0 1 0 2.7 2.6 4 4 0 1 1-2.6-2.6z" fill-rule="nonzero"/></svg>',print:'<svg width="24" height="24"><path d="M18 8H6a3 3 0 0 0-3 3v6h2v3h14v-3h2v-6a3 3 0 0 0-3-3zm-1 10H7v-4h10v4zm.5-5c-.8 0-1.5-.7-1.5-1.5s.7-1.5 1.5-1.5 1.5.7 1.5 1.5-.7 1.5-1.5 1.5zm.5-8H6v2h12V5z" fill-rule="nonzero"/></svg>',quote:'<svg width="24" height="24"><path d="M7.5 17h.9c.4 0 .7-.2.9-.6L11 13V8c0-.6-.4-1-1-1H6a1 1 0 0 0-1 1v4c0 .6.4 1 1 1h2l-1.3 2.7a1 1 0 0 0 .8 1.3zm8 0h.9c.4 0 .7-.2.9-.6L19 13V8c0-.6-.4-1-1-1h-4a1 1 0 0 0-1 1v4c0 .6.4 1 1 1h2l-1.3 2.7a1 1 0 0 0 .8 1.3z" fill-rule="nonzero"/></svg>',redo:'<svg width="24" height="24"><path d="M17.6 10H12c-2.8 0-4.4 1.4-4.9 3.5-.4 2 .3 4 1.4 4.6a1 1 0 1 1-1 1.8c-2-1.2-2.9-4.1-2.3-6.8.6-3 3-5.1 6.8-5.1h5.6l-3.3-3.3a1 1 0 1 1 1.4-1.4l5 5a1 1 0 0 1 0 1.4l-5 5a1 1 0 0 1-1.4-1.4l3.3-3.3z" fill-rule="nonzero"/></svg>',reload:'<svg width="24" height="24"><g fill-rule="nonzero"><path d="M5 22.1l-1.2-4.7v-.2a1 1 0 0 1 1-1l5 .4a1 1 0 1 1-.2 2l-2.2-.2a7.8 7.8 0 0 0 8.4.2 7.5 7.5 0 0 0 3.5-6.4 1 1 0 1 1 2 0 9.5 9.5 0 0 1-4.5 8 9.9 9.9 0 0 1-10.2 0l.4 1.4a1 1 0 1 1-2 .5zM13.6 7.4c0-.5.5-1 1-.9l2.8.2a8 8 0 0 0-9.5-1 7.5 7.5 0 0 0-3.6 7 1 1 0 0 1-2 0 9.5 9.5 0 0 1 4.5-8.6 10 10 0 0 1 10.9.3l-.3-1a1 1 0 0 1 2-.5l1.1 4.8a1 1 0 0 1-1 1.2l-5-.4a1 1 0 0 1-.9-1z"/></g></svg>',"remove-formatting":'<svg width="24" height="24"><path d="M13.2 6a1 1 0 0 1 0 .2l-2.6 10a1 1 0 0 1-1 .8h-.2a.8.8 0 0 1-.8-1l2.6-10H8a1 1 0 1 1 0-2h9a1 1 0 0 1 0 2h-3.8zM5 18h7a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2zm13 1.5L16.5 18 15 19.5a.7.7 0 0 1-1-1l1.5-1.5-1.5-1.5a.7.7 0 0 1 1-1l1.5 1.5 1.5-1.5a.7.7 0 0 1 1 1L17.5 17l1.5 1.5a.7.7 0 0 1-1 1z" fill-rule="evenodd"/></svg>',remove:'<svg width="24" height="24"><path d="M16 7h3a1 1 0 0 1 0 2h-1v9a3 3 0 0 1-3 3H9a3 3 0 0 1-3-3V9H5a1 1 0 1 1 0-2h3V6a3 3 0 0 1 3-3h2a3 3 0 0 1 3 3v1zm-2 0V6c0-.6-.4-1-1-1h-2a1 1 0 0 0-1 1v1h4zm2 2H8v9c0 .6.4 1 1 1h6c.6 0 1-.4 1-1V9zm-7 3a1 1 0 0 1 2 0v4a1 1 0 0 1-2 0v-4zm4 0a1 1 0 0 1 2 0v4a1 1 0 0 1-2 0v-4z" fill-rule="nonzero"/></svg>',"resize-handle":'<svg width="10" height="10"><g fill-rule="nonzero"><path d="M8.1 1.1A.5.5 0 1 1 9 2l-7 7A.5.5 0 1 1 1 8l7-7zM8.1 5.1A.5.5 0 1 1 9 6l-3 3A.5.5 0 1 1 5 8l3-3z"/></g></svg>',resize:'<svg width="24" height="24"><path d="M4 5c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3h6c.3 0 .5.1.7.3.2.2.3.4.3.7 0 .3-.1.5-.3.7a1 1 0 0 1-.7.3H7.4L18 16.6V13c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3.3 0 .5.1.7.3.2.2.3.4.3.7v6c0 .3-.1.5-.3.7a1 1 0 0 1-.7.3h-6a1 1 0 0 1-.7-.3 1 1 0 0 1-.3-.7c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3h3.6L6 7.4V11c0 .3-.1.5-.3.7a1 1 0 0 1-.7.3 1 1 0 0 1-.7-.3A1 1 0 0 1 4 11V5z" fill-rule="evenodd"/></svg>',"restore-draft":'<svg width="24" height="24"><g fill-rule="evenodd"><path d="M17 13c0 .6-.4 1-1 1h-4V8c0-.6.4-1 1-1s1 .4 1 1v4h2c.6 0 1 .4 1 1z"/><path d="M4.7 10H9a1 1 0 0 1 0 2H3a1 1 0 0 1-1-1V5a1 1 0 1 1 2 0v3l2.5-2.4a9.2 9.2 0 0 1 10.8-1.5A9 9 0 0 1 13.4 21c-2.4.1-4.7-.7-6.5-2.2a1 1 0 1 1 1.3-1.5 7.2 7.2 0 0 0 11.6-3.7 7 7 0 0 0-3.5-7.7A7.2 7.2 0 0 0 8 7L4.7 10z" fill-rule="nonzero"/></g></svg>',"rotate-left":'<svg width="24" height="24"><path d="M4.7 10H9a1 1 0 0 1 0 2H3a1 1 0 0 1-1-1V5a1 1 0 1 1 2 0v3l2.5-2.4a9.2 9.2 0 0 1 10.8-1.5A9 9 0 0 1 13.4 21c-2.4.1-4.7-.7-6.5-2.2a1 1 0 1 1 1.3-1.5 7.2 7.2 0 0 0 11.6-3.7 7 7 0 0 0-3.5-7.7A7.2 7.2 0 0 0 8 7L4.7 10z" fill-rule="nonzero"/></svg>',"rotate-right":'<svg width="24" height="24"><path d="M20 8V5a1 1 0 0 1 2 0v6c0 .6-.4 1-1 1h-6a1 1 0 0 1 0-2h4.3L16 7A7.2 7.2 0 0 0 7.7 6a7 7 0 0 0 3 13.1c1.9.1 3.7-.5 5-1.7a1 1 0 0 1 1.4 1.5A9.2 9.2 0 0 1 2.2 14c-.9-3.9 1-8 4.5-9.9 3.5-1.9 8-1.3 10.8 1.5L20 8z" fill-rule="nonzero"/></svg>',rtl:'<svg width="24" height="24"><path d="M8 5h8v2h-2v12h-2V7h-2v12H8v-7c-.5 0-1 0-1.4-.3A3.4 3.4 0 0 1 4.8 10a3.3 3.3 0 0 1 0-2.8 3.4 3.4 0 0 1 1.8-1.8L8 5zm12 11.2a1 1 0 1 1-1 1.6l-3-2a1 1 0 0 1 0-1.6l3-2a1 1 0 1 1 1 1.6L18.4 15l1.8 1.2z" fill-rule="evenodd"/></svg>',save:'<svg width="24" height="24"><path d="M5 16h14a2 2 0 0 1 2 2v2a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-2c0-1.1.9-2 2-2zm0 2v2h14v-2H5zm10 0h2v2h-2v-2zm-4-6.4L8.7 9.3a1 1 0 1 0-1.4 1.4l4 4c.4.4 1 .4 1.4 0l4-4a1 1 0 1 0-1.4-1.4L13 11.6V4a1 1 0 0 0-2 0v7.6z" fill-rule="nonzero"/></svg>',search:'<svg width="24" height="24"><path d="M16 17.3a8 8 0 1 1 1.4-1.4l4.3 4.4a1 1 0 0 1-1.4 1.4l-4.4-4.3zm-5-.3a6 6 0 1 0 0-12 6 6 0 0 0 0 12z" fill-rule="nonzero"/></svg>',"select-all":'<svg width="24" height="24"><path d="M3 5h2V3a2 2 0 0 0-2 2zm0 8h2v-2H3v2zm4 8h2v-2H7v2zM3 9h2V7H3v2zm10-6h-2v2h2V3zm6 0v2h2a2 2 0 0 0-2-2zM5 21v-2H3c0 1.1.9 2 2 2zm-2-4h2v-2H3v2zM9 3H7v2h2V3zm2 18h2v-2h-2v2zm8-8h2v-2h-2v2zm0 8a2 2 0 0 0 2-2h-2v2zm0-12h2V7h-2v2zm0 8h2v-2h-2v2zm-4 4h2v-2h-2v2zm0-16h2V3h-2v2zM7 17h10V7H7v10zm2-8h6v6H9V9z" fill-rule="nonzero"/></svg>',selected:'<svg width="24" height="24"><path fill-rule="nonzero" d="M6 4h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2zm3.6 10.9L7 12.3a.7.7 0 0 0-1 1L9.6 17 18 8.6a.7.7 0 0 0 0-1 .7.7 0 0 0-1 0l-7.4 7.3z"/></svg>',settings:'<svg width="24" height="24"><path d="M11 6h8c.6 0 1 .4 1 1s-.4 1-1 1h-8v.3c0 .2 0 .3-.2.5l-.6.2H7.8c-.3 0-.4 0-.6-.2a.7.7 0 0 1-.2-.6V8H5a1 1 0 1 1 0-2h2v-.3c0-.2 0-.3.2-.5l.5-.2h2.5c.3 0 .4 0 .6.2l.2.5V6zM8 8h2V6H8v2zm9 2.8v.2h2c.6 0 1 .4 1 1s-.4 1-1 1h-2v.3c0 .2 0 .3-.2.5l-.6.2h-2.4c-.3 0-.4 0-.6-.2a.7.7 0 0 1-.2-.6V13H5a1 1 0 0 1 0-2h8v-.3c0-.2 0-.3.2-.5l.6-.2h2.4c.3 0 .4 0 .6.2l.2.6zM14 13h2v-2h-2v2zm-3 2.8v.2h8c.6 0 1 .4 1 1s-.4 1-1 1h-8v.3c0 .2 0 .3-.2.5l-.6.2H7.8c-.3 0-.4 0-.6-.2a.7.7 0 0 1-.2-.6V18H5a1 1 0 0 1 0-2h2v-.3c0-.2 0-.3.2-.5l.5-.2h2.5c.3 0 .4 0 .6.2l.2.6zM8 18h2v-2H8v2z" fill-rule="evenodd"/></svg>',sharpen:'<svg width="24" height="24"><path d="M16 6l4 4-8 9-8-9 4-4h8zm-4 10.2l5.5-6.2-.1-.1H12v-.3h5.1l-.2-.2H12V9h4.6l-.2-.2H12v-.3h4.1l-.2-.2H12V8h3.6l-.2-.2H8.7L6.5 10l.1.1H12v.3H6.9l.2.2H12v.3H7.3l.2.2H12v.3H7.7l.3.2h4v.3H8.2l.2.2H12v.3H8.6l.3.2H12v.3H9l.3.2H12v.3H9.5l.2.2H12v.3h-2l.2.2H12v.3h-1.6l.2.2H12v.3h-1.1l.2.2h.9v.3h-.7l.2.2h.5v.3h-.3l.3.2z" fill-rule="evenodd"/></svg>',"sort-asc":'<svg width="24" height="24"><g fill-rule="evenodd"><path d="M4 8h5a1 1 0 1 1 0 2H4a1 1 0 1 1 0-2zm0 8h8a1 1 0 0 1 0 2H4a1 1 0 0 1 0-2zm0-4h7a1 1 0 0 1 0 2H4a1 1 0 0 1 0-2z"/><path fill-rule="nonzero" d="M16 8.4l-2.3 2.3a1 1 0 0 1-1.4-1.4l4-4a1 1 0 0 1 1.4 0l4 4a1 1 0 1 1-1.4 1.4L18 8.4V18a1 1 0 0 1-2 0V8.4z"/></g></svg>',"sort-dsc":'<svg width="24" height="24"><g fill-rule="evenodd"><path d="M4 16h5a1 1 0 0 0 0-2H4a1 1 0 0 0 0 2zm0-8h8a1 1 0 0 0 0-2H4a1 1 0 1 0 0 2zm0 4h7a1 1 0 0 0 0-2H4a1 1 0 0 0 0 2z"/><path fill-rule="nonzero" d="M16 15.6l-2.3-2.3a1 1 0 0 0-1.4 1.4l4 4c.4.4 1 .4 1.4 0l4-4a1 1 0 0 0-1.4-1.4L18 15.6V6a1 1 0 0 0-2 0v9.6z"/></g></svg>',sourcecode:'<svg width="24" height="24"><g fill-rule="nonzero"><path d="M9.8 15.7c.3.3.3.8 0 1-.3.4-.9.4-1.2 0l-4.4-4.1a.8.8 0 0 1 0-1.2l4.4-4.2c.3-.3.9-.3 1.2 0 .3.3.3.8 0 1.1L6 12l3.8 3.7zM14.2 15.7c-.3.3-.3.8 0 1 .4.4.9.4 1.2 0l4.4-4.1c.3-.3.3-.9 0-1.2l-4.4-4.2a.8.8 0 0 0-1.2 0c-.3.3-.3.8 0 1.1L18 12l-3.8 3.7z"/></g></svg>',"spell-check":'<svg width="24" height="24"><path d="M6 8v3H5V5c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3h2c.3 0 .5.1.7.3.2.2.3.4.3.7v6H8V8H6zm0-3v2h2V5H6zm13 0h-3v5h3v1h-3a1 1 0 0 1-.7-.3 1 1 0 0 1-.3-.7V5c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3h3v1zm-5 1.5l-.1.7c-.1.2-.3.3-.6.3.3 0 .5.1.6.3l.1.7V10c0 .3-.1.5-.3.7a1 1 0 0 1-.7.3h-3V4h3c.3 0 .5.1.7.3.2.2.3.4.3.7v1.5zM13 10V8h-2v2h2zm0-3V5h-2v2h2zm3 5l1 1-6.5 7L7 15.5l1.3-1 2.2 2.2L16 12z" fill-rule="evenodd"/></svg>',"strike-through":'<svg width="24" height="24"><g fill-rule="evenodd"><path d="M15.6 8.5c-.5-.7-1-1.1-1.3-1.3-.6-.4-1.3-.6-2-.6-2.7 0-2.8 1.7-2.8 2.1 0 1.6 1.8 2 3.2 2.3 4.4.9 4.6 2.8 4.6 3.9 0 1.4-.7 4.1-5 4.1A6.2 6.2 0 0 1 7 16.4l1.5-1.1c.4.6 1.6 2 3.7 2 1.6 0 2.5-.4 3-1.2.4-.8.3-2-.8-2.6-.7-.4-1.6-.7-2.9-1-1-.2-3.9-.8-3.9-3.6C7.6 6 10.3 5 12.4 5c2.9 0 4.2 1.6 4.7 2.4l-1.5 1.1z"/><path d="M5 11h14a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2z" fill-rule="nonzero"/></g></svg>',subscript:'<svg width="24" height="24"><path d="M10.4 10l4.6 4.6-1.4 1.4L9 11.4 4.4 16 3 14.6 7.6 10 3 5.4 4.4 4 9 8.6 13.6 4 15 5.4 10.4 10zM21 19h-5v-1l1-.8 1.7-1.6c.3-.4.5-.8.5-1.2 0-.3 0-.6-.2-.7-.2-.2-.5-.3-.9-.3a2 2 0 0 0-.8.2l-.7.3-.4-1.1 1-.6 1.2-.2c.8 0 1.4.3 1.8.7.4.4.6.9.6 1.5s-.2 1.1-.5 1.6a8 8 0 0 1-1.3 1.3l-.6.6h2.6V19z" fill-rule="nonzero"/></svg>',superscript:'<svg width="24" height="24"><path d="M15 9.4L10.4 14l4.6 4.6-1.4 1.4L9 15.4 4.4 20 3 18.6 7.6 14 3 9.4 4.4 8 9 12.6 13.6 8 15 9.4zm5.9 1.6h-5v-1l1-.8 1.7-1.6c.3-.5.5-.9.5-1.3 0-.3 0-.5-.2-.7-.2-.2-.5-.3-.9-.3l-.8.2-.7.4-.4-1.2c.2-.2.5-.4 1-.5.3-.2.8-.2 1.2-.2.8 0 1.4.2 1.8.6.4.4.6 1 .6 1.6 0 .5-.2 1-.5 1.5l-1.3 1.4-.6.5h2.6V11z" fill-rule="nonzero"/></svg>',"table-cell-properties":'<svg width="24" height="24"><path fill-rule="nonzero" d="M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zm-8 9H5v5h6v-5zm8 0h-6v5h6v-5zm-8-7H5v5h6V6z"/></svg>',"table-cell-select-all":'<svg width="24" height="24"><g fill-rule="evenodd"><path fill-rule="nonzero" d="M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zm0 2H5v12h14V6z"/><path d="M13 6v5h6v2h-6v5h-2v-5H5v-2h6V6h2z" opacity=".2"/></g></svg>',"table-cell-select-inner":'<svg width="24" height="24"><g fill-rule="evenodd"><path fill-rule="nonzero" d="M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zm0 2H5v12h14V6z" opacity=".2"/><path d="M13 6v5h6v2h-6v5h-2v-5H5v-2h6V6h2z"/></g></svg>',"table-delete-column":'<svg width="24" height="24"><path fill-rule="nonzero" d="M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zm-4 4h-2V6h-2v2H9V6H5v12h4v-2h2v2h2v-2h2v2h4V6h-4v2zm.3.5l1 1.2-3 2.3 3 2.3-1 1.2L12 13l-3.3 2.6-1-1.2 3-2.3-3-2.3 1-1.2L12 11l3.3-2.5z"/></svg>',"table-delete-row":'<svg width="24" height="24"><path fill-rule="nonzero" d="M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zm0 2H5v3h2.5v2H5v2h2.5v2H5v3h14v-3h-2.5v-2H19v-2h-2.5V9H19V6zm-4.7 1.8l1.2 1L13 12l2.6 3.3-1.2 1-2.3-3-2.3 3-1.2-1L11 12 8.5 8.7l1.2-1 2.3 3 2.3-3z"/></svg>',"table-delete-table":'<svg width="24" height="24"><g fill-rule="nonzero"><path d="M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zM5 6v12h14V6H5z"/><path d="M14.4 8.6l1 1-2.3 2.4 2.3 2.4-1 1-2.4-2.3-2.4 2.3-1-1 2.3-2.4-2.3-2.4 1-1 2.4 2.3z"/></g></svg>',"table-insert-column-after":'<svg width="24" height="24"><path fill-rule="nonzero" d="M20 4c.6 0 1 .4 1 1v2a1 1 0 0 1-2 0V6h-8v12h8v-1a1 1 0 0 1 2 0v2c0 .5-.4 1-.9 1H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h15zM9 13H5v5h4v-5zm7-5c.5 0 1 .4 1 .9V11h2a1 1 0 0 1 .1 2H17v2a1 1 0 0 1-2 .1V13h-2a1 1 0 0 1-.1-2H15V9c0-.6.4-1 1-1zM9 6H5v5h4V6z"/></svg>',"table-insert-column-before":'<svg width="24" height="24"><path fill-rule="nonzero" d="M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a1 1 0 0 1-1-1v-2a1 1 0 0 1 2 0v1h8V6H5v1a1 1 0 1 1-2 0V5c0-.6.4-1 1-1h15zm0 9h-4v5h4v-5zM8 8c.5 0 1 .4 1 .9V11h2a1 1 0 0 1 .1 2H9v2a1 1 0 0 1-2 .1V13H5a1 1 0 0 1-.1-2H7V9c0-.6.4-1 1-1zm11-2h-4v5h4V6z"/></svg>',"table-insert-row-above":'<svg width="24" height="24"><path fill-rule="nonzero" d="M6 4a1 1 0 1 1 0 2H5v6h14V6h-1a1 1 0 0 1 0-2h2c.6 0 1 .4 1 1v13a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5c0-.6.4-1 1-1h2zm5 10H5v4h6v-4zm8 0h-6v4h6v-4zM12 3c.5 0 1 .4 1 .9V6h2a1 1 0 0 1 0 2h-2v2a1 1 0 0 1-2 .1V8H9a1 1 0 0 1 0-2h2V4c0-.6.4-1 1-1z"/></svg>',"table-insert-row-after":'<svg width="24" height="24"><path fill-rule="nonzero" d="M12 13c.5 0 1 .4 1 .9V16h2a1 1 0 0 1 .1 2H13v2a1 1 0 0 1-2 .1V18H9a1 1 0 0 1-.1-2H11v-2c0-.6.4-1 1-1zm6 7a1 1 0 0 1 0-2h1v-6H5v6h1a1 1 0 0 1 0 2H4a1 1 0 0 1-1-1V6c0-1.1.9-2 2-2h14a2 2 0 0 1 2 2v13c0 .5-.4 1-.9 1H18zM11 6H5v4h6V6zm8 0h-6v4h6V6z"/></svg>',"table-left-header":'<svg width="24" height="24"><path d="M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zm0 9h-4v5h4v-5zm-6 0H9v5h4v-5zm0-7H9v5h4V6zm6 0h-4v5h4V6z"/></svg>',"table-merge-cells":'<svg width="24" height="24"><path fill-rule="nonzero" d="M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zM5 15.5V18h3v-2.5H5zm14-5h-9V18h9v-7.5zM19 6h-4v2.5h4V6zM8 6H5v2.5h3V6zm5 0h-3v2.5h3V6zm-8 7.5h3v-3H5v3z"/></svg>',"table-row-properties":'<svg width="24" height="24"><path fill-rule="nonzero" d="M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zM5 15v3h6v-3H5zm14 0h-6v3h6v-3zm0-9h-6v3h6V6zM5 9h6V6H5v3z"/></svg>',"table-split-cells":'<svg width="24" height="24"><path fill-rule="nonzero" d="M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zM8 15.5H5V18h3v-2.5zm11-5h-9V18h9v-7.5zm-2.5 1l1 1-2 2 2 2-1 1-2-2-2 2-1-1 2-2-2-2 1-1 2 2 2-2zm-8.5-1H5v3h3v-3zM19 6h-4v2.5h4V6zM8 6H5v2.5h3V6zm5 0h-3v2.5h3V6z"/></svg>',"table-top-header":'<svg width="24" height="24"><path d="M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zm-8 11H5v3h6v-3zm8 0h-6v3h6v-3zm0-5h-6v3h6v-3zM5 13h6v-3H5v3z"/></svg>',table:'<svg width="24" height="24"><path fill-rule="nonzero" d="M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zM5 14v4h6v-4H5zm14 0h-6v4h6v-4zm0-6h-6v4h6V8zM5 12h6V8H5v4z"/></svg>',template:'<svg width="24" height="24"><path d="M19 19v-1H5v1h14zM9 16v-4a5 5 0 1 1 6 0v4h4a2 2 0 0 1 2 2v3H3v-3c0-1.1.9-2 2-2h4zm4 0v-5l.8-.6a3 3 0 1 0-3.6 0l.8.6v5h2z" fill-rule="nonzero"/></svg>',"temporary-placeholder":'<svg width="24" height="24"><g fill-rule="evenodd"><path d="M9 7.6V6h2.5V4.5a.5.5 0 1 1 1 0V6H15v1.6a8 8 0 1 1-6 0zm-2.6 5.3a.5.5 0 0 0 .3.6c.3 0 .6 0 .6-.3l.1-.2a5 5 0 0 1 3.3-2.8c.3-.1.4-.4.4-.6-.1-.3-.4-.5-.6-.4a6 6 0 0 0-4.1 3.7z"/><circle cx="14" cy="4" r="1"/><circle cx="12" cy="2" r="1"/><circle cx="10" cy="4" r="1"/></g></svg>',"text-color":'<svg width="24" height="24"><g fill-rule="evenodd"><path id="tox-icon-text-color__color" d="M3 18h18v3H3z"/><path d="M8.7 16h-.8a.5.5 0 0 1-.5-.6l2.7-9c.1-.3.3-.4.5-.4h2.8c.2 0 .4.1.5.4l2.7 9a.5.5 0 0 1-.5.6h-.8a.5.5 0 0 1-.4-.4l-.7-2.2c0-.3-.3-.4-.5-.4h-3.4c-.2 0-.4.1-.5.4l-.7 2.2c0 .3-.2.4-.4.4zm2.6-7.6l-.6 2a.5.5 0 0 0 .5.6h1.6a.5.5 0 0 0 .5-.6l-.6-2c0-.3-.3-.4-.5-.4h-.4c-.2 0-.4.1-.5.4z"/></g></svg>',toc:'<svg width="24" height="24"><path d="M5 5c.6 0 1 .4 1 1s-.4 1-1 1a1 1 0 1 1 0-2zm3 0h11c.6 0 1 .4 1 1s-.4 1-1 1H8a1 1 0 1 1 0-2zm-3 8c.6 0 1 .4 1 1s-.4 1-1 1a1 1 0 0 1 0-2zm3 0h11c.6 0 1 .4 1 1s-.4 1-1 1H8a1 1 0 0 1 0-2zm0-4c.6 0 1 .4 1 1s-.4 1-1 1a1 1 0 1 1 0-2zm3 0h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zm-3 8c.6 0 1 .4 1 1s-.4 1-1 1a1 1 0 0 1 0-2zm3 0h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2z" fill-rule="evenodd"/></svg>',translate:'<svg width="24" height="24"><path d="M12.7 14.3l-.3.7-.4.7-2.2-2.2-3.1 3c-.3.4-.8.4-1 0a.7.7 0 0 1 0-1l3.1-3A12.4 12.4 0 0 1 6.7 9H8a10.1 10.1 0 0 0 1.7 2.4c.5-.5 1-1.1 1.4-1.8l.9-2H4.7a.7.7 0 1 1 0-1.5h4.4v-.7c0-.4.3-.8.7-.8.4 0 .7.4.7.8v.7H15c.4 0 .8.3.8.7 0 .4-.4.8-.8.8h-1.4a12.3 12.3 0 0 1-1 2.4 13.5 13.5 0 0 1-1.7 2.3l1.9 1.8zm4.3-3l2.7 7.3a.5.5 0 0 1-.4.7 1 1 0 0 1-1-.7l-.6-1.5h-3.4l-.6 1.5a1 1 0 0 1-1 .7.5.5 0 0 1-.4-.7l2.7-7.4a1 1 0 1 1 2 0zm-2.2 4.4h2.4L16 12.5l-1.2 3.2z" fill-rule="evenodd"/></svg>',underline:'<svg width="24" height="24"><path d="M16 5c.6 0 1 .4 1 1v5.5a4 4 0 0 1-.4 1.8l-1 1.4a5.3 5.3 0 0 1-5.5 1 5 5 0 0 1-1.6-1c-.5-.4-.8-.9-1.1-1.4a4 4 0 0 1-.4-1.8V6c0-.6.4-1 1-1s1 .4 1 1v5.5c0 .3 0 .6.2 1l.6.7a3.3 3.3 0 0 0 2.2.8 3.4 3.4 0 0 0 2.2-.8c.3-.2.4-.5.6-.8l.2-.9V6c0-.6.4-1 1-1zM8 17h8c.6 0 1 .4 1 1s-.4 1-1 1H8a1 1 0 0 1 0-2z" fill-rule="evenodd"/></svg>',undo:'<svg width="24" height="24"><path d="M6.4 8H12c3.7 0 6.2 2 6.8 5.1.6 2.7-.4 5.6-2.3 6.8a1 1 0 0 1-1-1.8c1.1-.6 1.8-2.7 1.4-4.6-.5-2.1-2.1-3.5-4.9-3.5H6.4l3.3 3.3a1 1 0 1 1-1.4 1.4l-5-5a1 1 0 0 1 0-1.4l5-5a1 1 0 0 1 1.4 1.4L6.4 8z" fill-rule="nonzero"/></svg>',unlink:'<svg width="24" height="24"><path d="M6.2 12.3a1 1 0 0 1 1.4 1.4l-2 2a2 2 0 1 0 2.6 2.8l4.8-4.8a1 1 0 0 0 0-1.4 1 1 0 1 1 1.4-1.3 2.9 2.9 0 0 1 0 4L9.6 20a3.9 3.9 0 0 1-5.5-5.5l2-2zm11.6-.6a1 1 0 0 1-1.4-1.4l2.1-2a2 2 0 1 0-2.7-2.8L11 10.3a1 1 0 0 0 0 1.4A1 1 0 1 1 9.6 13a2.9 2.9 0 0 1 0-4L14.4 4a3.9 3.9 0 0 1 5.5 5.5l-2 2zM7.6 6.3a.8.8 0 0 1-1 1.1L3.3 4.2a.7.7 0 1 1 1-1l3.2 3.1zM5.1 8.6a.8.8 0 0 1 0 1.5H3a.8.8 0 0 1 0-1.5H5zm5-3.5a.8.8 0 0 1-1.5 0V3a.8.8 0 0 1 1.5 0V5zm6 11.8a.8.8 0 0 1 1-1l3.2 3.2a.8.8 0 0 1-1 1L16 17zm-2.2 2a.8.8 0 0 1 1.5 0V21a.8.8 0 0 1-1.5 0V19zm5-3.5a.7.7 0 1 1 0-1.5H21a.8.8 0 0 1 0 1.5H19z" fill-rule="nonzero"/></svg>',unlock:'<svg width="24" height="24"><path d="M16 5c.8 0 1.5.3 2.1.9.6.6.9 1.3.9 2.1v3h-2V8a1 1 0 0 0-.3-.7A1 1 0 0 0 16 7h-2a1 1 0 0 0-.7.3 1 1 0 0 0-.3.7v3h.3c.2 0 .3 0 .5.2l.2.6v7.4c0 .3 0 .4-.2.6l-.6.2H4.8c-.3 0-.4 0-.6-.2a.7.7 0 0 1-.2-.6v-7.4c0-.3 0-.4.2-.6l.5-.2H11V8c0-.8.3-1.5.9-2.1.6-.6 1.3-.9 2.1-.9h2z" fill-rule="evenodd"/></svg>',"unordered-list":'<svg width="24" height="24"><path d="M11 5h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zm0 6h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zm0 6h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zM4.5 6c0-.4.1-.8.4-1 .3-.4.7-.5 1.1-.5.4 0 .8.1 1 .4.4.3.5.7.5 1.1 0 .4-.1.8-.4 1-.3.4-.7.5-1.1.5-.4 0-.8-.1-1-.4-.4-.3-.5-.7-.5-1.1zm0 6c0-.4.1-.8.4-1 .3-.4.7-.5 1.1-.5.4 0 .8.1 1 .4.4.3.5.7.5 1.1 0 .4-.1.8-.4 1-.3.4-.7.5-1.1.5-.4 0-.8-.1-1-.4-.4-.3-.5-.7-.5-1.1zm0 6c0-.4.1-.8.4-1 .3-.4.7-.5 1.1-.5.4 0 .8.1 1 .4.4.3.5.7.5 1.1 0 .4-.1.8-.4 1-.3.4-.7.5-1.1.5-.4 0-.8-.1-1-.4-.4-.3-.5-.7-.5-1.1z" fill-rule="evenodd"/></svg>',unselected:'<svg width="24" height="24"><path fill-rule="nonzero" d="M6 4h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2zm0 1a1 1 0 0 0-1 1v12c0 .6.4 1 1 1h12c.6 0 1-.4 1-1V6c0-.6-.4-1-1-1H6z"/></svg>',upload:'<svg width="24" height="24"><path d="M18 19v-2a1 1 0 0 1 2 0v3c0 .6-.4 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 2 0v2h12zM11 6.4L8.7 8.7a1 1 0 0 1-1.4-1.4l4-4a1 1 0 0 1 1.4 0l4 4a1 1 0 1 1-1.4 1.4L13 6.4V16a1 1 0 0 1-2 0V6.4z" fill-rule="nonzero"/></svg>',user:'<svg width="24" height="24"><path d="M12 24a12 12 0 1 1 0-24 12 12 0 0 1 0 24zm-8.7-5.3a11 11 0 0 0 17.4 0C19.4 16.3 14.6 15 12 15c-2.6 0-7.4 1.3-8.7 3.7zM12 13c2.2 0 4-2 4-4.5S14.2 4 12 4 8 6 8 8.5 9.8 13 12 13z" fill-rule="nonzero"/></svg>',visualblocks:'<svg width="24" height="24"><path d="M9 19v2H7v-2h2zm-4 0v2a2 2 0 0 1-2-2h2zm8 0v2h-2v-2h2zm8 0a2 2 0 0 1-2 2v-2h2zm-4 0v2h-2v-2h2zM15 7a1 1 0 0 1 0 2v7a1 1 0 0 1-2 0V9h-1v7a1 1 0 0 1-2 0v-4a2.5 2.5 0 0 1-.2-5H15zM5 15v2H3v-2h2zm16 0v2h-2v-2h2zM5 11v2H3v-2h2zm16 0v2h-2v-2h2zM5 7v2H3V7h2zm16 0v2h-2V7h2zM5 3v2H3c0-1.1.9-2 2-2zm8 0v2h-2V3h2zm6 0a2 2 0 0 1 2 2h-2V3zM9 3v2H7V3h2zm8 0v2h-2V3h2z" fill-rule="evenodd"/></svg>',visualchars:'<svg width="24" height="24"><path d="M10 5h7a1 1 0 0 1 0 2h-1v11a1 1 0 0 1-2 0V7h-2v11a1 1 0 0 1-2 0v-6c-.5 0-1 0-1.4-.3A3.4 3.4 0 0 1 6.8 10a3.3 3.3 0 0 1 0-2.8 3.4 3.4 0 0 1 1.8-1.8L10 5z" fill-rule="evenodd"/></svg>',warning:'<svg width="24" height="24"><path d="M19.8 18.3c.2.5.3.9 0 1.2-.1.3-.5.5-1 .5H5.2c-.5 0-.9-.2-1-.5-.3-.3-.2-.7 0-1.2L11 4.7l.5-.5.5-.2c.2 0 .3 0 .5.2.2 0 .3.3.5.5l6.8 13.6zM12 18c.3 0 .5-.1.7-.3.2-.2.3-.4.3-.7a1 1 0 0 0-.3-.7 1 1 0 0 0-.7-.3 1 1 0 0 0-.7.3 1 1 0 0 0-.3.7c0 .3.1.5.3.7.2.2.4.3.7.3zm.7-3l.3-4a1 1 0 0 0-.3-.7 1 1 0 0 0-.7-.3 1 1 0 0 0-.7.3 1 1 0 0 0-.3.7l.3 4h1.4z" fill-rule="evenodd"/></svg>',"zoom-in":'<svg width="24" height="24"><path d="M16 17.3a8 8 0 1 1 1.4-1.4l4.3 4.4a1 1 0 0 1-1.4 1.4l-4.4-4.3zm-5-.3a6 6 0 1 0 0-12 6 6 0 0 0 0 12zm-1-9a1 1 0 0 1 2 0v6a1 1 0 0 1-2 0V8zm-2 4a1 1 0 0 1 0-2h6a1 1 0 0 1 0 2H8z" fill-rule="nonzero"/></svg>',"zoom-out":'<svg width="24" height="24"><path d="M16 17.3a8 8 0 1 1 1.4-1.4l4.3 4.4a1 1 0 0 1-1.4 1.4l-4.4-4.3zm-5-.3a6 6 0 1 0 0-12 6 6 0 0 0 0 12zm-3-5a1 1 0 0 1 0-2h6a1 1 0 0 1 0 2H8z" fill-rule="nonzero"/></svg>'}},isContentCssSkinName=function(url){return/^[a-z0-9\-]+$/i.test(url)},getContentCssUrls=function(editor){var contentCss=Settings.getContentCss(editor),skinUrl=editor.editorManager.baseURL+"/skins/content",suffix=editor.editorManager.suffix,contentCssFile="content"+suffix+".css",inline=!0===editor.inline;return map(contentCss,function(url){return isContentCssSkinName(url)&&!inline?skinUrl+"/"+url+"/"+contentCssFile:editor.documentBaseURI.toAbsolute(url)})},appendContentCssFromSettings=function(editor){editor.contentCSS=editor.contentCSS.concat(getContentCssUrls(editor))};!function(BookmarkManager){BookmarkManager.isBookmarkNode=Bookmarks.isBookmarkNode}(BookmarkManager||(BookmarkManager={}));var BookmarkManager$1=BookmarkManager,isXYWithinRange=function(clientX,clientY,range){if(range.collapsed)return!1;if(Env.browser.isIE()&&range.startOffset===range.endOffset-1&&range.startContainer===range.endContainer){var elm=range.startContainer.childNodes[range.startOffset];if(NodeType.isElement(elm))return exists(elm.getClientRects(),function(rect){return containsXY(rect,clientX,clientY)})}return exists(range.getClientRects(),function(rect){return containsXY(rect,clientX,clientY)})},RangePoint={isXYWithinRange:isXYWithinRange},VK={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,END:35,HOME:36,modifierPressed:function(e){return e.shiftKey||e.ctrlKey||e.altKey||this.metaKeyPressed(e)},metaKeyPressed:function(e){return Env.mac?e.metaKey:e.ctrlKey&&!e.altKey}},isContentEditableFalse$6=NodeType.isContentEditableFalse,isContentEditableTrue$2=NodeType.isContentEditableTrue,getContentEditableRoot=function(root,node){for(;node&&node!==root;){if(isContentEditableTrue$2(node)||isContentEditableFalse$6(node))return node;node=node.parentNode}return null},ControlSelection=function(selection,editor){var selectedElm,selectedElmGhost,resizeHelper,resizeHandles,selectedHandle,startX,startY,selectedElmX,selectedElmY,startW,startH,ratio,resizeStarted,width,height,startScrollWidth,startScrollHeight,dom=editor.dom,each=Tools.each,editableDoc=editor.getDoc(),rootDocument=domGlobals.document,abs=Math.abs,round=Math.round,rootElement=editor.getBody();resizeHandles={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]};var isImage=function(elm){return elm&&("IMG"===elm.nodeName||editor.dom.is(elm,"figure.image"))},isEventOnImageOutsideRange=function(evt,range){if("longpress"===evt.type||0===evt.type.indexOf("touch")){var touch=evt.touches[0];return isImage(evt.target)&&!RangePoint.isXYWithinRange(touch.clientX,touch.clientY,range)}return isImage(evt.target)&&!RangePoint.isXYWithinRange(evt.clientX,evt.clientY,range)},contextMenuSelectImage=function(evt){var target=evt.target;isEventOnImageOutsideRange(evt,editor.selection.getRng())&&!evt.isDefaultPrevented()&&editor.selection.select(target)},getResizeTarget=function(elm){return editor.dom.is(elm,"figure.image")?elm.querySelector("img"):elm},isResizable=function(elm){var selector=Settings.getObjectResizing(editor);return!1!==selector&&!Env.iOS&&("string"!=typeof selector&&(selector="table,img,figure.image,div"),"false"!==elm.getAttribute("data-mce-resize")&&(elm!==editor.getBody()&&is(Element.fromDom(elm),selector)))},resizeGhostElement=function(e){var deltaX,deltaY,proportional,resizeHelperX,resizeHelperY;deltaX=e.screenX-startX,deltaY=e.screenY-startY,width=deltaX*selectedHandle[2]+startW,height=deltaY*selectedHandle[3]+startH,width=width<5?5:width,height=height<5?5:height,proportional=isImage(selectedElm)&&!1!==Settings.getResizeImgProportional(editor)?!VK.modifierPressed(e):VK.modifierPressed(e),proportional&&(abs(deltaX)>abs(deltaY)?(height=round(width*ratio),width=round(height/ratio)):(width=round(height/ratio),height=round(width*ratio))),dom.setStyles(getResizeTarget(selectedElmGhost),{width:width,height:height}),resizeHelperX=selectedHandle.startPos.x+deltaX,resizeHelperY=selectedHandle.startPos.y+deltaY,resizeHelperX=resizeHelperX>0?resizeHelperX:0,resizeHelperY=resizeHelperY>0?resizeHelperY:0,dom.setStyles(resizeHelper,{left:resizeHelperX,top:resizeHelperY,display:"block"}),resizeHelper.innerHTML=width+" &times; "+height,selectedHandle[2]<0&&selectedElmGhost.clientWidth<=width&&dom.setStyle(selectedElmGhost,"left",selectedElmX+(startW-width)),selectedHandle[3]<0&&selectedElmGhost.clientHeight<=height&&dom.setStyle(selectedElmGhost,"top",selectedElmY+(startH-height)),deltaX=rootElement.scrollWidth-startScrollWidth,deltaY=rootElement.scrollHeight-startScrollHeight,deltaX+deltaY!==0&&dom.setStyles(resizeHelper,{left:resizeHelperX-deltaX,top:resizeHelperY-deltaY}),resizeStarted||(fireObjectResizeStart(editor,selectedElm,startW,startH),resizeStarted=!0)},endGhostResize=function(){resizeStarted=!1;var setSizeProp=function(name,value){value&&(selectedElm.style[name]||!editor.schema.isValid(selectedElm.nodeName.toLowerCase(),name)?dom.setStyle(getResizeTarget(selectedElm),name,value):dom.setAttrib(getResizeTarget(selectedElm),name,value))};setSizeProp("width",width),setSizeProp("height",height),dom.unbind(editableDoc,"mousemove",resizeGhostElement),dom.unbind(editableDoc,"mouseup",endGhostResize),rootDocument!==editableDoc&&(dom.unbind(rootDocument,"mousemove",resizeGhostElement),dom.unbind(rootDocument,"mouseup",endGhostResize)),dom.remove(selectedElmGhost),dom.remove(resizeHelper),showResizeRect(selectedElm),fireObjectResized(editor,selectedElm,width,height),dom.setAttrib(selectedElm,"style",dom.getAttrib(selectedElm,"style")),editor.nodeChanged()},showResizeRect=function(targetElm){var position,targetWidth,targetHeight,e,rect;hideResizeRect(),unbindResizeHandleEvents(),position=dom.getPos(targetElm,rootElement),selectedElmX=position.x,selectedElmY=position.y,rect=targetElm.getBoundingClientRect(),targetWidth=rect.width||rect.right-rect.left,targetHeight=rect.height||rect.bottom-rect.top,selectedElm!==targetElm&&(selectedElm=targetElm,width=height=0),e=editor.fire("ObjectSelected",{target:targetElm}),isResizable(targetElm)&&!e.isDefaultPrevented()?each(resizeHandles,function(handle,name){var handleElm,startDrag=function(e){startX=e.screenX,startY=e.screenY,startW=getResizeTarget(selectedElm).clientWidth,startH=getResizeTarget(selectedElm).clientHeight,ratio=startH/startW,selectedHandle=handle,handle.startPos={x:targetWidth*handle[0]+selectedElmX,y:targetHeight*handle[1]+selectedElmY},startScrollWidth=rootElement.scrollWidth,startScrollHeight=rootElement.scrollHeight,selectedElmGhost=selectedElm.cloneNode(!0),dom.addClass(selectedElmGhost,"mce-clonedresizable"),dom.setAttrib(selectedElmGhost,"data-mce-bogus","all"),selectedElmGhost.contentEditable=!1,selectedElmGhost.unSelectabe=!0,dom.setStyles(selectedElmGhost,{left:selectedElmX,top:selectedElmY,margin:0}),selectedElmGhost.removeAttribute("data-mce-selected"),rootElement.appendChild(selectedElmGhost),dom.bind(editableDoc,"mousemove",resizeGhostElement),dom.bind(editableDoc,"mouseup",endGhostResize),rootDocument!==editableDoc&&(dom.bind(rootDocument,"mousemove",resizeGhostElement),dom.bind(rootDocument,"mouseup",endGhostResize)),resizeHelper=dom.add(rootElement,"div",{class:"mce-resize-helper","data-mce-bogus":"all"},startW+" &times; "+startH)};handleElm=dom.get("mceResizeHandle"+name),handleElm&&dom.remove(handleElm),handleElm=dom.add(rootElement,"div",{id:"mceResizeHandle"+name,"data-mce-bogus":"all",class:"mce-resizehandle",unselectable:!0,style:"cursor:"+name+"-resize; margin:0; padding:0"}),11===Env.ie&&(handleElm.contentEditable=!1),dom.bind(handleElm,"mousedown",function(e){e.stopImmediatePropagation(),e.preventDefault(),startDrag(e)}),handle.elm=handleElm,dom.setStyles(handleElm,{left:targetWidth*handle[0]+selectedElmX-handleElm.offsetWidth/2,top:targetHeight*handle[1]+selectedElmY-handleElm.offsetHeight/2})}):hideResizeRect(),selectedElm.setAttribute("data-mce-selected","1")},hideResizeRect=function(){var name,handleElm;unbindResizeHandleEvents(),selectedElm&&selectedElm.removeAttribute("data-mce-selected");for(name in resizeHandles)(handleElm=dom.get("mceResizeHandle"+name))&&(dom.unbind(handleElm),dom.remove(handleElm))},updateResizeRect=function(e){var startElm,controlElm,isChildOrEqual=function(node,parent){if(node)do{if(node===parent)return!0}while(node=node.parentNode)};if(!resizeStarted&&!editor.removed){if(each(dom.select("img[data-mce-selected],hr[data-mce-selected]"),function(img){img.removeAttribute("data-mce-selected")}),controlElm="mousedown"===e.type?e.target:selection.getNode(),controlElm=dom.$(controlElm).closest("table,img,figure.image,hr")[0],isChildOrEqual(controlElm,rootElement)&&(disableGeckoResize(),startElm=selection.getStart(!0),isChildOrEqual(startElm,controlElm)&&isChildOrEqual(selection.getEnd(!0),controlElm)))return void showResizeRect(controlElm);hideResizeRect()}},isWithinContentEditableFalse=function(elm){return isContentEditableFalse$6(getContentEditableRoot(editor.getBody(),elm))},unbindResizeHandleEvents=function(){for(var name_1 in resizeHandles){var handle=resizeHandles[name_1];handle.elm&&(dom.unbind(handle.elm),delete handle.elm)}},disableGeckoResize=function(){try{editor.getDoc().execCommand("enableObjectResizing",!1,!1)}catch(ex){}};return editor.on("init",function(){if(disableGeckoResize(),Env.browser.isIE()||Env.browser.isEdge()){editor.on("mousedown click",function(e){var target=e.target,nodeName=target.nodeName;resizeStarted||!/^(TABLE|IMG|HR)$/.test(nodeName)||isWithinContentEditableFalse(target)||(2!==e.button&&editor.selection.select(target,"TABLE"===nodeName),"mousedown"===e.type&&editor.nodeChanged())});var handleMSControlSelect_1=function(e){var delayedSelect=function(node){Delay.setEditorTimeout(editor,function(){return editor.selection.select(node)})};if(isWithinContentEditableFalse(e.target))return e.preventDefault(),void delayedSelect(e.target);/^(TABLE|IMG|HR)$/.test(e.target.nodeName)&&(e.preventDefault(),"IMG"===e.target.tagName&&delayedSelect(e.target))};dom.bind(rootElement,"mscontrolselect",handleMSControlSelect_1),editor.on("remove",function(){return dom.unbind(rootElement,"mscontrolselect",handleMSControlSelect_1)})}var throttledUpdateResizeRect=Delay.throttle(function(e){editor.composing||updateResizeRect(e)});editor.on("nodechange ResizeEditor ResizeWindow drop FullscreenStateChanged",throttledUpdateResizeRect),editor.on("keyup compositionend",function(e){selectedElm&&"TABLE"===selectedElm.nodeName&&throttledUpdateResizeRect(e)}),editor.on("hide blur",hideResizeRect),editor.on("contextmenu longpress",contextMenuSelectImage,!0)}),editor.on("remove",unbindResizeHandleEvents),{isResizable:isResizable,showResizeRect:showResizeRect,hideResizeRect:hideResizeRect,updateResizeRect:updateResizeRect,destroy:function(){selectedElm=selectedElmGhost=null}}},api$1=function(name,getOffset){var set=function(element,h){if(!isNumber(h)&&!h.match(/^[0-9]+$/))throw new Error(name+".set accepts only positive integer values. Value was "+h);var dom=element.dom();isSupported(dom)&&(dom.style[name]=h+"px")},get=function(element){var r=getOffset(element);if(r<=0||null===r){var css=get$4(element,name);return parseFloat(css)||0}return r},getOuter=get,aggregate=function(element,properties){return foldl(properties,function(acc,property){var val=get$4(element,property),value=void 0===val?0:parseInt(val,10);return isNaN(value)?acc:acc+value},0)};return{set:set,get:get,getOuter:getOuter,aggregate:aggregate,max:function(element,value,properties){var cumulativeInclusions=aggregate(element,properties);return value>cumulativeInclusions?value-cumulativeInclusions:0}}}("height",function(element){var dom=element.dom();return inBody(element)?dom.getBoundingClientRect().height:dom.offsetHeight}),get$8=function(element){return api$1.get(element)},walkUp=function(navigation,doc){return navigation.view(doc).fold(constant([]),function(f){var parent=navigation.owner(f);return[f].concat(walkUp(navigation,parent))})},pathTo=function(element,navigation){var d=navigation.owner(element);return walkUp(navigation,d)},view=function(doc){return(doc.dom()===domGlobals.document?Option.none():Option.from(doc.dom().defaultView.frameElement)).map(Element.fromDom)},owner$1=function(element){return owner(element)},Navigation=Object.freeze({__proto__:null,view:view,owner:owner$1}),find$3=function(element){var doc=Element.fromDom(domGlobals.document),scroll=get$1(doc),frames=pathTo(element,Navigation),offset=viewport(element),r=foldr(frames,function(b,a){var loc=viewport(a);return{left:b.left+loc.left(),top:b.top+loc.top()}},{left:0,top:0});return Position(r.left+offset.left()+scroll.left(),r.top+offset.top()+scroll.top())},excludeFromDescend=function(element){return"textarea"===name(element)},fireScrollIntoViewEvent=function(editor,data){return editor.fire("ScrollIntoView",data).isDefaultPrevented()},fireAfterScrollIntoViewEvent=function(editor,data){editor.fire("AfterScrollIntoView",data)},descend=function(element,offset){var children$1=children(element);if(0===children$1.length||excludeFromDescend(element))return{element:element,offset:offset};if(offset<children$1.length&&!excludeFromDescend(children$1[offset]))return{element:children$1[offset],offset:0};var last=children$1[children$1.length-1];return excludeFromDescend(last)?{element:element,offset:offset}:"img"===name(last)?{element:last,offset:1}:isText(last)?{element:last,offset:get$7(last).length}:{element:last,offset:children(last).length}},markerInfo=function(element,cleanupFun){var pos=absolute(element),height=get$8(element);return{element:element,bottom:pos.top()+height,height:height,pos:pos,cleanup:cleanupFun}},createMarker=function(element,offset){var startPoint=descend(element,offset),span=Element.fromHtml('<span data-mce-bogus="all">'+Zwsp.ZWSP+"</span>");return before(startPoint.element,span),markerInfo(span,function(){return remove(span)})},elementMarker=function(element){return markerInfo(Element.fromDom(element),noop)},withMarker=function(editor,f,rng,alignToTop){preserveWith(editor,function(_s,_e){return applyWithMarker(editor,f,rng,alignToTop)},rng)},withScrollEvents=function(editor,doc,f,marker,alignToTop){var data={elm:marker.element.dom(),alignToTop:alignToTop};if(!fireScrollIntoViewEvent(editor,data)){f(doc,get$1(doc).top(),marker,alignToTop),fireAfterScrollIntoViewEvent(editor,data)}},applyWithMarker=function(editor,f,rng,alignToTop){var body=Element.fromDom(editor.getBody()),doc=Element.fromDom(editor.getDoc());reflow(body);var marker=createMarker(Element.fromDom(rng.startContainer),rng.startOffset);withScrollEvents(editor,doc,f,marker,alignToTop),marker.cleanup()},withElement=function(editor,element,f,alignToTop){var doc=Element.fromDom(editor.getDoc());withScrollEvents(editor,doc,f,elementMarker(element),alignToTop)},preserveWith=function(editor,f,rng){var startElement=rng.startContainer,startOffset=rng.startOffset,endElement=rng.endContainer,endOffset=rng.endOffset;f(Element.fromDom(startElement),Element.fromDom(endElement));var newRng=editor.dom.createRng();newRng.setStart(startElement,startOffset),newRng.setEnd(endElement,endOffset),editor.selection.setRng(rng)},scrollToMarker=function(marker,viewHeight,alignToTop,doc){var pos=marker.pos;if(alignToTop)to(pos.left(),pos.top(),doc);else{var y=pos.top()-viewHeight+marker.height;to(pos.left(),y,doc)}},intoWindowIfNeeded=function(doc,scrollTop,viewHeight,marker,alignToTop){var viewportBottom=viewHeight+scrollTop,markerTop=marker.pos.top(),markerBottom=marker.bottom,largerThanViewport=markerBottom-markerTop>=viewHeight;if(markerTop<scrollTop)scrollToMarker(marker,viewHeight,!1!==alignToTop,doc);else if(markerTop>viewportBottom){var align=largerThanViewport?!1!==alignToTop:!0===alignToTop;scrollToMarker(marker,viewHeight,align,doc)}else markerBottom>viewportBottom&&!largerThanViewport&&scrollToMarker(marker,viewHeight,!0===alignToTop,doc)},intoWindow=function(doc,scrollTop,marker,alignToTop){var viewHeight=doc.dom().defaultView.innerHeight;intoWindowIfNeeded(doc,scrollTop,viewHeight,marker,alignToTop)},intoFrame=function(doc,scrollTop,marker,alignToTop){var frameViewHeight=doc.dom().defaultView.innerHeight;intoWindowIfNeeded(doc,scrollTop,frameViewHeight,marker,alignToTop);var op=find$3(marker.element),viewportBounds=getBounds(domGlobals.window);op.top()<viewportBounds.y()?intoView(marker.element,!1!==alignToTop):op.top()>viewportBounds.bottom()&&intoView(marker.element,!0===alignToTop)},rangeIntoWindow=function(editor,rng,alignToTop){return withMarker(editor,intoWindow,rng,alignToTop)},elementIntoWindow=function(editor,element,alignToTop){return withElement(editor,element,intoWindow,alignToTop)},rangeIntoFrame=function(editor,rng,alignToTop){return withMarker(editor,intoFrame,rng,alignToTop)},elementIntoFrame=function(editor,element,alignToTop){return withElement(editor,element,intoFrame,alignToTop)},elementIntoView=function(editor,element,alignToTop){(editor.inline?elementIntoWindow:elementIntoFrame)(editor,element,alignToTop)},rangeIntoView=function(editor,rng,alignToTop){(editor.inline?rangeIntoWindow:rangeIntoFrame)(editor,rng,alignToTop)},ScrollIntoView={scrollElementIntoView:elementIntoView,scrollRangeIntoView:rangeIntoView},hasCeProperty=function(node){return NodeType.isContentEditableTrue(node)||NodeType.isContentEditableFalse(node)},findParent=function(node,rootNode,predicate){for(;node&&node!==rootNode;){if(predicate(node))return node;node=node.parentNode}return null},findClosestIeRange=function(clientX,clientY,doc){var element,rng,rects;if(element=doc.elementFromPoint(clientX,clientY),rng=doc.body.createTextRange(),element&&"HTML"!==element.tagName||(element=doc.body),rng.moveToElementText(element),rects=Tools.toArray(rng.getClientRects()),rects=rects.sort(function(a,b){return a=Math.abs(Math.max(a.top-clientY,a.bottom-clientY)),b=Math.abs(Math.max(b.top-clientY,b.bottom-clientY)),a-b}),rects.length>0){clientY=(rects[0].bottom+rects[0].top)/2;try{return rng.moveToPoint(clientX,clientY),rng.collapse(!0),rng}catch(ex){}}return null},moveOutOfContentEditableFalse=function(rng,rootNode){var parentElement=rng&&rng.parentElement?rng.parentElement():null;return NodeType.isContentEditableFalse(findParent(parentElement,rootNode,hasCeProperty))?null:rng},fromPoint$1=function(clientX,clientY,doc){var rng,point,pointDoc=doc;if(pointDoc.caretPositionFromPoint)(point=pointDoc.caretPositionFromPoint(clientX,clientY))&&(rng=doc.createRange(),rng.setStart(point.offsetNode,point.offset),rng.collapse(!0));else if(doc.caretRangeFromPoint)rng=doc.caretRangeFromPoint(clientX,clientY);else if(pointDoc.body.createTextRange){rng=pointDoc.body.createTextRange();try{rng.moveToPoint(clientX,clientY),rng.collapse(!0)}catch(ex){rng=findClosestIeRange(clientX,clientY,doc)}return moveOutOfContentEditableFalse(rng,doc.body)}return rng},CaretRangeFromPoint={fromPoint:fromPoint$1},processRanges=function(editor,ranges){return map(ranges,function(range){var evt=editor.fire("GetSelectionRange",{range:range});return evt.range!==range?evt.range:range})},EventProcessRanges={processRanges:processRanges},fromElements=function(elements,scope){var doc=scope||domGlobals.document,fragment=doc.createDocumentFragment();return each(elements,function(element){fragment.appendChild(element.dom())}),Element.fromDom(fragment)},dropLast=function(xs){return xs.slice(0,-1)},parentsUntil$1=function(start,root,predicate){return contains$2(root,start)?dropLast(parents(start,function(elm){return predicate(elm)||eq(elm,root)})):[]},parents$1=function(start,root){return parentsUntil$1(start,root,constant(!1))},parentsAndSelf=function(start,root){return[start].concat(parents$1(start,root))},Parents={parentsUntil:parentsUntil$1,parents:parents$1,parentsAndSelf:parentsAndSelf},getStartNode=function(rng){var sc=rng.startContainer,so=rng.startOffset;return NodeType.isText(sc)?0===so?Option.some(Element.fromDom(sc)):Option.none():Option.from(sc.childNodes[so]).map(Element.fromDom)},getEndNode=function(rng){var ec=rng.endContainer,eo=rng.endOffset;return NodeType.isText(ec)?eo===ec.data.length?Option.some(Element.fromDom(ec)):Option.none():Option.from(ec.childNodes[eo-1]).map(Element.fromDom)},getFirstChildren=function(node){return firstChild(node).fold(constant([node]),function(child){return[node].concat(getFirstChildren(child))})},getLastChildren=function(node){return lastChild(node).fold(constant([node]),function(child){return"br"===name(child)?prevSibling(child).map(function(sibling){return[node].concat(getLastChildren(sibling))}).getOr([]):[node].concat(getLastChildren(child))})},hasAllContentsSelected=function(elm,rng){return lift2(getStartNode(rng),getEndNode(rng),function(startNode,endNode){var start=find(getFirstChildren(elm),curry(eq,startNode)),end=find(getLastChildren(elm),curry(eq,endNode));return start.isSome()&&end.isSome()}).getOr(!1)},moveEndPoint$1=function(dom,rng,node,start){var root=node,walker=new TreeWalker(node,root),nonEmptyElementsMap=dom.schema.getNonEmptyElements();do{if(3===node.nodeType&&0!==Tools.trim(node.nodeValue).length)return void(start?rng.setStart(node,0):rng.setEnd(node,node.nodeValue.length));if(nonEmptyElementsMap[node.nodeName]&&!/^(TD|TH)$/.test(node.nodeName))return void(start?rng.setStartBefore(node):"BR"===node.nodeName?rng.setEndBefore(node):rng.setEndAfter(node))}while(node=start?walker.next():walker.prev());"BODY"===root.nodeName&&(start?rng.setStart(root,0):rng.setEnd(root,root.childNodes.length))},hasAnyRanges=function(editor){var sel=editor.selection.getSel();return sel&&sel.rangeCount>0},tableModel=Immutable("element","width","rows"),tableRow=Immutable("element","cells"),cellPosition=Immutable("x","y"),getSpan=function(td,key){var value=parseInt(get$3(td,key),10);return isNaN(value)?1:value},fillout=function(table,x,y,tr,td){for(var rowspan=getSpan(td,"rowspan"),colspan=getSpan(td,"colspan"),rows=table.rows(),y2=y;y2<y+rowspan;y2++){rows[y2]||(rows[y2]=tableRow(deep(tr),[]));for(var x2=x;x2<x+colspan;x2++){rows[y2].cells()[x2]=y2===y&&x2===x?td:shallow(td)}}},cellExists=function(table,x,y){var rows=table.rows();return!!(rows[y]?rows[y].cells():[])[x]},skipCellsX=function(table,x,y){for(;cellExists(table,x,y);)x++;return x},getWidth=function(rows){return foldl(rows,function(acc,row){return row.cells().length>acc?row.cells().length:acc},0)},findElementPos=function(table,element){for(var rows=table.rows(),y=0;y<rows.length;y++)for(var cells=rows[y].cells(),x=0;x<cells.length;x++)if(eq(cells[x],element))return Option.some(cellPosition(x,y));return Option.none()},extractRows=function(table,sx,sy,ex,ey){for(var newRows=[],rows=table.rows(),y=sy;y<=ey;y++){var cells=rows[y].cells(),slice=sx<ex?cells.slice(sx,ex+1):cells.slice(ex,sx+1);newRows.push(tableRow(rows[y].element(),slice))}return newRows},subTable=function(table,startPos,endPos){var sx=startPos.x(),sy=startPos.y(),ex=endPos.x(),ey=endPos.y(),newRows=sy<ey?extractRows(table,sx,sy,ex,ey):extractRows(table,sx,ey,ex,sy);return tableModel(table.element(),getWidth(newRows),newRows)},createDomTable=function(table,rows){var tableElement=shallow(table.element()),tableBody=Element.fromTag("tbody");return append$1(tableBody,rows),append(tableElement,tableBody),tableElement},modelRowsToDomRows=function(table){return map(table.rows(),function(row){var cells=map(row.cells(),function(cell){var td=deep(cell);return remove$1(td,"colspan"),remove$1(td,"rowspan"),td}),tr=shallow(row.element());return append$1(tr,cells),tr})},fromDom$1=function(tableElm){var table=tableModel(shallow(tableElm),0,[]);return each(descendants$1(tableElm,"tr"),function(tr,y){each(descendants$1(tr,"td,th"),function(td,x){fillout(table,skipCellsX(table,x,y),y,tr,td)})}),tableModel(table.element(),getWidth(table.rows()),table.rows())},toDom=function(table){return createDomTable(table,modelRowsToDomRows(table))},subsection=function(table,startElement,endElement){return findElementPos(table,startElement).bind(function(startPos){return findElementPos(table,endElement).map(function(endPos){return subTable(table,startPos,endPos)})})},SimpleTableModel={fromDom:fromDom$1,toDom:toDom,subsection:subsection},getRanges=function(selection){var ranges=[];if(selection)for(var i=0;i<selection.rangeCount;i++)ranges.push(selection.getRangeAt(i));return ranges},getSelectedNodes=function(ranges){return bind(ranges,function(range){var node=getSelectedNode(range);return node?[Element.fromDom(node)]:[]})},hasMultipleRanges=function(selection){return getRanges(selection).length>1},MultiRange={getRanges:getRanges,getSelectedNodes:getSelectedNodes,hasMultipleRanges:hasMultipleRanges},getCellsFromRanges=function(ranges){return filter(MultiRange.getSelectedNodes(ranges),isTableCell)},getCellsFromElement=function(elm){return descendants$1(elm,"td[data-mce-selected],th[data-mce-selected]")},getCellsFromElementOrRanges=function(ranges,element){var selectedCells=getCellsFromElement(element),rangeCells=getCellsFromRanges(ranges);return selectedCells.length>0?selectedCells:rangeCells},getCellsFromEditor=function(editor){return getCellsFromElementOrRanges(MultiRange.getRanges(editor.selection.getSel()),Element.fromDom(editor.getBody()))},TableCellSelection={getCellsFromRanges:getCellsFromRanges,getCellsFromElement:getCellsFromElement,getCellsFromElementOrRanges:getCellsFromElementOrRanges,getCellsFromEditor:getCellsFromEditor},findParentListContainer=function(parents){return find(parents,function(elm){return"ul"===name(elm)||"ol"===name(elm)})},getFullySelectedListWrappers=function(parents,rng){return find(parents,function(elm){return"li"===name(elm)&&hasAllContentsSelected(elm,rng)}).fold(constant([]),function(li){return findParentListContainer(parents).map(function(listCont){return[Element.fromTag("li"),Element.fromTag(name(listCont))]}).getOr([])})},wrap$2=function(innerElm,elms){var wrapped=foldl(elms,function(acc,elm){return append(elm,acc),elm},innerElm);return elms.length>0?fromElements([wrapped]):wrapped},directListWrappers=function(commonAnchorContainer){return isListItem(commonAnchorContainer)?parent(commonAnchorContainer).filter(isList).fold(constant([]),function(listElm){return[commonAnchorContainer,listElm]}):isList(commonAnchorContainer)?[commonAnchorContainer]:[]},getWrapElements=function(rootNode,rng){var commonAnchorContainer=Element.fromDom(rng.commonAncestorContainer),parents=Parents.parentsAndSelf(commonAnchorContainer,rootNode),wrapElements=filter(parents,function(elm){return isInline(elm)||isHeading(elm)}),listWrappers=getFullySelectedListWrappers(parents,rng),allWrappers=wrapElements.concat(listWrappers.length?listWrappers:directListWrappers(commonAnchorContainer));return map(allWrappers,shallow)},emptyFragment=function(){return fromElements([])},getFragmentFromRange=function(rootNode,rng){return wrap$2(Element.fromDom(rng.cloneContents()),getWrapElements(rootNode,rng))},getParentTable=function(rootElm,cell){return ancestor$1(cell,"table",curry(eq,rootElm))},getTableFragment=function(rootNode,selectedTableCells){return getParentTable(rootNode,selectedTableCells[0]).bind(function(tableElm){var firstCell=selectedTableCells[0],lastCell=selectedTableCells[selectedTableCells.length-1],fullTableModel=SimpleTableModel.fromDom(tableElm);return SimpleTableModel.subsection(fullTableModel,firstCell,lastCell).map(function(sectionedTableModel){return fromElements([SimpleTableModel.toDom(sectionedTableModel)])})}).getOrThunk(emptyFragment)},getSelectionFragment=function(rootNode,ranges){return ranges.length>0&&ranges[0].collapsed?emptyFragment():getFragmentFromRange(rootNode,ranges[0])},read$1=function(rootNode,ranges){var selectedCells=TableCellSelection.getCellsFromElementOrRanges(ranges,rootNode);return selectedCells.length>0?getTableFragment(rootNode,selectedCells):getSelectionFragment(rootNode,ranges)},FragmentReader={read:read$1},getTextContent=function(editor){return Option.from(editor.selection.getRng()).map(function(rng){var bin=editor.dom.add(editor.getBody(),"div",{"data-mce-bogus":"all",style:"overflow: hidden; opacity: 0;"},rng.cloneContents()),text=Zwsp.trim(bin.innerText);return editor.dom.remove(bin),text}).getOr("")},getHtmlContent=function(editor,args){var fragment,rng=editor.selection.getRng(),tmpElm=editor.dom.create("body"),sel=editor.selection.getSel(),ranges=EventProcessRanges.processRanges(editor,MultiRange.getRanges(sel));return fragment=args.contextual?FragmentReader.read(Element.fromDom(editor.getBody()),ranges).dom():rng.cloneContents(),fragment&&tmpElm.appendChild(fragment),editor.selection.serializer.serialize(tmpElm,args)},getContent$1=function(editor,args){if(void 0===args&&(args={}),args.get=!0,args.format=args.format||"html",args.selection=!0,args=editor.fire("BeforeGetContent",args),args.isDefaultPrevented())return editor.fire("GetContent",args),args.content;if("text"===args.format)return getTextContent(editor);args.getInner=!0;var content=getHtmlContent(editor,args);return"tree"===args.format?content:(args.content=editor.selection.isCollapsed()?"":content,editor.fire("GetContent",args),args.content)},GetSelectionContent={getContent:getContent$1},isEq$1=function(rng1,rng2){return rng1&&rng2&&rng1.startContainer===rng2.startContainer&&rng1.startOffset===rng2.startOffset&&rng1.endContainer===rng2.endContainer&&rng1.endOffset===rng2.endOffset},RangeCompare={isEq:isEq$1},findParent$1=function(node,rootNode,predicate){for(;node&&node!==rootNode;){if(predicate(node))return node;node=node.parentNode}return null},hasParent=function(node,rootNode,predicate){return null!==findParent$1(node,rootNode,predicate)},hasParentWithName=function(node,rootNode,name){return hasParent(node,rootNode,function(node){return node.nodeName===name})},isTable$3=function(node){return node&&"TABLE"===node.nodeName},isTableCell$2=function(node){return node&&/^(TD|TH|CAPTION)$/.test(node.nodeName)},isCeFalseCaretContainer=function(node,rootNode){return isCaretContainer(node)&&!1===hasParent(node,rootNode,isCaretNode)},hasBrBeforeAfter=function(dom,node,left){for(var walker=new TreeWalker(node,dom.getParent(node.parentNode,dom.isBlock)||dom.getRoot());node=walker[left?"prev":"next"]();)if(NodeType.isBr(node))return!0},isPrevNode=function(node,name){return node.previousSibling&&node.previousSibling.nodeName===name},hasContentEditableFalseParent=function(body,node){for(;node&&node!==body;){if(NodeType.isContentEditableFalse(node))return!0;node=node.parentNode}return!1},findTextNodeRelative=function(dom,isAfterNode,collapsed,left,startNode){var lastInlineElement,node,body=dom.getRoot(),nonEmptyElementsMap=dom.schema.getNonEmptyElements(),parentBlockContainer=dom.getParent(startNode.parentNode,dom.isBlock)||body;if(left&&NodeType.isBr(startNode)&&isAfterNode&&dom.isEmpty(parentBlockContainer))return Option.some(CaretPosition(startNode.parentNode,dom.nodeIndex(startNode)));for(var walker=new TreeWalker(startNode,parentBlockContainer);node=walker[left?"prev":"next"]();){if("false"===dom.getContentEditableParent(node)||isCeFalseCaretContainer(node,body))return Option.none();if(NodeType.isText(node)&&node.nodeValue.length>0)return!1===hasParentWithName(node,body,"A")?Option.some(CaretPosition(node,left?node.nodeValue.length:0)):Option.none();if(dom.isBlock(node)||nonEmptyElementsMap[node.nodeName.toLowerCase()])return Option.none();lastInlineElement=node}return collapsed&&lastInlineElement?Option.some(CaretPosition(lastInlineElement,0)):Option.none()},normalizeEndPoint=function(dom,collapsed,start,rng){var container,offset,node,nonEmptyElementsMap,directionLeft,isAfterNode,body=dom.getRoot(),normalized=!1;if(container=rng[(start?"start":"end")+"Container"],offset=rng[(start?"start":"end")+"Offset"],isAfterNode=NodeType.isElement(container)&&offset===container.childNodes.length,nonEmptyElementsMap=dom.schema.getNonEmptyElements(),directionLeft=start,isCaretContainer(container))return Option.none();if(NodeType.isElement(container)&&offset>container.childNodes.length-1&&(directionLeft=!1),NodeType.isDocument(container)&&(container=body,offset=0),container===body){if(directionLeft&&(node=container.childNodes[offset>0?offset-1:0])){if(isCaretContainer(node))return Option.none();if(nonEmptyElementsMap[node.nodeName]||isTable$3(node))return Option.none()}if(container.hasChildNodes()){if(offset=Math.min(!directionLeft&&offset>0?offset-1:offset,container.childNodes.length-1),container=container.childNodes[offset],offset=NodeType.isText(container)&&isAfterNode?container.data.length:0,!collapsed&&container===body.lastChild&&isTable$3(container))return Option.none();if(hasContentEditableFalseParent(body,container)||isCaretContainer(container))return Option.none();if(container.hasChildNodes()&&!1===isTable$3(container)){node=container;var walker=new TreeWalker(container,body);do{if(NodeType.isContentEditableFalse(node)||isCaretContainer(node)){normalized=!1;break}if(NodeType.isText(node)&&node.nodeValue.length>0){offset=directionLeft?0:node.nodeValue.length,container=node,normalized=!0;break}if(nonEmptyElementsMap[node.nodeName.toLowerCase()]&&!isTableCell$2(node)){offset=dom.nodeIndex(node),container=node.parentNode,directionLeft||offset++,normalized=!0;break}}while(node=directionLeft?walker.next():walker.prev())}}}return collapsed&&(NodeType.isText(container)&&0===offset&&findTextNodeRelative(dom,isAfterNode,collapsed,!0,container).each(function(pos){container=pos.container(),offset=pos.offset(),normalized=!0}),NodeType.isElement(container)&&(node=container.childNodes[offset],node||(node=container.childNodes[offset-1]),!node||!NodeType.isBr(node)||isPrevNode(node,"A")||hasBrBeforeAfter(dom,node,!1)||hasBrBeforeAfter(dom,node,!0)||findTextNodeRelative(dom,isAfterNode,collapsed,!0,node).each(function(pos){container=pos.container(),offset=pos.offset(),normalized=!0}))),directionLeft&&!collapsed&&NodeType.isText(container)&&offset===container.nodeValue.length&&findTextNodeRelative(dom,isAfterNode,collapsed,!1,container).each(function(pos){container=pos.container(),offset=pos.offset(),normalized=!0}),normalized?Option.some(CaretPosition(container,offset)):Option.none()},normalize=function(dom,rng){var collapsed=rng.collapsed,normRng=rng.cloneRange(),startPos=CaretPosition.fromRangeStart(rng);return normalizeEndPoint(dom,collapsed,!0,normRng).each(function(pos){collapsed&&CaretPosition.isAbove(startPos,pos)||normRng.setStart(pos.container(),pos.offset())}),collapsed||normalizeEndPoint(dom,collapsed,!1,normRng).each(function(pos){normRng.setEnd(pos.container(),pos.offset())}),collapsed&&normRng.collapse(!0),RangeCompare.isEq(rng,normRng)?Option.none():Option.some(normRng)},NormalizeRange={normalize:normalize},prependData=function(target,data){target.insertData(0,data)},removeEmpty=function(text){return 0===text.dom().length?(remove(text),Option.none()):Option.some(text)},rngSetContent=function(rng,fragment){var firstChild=Option.from(fragment.firstChild).map(Element.fromDom),lastChild=Option.from(fragment.lastChild).map(Element.fromDom);rng.deleteContents(),rng.insertNode(fragment);var prevText=firstChild.bind(prevSibling).filter(isText).bind(removeEmpty),nextText=lastChild.bind(nextSibling).filter(isText).bind(removeEmpty);lift2(prevText,firstChild.filter(isText),function(prev,start){prependData(start.dom(),prev.dom().data),remove(prev)}),lift2(nextText,lastChild.filter(isText),function(next,end){var oldLength=end.dom().length;end.dom().appendData(next.dom().data),rng.setEnd(end.dom(),oldLength),remove(next)}),rng.collapse(!1)},setupArgs=function(args,content){return args=args||{format:"html"},args.set=!0,args.selection=!0,args.content=content,args},setContent$1=function(editor,content,args){if(args=setupArgs(args,content),!args.no_events&&(args=editor.fire("BeforeSetContent",args),args.isDefaultPrevented()))return void editor.fire("SetContent",args);var rng=editor.selection.getRng();rngSetContent(rng,rng.createContextualFragment(args.content)),editor.selection.setRng(rng),ScrollIntoView.scrollRangeIntoView(editor,rng),args.no_events||editor.fire("SetContent",args)},SetSelectionContent={setContent:setContent$1},getEndpointElement=function(root,rng,start,real,resolve){var container=start?rng.startContainer:rng.endContainer,offset=start?rng.startOffset:rng.endOffset;return Option.from(container).map(Element.fromDom).map(function(elm){return real&&rng.collapsed?elm:child(elm,resolve(elm,offset)).getOr(elm)}).bind(function(elm){return isElement(elm)?Option.some(elm):parent(elm)}).map(function(elm){return elm.dom()}).getOr(root)},getStart$2=function(root,rng,real){return getEndpointElement(root,rng,!0,real,function(elm,offset){return Math.min(childNodesCount(elm),offset)})},getEnd=function(root,rng,real){return getEndpointElement(root,rng,!1,real,function(elm,offset){return offset>0?offset-1:offset})},skipEmptyTextNodes=function(node,forwards){for(var orig=node;node&&NodeType.isText(node)&&0===node.length;)node=forwards?node.nextSibling:node.previousSibling;return node||orig},getNode$1=function(root,rng){var elm,startContainer,endContainer,startOffset,endOffset;return rng?(startContainer=rng.startContainer,endContainer=rng.endContainer,startOffset=rng.startOffset,endOffset=rng.endOffset,elm=rng.commonAncestorContainer,!rng.collapsed&&(startContainer===endContainer&&endOffset-startOffset<2&&startContainer.hasChildNodes()&&(elm=startContainer.childNodes[startOffset]),3===startContainer.nodeType&&3===endContainer.nodeType&&(startContainer=startContainer.length===startOffset?skipEmptyTextNodes(startContainer.nextSibling,!0):startContainer.parentNode,endContainer=0===endOffset?skipEmptyTextNodes(endContainer.previousSibling,!1):endContainer.parentNode,startContainer&&startContainer===endContainer))?startContainer:elm&&3===elm.nodeType?elm.parentNode:elm):root},getSelectedBlocks=function(dom,rng,startElm,endElm){var node,root,selectedBlocks=[];if(root=dom.getRoot(),startElm=dom.getParent(startElm||getStart$2(root,rng,rng.collapsed),dom.isBlock),endElm=dom.getParent(endElm||getEnd(root,rng,rng.collapsed),dom.isBlock),startElm&&startElm!==root&&selectedBlocks.push(startElm),startElm&&endElm&&startElm!==endElm){node=startElm;for(var walker=new TreeWalker(startElm,root);(node=walker.next())&&node!==endElm;)dom.isBlock(node)&&selectedBlocks.push(node)}return endElm&&startElm!==endElm&&endElm!==root&&selectedBlocks.push(endElm),selectedBlocks},select$1=function(dom,node,content){return Option.from(node).map(function(node){var idx=dom.nodeIndex(node),rng=dom.createRng();return rng.setStart(node.parentNode,idx),rng.setEnd(node.parentNode,idx+1),content&&(moveEndPoint$1(dom,rng,node,!0),moveEndPoint$1(dom,rng,node,!1)),rng})},deleteFromCallbackMap=function(callbackMap,selector,callback){if(callbackMap&&callbackMap.hasOwnProperty(selector)){var newCallbacks=filter(callbackMap[selector],function(cb){return cb!==callback});0===newCallbacks.length?delete callbackMap[selector]:callbackMap[selector]=newCallbacks}},isNativeIeSelection=function(rng){return!!rng.select},isAttachedToDom=function(node){return!(!node||!node.ownerDocument)&&contains$2(Element.fromDom(node.ownerDocument),Element.fromDom(node))},isValidRange=function(rng){return!!rng&&(!!isNativeIeSelection(rng)||isAttachedToDom(rng.startContainer)&&isAttachedToDom(rng.endContainer))},Selection$1=function(dom,win,serializer,editor){var bookmarkManager,controlSelection,selectedRange,explicitRange,selectorChangedWithUnbind=SelectorChanged(dom,editor).selectorChangedWithUnbind,setCursorLocation=function(node,offset){var rng=dom.createRng();node?(rng.setStart(node,offset),rng.setEnd(node,offset),setRng(rng),collapse(!1)):(moveEndPoint$1(dom,rng,editor.getBody(),!0),setRng(rng))},getContent=function(args){return GetSelectionContent.getContent(editor,args)},setContent=function(content,args){return SetSelectionContent.setContent(editor,content,args)},getStart=function(real){return getStart$2(editor.getBody(),getRng(),real)},getEnd$1=function(real){return getEnd(editor.getBody(),getRng(),real)},getBookmark=function(type,normalized){return bookmarkManager.getBookmark(type,normalized)},moveToBookmark=function(bookmark){return bookmarkManager.moveToBookmark(bookmark)},select=function(node,content){return select$1(dom,node,content).each(setRng),node},isCollapsed=function(){var rng=getRng(),sel=getSel();return!(!rng||rng.item)&&(rng.compareEndPoints?0===rng.compareEndPoints("StartToEnd",rng):!sel||rng.collapsed)},collapse=function(toStart){var rng=getRng();rng.collapse(!!toStart),setRng(rng)},getSel=function(){return win.getSelection?win.getSelection():win.document.selection},getRng=function(){var selection,rng,elm,doc,tryCompareBoundaryPoints=function(how,sourceRange,destinationRange){try{return sourceRange.compareBoundaryPoints(how,destinationRange)}catch(ex){return-1}};if(!win)return null;if(void 0===(doc=win.document)||null===doc)return null;if(void 0!==editor.bookmark&&!1===EditorFocus.hasFocus(editor)){var bookmark=SelectionBookmark.getRng(editor);if(bookmark.isSome())return bookmark.map(function(r){return EventProcessRanges.processRanges(editor,[r])[0]}).getOr(doc.createRange())}try{(selection=getSel())&&!NodeType.isRestrictedNode(selection.anchorNode)&&(rng=selection.rangeCount>0?selection.getRangeAt(0):selection.createRange?selection.createRange():doc.createRange())}catch(ex){}return rng=EventProcessRanges.processRanges(editor,[rng])[0],rng||(rng=doc.createRange?doc.createRange():doc.body.createTextRange()),rng.setStart&&9===rng.startContainer.nodeType&&rng.collapsed&&(elm=dom.getRoot(),rng.setStart(elm,0),rng.setEnd(elm,0)),selectedRange&&explicitRange&&(0===tryCompareBoundaryPoints(rng.START_TO_START,rng,selectedRange)&&0===tryCompareBoundaryPoints(rng.END_TO_END,rng,selectedRange)?rng=explicitRange:(selectedRange=null,explicitRange=null)),rng},setRng=function(rng,forward){var sel,node,evt;if(isValidRange(rng)){var ieRange=isNativeIeSelection(rng)?rng:null;if(ieRange){explicitRange=null;try{ieRange.select()}catch(ex){}}else{if(sel=getSel(),evt=editor.fire("SetSelectionRange",{range:rng,forward:forward}),rng=evt.range,sel){explicitRange=rng;try{sel.removeAllRanges(),sel.addRange(rng)}catch(ex){}!1===forward&&sel.extend&&(sel.collapse(rng.endContainer,rng.endOffset),sel.extend(rng.startContainer,rng.startOffset)),selectedRange=sel.rangeCount>0?sel.getRangeAt(0):null}rng.collapsed||rng.startContainer!==rng.endContainer||!sel.setBaseAndExtent||Env.ie||rng.endOffset-rng.startOffset<2&&rng.startContainer.hasChildNodes()&&(node=rng.startContainer.childNodes[rng.startOffset])&&"IMG"===node.tagName&&(sel.setBaseAndExtent(rng.startContainer,rng.startOffset,rng.endContainer,rng.endOffset),sel.anchorNode===rng.startContainer&&sel.focusNode===rng.endContainer||sel.setBaseAndExtent(node,0,node,1)),editor.fire("AfterSetSelectionRange",{range:rng,forward:forward})}}},setNode=function(elm){return setContent(dom.getOuterHTML(elm)),elm},getNode=function(){return getNode$1(editor.getBody(),getRng())},getSelectedBlocks$1=function(startElm,endElm){return getSelectedBlocks(dom,getRng(),startElm,endElm)},isForward=function(){var anchorRange,focusRange,sel=getSel();return!(sel&&sel.anchorNode&&sel.focusNode)||(anchorRange=dom.createRng(),anchorRange.setStart(sel.anchorNode,sel.anchorOffset),anchorRange.collapse(!0),focusRange=dom.createRng(),focusRange.setStart(sel.focusNode,sel.focusOffset),focusRange.collapse(!0),anchorRange.compareBoundaryPoints(anchorRange.START_TO_START,focusRange)<=0)},normalize=function(){var rng=getRng(),sel=getSel();if(!MultiRange.hasMultipleRanges(sel)&&hasAnyRanges(editor)){var normRng=NormalizeRange.normalize(dom,rng);return normRng.each(function(normRng){setRng(normRng,isForward())}),normRng.getOr(rng)}return rng},selectorChanged=function(selector,callback){return selectorChangedWithUnbind(selector,callback),exports},getScrollContainer=function(){for(var scrollContainer,node=dom.getRoot();node&&"BODY"!==node.nodeName;){if(node.scrollHeight>node.clientHeight){scrollContainer=node;break}node=node.parentNode}return scrollContainer},scrollIntoView=function(elm,alignToTop){return ScrollIntoView.scrollElementIntoView(editor,elm,alignToTop)},placeCaretAt=function(clientX,clientY){return setRng(CaretRangeFromPoint.fromPoint(clientX,clientY,editor.getDoc()))},getBoundingClientRect=function(){var rng=getRng();return rng.collapsed?CaretPosition$1.fromRangeStart(rng).getClientRects()[0]:rng.getBoundingClientRect()},destroy=function(){win=selectedRange=explicitRange=null,controlSelection.destroy()},exports={bookmarkManager:null,controlSelection:null,dom:dom,win:win,serializer:serializer,editor:editor,collapse:collapse,setCursorLocation:setCursorLocation,getContent:getContent,setContent:setContent,getBookmark:getBookmark,moveToBookmark:moveToBookmark,select:select,isCollapsed:isCollapsed,isForward:isForward,setNode:setNode,getNode:getNode,getSel:getSel,setRng:setRng,getRng:getRng,getStart:getStart,getEnd:getEnd$1,getSelectedBlocks:getSelectedBlocks$1,normalize:normalize,selectorChanged:selectorChanged,selectorChangedWithUnbind:selectorChangedWithUnbind,getScrollContainer:getScrollContainer,scrollIntoView:scrollIntoView,placeCaretAt:placeCaretAt,getBoundingClientRect:getBoundingClientRect,destroy:destroy};return bookmarkManager=BookmarkManager$1(exports),controlSelection=ControlSelection(exports,editor),exports.bookmarkManager=bookmarkManager,exports.controlSelection=controlSelection,exports},removeAttrs=function(node,names){each(names,function(name){node.attr(name,null)})},addFontToSpansFilter=function(domParser,styles,fontSizes){domParser.addNodeFilter("font",function(nodes){each(nodes,function(node){var props=styles.parse(node.attr("style")),color=node.attr("color"),face=node.attr("face"),size=node.attr("size");color&&(props.color=color),face&&(props["font-family"]=face),size&&(props["font-size"]=fontSizes[parseInt(node.attr("size"),10)-1]),node.name="span",node.attr("style",styles.serialize(props)),removeAttrs(node,["color","face","size"])})})},addStrikeToSpanFilter=function(domParser,styles){domParser.addNodeFilter("strike",function(nodes){each(nodes,function(node){var props=styles.parse(node.attr("style"));props["text-decoration"]="line-through",node.name="span",node.attr("style",styles.serialize(props))})})},addFilters=function(domParser,settings){var styles=Styles();settings.convert_fonts_to_spans&&addFontToSpansFilter(domParser,styles,Tools.explode(settings.font_size_legacy_values)),addStrikeToSpanFilter(domParser,styles)},register$1=function(domParser,settings){settings.inline_styles&&addFilters(domParser,settings)},LegacyFilter={register:register$1},paddEmptyNode=function(settings,args,blockElements,node){(settings.padd_empty_with_br||args.insert)&&blockElements[node.name]?node.empty().append(new Node$1("br",1)).shortEnded=!0:node.empty().append(new Node$1("#text",3)).value=" "},isPaddedWithNbsp=function(node){return hasOnlyChild(node,"#text")&&" "===node.firstChild.value},hasOnlyChild=function(node,name){return node&&node.firstChild&&node.firstChild===node.lastChild&&node.firstChild.name===name},isPadded=function(schema,node){var rule=schema.getElementRule(node.name);return rule&&rule.paddEmpty},isEmpty$1=function(schema,nonEmptyElements,whitespaceElements,node){return node.isEmpty(nonEmptyElements,whitespaceElements,function(node){return isPadded(schema,node)})},isLineBreakNode=function(node,blockElements){return node&&(blockElements[node.name]||"br"===node.name)},register$2=function(parser,settings){var schema=parser.schema;settings.remove_trailing_brs&&parser.addNodeFilter("br",function(nodes,_,args){var i,node,parent,lastParent,prev,prevName,elementRule,textNode,l=nodes.length,blockElements=Tools.extend({},schema.getBlockElements()),nonEmptyElements=schema.getNonEmptyElements(),whiteSpaceElements=schema.getNonEmptyElements();for(blockElements.body=1,i=0;i<l;i++)if(node=nodes[i],parent=node.parent,blockElements[node.parent.name]&&node===parent.lastChild){for(prev=node.prev;prev;){if("span"!==(prevName=prev.name)||"bookmark"!==prev.attr("data-mce-type")){if("br"!==prevName)break;if("br"===prevName){node=null;break}}prev=prev.prev}node&&(node.remove(),isEmpty$1(schema,nonEmptyElements,whiteSpaceElements,parent)&&(elementRule=schema.getElementRule(parent.name))&&(elementRule.removeEmpty?parent.remove():elementRule.paddEmpty&&paddEmptyNode(settings,args,blockElements,parent)))}else{for(lastParent=node;parent&&parent.firstChild===lastParent&&parent.lastChild===lastParent&&(lastParent=parent,!blockElements[parent.name]);)parent=parent.parent;lastParent===parent&&!0!==settings.padd_empty_with_br&&(textNode=new Node$1("#text",3),textNode.value=" ",node.replace(textNode))}}),parser.addAttributeFilter("href",function(nodes){var node,i=nodes.length,appendRel=function(rel){return rel.split(" ").filter(function(p){return p.length>0}).concat(["noopener"]).sort().join(" ")};if(!settings.allow_unsafe_link_target)for(;i--;)node=nodes[i],"a"===node.name&&"_blank"===node.attr("target")&&node.attr("rel",function(rel){var newRel=rel?Tools.trim(rel):"";return/\b(noopener)\b/g.test(newRel)?newRel:appendRel(newRel)}(node.attr("rel")))}),settings.allow_html_in_named_anchor||parser.addAttributeFilter("id,name",function(nodes){for(var sibling,prevSibling,parent,node,i=nodes.length;i--;)if(node=nodes[i],"a"===node.name&&node.firstChild&&!node.attr("href")){parent=node.parent,sibling=node.lastChild;do{prevSibling=sibling.prev,parent.insert(sibling,node),sibling=prevSibling}while(sibling)}}),settings.fix_list_elements&&parser.addNodeFilter("ul,ol",function(nodes){for(var node,parentNode,i=nodes.length;i--;)if(node=nodes[i],parentNode=node.parent,"ul"===parentNode.name||"ol"===parentNode.name)if(node.prev&&"li"===node.prev.name)node.prev.append(node);else{var li=new Node$1("li",1);li.attr("style","list-style-type: none"),node.wrap(li)}}),settings.validate&&schema.getValidClasses()&&parser.addAttributeFilter("class",function(nodes){for(var node,classList,ci,className,classValue,validClassesMap,valid,i=nodes.length,validClasses=schema.getValidClasses();i--;){for(node=nodes[i],classList=node.attr("class").split(" "),classValue="",ci=0;ci<classList.length;ci++)className=classList[ci],valid=!1,validClassesMap=validClasses["*"],validClassesMap&&validClassesMap[className]&&(valid=!0),validClassesMap=validClasses[node.name],!valid&&validClassesMap&&validClassesMap[className]&&(valid=!0),valid&&(classValue&&(classValue+=" "),classValue+=className);classValue.length||(classValue=null),node.attr("class",classValue)}})},makeMap$4=Tools.makeMap,each$8=Tools.each,explode$2=Tools.explode,extend$2=Tools.extend,DomParser=function(settings,schema){void 0===schema&&(schema=Schema());var nodeFilters={},attributeFilters=[],matchedNodes={},matchedAttributes={};settings=settings||{},settings.validate=!("validate"in settings)||settings.validate,settings.root_name=settings.root_name||"body";var fixInvalidChildren=function(nodes){var ni,node,parent,parents,newParent,currentNode,tempNode,childNode,i,nonEmptyElements,whitespaceElements,nonSplitableElements,textBlockElements,specialElements,sibling,nextNode;for(nonSplitableElements=makeMap$4("tr,td,th,tbody,thead,tfoot,table"),nonEmptyElements=schema.getNonEmptyElements(),whitespaceElements=schema.getWhiteSpaceElements(),textBlockElements=schema.getTextBlockElements(),specialElements=schema.getSpecialElements(),ni=0;ni<nodes.length;ni++)if(node=nodes[ni],node.parent&&!node.fixed)if(textBlockElements[node.name]&&"li"===node.parent.name){for(sibling=node.next;sibling&&textBlockElements[sibling.name];)sibling.name="li",sibling.fixed=!0,node.parent.insert(sibling,node.parent),sibling=sibling.next;node.unwrap(node)}else{for(parents=[node],parent=node.parent;parent&&!schema.isValidChild(parent.name,node.name)&&!nonSplitableElements[parent.name];parent=parent.parent)parents.push(parent);if(parent&&parents.length>1){for(parents.reverse(),newParent=currentNode=filterNode(parents[0].clone()),i=0;i<parents.length-1;i++){for(schema.isValidChild(currentNode.name,parents[i].name)?(tempNode=filterNode(parents[i].clone()),currentNode.append(tempNode)):tempNode=currentNode,childNode=parents[i].firstChild;childNode&&childNode!==parents[i+1];)nextNode=childNode.next,tempNode.append(childNode),childNode=nextNode;currentNode=tempNode}isEmpty$1(schema,nonEmptyElements,whitespaceElements,newParent)?parent.insert(node,parents[0],!0):(parent.insert(newParent,parents[0],!0),parent.insert(node,newParent)),parent=parents[0],(isEmpty$1(schema,nonEmptyElements,whitespaceElements,parent)||hasOnlyChild(parent,"br"))&&parent.empty().remove()}else if(node.parent){if("li"===node.name){if((sibling=node.prev)&&("ul"===sibling.name||"ul"===sibling.name)){sibling.append(node);continue}if((sibling=node.next)&&("ul"===sibling.name||"ul"===sibling.name)){sibling.insert(node,sibling.firstChild,!0);continue}node.wrap(filterNode(new Node$1("ul",1)));continue}schema.isValidChild(node.parent.name,"div")&&schema.isValidChild("div",node.name)?node.wrap(filterNode(new Node$1("div",1))):specialElements[node.name]?node.empty().remove():node.unwrap()}}},filterNode=function(node){var i,name,list;name=node.name,name in nodeFilters&&(list=matchedNodes[name],list?list.push(node):matchedNodes[name]=[node]),i=attributeFilters.length;for(;i--;)(name=attributeFilters[i].name)in node.attributes.map&&(list=matchedAttributes[name],list?list.push(node):matchedAttributes[name]=[node]);return node},addNodeFilter=function(name,callback){each$8(explode$2(name),function(name){var list=nodeFilters[name];list||(nodeFilters[name]=list=[]),list.push(callback)})},getNodeFilters=function(){var out=[];for(var name_1 in nodeFilters)nodeFilters.hasOwnProperty(name_1)&&out.push({name:name_1,callbacks:nodeFilters[name_1]});return out},addAttributeFilter=function(name,callback){each$8(explode$2(name),function(name){var i;for(i=0;i<attributeFilters.length;i++)if(attributeFilters[i].name===name)return void attributeFilters[i].callbacks.push(callback);attributeFilters.push({name:name,callbacks:[callback]})})},getAttributeFilters=function(){return[].concat(attributeFilters)},parse=function(html,args){var parser,nodes,i,l,fi,fl,list,name,blockElements,isInWhiteSpacePreservedElement,node,invalidChildren=[];args=args||{},matchedNodes={},matchedAttributes={},blockElements=extend$2(makeMap$4("script,style,head,html,body,title,meta,param"),schema.getBlockElements());var nonEmptyElements=schema.getNonEmptyElements(),children=schema.children,validate=settings.validate,forcedRootBlockName="forced_root_block"in args?args.forced_root_block:settings.forced_root_block,rootBlockName=function(name){return!1===name?"":!0===name?"p":name}(forcedRootBlockName),whiteSpaceElements=schema.getWhiteSpaceElements(),startWhiteSpaceRegExp=/^[ \t\r\n]+/,endWhiteSpaceRegExp=/[ \t\r\n]+$/,allWhiteSpaceRegExp=/[ \t\r\n]+/g,isAllWhiteSpaceRegExp=/^[ \t\r\n]+$/;isInWhiteSpacePreservedElement=whiteSpaceElements.hasOwnProperty(args.context)||whiteSpaceElements.hasOwnProperty(settings.root_name);var createNode=function(name,type){var list,node=new Node$1(name,type);return name in nodeFilters&&(list=matchedNodes[name],list?list.push(node):matchedNodes[name]=[node]),node},removeWhitespaceBefore=function(node){var textNode,textNodeNext,textVal,sibling,blockElements=schema.getBlockElements();for(textNode=node.prev;textNode&&3===textNode.type;){if(textVal=textNode.value.replace(endWhiteSpaceRegExp,""),textVal.length>0)return void(textNode.value=textVal);if(textNodeNext=textNode.next){if(3===textNodeNext.type&&textNodeNext.value.length){textNode=textNode.prev;continue}if(!blockElements[textNodeNext.name]&&"script"!==textNodeNext.name&&"style"!==textNodeNext.name){textNode=textNode.prev;continue}}sibling=textNode.prev,textNode.remove(),textNode=sibling}};parser=SaxParser$1({validate:validate,allow_script_urls:settings.allow_script_urls,allow_conditional_comments:settings.allow_conditional_comments,preserve_cdata:settings.preserve_cdata,self_closing_elements:function(input){var name,output={};for(name in input)"li"!==name&&"p"!==name&&(output[name]=input[name]);return output}(schema.getSelfClosingElements()),cdata:function(text){node.append(createNode("#cdata",4)).value=text},text:function(text,raw){var textNode;isInWhiteSpacePreservedElement||(text=text.replace(allWhiteSpaceRegExp," "),isLineBreakNode(node.lastChild,blockElements)&&(text=text.replace(startWhiteSpaceRegExp,""))),0!==text.length&&(textNode=createNode("#text",3),textNode.raw=!!raw,node.append(textNode).value=text)},comment:function(text){node.append(createNode("#comment",8)).value=text},pi:function(name,text){node.append(createNode(name,7)).value=text,removeWhitespaceBefore(node)},doctype:function(text){var newNode;newNode=node.append(createNode("#doctype",10)),newNode.value=text,removeWhitespaceBefore(node)},start:function(name,attrs,empty){var newNode,attrFiltersLen,elementRule,attrName,parent;if(elementRule=validate?schema.getElementRule(name):{}){for(newNode=createNode(elementRule.outputName||name,1),newNode.attributes=attrs,newNode.shortEnded=empty,node.append(newNode),parent=children[node.name],parent&&children[newNode.name]&&!parent[newNode.name]&&invalidChildren.push(newNode),attrFiltersLen=attributeFilters.length;attrFiltersLen--;)(attrName=attributeFilters[attrFiltersLen].name)in attrs.map&&(list=matchedAttributes[attrName],list?list.push(newNode):matchedAttributes[attrName]=[newNode]);blockElements[name]&&removeWhitespaceBefore(newNode),empty||(node=newNode),!isInWhiteSpacePreservedElement&&whiteSpaceElements[name]&&(isInWhiteSpacePreservedElement=!0)}},end:function(name){var textNode,elementRule,text,sibling,tempNode;if(elementRule=validate?schema.getElementRule(name):{}){if(blockElements[name]&&!isInWhiteSpacePreservedElement){if((textNode=node.firstChild)&&3===textNode.type)if(text=textNode.value.replace(startWhiteSpaceRegExp,""),text.length>0)textNode.value=text,textNode=textNode.next;else for(sibling=textNode.next,textNode.remove(),textNode=sibling;textNode&&3===textNode.type;)text=textNode.value,sibling=textNode.next,(0===text.length||isAllWhiteSpaceRegExp.test(text))&&(textNode.remove(),textNode=sibling),textNode=sibling;if((textNode=node.lastChild)&&3===textNode.type)if(text=textNode.value.replace(endWhiteSpaceRegExp,""),text.length>0)textNode.value=text,textNode=textNode.prev;else for(sibling=textNode.prev,textNode.remove(),textNode=sibling;textNode&&3===textNode.type;)text=textNode.value,sibling=textNode.prev,(0===text.length||isAllWhiteSpaceRegExp.test(text))&&(textNode.remove(),textNode=sibling),textNode=sibling}if(isInWhiteSpacePreservedElement&&whiteSpaceElements[name]&&(isInWhiteSpacePreservedElement=!1),elementRule.removeEmpty&&isEmpty$1(schema,nonEmptyElements,whiteSpaceElements,node)&&!node.attr("name")&&!node.attr("id"))return tempNode=node.parent,blockElements[node.name]?node.empty().remove():node.unwrap(),void(node=tempNode);elementRule.paddEmpty&&(isPaddedWithNbsp(node)||isEmpty$1(schema,nonEmptyElements,whiteSpaceElements,node))&&paddEmptyNode(settings,args,blockElements,node),node=node.parent}}},schema);var rootNode=node=new Node$1(args.context||settings.root_name,11);if(parser.parse(html,args.format),validate&&invalidChildren.length&&(args.context?args.invalid=!0:fixInvalidChildren(invalidChildren)),rootBlockName&&("body"===rootNode.name||args.isRootContent)&&function(){var next,rootBlockNode,node=rootNode.firstChild,trim=function(rootBlockNode){rootBlockNode&&(node=rootBlockNode.firstChild,node&&3===node.type&&(node.value=node.value.replace(startWhiteSpaceRegExp,"")),(node=rootBlockNode.lastChild)&&3===node.type&&(node.value=node.value.replace(endWhiteSpaceRegExp,"")))};if(schema.isValidChild(rootNode.name,rootBlockName.toLowerCase())){for(;node;)next=node.next,3===node.type||1===node.type&&"p"!==node.name&&!blockElements[node.name]&&!node.attr("data-mce-type")?rootBlockNode?rootBlockNode.append(node):(rootBlockNode=createNode(rootBlockName,1),rootBlockNode.attr(settings.forced_root_block_attrs),rootNode.insert(rootBlockNode,node),rootBlockNode.append(node)):(trim(rootBlockNode),rootBlockNode=null),node=next;trim(rootBlockNode)}}(),!args.invalid){for(name in matchedNodes)if(matchedNodes.hasOwnProperty(name)){for(list=nodeFilters[name],nodes=matchedNodes[name],fi=nodes.length;fi--;)nodes[fi].parent||nodes.splice(fi,1);for(i=0,l=list.length;i<l;i++)list[i](nodes,name,args)}for(i=0,l=attributeFilters.length;i<l;i++)if(list=attributeFilters[i],list.name in matchedAttributes){for(nodes=matchedAttributes[list.name],fi=nodes.length;fi--;)nodes[fi].parent||nodes.splice(fi,1);for(fi=0,fl=list.callbacks.length;fi<fl;fi++)list.callbacks[fi](nodes,list.name,args)}}return rootNode},exports={schema:schema,addAttributeFilter:addAttributeFilter,getAttributeFilters:getAttributeFilters,addNodeFilter:addNodeFilter,getNodeFilters:getNodeFilters,filterNode:filterNode,parse:parse};return register$2(exports,settings),LegacyFilter.register(exports,settings),exports},register$3=function(htmlParser,settings,dom){htmlParser.addAttributeFilter("data-mce-tabindex",function(nodes,name){for(var node,i=nodes.length;i--;)node=nodes[i],node.attr("tabindex",node.attr("data-mce-tabindex")),node.attr(name,null)}),htmlParser.addAttributeFilter("src,href,style",function(nodes,name){for(var node,value,i=nodes.length,internalName="data-mce-"+name,urlConverter=settings.url_converter,urlConverterScope=settings.url_converter_scope;i--;)node=nodes[i],value=node.attr(internalName),void 0!==value?(node.attr(name,value.length>0?value:null),node.attr(internalName,null)):(value=node.attr(name),"style"===name?value=dom.serializeStyle(dom.parseStyle(value),node.name):urlConverter&&(value=urlConverter.call(urlConverterScope,value,name,node.name)),node.attr(name,value.length>0?value:null))}),htmlParser.addAttributeFilter("class",function(nodes){for(var node,value,i=nodes.length;i--;)node=nodes[i],(value=node.attr("class"))&&(value=node.attr("class").replace(/(?:^|\s)mce-item-\w+(?!\S)/g,""),node.attr("class",value.length>0?value:null))}),htmlParser.addAttributeFilter("data-mce-type",function(nodes,name,args){for(var node,i=nodes.length;i--;)if(node=nodes[i],"bookmark"===node.attr("data-mce-type")&&!args.cleanup){var hasChildren=Option.from(node.firstChild).exists(function(firstChild){return!Zwsp.isZwsp(firstChild.value)});hasChildren?node.unwrap():node.remove()}}),htmlParser.addNodeFilter("noscript",function(nodes){for(var node,i=nodes.length;i--;)(node=nodes[i].firstChild)&&(node.value=Entities.decode(node.value))}),htmlParser.addNodeFilter("script,style",function(nodes,name){for(var node,value,type,i=nodes.length,trim=function(value){return value.replace(/(<!--\[CDATA\[|\]\]-->)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"")};i--;)node=nodes[i],value=node.firstChild?node.firstChild.value:"","script"===name?(type=node.attr("type"),type&&node.attr("type","mce-no/type"===type?null:type.replace(/^mce\-/,"")),"xhtml"===settings.element_format&&value.length>0&&(node.firstChild.value="// <![CDATA[\n"+trim(value)+"\n// ]]>")):"xhtml"===settings.element_format&&value.length>0&&(node.firstChild.value="\x3c!--\n"+trim(value)+"\n--\x3e")}),htmlParser.addNodeFilter("#comment",function(nodes){for(var node,i=nodes.length;i--;)node=nodes[i],settings.preserve_cdata&&0===node.value.indexOf("[CDATA[")?(node.name="#cdata",node.type=4,node.value=dom.decode(node.value.replace(/^\[CDATA\[|\]\]$/g,""))):0===node.value.indexOf("mce:protected ")&&(node.name="#text",node.type=3,node.raw=!0,node.value=unescape(node.value).substr(14))}),htmlParser.addNodeFilter("xml:namespace,input",function(nodes,name){for(var node,i=nodes.length;i--;)node=nodes[i],7===node.type?node.remove():1===node.type&&("input"!==name||node.attr("type")||node.attr("type","text"))}),htmlParser.addAttributeFilter("data-mce-type",function(nodes){each(nodes,function(node){"format-caret"===node.attr("data-mce-type")&&(node.isEmpty(htmlParser.schema.getNonEmptyElements())?node.remove():node.unwrap())})}),htmlParser.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-type,data-mce-resize,data-mce-placeholder",function(nodes,name){for(var i=nodes.length;i--;)nodes[i].attr(name,null)})},trimTrailingBr=function(rootNode){var brNode1,brNode2,isBr=function(node){return node&&"br"===node.name};brNode1=rootNode.lastChild,isBr(brNode1)&&(brNode2=brNode1.prev,isBr(brNode2)&&(brNode1.remove(),brNode2.remove()))},DomSerializerFilters={register:register$3,trimTrailingBr:trimTrailingBr},preProcess=function(editor,node,args){var impl,doc,oldDoc,dom=editor.dom;return node=node.cloneNode(!0),impl=domGlobals.document.implementation,impl.createHTMLDocument&&(doc=impl.createHTMLDocument(""),Tools.each("BODY"===node.nodeName?node.childNodes:[node],function(node){doc.body.appendChild(doc.importNode(node,!0))}),node="BODY"!==node.nodeName?doc.body.firstChild:doc.body,oldDoc=dom.doc,dom.doc=doc),firePreProcess(editor,__assign(__assign({},args),{node:node})),oldDoc&&(dom.doc=oldDoc),node},shouldFireEvent=function(editor,args){return editor&&editor.hasEventListeners("PreProcess")&&!args.no_events},process=function(editor,node,args){return shouldFireEvent(editor,args)?preProcess(editor,node,args):node},DomSerializerPreProcess={process:process},addTempAttr=function(htmlParser,tempAttrs,name){-1===Tools.inArray(tempAttrs,name)&&(htmlParser.addAttributeFilter(name,function(nodes,name){for(var i=nodes.length;i--;)nodes[i].attr(name,null)}),tempAttrs.push(name))},postProcess=function(editor,args,content){if(!args.no_events&&editor){return firePostProcess(editor,__assign(__assign({},args),{content:content})).content}return content},getHtmlFromNode=function(dom,node,args){var html=Zwsp.trim(args.getInner?node.innerHTML:dom.getOuterHTML(node));return args.selection||isWsPreserveElement(Element.fromDom(node))?html:Tools.trim(html)},parseHtml=function(htmlParser,html,args){var parserArgs=args.selection?__assign({forced_root_block:!1},args):args,rootNode=htmlParser.parse(html,parserArgs);return DomSerializerFilters.trimTrailingBr(rootNode),rootNode},serializeNode=function(settings,schema,node){return Serializer(settings,schema).serialize(node)},toHtml=function(editor,settings,schema,rootNode,args){var content=serializeNode(settings,schema,rootNode);return postProcess(editor,args,content)},DomSerializer=function(settings,editor){var tempAttrs=["data-mce-selected"],dom=editor&&editor.dom?editor.dom:DOMUtils$1.DOM,schema=editor&&editor.schema?editor.schema:Schema(settings);settings.entity_encoding=settings.entity_encoding||"named",settings.remove_trailing_brs=!("remove_trailing_brs"in settings)||settings.remove_trailing_brs;var htmlParser=DomParser(settings,schema);DomSerializerFilters.register(htmlParser,settings,dom);var serialize=function(node,parserArgs){void 0===parserArgs&&(parserArgs={});var args=__assign({format:"html"},parserArgs),targetNode=DomSerializerPreProcess.process(editor,node,args),html=getHtmlFromNode(dom,targetNode,args),rootNode=parseHtml(htmlParser,html,args);return"tree"===args.format?rootNode:toHtml(editor,settings,schema,rootNode,args)};return{schema:schema,addNodeFilter:htmlParser.addNodeFilter,addAttributeFilter:htmlParser.addAttributeFilter,serialize:serialize,addRules:function(rules){schema.addValidElements(rules)},setRules:function(rules){schema.setValidElements(rules)},addTempAttr:curry(addTempAttr,htmlParser,tempAttrs),getTempAttrs:function(){return tempAttrs},getNodeFilters:htmlParser.getNodeFilters,getAttributeFilters:htmlParser.getAttributeFilters}},Serializer$1=function(settings,editor){var domSerializer=DomSerializer(settings,editor);return{schema:domSerializer.schema,addNodeFilter:domSerializer.addNodeFilter,addAttributeFilter:domSerializer.addAttributeFilter,serialize:domSerializer.serialize,addRules:domSerializer.addRules,setRules:domSerializer.setRules,addTempAttr:domSerializer.addTempAttr,getTempAttrs:domSerializer.getTempAttrs,getNodeFilters:domSerializer.getNodeFilters,getAttributeFilters:domSerializer.getAttributeFilters}},blobUriToBlob=function(url){return new promiseObj(function(resolve,reject){var rejectWithError=function(){reject("Cannot convert "+url+" to Blob. Resource might not exist or is inaccessible.")};try{var xhr=new domGlobals.XMLHttpRequest;xhr.open("GET",url,!0),xhr.responseType="blob",xhr.onload=function(){200===this.status?resolve(this.response):rejectWithError()},xhr.onerror=rejectWithError,xhr.send()}catch(ex){rejectWithError()}})},parseDataUri=function(uri){var type,matches,uriParts=decodeURIComponent(uri).split(",");return matches=/data:([^;]+)/.exec(uriParts[0]),matches&&(type=matches[1]),{type:type,data:uriParts[1]}},dataUriToBlob=function(uri){return new promiseObj(function(resolve){var str,arr,i,uriParts=parseDataUri(uri);try{str=domGlobals.atob(uriParts.data)}catch(e){return void resolve(new domGlobals.Blob([]))}for(arr=new Uint8Array(str.length),i=0;i<arr.length;i++)arr[i]=str.charCodeAt(i);resolve(new domGlobals.Blob([arr],{type:uriParts.type}))})},uriToBlob=function(url){return 0===url.indexOf("blob:")?blobUriToBlob(url):0===url.indexOf("data:")?dataUriToBlob(url):null},blobToDataUri=function(blob){return new promiseObj(function(resolve){var reader=new domGlobals.FileReader;reader.onloadend=function(){resolve(reader.result)},reader.readAsDataURL(blob)})},Conversions={uriToBlob:uriToBlob,blobToDataUri:blobToDataUri,parseDataUri:parseDataUri},count=0,uniqueId=function(prefix){return(prefix||"blobid")+count++},imageToBlobInfo=function(blobCache,img,resolve,reject){var base64,blobInfo;if(0===img.src.indexOf("blob:"))return blobInfo=blobCache.getByUri(img.src),void(blobInfo?resolve({image:img,blobInfo:blobInfo}):Conversions.uriToBlob(img.src).then(function(blob){Conversions.blobToDataUri(blob).then(function(dataUri){base64=Conversions.parseDataUri(dataUri).data,blobInfo=blobCache.create(uniqueId(),blob,base64),blobCache.add(blobInfo),resolve({image:img,blobInfo:blobInfo})})},function(err){reject(err)}));base64=Conversions.parseDataUri(img.src).data,blobInfo=blobCache.findFirst(function(cachedBlobInfo){return cachedBlobInfo.base64()===base64}),blobInfo?resolve({image:img,blobInfo:blobInfo}):Conversions.uriToBlob(img.src).then(function(blob){blobInfo=blobCache.create(uniqueId(),blob,base64),blobCache.add(blobInfo),resolve({image:img,blobInfo:blobInfo})},function(err){reject(err)})},getAllImages=function(elm){return elm?from$1(elm.getElementsByTagName("img")):[]},count$1=0,seed=function(){var rnd=function(){return Math.round(4294967295*Math.random()).toString(36)};return"s"+(new Date).getTime().toString(36)+rnd()+rnd()+rnd()},uuid=function(prefix){return prefix+count$1+++seed()},Uuid={uuid:uuid},BlobCache=function(){var cache=[],mimeToExt=function(mime){return{"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png"}[mime.toLowerCase()]||"dat"},create=function(o,blob,base64,filename){if(isString(o)){return toBlobInfo({id:o,name:filename,blob:blob,base64:base64})}if(isObject(o))return toBlobInfo(o);throw new Error("Unknown input type")},toBlobInfo=function(o){var id,name;if(!o.blob||!o.base64)throw new Error("blob and base64 representations of the image are required for BlobInfo to be created");return id=o.id||Uuid.uuid("blobid"),name=o.name||id,{id:constant(id),name:constant(name),filename:constant(name+"."+mimeToExt(o.blob.type)),blob:constant(o.blob),base64:constant(o.base64),blobUri:constant(o.blobUri||domGlobals.URL.createObjectURL(o.blob)),uri:constant(o.uri)}},add=function(blobInfo){get(blobInfo.id())||cache.push(blobInfo)},get=function(id){return findFirst(function(cachedBlobInfo){return cachedBlobInfo.id()===id})},findFirst=function(predicate){return filter(cache,predicate)[0]};return{create:create,add:add,get:get,getByUri:function(blobUri){return findFirst(function(blobInfo){return blobInfo.blobUri()===blobUri})},findFirst:findFirst,removeByUri:function(blobUri){cache=filter(cache,function(blobInfo){return blobInfo.blobUri()!==blobUri||(domGlobals.URL.revokeObjectURL(blobInfo.blobUri()),!1)})},destroy:function(){each(cache,function(cachedBlobInfo){domGlobals.URL.revokeObjectURL(cachedBlobInfo.blobUri())}),cache=[]}}},EditorUpload=function(editor){var uploader,imageScanner,blobCache=BlobCache(),uploadStatus=UploadStatus(),urlFilters=[],aliveGuard=function(callback){return function(result){return editor.selection?callback(result):[]}},cacheInvalidator=function(url){return url+(-1===url.indexOf("?")?"?":"&")+(new Date).getTime()},replaceString=function(content,search,replace){var index=0;do{-1!==(index=content.indexOf(search,index))&&(content=content.substring(0,index)+replace+content.substr(index+search.length),index+=replace.length-search.length+1)}while(-1!==index);return content},replaceImageUrl=function(content,targetUrl,replacementUrl){return content=replaceString(content,'src="'+targetUrl+'"','src="'+replacementUrl+'"'),content=replaceString(content,'data-mce-src="'+targetUrl+'"','data-mce-src="'+replacementUrl+'"')},replaceUrlInUndoStack=function(targetUrl,replacementUrl){each(editor.undoManager.data,function(level){"fragmented"===level.type?level.fragments=map(level.fragments,function(fragment){return replaceImageUrl(fragment,targetUrl,replacementUrl)}):level.content=replaceImageUrl(level.content,targetUrl,replacementUrl)})},openNotification=function(){return editor.notificationManager.open({text:editor.translate("Image uploading..."),type:"info",timeout:-1,progressBar:!0})},replaceImageUri=function(image,resultUri){blobCache.removeByUri(image.src),replaceUrlInUndoStack(image.src,resultUri),editor.$(image).attr({src:Settings.shouldReuseFileName(editor)?cacheInvalidator(resultUri):resultUri,"data-mce-src":editor.convertURL(resultUri,"src")})},uploadImages=function(callback){return uploader||(uploader=Uploader(uploadStatus,{url:Settings.getImageUploadUrl(editor),basePath:Settings.getImageUploadBasePath(editor),credentials:Settings.getImagesUploadCredentials(editor),handler:Settings.getImagesUploadHandler(editor)})),scanForImages().then(aliveGuard(function(imageInfos){var blobInfos=map(imageInfos,function(imageInfo){return imageInfo.blobInfo});return uploader.upload(blobInfos,openNotification).then(aliveGuard(function(result){var filteredResult=map(result,function(uploadInfo,index){var image=imageInfos[index].image;return uploadInfo.status&&Settings.shouldReplaceBlobUris(editor)?replaceImageUri(image,uploadInfo.url):uploadInfo.error&&ErrorReporter.uploadError(editor,uploadInfo.error),{element:image,status:uploadInfo.status}});return callback&&callback(filteredResult),filteredResult}))}))},uploadImagesAuto=function(callback){if(Settings.isAutomaticUploadsEnabled(editor))return uploadImages(callback)},isValidDataUriImage=function(imgElm){if(!1===forall(urlFilters,function(filter){return filter(imgElm)}))return!1;if(0===imgElm.getAttribute("src").indexOf("data:")){return Settings.getImagesDataImgFilter(editor)(imgElm)}return!0},addFilter=function(filter){urlFilters.push(filter)},scanForImages=function(){return imageScanner||(imageScanner=ImageScanner(uploadStatus,blobCache)),imageScanner.findAll(editor.getBody(),isValidDataUriImage).then(aliveGuard(function(result){return result=filter(result,function(resultItem){return"string"!=typeof resultItem||(ErrorReporter.displayError(editor,resultItem),!1)}),each(result,function(resultItem){replaceUrlInUndoStack(resultItem.image.src,resultItem.blobInfo.blobUri()),resultItem.image.src=resultItem.blobInfo.blobUri(),resultItem.image.removeAttribute("data-mce-src")}),result}))},destroy=function(){blobCache.destroy(),uploadStatus.destroy(),imageScanner=uploader=null},replaceBlobUris=function(content){return content.replace(/src="(blob:[^"]+)"/g,function(match,blobUri){var resultUri=uploadStatus.getResultUri(blobUri);if(resultUri)return'src="'+resultUri+'"';var blobInfo=blobCache.getByUri(blobUri);if(blobInfo||(blobInfo=foldl(editor.editorManager.get(),function(result,editor){return result||editor.editorUpload&&editor.editorUpload.blobCache.getByUri(blobUri)},null)),blobInfo){return'src="data:'+blobInfo.blob().type+";base64,"+blobInfo.base64()+'"'}return match})};return editor.on("SetContent",function(){Settings.isAutomaticUploadsEnabled(editor)?uploadImagesAuto():scanForImages()}),editor.on("RawSaveContent",function(e){e.content=replaceBlobUris(e.content)}),editor.on("GetContent",function(e){e.source_view||"raw"===e.format||(e.content=replaceBlobUris(e.content))}),editor.on("PostRender",function(){editor.parser.addNodeFilter("img",function(images){each(images,function(img){var src=img.attr("src");if(!blobCache.getByUri(src)){var resultUri=uploadStatus.getResultUri(src);resultUri&&img.attr("src",resultUri)}})})}),{blobCache:blobCache,addFilter:addFilter,uploadImages:uploadImages,uploadImagesAuto:uploadImagesAuto,scanForImages:scanForImages,destroy:destroy}},getLastChildren$1=function(elm){for(var children=[],rawNode=elm.dom();rawNode;)children.push(Element.fromDom(rawNode)),rawNode=rawNode.lastChild;return children},removeTrailingBr=function(elm){var allBrs=descendants$1(elm,"br"),brs=filter(getLastChildren$1(elm).slice(-1),isBr$1);allBrs.length===brs.length&&each(brs,remove)},fillWithPaddingBr=function(elm){empty(elm),append(elm,Element.fromHtml('<br data-mce-bogus="1">'))},isPaddingContents=function(elm){return isText(elm)?" "===get$7(elm):isBr$1(elm)},isPaddedElement=function(elm){return 1===filter(children(elm),isPaddingContents).length},trimBlockTrailingBr=function(elm){lastChild(elm).each(function(lastChild){prevSibling(lastChild).each(function(lastChildPrevSibling){isBlock(elm)&&isBr$1(lastChild)&&isBlock(lastChildPrevSibling)&&remove(lastChild)})})},PaddingBr={removeTrailingBr:removeTrailingBr,fillWithPaddingBr:fillWithPaddingBr,isPaddedElement:isPaddedElement,trimBlockTrailingBr:trimBlockTrailingBr},isEq$2=isEq,matchesUnInheritedFormatSelector=function(ed,node,name){var formatList=ed.formatter.get(name);if(formatList)for(var i=0;i<formatList.length;i++)if(!1===formatList[i].inherit&&ed.dom.is(node,formatList[i].selector))return!0;return!1},matchParents=function(editor,node,name,vars){var root=editor.dom.getRoot();return node!==root&&(node=editor.dom.getParent(node,function(node){return!!matchesUnInheritedFormatSelector(editor,node,name)||(node.parentNode===root||!!matchNode(editor,node,name,vars,!0))}),matchNode(editor,node,name,vars))},matchName=function(dom,node,format){return!!isEq$2(node,format.inline)||(!!isEq$2(node,format.block)||(format.selector?1===node.nodeType&&dom.is(node,format.selector):void 0))},matchItems=function(dom,node,format,itemName,similar,vars){var key,value,i,items=format[itemName];if(format.onmatch)return format.onmatch(node,format,itemName);if(items)if(void 0===items.length){for(key in items)if(items.hasOwnProperty(key)){if(value="attributes"===itemName?dom.getAttrib(node,key):getStyle(dom,node,key),similar&&!value&&!format.exact)return;if((!similar||format.exact)&&!isEq$2(value,normalizeStyleValue(dom,replaceVars(items[key],vars),key)))return}}else for(i=0;i<items.length;i++)if("attributes"===itemName?dom.getAttrib(node,items[i]):getStyle(dom,node,items[i]))return format;return format},matchNode=function(ed,node,name,vars,similar){var format,i,x,classes,formatList=ed.formatter.get(name),dom=ed.dom;if(formatList&&node)for(i=0;i<formatList.length;i++)if(format=formatList[i],matchName(ed.dom,node,format)&&matchItems(dom,node,format,"attributes",similar,vars)&&matchItems(dom,node,format,"styles",similar,vars)){if(classes=format.classes)for(x=0;x<classes.length;x++)if(!ed.dom.hasClass(node,classes[x]))return;return format}},match=function(editor,name,vars,node){var startNode;return node?matchParents(editor,node,name,vars):(node=editor.selection.getNode(),!!matchParents(editor,node,name,vars)||!((startNode=editor.selection.getStart())===node||!matchParents(editor,startNode,name,vars)))},matchAll=function(editor,names,vars){var startElement,matchedFormatNames=[],checkedMap={};return startElement=editor.selection.getStart(),editor.dom.getParent(startElement,function(node){var i,name;for(i=0;i<names.length;i++)name=names[i],!checkedMap[name]&&matchNode(editor,node,name,vars)&&(checkedMap[name]=!0,matchedFormatNames.push(name))},editor.dom.getRoot()),matchedFormatNames},canApply=function(editor,name){var startNode,parents,i,x,selector,formatList=editor.formatter.get(name),dom=editor.dom;if(formatList)for(startNode=editor.selection.getStart(),parents=getParents$1(dom,startNode),x=formatList.length-1;x>=0;x--){if(!(selector=formatList[x].selector)||formatList[x].defaultBlock)return!0;for(i=parents.length-1;i>=0;i--)if(dom.is(parents[i],selector))return!0}return!1},splitText=function(node,offset){return node.splitText(offset)},split$1=function(rng){var startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset;return startContainer===endContainer&&NodeType.isText(startContainer)?startOffset>0&&startOffset<startContainer.nodeValue.length&&(endContainer=splitText(startContainer,startOffset),startContainer=endContainer.previousSibling,endOffset>startOffset?(endOffset-=startOffset,startContainer=endContainer=splitText(endContainer,endOffset).previousSibling,endOffset=endContainer.nodeValue.length,startOffset=0):endOffset=0):(NodeType.isText(startContainer)&&startOffset>0&&startOffset<startContainer.nodeValue.length&&(startContainer=splitText(startContainer,startOffset),startOffset=0),NodeType.isText(endContainer)&&endOffset>0&&endOffset<endContainer.nodeValue.length&&(endContainer=splitText(endContainer,endOffset).previousSibling,endOffset=endContainer.nodeValue.length)),{startContainer:startContainer,startOffset:startOffset,endContainer:endContainer,endOffset:endOffset}},normalizeContent=function(content,isStartOfContent,isEndOfContent){return foldl(content,function(acc,c){return isWhiteSpace$1(c)||isNbsp(c)?acc.previousCharIsSpace||""===acc.str&&isStartOfContent||acc.str.length===content.length-1&&isEndOfContent?{previousCharIsSpace:!1,str:acc.str+" "}:{previousCharIsSpace:!0,str:acc.str+" "}:{previousCharIsSpace:!1,str:acc.str+c}},{previousCharIsSpace:!1,str:""}).str},normalize$1=function(node,offset,count){if(0!==count){var whitespace=node.data.slice(offset,offset+count),isEndOfContent=offset+count>=node.data.length,isStartOfContent=0===offset;node.replaceData(offset,count,normalizeContent(whitespace,isStartOfContent,isEndOfContent))}},normalizeWhitespaceAfter=function(node,offset){var content=node.data.slice(offset),whitespaceCount=content.length-lTrim(content).length;return normalize$1(node,offset,whitespaceCount)},normalizeWhitespaceBefore=function(node,offset){var content=node.data.slice(0,offset),whitespaceCount=content.length-rTrim(content).length;return normalize$1(node,offset-whitespaceCount,whitespaceCount)},mergeTextNodes=function(prevNode,nextNode,normalizeWhitespace){var whitespaceOffset=rTrim(prevNode.data).length;return prevNode.appendData(nextNode.data),remove(Element.fromDom(nextNode)),normalizeWhitespace&&normalizeWhitespaceAfter(prevNode,whitespaceOffset),prevNode},ancestor$2=function(scope,selector,isRoot){return ancestor$1(scope,selector,isRoot).isSome()},hasWhitespacePreserveParent=function(rootNode,node){var rootElement=Element.fromDom(rootNode),startNode=Element.fromDom(node);return ancestor$2(startNode,"pre,code",curry(eq,rootElement))},isWhitespace=function(rootNode,node){return NodeType.isText(node)&&/^[ \t\r\n]*$/.test(node.data)&&!1===hasWhitespacePreserveParent(rootNode,node)},isNamedAnchor=function(node){return NodeType.isElement(node)&&"A"===node.nodeName&&node.hasAttribute("name")},isContent$1=function(rootNode,node){return isCaretCandidate(node)&&!1===isWhitespace(rootNode,node)||isNamedAnchor(node)||isBookmark(node)},isBookmark=NodeType.hasAttribute("data-mce-bookmark"),isBogus$2=NodeType.hasAttribute("data-mce-bogus"),isBogusAll$1=NodeType.hasAttributeValue("data-mce-bogus","all"),isEmptyNode=function(targetNode,skipBogus){var node,brCount=0;if(isContent$1(targetNode,targetNode))return!1;if(!(node=targetNode.firstChild))return!0;var walker=new TreeWalker(node,targetNode);do{if(skipBogus){if(isBogusAll$1(node)){node=walker.next(!0);continue}if(isBogus$2(node)){node=walker.next();continue}}if(NodeType.isBr(node))brCount++,node=walker.next();else{if(isContent$1(targetNode,node))return!1;node=walker.next()}}while(node);return brCount<=1},isEmpty$2=function(elm,skipBogus){return void 0===skipBogus&&(skipBogus=!0),isEmptyNode(elm.dom(),skipBogus)},Empty={isEmpty:isEmpty$2},needsReposition=function(pos,elm){var container=pos.container(),offset=pos.offset();return!1===CaretPosition$1.isTextPosition(pos)&&container===elm.parentNode&&offset>CaretPosition$1.before(elm).offset()},reposition=function(elm,pos){return needsReposition(pos,elm)?CaretPosition$1(pos.container(),pos.offset()-1):pos},beforeOrStartOf=function(node){return NodeType.isText(node)?CaretPosition$1(node,0):CaretPosition$1.before(node)},afterOrEndOf=function(node){return NodeType.isText(node)?CaretPosition$1(node,node.data.length):CaretPosition$1.after(node)},getPreviousSiblingCaretPosition=function(elm){return isCaretCandidate(elm.previousSibling)?Option.some(afterOrEndOf(elm.previousSibling)):elm.previousSibling?CaretFinder.lastPositionIn(elm.previousSibling):Option.none()},getNextSiblingCaretPosition=function(elm){return isCaretCandidate(elm.nextSibling)?Option.some(beforeOrStartOf(elm.nextSibling)):elm.nextSibling?CaretFinder.firstPositionIn(elm.nextSibling):Option.none()},findCaretPositionBackwardsFromElm=function(rootElement,elm){var startPosition=CaretPosition$1.before(elm.previousSibling?elm.previousSibling:elm.parentNode);return CaretFinder.prevPosition(rootElement,startPosition).fold(function(){return CaretFinder.nextPosition(rootElement,CaretPosition$1.after(elm))},Option.some)},findCaretPositionForwardsFromElm=function(rootElement,elm){return CaretFinder.nextPosition(rootElement,CaretPosition$1.after(elm)).fold(function(){return CaretFinder.prevPosition(rootElement,CaretPosition$1.before(elm))},Option.some)},findCaretPositionBackwards=function(rootElement,elm){return getPreviousSiblingCaretPosition(elm).orThunk(function(){return getNextSiblingCaretPosition(elm)}).orThunk(function(){return findCaretPositionBackwardsFromElm(rootElement,elm)})},findCaretPositionForward=function(rootElement,elm){return getNextSiblingCaretPosition(elm).orThunk(function(){return getPreviousSiblingCaretPosition(elm)}).orThunk(function(){return findCaretPositionForwardsFromElm(rootElement,elm)})},findCaretPosition$1=function(forward,rootElement,elm){return forward?findCaretPositionForward(rootElement,elm):findCaretPositionBackwards(rootElement,elm)},findCaretPosOutsideElmAfterDelete=function(forward,rootElement,elm){return findCaretPosition$1(forward,rootElement,elm).map(curry(reposition,elm))},setSelection=function(editor,forward,pos){pos.fold(function(){editor.focus()},function(pos){editor.selection.setRng(pos.toRange(),forward)})},eqRawNode=function(rawNode){return function(elm){return elm.dom()===rawNode}},isBlock$2=function(editor,elm){return elm&&editor.schema.getBlockElements().hasOwnProperty(name(elm))},paddEmptyBlock=function(elm){if(Empty.isEmpty(elm)){var br=Element.fromHtml('<br data-mce-bogus="1">');return empty(elm),append(elm,br),Option.some(CaretPosition$1.before(br.dom()))}return Option.none()},deleteNormalized=function(elm,afterDeletePosOpt,normalizeWhitespace){var prevTextOpt=prevSibling(elm).filter(isText),nextTextOpt=nextSibling(elm).filter(isText);return remove(elm),lift3(prevTextOpt,nextTextOpt,afterDeletePosOpt,function(prev,next,pos){var prevNode=prev.dom(),nextNode=next.dom(),offset=prevNode.data.length;return mergeTextNodes(prevNode,nextNode,normalizeWhitespace),pos.container()===nextNode?CaretPosition$1(prevNode,offset):pos}).orThunk(function(){return normalizeWhitespace&&(prevTextOpt.each(function(elm){return normalizeWhitespaceBefore(elm.dom(),elm.dom().length)}),nextTextOpt.each(function(elm){return normalizeWhitespaceAfter(elm.dom(),0)})),afterDeletePosOpt})},isInlineElement=function(editor,element){return has(editor.schema.getTextInlineElements(),name(element))},deleteElement=function(editor,forward,elm,moveCaret){void 0===moveCaret&&(moveCaret=!0);var afterDeletePos=findCaretPosOutsideElmAfterDelete(forward,editor.getBody(),elm.dom()),parentBlock=ancestor(elm,curry(isBlock$2,editor),eqRawNode(editor.getBody())),normalizedAfterDeletePos=deleteNormalized(elm,afterDeletePos,isInlineElement(editor,elm));editor.dom.isEmpty(editor.getBody())?(editor.setContent(""),editor.selection.setCursorLocation()):parentBlock.bind(paddEmptyBlock).fold(function(){moveCaret&&setSelection(editor,forward,normalizedAfterDeletePos)},function(paddPos){moveCaret&&setSelection(editor,forward,Option.some(paddPos))})},DeleteElement={deleteElement:deleteElement},ZWSP$1=Zwsp.ZWSP,importNode=function(ownerDocument,node){return ownerDocument.importNode(node,!0)},getEmptyCaretContainers=function(node){for(var nodes=[];node;){if(3===node.nodeType&&node.nodeValue!==ZWSP$1||node.childNodes.length>1)return[];1===node.nodeType&&nodes.push(node),node=node.firstChild}return nodes},isCaretContainerEmpty=function(node){return getEmptyCaretContainers(node).length>0},findFirstTextNode=function(node){if(node){var walker=new TreeWalker(node,node);for(node=walker.current();node;node=walker.next())if(NodeType.isText(node))return node}return null},createCaretContainer=function(fill){var caretContainer=Element.fromTag("span");return setAll(caretContainer,{id:"_mce_caret","data-mce-bogus":"1","data-mce-type":"format-caret"}),fill&&append(caretContainer,Element.fromText(ZWSP$1)),caretContainer},trimZwspFromCaretContainer=function(caretContainerNode){var textNode=findFirstTextNode(caretContainerNode);return textNode&&textNode.nodeValue.charAt(0)===ZWSP$1&&textNode.deleteData(0,1),textNode},removeCaretContainerNode=function(editor,node,moveCaret){void 0===moveCaret&&(moveCaret=!0);var dom=editor.dom,selection=editor.selection;if(isCaretContainerEmpty(node))DeleteElement.deleteElement(editor,!1,Element.fromDom(node),moveCaret);else{var rng=selection.getRng(),block=dom.getParent(node,dom.isBlock),textNode=trimZwspFromCaretContainer(node);rng.startContainer===textNode&&rng.startOffset>0&&rng.setStart(textNode,rng.startOffset-1),rng.endContainer===textNode&&rng.endOffset>0&&rng.setEnd(textNode,rng.endOffset-1),dom.remove(node,!0),block&&dom.isEmpty(block)&&PaddingBr.fillWithPaddingBr(Element.fromDom(block)),selection.setRng(rng)}},removeCaretContainer=function(editor,node,moveCaret){void 0===moveCaret&&(moveCaret=!0);var dom=editor.dom,selection=editor.selection;if(node)removeCaretContainerNode(editor,node,moveCaret);else if(!(node=getParentCaretContainer(editor.getBody(),selection.getStart())))for(;node=dom.get("_mce_caret");)removeCaretContainerNode(editor,node,!1)},insertCaretContainerNode=function(editor,caretContainer,formatNode){var dom=editor.dom,block=dom.getParent(formatNode,curry(isTextBlock$1,editor));block&&dom.isEmpty(block)?formatNode.parentNode.replaceChild(caretContainer,formatNode):(PaddingBr.removeTrailingBr(Element.fromDom(formatNode)),dom.isEmpty(formatNode)?formatNode.parentNode.replaceChild(caretContainer,formatNode):dom.insertAfter(caretContainer,formatNode))},appendNode=function(parentNode,node){return parentNode.appendChild(node),node},insertFormatNodesIntoCaretContainer=function(formatNodes,caretContainer){var innerMostFormatNode=foldr(formatNodes,function(parentNode,formatNode){return appendNode(parentNode,formatNode.cloneNode(!1))},caretContainer);return appendNode(innerMostFormatNode,innerMostFormatNode.ownerDocument.createTextNode(ZWSP$1))},applyCaretFormat=function(editor,name,vars){var rng,caretContainer,textNode,offset,bookmark,container,text,selection=editor.selection;rng=selection.getRng(),offset=rng.startOffset,container=rng.startContainer,text=container.nodeValue,(caretContainer=getParentCaretContainer(editor.getBody(),selection.getStart()))&&(textNode=findFirstTextNode(caretContainer));var wordcharRegex=/[^\s\u00a0\u00ad\u200b\ufeff]/;text&&offset>0&&offset<text.length&&wordcharRegex.test(text.charAt(offset))&&wordcharRegex.test(text.charAt(offset-1))?(bookmark=selection.getBookmark(),rng.collapse(!0),rng=expandRng(editor,rng,editor.formatter.get(name)),rng=split$1(rng),editor.formatter.apply(name,vars,rng),selection.moveToBookmark(bookmark)):(caretContainer&&textNode.nodeValue===ZWSP$1?editor.formatter.apply(name,vars,caretContainer):(caretContainer=importNode(editor.getDoc(),createCaretContainer(!0).dom()),textNode=caretContainer.firstChild,rng.insertNode(caretContainer),offset=1,editor.formatter.apply(name,vars,caretContainer)),selection.setCursorLocation(textNode,offset))},removeCaretFormat=function(editor,name,vars,similar){var container,offset,bookmark,hasContentAfter,node,formatNode,caretContainer,dom=editor.dom,selection=editor.selection,parents=[],rng=selection.getRng();for(container=rng.startContainer,offset=rng.startOffset,node=container,3===container.nodeType&&(offset!==container.nodeValue.length&&(hasContentAfter=!0),node=node.parentNode);node;){if(matchNode(editor,node,name,vars,similar)){formatNode=node;break}node.nextSibling&&(hasContentAfter=!0),parents.push(node),node=node.parentNode}if(formatNode)if(hasContentAfter){bookmark=selection.getBookmark(),rng.collapse(!0);var expandedRng=expandRng(editor,rng,editor.formatter.get(name),!0);expandedRng=split$1(expandedRng),editor.formatter.remove(name,vars,expandedRng),selection.moveToBookmark(bookmark)}else{caretContainer=getParentCaretContainer(editor.getBody(),formatNode);var newCaretContainer=createCaretContainer(!1).dom(),caretNode=insertFormatNodesIntoCaretContainer(parents,newCaretContainer);caretContainer?insertCaretContainerNode(editor,newCaretContainer,caretContainer):insertCaretContainerNode(editor,newCaretContainer,formatNode),removeCaretContainerNode(editor,caretContainer,!1),selection.setCursorLocation(caretNode,1),dom.isEmpty(formatNode)&&dom.remove(formatNode)}},disableCaretContainer=function(editor,keyCode){var selection=editor.selection,body=editor.getBody();removeCaretContainer(editor,null,!1),8!==keyCode&&46!==keyCode||!selection.isCollapsed()||selection.getStart().innerHTML!==ZWSP$1||removeCaretContainer(editor,getParentCaretContainer(body,selection.getStart())),37!==keyCode&&39!==keyCode||removeCaretContainer(editor,getParentCaretContainer(body,selection.getStart()))},setup$3=function(editor){editor.on("mouseup keydown",function(e){disableCaretContainer(editor,e.keyCode)})},replaceWithCaretFormat=function(targetNode,formatNodes){var caretContainer=createCaretContainer(!1),innerMost=insertFormatNodesIntoCaretContainer(formatNodes,caretContainer.dom());return before(Element.fromDom(targetNode),caretContainer),remove(Element.fromDom(targetNode)),CaretPosition$1(innerMost,0)},isFormatElement=function(editor,element){return editor.schema.getTextInlineElements().hasOwnProperty(name(element))&&!isCaretNode(element.dom())&&!NodeType.isBogus(element.dom())},isEmptyCaretFormatElement=function(element){return isCaretNode(element.dom())&&isCaretContainerEmpty(element.dom())},postProcessHooks={},filter$3=ArrUtils.filter,each$9=ArrUtils.each,postProcess$1=function(name,editor){each$9(postProcessHooks[name],function(hook){hook(editor)})};!function(name,hook){var hooks=postProcessHooks[name];hooks||(postProcessHooks[name]=hooks=[]),postProcessHooks[name].push(hook)}("pre",function(editor){var isPre,blocks,rng=editor.selection.getRng(),hasPreSibling=function(pre){return isPre(pre.previousSibling)&&-1!==ArrUtils.indexOf(blocks,pre.previousSibling)},joinPre=function(pre1,pre2){DomQuery(pre2).remove(),DomQuery(pre1).append("<br><br>").append(pre2.childNodes)};isPre=NodeType.matchNodeNames(["pre"]),rng.collapsed||(blocks=editor.selection.getSelectedBlocks(),each$9(filter$3(filter$3(blocks,isPre),hasPreSibling),function(pre){joinPre(pre.previousSibling,pre)}))});var VDirection,each$a=Tools.each,ElementUtils=function(dom){this.compare=function(node1,node2){if(node1.nodeName!==node2.nodeName)return!1;var getAttribs=function(node){var attribs={};return each$a(dom.getAttribs(node),function(attr){var name=attr.nodeName.toLowerCase();0!==name.indexOf("_")&&"style"!==name&&0!==name.indexOf("data-")&&(attribs[name]=dom.getAttrib(node,name))}),attribs},compareObjects=function(obj1,obj2){var value,name;for(name in obj1)if(obj1.hasOwnProperty(name)){if(void 0===(value=obj2[name]))return!1;if(obj1[name]!==value)return!1;delete obj2[name]}for(name in obj2)if(obj2.hasOwnProperty(name))return!1;return!0};return!!compareObjects(getAttribs(node1),getAttribs(node2))&&(!!compareObjects(dom.parseStyle(dom.getAttrib(node1,"style")),dom.parseStyle(dom.getAttrib(node2,"style")))&&(!Bookmarks.isBookmarkNode(node1)&&!Bookmarks.isBookmarkNode(node2)))}},MCE_ATTR_RE=/^(src|href|style)$/,each$b=Tools.each,isEq$3=isEq,isTableCell$3=function(node){return/^(TH|TD)$/.test(node.nodeName)},isChildOfInlineParent=function(dom,node,parent){return dom.isChildOf(node,parent)&&node!==parent&&!dom.isBlock(parent)},getContainer=function(ed,rng,start){var container,offset;if(container=rng[start?"startContainer":"endContainer"],offset=rng[start?"startOffset":"endOffset"],NodeType.isElement(container)){var lastIdx=container.childNodes.length-1;!start&&offset&&offset--,container=container.childNodes[offset>lastIdx?lastIdx:offset]}return NodeType.isText(container)&&start&&offset>=container.nodeValue.length&&(container=new TreeWalker(container,ed.getBody()).next()||container),NodeType.isText(container)&&!start&&0===offset&&(container=new TreeWalker(container,ed.getBody()).prev()||container),container},wrap$3=function(dom,node,name,attrs){var wrapper=dom.create(name,attrs);return node.parentNode.insertBefore(wrapper,node),wrapper.appendChild(node),wrapper},wrapWithSiblings=function(dom,node,next,name,attrs){var start=Element.fromDom(node),wrapper=Element.fromDom(dom.create(name,attrs)),siblings=next?nextSiblings(start):prevSiblings(start);return append$1(wrapper,siblings),next?(before(start,wrapper),prepend(wrapper,start)):(after(start,wrapper),append(wrapper,start)),wrapper.dom()},matchName$1=function(dom,node,format){return!!isEq$3(node,format.inline)||(!!isEq$3(node,format.block)||(format.selector?NodeType.isElement(node)&&dom.is(node,format.selector):void 0))},isColorFormatAndAnchor=function(node,format){return format.links&&"A"===node.nodeName},find$4=function(dom,node,next,inc){return!(node=getNonWhiteSpaceSibling(node,next,inc))||"BR"===node.nodeName||dom.isBlock(node)},removeNode$1=function(ed,node,format){var rootBlockElm,parentNode=node.parentNode,dom=ed.dom,forcedRootBlock=Settings.getForcedRootBlock(ed);format.block&&(forcedRootBlock?parentNode===dom.getRoot()&&(format.list_block&&isEq$3(node,format.list_block)||each$b(Tools.grep(node.childNodes),function(node){isValid(ed,forcedRootBlock,node.nodeName.toLowerCase())?rootBlockElm?rootBlockElm.appendChild(node):(rootBlockElm=wrap$3(dom,node,forcedRootBlock),dom.setAttribs(rootBlockElm,ed.settings.forced_root_block_attrs)):rootBlockElm=0})):dom.isBlock(node)&&!dom.isBlock(parentNode)&&(find$4(dom,node,!1)||find$4(dom,node.firstChild,!0,!0)||node.insertBefore(dom.create("br"),node.firstChild),find$4(dom,node,!0)||find$4(dom,node.lastChild,!1,!0)||node.appendChild(dom.create("br")))),format.selector&&format.inline&&!isEq$3(format.inline,node)||dom.remove(node,!0)},removeFormat=function(ed,format,vars,node,compareNode){var stylesModified,dom=ed.dom;if(!matchName$1(dom,node,format)&&!isColorFormatAndAnchor(node,format))return!1;var elm=node;if("all"!==format.remove){each$b(format.styles,function(value,name){value=normalizeStyleValue(dom,replaceVars(value,vars),name),"number"==typeof name&&(name=value,compareNode=null),(format.remove_similar||!compareNode||isEq$3(getStyle(dom,compareNode,name),value))&&dom.setStyle(elm,name,""),stylesModified=!0}),stylesModified&&""===dom.getAttrib(elm,"style")&&(elm.removeAttribute("style"),elm.removeAttribute("data-mce-style")),each$b(format.attributes,function(value,name){var valueOut;if(value=replaceVars(value,vars),"number"==typeof name&&(name=value,compareNode=null),format.remove_similar||!compareNode||isEq$3(dom.getAttrib(compareNode,name),value)){if("class"===name&&(value=dom.getAttrib(elm,name))&&(valueOut="",each$b(value.split(/\s+/),function(cls){/mce\-\w+/.test(cls)&&(valueOut+=(valueOut?" ":"")+cls)}),valueOut))return void dom.setAttrib(elm,name,valueOut);"class"===name&&elm.removeAttribute("className"),MCE_ATTR_RE.test(name)&&elm.removeAttribute("data-mce-"+name),elm.removeAttribute(name)}}),each$b(format.classes,function(value){value=replaceVars(value,vars),compareNode&&!dom.hasClass(compareNode,value)||dom.removeClass(elm,value)});for(var attrs=dom.getAttribs(elm),i=0;i<attrs.length;i++){var attrName=attrs[i].nodeName;if(0!==attrName.indexOf("_")&&0!==attrName.indexOf("data-"))return!1}}return"none"!==format.remove?(removeNode$1(ed,elm,format),!0):void 0},findFormatRoot=function(editor,container,name,vars,similar){var formatRoot;return each$b(getParents$1(editor.dom,container.parentNode).reverse(),function(parent){var format;formatRoot||"_start"===parent.id||"_end"===parent.id||(format=matchNode(editor,parent,name,vars,similar))&&!1!==format.split&&(formatRoot=parent)}),formatRoot},wrapAndSplit=function(editor,formatList,formatRoot,container,target,split,format,vars){var parent,clone,lastClone,firstClone,i,formatRootParent,dom=editor.dom;if(formatRoot){for(formatRootParent=formatRoot.parentNode,parent=container.parentNode;parent&&parent!==formatRootParent;parent=parent.parentNode){for(clone=dom.clone(parent,!1),i=0;i<formatList.length;i++)if(removeFormat(editor,formatList[i],vars,clone,clone)){clone=0;break}clone&&(lastClone&&clone.appendChild(lastClone),firstClone||(firstClone=clone),lastClone=clone)}!split||format.mixed&&dom.isBlock(formatRoot)||(container=dom.split(formatRoot,container)),lastClone&&(target.parentNode.insertBefore(lastClone,target),firstClone.appendChild(target))}return container},remove$7=function(ed,name,vars,node,similar){var bookmark,rng,formatList=ed.formatter.get(name),format=formatList[0],contentEditable=!0,dom=ed.dom,selection=ed.selection,splitToFormatRoot=function(container){var formatRoot=findFormatRoot(ed,container,name,vars,similar);return wrapAndSplit(ed,formatList,formatRoot,container,container,!0,format,vars)},isRemoveBookmarkNode=function(node){return Bookmarks.isBookmarkNode(node)&&NodeType.isElement(node)&&("_start"===node.id||"_end"===node.id)},process=function(node){var children,i,l,lastContentEditable,hasContentEditableState;if(NodeType.isElement(node)&&dom.getContentEditable(node)&&(lastContentEditable=contentEditable,contentEditable="true"===dom.getContentEditable(node),hasContentEditableState=!0),children=Tools.grep(node.childNodes),contentEditable&&!hasContentEditableState)for(i=0,l=formatList.length;i<l&&!removeFormat(ed,formatList[i],vars,node,node);i++);if(format.deep&&children.length){for(i=0,l=children.length;i<l;i++)process(children[i]);hasContentEditableState&&(contentEditable=lastContentEditable)}},unwrap=function(start){var node=dom.get(start?"_start":"_end"),out=node[start?"firstChild":"lastChild"];return isRemoveBookmarkNode(out)&&(out=out[start?"firstChild":"lastChild"]),NodeType.isText(out)&&0===out.data.length&&(out=start?node.previousSibling||node.nextSibling:node.nextSibling||node.previousSibling),dom.remove(node,!0),out},removeRngStyle=function(rng){var startContainer,endContainer,commonAncestorContainer=rng.commonAncestorContainer,expandedRng=expandRng(ed,rng,formatList,!0);if(format.split){if(expandedRng=split$1(expandedRng),startContainer=getContainer(ed,expandedRng,!0),endContainer=getContainer(ed,expandedRng),startContainer!==endContainer){if(/^(TR|TH|TD)$/.test(startContainer.nodeName)&&startContainer.firstChild&&(startContainer="TR"===startContainer.nodeName?startContainer.firstChild.firstChild||startContainer:startContainer.firstChild||startContainer),commonAncestorContainer&&/^T(HEAD|BODY|FOOT|R)$/.test(commonAncestorContainer.nodeName)&&isTableCell$3(endContainer)&&endContainer.firstChild&&(endContainer=endContainer.firstChild||endContainer),isChildOfInlineParent(dom,startContainer,endContainer)){var marker=Option.from(startContainer.firstChild).getOr(startContainer);return splitToFormatRoot(wrapWithSiblings(dom,marker,!0,"span",{id:"_start","data-mce-type":"bookmark"})),void unwrap(!0)}if(isChildOfInlineParent(dom,endContainer,startContainer)){var marker=Option.from(endContainer.lastChild).getOr(endContainer);return splitToFormatRoot(wrapWithSiblings(dom,marker,!1,"span",{id:"_end","data-mce-type":"bookmark"})),void unwrap(!1)}startContainer=wrap$3(dom,startContainer,"span",{id:"_start","data-mce-type":"bookmark"}),endContainer=wrap$3(dom,endContainer,"span",{id:"_end","data-mce-type":"bookmark"});var newRng=dom.createRng();newRng.setStartAfter(startContainer),newRng.setEndBefore(endContainer),RangeWalk.walk(dom,newRng,function(nodes){each(nodes,function(n){Bookmarks.isBookmarkNode(n)||Bookmarks.isBookmarkNode(n.parentNode)||splitToFormatRoot(n)})}),splitToFormatRoot(startContainer),splitToFormatRoot(endContainer),startContainer=unwrap(!0),endContainer=unwrap()}else startContainer=endContainer=splitToFormatRoot(startContainer);expandedRng.startContainer=startContainer.parentNode?startContainer.parentNode:startContainer,expandedRng.startOffset=dom.nodeIndex(startContainer),expandedRng.endContainer=endContainer.parentNode?endContainer.parentNode:endContainer,expandedRng.endOffset=dom.nodeIndex(endContainer)+1}RangeWalk.walk(dom,expandedRng,function(nodes){each$b(nodes,function(node){process(node),NodeType.isElement(node)&&"underline"===ed.dom.getStyle(node,"text-decoration")&&node.parentNode&&"underline"===getTextDecoration(dom,node.parentNode)&&removeFormat(ed,{deep:!1,exact:!0,inline:"span",styles:{textDecoration:"underline"}},null,node)})})};if(node)return void(isNode(node)?(rng=dom.createRng(),rng.setStartBefore(node),rng.setEndAfter(node),removeRngStyle(rng)):removeRngStyle(node));if("false"!==dom.getContentEditable(selection.getNode()))selection.isCollapsed()&&format.inline&&!dom.select("td[data-mce-selected],th[data-mce-selected]").length?removeCaretFormat(ed,name,vars,similar):(bookmark=GetBookmark.getPersistentBookmark(ed.selection,!0),removeRngStyle(selection.getRng()),selection.moveToBookmark(bookmark),format.inline&&match(ed,name,vars,selection.getStart())&&moveStart(dom,selection,selection.getRng()),ed.nodeChanged());else{node=selection.getNode();for(var i=0,l=formatList.length;i<l&&(!formatList[i].ceFalseOverride||!removeFormat(ed,formatList[i],vars,node,node));i++);}},each$c=Tools.each,isElementNode=function(node){return NodeType.isElement(node)&&!Bookmarks.isBookmarkNode(node)&&!isCaretNode(node)&&!NodeType.isBogus(node)},findElementSibling=function(node,siblingName){var sibling;for(sibling=node;sibling;sibling=sibling[siblingName]){if(NodeType.isText(sibling)&&0!==sibling.nodeValue.length)return node;if(NodeType.isElement(sibling)&&!Bookmarks.isBookmarkNode(sibling))return sibling}return node},mergeSiblingsNodes=function(dom,prev,next){var sibling,tmpSibling,elementUtils=new ElementUtils(dom);if(prev&&next&&(prev=findElementSibling(prev,"previousSibling"),next=findElementSibling(next,"nextSibling"),elementUtils.compare(prev,next))){for(sibling=prev.nextSibling;sibling&&sibling!==next;)tmpSibling=sibling,sibling=sibling.nextSibling,prev.appendChild(tmpSibling);return dom.remove(next),Tools.each(Tools.grep(next.childNodes),function(node){prev.appendChild(node)}),prev}return next},processChildElements=function(node,filter,process){each$c(node.childNodes,function(node){isElementNode(node)&&(filter(node)&&process(node),node.hasChildNodes()&&processChildElements(node,filter,process))})},hasStyle=function(dom,name){return curry(function(name,node){return!(!node||!getStyle(dom,node,name))},name)},applyStyle=function(dom,name,value){return curry(function(name,value,node){dom.setStyle(node,name,value),""===node.getAttribute("style")&&node.removeAttribute("style"),unwrapEmptySpan(dom,node)},name,value)},unwrapEmptySpan=function(dom,node){"SPAN"===node.nodeName&&0===dom.getAttribs(node).length&&dom.remove(node,!0)},processUnderlineAndColor=function(dom,node){var textDecoration;1===node.nodeType&&node.parentNode&&1===node.parentNode.nodeType&&(textDecoration=getTextDecoration(dom,node.parentNode),dom.getStyle(node,"color")&&textDecoration?dom.setStyle(node,"text-decoration",textDecoration):dom.getStyle(node,"text-decoration")===textDecoration&&dom.setStyle(node,"text-decoration",null))},mergeUnderlineAndColor=function(dom,format,vars,node){(format.styles.color||format.styles.textDecoration)&&(Tools.walk(node,curry(processUnderlineAndColor,dom),"childNodes"),processUnderlineAndColor(dom,node))},mergeBackgroundColorAndFontSize=function(dom,format,vars,node){format.styles&&format.styles.backgroundColor&&processChildElements(node,hasStyle(dom,"fontSize"),applyStyle(dom,"backgroundColor",replaceVars(format.styles.backgroundColor,vars)))},mergeSubSup=function(dom,format,vars,node){"sub"!==format.inline&&"sup"!==format.inline||(processChildElements(node,hasStyle(dom,"fontSize"),applyStyle(dom,"fontSize","")),dom.remove(dom.select("sup"===format.inline?"sub":"sup",node),!0))},mergeSiblings=function(dom,format,vars,node){node&&!1!==format.merge_siblings&&(node=mergeSiblingsNodes(dom,getNonWhiteSpaceSibling(node),node),node=mergeSiblingsNodes(dom,node,getNonWhiteSpaceSibling(node,!0)))},clearChildStyles=function(dom,format,node){if(format.clear_child_styles){var selector=format.links?"*:not(a)":"*";each$c(dom.select(selector,node),function(node){isElementNode(node)&&each$c(format.styles,function(value,name){dom.setStyle(node,name,"")})})}},mergeWithChildren=function(editor,formatList,vars,node){each$c(formatList,function(format){each$c(editor.dom.select(format.inline,node),function(child){isElementNode(child)&&removeFormat(editor,format,vars,child,format.exact?child:null)}),clearChildStyles(editor.dom,format,node)})},mergeWithParents=function(editor,format,name,vars,node){matchNode(editor,node.parentNode,name,vars)&&removeFormat(editor,format,vars,node)||format.merge_with_parents&&editor.dom.getParent(node.parentNode,function(parent){if(matchNode(editor,parent,name,vars))return removeFormat(editor,format,vars,node),!0})},createRange$1=function(sc,so,ec,eo){var rng=domGlobals.document.createRange();return rng.setStart(sc,so),rng.setEnd(ec,eo),rng},normalizeBlockSelectionRange=function(rng){var startPos=CaretPosition$1.fromRangeStart(rng),endPos=CaretPosition$1.fromRangeEnd(rng),rootNode=rng.commonAncestorContainer;return CaretFinder.fromPosition(!1,rootNode,endPos).map(function(newEndPos){return!isInSameBlock(startPos,endPos,rootNode)&&isInSameBlock(startPos,newEndPos,rootNode)?createRange$1(startPos.container(),startPos.offset(),newEndPos.container(),newEndPos.offset()):rng}).getOr(rng)},normalize$2=function(rng){return rng.collapsed?rng:normalizeBlockSelectionRange(rng)},RangeNormalizer={normalize:normalize$2},each$d=Tools.each,isElementNode$1=function(node){return node&&1===node.nodeType&&!Bookmarks.isBookmarkNode(node)&&!isCaretNode(node)&&!NodeType.isBogus(node)},applyFormat=function(ed,name,vars,node){var bookmark,rng,formatList=ed.formatter.get(name),format=formatList[0],isCollapsed=!node&&ed.selection.isCollapsed(),dom=ed.dom,selection=ed.selection,setElementFormat=function(elm,fmt){if(fmt=fmt||format,elm){if(fmt.onformat&&fmt.onformat(elm,fmt,vars,node),each$d(fmt.styles,function(value,name){dom.setStyle(elm,name,replaceVars(value,vars))}),fmt.styles){var styleVal=dom.getAttrib(elm,"style");styleVal&&dom.setAttrib(elm,"data-mce-style",styleVal)}each$d(fmt.attributes,function(value,name){dom.setAttrib(elm,name,replaceVars(value,vars))}),each$d(fmt.classes,function(value){value=replaceVars(value,vars),dom.hasClass(elm,value)||dom.addClass(elm,value)})}},applyNodeStyle=function(formatList,node){var found=!1;return!!format.selector&&(each$d(formatList,function(format){if(!("collapsed"in format&&format.collapsed!==isCollapsed))return dom.is(node,format.selector)&&!isCaretNode(node)?(setElementFormat(node,format),found=!0,!1):void 0}),found)},applyRngStyle=function(dom,rng,bookmark,nodeSpecific){var wrapName,wrapElm,newWrappers=[],contentEditable=!0;wrapName=format.inline||format.block,wrapElm=dom.create(wrapName),setElementFormat(wrapElm),RangeWalk.walk(dom,rng,function(nodes){var currentWrapElm,process=function(node){var hasContentEditableState=!1,lastContentEditable=contentEditable,nodeName=node.nodeName.toLowerCase(),parentName=node.parentNode.nodeName.toLowerCase();if(NodeType.isElement(node)&&dom.getContentEditable(node)&&(lastContentEditable=contentEditable,contentEditable="true"===dom.getContentEditable(node),hasContentEditableState=!0),isEq(nodeName,"br"))return currentWrapElm=0,void(format.block&&dom.remove(node));if(format.wrapper&&matchNode(ed,node,name,vars))return void(currentWrapElm=0);if(contentEditable&&!hasContentEditableState&&format.block&&!format.wrapper&&isTextBlock$1(ed,nodeName)&&isValid(ed,parentName,wrapName))return node=dom.rename(node,wrapName),setElementFormat(node),newWrappers.push(node),void(currentWrapElm=0);if(format.selector){var found=applyNodeStyle(formatList,node);if(!format.inline||found)return void(currentWrapElm=0)}!contentEditable||hasContentEditableState||!isValid(ed,wrapName,nodeName)||!isValid(ed,parentName,wrapName)||!nodeSpecific&&3===node.nodeType&&1===node.nodeValue.length&&65279===node.nodeValue.charCodeAt(0)||isCaretNode(node)||format.inline&&dom.isBlock(node)?(currentWrapElm=0,each$d(Tools.grep(node.childNodes),process),hasContentEditableState&&(contentEditable=lastContentEditable),currentWrapElm=0):(currentWrapElm||(currentWrapElm=dom.clone(wrapElm,!1),node.parentNode.insertBefore(currentWrapElm,node),newWrappers.push(currentWrapElm)),currentWrapElm.appendChild(node))};each$d(nodes,process)}),!0===format.links&&each$d(newWrappers,function(node){var process=function(node){"A"===node.nodeName&&setElementFormat(node,format),each$d(Tools.grep(node.childNodes),process)};process(node)}),each$d(newWrappers,function(node){var childCount,getChildElementNode=function(root){var child=!1;return each$d(root.childNodes,function(node){if(isElementNode$1(node))return child=node,!1}),child};if(childCount=function(node){var count=0;return each$d(node.childNodes,function(node){isEmptyTextNode(node)||Bookmarks.isBookmarkNode(node)||count++}),count}(node),(newWrappers.length>1||!dom.isBlock(node))&&0===childCount)return void dom.remove(node,!0);(format.inline||format.wrapper)&&(format.exact||1!==childCount||(node=function(node){var child,clone;return child=getChildElementNode(node),child&&!Bookmarks.isBookmarkNode(child)&&matchName(dom,child,format)&&(clone=dom.clone(child,!1),setElementFormat(clone),dom.replace(clone,node,!0),dom.remove(child,!0)),clone||node}(node)),mergeWithChildren(ed,formatList,vars,node),mergeWithParents(ed,format,name,vars,node),mergeBackgroundColorAndFontSize(dom,format,vars,node),mergeSubSup(dom,format,0,node),mergeSiblings(dom,format,0,node))})};if("false"!==dom.getContentEditable(selection.getNode())){if(format){if(node)isNode(node)?applyNodeStyle(formatList,node)||(rng=dom.createRng(),rng.setStartBefore(node),rng.setEndAfter(node),applyRngStyle(dom,expandRng(ed,rng,formatList),0,!0)):applyRngStyle(dom,node,0,!0);else if(isCollapsed&&format.inline&&!dom.select("td[data-mce-selected],th[data-mce-selected]").length)applyCaretFormat(ed,name,vars);else{var curSelNode=ed.selection.getNode();ed.settings.forced_root_block||!formatList[0].defaultBlock||dom.getParent(curSelNode,dom.isBlock)||applyFormat(ed,formatList[0].defaultBlock),ed.selection.setRng(RangeNormalizer.normalize(ed.selection.getRng())),bookmark=GetBookmark.getPersistentBookmark(ed.selection,!0),applyRngStyle(dom,expandRng(ed,selection.getRng(),formatList)),format.styles&&mergeUnderlineAndColor(dom,format,0,curSelNode),selection.moveToBookmark(bookmark),moveStart(dom,selection,selection.getRng()),ed.nodeChanged()}postProcess$1(name,ed)}}else{node=selection.getNode();for(var i=0,l=formatList.length;i<l;i++)if(formatList[i].ceFalseOverride&&dom.is(node,formatList[i].selector))return void setElementFormat(node,formatList[i])}},setup$4=function(registeredFormatListeners,editor){var currentFormats=Cell({});registeredFormatListeners.set({}),editor.on("NodeChange",function(e){updateAndFireChangeCallbacks(editor,e.element,currentFormats,registeredFormatListeners.get())})},updateAndFireChangeCallbacks=function(editor,elm,currentFormats,formatChangeData){var formatsList=keys(currentFormats.get()),newFormats={},matchedFormats={},parents=filter(getParents$1(editor.dom,elm),function(node){return 1===node.nodeType&&!node.getAttribute("data-mce-bogus")});each$1(formatChangeData,function(data,format){Tools.each(parents,function(node){return editor.formatter.matchNode(node,format,{},data.similar)?(-1===formatsList.indexOf(format)&&(each(data.callbacks,function(callback){callback(!0,{node:node,format:format,parents:parents})}),newFormats[format]=data.callbacks),matchedFormats[format]=data.callbacks,!1):!matchesUnInheritedFormatSelector(editor,node,format)&&void 0})});var remainingFormats=filterRemainingFormats(currentFormats.get(),matchedFormats,elm,parents);currentFormats.set(__assign(__assign({},newFormats),remainingFormats))},filterRemainingFormats=function(currentFormats,matchedFormats,elm,parents){return bifilter(currentFormats,function(callbacks,format){return!!has(matchedFormats,format)||(each(callbacks,function(callback){callback(!1,{node:elm,format:format,parents:parents})}),!1)}).t},addListeners=function(registeredFormatListeners,formats,callback,similar){var formatChangeItems=registeredFormatListeners.get();each(formats.split(","),function(format){formatChangeItems[format]||(formatChangeItems[format]={similar:similar,callbacks:[]}),formatChangeItems[format].callbacks.push(callback)}),registeredFormatListeners.set(formatChangeItems)},removeListeners=function(registeredFormatListeners,formats,callback){var formatChangeItems=registeredFormatListeners.get();each(formats.split(","),function(format){formatChangeItems[format].callbacks=filter(formatChangeItems[format].callbacks,function(c){return c!==callback}),0===formatChangeItems[format].callbacks.length&&delete formatChangeItems[format]}),registeredFormatListeners.set(formatChangeItems)},formatChanged=function(editor,registeredFormatListeners,formats,callback,similar){return null===registeredFormatListeners.get()&&setup$4(registeredFormatListeners,editor),addListeners(registeredFormatListeners,formats,callback,similar),{unbind:function(){return removeListeners(registeredFormatListeners,formats,callback)}}},get$9=function(dom){var formats={valigntop:[{selector:"td,th",styles:{verticalAlign:"top"}}],valignmiddle:[{selector:"td,th",styles:{verticalAlign:"middle"}}],valignbottom:[{selector:"td,th",styles:{verticalAlign:"bottom"}}],alignleft:[{selector:"figure.image",collapsed:!1,classes:"align-left",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"left"},inherit:!1,preview:!1,defaultBlock:"div"},{selector:"img,table",collapsed:!1,styles:{float:"left"},preview:"font-family font-size"}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"center"},inherit:!1,preview:"font-family font-size",defaultBlock:"div"},{selector:"figure.image",collapsed:!1,classes:"align-center",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"img",collapsed:!1,styles:{display:"block",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"},preview:"font-family font-size"}],alignright:[{selector:"figure.image",collapsed:!1,classes:"align-right",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"right"},inherit:!1,preview:"font-family font-size",defaultBlock:"div"},{selector:"img,table",collapsed:!1,styles:{float:"right"},preview:"font-family font-size"}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"justify"},inherit:!1,defaultBlock:"div",preview:"font-family font-size"}],bold:[{inline:"strong",remove:"all"},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all"}],italic:[{inline:"em",remove:"all"},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all"}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all"}],strikethrough:[{inline:"span",styles:{textDecoration:"line-through"},exact:!0},{inline:"strike",remove:"all"}],forecolor:{inline:"span",styles:{color:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},fontname:{inline:"span",toggle:!1,styles:{fontFamily:"%value"},clear_child_styles:!0},fontsize:{inline:"span",toggle:!1,styles:{fontSize:"%value"},clear_child_styles:!0},fontsize_class:{inline:"span",attributes:{class:"%value"}},blockquote:{block:"blockquote",wrapper:!0,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:function(){return!0},onformat:function(elm,fmt,vars){Tools.each(vars,function(value,key){dom.setAttrib(elm,key,value)})}},removeformat:[{selector:"b,strong,em,i,font,u,strike,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]};return Tools.each("p h1 h2 h3 h4 h5 h6 div address pre div dt dd samp".split(/\s/),function(name){formats[name]={block:name,remove:"all"}}),formats},DefaultFormats={get:get$9},each$e=Tools.each,dom=DOMUtils$1.DOM,parsedSelectorToHtml=function(ancestry,editor){var elm,item,fragment,schema=editor&&editor.schema||Schema({}),decorate=function(elm,item){item.classes.length&&dom.addClass(elm,item.classes.join(" ")),dom.setAttribs(elm,item.attrs)},createElement=function(sItem){var elm;return item="string"==typeof sItem?{name:sItem,classes:[],attrs:{}}:sItem,elm=dom.create(item.name),decorate(elm,item),elm},getRequiredParent=function(elm,candidate){var name="string"!=typeof elm?elm.nodeName.toLowerCase():elm,elmRule=schema.getElementRule(name),parentsRequired=elmRule&&elmRule.parentsRequired;return!(!parentsRequired||!parentsRequired.length)&&(candidate&&-1!==Tools.inArray(parentsRequired,candidate)?candidate:parentsRequired[0])},wrapInHtml=function(elm,ancestry,siblings){var parent,parentCandidate,parentRequired,ancestor=ancestry.length>0&&ancestry[0],ancestorName=ancestor&&ancestor.name;if(parentRequired=getRequiredParent(elm,ancestorName))ancestorName===parentRequired?(parentCandidate=ancestry[0],ancestry=ancestry.slice(1)):parentCandidate=parentRequired;else if(ancestor)parentCandidate=ancestry[0],ancestry=ancestry.slice(1);else if(!siblings)return elm;return parentCandidate&&(parent=createElement(parentCandidate),parent.appendChild(elm)),siblings&&(parent||(parent=dom.create("div"),parent.appendChild(elm)),Tools.each(siblings,function(sibling){var siblingElm=createElement(sibling);parent.insertBefore(siblingElm,elm)})),wrapInHtml(parent,ancestry,parentCandidate&&parentCandidate.siblings)};return ancestry&&ancestry.length?(item=ancestry[0],elm=createElement(item),fragment=dom.create("div"),fragment.appendChild(wrapInHtml(elm,ancestry.slice(1),item.siblings)),fragment):""},parseSelectorItem=function(item){var tagName,obj={classes:[],attrs:{}};return item=obj.selector=Tools.trim(item),"*"!==item&&(tagName=item.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g,function($0,$1,$2,$3,$4){switch($1){case"#":obj.attrs.id=$2;break;case".":obj.classes.push($2);break;case":":-1!==Tools.inArray("checked disabled enabled read-only required".split(" "),$2)&&(obj.attrs[$2]=$2)}if("["===$3){var m=$4.match(/([\w\-]+)(?:\=\"([^\"]+))?/);m&&(obj.attrs[m[1]]=m[2])}return""})),obj.name=tagName||"div",obj},parseSelector=function(selector){return selector&&"string"==typeof selector?(selector=selector.split(/\s*,\s*/)[0],selector=selector.replace(/\s*(~\+|~|\+|>)\s*/g,"$1"),Tools.map(selector.split(/(?:>|\s+(?![^\[\]]+\]))/),function(item){var siblings=Tools.map(item.split(/(?:~\+|~|\+)/),parseSelectorItem),obj=siblings.pop();return siblings.length&&(obj.siblings=siblings),obj}).reverse()):[]},getCssText=function(editor,format){var name,previewFrag,previewElm,items,parentFontSize,previewStyles,previewCss="";if(!1===(previewStyles=editor.settings.preview_styles))return"";"string"!=typeof previewStyles&&(previewStyles="font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow");var removeVars=function(val){return val.replace(/%(\w+)/g,"")};if("string"==typeof format){if(!(format=editor.formatter.get(format)))return;format=format[0]}return"preview"in format&&!1===(previewStyles=format.preview)?"":(name=format.block||format.inline||"span",items=parseSelector(format.selector),items.length?(items[0].name||(items[0].name=name),name=format.selector,previewFrag=parsedSelectorToHtml(items,editor)):previewFrag=parsedSelectorToHtml([name],editor),previewElm=dom.select(name,previewFrag)[0]||previewFrag.firstChild,each$e(format.styles,function(value,name){(value=removeVars(value))&&dom.setStyle(previewElm,name,value)}),each$e(format.attributes,function(value,name){(value=removeVars(value))&&dom.setAttrib(previewElm,name,value)}),each$e(format.classes,function(value){value=removeVars(value),dom.hasClass(previewElm,value)||dom.addClass(previewElm,value)}),editor.fire("PreviewFormats"),dom.setStyles(previewFrag,{position:"absolute",left:-65535}),editor.getBody().appendChild(previewFrag),parentFontSize=dom.getStyle(editor.getBody(),"fontSize",!0),parentFontSize=/px$/.test(parentFontSize)?parseInt(parentFontSize,10):0,each$e(previewStyles.split(" "),function(name){var value=dom.getStyle(previewElm,name,!0);if(!("background-color"===name&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(value)&&(value=dom.getStyle(editor.getBody(),name,!0),"#ffffff"===dom.toHex(value).toLowerCase())||"color"===name&&"#000000"===dom.toHex(value).toLowerCase())){if("font-size"===name&&/em|%$/.test(value)){if(0===parentFontSize)return;value=parseFloat(value)/(/%$/.test(value)?100:1)*parentFontSize+"px"}"border"===name&&value&&(previewCss+="padding:0 2px;"),previewCss+=name+":"+value+";"}}),editor.fire("AfterPreviewFormats"),dom.remove(previewFrag),previewCss)},toggle=function(editor,formats,name,vars,node){var fmt=formats.get(name);!match(editor,name,vars,node)||"toggle"in fmt[0]&&!fmt[0].toggle?applyFormat(editor,name,vars,node):remove$7(editor,name,vars,node)},setup$5=function(editor){editor.addShortcut("meta+b","","Bold"),editor.addShortcut("meta+i","","Italic"),editor.addShortcut("meta+u","","Underline");for(var i=1;i<=6;i++)editor.addShortcut("access+"+i,"",["FormatBlock",!1,"h"+i]);editor.addShortcut("access+7","",["FormatBlock",!1,"p"]),editor.addShortcut("access+8","",["FormatBlock",!1,"div"]),editor.addShortcut("access+9","",["FormatBlock",!1,"address"])},FormatShortcuts={setup:setup$5},Formatter=function(editor){var formats=FormatRegistry(editor),formatChangeState=Cell(null);return FormatShortcuts.setup(editor),setup$3(editor),{get:formats.get,has:formats.has,register:formats.register,unregister:formats.unregister,apply:curry(applyFormat,editor),remove:curry(remove$7,editor),toggle:curry(toggle,editor,formats),match:curry(match,editor),matchAll:curry(matchAll,editor),matchNode:curry(matchNode,editor),canApply:curry(canApply,editor),formatChanged:curry(formatChanged,editor,formatChangeState),getCssText:curry(getCssText,editor)}},diff=function(left,right){var size=left.length+right.length+2,vDown=new Array(size),vUp=new Array(size),snake=function(start,end,diag){return{start:start,end:end,diag:diag}},buildScript=function(start1,end1,start2,end2,script){var middle=getMiddleSnake(start1,end1,start2,end2);if(null===middle||middle.start===end1&&middle.diag===end1-end2||middle.end===start1&&middle.diag===start1-start2)for(var i=start1,j=start2;i<end1||j<end2;)i<end1&&j<end2&&left[i]===right[j]?(script.push([0,left[i]]),++i,++j):end1-start1>end2-start2?(script.push([2,left[i]]),++i):(script.push([1,right[j]]),++j);else{buildScript(start1,middle.start,start2,middle.start-middle.diag,script);for(var i2=middle.start;i2<middle.end;++i2)script.push([0,left[i2]]);buildScript(middle.end,end1,middle.end-middle.diag,end2,script)}},buildSnake=function(start,diag,end1,end2){for(var end=start;end-diag<end2&&end<end1&&left[end]===right[end-diag];)++end;return snake(start,end,diag)},getMiddleSnake=function(start1,end1,start2,end2){var m=end1-start1,n=end2-start2;if(0===m||0===n)return null;var delta=m-n,sum=n+m,offset=(sum%2==0?sum:sum+1)/2;vDown[1+offset]=start1,vUp[1+offset]=end1+1;var d,k,i,x,y;for(d=0;d<=offset;++d){for(k=-d;k<=d;k+=2){for(i=k+offset,k===-d||k!==d&&vDown[i-1]<vDown[i+1]?vDown[i]=vDown[i+1]:vDown[i]=vDown[i-1]+1,x=vDown[i],y=x-start1+start2-k;x<end1&&y<end2&&left[x]===right[y];)vDown[i]=++x,++y;if(delta%2!=0&&delta-d<=k&&k<=delta+d&&vUp[i-delta]<=vDown[i])return buildSnake(vUp[i-delta],k+start1-start2,end1,end2)}for(k=delta-d;k<=delta+d;k+=2){for(i=k+offset-delta,k===delta-d||k!==delta+d&&vUp[i+1]<=vUp[i-1]?vUp[i]=vUp[i+1]-1:vUp[i]=vUp[i-1],x=vUp[i]-1,y=x-start1+start2-k;x>=start1&&y>=start2&&left[x]===right[y];)vUp[i]=x--,y--;if(delta%2==0&&-d<=k&&k<=d&&vUp[i]<=vDown[i+delta])return buildSnake(vUp[i],k+start1-start2,end1,end2)}}},script=[];return buildScript(0,left.length,0,right.length,script),script},Diff={KEEP:0,DELETE:2,INSERT:1,diff:diff},getOuterHtml=function(elm){return NodeType.isElement(elm)?elm.outerHTML:NodeType.isText(elm)?Entities.encodeRaw(elm.data,!1):NodeType.isComment(elm)?"\x3c!--"+elm.data+"--\x3e":""},createFragment$1=function(html){var frag,node,container;for(container=domGlobals.document.createElement("div"),frag=domGlobals.document.createDocumentFragment(),html&&(container.innerHTML=html);node=container.firstChild;)frag.appendChild(node);return frag},insertAt=function(elm,html,index){var fragment=createFragment$1(html);if(elm.hasChildNodes()&&index<elm.childNodes.length){var target=elm.childNodes[index];target.parentNode.insertBefore(fragment,target)}else elm.appendChild(fragment)},removeAt=function(elm,index){if(elm.hasChildNodes()&&index<elm.childNodes.length){var target=elm.childNodes[index];target.parentNode.removeChild(target)}},applyDiff=function(diff,elm){var index=0;each(diff,function(action){action[0]===Diff.KEEP?index++:action[0]===Diff.INSERT?(insertAt(elm,action[1],index),index++):action[0]===Diff.DELETE&&removeAt(elm,index)})},read$2=function(elm){return filter(map(from$1(elm.childNodes),getOuterHtml),function(item){return item.length>0})},write=function(fragments,elm){var currentFragments=map(from$1(elm.childNodes),getOuterHtml);return applyDiff(Diff.diff(currentFragments,fragments),elm),elm},Fragments={read:read$2,write:write},undoLevelDocument=Cell(Option.none()),lazyTempDocument=function(){return undoLevelDocument.get().getOrThunk(function(){var doc=domGlobals.document.implementation.createHTMLDocument("undo");return undoLevelDocument.set(Option.some(doc)),doc})},hasIframes=function(html){return-1!==html.indexOf("</iframe>")},createFragmentedLevel=function(fragments){return{type:"fragmented",fragments:fragments,content:"",bookmark:null,beforeBookmark:null}},createCompleteLevel=function(content){return{type:"complete",fragments:null,content:content,bookmark:null,beforeBookmark:null}},createFromEditor=function(editor){var fragments,content,trimmedFragments;return fragments=Fragments.read(editor.getBody()),trimmedFragments=bind(fragments,function(html){var trimmed=TrimHtml.trimInternal(editor.serializer,html);return trimmed.length>0?[trimmed]:[]}),content=trimmedFragments.join(""),hasIframes(content)?createFragmentedLevel(trimmedFragments):createCompleteLevel(content)},applyToEditor=function(editor,level,before){"fragmented"===level.type?Fragments.write(level.fragments,editor.getBody()):editor.setContent(level.content,{format:"raw"}),editor.selection.moveToBookmark(before?level.beforeBookmark:level.bookmark)},getLevelContent=function(level){return"fragmented"===level.type?level.fragments.join(""):level.content},getCleanLevelContent=function(level){var elm=Element.fromTag("body",lazyTempDocument());return set$1(elm,getLevelContent(level)),each(descendants$1(elm,"*[data-mce-bogus]"),unwrap),get$6(elm)},hasEqualContent=function(level1,level2){return getLevelContent(level1)===getLevelContent(level2)},hasEqualCleanedContent=function(level1,level2){return getCleanLevelContent(level1)===getCleanLevelContent(level2)},isEq$4=function(level1,level2){return!(!level1||!level2)&&(!!hasEqualContent(level1,level2)||hasEqualCleanedContent(level1,level2))},Levels={createFragmentedLevel:createFragmentedLevel,createCompleteLevel:createCompleteLevel,createFromEditor:createFromEditor,applyToEditor:applyToEditor,isEq:isEq$4},isUnlocked=function(locks){return 0===locks.get()},setTyping=function(undoManager,typing,locks){isUnlocked(locks)&&(undoManager.typing=typing)},endTyping=function(undoManager,locks){undoManager.typing&&(setTyping(undoManager,!1,locks),undoManager.add())},endTypingLevelIgnoreLocks=function(undoManager){undoManager.typing&&(undoManager.typing=!1,undoManager.add())},beforeChange=function(editor,locks,beforeBookmark){isUnlocked(locks)&&beforeBookmark.set(Option.some(GetBookmark.getUndoBookmark(editor.selection)))},addUndoLevel=function(editor,undoManager,index,locks,beforeBookmark,level,event){var settings=editor.settings,currentLevel=Levels.createFromEditor(editor);if(level=level||{},level=Tools.extend(level,currentLevel),!1===isUnlocked(locks)||editor.removed)return null;var lastLevel=undoManager.data[index.get()];if(editor.fire("BeforeAddUndo",{level:level,lastLevel:lastLevel,originalEvent:event}).isDefaultPrevented())return null;if(lastLevel&&Levels.isEq(lastLevel,level))return null;if(undoManager.data[index.get()]&&beforeBookmark.get().each(function(bm){undoManager.data[index.get()].beforeBookmark=bm}),settings.custom_undo_redo_levels&&undoManager.data.length>settings.custom_undo_redo_levels){for(var i=0;i<undoManager.data.length-1;i++)undoManager.data[i]=undoManager.data[i+1];undoManager.data.length--,index.set(undoManager.data.length)}level.bookmark=GetBookmark.getUndoBookmark(editor.selection),index.get()<undoManager.data.length-1&&(undoManager.data.length=index.get()+1),undoManager.data.push(level),index.set(undoManager.data.length-1);var args={level:level,lastLevel:lastLevel,originalEvent:event};return editor.fire("AddUndo",args),index.get()>0&&(editor.setDirty(!0),editor.fire("change",args)),level},clear=function(editor,undoManager,index){undoManager.data=[],index.set(0),undoManager.typing=!1,editor.fire("ClearUndos")},extra=function(editor,undoManager,index,callback1,callback2){if(undoManager.transact(callback1)){var bookmark=undoManager.data[index.get()].bookmark,lastLevel=undoManager.data[index.get()-1];Levels.applyToEditor(editor,lastLevel,!0),undoManager.transact(callback2)&&(undoManager.data[index.get()-1].beforeBookmark=bookmark)}},redo=function(editor,index,data){var level;return index.get()<data.length-1&&(index.set(index.get()+1),level=data[index.get()],Levels.applyToEditor(editor,level,!1),editor.setDirty(!0),editor.fire("Redo",{level:level})),level},undo=function(editor,undoManager,locks,index){var level;return undoManager.typing&&(undoManager.add(),undoManager.typing=!1,setTyping(undoManager,!1,locks)),index.get()>0&&(index.set(index.get()-1),level=undoManager.data[index.get()],Levels.applyToEditor(editor,level,!0),editor.setDirty(!0),editor.fire("Undo",{level:level})),level},reset=function(undoManager){undoManager.clear(),undoManager.add()},hasUndo=function(editor,undoManager,index){return index.get()>0||undoManager.typing&&undoManager.data[0]&&!Levels.isEq(Levels.createFromEditor(editor),undoManager.data[0])},hasRedo=function(undoManager,index){return index.get()<undoManager.data.length-1&&!undoManager.typing},transact=function(undoManager,locks,callback){return endTyping(undoManager,locks),undoManager.beforeChange(),undoManager.ignore(callback),undoManager.add()},ignore=function(locks,callback){try{locks.set(locks.get()+1),callback()}finally{locks.set(locks.get()-1)}},registerEvents$1=function(editor,undoManager,locks){var isFirstTypedCharacter=Cell(!1),addNonTypingUndoLevel=function(e){setTyping(undoManager,!1,locks),undoManager.add({},e)};editor.on("init",function(){undoManager.add()}),editor.on("BeforeExecCommand",function(e){var cmd=e.command;"Undo"!==cmd&&"Redo"!==cmd&&"mceRepaint"!==cmd&&(endTyping(undoManager,locks),undoManager.beforeChange())}),editor.on("ExecCommand",function(e){var cmd=e.command;"Undo"!==cmd&&"Redo"!==cmd&&"mceRepaint"!==cmd&&addNonTypingUndoLevel(e)}),editor.on("ObjectResizeStart cut",function(){undoManager.beforeChange()}),editor.on("SaveContent ObjectResized blur",addNonTypingUndoLevel),editor.on("dragend",addNonTypingUndoLevel),editor.on("keyup",function(e){var keyCode=e.keyCode;e.isDefaultPrevented()||((keyCode>=33&&keyCode<=36||keyCode>=37&&keyCode<=40||45===keyCode||e.ctrlKey)&&(addNonTypingUndoLevel(),editor.nodeChanged()),46!==keyCode&&8!==keyCode||editor.nodeChanged(),isFirstTypedCharacter.get()&&undoManager.typing&&!1===Levels.isEq(Levels.createFromEditor(editor),undoManager.data[0])&&(!1===editor.isDirty()&&(editor.setDirty(!0),editor.fire("change",{level:undoManager.data[0],lastLevel:null})),editor.fire("TypingUndo"),isFirstTypedCharacter.set(!1),editor.nodeChanged()))}),editor.on("keydown",function(e){var keyCode=e.keyCode;if(!e.isDefaultPrevented()){if(keyCode>=33&&keyCode<=36||keyCode>=37&&keyCode<=40||45===keyCode)return void(undoManager.typing&&addNonTypingUndoLevel(e));var modKey=e.ctrlKey&&!e.altKey||e.metaKey;!(keyCode<16||keyCode>20)||224===keyCode||91===keyCode||undoManager.typing||modKey||(undoManager.beforeChange(),setTyping(undoManager,!0,locks),undoManager.add({},e),isFirstTypedCharacter.set(!0))}}),editor.on("mousedown",function(e){undoManager.typing&&addNonTypingUndoLevel(e)});var isInsertReplacementText=function(event){return"insertReplacementText"===event.inputType},isInsertTextDataNull=function(event){return"insertText"===event.inputType&&null===event.data};editor.on("input",function(e){e.inputType&&(isInsertReplacementText(e)||isInsertTextDataNull(e))&&addNonTypingUndoLevel(e)}),editor.on("AddUndo Undo Redo ClearUndos",function(e){e.isDefaultPrevented()||editor.nodeChanged()})},addKeyboardShortcuts=function(editor){editor.addShortcut("meta+z","","Undo"),editor.addShortcut("meta+y,meta+shift+z","","Redo")},UndoManager=function(editor){var beforeBookmark=Cell(Option.none()),locks=Cell(0),index=Cell(0),undoManager={data:[],typing:!1,beforeChange:function(){beforeChange(editor,locks,beforeBookmark)},add:function(level,event){return addUndoLevel(editor,undoManager,index,locks,beforeBookmark,level,event)},undo:function(){return undo(editor,undoManager,locks,index)},redo:function(){return redo(editor,index,undoManager.data)},clear:function(){clear(editor,undoManager,index)},reset:function(){reset(undoManager)},hasUndo:function(){return hasUndo(editor,undoManager,index)},hasRedo:function(){return hasRedo(undoManager,index)},transact:function(callback){return transact(undoManager,locks,callback)},ignore:function(callback){ignore(locks,callback)},extra:function(callback1,callback2){extra(editor,undoManager,index,callback1,callback2)}};return registerEvents$1(editor,undoManager,locks),addKeyboardShortcuts(editor),undoManager},nonTypingKeycodes=[9,27,VK.HOME,VK.END,19,20,44,144,145,33,34,45,16,17,18,91,92,93,VK.DOWN,VK.UP,VK.LEFT,VK.RIGHT].concat(Env.browser.isFirefox()?[224]:[]),isKeyboardEvent=function(e){return"keydown"===e.type||"keyup"===e.type},isDeleteEvent=function(e){var keyCode=e.keyCode;return keyCode===VK.BACKSPACE||keyCode===VK.DELETE},isNonTypingKeyboardEvent=function(e){if(isKeyboardEvent(e)){var keyCode=e.keyCode;return!isDeleteEvent(e)&&(VK.metaKeyPressed(e)||e.altKey||keyCode>=112&&keyCode<=123||contains(nonTypingKeycodes,keyCode))}return!1},isTypingKeyboardEvent=function(e){return isKeyboardEvent(e)&&!(isDeleteEvent(e)||"keyup"===e.type&&229===e.keyCode)},isVisuallyEmpty=function(dom,rootElm,forcedRootBlock){if(Empty.isEmpty(Element.fromDom(rootElm),!1)){var isForcedRootBlockFalse=""===forcedRootBlock,firstElement=rootElm.firstElementChild;return!firstElement||!dom.getStyle(rootElm.firstElementChild,"padding-left")&&!dom.getStyle(rootElm.firstElementChild,"padding-right")&&(isForcedRootBlockFalse?!dom.isBlock(firstElement):forcedRootBlock===firstElement.nodeName.toLowerCase())}return!1},setup$6=function(editor){var dom=editor.dom,rootBlock=Settings.getForcedRootBlock(editor),placeholder=Settings.getPlaceholder(editor),updatePlaceholder=function(e,initial){if(!isNonTypingKeyboardEvent(e)){var body=editor.getBody(),showPlaceholder=!isTypingKeyboardEvent(e)&&isVisuallyEmpty(dom,body,rootBlock);(""!==dom.getAttrib(body,"data-mce-placeholder")!==showPlaceholder||initial)&&(dom.setAttrib(body,"data-mce-placeholder",showPlaceholder?placeholder:null),dom.setAttrib(body,"aria-placeholder",showPlaceholder?placeholder:null),firePlaceholderToggle(editor,showPlaceholder),editor.on(showPlaceholder?"keydown":"keyup",updatePlaceholder),editor.off(showPlaceholder?"keyup":"keydown",updatePlaceholder))}};placeholder&&editor.on("init",function(e){updatePlaceholder(e,!0),editor.on("change SetContent ExecCommand",updatePlaceholder),editor.on("remove",function(){var body=editor.getBody();dom.setAttrib(body,"data-mce-placeholder",null),dom.setAttrib(body,"aria-placeholder",null)})})},getTouch=function(event){return void 0===event.touches||1!==event.touches.length?Option.none():Option.some(event.touches[0])},isFarEnough=function(touch,data){var distX=Math.abs(touch.clientX-data.x()),distY=Math.abs(touch.clientY-data.y());return distX>5||distY>5},setup$7=function(editor){var startData=Cell(Option.none()),longpressFired=Cell(!1),debounceLongpress=last$2(function(e){editor.fire("longpress",__assign(__assign({},e),{type:"longpress"})),longpressFired.set(!0)},400);editor.on("touchstart",function(e){getTouch(e).each(function(touch){debounceLongpress.cancel();var data={x:constant(touch.clientX),y:constant(touch.clientY),target:constant(e.target)};debounceLongpress.throttle(e),longpressFired.set(!1),startData.set(Option.some(data))})},!0),editor.on("touchmove",function(e){debounceLongpress.cancel(),getTouch(e).each(function(touch){startData.get().each(function(data){isFarEnough(touch,data)&&(startData.set(Option.none()),longpressFired.set(!1),editor.fire("longpresscancel"))})})},!0),editor.on("touchend touchcancel",function(e){debounceLongpress.cancel(),"touchcancel"!==e.type&&startData.get().filter(function(data){return data.target().isEqualNode(e.target)}).each(function(){longpressFired.get()?e.preventDefault():editor.fire("tap",__assign(__assign({},e),{type:"tap"}))})},!0)},TouchEvents={setup:setup$7},isBlockElement=function(blockElements,node){return blockElements.hasOwnProperty(node.nodeName)},isValidTarget=function(blockElements,node){return!!NodeType.isText(node)||!!NodeType.isElement(node)&&(!isBlockElement(blockElements,node)&&!Bookmarks.isBookmarkNode(node))},hasBlockParent=function(blockElements,root,node){return exists(Parents.parents(Element.fromDom(node),Element.fromDom(root)),function(elm){return isBlockElement(blockElements,elm.dom())})},shouldRemoveTextNode=function(blockElements,node){if(NodeType.isText(node)){if(0===node.nodeValue.length)return!0;if(/^\s+$/.test(node.nodeValue)&&(!node.nextSibling||isBlockElement(blockElements,node.nextSibling)))return!0}return!1},addRootBlocks=function(editor){var rng,startContainer,startOffset,endContainer,endOffset,rootBlockNode,tempNode,wrapped,restoreSelection,rootNodeName,dom=editor.dom,selection=editor.selection,schema=editor.schema,blockElements=schema.getBlockElements(),node=selection.getStart(),rootNode=editor.getBody(),forcedRootBlock=Settings.getForcedRootBlock(editor);if(node&&NodeType.isElement(node)&&forcedRootBlock&&(rootNodeName=rootNode.nodeName.toLowerCase(),schema.isValidChild(rootNodeName,forcedRootBlock.toLowerCase())&&!hasBlockParent(blockElements,rootNode,node))){for(rng=selection.getRng(),startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset,restoreSelection=EditorFocus.hasFocus(editor),node=rootNode.firstChild;node;)if(isValidTarget(blockElements,node)){if(shouldRemoveTextNode(blockElements,node)){tempNode=node,node=node.nextSibling,dom.remove(tempNode);continue}rootBlockNode||(rootBlockNode=dom.create(forcedRootBlock,Settings.getForcedRootBlockAttrs(editor)),node.parentNode.insertBefore(rootBlockNode,node),wrapped=!0),tempNode=node,node=node.nextSibling,rootBlockNode.appendChild(tempNode)}else rootBlockNode=null,node=node.nextSibling;wrapped&&restoreSelection&&(rng.setStart(startContainer,startOffset),rng.setEnd(endContainer,endOffset),selection.setRng(rng),editor.nodeChanged())}},setup$8=function(editor){Settings.getForcedRootBlock(editor)&&editor.on("NodeChange",curry(addRootBlocks,editor))},ForceBlocks={setup:setup$8},isText$8=NodeType.isText,startsWithCaretContainer$1=function(node){return isText$8(node)&&node.data[0]===Zwsp.ZWSP},endsWithCaretContainer$1=function(node){return isText$8(node)&&node.data[node.data.length-1]===Zwsp.ZWSP},createZwsp=function(node){return node.ownerDocument.createTextNode(Zwsp.ZWSP)},insertBefore=function(node){if(isText$8(node.previousSibling))return endsWithCaretContainer$1(node.previousSibling)?node.previousSibling:(node.previousSibling.appendData(Zwsp.ZWSP),node.previousSibling);if(isText$8(node))return startsWithCaretContainer$1(node)?node:(node.insertData(0,Zwsp.ZWSP),node);var newNode=createZwsp(node);return node.parentNode.insertBefore(newNode,node),newNode},insertAfter=function(node){if(isText$8(node.nextSibling))return startsWithCaretContainer$1(node.nextSibling)?node.nextSibling:(node.nextSibling.insertData(0,Zwsp.ZWSP),node.nextSibling);if(isText$8(node))return endsWithCaretContainer$1(node)?node:(node.appendData(Zwsp.ZWSP),node);var newNode=createZwsp(node);return node.nextSibling?node.parentNode.insertBefore(newNode,node.nextSibling):node.parentNode.appendChild(newNode),newNode},insertInline$1=function(before,node){return before?insertBefore(node):insertAfter(node)},insertInlineBefore=curry(insertInline$1,!0),insertInlineAfter=curry(insertInline$1,!1),insertInlinePos=function(pos,before){return NodeType.isText(pos.container())?insertInline$1(before,pos.container()):insertInline$1(before,pos.getNode())},isPosCaretContainer=function(pos,caret){var caretNode=caret.get();return caretNode&&pos.container()===caretNode&&isCaretContainerInline(caretNode)},renderCaret=function(caret,location){return location.fold(function(element){CaretContainerRemove.remove(caret.get());var text=insertInlineBefore(element);return caret.set(text),Option.some(CaretPosition$1(text,text.length-1))},function(element){return CaretFinder.firstPositionIn(element).map(function(pos){if(isPosCaretContainer(pos,caret))return CaretPosition$1(caret.get(),1);CaretContainerRemove.remove(caret.get());var text=insertInlinePos(pos,!0);return caret.set(text),CaretPosition$1(text,1)})},function(element){return CaretFinder.lastPositionIn(element).map(function(pos){if(isPosCaretContainer(pos,caret))return CaretPosition$1(caret.get(),caret.get().length-1);CaretContainerRemove.remove(caret.get());var text=insertInlinePos(pos,!1);return caret.set(text),CaretPosition$1(text,text.length-1)})},function(element){CaretContainerRemove.remove(caret.get());var text=insertInlineAfter(element);return caret.set(text),Option.some(CaretPosition$1(text,1))})},BoundaryCaret={renderCaret:renderCaret},strongRtl=/[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/,hasStrongRtl=function(text){return strongRtl.test(text)},isInlineTarget=function(editor,elm){return is(Element.fromDom(elm),Settings.getInlineBoundarySelector(editor))},isRtl$1=function(element){return"rtl"===DOMUtils$1.DOM.getStyle(element,"direction",!0)||hasStrongRtl(element.textContent)},findInlineParents=function(isInlineTarget,rootNode,pos){return filter(DOMUtils$1.DOM.getParents(pos.container(),"*",rootNode),isInlineTarget)},findRootInline=function(isInlineTarget,rootNode,pos){var parents=findInlineParents(isInlineTarget,rootNode,pos);return Option.from(parents[parents.length-1])},hasSameParentBlock=function(rootNode,node1,node2){var block1=getParentBlock(node1,rootNode),block2=getParentBlock(node2,rootNode);return block1&&block1===block2},isAtZwsp=function(pos){return isBeforeInline(pos)||isAfterInline(pos)},normalizePosition=function(forward,pos){if(!pos)return pos;var container=pos.container(),offset=pos.offset();return forward?isCaretContainerInline(container)?NodeType.isText(container.nextSibling)?CaretPosition$1(container.nextSibling,0):CaretPosition$1.after(container):isBeforeInline(pos)?CaretPosition$1(container,offset+1):pos:isCaretContainerInline(container)?NodeType.isText(container.previousSibling)?CaretPosition$1(container.previousSibling,container.previousSibling.data.length):CaretPosition$1.before(container):isAfterInline(pos)?CaretPosition$1(container,offset-1):pos},normalizeForwards=curry(normalizePosition,!0),normalizeBackwards=curry(normalizePosition,!1),InlineUtils={isInlineTarget:isInlineTarget,findRootInline:findRootInline,isRtl:isRtl$1,isAtZwsp:isAtZwsp,normalizePosition:normalizePosition,normalizeForwards:normalizeForwards,normalizeBackwards:normalizeBackwards,hasSameParentBlock:hasSameParentBlock},evaluateUntil=function(fns,args){for(var i=0;i<fns.length;i++){var result=fns[i].apply(null,args);if(result.isSome())return result}return Option.none()},LazyEvaluator={evaluateUntil:evaluateUntil},Location=Adt.generate([{before:["element"]},{start:["element"]},{end:["element"]},{after:["element"]}]),rescope=function(rootNode,node){var parentBlock=getParentBlock(node,rootNode);return parentBlock||rootNode},before$4=function(isInlineTarget,rootNode,pos){var nPos=InlineUtils.normalizeForwards(pos),scope=rescope(rootNode,nPos.container());return InlineUtils.findRootInline(isInlineTarget,scope,nPos).fold(function(){return CaretFinder.nextPosition(scope,nPos).bind(curry(InlineUtils.findRootInline,isInlineTarget,scope)).map(function(inline){return Location.before(inline)})},Option.none)},isNotInsideFormatCaretContainer=function(rootNode,elm){return null===getParentCaretContainer(rootNode,elm)},findInsideRootInline=function(isInlineTarget,rootNode,pos){return InlineUtils.findRootInline(isInlineTarget,rootNode,pos).filter(curry(isNotInsideFormatCaretContainer,rootNode))},start=function(isInlineTarget,rootNode,pos){var nPos=InlineUtils.normalizeBackwards(pos);return findInsideRootInline(isInlineTarget,rootNode,nPos).bind(function(inline){return CaretFinder.prevPosition(inline,nPos).isNone()?Option.some(Location.start(inline)):Option.none()})},end=function(isInlineTarget,rootNode,pos){var nPos=InlineUtils.normalizeForwards(pos);return findInsideRootInline(isInlineTarget,rootNode,nPos).bind(function(inline){return CaretFinder.nextPosition(inline,nPos).isNone()?Option.some(Location.end(inline)):Option.none()})},after$3=function(isInlineTarget,rootNode,pos){var nPos=InlineUtils.normalizeBackwards(pos),scope=rescope(rootNode,nPos.container());return InlineUtils.findRootInline(isInlineTarget,scope,nPos).fold(function(){return CaretFinder.prevPosition(scope,nPos).bind(curry(InlineUtils.findRootInline,isInlineTarget,scope)).map(function(inline){return Location.after(inline)})},Option.none)},isValidLocation=function(location){return!1===InlineUtils.isRtl(getElement(location))},readLocation=function(isInlineTarget,rootNode,pos){return LazyEvaluator.evaluateUntil([before$4,start,end,after$3],[isInlineTarget,rootNode,pos]).filter(isValidLocation)},getElement=function(location){return location.fold(identity,identity,identity,identity)},getName=function(location){return location.fold(constant("before"),constant("start"),constant("end"),constant("after"))},outside=function(location){return location.fold(Location.before,Location.before,Location.after,Location.after)},inside=function(location){return location.fold(Location.start,Location.start,Location.end,Location.end)},isEq$5=function(location1,location2){return getName(location1)===getName(location2)&&getElement(location1)===getElement(location2)},betweenInlines=function(forward,isInlineTarget,rootNode,from,to,location){return lift2(InlineUtils.findRootInline(isInlineTarget,rootNode,from),InlineUtils.findRootInline(isInlineTarget,rootNode,to),function(fromInline,toInline){return fromInline!==toInline&&InlineUtils.hasSameParentBlock(rootNode,fromInline,toInline)?Location.after(forward?fromInline:toInline):location}).getOr(location)},skipNoMovement=function(fromLocation,toLocation){return fromLocation.fold(constant(!0),function(fromLocation){return!isEq$5(fromLocation,toLocation)})},findLocationTraverse=function(forward,isInlineTarget,rootNode,fromLocation,pos){var from=InlineUtils.normalizePosition(forward,pos);return CaretFinder.fromPosition(forward,rootNode,from).map(curry(InlineUtils.normalizePosition,forward)).fold(function(){return fromLocation.map(outside)},function(to){return readLocation(isInlineTarget,rootNode,to).map(curry(betweenInlines,forward,isInlineTarget,rootNode,from,to)).filter(curry(skipNoMovement,fromLocation))}).filter(isValidLocation)},findLocationSimple=function(forward,location){return forward?location.fold(compose(Option.some,Location.start),Option.none,compose(Option.some,Location.after),Option.none):location.fold(Option.none,compose(Option.some,Location.before),Option.none,compose(Option.some,Location.end))},findLocation=function(forward,isInlineTarget,rootNode,pos){var from=InlineUtils.normalizePosition(forward,pos),fromLocation=readLocation(isInlineTarget,rootNode,from);return readLocation(isInlineTarget,rootNode,from).bind(curry(findLocationSimple,forward)).orThunk(function(){return findLocationTraverse(forward,isInlineTarget,rootNode,fromLocation,pos)})},BoundaryLocation={readLocation:readLocation,findLocation:findLocation,prevLocation:curry(findLocation,!1),nextLocation:curry(findLocation,!0),getElement:getElement,outside:outside,inside:inside},hasSelectionModifyApi=function(editor){return isFunction(editor.selection.getSel().modify)},moveRel=function(forward,selection,pos){var delta=forward?1:-1;return selection.setRng(CaretPosition$1(pos.container(),pos.offset()+delta).toRange()),selection.getSel().modify("move",forward?"forward":"backward","word"),!0},moveByWord=function(forward,editor){var rng=editor.selection.getRng(),pos=forward?CaretPosition$1.fromRangeEnd(rng):CaretPosition$1.fromRangeStart(rng);return!!hasSelectionModifyApi(editor)&&(forward&&isBeforeInline(pos)?moveRel(!0,editor.selection,pos):!(forward||!isAfterInline(pos))&&moveRel(!1,editor.selection,pos))},WordSelection={hasSelectionModifyApi:hasSelectionModifyApi,moveByWord:moveByWord},setCaretPosition=function(editor,pos){var rng=editor.dom.createRng();rng.setStart(pos.container(),pos.offset()),rng.setEnd(pos.container(),pos.offset()),editor.selection.setRng(rng)},isFeatureEnabled=function(editor){return!1!==editor.settings.inline_boundaries},setSelected=function(state,elm){state?elm.setAttribute("data-mce-selected","inline-boundary"):elm.removeAttribute("data-mce-selected")},renderCaretLocation=function(editor,caret,location){return BoundaryCaret.renderCaret(caret,location).map(function(pos){return setCaretPosition(editor,pos),location})},findLocation$1=function(editor,caret,forward){var rootNode=editor.getBody(),from=CaretPosition$1.fromRangeStart(editor.selection.getRng()),isInlineTarget=curry(InlineUtils.isInlineTarget,editor);return BoundaryLocation.findLocation(forward,isInlineTarget,rootNode,from).bind(function(location){return renderCaretLocation(editor,caret,location)})},toggleInlines=function(isInlineTarget,dom,elms){var selectedInlines=filter(dom.select('*[data-mce-selected="inline-boundary"]'),isInlineTarget),targetInlines=filter(elms,isInlineTarget);each(difference(selectedInlines,targetInlines),curry(setSelected,!1)),each(difference(targetInlines,selectedInlines),curry(setSelected,!0))},safeRemoveCaretContainer=function(editor,caret){if(editor.selection.isCollapsed()&&!0!==editor.composing&&caret.get()){var pos=CaretPosition$1.fromRangeStart(editor.selection.getRng());CaretPosition$1.isTextPosition(pos)&&!1===InlineUtils.isAtZwsp(pos)&&(setCaretPosition(editor,CaretContainerRemove.removeAndReposition(caret.get(),pos)),caret.set(null))}},renderInsideInlineCaret=function(isInlineTarget,editor,caret,elms){if(editor.selection.isCollapsed()){var inlines=filter(elms,isInlineTarget);each(inlines,function(inline){var pos=CaretPosition$1.fromRangeStart(editor.selection.getRng());BoundaryLocation.readLocation(isInlineTarget,editor.getBody(),pos).bind(function(location){return renderCaretLocation(editor,caret,location)})})}},move=function(editor,caret,forward){return function(){return!!isFeatureEnabled(editor)&&findLocation$1(editor,caret,forward).isSome()}},moveWord=function(forward,editor,caret){return function(){return!!isFeatureEnabled(editor)&&WordSelection.moveByWord(forward,editor)}},setupSelectedState=function(editor){var caret=Cell(null),isInlineTarget=curry(InlineUtils.isInlineTarget,editor);return editor.on("NodeChange",function(e){isFeatureEnabled(editor)&&(toggleInlines(isInlineTarget,editor.dom,e.parents),safeRemoveCaretContainer(editor,caret),renderInsideInlineCaret(isInlineTarget,editor,caret,e.parents))}),caret},moveNextWord=curry(moveWord,!0),movePrevWord=curry(moveWord,!1),BoundarySelection={move:move,moveNextWord:moveNextWord,movePrevWord:movePrevWord,setupSelectedState:setupSelectedState,setCaretPosition:setCaretPosition},getNodeClientRects=function(node){var toArrayWithNode=function(clientRects){return map(clientRects,function(clientRect){return clientRect=clone$1(clientRect),clientRect.node=node,clientRect})};if(NodeType.isElement(node))return toArrayWithNode(node.getClientRects());if(NodeType.isText(node)){var rng=node.ownerDocument.createRange();return rng.setStart(node,0),rng.setEnd(node,node.data.length),toArrayWithNode(rng.getClientRects())}},getClientRects=function(node){return foldl(node,function(result,node){return result.concat(getNodeClientRects(node))},[])};!function(VDirection){VDirection[VDirection.Up=-1]="Up",VDirection[VDirection.Down=1]="Down"}(VDirection||(VDirection={}));var BreakType,findUntil=function(direction,root,predicateFn,node){for(;node=findNode(node,direction,isEditableCaretCandidate,root);)if(predicateFn(node))return},walkUntil=function(direction,isAboveFn,isBeflowFn,root,predicateFn,caretPosition){var node,targetClientRect,line=0,result=[],add=function(node){var i,clientRect,clientRects;for(clientRects=getClientRects([node]),-1===direction&&(clientRects=clientRects.reverse()),i=0;i<clientRects.length;i++)if(clientRect=clientRects[i],!isBeflowFn(clientRect,targetClientRect)){if(result.length>0&&isAboveFn(clientRect,ArrUtils.last(result))&&line++,clientRect.line=line,predicateFn(clientRect))return!0;result.push(clientRect)}};return(targetClientRect=ArrUtils.last(caretPosition.getClientRects()))?(node=caretPosition.getNode(),add(node),findUntil(direction,root,add,node),result):result},aboveLineNumber=function(lineNumber,clientRect){return clientRect.line>lineNumber},isLineNumber=function(lineNumber,clientRect){return clientRect.line===lineNumber},upUntil=curry(walkUntil,VDirection.Up,isAbove,isBelow),downUntil=curry(walkUntil,VDirection.Down,isBelow,isAbove),positionsUntil=function(direction,root,predicateFn,node){var walkFn,isBelowFn,isAboveFn,caretPosition,clientRect,targetClientRect,caretWalker=CaretWalker(root),result=[],line=0,getClientRect=function(caretPosition){return ArrUtils.last(caretPosition.getClientRects())};1===direction?(walkFn=caretWalker.next,isBelowFn=isBelow,isAboveFn=isAbove,caretPosition=CaretPosition$1.after(node)):(walkFn=caretWalker.prev,isBelowFn=isAbove,isAboveFn=isBelow,caretPosition=CaretPosition$1.before(node)),targetClientRect=getClientRect(caretPosition);do{if(caretPosition.isVisible()&&(clientRect=getClientRect(caretPosition),!isAboveFn(clientRect,targetClientRect))){if(result.length>0&&isBelowFn(clientRect,ArrUtils.last(result))&&line++,clientRect=clone$1(clientRect),clientRect.position=caretPosition,clientRect.line=line,predicateFn(clientRect))return result;result.push(clientRect)}}while(caretPosition=walkFn(caretPosition));return result},isAboveLine=function(lineNumber){return function(clientRect){return aboveLineNumber(lineNumber,clientRect)}},isLine=function(lineNumber){return function(clientRect){return isLineNumber(lineNumber,clientRect)}},isContentEditableFalse$7=NodeType.isContentEditableFalse,findNode$1=findNode,distanceToRectLeft=function(clientRect,clientX){return Math.abs(clientRect.left-clientX)},distanceToRectRight=function(clientRect,clientX){return Math.abs(clientRect.right-clientX)},isInside=function(clientX,clientRect){return clientX>=clientRect.left&&clientX<=clientRect.right},findClosestClientRect=function(clientRects,clientX){return ArrUtils.reduce(clientRects,function(oldClientRect,clientRect){var oldDistance,newDistance;return oldDistance=Math.min(distanceToRectLeft(oldClientRect,clientX),distanceToRectRight(oldClientRect,clientX)),newDistance=Math.min(distanceToRectLeft(clientRect,clientX),distanceToRectRight(clientRect,clientX)),isInside(clientX,clientRect)?clientRect:isInside(clientX,oldClientRect)?oldClientRect:newDistance===oldDistance&&isContentEditableFalse$7(clientRect.node)?clientRect:newDistance<oldDistance?clientRect:oldClientRect})},walkUntil$1=function(direction,root,predicateFn,node){for(;node=findNode$1(node,direction,isEditableCaretCandidate,root);)if(predicateFn(node))return},findLineNodeRects=function(root,targetNodeRect){var clientRects=[],collect=function(checkPosFn,node){var lineRects;return lineRects=filter(getClientRects([node]),function(clientRect){return!checkPosFn(clientRect,targetNodeRect)}),clientRects=clientRects.concat(lineRects),0===lineRects.length};return clientRects.push(targetNodeRect),walkUntil$1(VDirection.Up,root,curry(collect,isAbove),targetNodeRect.node),walkUntil$1(VDirection.Down,root,curry(collect,isBelow),targetNodeRect.node),clientRects},getFakeCaretTargets=function(root){return filter(from$1(root.getElementsByTagName("*")),isFakeCaretTarget)},caretInfo=function(clientRect,clientX){return{node:clientRect.node,before:distanceToRectLeft(clientRect,clientX)<distanceToRectRight(clientRect,clientX)}},closestCaret=function(root,clientX,clientY){var closestNodeRect,contentEditableFalseNodeRects=getClientRects(getFakeCaretTargets(root)),targetNodeRects=filter(contentEditableFalseNodeRects,function(rect){return clientY>=rect.top&&clientY<=rect.bottom});return closestNodeRect=findClosestClientRect(targetNodeRects,clientX),closestNodeRect&&(closestNodeRect=findClosestClientRect(findLineNodeRects(root,closestNodeRect),clientX))&&isFakeCaretTarget(closestNodeRect.node)?caretInfo(closestNodeRect,clientX):null},isContentEditableTrue$3=NodeType.isContentEditableTrue,isContentEditableFalse$8=NodeType.isContentEditableFalse,showCaret=function(direction,editor,node,before,scrollIntoView){return editor._selectionOverrides.showCaret(direction,node,before,scrollIntoView)},getNodeRange=function(node){var rng=node.ownerDocument.createRange();return rng.selectNode(node),rng},selectNode=function(editor,node){return editor.fire("BeforeObjectSelected",{target:node}).isDefaultPrevented()?null:getNodeRange(node)},renderCaretAtRange=function(editor,range,scrollIntoView){var normalizedRange=normalizeRange(1,editor.getBody(),range),caretPosition=CaretPosition$1.fromRangeStart(normalizedRange),caretPositionNode=caretPosition.getNode();if(isContentEditableFalse$8(caretPositionNode))return showCaret(1,editor,caretPositionNode,!caretPosition.isAtEnd(),!1);var caretPositionBeforeNode=caretPosition.getNode(!0);if(isContentEditableFalse$8(caretPositionBeforeNode))return showCaret(1,editor,caretPositionBeforeNode,!1,!1);var ceRoot=editor.dom.getParent(caretPosition.getNode(),function(node){return isContentEditableFalse$8(node)||isContentEditableTrue$3(node)});return isContentEditableFalse$8(ceRoot)?showCaret(1,editor,ceRoot,!1,scrollIntoView):null},renderRangeCaret=function(editor,range,scrollIntoView){if(!range||!range.collapsed)return range;var caretRange=renderCaretAtRange(editor,range,scrollIntoView);return caretRange||range},isChar=function(forward,predicate,pos){return Option.from(pos.container()).filter(NodeType.isText).exists(function(text){var delta=forward?0:-1;return predicate(text.data.charAt(pos.offset()+delta))})},isBeforeSpace=curry(isChar,!0,isWhiteSpace$1),isAfterSpace=curry(isChar,!1,isWhiteSpace$1),isEmptyText=function(pos){var container=pos.container();return NodeType.isText(container)&&0===container.data.length},matchesElementPosition=function(before,predicate){return function(pos){return Option.from(getChildNodeAtRelativeOffset(before?0:-1,pos)).filter(predicate).isSome()}},isImageBlock=function(node){return"IMG"===node.nodeName&&"block"===get$4(Element.fromDom(node),"display")},isCefNode=function(node){return NodeType.isContentEditableFalse(node)&&!NodeType.isBogusAll(node)},isBeforeImageBlock=matchesElementPosition(!0,isImageBlock),isAfterImageBlock=matchesElementPosition(!1,isImageBlock),isBeforeTable=matchesElementPosition(!0,NodeType.isTable),isAfterTable=matchesElementPosition(!1,NodeType.isTable),isBeforeContentEditableFalse=matchesElementPosition(!0,isCefNode),isAfterContentEditableFalse=matchesElementPosition(!1,isCefNode);!function(BreakType){BreakType[BreakType.Br=0]="Br",BreakType[BreakType.Block=1]="Block",BreakType[BreakType.Wrap=2]="Wrap",BreakType[BreakType.Eol=3]="Eol"}(BreakType||(BreakType={}));var customEventRootDelegates,beforeUnloadDelegate,flip=function(direction,positions){return direction===HDirection.Backwards?reverse(positions):positions},walk$3=function(direction,caretWalker,pos){return direction===HDirection.Forwards?caretWalker.next(pos):caretWalker.prev(pos)},getBreakType=function(scope,direction,currentPos,nextPos){return NodeType.isBr(nextPos.getNode(direction===HDirection.Forwards))?BreakType.Br:!1===isInSameBlock(currentPos,nextPos)?BreakType.Block:BreakType.Wrap},getPositionsUntil=function(predicate,direction,scope,start){for(var nextPos,caretWalker=CaretWalker(scope),currentPos=start,positions=[];currentPos&&(nextPos=walk$3(direction,caretWalker,currentPos));){if(NodeType.isBr(nextPos.getNode(!1)))return direction===HDirection.Forwards?{positions:flip(direction,positions).concat([nextPos]),breakType:BreakType.Br,breakAt:Option.some(nextPos)}:{positions:flip(direction,positions),breakType:BreakType.Br,breakAt:Option.some(nextPos)};if(nextPos.isVisible()){if(predicate(currentPos,nextPos)){var breakType=getBreakType(0,direction,currentPos,nextPos);return{positions:flip(direction,positions),breakType:breakType,breakAt:Option.some(nextPos)}}positions.push(nextPos),currentPos=nextPos}else currentPos=nextPos}return{positions:flip(direction,positions),breakType:BreakType.Eol,breakAt:Option.none()}},getAdjacentLinePositions=function(direction,getPositionsUntilBreak,scope,start){return getPositionsUntilBreak(scope,start).breakAt.map(function(pos){var positions=getPositionsUntilBreak(scope,pos).positions;return direction===HDirection.Backwards?positions.concat(pos):[pos].concat(positions)}).getOr([])},findClosestHorizontalPositionFromPoint=function(positions,x){return foldl(positions,function(acc,newPos){return acc.fold(function(){return Option.some(newPos)},function(lastPos){return lift2(head(lastPos.getClientRects()),head(newPos.getClientRects()),function(lastRect,newRect){var lastDist=Math.abs(x-lastRect.left);return Math.abs(x-newRect.left)<=lastDist?newPos:lastPos}).or(acc)})},Option.none())},findClosestHorizontalPosition=function(positions,pos){return head(pos.getClientRects()).bind(function(targetRect){return findClosestHorizontalPositionFromPoint(positions,targetRect.left)})},getPositionsUntilPreviousLine=curry(getPositionsUntil,CaretPosition.isAbove,-1),getPositionsUntilNextLine=curry(getPositionsUntil,CaretPosition.isBelow,1),isAtFirstLine=function(scope,pos){return getPositionsUntilPreviousLine(scope,pos).breakAt.isNone()},isAtLastLine=function(scope,pos){return getPositionsUntilNextLine(scope,pos).breakAt.isNone()},getPositionsAbove=curry(getAdjacentLinePositions,-1,getPositionsUntilPreviousLine),getPositionsBelow=curry(getAdjacentLinePositions,1,getPositionsUntilNextLine),getFirstLinePositions=function(scope){return CaretFinder.firstPositionIn(scope).map(function(pos){return[pos].concat(getPositionsUntilNextLine(scope,pos).positions)}).getOr([])},getLastLinePositions=function(scope){return CaretFinder.lastPositionIn(scope).map(function(pos){return getPositionsUntilPreviousLine(scope,pos).positions.concat(pos)}).getOr([])},isContentEditableFalse$9=NodeType.isContentEditableFalse,getSelectedNode$1=getSelectedNode,moveToCeFalseHorizontally=function(direction,editor,getNextPosFn,range){var forwards=direction===HDirection.Forwards,isBeforeContentEditableFalseFn=forwards?isBeforeContentEditableFalse:isAfterContentEditableFalse;if(!range.collapsed){var node=getSelectedNode$1(range);if(isContentEditableFalse$9(node))return showCaret(direction,editor,node,direction===HDirection.Backwards,!0)}var rangeIsInContainerBlock=isRangeInCaretContainerBlock(range),caretPosition=getNormalizedRangeEndPoint(direction,editor.getBody(),range);if(isBeforeContentEditableFalseFn(caretPosition))return selectNode(editor,caretPosition.getNode(!forwards));var nextCaretPosition=InlineUtils.normalizePosition(forwards,getNextPosFn(caretPosition));if(!nextCaretPosition)return rangeIsInContainerBlock?range:null;if(isBeforeContentEditableFalseFn(nextCaretPosition))return showCaret(direction,editor,nextCaretPosition.getNode(!forwards),forwards,!0);var peekCaretPosition=getNextPosFn(nextCaretPosition);return peekCaretPosition&&isBeforeContentEditableFalseFn(peekCaretPosition)&&isMoveInsideSameBlock(nextCaretPosition,peekCaretPosition)?showCaret(direction,editor,peekCaretPosition.getNode(!forwards),forwards,!0):rangeIsInContainerBlock?renderRangeCaret(editor,nextCaretPosition.toRange(),!0):null},moveToCeFalseVertically=function(direction,editor,walkerFn,range){var caretPosition,linePositions,nextLinePositions,closestNextLineRect,caretClientRect,clientX,dist1,dist2,contentEditableFalseNode;if(contentEditableFalseNode=getSelectedNode$1(range),caretPosition=getNormalizedRangeEndPoint(direction,editor.getBody(),range),linePositions=walkerFn(editor.getBody(),isAboveLine(1),caretPosition),nextLinePositions=filter(linePositions,isLine(1)),caretClientRect=ArrUtils.last(caretPosition.getClientRects()),(isBeforeContentEditableFalse(caretPosition)||isBeforeTable(caretPosition))&&(contentEditableFalseNode=caretPosition.getNode()),(isAfterContentEditableFalse(caretPosition)||isAfterTable(caretPosition))&&(contentEditableFalseNode=caretPosition.getNode(!0)),!caretClientRect)return null;if(clientX=caretClientRect.left,(closestNextLineRect=findClosestClientRect(nextLinePositions,clientX))&&isContentEditableFalse$9(closestNextLineRect.node))return dist1=Math.abs(clientX-closestNextLineRect.left),dist2=Math.abs(clientX-closestNextLineRect.right),showCaret(direction,editor,closestNextLineRect.node,dist1<dist2,!0);if(contentEditableFalseNode){var caretPositions=positionsUntil(direction,editor.getBody(),isAboveLine(1),contentEditableFalseNode);if(closestNextLineRect=findClosestClientRect(filter(caretPositions,isLine(1)),clientX))return renderRangeCaret(editor,closestNextLineRect.position.toRange(),!0);if(closestNextLineRect=ArrUtils.last(filter(caretPositions,isLine(0))))return renderRangeCaret(editor,closestNextLineRect.position.toRange(),!0)}},createTextBlock=function(editor){var textBlock=editor.dom.create(Settings.getForcedRootBlock(editor));return(!Env.ie||Env.ie>=11)&&(textBlock.innerHTML='<br data-mce-bogus="1">'),textBlock},exitPreBlock=function(editor,direction,range){var pre,caretPos,newBlock,caretWalker=CaretWalker(editor.getBody()),getNextVisualCaretPosition=curry(getVisualCaretPosition,caretWalker.next),getPrevVisualCaretPosition=curry(getVisualCaretPosition,caretWalker.prev);if(range.collapsed&&editor.settings.forced_root_block){if(!(pre=editor.dom.getParent(range.startContainer,"PRE")))return;caretPos=1===direction?getNextVisualCaretPosition(CaretPosition$1.fromRangeStart(range)):getPrevVisualCaretPosition(CaretPosition$1.fromRangeStart(range)),caretPos||(newBlock=createTextBlock(editor),1===direction?editor.$(pre).after(newBlock):editor.$(pre).before(newBlock),editor.selection.select(newBlock,!0),editor.selection.collapse())}},getHorizontalRange=function(editor,forward){var newRange,caretWalker=CaretWalker(editor.getBody()),getNextVisualCaretPosition=curry(getVisualCaretPosition,caretWalker.next),getPrevVisualCaretPosition=curry(getVisualCaretPosition,caretWalker.prev),direction=forward?HDirection.Forwards:HDirection.Backwards,getNextPosFn=forward?getNextVisualCaretPosition:getPrevVisualCaretPosition,range=editor.selection.getRng();return(newRange=moveToCeFalseHorizontally(direction,editor,getNextPosFn,range))?newRange:(newRange=exitPreBlock(editor,direction,range))||null},getVerticalRange=function(editor,down){var newRange,direction=down?1:-1,walkerFn=down?downUntil:upUntil,range=editor.selection.getRng();return(newRange=moveToCeFalseVertically(direction,editor,walkerFn,range))?newRange:(newRange=exitPreBlock(editor,direction,range))||null},moveH=function(editor,forward){return function(){var newRng=getHorizontalRange(editor,forward);return!!newRng&&(editor.selection.setRng(newRng),!0)}},moveV=function(editor,down){return function(){var newRng=getVerticalRange(editor,down);return!!newRng&&(editor.selection.setRng(newRng),!0)}},isCefPosition=function(forward){return function(pos){return forward?isAfterContentEditableFalse(pos):isBeforeContentEditableFalse(pos)}},moveToLineEndPoint=function(editor,forward){return function(){var from=forward?CaretPosition$1.fromRangeEnd(editor.selection.getRng()):CaretPosition$1.fromRangeStart(editor.selection.getRng()),result=forward?getPositionsUntilNextLine(editor.getBody(),from):getPositionsUntilPreviousLine(editor.getBody(),from);return(forward?last(result.positions):head(result.positions)).filter(isCefPosition(forward)).fold(constant(!1),function(pos){return editor.selection.setRng(pos.toRange()),!0})}},deflate=function(rect,delta){return{left:rect.left-delta,top:rect.top-delta,right:rect.right+2*delta,bottom:rect.bottom+2*delta,width:rect.width+delta,height:rect.height+delta}},getCorners=function(getYAxisValue,tds){return bind(tds,function(td){var rect=deflate(clone$1(td.getBoundingClientRect()),-1);return[{x:rect.left,y:getYAxisValue(rect),cell:td},{x:rect.right,y:getYAxisValue(rect),cell:td}]})},findClosestCorner=function(corners,x,y){return foldl(corners,function(acc,newCorner){return acc.fold(function(){return Option.some(newCorner)},function(oldCorner){var oldDist=Math.sqrt(Math.abs(oldCorner.x-x)+Math.abs(oldCorner.y-y)),newDist=Math.sqrt(Math.abs(newCorner.x-x)+Math.abs(newCorner.y-y));return Option.some(newDist<oldDist?newCorner:oldCorner)})},Option.none())},getClosestCell=function(getYAxisValue,isTargetCorner,table,x,y){var cells=descendants$1(Element.fromDom(table),"td,th,caption").map(function(e){return e.dom()}),corners=filter(getCorners(getYAxisValue,cells),function(corner){return isTargetCorner(corner,y)});return findClosestCorner(corners,x,y).map(function(corner){return corner.cell})},getBottomValue=function(rect){return rect.bottom},getTopValue=function(rect){return rect.top},isAbove$1=function(corner,y){return corner.y<y},isBelow$1=function(corner,y){return corner.y>y},getClosestCellAbove=curry(getClosestCell,getBottomValue,isAbove$1),getClosestCellBelow=curry(getClosestCell,getTopValue,isBelow$1),findClosestPositionInAboveCell=function(table,pos){return head(pos.getClientRects()).bind(function(rect){return getClosestCellAbove(table,rect.left,rect.top)}).bind(function(cell){return findClosestHorizontalPosition(getLastLinePositions(cell),pos)})},findClosestPositionInBelowCell=function(table,pos){return last(pos.getClientRects()).bind(function(rect){return getClosestCellBelow(table,rect.left,rect.top)}).bind(function(cell){return findClosestHorizontalPosition(getFirstLinePositions(cell),pos)})},moveToRange=function(editor,rng){editor.selection.setRng(rng),ScrollIntoView.scrollRangeIntoView(editor,rng)},hasNextBreak=function(getPositionsUntil,scope,lineInfo){return lineInfo.breakAt.map(function(breakPos){return getPositionsUntil(scope,breakPos).breakAt.isSome()}).getOr(!1)},startsWithWrapBreak=function(lineInfo){return lineInfo.breakType===BreakType.Wrap&&0===lineInfo.positions.length},startsWithBrBreak=function(lineInfo){return lineInfo.breakType===BreakType.Br&&1===lineInfo.positions.length},isAtTableCellLine=function(getPositionsUntil,scope,pos){var lineInfo=getPositionsUntil(scope,pos);return startsWithWrapBreak(lineInfo)||!NodeType.isBr(pos.getNode())&&startsWithBrBreak(lineInfo)?!hasNextBreak(getPositionsUntil,scope,lineInfo):lineInfo.breakAt.isNone()},isAtFirstTableCellLine=curry(isAtTableCellLine,getPositionsUntilPreviousLine),isAtLastTableCellLine=curry(isAtTableCellLine,getPositionsUntilNextLine),isCaretAtStartOrEndOfTable=function(forward,rng,table){var caretPos=CaretPosition$1.fromRangeStart(rng);return CaretFinder.positionIn(!forward,table).map(function(pos){return pos.isEqual(caretPos)}).getOr(!1)},navigateHorizontally=function(editor,forward,table,td){var rng=editor.selection.getRng(),direction=forward?1:-1;if(isFakeCaretTableBrowser()&&isCaretAtStartOrEndOfTable(forward,rng,table)){var newRng=showCaret(direction,editor,table,!forward,!0);return moveToRange(editor,newRng),!0}return!1},getClosestAbovePosition=function(root,table,start){return findClosestPositionInAboveCell(table,start).orThunk(function(){return head(start.getClientRects()).bind(function(rect){return findClosestHorizontalPositionFromPoint(getPositionsAbove(root,CaretPosition$1.before(table)),rect.left)})}).getOr(CaretPosition$1.before(table))},getClosestBelowPosition=function(root,table,start){return findClosestPositionInBelowCell(table,start).orThunk(function(){return head(start.getClientRects()).bind(function(rect){return findClosestHorizontalPositionFromPoint(getPositionsBelow(root,CaretPosition$1.after(table)),rect.left)})}).getOr(CaretPosition$1.after(table))},getTable=function(previous,pos){var node=pos.getNode(previous);return NodeType.isElement(node)&&"TABLE"===node.nodeName?Option.some(node):Option.none()},renderBlock=function(down,editor,table,pos){var forcedRootBlock=Settings.getForcedRootBlock(editor);forcedRootBlock?editor.undoManager.transact(function(){var element=Element.fromTag(forcedRootBlock);setAll(element,Settings.getForcedRootBlockAttrs(editor)),append(element,Element.fromTag("br")),down?after(Element.fromDom(table),element):before(Element.fromDom(table),element);var rng=editor.dom.createRng();rng.setStart(element.dom(),0),rng.setEnd(element.dom(),0),moveToRange(editor,rng)}):moveToRange(editor,pos.toRange())},moveCaret=function(editor,down,pos){var last=!1===down;(down?getTable(!0,pos):getTable(!1,pos)).fold(function(){return moveToRange(editor,pos.toRange())},function(table){return CaretFinder.positionIn(last,editor.getBody()).filter(function(lastPos){return lastPos.isEqual(pos)}).fold(function(){return moveToRange(editor,pos.toRange())},function(_){return renderBlock(down,editor,table,pos)})})},navigateVertically=function(editor,down,table,td){var rng=editor.selection.getRng(),pos=CaretPosition$1.fromRangeStart(rng),root=editor.getBody();if(!down&&isAtFirstTableCellLine(td,pos)){var newPos=getClosestAbovePosition(root,table,pos);return moveCaret(editor,down,newPos),!0}if(down&&isAtLastTableCellLine(td,pos)){var newPos=getClosestBelowPosition(root,table,pos);return moveCaret(editor,down,newPos),!0}return!1},moveH$1=function(editor,forward){return function(){return Option.from(editor.dom.getParent(editor.selection.getNode(),"td,th")).bind(function(td){return Option.from(editor.dom.getParent(td,"table")).map(function(table){return navigateHorizontally(editor,forward,table)})}).getOr(!1)}},moveV$1=function(editor,forward){return function(){return Option.from(editor.dom.getParent(editor.selection.getNode(),"td,th")).bind(function(td){return Option.from(editor.dom.getParent(td,"table")).map(function(table){return navigateVertically(editor,forward,table,td)})}).getOr(!1)}},isTarget=function(node){return contains(["figcaption"],name(node))},rangeBefore=function(target){var rng=domGlobals.document.createRange();return rng.setStartBefore(target.dom()),rng.setEndBefore(target.dom()),rng},insertElement=function(root,elm,forward){forward?append(root,elm):prepend(root,elm)},insertBr=function(root,forward){var br=Element.fromTag("br");return insertElement(root,br,forward),rangeBefore(br)},insertBlock$1=function(root,forward,blockName,attrs){var block=Element.fromTag(blockName),br=Element.fromTag("br");return setAll(block,attrs),append(block,br),insertElement(root,block,forward),rangeBefore(br)},insertEmptyLine=function(root,rootBlockName,attrs,forward){return""===rootBlockName?insertBr(root,forward):insertBlock$1(root,forward,rootBlockName,attrs)},getClosestTargetBlock=function(pos,root){var isRoot=curry(eq,root);return closest(Element.fromDom(pos.container()),isBlock,isRoot).filter(isTarget)},isAtFirstOrLastLine=function(root,forward,pos){return forward?isAtLastLine(root.dom(),pos):isAtFirstLine(root.dom(),pos)},moveCaretToNewEmptyLine=function(editor,forward){var root=Element.fromDom(editor.getBody()),pos=CaretPosition$1.fromRangeStart(editor.selection.getRng()),rootBlock=Settings.getForcedRootBlock(editor),rootBlockAttrs=Settings.getForcedRootBlockAttrs(editor);return getClosestTargetBlock(pos,root).exists(function(){if(isAtFirstOrLastLine(root,forward,pos)){var rng=insertEmptyLine(root,rootBlock,rootBlockAttrs,forward);return editor.selection.setRng(rng),!0}return!1})},moveV$2=function(editor,forward){return function(){return!!editor.selection.isCollapsed()&&moveCaretToNewEmptyLine(editor,forward)}},defaultPatterns=function(patterns){return map(patterns,function(pattern){return __assign({shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1,keyCode:0,action:noop},pattern)})},matchesEvent=function(pattern,evt){return evt.keyCode===pattern.keyCode&&evt.shiftKey===pattern.shiftKey&&evt.altKey===pattern.altKey&&evt.ctrlKey===pattern.ctrlKey&&evt.metaKey===pattern.metaKey},match$1=function(patterns,evt){return bind(defaultPatterns(patterns),function(pattern){return matchesEvent(pattern,evt)?[pattern]:[]})},action=function(f){for(var x=[],_i=1;_i<arguments.length;_i++)x[_i-1]=arguments[_i];var args=Array.prototype.slice.call(arguments,1);return function(){return f.apply(null,args)}},execute=function(patterns,evt){return find(match$1(patterns,evt),function(pattern){return pattern.action()})},MatchKeys={match:match$1,action:action,execute:execute},executeKeydownOverride=function(editor,caret,evt){var os=detect$3().os;MatchKeys.execute([{keyCode:VK.RIGHT,action:moveH(editor,!0)},{keyCode:VK.LEFT,action:moveH(editor,!1)},{keyCode:VK.UP,action:moveV(editor,!1)},{keyCode:VK.DOWN,action:moveV(editor,!0)},{keyCode:VK.RIGHT,action:moveH$1(editor,!0)},{keyCode:VK.LEFT,action:moveH$1(editor,!1)},{keyCode:VK.UP,action:moveV$1(editor,!1)},{keyCode:VK.DOWN,action:moveV$1(editor,!0)},{keyCode:VK.RIGHT,action:BoundarySelection.move(editor,caret,!0)},{keyCode:VK.LEFT,action:BoundarySelection.move(editor,caret,!1)},{keyCode:VK.RIGHT,ctrlKey:!os.isOSX(),altKey:os.isOSX(),action:BoundarySelection.moveNextWord(editor,caret)},{keyCode:VK.LEFT,ctrlKey:!os.isOSX(),altKey:os.isOSX(),action:BoundarySelection.movePrevWord(editor,caret)},{keyCode:VK.UP,action:moveV$2(editor,!1)},{keyCode:VK.DOWN,action:moveV$2(editor,!0)}],evt).each(function(_){evt.preventDefault()})},setup$9=function(editor,caret){editor.on("keydown",function(evt){!1===evt.isDefaultPrevented()&&executeKeydownOverride(editor,caret,evt)})},ArrowKeys={setup:setup$9},isBeforeRoot=function(rootNode){return function(elm){return eq(rootNode,Element.fromDom(elm.dom().parentNode))}},getParentBlock$1=function(rootNode,elm){return contains$2(rootNode,elm)?closest(elm,function(element){return isTextBlock(element)||isListItem(element)},isBeforeRoot(rootNode)):Option.none()},placeCaretInEmptyBody=function(editor){var body=editor.getBody(),node=body.firstChild&&editor.dom.isBlock(body.firstChild)?body.firstChild:body;editor.selection.setCursorLocation(node,0)},paddEmptyBody=function(editor){editor.dom.isEmpty(editor.getBody())&&(editor.setContent(""),placeCaretInEmptyBody(editor))},willDeleteLastPositionInElement=function(forward,fromPos,elm){return lift2(CaretFinder.firstPositionIn(elm),CaretFinder.lastPositionIn(elm),function(firstPos,lastPos){var normalizedFirstPos=InlineUtils.normalizePosition(!0,firstPos),normalizedLastPos=InlineUtils.normalizePosition(!1,lastPos),normalizedFromPos=InlineUtils.normalizePosition(!1,fromPos);return forward?CaretFinder.nextPosition(elm,normalizedFromPos).map(function(nextPos){return nextPos.isEqual(normalizedLastPos)&&fromPos.isEqual(normalizedFirstPos)}).getOr(!1):CaretFinder.prevPosition(elm,normalizedFromPos).map(function(prevPos){return prevPos.isEqual(normalizedFirstPos)&&fromPos.isEqual(normalizedLastPos)}).getOr(!1)}).getOr(!0)},DeleteUtils={getParentBlock:getParentBlock$1,paddEmptyBody:paddEmptyBody,willDeleteLastPositionInElement:willDeleteLastPositionInElement},blockPosition=function(block,position){return{block:constant(block),position:constant(position)}},blockBoundary=function(from,to){return{from:constant(from),to:constant(to)}},getBlockPosition=function(rootNode,pos){var rootElm=Element.fromDom(rootNode),containerElm=Element.fromDom(pos.container());return DeleteUtils.getParentBlock(rootElm,containerElm).map(function(block){return blockPosition(block,pos)})},isDifferentBlocks=function(blockBoundary){return!1===eq(blockBoundary.from().block(),blockBoundary.to().block())},hasSameParent=function(blockBoundary){return parent(blockBoundary.from().block()).bind(function(parent1){return parent(blockBoundary.to().block()).filter(function(parent2){return eq(parent1,parent2)})}).isSome()},isEditable=function(blockBoundary){return!1===NodeType.isContentEditableFalse(blockBoundary.from().block().dom())&&!1===NodeType.isContentEditableFalse(blockBoundary.to().block().dom())},skipLastBr=function(rootNode,forward,blockPosition){return NodeType.isBr(blockPosition.position().getNode())&&!1===Empty.isEmpty(blockPosition.block())?CaretFinder.positionIn(!1,blockPosition.block().dom()).bind(function(lastPositionInBlock){return lastPositionInBlock.isEqual(blockPosition.position())?CaretFinder.fromPosition(forward,rootNode,lastPositionInBlock).bind(function(to){return getBlockPosition(rootNode,to)}):Option.some(blockPosition)}).getOr(blockPosition):blockPosition},readFromRange=function(rootNode,forward,rng){var fromBlockPos=getBlockPosition(rootNode,CaretPosition$1.fromRangeStart(rng)),toBlockPos=fromBlockPos.bind(function(blockPos){return CaretFinder.fromPosition(forward,rootNode,blockPos.position()).bind(function(to){return getBlockPosition(rootNode,to).map(function(blockPos){return skipLastBr(rootNode,forward,blockPos)})})});return lift2(fromBlockPos,toBlockPos,blockBoundary).filter(function(blockBoundary){return isDifferentBlocks(blockBoundary)&&hasSameParent(blockBoundary)&&isEditable(blockBoundary)})},read$3=function(rootNode,forward,rng){return rng.collapsed?readFromRange(rootNode,forward,rng):Option.none()},BlockMergeBoundary={read:read$3},getChildrenUntilBlockBoundary=function(block){var children$1=children(block);return findIndex(children$1,isBlock).fold(function(){return children$1},function(index){return children$1.slice(0,index)})},extractChildren=function(block){var children=getChildrenUntilBlockBoundary(block);return each(children,remove),children},removeEmptyRoot=function(rootNode,block){var parents=Parents.parentsAndSelf(block,rootNode);return find(parents.reverse(),function(element){return Empty.isEmpty(element)}).each(remove)},isEmptyBefore=function(el){return 0===filter(prevSiblings(el),function(el){return!Empty.isEmpty(el)}).length},nestedBlockMerge=function(rootNode,fromBlock,toBlock,insertionPoint){if(Empty.isEmpty(toBlock))return PaddingBr.fillWithPaddingBr(toBlock),CaretFinder.firstPositionIn(toBlock.dom());isEmptyBefore(insertionPoint)&&Empty.isEmpty(fromBlock)&&before(insertionPoint,Element.fromTag("br"));var position=CaretFinder.prevPosition(toBlock.dom(),CaretPosition$1.before(insertionPoint.dom()));return each(extractChildren(fromBlock),function(child){before(insertionPoint,child)}),removeEmptyRoot(rootNode,fromBlock),position},sidelongBlockMerge=function(rootNode,fromBlock,toBlock){if(Empty.isEmpty(toBlock))return remove(toBlock),Empty.isEmpty(fromBlock)&&PaddingBr.fillWithPaddingBr(fromBlock),CaretFinder.firstPositionIn(fromBlock.dom());var position=CaretFinder.lastPositionIn(toBlock.dom());return each(extractChildren(fromBlock),function(child){append(toBlock,child)}),removeEmptyRoot(rootNode,fromBlock),position},findInsertionPoint=function(toBlock,block){var parentsAndSelf=Parents.parentsAndSelf(block,toBlock);return Option.from(parentsAndSelf[parentsAndSelf.length-1])},getInsertionPoint=function(fromBlock,toBlock){return contains$2(toBlock,fromBlock)?findInsertionPoint(toBlock,fromBlock):Option.none()},trimBr=function(first,block){CaretFinder.positionIn(first,block.dom()).map(function(position){return position.getNode()}).map(Element.fromDom).filter(isBr$1).each(remove)},mergeBlockInto=function(rootNode,fromBlock,toBlock){return trimBr(!0,fromBlock),trimBr(!1,toBlock),getInsertionPoint(fromBlock,toBlock).fold(curry(sidelongBlockMerge,rootNode,fromBlock,toBlock),curry(nestedBlockMerge,rootNode,fromBlock,toBlock))},mergeBlocks=function(rootNode,forward,block1,block2){return forward?mergeBlockInto(rootNode,block2,block1):mergeBlockInto(rootNode,block1,block2)},MergeBlocks={mergeBlocks:mergeBlocks},backspaceDelete=function(editor,forward){var rootNode=Element.fromDom(editor.getBody()),position=BlockMergeBoundary.read(rootNode.dom(),forward,editor.selection.getRng()).bind(function(blockBoundary){return MergeBlocks.mergeBlocks(rootNode,forward,blockBoundary.from().block(),blockBoundary.to().block())});return position.each(function(pos){editor.selection.setRng(pos.toRange())}),position.isSome()},BlockBoundaryDelete={backspaceDelete:backspaceDelete},deleteRangeMergeBlocks=function(rootNode,selection){var rng=selection.getRng();return lift2(DeleteUtils.getParentBlock(rootNode,Element.fromDom(rng.startContainer)),DeleteUtils.getParentBlock(rootNode,Element.fromDom(rng.endContainer)),function(block1,block2){return!1===eq(block1,block2)&&(rng.deleteContents(),MergeBlocks.mergeBlocks(rootNode,!0,block1,block2).each(function(pos){selection.setRng(pos.toRange())}),!0)}).getOr(!1)},isRawNodeInTable=function(root,rawNode){var node=Element.fromDom(rawNode),isRoot=curry(eq,root);return ancestor(node,isTableCell,isRoot).isSome()},isSelectionInTable=function(root,rng){return isRawNodeInTable(root,rng.startContainer)||isRawNodeInTable(root,rng.endContainer)},isEverythingSelected=function(root,rng){var noPrevious=CaretFinder.prevPosition(root.dom(),CaretPosition$1.fromRangeStart(rng)).isNone(),noNext=CaretFinder.nextPosition(root.dom(),CaretPosition$1.fromRangeEnd(rng)).isNone();return!isSelectionInTable(root,rng)&&noPrevious&&noNext},emptyEditor=function(editor){return editor.setContent(""),editor.selection.setCursorLocation(),!0},deleteRange=function(editor){var rootNode=Element.fromDom(editor.getBody()),rng=editor.selection.getRng();return isEverythingSelected(rootNode,rng)?emptyEditor(editor):deleteRangeMergeBlocks(rootNode,editor.selection)},backspaceDelete$1=function(editor,forward){return!editor.selection.isCollapsed()&&deleteRange(editor)},BlockRangeDelete={backspaceDelete:backspaceDelete$1},isBr$5=function(pos){return getElementFromPosition(pos).exists(isBr$1)},findBr=function(forward,root,pos){var parentBlocks=filter(Parents.parentsAndSelf(Element.fromDom(pos.container()),root),isBlock),scope=head(parentBlocks).getOr(root);return CaretFinder.fromPosition(forward,scope.dom(),pos).filter(isBr$5)},isBeforeBr=function(root,pos){return getElementFromPosition(pos).exists(isBr$1)||findBr(!0,root,pos).isSome()},isAfterBr=function(root,pos){return getElementFromPrevPosition(pos).exists(isBr$1)||findBr(!1,root,pos).isSome()},findPreviousBr=curry(findBr,!1),findNextBr=curry(findBr,!0),isCompoundElement=function(node){return isTableCell(Element.fromDom(node))||isListItem(Element.fromDom(node))},DeleteAction=Adt.generate([{remove:["element"]},{moveToElement:["element"]},{moveToPosition:["position"]}]),isAtContentEditableBlockCaret=function(forward,from){var elm=from.getNode(!1===forward),caretLocation=forward?"after":"before";return NodeType.isElement(elm)&&elm.getAttribute("data-mce-caret")===caretLocation},isDeleteFromCefDifferentBlocks=function(root,forward,from,to){var inSameBlock=function(elm){return isInline(Element.fromDom(elm))&&!isInSameBlock(from,to,root)};return getRelativeCefElm(!forward,from).fold(function(){return getRelativeCefElm(forward,to).fold(constant(!1),inSameBlock)},inSameBlock)},deleteEmptyBlockOrMoveToCef=function(root,forward,from,to){var toCefElm=to.getNode(!1===forward);return DeleteUtils.getParentBlock(Element.fromDom(root),Element.fromDom(from.getNode())).map(function(blockElm){return Empty.isEmpty(blockElm)?DeleteAction.remove(blockElm.dom()):DeleteAction.moveToElement(toCefElm)}).orThunk(function(){return Option.some(DeleteAction.moveToElement(toCefElm))})},findCefPosition=function(root,forward,from){return CaretFinder.fromPosition(forward,root,from).bind(function(to){return isCompoundElement(to.getNode())?Option.none():isDeleteFromCefDifferentBlocks(root,forward,from,to)?Option.none():forward&&NodeType.isContentEditableFalse(to.getNode())?deleteEmptyBlockOrMoveToCef(root,forward,from,to):!1===forward&&NodeType.isContentEditableFalse(to.getNode(!0))?deleteEmptyBlockOrMoveToCef(root,forward,from,to):forward&&isAfterContentEditableFalse(from)?Option.some(DeleteAction.moveToPosition(to)):!1===forward&&isBeforeContentEditableFalse(from)?Option.some(DeleteAction.moveToPosition(to)):Option.none()})},getContentEditableBlockAction=function(forward,elm){return forward&&NodeType.isContentEditableFalse(elm.nextSibling)?Option.some(DeleteAction.moveToElement(elm.nextSibling)):!1===forward&&NodeType.isContentEditableFalse(elm.previousSibling)?Option.some(DeleteAction.moveToElement(elm.previousSibling)):Option.none()},skipMoveToActionFromInlineCefToContent=function(root,from,deleteAction){return deleteAction.fold(function(elm){return Option.some(DeleteAction.remove(elm))},function(elm){return Option.some(DeleteAction.moveToElement(elm))},function(to){return isInSameBlock(from,to,root)?Option.none():Option.some(DeleteAction.moveToPosition(to))})},getContentEditableAction=function(root,forward,from){return isAtContentEditableBlockCaret(forward,from)?getContentEditableBlockAction(forward,from.getNode(!1===forward)).fold(function(){return findCefPosition(root,forward,from)},Option.some):findCefPosition(root,forward,from).bind(function(deleteAction){return skipMoveToActionFromInlineCefToContent(root,from,deleteAction)})},read$4=function(root,forward,rng){var normalizedRange=normalizeRange(forward?1:-1,root,rng),from=CaretPosition$1.fromRangeStart(normalizedRange),rootElement=Element.fromDom(root);return!1===forward&&isAfterContentEditableFalse(from)?Option.some(DeleteAction.remove(from.getNode(!0))):forward&&isBeforeContentEditableFalse(from)?Option.some(DeleteAction.remove(from.getNode())):!1===forward&&isBeforeContentEditableFalse(from)&&isAfterBr(rootElement,from)?findPreviousBr(rootElement,from).map(function(br){return DeleteAction.remove(br.getNode())}):forward&&isAfterContentEditableFalse(from)&&isBeforeBr(rootElement,from)?findNextBr(rootElement,from).map(function(br){return DeleteAction.remove(br.getNode())}):getContentEditableAction(root,forward,from)},deleteElement$1=function(editor,forward){return function(element){return editor._selectionOverrides.hideFakeCaret(),DeleteElement.deleteElement(editor,forward,Element.fromDom(element)),!0}},moveToElement=function(editor,forward){return function(element){var pos=forward?CaretPosition$1.before(element):CaretPosition$1.after(element);return editor.selection.setRng(pos.toRange()),!0}},moveToPosition=function(editor){return function(pos){return editor.selection.setRng(pos.toRange()),!0}},getAncestorCe=function(editor,node){return Option.from(getContentEditableRoot$1(editor.getBody(),node))},backspaceDeleteCaret=function(editor,forward){var selectedNode=editor.selection.getNode();return getAncestorCe(editor,selectedNode).filter(NodeType.isContentEditableFalse).fold(function(){return read$4(editor.getBody(),forward,editor.selection.getRng()).map(function(deleteAction){return deleteAction.fold(deleteElement$1(editor,forward),moveToElement(editor,forward),moveToPosition(editor))}).getOr(!1)},function(){return!0})},deleteOffscreenSelection=function(rootElement){each(descendants$1(rootElement,".mce-offscreen-selection"),remove)},backspaceDeleteRange=function(editor,forward){var selectedNode=editor.selection.getNode();if(NodeType.isContentEditableFalse(selectedNode)){return getAncestorCe(editor,selectedNode.parentNode).filter(NodeType.isContentEditableFalse).fold(function(){return deleteOffscreenSelection(Element.fromDom(editor.getBody())),DeleteElement.deleteElement(editor,forward,Element.fromDom(editor.selection.getNode())),DeleteUtils.paddEmptyBody(editor),!0},function(){return!0})}return!1},getContentEditableRoot$1=function(root,node){for(;node&&node!==root;){if(NodeType.isContentEditableTrue(node)||NodeType.isContentEditableFalse(node))return node;node=node.parentNode}return null},paddEmptyElement=function(editor){var br,ceRoot=getContentEditableRoot$1(editor.getBody(),editor.selection.getNode());return NodeType.isContentEditableTrue(ceRoot)&&editor.dom.isBlock(ceRoot)&&editor.dom.isEmpty(ceRoot)&&(br=editor.dom.create("br",{"data-mce-bogus":"1"}),editor.dom.setHTML(ceRoot,""),ceRoot.appendChild(br),editor.selection.setRng(CaretPosition$1.before(br).toRange())),!0},backspaceDelete$2=function(editor,forward){return editor.selection.isCollapsed()?backspaceDeleteCaret(editor,forward):backspaceDeleteRange(editor,forward)},CefDelete={backspaceDelete:backspaceDelete$2,paddEmptyElement:paddEmptyElement},trimEmptyTextNode$1=function(dom,node){NodeType.isText(node)&&0===node.data.length&&dom.remove(node)},deleteContentAndShowCaret=function(editor,range,node,direction,forward,peekCaretPosition){var caretRange=showCaret(direction,editor,peekCaretPosition.getNode(!forward),forward,!0);if(range.collapsed){var deleteRange=range.cloneRange();forward?deleteRange.setEnd(caretRange.startContainer,caretRange.startOffset):deleteRange.setStart(caretRange.endContainer,caretRange.endOffset),deleteRange.deleteContents()}else range.deleteContents();return editor.selection.setRng(caretRange),trimEmptyTextNode$1(editor.dom,node),!0},deleteCefBoundaryText=function(editor,forward){var range=editor.selection.getRng();if(!NodeType.isText(range.commonAncestorContainer))return!1;var direction=forward?HDirection.Forwards:HDirection.Backwards,caretWalker=CaretWalker(editor.getBody()),getNextVisualCaretPosition=curry(getVisualCaretPosition,caretWalker.next),getPrevVisualCaretPosition=curry(getVisualCaretPosition,caretWalker.prev),getNextPosFn=forward?getNextVisualCaretPosition:getPrevVisualCaretPosition,isBeforeContentEditableFalseFn=forward?isBeforeContentEditableFalse:isAfterContentEditableFalse,caretPosition=getNormalizedRangeEndPoint(direction,editor.getBody(),range),nextCaretPosition=InlineUtils.normalizePosition(forward,getNextPosFn(caretPosition));if(!nextCaretPosition||!isMoveInsideSameBlock(caretPosition,nextCaretPosition))return!1;if(isBeforeContentEditableFalseFn(nextCaretPosition))return deleteContentAndShowCaret(editor,range,caretPosition.getNode(),direction,forward,nextCaretPosition);var peekCaretPosition=getNextPosFn(nextCaretPosition);return!!(peekCaretPosition&&isBeforeContentEditableFalseFn(peekCaretPosition)&&isMoveInsideSameBlock(nextCaretPosition,peekCaretPosition))&&deleteContentAndShowCaret(editor,range,caretPosition.getNode(),direction,forward,peekCaretPosition)},backspaceDelete$3=function(editor,forward){return deleteCefBoundaryText(editor,forward)},CefBoundaryDelete={backspaceDelete:backspaceDelete$3},isFeatureEnabled$1=function(editor){return!1!==editor.settings.inline_boundaries},rangeFromPositions=function(from,to){var range=domGlobals.document.createRange();return range.setStart(from.container(),from.offset()),range.setEnd(to.container(),to.offset()),range},hasOnlyTwoOrLessPositionsLeft=function(elm){return lift2(CaretFinder.firstPositionIn(elm),CaretFinder.lastPositionIn(elm),function(firstPos,lastPos){var normalizedFirstPos=InlineUtils.normalizePosition(!0,firstPos),normalizedLastPos=InlineUtils.normalizePosition(!1,lastPos);return CaretFinder.nextPosition(elm,normalizedFirstPos).map(function(pos){return pos.isEqual(normalizedLastPos)}).getOr(!0)}).getOr(!0)},setCaretLocation=function(editor,caret){return function(location){return BoundaryCaret.renderCaret(caret,location).map(function(pos){return BoundarySelection.setCaretPosition(editor,pos),!0}).getOr(!1)}},deleteFromTo=function(editor,caret,from,to){var rootNode=editor.getBody(),isInlineTarget=curry(InlineUtils.isInlineTarget,editor);editor.undoManager.ignore(function(){editor.selection.setRng(rangeFromPositions(from,to)),editor.execCommand("Delete"),BoundaryLocation.readLocation(isInlineTarget,rootNode,CaretPosition$1.fromRangeStart(editor.selection.getRng())).map(BoundaryLocation.inside).map(setCaretLocation(editor,caret))}),editor.nodeChanged()},rescope$1=function(rootNode,node){var parentBlock=getParentBlock(node,rootNode);return parentBlock||rootNode},backspaceDeleteCollapsed=function(editor,caret,forward,from){var rootNode=rescope$1(editor.getBody(),from.container()),isInlineTarget=curry(InlineUtils.isInlineTarget,editor),fromLocation=BoundaryLocation.readLocation(isInlineTarget,rootNode,from);return fromLocation.bind(function(location){return forward?location.fold(constant(Option.some(BoundaryLocation.inside(location))),Option.none,constant(Option.some(BoundaryLocation.outside(location))),Option.none):location.fold(Option.none,constant(Option.some(BoundaryLocation.outside(location))),Option.none,constant(Option.some(BoundaryLocation.inside(location))))}).map(setCaretLocation(editor,caret)).getOrThunk(function(){var toPosition=CaretFinder.navigate(forward,rootNode,from),toLocation=toPosition.bind(function(pos){return BoundaryLocation.readLocation(isInlineTarget,rootNode,pos)});return fromLocation.isSome()&&toLocation.isSome()?InlineUtils.findRootInline(isInlineTarget,rootNode,from).map(function(elm){return!!hasOnlyTwoOrLessPositionsLeft(elm)&&(DeleteElement.deleteElement(editor,forward,Element.fromDom(elm)),!0)}).getOr(!1):toLocation.bind(function(_){return toPosition.map(function(to){return forward?deleteFromTo(editor,caret,from,to):deleteFromTo(editor,caret,to,from),!0})}).getOr(!1)})},backspaceDelete$4=function(editor,caret,forward){if(editor.selection.isCollapsed()&&isFeatureEnabled$1(editor)){var from=CaretPosition$1.fromRangeStart(editor.selection.getRng());return backspaceDeleteCollapsed(editor,caret,forward,from)}return!1},BoundaryDelete={backspaceDelete:backspaceDelete$4},getParentInlines=function(rootElm,startElm){var parents=Parents.parentsAndSelf(startElm,rootElm);return findIndex(parents,isBlock).fold(constant(parents),function(index){return parents.slice(0,index)})},hasOnlyOneChild=function(elm){return 1===children(elm).length},deleteLastPosition=function(forward,editor,target,parentInlines){var isFormatElement$1=curry(isFormatElement,editor),formatNodes=map(filter(parentInlines,isFormatElement$1),function(elm){return elm.dom()});if(0===formatNodes.length)DeleteElement.deleteElement(editor,forward,target);else{var pos=replaceWithCaretFormat(target.dom(),formatNodes);editor.selection.setRng(pos.toRange())}},deleteCaret=function(editor,forward){var rootElm=Element.fromDom(editor.getBody()),startElm=Element.fromDom(editor.selection.getStart()),parentInlines=filter(getParentInlines(rootElm,startElm),hasOnlyOneChild);return last(parentInlines).map(function(target){var fromPos=CaretPosition$1.fromRangeStart(editor.selection.getRng());return!(!DeleteUtils.willDeleteLastPositionInElement(forward,fromPos,target.dom())||isEmptyCaretFormatElement(target))&&(deleteLastPosition(forward,editor,target,parentInlines),!0)}).getOr(!1)},backspaceDelete$5=function(editor,forward){return!!editor.selection.isCollapsed()&&deleteCaret(editor,forward)},InlineFormatDelete={backspaceDelete:backspaceDelete$5},tableCellRng=function(start,end){return{start:constant(start),end:constant(end)}},tableSelection=function(rng,table,cells){return{rng:constant(rng),table:constant(table),cells:constant(cells)}},deleteAction=Adt.generate([{removeTable:["element"]},{emptyCells:["cells"]}]),isRootFromElement=function(root){return function(cur){return eq(root,cur)}},getClosestCell$1=function(container,isRoot){return closest$1(Element.fromDom(container),"td,th",isRoot)},getClosestTable=function(cell,isRoot){return ancestor$1(cell,"table",isRoot)},isExpandedCellRng=function(cellRng){return!1===eq(cellRng.start(),cellRng.end())},getTableFromCellRng=function(cellRng,isRoot){return getClosestTable(cellRng.start(),isRoot).bind(function(startParentTable){return getClosestTable(cellRng.end(),isRoot).bind(function(endParentTable){return someIf(eq(startParentTable,endParentTable),startParentTable)})})},getTableCells=function(table){return descendants$1(table,"td,th")},getCellRangeFromStartTable=function(cellRng,isRoot){return getClosestTable(cellRng.start(),isRoot).bind(function(table){return last(getTableCells(table)).map(function(endCell){return tableCellRng(cellRng.start(),endCell)})})},partialSelection=function(isRoot,rng){var startCell=getClosestCell$1(rng.startContainer,isRoot),endCell=getClosestCell$1(rng.endContainer,isRoot);return rng.collapsed?Option.none():lift2(startCell,endCell,tableCellRng).fold(function(){return startCell.fold(function(){return endCell.bind(function(endCell){return getClosestTable(endCell,isRoot).bind(function(table){return head(getTableCells(table)).map(function(startCell){return tableCellRng(startCell,endCell)})})})},function(startCell){return getClosestTable(startCell,isRoot).bind(function(table){return last(getTableCells(table)).map(function(endCell){return tableCellRng(startCell,endCell)})})})},function(cellRng){return isWithinSameTable(isRoot,cellRng)?Option.none():getCellRangeFromStartTable(cellRng,isRoot)})},isWithinSameTable=function(isRoot,cellRng){return getTableFromCellRng(cellRng,isRoot).isSome()},getCellRng=function(rng,isRoot){var startCell=getClosestCell$1(rng.startContainer,isRoot),endCell=getClosestCell$1(rng.endContainer,isRoot);return lift2(startCell,endCell,tableCellRng).filter(isExpandedCellRng).filter(function(cellRng){return isWithinSameTable(isRoot,cellRng)}).orThunk(function(){return partialSelection(isRoot,rng)})},getTableSelectionFromCellRng=function(cellRng,isRoot){return getTableFromCellRng(cellRng,isRoot).map(function(table){return tableSelection(cellRng,table,getTableCells(table))})},getTableSelectionFromRng=function(root,rng){var isRoot=isRootFromElement(root);return getCellRng(rng,isRoot).bind(function(cellRng){return getTableSelectionFromCellRng(cellRng,isRoot)})},getCellIndex=function(cells,cell){return findIndex(cells,function(x){return eq(x,cell)})},getSelectedCells=function(tableSelection){return lift2(getCellIndex(tableSelection.cells(),tableSelection.rng().start()),getCellIndex(tableSelection.cells(),tableSelection.rng().end()),function(startIndex,endIndex){return tableSelection.cells().slice(startIndex,endIndex+1)})},getAction=function(tableSelection){return getSelectedCells(tableSelection).map(function(selected){var cells=tableSelection.cells();return selected.length===cells.length?deleteAction.removeTable(tableSelection.table()):deleteAction.emptyCells(selected)})},getActionFromRange=function(root,rng){return getTableSelectionFromRng(root,rng).bind(getAction)},emptyCells=function(editor,cells){return each(cells,PaddingBr.fillWithPaddingBr),editor.selection.setCursorLocation(cells[0].dom(),0),!0},deleteTableElement=function(editor,table){return DeleteElement.deleteElement(editor,!1,table),!0},deleteCellRange=function(editor,rootElm,rng){return getActionFromRange(rootElm,rng).map(function(action){return action.fold(curry(deleteTableElement,editor),curry(emptyCells,editor))})},deleteCaptionRange=function(editor,caption){return emptyElement(editor,caption)},deleteTableRange=function(editor,rootElm,rng,startElm){return getParentCaption(rootElm,startElm).fold(function(){return deleteCellRange(editor,rootElm,rng)},function(caption){return deleteCaptionRange(editor,caption)}).getOr(!1)},deleteRange$1=function(editor,startElm){var rootNode=Element.fromDom(editor.getBody()),rng=editor.selection.getRng(),selectedCells=TableCellSelection.getCellsFromEditor(editor);return 0!==selectedCells.length?emptyCells(editor,selectedCells):deleteTableRange(editor,rootNode,rng,startElm)},getParentCell=function(rootElm,elm){return find(Parents.parentsAndSelf(elm,rootElm),isTableCell)},getParentCaption=function(rootElm,elm){return find(Parents.parentsAndSelf(elm,rootElm),function(elm){return"caption"===name(elm)})},deleteBetweenCells=function(editor,rootElm,forward,fromCell,from){return CaretFinder.navigate(forward,editor.getBody(),from).bind(function(to){return getParentCell(rootElm,Element.fromDom(to.getNode())).map(function(toCell){return!1===eq(toCell,fromCell)})})},emptyElement=function(editor,elm){return PaddingBr.fillWithPaddingBr(elm),editor.selection.setCursorLocation(elm.dom(),0),Option.some(!0)},isDeleteOfLastCharPos=function(fromCaption,forward,from,to){return CaretFinder.firstPositionIn(fromCaption.dom()).bind(function(first){return CaretFinder.lastPositionIn(fromCaption.dom()).map(function(last){return forward?from.isEqual(first)&&to.isEqual(last):from.isEqual(last)&&to.isEqual(first)})}).getOr(!0)},emptyCaretCaption=function(editor,elm){return emptyElement(editor,elm)},validateCaretCaption=function(rootElm,fromCaption,to){return getParentCaption(rootElm,Element.fromDom(to.getNode())).map(function(toCaption){return!1===eq(toCaption,fromCaption)})},deleteCaretInsideCaption=function(editor,rootElm,forward,fromCaption,from){return CaretFinder.navigate(forward,editor.getBody(),from).bind(function(to){return isDeleteOfLastCharPos(fromCaption,forward,from,to)?emptyCaretCaption(editor,fromCaption):validateCaretCaption(rootElm,fromCaption,to)}).or(Option.some(!0))},deleteCaretCells=function(editor,forward,rootElm,startElm){var from=CaretPosition$1.fromRangeStart(editor.selection.getRng());return getParentCell(rootElm,startElm).bind(function(fromCell){return Empty.isEmpty(fromCell)?emptyElement(editor,fromCell):deleteBetweenCells(editor,rootElm,forward,fromCell,from)}).getOr(!1)},deleteCaretCaption=function(editor,forward,rootElm,fromCaption){var from=CaretPosition$1.fromRangeStart(editor.selection.getRng());return Empty.isEmpty(fromCaption)?emptyElement(editor,fromCaption):deleteCaretInsideCaption(editor,rootElm,forward,fromCaption,from)},isNearTable=function(forward,pos){return forward?isBeforeTable(pos):isAfterTable(pos)},isBeforeOrAfterTable=function(editor,forward){var fromPos=CaretPosition$1.fromRangeStart(editor.selection.getRng());return isNearTable(forward,fromPos)||CaretFinder.fromPosition(forward,editor.getBody(),fromPos).map(function(pos){return isNearTable(forward,pos)}).getOr(!1)},deleteCaret$1=function(editor,forward,startElm){var rootElm=Element.fromDom(editor.getBody());return getParentCaption(rootElm,startElm).fold(function(){return deleteCaretCells(editor,forward,rootElm,startElm)||isBeforeOrAfterTable(editor,forward)},function(fromCaption){return deleteCaretCaption(editor,forward,rootElm,fromCaption).getOr(!1)})},backspaceDelete$6=function(editor,forward){var startElm=Element.fromDom(editor.selection.getStart(!0)),cells=TableCellSelection.getCellsFromEditor(editor);return editor.selection.isCollapsed()&&0===cells.length?deleteCaret$1(editor,forward,startElm):deleteRange$1(editor,startElm)},TableDelete={backspaceDelete:backspaceDelete$6},deleteCaret$2=function(editor,forward){var fromPos=CaretPosition$1.fromRangeStart(editor.selection.getRng());return CaretFinder.fromPosition(forward,editor.getBody(),fromPos).filter(function(pos){return forward?isBeforeImageBlock(pos):isAfterImageBlock(pos)}).bind(function(pos){return Option.from(getChildNodeAtRelativeOffset(forward?0:-1,pos))}).map(function(elm){return editor.selection.select(elm),!0}).getOr(!1)},backspaceDelete$7=function(editor,forward){return!!editor.selection.isCollapsed()&&deleteCaret$2(editor,forward)},PageBreakDelete={backspaceDelete:backspaceDelete$7},isEditable$1=function(target){return closest(target,function(elm){return NodeType.isContentEditableTrue(elm.dom())||NodeType.isContentEditableFalse(elm.dom())}).exists(function(elm){return NodeType.isContentEditableTrue(elm.dom())})},parseIndentValue=function(value){var number=parseInt(value,10);return isNaN(number)?0:number},getIndentStyleName=function(useMargin,element){return(useMargin||isTable$1(element)?"margin":"padding")+("rtl"===get$4(element,"direction")?"-right":"-left")},indentElement=function(dom,command,useMargin,value,unit,element){var indentStyleName=getIndentStyleName(useMargin,Element.fromDom(element));if("outdent"===command){var styleValue=Math.max(0,parseIndentValue(element.style[indentStyleName])-value);dom.setStyle(element,indentStyleName,styleValue?styleValue+unit:"")}else{var styleValue=parseIndentValue(element.style[indentStyleName])+value+unit;dom.setStyle(element,indentStyleName,styleValue)}},validateBlocks=function(editor,blocks){return forall(blocks,function(block){var indentStyleName=getIndentStyleName(Settings.shouldIndentUseMargin(editor),block),intentValue=getRaw(block,indentStyleName).map(parseIndentValue).getOr(0);return"false"!==editor.dom.getContentEditable(block.dom())&&intentValue>0})},canOutdent=function(editor){var blocks=getBlocksToIndent(editor);return!0!==editor.readonly&&(blocks.length>1||validateBlocks(editor,blocks))},isListComponent=function(el){return isList(el)||isListItem(el)},parentIsListComponent=function(el){return parent(el).map(isListComponent).getOr(!1)},getBlocksToIndent=function(editor){return filter(map(editor.selection.getSelectedBlocks(),Element.fromDom),function(el){return!isListComponent(el)&&!parentIsListComponent(el)&&isEditable$1(el)})},handle=function(editor,command){var dom=editor.dom,selection=editor.selection,formatter=editor.formatter,indentation=Settings.getIndentation(editor),indentUnit=/[a-z%]+$/i.exec(indentation)[0],indentValue=parseInt(indentation,10),useMargin=Settings.shouldIndentUseMargin(editor),forcedRootBlock=Settings.getForcedRootBlock(editor);editor.queryCommandState("InsertUnorderedList")||editor.queryCommandState("InsertOrderedList")||""!==forcedRootBlock||dom.getParent(selection.getNode(),dom.isBlock)||formatter.apply("div"),each(getBlocksToIndent(editor),function(block){indentElement(dom,command,useMargin,indentValue,indentUnit,block.dom())})},navigateIgnoreEmptyTextNodes=function(forward,root,from){return CaretFinder.navigateIgnore(forward,root,from,isEmptyText)},getClosestBlock=function(root,pos){return find(Parents.parentsAndSelf(Element.fromDom(pos.container()),root),isBlock)},isAtBeforeAfterBlockBoundary=function(forward,root,pos){return navigateIgnoreEmptyTextNodes(forward,root.dom(),pos).forall(function(newPos){return getClosestBlock(root,pos).fold(function(){return!1===isInSameBlock(newPos,pos,root.dom())},function(fromBlock){return!1===isInSameBlock(newPos,pos,root.dom())&&contains$2(fromBlock,Element.fromDom(newPos.container()))})})},isAtBlockBoundary=function(forward,root,pos){return getClosestBlock(root,pos).fold(function(){return navigateIgnoreEmptyTextNodes(forward,root.dom(),pos).forall(function(newPos){return!1===isInSameBlock(newPos,pos,root.dom())})},function(parent){return navigateIgnoreEmptyTextNodes(forward,parent.dom(),pos).isNone()})},isAtStartOfBlock=curry(isAtBlockBoundary,!1),isAtEndOfBlock=curry(isAtBlockBoundary,!0),isBeforeBlock=curry(isAtBeforeAfterBlockBoundary,!1),isAfterBlock=curry(isAtBeforeAfterBlockBoundary,!0),backspaceDelete$8=function(editor,_caret,_forward){if(editor.selection.isCollapsed()&&canOutdent(editor)){var dom=editor.dom,rng=editor.selection.getRng(),pos=CaretPosition$1.fromRangeStart(rng),block=dom.getParent(rng.startContainer,dom.isBlock);if(null!==block&&isAtStartOfBlock(Element.fromDom(block),pos))return handle(editor,"outdent"),!0}return!1},Outdent={backspaceDelete:backspaceDelete$8},executeKeydownOverride$1=function(editor,caret,evt){MatchKeys.execute([{keyCode:VK.BACKSPACE,action:MatchKeys.action(Outdent.backspaceDelete,editor,!1)},{keyCode:VK.BACKSPACE,action:MatchKeys.action(CefDelete.backspaceDelete,editor,!1)},{keyCode:VK.DELETE,action:MatchKeys.action(CefDelete.backspaceDelete,editor,!0)},{keyCode:VK.BACKSPACE,action:MatchKeys.action(CefBoundaryDelete.backspaceDelete,editor,!1)},{keyCode:VK.DELETE,action:MatchKeys.action(CefBoundaryDelete.backspaceDelete,editor,!0)},{keyCode:VK.BACKSPACE,action:MatchKeys.action(BoundaryDelete.backspaceDelete,editor,caret,!1)},{keyCode:VK.DELETE,action:MatchKeys.action(BoundaryDelete.backspaceDelete,editor,caret,!0)},{keyCode:VK.BACKSPACE,action:MatchKeys.action(TableDelete.backspaceDelete,editor,!1)},{keyCode:VK.DELETE,action:MatchKeys.action(TableDelete.backspaceDelete,editor,!0)},{keyCode:VK.BACKSPACE,action:MatchKeys.action(PageBreakDelete.backspaceDelete,editor,!1)},{keyCode:VK.DELETE,action:MatchKeys.action(PageBreakDelete.backspaceDelete,editor,!0)},{keyCode:VK.BACKSPACE,action:MatchKeys.action(BlockRangeDelete.backspaceDelete,editor,!1)},{keyCode:VK.DELETE,action:MatchKeys.action(BlockRangeDelete.backspaceDelete,editor,!0)},{keyCode:VK.BACKSPACE,action:MatchKeys.action(BlockBoundaryDelete.backspaceDelete,editor,!1)},{keyCode:VK.DELETE,action:MatchKeys.action(BlockBoundaryDelete.backspaceDelete,editor,!0)},{keyCode:VK.BACKSPACE,action:MatchKeys.action(InlineFormatDelete.backspaceDelete,editor,!1)},{keyCode:VK.DELETE,action:MatchKeys.action(InlineFormatDelete.backspaceDelete,editor,!0)}],evt).each(function(_){evt.preventDefault()})},executeKeyupOverride=function(editor,evt){MatchKeys.execute([{keyCode:VK.BACKSPACE,action:MatchKeys.action(CefDelete.paddEmptyElement,editor)},{keyCode:VK.DELETE,action:MatchKeys.action(CefDelete.paddEmptyElement,editor)}],evt)},setup$a=function(editor,caret){editor.on("keydown",function(evt){!1===evt.isDefaultPrevented()&&executeKeydownOverride$1(editor,caret,evt)}),editor.on("keyup",function(evt){!1===evt.isDefaultPrevented()&&executeKeyupOverride(editor,evt)})},DeleteBackspaceKeys={setup:setup$a},firstNonWhiteSpaceNodeSibling=function(node){for(;node;){if(1===node.nodeType||3===node.nodeType&&node.data&&/[\r\n\s]/.test(node.data))return node;node=node.nextSibling}},moveToCaretPosition=function(editor,root){var node,rng,lastNode=root,dom=editor.dom,moveCaretBeforeOnEnterElementsMap=editor.schema.getMoveCaretBeforeOnEnterElements();if(root){if(/^(LI|DT|DD)$/.test(root.nodeName)){var firstChild=firstNonWhiteSpaceNodeSibling(root.firstChild);firstChild&&/^(UL|OL|DL)$/.test(firstChild.nodeName)&&root.insertBefore(dom.doc.createTextNode(" "),root.firstChild)}if(rng=dom.createRng(),root.normalize(),root.hasChildNodes()){for(var walker=new TreeWalker(root,root);node=walker.current();){if(NodeType.isText(node)){rng.setStart(node,0),rng.setEnd(node,0);break}if(moveCaretBeforeOnEnterElementsMap[node.nodeName.toLowerCase()]){rng.setStartBefore(node),rng.setEndBefore(node);break}lastNode=node,node=walker.next()}node||(rng.setStart(lastNode,0),rng.setEnd(lastNode,0))}else NodeType.isBr(root)?root.nextSibling&&dom.isBlock(root.nextSibling)?(rng.setStartBefore(root),rng.setEndBefore(root)):(rng.setStartAfter(root),rng.setEndAfter(root)):(rng.setStart(root,0),rng.setEnd(root,0));editor.selection.setRng(rng),ScrollIntoView.scrollRangeIntoView(editor,rng)}},getEditableRoot=function(dom,node){var parent,editableRoot,root=dom.getRoot();for(parent=node;parent!==root&&"false"!==dom.getContentEditable(parent);)"true"===dom.getContentEditable(parent)&&(editableRoot=parent),parent=parent.parentNode;return parent!==root?editableRoot:root},getParentBlock$2=function(editor){return Option.from(editor.dom.getParent(editor.selection.getStart(!0),editor.dom.isBlock))},getParentBlockName=function(editor){return getParentBlock$2(editor).fold(constant(""),function(parentBlock){return parentBlock.nodeName.toUpperCase()})},isListItemParentBlock=function(editor){return getParentBlock$2(editor).filter(function(elm){return isListItem(Element.fromDom(elm))}).isSome()},NewLineUtils={moveToCaretPosition:moveToCaretPosition,getEditableRoot:getEditableRoot,getParentBlock:getParentBlock$2,getParentBlockName:getParentBlockName,isListItemParentBlock:isListItemParentBlock},hasFirstChild=function(elm,name){return elm.firstChild&&elm.firstChild.nodeName===name},hasParent$1=function(elm,parentName){return elm&&elm.parentNode&&elm.parentNode.nodeName===parentName},isListBlock=function(elm){return elm&&/^(OL|UL|LI)$/.test(elm.nodeName)},isNestedList=function(elm){return isListBlock(elm)&&isListBlock(elm.parentNode)},getContainerBlock=function(containerBlock){var containerBlockParent=containerBlock.parentNode;return/^(LI|DT|DD)$/.test(containerBlockParent.nodeName)?containerBlockParent:containerBlock},isFirstOrLastLi=function(containerBlock,parentBlock,first){for(var node=containerBlock[first?"firstChild":"lastChild"];node&&!NodeType.isElement(node);)node=node[first?"nextSibling":"previousSibling"];return node===parentBlock},insert=function(editor,createNewBlock,containerBlock,parentBlock,newBlockName){var dom=editor.dom,rng=editor.selection.getRng();if(containerBlock!==editor.getBody()){isNestedList(containerBlock)&&(newBlockName="LI");var newBlock=newBlockName?createNewBlock(newBlockName):dom.create("BR");if(isFirstOrLastLi(containerBlock,parentBlock,!0)&&isFirstOrLastLi(containerBlock,parentBlock,!1))hasParent$1(containerBlock,"LI")?dom.insertAfter(newBlock,getContainerBlock(containerBlock)):dom.replace(newBlock,containerBlock);else if(isFirstOrLastLi(containerBlock,parentBlock,!0))hasParent$1(containerBlock,"LI")?(dom.insertAfter(newBlock,getContainerBlock(containerBlock)),newBlock.appendChild(dom.doc.createTextNode(" ")),newBlock.appendChild(containerBlock)):containerBlock.parentNode.insertBefore(newBlock,containerBlock);else if(isFirstOrLastLi(containerBlock,parentBlock,!1))dom.insertAfter(newBlock,getContainerBlock(containerBlock));else{containerBlock=getContainerBlock(containerBlock);var tmpRng=rng.cloneRange();tmpRng.setStartAfter(parentBlock),tmpRng.setEndAfter(containerBlock);var fragment=tmpRng.extractContents();"LI"===newBlockName&&hasFirstChild(fragment,"LI")?(newBlock=fragment.firstChild,dom.insertAfter(fragment,containerBlock)):(dom.insertAfter(fragment,containerBlock),dom.insertAfter(newBlock,containerBlock))}dom.remove(parentBlock),NewLineUtils.moveToCaretPosition(editor,newBlock)}},InsertLi={insert:insert},trimZwsp=function(fragment){each(descendants(Element.fromDom(fragment),isText),function(text){var rawNode=text.dom();rawNode.nodeValue=Zwsp.trim(rawNode.nodeValue)})},isEmptyAnchor=function(dom,elm){return elm&&"A"===elm.nodeName&&dom.isEmpty(elm)},isTableCell$4=function(node){return node&&/^(TD|TH|CAPTION)$/.test(node.nodeName)},emptyBlock=function(elm){elm.innerHTML='<br data-mce-bogus="1">'},containerAndSiblingName=function(container,nodeName){return container.nodeName===nodeName||container.previousSibling&&container.previousSibling.nodeName===nodeName},canSplitBlock=function(dom,node){return node&&dom.isBlock(node)&&!/^(TD|TH|CAPTION|FORM)$/.test(node.nodeName)&&!/^(fixed|absolute)/i.test(node.style.position)&&"true"!==dom.getContentEditable(node)},trimInlineElementsOnLeftSideOfBlock=function(dom,nonEmptyElementsMap,block){var i,node=block,firstChilds=[];if(node){for(;node=node.firstChild;){if(dom.isBlock(node))return;NodeType.isElement(node)&&!nonEmptyElementsMap[node.nodeName.toLowerCase()]&&firstChilds.push(node)}for(i=firstChilds.length;i--;)node=firstChilds[i],!node.hasChildNodes()||node.firstChild===node.lastChild&&""===node.firstChild.nodeValue?dom.remove(node):isEmptyAnchor(dom,node)&&dom.remove(node)}},normalizeZwspOffset=function(start,container,offset){return!1===NodeType.isText(container)?offset:start?1===offset&&container.data.charAt(offset-1)===Zwsp.ZWSP?0:offset:offset===container.data.length-1&&container.data.charAt(offset)===Zwsp.ZWSP?container.data.length:offset},includeZwspInRange=function(rng){var newRng=rng.cloneRange();return newRng.setStart(rng.startContainer,normalizeZwspOffset(!0,rng.startContainer,rng.startOffset)),newRng.setEnd(rng.endContainer,normalizeZwspOffset(!1,rng.endContainer,rng.endOffset)),newRng},trimLeadingLineBreaks=function(node){do{NodeType.isText(node)&&(node.nodeValue=node.nodeValue.replace(/^[\r\n]+/,"")),node=node.firstChild}while(node)},getEditableRoot$1=function(dom,node){var parent,editableRoot,root=dom.getRoot();for(parent=node;parent!==root&&"false"!==dom.getContentEditable(parent);)"true"===dom.getContentEditable(parent)&&(editableRoot=parent),parent=parent.parentNode;return parent!==root?editableRoot:root},setForcedBlockAttrs=function(editor,node){var forcedRootBlockName=Settings.getForcedRootBlock(editor);forcedRootBlockName&&forcedRootBlockName.toLowerCase()===node.tagName.toLowerCase()&&editor.dom.setAttribs(node,Settings.getForcedRootBlockAttrs(editor))},wrapSelfAndSiblingsInDefaultBlock=function(editor,newBlockName,rng,container,offset){var newBlock,parentBlock,startNode,node,next,rootBlockName,blockName=newBlockName||"P",dom=editor.dom,editableRoot=getEditableRoot$1(dom,container);if(!(parentBlock=dom.getParent(container,dom.isBlock))||!canSplitBlock(dom,parentBlock)){if(parentBlock=parentBlock||editableRoot,rootBlockName=parentBlock===editor.getBody()||isTableCell$4(parentBlock)?parentBlock.nodeName.toLowerCase():parentBlock.parentNode.nodeName.toLowerCase(),!parentBlock.hasChildNodes())return newBlock=dom.create(blockName),setForcedBlockAttrs(editor,newBlock),parentBlock.appendChild(newBlock),rng.setStart(newBlock,0),rng.setEnd(newBlock,0),newBlock;for(node=container;node.parentNode!==parentBlock;)node=node.parentNode;for(;node&&!dom.isBlock(node);)startNode=node,node=node.previousSibling;if(startNode&&editor.schema.isValidChild(rootBlockName,blockName.toLowerCase())){for(newBlock=dom.create(blockName),setForcedBlockAttrs(editor,newBlock),startNode.parentNode.insertBefore(newBlock,startNode),node=startNode;node&&!dom.isBlock(node);)next=node.nextSibling,newBlock.appendChild(node),node=next;rng.setStart(container,offset),rng.setEnd(container,offset)}}return container},addBrToBlockIfNeeded=function(dom,block){var lastChild;block.normalize(),(lastChild=block.lastChild)&&!/^(left|right)$/gi.test(dom.getStyle(lastChild,"float",!0))||dom.add(block,"br")},insert$1=function(editor,evt){var tmpRng,editableRoot,container,offset,parentBlock,shiftKey,newBlock,fragment,containerBlock,parentBlockName,containerBlockName,newBlockName,isAfterLastNodeInContainer,dom=editor.dom,schema=editor.schema,nonEmptyElementsMap=schema.getNonEmptyElements(),rng=editor.selection.getRng(),createNewBlock=function(name){var block,clonedNode,caretNode,node=container,textInlineElements=schema.getTextInlineElements();if(name||"TABLE"===parentBlockName||"HR"===parentBlockName?(block=dom.create(name||newBlockName),setForcedBlockAttrs(editor,block)):block=parentBlock.cloneNode(!1),caretNode=block,!1===Settings.shouldKeepStyles(editor))dom.setAttrib(block,"style",null),dom.setAttrib(block,"class",null);else do{if(textInlineElements[node.nodeName]){if(isCaretNode(node)||Bookmarks.isBookmarkNode(node))continue;clonedNode=node.cloneNode(!1),dom.setAttrib(clonedNode,"id",""),block.hasChildNodes()?(clonedNode.appendChild(block.firstChild),block.appendChild(clonedNode)):(caretNode=clonedNode,block.appendChild(clonedNode))}}while((node=node.parentNode)&&node!==editableRoot);return emptyBlock(caretNode),block},isCaretAtStartOrEndOfBlock=function(start){var node,name,normalizedOffset=normalizeZwspOffset(start,container,offset);if(NodeType.isText(container)&&(start?normalizedOffset>0:normalizedOffset<container.nodeValue.length))return!1;if(container.parentNode===parentBlock&&isAfterLastNodeInContainer&&!start)return!0;if(start&&NodeType.isElement(container)&&container===parentBlock.firstChild)return!0;if(containerAndSiblingName(container,"TABLE")||containerAndSiblingName(container,"HR"))return isAfterLastNodeInContainer&&!start||!isAfterLastNodeInContainer&&start;var walker=new TreeWalker(container,parentBlock);for(NodeType.isText(container)&&(start&&0===normalizedOffset?walker.prev():start||normalizedOffset!==container.nodeValue.length||walker.next());node=walker.current();){if(NodeType.isElement(node)){if(!node.getAttribute("data-mce-bogus")&&(name=node.nodeName.toLowerCase(),nonEmptyElementsMap[name]&&"br"!==name))return!1}else if(NodeType.isText(node)&&!/^[ \t\r\n]*$/.test(node.nodeValue))return!1;start?walker.prev():walker.next()}return!0},insertNewBlockAfter=function(){newBlock=/^(H[1-6]|PRE|FIGURE)$/.test(parentBlockName)&&"HGROUP"!==containerBlockName?createNewBlock(newBlockName):createNewBlock(),Settings.shouldEndContainerOnEmptyBlock(editor)&&canSplitBlock(dom,containerBlock)&&dom.isEmpty(parentBlock)?newBlock=dom.split(containerBlock,parentBlock):dom.insertAfter(newBlock,parentBlock),NewLineUtils.moveToCaretPosition(editor,newBlock)};NormalizeRange.normalize(dom,rng).each(function(normRng){rng.setStart(normRng.startContainer,normRng.startOffset),rng.setEnd(normRng.endContainer,normRng.endOffset)}),container=rng.startContainer,offset=rng.startOffset,newBlockName=Settings.getForcedRootBlock(editor),shiftKey=!(!evt||!evt.shiftKey);var ctrlKey=!(!evt||!evt.ctrlKey);if(NodeType.isElement(container)&&container.hasChildNodes()&&(isAfterLastNodeInContainer=offset>container.childNodes.length-1,container=container.childNodes[Math.min(offset,container.childNodes.length-1)]||container,offset=isAfterLastNodeInContainer&&NodeType.isText(container)?container.nodeValue.length:0),editableRoot=getEditableRoot$1(dom,container)){if((newBlockName&&!shiftKey||!newBlockName&&shiftKey)&&(container=wrapSelfAndSiblingsInDefaultBlock(editor,newBlockName,rng,container,offset)),parentBlock=dom.getParent(container,dom.isBlock),containerBlock=parentBlock?dom.getParent(parentBlock.parentNode,dom.isBlock):null,parentBlockName=parentBlock?parentBlock.nodeName.toUpperCase():"",containerBlockName=containerBlock?containerBlock.nodeName.toUpperCase():"","LI"!==containerBlockName||ctrlKey||(parentBlock=containerBlock,containerBlock=containerBlock.parentNode,parentBlockName=containerBlockName),/^(LI|DT|DD)$/.test(parentBlockName)&&dom.isEmpty(parentBlock))return void InsertLi.insert(editor,createNewBlock,containerBlock,parentBlock,newBlockName);newBlockName&&parentBlock===editor.getBody()||(newBlockName=newBlockName||"P",isCaretContainerBlock(parentBlock)?(newBlock=showCaretContainerBlock(parentBlock),dom.isEmpty(parentBlock)&&emptyBlock(parentBlock),NewLineUtils.moveToCaretPosition(editor,newBlock)):isCaretAtStartOrEndOfBlock()?insertNewBlockAfter():isCaretAtStartOrEndOfBlock(!0)?(newBlock=parentBlock.parentNode.insertBefore(createNewBlock(),parentBlock),NewLineUtils.moveToCaretPosition(editor,containerAndSiblingName(parentBlock,"HR")?newBlock:parentBlock)):(tmpRng=includeZwspInRange(rng).cloneRange(),tmpRng.setEndAfter(parentBlock),fragment=tmpRng.extractContents(),trimZwsp(fragment),trimLeadingLineBreaks(fragment),newBlock=fragment.firstChild,dom.insertAfter(fragment,parentBlock),trimInlineElementsOnLeftSideOfBlock(dom,nonEmptyElementsMap,newBlock),addBrToBlockIfNeeded(dom,parentBlock),dom.isEmpty(parentBlock)&&emptyBlock(parentBlock),newBlock.normalize(),dom.isEmpty(newBlock)?(dom.remove(newBlock),insertNewBlockAfter()):NewLineUtils.moveToCaretPosition(editor,newBlock)),dom.setAttrib(newBlock,"id",""),editor.fire("NewBlock",{newBlock:newBlock}))}},InsertBlock={insert:insert$1},hasRightSideContent=function(schema,container,parentBlock){for(var node,walker=new TreeWalker(container,parentBlock),nonEmptyElementsMap=schema.getNonEmptyElements();node=walker.next();)if(nonEmptyElementsMap[node.nodeName.toLowerCase()]||node.length>0)return!0},scrollToBr=function(dom,selection,brElm){var marker=dom.create("span",{},"&nbsp;");brElm.parentNode.insertBefore(marker,brElm),selection.scrollIntoView(marker),dom.remove(marker)},moveSelectionToBr=function(dom,selection,brElm,extraBr){var rng=dom.createRng();extraBr?(rng.setStartBefore(brElm),rng.setEndBefore(brElm)):(rng.setStartAfter(brElm),rng.setEndAfter(brElm)),selection.setRng(rng)},insertBrAtCaret=function(editor,evt){var brElm,extraBr,selection=editor.selection,dom=editor.dom,rng=selection.getRng();NormalizeRange.normalize(dom,rng).each(function(normRng){rng.setStart(normRng.startContainer,normRng.startOffset),rng.setEnd(normRng.endContainer,normRng.endOffset)});var offset=rng.startOffset,container=rng.startContainer;if(1===container.nodeType&&container.hasChildNodes()){var isAfterLastNodeInContainer=offset>container.childNodes.length-1;container=container.childNodes[Math.min(offset,container.childNodes.length-1)]||container,offset=isAfterLastNodeInContainer&&3===container.nodeType?container.nodeValue.length:0}var parentBlock=dom.getParent(container,dom.isBlock),containerBlock=parentBlock?dom.getParent(parentBlock.parentNode,dom.isBlock):null,containerBlockName=containerBlock?containerBlock.nodeName.toUpperCase():"",isControlKey=!(!evt||!evt.ctrlKey);"LI"!==containerBlockName||isControlKey||(parentBlock=containerBlock),container&&3===container.nodeType&&offset>=container.nodeValue.length&&(hasRightSideContent(editor.schema,container,parentBlock)||(brElm=dom.create("br"),rng.insertNode(brElm),rng.setStartAfter(brElm),rng.setEndAfter(brElm),extraBr=!0)),brElm=dom.create("br"),rangeInsertNode(dom,rng,brElm),scrollToBr(dom,selection,brElm),moveSelectionToBr(dom,selection,brElm,extraBr),editor.undoManager.add()},insertBrBefore=function(editor,inline){var br=Element.fromTag("br");before(Element.fromDom(inline),br),editor.undoManager.add()},insertBrAfter=function(editor,inline){hasBrAfter(editor.getBody(),inline)||after(Element.fromDom(inline),Element.fromTag("br"));var br=Element.fromTag("br");after(Element.fromDom(inline),br),scrollToBr(editor.dom,editor.selection,br.dom()),moveSelectionToBr(editor.dom,editor.selection,br.dom(),!1),editor.undoManager.add()},isBeforeBr$1=function(pos){return NodeType.isBr(pos.getNode())},hasBrAfter=function(rootNode,startNode){return!!isBeforeBr$1(CaretPosition$1.after(startNode))||CaretFinder.nextPosition(rootNode,CaretPosition$1.after(startNode)).map(function(pos){return NodeType.isBr(pos.getNode())}).getOr(!1)},isAnchorLink=function(elm){return elm&&"A"===elm.nodeName&&"href"in elm},isInsideAnchor=function(location){return location.fold(constant(!1),isAnchorLink,isAnchorLink,constant(!1))},readInlineAnchorLocation=function(editor){var isInlineTarget=curry(InlineUtils.isInlineTarget,editor),position=CaretPosition$1.fromRangeStart(editor.selection.getRng());return BoundaryLocation.readLocation(isInlineTarget,editor.getBody(),position).filter(isInsideAnchor)},insertBrOutsideAnchor=function(editor,location){location.fold(noop,curry(insertBrBefore,editor),curry(insertBrAfter,editor),noop)},insert$2=function(editor,evt){var anchorLocation=readInlineAnchorLocation(editor);anchorLocation.isSome()?anchorLocation.each(curry(insertBrOutsideAnchor,editor)):insertBrAtCaret(editor,evt)},InsertBr={insert:insert$2},matchesSelector=function(editor,selector){return NewLineUtils.getParentBlock(editor).filter(function(parentBlock){return selector.length>0&&is(Element.fromDom(parentBlock),selector)}).isSome()},shouldInsertBr=function(editor){return matchesSelector(editor,Settings.getBrNewLineSelector(editor))},shouldBlockNewLine=function(editor){return matchesSelector(editor,Settings.getNoNewLineSelector(editor))},ContextSelectors={shouldInsertBr:shouldInsertBr,shouldBlockNewLine:shouldBlockNewLine},newLineAction=Adt.generate([{br:[]},{block:[]},{none:[]}]),shouldBlockNewLine$1=function(editor,shiftKey){return ContextSelectors.shouldBlockNewLine(editor)},isBrMode=function(requiredState){return function(editor,shiftKey){return""===Settings.getForcedRootBlock(editor)===requiredState}},inListBlock=function(requiredState){return function(editor,shiftKey){return NewLineUtils.isListItemParentBlock(editor)===requiredState}},inBlock=function(blockName,requiredState){return function(editor,shiftKey){return NewLineUtils.getParentBlockName(editor)===blockName.toUpperCase()===requiredState}},inPreBlock=function(requiredState){return inBlock("pre",requiredState)},inSummaryBlock=function(){return inBlock("summary",!0)},shouldPutBrInPre$1=function(requiredState){return function(editor,shiftKey){return Settings.shouldPutBrInPre(editor)===requiredState}},inBrContext=function(editor,shiftKey){return ContextSelectors.shouldInsertBr(editor)},hasShiftKey=function(editor,shiftKey){return shiftKey},canInsertIntoEditableRoot=function(editor){var forcedRootBlock=Settings.getForcedRootBlock(editor),rootEditable=NewLineUtils.getEditableRoot(editor.dom,editor.selection.getStart());return rootEditable&&editor.schema.isValidChild(rootEditable.nodeName,forcedRootBlock||"P")},match$2=function(predicates,action){return function(editor,shiftKey){return foldl(predicates,function(res,p){return res&&p(editor,shiftKey)},!0)?Option.some(action):Option.none()}},getAction$1=function(editor,evt){return LazyEvaluator.evaluateUntil([match$2([shouldBlockNewLine$1],newLineAction.none()),match$2([inSummaryBlock()],newLineAction.br()),match$2([inPreBlock(!0),shouldPutBrInPre$1(!1),hasShiftKey],newLineAction.br()),match$2([inPreBlock(!0),shouldPutBrInPre$1(!1)],newLineAction.block()),match$2([inPreBlock(!0),shouldPutBrInPre$1(!0),hasShiftKey],newLineAction.block()),match$2([inPreBlock(!0),shouldPutBrInPre$1(!0)],newLineAction.br()),match$2([inListBlock(!0),hasShiftKey],newLineAction.br()),match$2([inListBlock(!0)],newLineAction.block()),match$2([isBrMode(!0),hasShiftKey,canInsertIntoEditableRoot],newLineAction.block()),match$2([isBrMode(!0)],newLineAction.br()),match$2([inBrContext],newLineAction.br()),match$2([isBrMode(!1),hasShiftKey],newLineAction.br()),match$2([canInsertIntoEditableRoot],newLineAction.block())],[editor,!(!evt||!evt.shiftKey)]).getOr(newLineAction.none())},NewLineAction={getAction:getAction$1},insert$3=function(editor,evt){NewLineAction.getAction(editor,evt).fold(function(){InsertBr.insert(editor,evt)},function(){InsertBlock.insert(editor,evt)},noop)},InsertNewLine={insert:insert$3},handleEnterKeyEvent=function(editor,event){event.isDefaultPrevented()||(event.preventDefault(),endTypingLevelIgnoreLocks(editor.undoManager),editor.undoManager.transact(function(){!1===editor.selection.isCollapsed()&&editor.execCommand("Delete"),InsertNewLine.insert(editor,event)}))},setup$b=function(editor){editor.on("keydown",function(event){event.keyCode===VK.ENTER&&handleEnterKeyEvent(editor,event)})},EnterKey={setup:setup$b},insertTextAtPosition=function(text,pos){var container=pos.container(),offset=pos.offset();return NodeType.isText(container)?(container.insertData(offset,text),Option.some(CaretPosition(container,offset+text.length))):getElementFromPosition(pos).map(function(elm){var textNode=Element.fromText(text);return pos.isAtEnd()?after(elm,textNode):before(elm,textNode),CaretPosition(textNode.dom(),text.length)})},insertNbspAtPosition=curry(insertTextAtPosition," "),insertSpaceAtPosition=curry(insertTextAtPosition," "),isInMiddleOfText=function(pos){return CaretPosition.isTextPosition(pos)&&!pos.isAtStart()&&!pos.isAtEnd()},getClosestBlock$1=function(root,pos){var parentBlocks=filter(Parents.parentsAndSelf(Element.fromDom(pos.container()),root),isBlock);return head(parentBlocks).getOr(root)},hasSpaceBefore=function(root,pos){return isInMiddleOfText(pos)?isAfterSpace(pos):isAfterSpace(pos)||CaretFinder.prevPosition(getClosestBlock$1(root,pos).dom(),pos).exists(isAfterSpace)},hasSpaceAfter=function(root,pos){return isInMiddleOfText(pos)?isBeforeSpace(pos):isBeforeSpace(pos)||CaretFinder.nextPosition(getClosestBlock$1(root,pos).dom(),pos).exists(isBeforeSpace)},isPreValue=function(value){return contains(["pre","pre-wrap"],value)},isInPre=function(pos){return getElementFromPosition(pos).bind(function(elm){return closest(elm,isElement)}).exists(function(elm){return isPreValue(get$4(elm,"white-space"))})},isAtBeginningOfBody=function(root,pos){return CaretFinder.prevPosition(root.dom(),pos).isNone()},isAtEndOfBody=function(root,pos){return CaretFinder.nextPosition(root.dom(),pos).isNone()},isAtLineBoundary=function(root,pos){return isAtBeginningOfBody(root,pos)||isAtEndOfBody(root,pos)||isAtStartOfBlock(root,pos)||isAtEndOfBlock(root,pos)||isAfterBr(root,pos)||isBeforeBr(root,pos)},needsToHaveNbsp=function(root,pos){return!isInPre(pos)&&(isAtLineBoundary(root,pos)||hasSpaceBefore(root,pos)||hasSpaceAfter(root,pos))},needsToBeNbspLeft=function(root,pos){return!isInPre(pos)&&(isAtStartOfBlock(root,pos)||isBeforeBlock(root,pos)||isAfterBr(root,pos)||hasSpaceBefore(root,pos))},leanRight=function(pos){var container=pos.container(),offset=pos.offset();return NodeType.isText(container)&&offset<container.data.length?CaretPosition(container,offset+1):pos},needsToBeNbspRight=function(root,pos){var afterPos=leanRight(pos);return!isInPre(afterPos)&&(isAtEndOfBlock(root,afterPos)||isAfterBlock(root,afterPos)||isBeforeBr(root,afterPos)||hasSpaceAfter(root,afterPos))},needsToBeNbsp=function(root,pos){return needsToBeNbspLeft(root,pos)||needsToBeNbspRight(root,pos)},isNbspAt=function(text,offset){return isNbsp(text.charAt(offset))},hasNbsp=function(pos){var container=pos.container();return NodeType.isText(container)&&contains$1(container.data," ")},normalizeNbspMiddle=function(text){var chars=text.split("");return map(chars,function(chr,i){return isNbsp(chr)&&i>0&&i<chars.length-1&&isContent(chars[i-1])&&isContent(chars[i+1])?" ":chr}).join("")},normalizeNbspAtStart=function(root,node){var text=node.data,firstPos=CaretPosition(node,0);return!(!isNbspAt(text,0)||needsToBeNbsp(root,firstPos))&&(node.data=" "+text.slice(1),!0)},normalizeNbspInMiddleOfTextNode=function(node){var text=node.data,newText=normalizeNbspMiddle(text);return newText!==text&&(node.data=newText,!0)},normalizeNbspAtEnd=function(root,node){var text=node.data,lastPos=CaretPosition(node,text.length-1);return!(!isNbspAt(text,text.length-1)||needsToBeNbsp(root,lastPos))&&(node.data=text.slice(0,-1)+" ",!0)},normalizeNbsps=function(root,pos){return Option.some(pos).filter(hasNbsp).bind(function(pos){var container=pos.container();return normalizeNbspAtStart(root,container)||normalizeNbspInMiddleOfTextNode(container)||normalizeNbspAtEnd(root,container)?Option.some(pos):Option.none()})},normalizeNbspsInEditor=function(editor){var root=Element.fromDom(editor.getBody());editor.selection.isCollapsed()&&normalizeNbsps(root,CaretPosition.fromRangeStart(editor.selection.getRng())).each(function(pos){editor.selection.setRng(pos.toRange())})},locationToCaretPosition=function(root){return function(location){return location.fold(function(element){return CaretFinder.prevPosition(root.dom(),CaretPosition$1.before(element))},function(element){return CaretFinder.firstPositionIn(element)},function(element){return CaretFinder.lastPositionIn(element)},function(element){return CaretFinder.nextPosition(root.dom(),CaretPosition$1.after(element))})}},insertInlineBoundarySpaceOrNbsp=function(root,pos){return function(checkPos){return needsToHaveNbsp(root,checkPos)?insertNbspAtPosition(pos):insertSpaceAtPosition(pos)}},setSelection$1=function(editor){return function(pos){return editor.selection.setRng(pos.toRange()),editor.nodeChanged(),!0}},insertSpaceOrNbspAtSelection=function(editor){var pos=CaretPosition$1.fromRangeStart(editor.selection.getRng()),root=Element.fromDom(editor.getBody());if(editor.selection.isCollapsed()){var isInlineTarget=curry(InlineUtils.isInlineTarget,editor),caretPosition=CaretPosition$1.fromRangeStart(editor.selection.getRng());return BoundaryLocation.readLocation(isInlineTarget,editor.getBody(),caretPosition).bind(locationToCaretPosition(root)).bind(insertInlineBoundarySpaceOrNbsp(root,pos)).exists(setSelection$1(editor))}return!1},executeKeydownOverride$2=function(editor,evt){MatchKeys.execute([{keyCode:VK.SPACEBAR,action:MatchKeys.action(insertSpaceOrNbspAtSelection,editor)}],evt).each(function(_){evt.preventDefault()})},setup$c=function(editor){editor.on("keydown",function(evt){!1===evt.isDefaultPrevented()&&executeKeydownOverride$2(editor,evt)})},SpaceKey={setup:setup$c},findBlockCaretContainer=function(editor){return descendant(Element.fromDom(editor.getBody()),"*[data-mce-caret]").fold(constant(null),function(elm){return elm.dom()})},removeIeControlRect=function(editor){editor.selection.setRng(editor.selection.getRng())},showBlockCaretContainer=function(editor,blockCaretContainer){blockCaretContainer.hasAttribute("data-mce-caret")&&(showCaretContainerBlock(blockCaretContainer),removeIeControlRect(editor),editor.selection.scrollIntoView(blockCaretContainer))},handleBlockContainer=function(editor,e){var blockCaretContainer=findBlockCaretContainer(editor);if(blockCaretContainer)return"compositionstart"===e.type?(e.preventDefault(),e.stopPropagation(),void showBlockCaretContainer(editor,blockCaretContainer)):void(hasContent(blockCaretContainer)&&(showBlockCaretContainer(editor,blockCaretContainer),editor.undoManager.add()))},setup$d=function(editor){editor.on("keyup compositionstart",curry(handleBlockContainer,editor))},CaretContainerInput={setup:setup$d},browser$5=detect$3().browser,setupIeInput=function(editor){var keypressThrotter=first(function(){editor.composing||normalizeNbspsInEditor(editor)},0);browser$5.isIE()&&(editor.on("keypress",function(e){keypressThrotter.throttle()}),editor.on("remove",function(e){keypressThrotter.cancel()}))},setup$e=function(editor){setupIeInput(editor),editor.on("input",function(e){!1===e.isComposing&&normalizeNbspsInEditor(editor)})},executeKeydownOverride$3=function(editor,evt){MatchKeys.execute([{keyCode:VK.END,action:moveToLineEndPoint(editor,!0)},{keyCode:VK.HOME,action:moveToLineEndPoint(editor,!1)}],evt).each(function(_){evt.preventDefault()})},setup$f=function(editor){editor.on("keydown",function(evt){!1===evt.isDefaultPrevented()&&executeKeydownOverride$3(editor,evt)})},HomeEndKeys={setup:setup$f},setup$g=function(editor){var caret=BoundarySelection.setupSelectedState(editor);CaretContainerInput.setup(editor),ArrowKeys.setup(editor,caret),DeleteBackspaceKeys.setup(editor,caret),EnterKey.setup(editor),SpaceKey.setup(editor),setup$e(editor),HomeEndKeys.setup(editor)},KeyboardOverrides={setup:setup$g},NodeChange=function(){function NodeChange(editor){this.lastPath=[],this.editor=editor;var lastRng,self=this;"onselectionchange"in editor.getDoc()||editor.on("NodeChange click mouseup keyup focus",function(e){var nativeRng,fakeRng;nativeRng=editor.selection.getRng(),fakeRng={startContainer:nativeRng.startContainer,startOffset:nativeRng.startOffset,endContainer:nativeRng.endContainer,endOffset:nativeRng.endOffset},"nodechange"!==e.type&&RangeCompare.isEq(fakeRng,lastRng)||editor.fire("SelectionChange"),lastRng=fakeRng}),editor.on("contextmenu",function(){editor.fire("SelectionChange")}),editor.on("SelectionChange",function(){var startElm=editor.selection.getStart(!0);!startElm||!Env.range&&editor.selection.isCollapsed()||hasAnyRanges(editor)&&!self.isSameElementPath(startElm)&&editor.dom.isChildOf(startElm,editor.getBody())&&editor.nodeChanged({selectionChange:!0})}),editor.on("mouseup",function(e){!e.isDefaultPrevented()&&hasAnyRanges(editor)&&("IMG"===editor.selection.getNode().nodeName?Delay.setEditorTimeout(editor,function(){editor.nodeChanged()}):editor.nodeChanged())})}return NodeChange.prototype.nodeChanged=function(args){var node,parents,root,selection=this.editor.selection;this.editor.initialized&&selection&&!this.editor.settings.disable_nodechange&&!this.editor.readonly&&(root=this.editor.getBody(),node=selection.getStart(!0)||root,node.ownerDocument===this.editor.getDoc()&&this.editor.dom.isChildOf(node,root)||(node=root),parents=[],this.editor.dom.getParent(node,function(node){if(node===root)return!0;parents.push(node)}),args=args||{},args.element=node,args.parents=parents,this.editor.fire("NodeChange",args))},NodeChange.prototype.isSameElementPath=function(startElm){var i,currentPath;if(currentPath=this.editor.$(startElm).parentsUntil(this.editor.getBody()).add(startElm),currentPath.length===this.lastPath.length){for(i=currentPath.length;i>=0&&currentPath[i]===this.lastPath[i];i--);if(-1===i)return this.lastPath=currentPath,!0}return this.lastPath=currentPath,!1},NodeChange}(),preventSummaryToggle=function(editor){editor.on("click",function(e){editor.dom.getParent(e.target,"details")&&e.preventDefault()})},filterDetails=function(editor){editor.parser.addNodeFilter("details",function(elms){each(elms,function(details){details.attr("data-mce-open",details.attr("open")),details.attr("open","open")})}),editor.serializer.addNodeFilter("details",function(elms){each(elms,function(details){var open=details.attr("data-mce-open");details.attr("open",isString(open)?open:null),details.attr("data-mce-open",null)})})},setup$h=function(editor){preventSummaryToggle(editor),filterDetails(editor)},isTextBlockNode=function(node){return NodeType.isElement(node)&&isTextBlock(Element.fromDom(node))},normalizeSelection$1=function(editor){var rng=editor.selection.getRng(),startPos=CaretPosition.fromRangeStart(rng),endPos=CaretPosition.fromRangeEnd(rng);if(CaretPosition.isElementPosition(startPos)){var container=startPos.container();isTextBlockNode(container)&&CaretFinder.firstPositionIn(container).each(function(pos){return rng.setStart(pos.container(),pos.offset())})}if(CaretPosition.isElementPosition(endPos)){var container=startPos.container();isTextBlockNode(container)&&CaretFinder.lastPositionIn(container).each(function(pos){return rng.setEnd(pos.container(),pos.offset())})}editor.selection.setRng(RangeNormalizer.normalize(rng))},setup$i=function(editor){editor.on("click",function(e){e.detail>=3&&normalizeSelection$1(editor)})},getAbsolutePosition=function(elm){var doc,docElem,win,clientRect;return clientRect=elm.getBoundingClientRect(),doc=elm.ownerDocument,docElem=doc.documentElement,win=doc.defaultView,{top:clientRect.top+win.pageYOffset-docElem.clientTop,left:clientRect.left+win.pageXOffset-docElem.clientLeft}},getBodyPosition=function(editor){return editor.inline?getAbsolutePosition(editor.getBody()):{left:0,top:0}},getScrollPosition=function(editor){var body=editor.getBody();return editor.inline?{left:body.scrollLeft,top:body.scrollTop}:{left:0,top:0}},getBodyScroll=function(editor){var body=editor.getBody(),docElm=editor.getDoc().documentElement,inlineScroll={left:body.scrollLeft,top:body.scrollTop},iframeScroll={left:body.scrollLeft||docElm.scrollLeft,top:body.scrollTop||docElm.scrollTop};return editor.inline?inlineScroll:iframeScroll},getMousePosition=function(editor,event){if(event.target.ownerDocument!==editor.getDoc()){var iframePosition=getAbsolutePosition(editor.getContentAreaContainer()),scrollPosition=getBodyScroll(editor);return{left:event.pageX-iframePosition.left+scrollPosition.left,top:event.pageY-iframePosition.top+scrollPosition.top}}return{left:event.pageX,top:event.pageY}},calculatePosition=function(bodyPosition,scrollPosition,mousePosition){return{pageX:mousePosition.left-bodyPosition.left+scrollPosition.left,pageY:mousePosition.top-bodyPosition.top+scrollPosition.top}},calc=function(editor,event){return calculatePosition(getBodyPosition(editor),getScrollPosition(editor),getMousePosition(editor,event))},MousePosition={calc:calc},isContentEditableFalse$a=NodeType.isContentEditableFalse,isContentEditableTrue$4=NodeType.isContentEditableTrue,isDraggable=function(rootElm,elm){return isContentEditableFalse$a(elm)&&elm!==rootElm},isValidDropTarget=function(editor,targetElement,dragElement){return targetElement!==dragElement&&!editor.dom.isChildOf(targetElement,dragElement)&&!isContentEditableFalse$a(targetElement)},cloneElement=function(elm){var cloneElm=elm.cloneNode(!0);return cloneElm.removeAttribute("data-mce-selected"),cloneElm},createGhost=function(editor,elm,width,height){var clonedElm=elm.cloneNode(!0);editor.dom.setStyles(clonedElm,{width:width,height:height}),editor.dom.setAttrib(clonedElm,"data-mce-selected",null);var ghostElm=editor.dom.create("div",{class:"mce-drag-container","data-mce-bogus":"all",unselectable:"on",contenteditable:"false"});return editor.dom.setStyles(ghostElm,{position:"absolute",opacity:.5,overflow:"hidden",border:0,padding:0,margin:0,width:width,height:height}),editor.dom.setStyles(clonedElm,{margin:0,boxSizing:"border-box"}),ghostElm.appendChild(clonedElm),ghostElm},appendGhostToBody=function(ghostElm,bodyElm){ghostElm.parentNode!==bodyElm&&bodyElm.appendChild(ghostElm)},moveGhost=function(ghostElm,position,width,height,maxX,maxY){var overflowX=0,overflowY=0;ghostElm.style.left=position.pageX+"px",ghostElm.style.top=position.pageY+"px",position.pageX+width>maxX&&(overflowX=position.pageX+width-maxX),position.pageY+height>maxY&&(overflowY=position.pageY+height-maxY),ghostElm.style.width=width-overflowX+"px",ghostElm.style.height=height-overflowY+"px"},removeElement=function(elm){elm&&elm.parentNode&&elm.parentNode.removeChild(elm)},isLeftMouseButtonPressed=function(e){return 0===e.button},hasDraggableElement=function(state){return state.element},applyRelPos=function(state,position){return{pageX:position.pageX-state.relX,pageY:position.pageY+5}},start$1=function(state,editor){return function(e){if(isLeftMouseButtonPressed(e)){var ceElm=find(editor.dom.getParents(e.target),Predicate.or(isContentEditableFalse$a,isContentEditableTrue$4)).getOr(null);if(isDraggable(editor.getBody(),ceElm)){var elmPos=editor.dom.getPos(ceElm),bodyElm=editor.getBody(),docElm=editor.getDoc().documentElement;state.element=ceElm,state.screenX=e.screenX,state.screenY=e.screenY,state.maxX=(editor.inline?bodyElm.scrollWidth:docElm.offsetWidth)-2,state.maxY=(editor.inline?bodyElm.scrollHeight:docElm.offsetHeight)-2,state.relX=e.pageX-elmPos.x,state.relY=e.pageY-elmPos.y,state.width=ceElm.offsetWidth,state.height=ceElm.offsetHeight,state.ghost=createGhost(editor,ceElm,state.width,state.height)}}}},move$1=function(state,editor){var throttledPlaceCaretAt=Delay.throttle(function(clientX,clientY){editor._selectionOverrides.hideFakeCaret(),editor.selection.placeCaretAt(clientX,clientY)},0);return function(e){var movement=Math.max(Math.abs(e.screenX-state.screenX),Math.abs(e.screenY-state.screenY));if(hasDraggableElement(state)&&!state.dragging&&movement>10){if(editor.fire("dragstart",{target:state.element}).isDefaultPrevented())return;state.dragging=!0,editor.focus()}if(state.dragging){var targetPos=applyRelPos(state,MousePosition.calc(editor,e));appendGhostToBody(state.ghost,editor.getBody()),moveGhost(state.ghost,targetPos,state.width,state.height,state.maxX,state.maxY),throttledPlaceCaretAt(e.clientX,e.clientY)}}},getRawTarget=function(selection){var rng=selection.getSel().getRangeAt(0),startContainer=rng.startContainer;return 3===startContainer.nodeType?startContainer.parentNode:startContainer},drop=function(state,editor){return function(e){if(state.dragging&&isValidDropTarget(editor,getRawTarget(editor.selection),state.element)){var targetClone_1=cloneElement(state.element),args=editor.fire("drop",{targetClone:targetClone_1,clientX:e.clientX,clientY:e.clientY});args.isDefaultPrevented()||(targetClone_1=args.targetClone,editor.undoManager.transact(function(){removeElement(state.element),editor.insertContent(editor.dom.getOuterHTML(targetClone_1)),editor._selectionOverrides.hideFakeCaret()}))}removeDragState(state)}},stop=function(state,editor){return function(){state.dragging&&editor.fire("dragend"),removeDragState(state)}},removeDragState=function(state){state.dragging=!1,state.element=null,removeElement(state.ghost)},bindFakeDragEvents=function(editor){var pageDom,dragStartHandler,dragHandler,dropHandler,dragEndHandler,rootDocument,state={};pageDom=DOMUtils$1.DOM,rootDocument=domGlobals.document,dragStartHandler=start$1(state,editor),dragHandler=move$1(state,editor),dropHandler=drop(state,editor),dragEndHandler=stop(state,editor),editor.on("mousedown",dragStartHandler),editor.on("mousemove",dragHandler),editor.on("mouseup",dropHandler),pageDom.bind(rootDocument,"mousemove",dragHandler),pageDom.bind(rootDocument,"mouseup",dragEndHandler),editor.on("remove",function(){pageDom.unbind(rootDocument,"mousemove",dragHandler),pageDom.unbind(rootDocument,"mouseup",dragEndHandler)})},blockIeDrop=function(editor){editor.on("drop",function(e){var realTarget=void 0!==e.clientX?editor.getDoc().elementFromPoint(e.clientX,e.clientY):null;(isContentEditableFalse$a(realTarget)||isContentEditableFalse$a(editor.dom.getContentEditableParent(realTarget)))&&e.preventDefault()})},init=function(editor){bindFakeDragEvents(editor),blockIeDrop(editor)},DragDropOverrides={init:init},setup$j=function(editor){var renderFocusCaret=first(function(){if(!editor.removed&&editor.getBody().contains(domGlobals.document.activeElement)){if(editor.selection.getRng().collapsed){var caretRange=renderRangeCaret(editor,editor.selection.getRng(),!1);editor.selection.setRng(caretRange)}}},0);editor.on("focus",function(){renderFocusCaret.throttle()}),editor.on("blur",function(){renderFocusCaret.cancel()})},CefFocus={setup:setup$j},isContentEditableTrue$5=NodeType.isContentEditableTrue,isContentEditableFalse$b=NodeType.isContentEditableFalse,getContentEditableRoot$2=function(editor,node){for(var root=editor.getBody();node&&node!==root;){if(isContentEditableTrue$5(node)||isContentEditableFalse$b(node))return node;node=node.parentNode}return null},SelectionOverrides=function(editor){var selectedContentEditableNode,isBlock=function(node){return editor.dom.isBlock(node)},rootNode=editor.getBody(),fakeCaret=FakeCaret(editor,rootNode,isBlock,function(){return EditorFocus.hasFocus(editor)}),realSelectionId="sel-"+editor.dom.uniqueId(),isFakeSelectionElement=function(elm){return editor.dom.hasClass(elm,"mce-offscreen-selection")},getRealSelectionElement=function(){var container=editor.dom.get(realSelectionId);return container?container.getElementsByTagName("*")[0]:container},setRange=function(range){range&&editor.selection.setRng(range)},getRange=function(){return editor.selection.getRng()},showCaret=function(direction,node,before,scrollIntoView){void 0===scrollIntoView&&(scrollIntoView=!0);var e;return e=editor.fire("ShowCaret",{target:node,direction:direction,before:before}),e.isDefaultPrevented()?null:(scrollIntoView&&editor.selection.scrollIntoView(node,-1===direction),fakeCaret.show(before,node))},showBlockCaretContainer=function(blockCaretContainer){blockCaretContainer.hasAttribute("data-mce-caret")&&(showCaretContainerBlock(blockCaretContainer),setRange(getRange()),editor.selection.scrollIntoView(blockCaretContainer))},isWithinCaretContainer=function(node){return isCaretContainer(node)||startsWithCaretContainer(node)||endsWithCaretContainer(node)},isRangeInCaretContainer=function(rng){return isWithinCaretContainer(rng.startContainer)||isWithinCaretContainer(rng.endContainer)},normalizeShortEndedElementSelection=function(rng){var shortEndedElements=editor.schema.getShortEndedElements(),newRng=editor.dom.createRng(),startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset;return has(shortEndedElements,startContainer.nodeName.toLowerCase())?0===startOffset?newRng.setStartBefore(startContainer):newRng.setStartAfter(startContainer):newRng.setStart(startContainer,startOffset),has(shortEndedElements,endContainer.nodeName.toLowerCase())?0===endOffset?newRng.setEndBefore(endContainer):newRng.setEndAfter(endContainer):newRng.setEnd(endContainer,endOffset),newRng},setContentEditableSelection=function(range,forward){var node,$realSelectionContainer,sel,startContainer,startOffset,endOffset,e,caretPosition,targetClone,origTargetClone,$=editor.$,dom=editor.dom;if(!range)return null;if(range.collapsed){if(!isRangeInCaretContainer(range))if(!1===forward){if(caretPosition=getNormalizedRangeEndPoint(-1,rootNode,range),isFakeCaretTarget(caretPosition.getNode(!0)))return showCaret(-1,caretPosition.getNode(!0),!1,!1);if(isFakeCaretTarget(caretPosition.getNode()))return showCaret(-1,caretPosition.getNode(),!caretPosition.isAtEnd(),!1)}else{if(caretPosition=getNormalizedRangeEndPoint(1,rootNode,range),isFakeCaretTarget(caretPosition.getNode()))return showCaret(1,caretPosition.getNode(),!caretPosition.isAtEnd(),!1);if(isFakeCaretTarget(caretPosition.getNode(!0)))return showCaret(1,caretPosition.getNode(!0),!1,!1)}return null}if(startContainer=range.startContainer,startOffset=range.startOffset,endOffset=range.endOffset,3===startContainer.nodeType&&0===startOffset&&isContentEditableFalse$b(startContainer.parentNode)&&(startContainer=startContainer.parentNode,startOffset=dom.nodeIndex(startContainer),startContainer=startContainer.parentNode),1!==startContainer.nodeType)return null;if(endOffset===startOffset+1&&startContainer===range.endContainer&&(node=startContainer.childNodes[startOffset]),!isContentEditableFalse$b(node))return null;if(targetClone=origTargetClone=node.cloneNode(!0),e=editor.fire("ObjectSelected",{target:node,targetClone:targetClone}),e.isDefaultPrevented())return null;$realSelectionContainer=descendant(Element.fromDom(editor.getBody()),"#"+realSelectionId).fold(function(){return $([])},function(elm){return $([elm.dom()])}),targetClone=e.targetClone,0===$realSelectionContainer.length&&($realSelectionContainer=$('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>').attr("id",realSelectionId),$realSelectionContainer.appendTo(editor.getBody())),range=editor.dom.createRng(),targetClone===origTargetClone&&Env.ie?($realSelectionContainer.empty().append('<p style="font-size: 0" data-mce-bogus="all"> </p>').append(targetClone),range.setStartAfter($realSelectionContainer[0].firstChild.firstChild),range.setEndAfter(targetClone)):($realSelectionContainer.empty().append(" ").append(targetClone).append(" "),range.setStart($realSelectionContainer[0].firstChild,1),range.setEnd($realSelectionContainer[0].lastChild,0)),$realSelectionContainer.css({top:dom.getPos(node,editor.getBody()).y}),$realSelectionContainer[0].focus(),sel=editor.selection.getSel(),sel.removeAllRanges(),sel.addRange(range);var nodeElm=Element.fromDom(node);return each(descendants$1(Element.fromDom(editor.getBody()),"*[data-mce-selected]"),function(elm){eq(nodeElm,elm)||remove$1(elm,"data-mce-selected")}),editor.dom.getAttrib(node,"data-mce-selected")||node.setAttribute("data-mce-selected","1"),selectedContentEditableNode=node,hideFakeCaret(),range},removeContentEditableSelection=function(){selectedContentEditableNode&&(selectedContentEditableNode.removeAttribute("data-mce-selected"),descendant(Element.fromDom(editor.getBody()),"#"+realSelectionId).each(remove),selectedContentEditableNode=null),descendant(Element.fromDom(editor.getBody()),"#"+realSelectionId).each(remove),selectedContentEditableNode=null},destroy=function(){fakeCaret.destroy(),selectedContentEditableNode=null},hideFakeCaret=function(){fakeCaret.hide()};return Env.ceFalse&&function(){editor.on("mouseup",function(e){var range=getRange();range.collapsed&&EditorView.isXYInContentArea(editor,e.clientX,e.clientY)&&setRange(renderCaretAtRange(editor,range,!1))}),editor.on("click",function(e){var contentEditableRoot;(contentEditableRoot=getContentEditableRoot$2(editor,e.target))&&(isContentEditableFalse$b(contentEditableRoot)&&(e.preventDefault(),editor.focus()),isContentEditableTrue$5(contentEditableRoot)&&editor.dom.isChildOf(contentEditableRoot,editor.selection.getNode())&&removeContentEditableSelection())}),editor.on("blur NewBlock",function(){removeContentEditableSelection()}),editor.on("ResizeWindow FullscreenStateChanged",function(){return fakeCaret.reposition()});var hasNormalCaretPosition=function(elm){var caretWalker=CaretWalker(elm);if(!elm.firstChild)return!1;var startPos=CaretPosition$1.before(elm.firstChild),newPos=caretWalker.next(startPos);return newPos&&!isBeforeContentEditableFalse(newPos)&&!isAfterContentEditableFalse(newPos)},isInSameBlock=function(node1,node2){return editor.dom.getParent(node1,editor.dom.isBlock)===editor.dom.getParent(node2,editor.dom.isBlock)},hasBetterMouseTarget=function(targetNode,caretNode){var targetBlock=editor.dom.getParent(targetNode,editor.dom.isBlock),caretBlock=editor.dom.getParent(caretNode,editor.dom.isBlock);return!(!targetBlock||!editor.dom.isChildOf(targetBlock,caretBlock)||!1!==isContentEditableFalse$b(getContentEditableRoot$2(editor,targetBlock)))||targetBlock&&!isInSameBlock(targetBlock,caretBlock)&&hasNormalCaretPosition(targetBlock)};!function(editor){editor.on("tap",function(e){var contentEditableRoot=getContentEditableRoot$2(editor,e.target);isContentEditableFalse$b(contentEditableRoot)&&(e.preventDefault(),setContentEditableSelection(selectNode(editor,contentEditableRoot)))},!0)}(editor),editor.on("mousedown",function(e){var contentEditableRoot,targetElm=e.target;if((targetElm===rootNode||"HTML"===targetElm.nodeName||editor.dom.isChildOf(targetElm,rootNode))&&!1!==EditorView.isXYInContentArea(editor,e.clientX,e.clientY))if(contentEditableRoot=getContentEditableRoot$2(editor,targetElm))isContentEditableFalse$b(contentEditableRoot)?(e.preventDefault(),setContentEditableSelection(selectNode(editor,contentEditableRoot))):(removeContentEditableSelection(),isContentEditableTrue$5(contentEditableRoot)&&e.shiftKey||RangePoint.isXYWithinRange(e.clientX,e.clientY,editor.selection.getRng())||(hideFakeCaret(),editor.selection.placeCaretAt(e.clientX,e.clientY)));else if(!1===isFakeCaretTarget(targetElm)){removeContentEditableSelection(),hideFakeCaret();var caretInfo=closestCaret(rootNode,e.clientX,e.clientY);if(caretInfo&&!hasBetterMouseTarget(e.target,caretInfo.node)){e.preventDefault();var range=showCaret(1,caretInfo.node,caretInfo.before,!1);editor.getBody().focus(),setRange(range)}}}),editor.on("keypress",function(e){VK.modifierPressed(e)||(e.keyCode,isContentEditableFalse$b(editor.selection.getNode())&&e.preventDefault())}),editor.on("GetSelectionRange",function(e){var rng=e.range;if(selectedContentEditableNode){if(!selectedContentEditableNode.parentNode)return void(selectedContentEditableNode=null);rng=rng.cloneRange(),rng.selectNode(selectedContentEditableNode),e.range=rng}}),editor.on("SetSelectionRange",function(e){e.range=normalizeShortEndedElementSelection(e.range);var rng=setContentEditableSelection(e.range,e.forward);rng&&(e.range=rng)});var isPasteBin=function(node){return"mcepastebin"===node.id};editor.on("AfterSetSelectionRange",function(e){var rng=e.range;isRangeInCaretContainer(rng)||isPasteBin(rng.startContainer.parentNode)||hideFakeCaret(),isFakeSelectionElement(rng.startContainer.parentNode)||removeContentEditableSelection()}),editor.on("copy",function(e){var clipboardData=e.clipboardData;if(!e.isDefaultPrevented()&&e.clipboardData&&!Env.ie){var realSelectionElement=getRealSelectionElement();realSelectionElement&&(e.preventDefault(),clipboardData.clearData(),clipboardData.setData("text/html",realSelectionElement.outerHTML),clipboardData.setData("text/plain",realSelectionElement.outerText))}}),DragDropOverrides.init(editor),CefFocus.setup(editor)}(),{showCaret:showCaret,showBlockCaretContainer:showBlockCaretContainer,hideFakeCaret:hideFakeCaret,destroy:destroy}},Quirks=function(editor){var each=Tools.each,BACKSPACE=VK.BACKSPACE,DELETE=VK.DELETE,dom=editor.dom,selection=editor.selection,settings=editor.settings,parser=editor.parser,isGecko=Env.gecko,isIE=Env.ie,isWebKit=Env.webkit,mceInternalDataType=isIE?"Text":"URL",setEditorCommandState=function(cmd,state){try{editor.getDoc().execCommand(cmd,!1,state)}catch(ex){}},isDefaultPrevented=function(e){return e.isDefaultPrevented()},setMceInternalContent=function(e){var selectionHtml,internalContent;e.dataTransfer&&(editor.selection.isCollapsed()&&"IMG"===e.target.tagName&&selection.select(e.target),selectionHtml=editor.selection.getContent(),selectionHtml.length>0&&(internalContent="data:text/mce-internal,"+escape(editor.id)+","+escape(selectionHtml),e.dataTransfer.setData(mceInternalDataType,internalContent)))},getMceInternalContent=function(e){var internalContent;return e.dataTransfer&&(internalContent=e.dataTransfer.getData(mceInternalDataType))&&internalContent.indexOf("data:text/mce-internal,")>=0?(internalContent=internalContent.substr("data:text/mce-internal,".length).split(","),{id:unescape(internalContent[0]),html:unescape(internalContent[1])}):null},insertClipboardContents=function(content,internal){editor.queryCommandSupported("mceInsertClipboardContent")?editor.execCommand("mceInsertClipboardContent",!1,{content:content,internal:internal}):editor.execCommand("mceInsertContent",!1,content)},selectAll=function(){editor.shortcuts.add("meta+a",null,"SelectAll")},disableBackspaceIntoATable=function(){editor.on("keydown",function(e){if(!isDefaultPrevented(e)&&e.keyCode===BACKSPACE&&selection.isCollapsed()&&0===selection.getRng().startOffset){var previousSibling=selection.getNode().previousSibling;if(previousSibling&&previousSibling.nodeName&&"table"===previousSibling.nodeName.toLowerCase())return e.preventDefault(),!1}})},bodyHeight=function(){editor.inline||(editor.contentStyles.push("body {min-height: 150px}"),editor.on("click",function(e){var rng;if("HTML"===e.target.nodeName){if(Env.ie>11)return void editor.getBody().focus();rng=editor.selection.getRng(),editor.getBody().focus(),editor.selection.setRng(rng),editor.selection.normalize(),editor.nodeChanged()}}))},refreshContentEditable=function(){},isHidden=function(){var sel;return!(!isGecko||editor.removed)&&(!(sel=editor.selection.getSel())||!sel.rangeCount||0===sel.rangeCount)};return function(){editor.on("keydown",function(e){var rng,container,offset,root,parent;if(!isDefaultPrevented(e)&&e.keyCode===VK.BACKSPACE&&(rng=selection.getRng(),container=rng.startContainer,offset=rng.startOffset,root=dom.getRoot(),parent=container,rng.collapsed&&0===offset)){for(;parent&&parent.parentNode&&parent.parentNode.firstChild===parent&&parent.parentNode!==root;)parent=parent.parentNode;"BLOCKQUOTE"===parent.tagName&&(editor.formatter.toggle("blockquote",null,parent),rng=dom.createRng(),rng.setStart(container,0),rng.setEnd(container,0),selection.setRng(rng))}})}(),function(){var serializeRng=function(rng){var body=dom.create("body"),contents=rng.cloneContents();return body.appendChild(contents),selection.serializer.serialize(body,{format:"html"})},allContentsSelected=function(rng){var selection=serializeRng(rng),allRng=dom.createRng();return allRng.selectNode(editor.getBody()),selection===serializeRng(allRng)};editor.on("keydown",function(e){var isCollapsed,body,keyCode=e.keyCode;if(!isDefaultPrevented(e)&&(keyCode===DELETE||keyCode===BACKSPACE)){if(isCollapsed=editor.selection.isCollapsed(),body=editor.getBody(),isCollapsed&&!dom.isEmpty(body))return;if(!isCollapsed&&!allContentsSelected(editor.selection.getRng()))return;e.preventDefault(),editor.setContent(""),body.firstChild&&dom.isBlock(body.firstChild)?editor.selection.setCursorLocation(body.firstChild,0):editor.selection.setCursorLocation(body,0),editor.nodeChanged()}})}(),Env.windowsPhone||function(){editor.on("keyup focusin mouseup",function(e){VK.modifierPressed(e)||selection.normalize()},!0)}(),isWebKit&&(function(){editor.inline||dom.bind(editor.getDoc(),"mousedown mouseup",function(e){var rng;if(e.target===editor.getDoc().documentElement)if(rng=selection.getRng(),editor.getBody().focus(),"mousedown"===e.type){if(isCaretContainer(rng.startContainer))return;selection.placeCaretAt(e.clientX,e.clientY)}else selection.setRng(rng)})}(),function(){editor.on("click",function(e){var target=e.target;/^(IMG|HR)$/.test(target.nodeName)&&"false"!==dom.getContentEditableParent(target)&&(e.preventDefault(),editor.selection.select(target),editor.nodeChanged()),"A"===target.nodeName&&dom.hasClass(target,"mce-item-anchor")&&(e.preventDefault(),selection.select(target))})}(),function(){settings.forced_root_block&&editor.on("init",function(){setEditorCommandState("DefaultParagraphSeparator",Settings.getForcedRootBlock(editor))})}(),function(){editor.on("init",function(){editor.dom.bind(editor.getBody(),"submit",function(e){e.preventDefault()})})}(),disableBackspaceIntoATable(),function(){parser.addNodeFilter("br",function(nodes){for(var i=nodes.length;i--;)"Apple-interchange-newline"===nodes[i].attr("class")&&nodes[i].remove()})}(),Env.iOS?(function(){editor.inline||editor.on("keydown",function(){domGlobals.document.activeElement===domGlobals.document.body&&editor.getWin().focus()})}(),bodyHeight(),function(){editor.on("click",function(e){var elm=e.target;do{if("A"===elm.tagName)return void e.preventDefault()}while(elm=elm.parentNode)}),editor.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")}()):selectAll()),Env.ie>=11&&(bodyHeight(),disableBackspaceIntoATable()),Env.ie&&(selectAll(),function(){setEditorCommandState("AutoUrlDetect",!1)}(),function(){editor.on("dragstart",function(e){setMceInternalContent(e)}),editor.on("drop",function(e){if(!isDefaultPrevented(e)){var internalContent=getMceInternalContent(e);if(internalContent&&internalContent.id!==editor.id){e.preventDefault();var rng=CaretRangeFromPoint.fromPoint(e.x,e.y,editor.getDoc());selection.setRng(rng),insertClipboardContents(internalContent.html,!0)}}})}()),isGecko&&(!function(){editor.on("keydown",function(e){if(!isDefaultPrevented(e)&&e.keyCode===BACKSPACE){if(!editor.getBody().getElementsByTagName("hr").length)return;if(selection.isCollapsed()&&0===selection.getRng().startOffset){var node=selection.getNode(),previousSibling=node.previousSibling;if("HR"===node.nodeName)return dom.remove(node),void e.preventDefault();previousSibling&&previousSibling.nodeName&&"hr"===previousSibling.nodeName.toLowerCase()&&(dom.remove(previousSibling),e.preventDefault())}}})}(),function(){domGlobals.Range.prototype.getClientRects||editor.on("mousedown",function(e){if(!isDefaultPrevented(e)&&"HTML"===e.target.nodeName){var body_1=editor.getBody();body_1.blur(),Delay.setEditorTimeout(editor,function(){body_1.focus()})}})}(),function(){var getAttributeApplyFunction=function(){var template=dom.getAttribs(selection.getStart().cloneNode(!1));return function(){var target=selection.getStart();target!==editor.getBody()&&(dom.setAttrib(target,"style",null),each(template,function(attr){target.setAttributeNode(attr.cloneNode(!0))}))}},isSelectionAcrossElements=function(){return!selection.isCollapsed()&&dom.getParent(selection.getStart(),dom.isBlock)!==dom.getParent(selection.getEnd(),dom.isBlock)};editor.on("keypress",function(e){var applyAttributes;if(!isDefaultPrevented(e)&&(8===e.keyCode||46===e.keyCode)&&isSelectionAcrossElements())return applyAttributes=getAttributeApplyFunction(),editor.getDoc().execCommand("delete",!1,null),applyAttributes(),e.preventDefault(),!1}),dom.bind(editor.getDoc(),"cut",function(e){var applyAttributes;!isDefaultPrevented(e)&&isSelectionAcrossElements()&&(applyAttributes=getAttributeApplyFunction(),Delay.setEditorTimeout(editor,function(){applyAttributes()}))})}(),function(){var setOpts=function(){setEditorCommandState("StyleWithCSS",!1),setEditorCommandState("enableInlineTableEditing",!1),settings.object_resizing||setEditorCommandState("enableObjectResizing",!1)};settings.readonly||editor.on("BeforeExecCommand mousedown",setOpts)}(),function(){var fixLinks=function(){each(dom.select("a"),function(node){var parentNode=node.parentNode,root=dom.getRoot();if(parentNode.lastChild===node){for(;parentNode&&!dom.isBlock(parentNode);){if(parentNode.parentNode.lastChild!==parentNode||parentNode===root)return;parentNode=parentNode.parentNode}dom.add(parentNode,"br",{"data-mce-bogus":1})}})};editor.on("SetContent ExecCommand",function(e){"setcontent"!==e.type&&"mceInsertLink"!==e.command||fixLinks()})}(),function(){editor.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}")}(),function(){Env.mac&&editor.on("keydown",function(e){if(VK.metaKeyPressed(e)&&!e.shiftKey&&(37===e.keyCode||39===e.keyCode)){e.preventDefault();editor.selection.getSel().modify("move",37===e.keyCode?"backward":"forward","lineboundary")}})}(),disableBackspaceIntoATable()),{refreshContentEditable:refreshContentEditable,isHidden:isHidden}},DOM$4=DOMUtils$1.DOM,appendStyle=function(editor,text){var head=Element.fromDom(editor.getDoc().head),tag=Element.fromTag("style");set(tag,"type","text/css"),append(tag,Element.fromText(text)),append(head,tag)},createParser=function(editor){var parser=DomParser(editor.settings,editor.schema);return parser.addAttributeFilter("src,href,style,tabindex",function(nodes,name){for(var node,value,internalName,i=nodes.length,dom=editor.dom;i--;)if(node=nodes[i],value=node.attr(name),internalName="data-mce-"+name,!node.attr(internalName)){if(0===value.indexOf("data:")||0===value.indexOf("blob:"))continue;"style"===name?(value=dom.serializeStyle(dom.parseStyle(value),node.name),value.length||(value=null),node.attr(internalName,value),node.attr(name,value)):"tabindex"===name?(node.attr(internalName,value),node.attr(name,null)):node.attr(internalName,editor.convertURL(value,name,node.name))}}),parser.addNodeFilter("script",function(nodes){for(var node,type,i=nodes.length;i--;)node=nodes[i],type=node.attr("type")||"no/type",0!==type.indexOf("mce-")&&node.attr("type","mce-"+type)}),editor.settings.preserve_cdata&&parser.addNodeFilter("#cdata",function(nodes){for(var node,i=nodes.length;i--;)node=nodes[i],node.type=8,node.name="#comment",node.value="[CDATA["+editor.dom.encode(node.value)+"]]"}),parser.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",function(nodes){for(var node,i=nodes.length,nonEmptyElements=editor.schema.getNonEmptyElements();i--;)node=nodes[i],node.isEmpty(nonEmptyElements)&&0===node.getAll("br").length&&(node.append(new Node$1("br",1)).shortEnded=!0)}),parser},autoFocus=function(editor){editor.settings.auto_focus&&Delay.setEditorTimeout(editor,function(){var focusEditor;focusEditor=!0===editor.settings.auto_focus?editor:editor.editorManager.get(editor.settings.auto_focus),focusEditor.destroyed||focusEditor.focus()},100)},moveSelectionToFirstCaretPosition=function(editor){var root=editor.dom.getRoot();editor.inline||hasAnyRanges(editor)&&editor.selection.getStart(!0)!==root||CaretFinder.firstPositionIn(root).each(function(pos){var node=pos.getNode(),caretPos=NodeType.isTable(node)?CaretFinder.firstPositionIn(node).getOr(pos):pos;editor.selection.setRng(caretPos.toRange())})},initEditor=function(editor){editor.bindPendingEventDelegates(),editor.initialized=!0,fireInit(editor),editor.focus(!0),moveSelectionToFirstCaretPosition(editor),editor.nodeChanged({initial:!0}),editor.execCallback("init_instance_callback",editor),autoFocus(editor)},getStyleSheetLoader=function(editor){return editor.inline?DOM$4.styleSheetLoader:editor.dom.styleSheetLoader},initContentBody=function(editor,skipWrite){var body,contentCssText,settings=editor.settings,targetElm=editor.getElement(),doc=editor.getDoc();settings.inline||(editor.getElement().style.visibility=editor.orgVisibility),skipWrite||editor.inline||(doc.open(),doc.write(editor.iframeHTML),doc.close()),editor.inline&&(editor.on("remove",function(){var bodyEl=this.getBody();DOM$4.removeClass(bodyEl,"mce-content-body"),DOM$4.removeClass(bodyEl,"mce-edit-focus"),DOM$4.setAttrib(bodyEl,"contentEditable",null)}),DOM$4.addClass(targetElm,"mce-content-body"),editor.contentDocument=doc=domGlobals.document,editor.contentWindow=domGlobals.window,editor.bodyElement=targetElm,editor.contentAreaContainer=targetElm,settings.root_name=targetElm.nodeName.toLowerCase()),body=editor.getBody(),body.disabled=!0,editor.readonly=settings.readonly,editor.readonly||(editor.inline&&"static"===DOM$4.getStyle(body,"position",!0)&&(body.style.position="relative"),body.contentEditable=editor.getParam("content_editable_state",!0)),body.disabled=!1,editor.editorUpload=EditorUpload(editor),editor.schema=Schema(settings),editor.dom=DOMUtils$1(doc,{keep_values:!0,url_converter:editor.convertURL,url_converter_scope:editor,hex_colors:settings.force_hex_style_colors,update_styles:!0,root_element:editor.inline?editor.getBody():null,collect:function(){return editor.inline},schema:editor.schema,contentCssCors:Settings.shouldUseContentCssCors(editor),referrerPolicy:Settings.getReferrerPolicy(editor),onSetAttrib:function(e){editor.fire("SetAttrib",e)}}),editor.parser=createParser(editor),editor.serializer=Serializer$1(settings,editor),editor.selection=Selection$1(editor.dom,editor.getWin(),editor.serializer,editor),editor.annotator=Annotator(editor),editor.formatter=Formatter(editor),editor.undoManager=UndoManager(editor),editor._nodeChangeDispatcher=new NodeChange(editor),editor._selectionOverrides=SelectionOverrides(editor),TouchEvents.setup(editor),setup$h(editor),setup$i(editor),KeyboardOverrides.setup(editor),ForceBlocks.setup(editor),setup$6(editor),firePreInit(editor),settings.browser_spellcheck||settings.gecko_spellcheck||(doc.body.spellcheck=!1,DOM$4.setAttrib(body,"spellcheck","false")),editor.quirks=Quirks(editor),firePostRender(editor);var directionality=Settings.getDirectionality(editor);void 0!==directionality&&(body.dir=directionality),settings.protect&&editor.on("BeforeSetContent",function(e){Tools.each(settings.protect,function(pattern){e.content=e.content.replace(pattern,function(str){return"\x3c!--mce:protected "+escape(str)+"--\x3e"})})}),editor.on("SetContent",function(){editor.addVisual(editor.getBody())}),editor.load({initial:!0,format:"html"}),editor.startContent=editor.getContent({format:"raw"}),editor.on("compositionstart compositionend",function(e){editor.composing="compositionstart"===e.type}),editor.contentStyles.length>0&&(contentCssText="",Tools.each(editor.contentStyles,function(style){contentCssText+=style+"\r\n"}),editor.dom.addStyle(contentCssText)),getStyleSheetLoader(editor).loadAll(editor.contentCSS,function(_){initEditor(editor)},function(urls){initEditor(editor)}),settings.content_style&&appendStyle(editor,settings.content_style)},InitContentBody={initContentBody:initContentBody},DOM$5=DOMUtils$1.DOM,relaxDomain=function(editor,ifr){if(domGlobals.document.domain!==domGlobals.window.location.hostname&&Env.browser.isIE()){var bodyUuid=Uuid.uuid("mce");editor[bodyUuid]=function(){InitContentBody.initContentBody(editor)};var domainRelaxUrl='javascript:(function(){document.open();document.domain="'+domGlobals.document.domain+'";var ed = window.parent.tinymce.get("'+editor.id+'");document.write(ed.iframeHTML);document.close();ed.'+bodyUuid+"(true);})()";return DOM$5.setAttrib(ifr,"src",domainRelaxUrl),!0}return!1},createIframeElement=function(id,title,height,customAttrs){var iframe=Element.fromTag("iframe");return setAll(iframe,customAttrs),setAll(iframe,{id:id+"_ifr",frameBorder:"0",allowTransparency:"true",title:title}),add$3(iframe,"tox-edit-area__iframe"),iframe},getIframeHtml=function(editor){var bodyId,bodyClass,iframeHTML;return iframeHTML=Settings.getDocType(editor)+"<html><head>",Settings.getDocumentBaseUrl(editor)!==editor.documentBaseUrl&&(iframeHTML+='<base href="'+editor.documentBaseURI.getURI()+'" />'),iframeHTML+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />',bodyId=Settings.getBodyId(editor),bodyClass=Settings.getBodyClass(editor),Settings.getContentSecurityPolicy(editor)&&(iframeHTML+='<meta http-equiv="Content-Security-Policy" content="'+Settings.getContentSecurityPolicy(editor)+'" />'),iframeHTML+='</head><body id="'+bodyId+'" class="mce-content-body '+bodyClass+'" data-id="'+editor.id+'"><br></body></html>'},createIframe=function(editor,o){var title=editor.editorManager.translate("Rich Text Area. Press ALT-0 for help."),ifr=createIframeElement(editor.id,title,o.height,Settings.getIframeAttrs(editor)).dom();ifr.onload=function(){ifr.onload=null,editor.fire("load")};var isDomainRelaxed=relaxDomain(editor,ifr);return editor.contentAreaContainer=o.iframeContainer,editor.iframeElement=ifr,editor.iframeHTML=getIframeHtml(editor),DOM$5.add(o.iframeContainer,ifr),isDomainRelaxed},init$1=function(editor,boxInfo){var isDomainRelaxed=createIframe(editor,boxInfo);boxInfo.editorContainer&&(DOM$5.get(boxInfo.editorContainer).style.display=editor.orgDisplay,editor.hidden=DOM$5.isHidden(boxInfo.editorContainer)),editor.getElement().style.display="none",DOM$5.setAttrib(editor.id,"aria-hidden","true"),isDomainRelaxed||InitContentBody.initContentBody(editor)},InitIframe={init:init$1},DOM$6=DOMUtils$1.DOM,initPlugin=function(editor,initializedPlugins,plugin){var Plugin=PluginManager.get(plugin),pluginUrl=PluginManager.urls[plugin]||editor.documentBaseUrl.replace(/\/$/,"");if(plugin=Tools.trim(plugin),Plugin&&-1===Tools.inArray(initializedPlugins,plugin)){if(Tools.each(PluginManager.dependencies(plugin),function(dep){initPlugin(editor,initializedPlugins,dep)}),editor.plugins[plugin])return;try{var pluginInstance=new Plugin(editor,pluginUrl,editor.$);editor.plugins[plugin]=pluginInstance,pluginInstance.init&&(pluginInstance.init(editor,pluginUrl),initializedPlugins.push(plugin))}catch(e){ErrorReporter.pluginInitError(editor,plugin,e)}}},trimLegacyPrefix=function(name){return name.replace(/^\-/,"")},initPlugins=function(editor){var initializedPlugins=[];Tools.each(editor.settings.plugins.split(/[ ,]/),function(name){initPlugin(editor,initializedPlugins,trimLegacyPrefix(name))})},initIcons=function(editor){var iconPackName=Tools.trim(editor.settings.icons),currentIcons=editor.ui.registry.getAll().icons,defaultIcons=getAll(),loadIcons=__assign(__assign({},defaultIcons),IconManager.get(iconPackName).icons);each$1(loadIcons,function(svgData,icon){has(currentIcons,icon)||editor.ui.registry.addIcon(icon,svgData)})},initTheme=function(editor){var theme=editor.settings.theme;if(isString(theme)){editor.settings.theme=trimLegacyPrefix(theme);var Theme=ThemeManager.get(theme);editor.theme=new Theme(editor,ThemeManager.urls[theme]),editor.theme.init&&editor.theme.init(editor,ThemeManager.urls[theme]||editor.documentBaseUrl.replace(/\/$/,""),editor.$)}else editor.theme={}},renderFromLoadedTheme=function(editor){return editor.theme.renderUI()},renderFromThemeFunc=function(editor){var elm=editor.getElement(),theme=editor.settings.theme,info=theme(editor,elm);return info.editorContainer.nodeType&&(info.editorContainer.id=info.editorContainer.id||editor.id+"_parent"),info.iframeContainer&&info.iframeContainer.nodeType&&(info.iframeContainer.id=info.iframeContainer.id||editor.id+"_iframecontainer"),info.height=info.iframeHeight?info.iframeHeight:elm.offsetHeight,info},createThemeFalseResult=function(element){return{editorContainer:element,iframeContainer:element}},renderThemeFalseIframe=function(targetElement){var iframeContainer=DOM$6.create("div");return DOM$6.insertAfter(iframeContainer,targetElement),createThemeFalseResult(iframeContainer)},renderThemeFalse=function(editor){var targetElement=editor.getElement();return editor.inline?createThemeFalseResult(null):renderThemeFalseIframe(targetElement)},renderThemeUi=function(editor){var elm=editor.getElement();return editor.orgDisplay=elm.style.display,isString(editor.settings.theme)?renderFromLoadedTheme(editor):isFunction(editor.settings.theme)?renderFromThemeFunc(editor):renderThemeFalse(editor)},init$2=function(editor){editor.fire("ScriptsLoaded"),initIcons(editor),initTheme(editor),initPlugins(editor);var boxInfo=renderThemeUi(editor);return editor.editorContainer=boxInfo.editorContainer?boxInfo.editorContainer:null,appendContentCssFromSettings(editor),editor.inline?InitContentBody.initContentBody(editor):InitIframe.init(editor,boxInfo)},Init={init:init$2},DOM$7=DOMUtils$1.DOM,hasSkipLoadPrefix=function(name){return"-"===name.charAt(0)},loadLanguage=function(scriptLoader,editor){var languageCode=Settings.getLanguageCode(editor),languageUrl=Settings.getLanguageUrl(editor);if(!1===I18n.hasCode(languageCode)&&"en"!==languageCode){var url_1=""!==languageUrl?languageUrl:editor.editorManager.baseURL+"/langs/"+languageCode+".js";scriptLoader.add(url_1,noop,void 0,function(){ErrorReporter.languageLoadError(editor,url_1,languageCode)})}},loadTheme=function(scriptLoader,editor,suffix,callback){var settings=editor.settings,theme=settings.theme;if(isString(theme)){if(!hasSkipLoadPrefix(theme)&&!ThemeManager.urls.hasOwnProperty(theme)){var themeUrl=settings.theme_url;themeUrl?ThemeManager.load(theme,editor.documentBaseURI.toAbsolute(themeUrl)):ThemeManager.load(theme,"themes/"+theme+"/theme"+suffix+".js")}scriptLoader.loadQueue(function(){ThemeManager.waitFor(theme,callback)})}else callback()},getIconsUrlMetaFromUrl=function(editor){return Option.from(Settings.getIconsUrl(editor)).filter(function(url){return url.length>0}).map(function(url){return{url:url,name:Option.none()}})},getIconsUrlMetaFromName=function(editor){return Option.from(Settings.getIconPackName(editor)).filter(function(name){return name.length>0&&!IconManager.has(name)}).map(function(name){return{url:editor.editorManager.baseURL+"/icons/"+name+"/icons.js",name:Option.some(name)}})},loadIcons=function(scriptLoader,editor){getIconsUrlMetaFromUrl(editor).orThunk(function(){return getIconsUrlMetaFromName(editor)}).each(function(urlMeta){scriptLoader.add(urlMeta.url,noop,void 0,function(){ErrorReporter.iconsLoadError(editor,urlMeta.url,urlMeta.name.getOrUndefined())})})},loadPlugins=function(editor,settings,suffix){isArray(settings.plugins)&&(settings.plugins=settings.plugins.join(" ")),Tools.each(settings.external_plugins,function(url,name){PluginManager.load(name,url,noop,void 0,function(){ErrorReporter.pluginLoadError(editor,url,name)}),settings.plugins+=" "+name}),Tools.each(settings.plugins.split(/[ ,]/),function(plugin){if((plugin=Tools.trim(plugin))&&!PluginManager.urls[plugin])if(hasSkipLoadPrefix(plugin)){plugin=plugin.substr(1,plugin.length);var dependencies=PluginManager.dependencies(plugin);Tools.each(dependencies,function(depPlugin){var defaultSettings={prefix:"plugins/",resource:depPlugin,suffix:"/plugin"+suffix+".js"},dep=PluginManager.createUrl(defaultSettings,depPlugin);PluginManager.load(dep.resource,dep,noop,void 0,function(){ErrorReporter.pluginLoadError(editor,dep.prefix+dep.resource+dep.suffix,dep.resource)})})}else{var url_2={prefix:"plugins/",resource:plugin,suffix:"/plugin"+suffix+".js"};PluginManager.load(plugin,url_2,noop,void 0,function(){ErrorReporter.pluginLoadError(editor,url_2.prefix+url_2.resource+url_2.suffix,plugin)})}})},loadScripts=function(editor,suffix){var scriptLoader=ScriptLoader.ScriptLoader;loadTheme(scriptLoader,editor,suffix,function(){loadLanguage(scriptLoader,editor),loadIcons(scriptLoader,editor),loadPlugins(editor,editor.settings,suffix),scriptLoader.loadQueue(function(){editor.removed||Init.init(editor)},editor,function(){editor.removed||Init.init(editor)})})},render=function(editor){var settings=editor.settings,id=editor.id;I18n.setCode(Settings.getLanguageCode(editor));var readyHandler=function(){DOM$7.unbind(domGlobals.window,"ready",readyHandler),editor.render()};if(!EventUtils.Event.domLoaded)return void DOM$7.bind(domGlobals.window,"ready",readyHandler);if(editor.getElement()&&Env.contentEditable){settings.inline?editor.inline=!0:(editor.orgVisibility=editor.getElement().style.visibility,editor.getElement().style.visibility="hidden");var form=editor.getElement().form||DOM$7.getParent(id,"form");form&&(editor.formElement=form,settings.hidden_input&&!NodeType.isTextareaOrInput(editor.getElement())&&(DOM$7.insertAfter(DOM$7.create("input",{type:"hidden",name:id}),id),editor.hasHiddenInput=!0),editor.formEventDelegate=function(e){editor.fire(e.type,e)},DOM$7.bind(form,"submit reset",editor.formEventDelegate),editor.on("reset",function(){editor.resetContent()}),!settings.submit_patch||form.submit.nodeType||form.submit.length||form._mceOldSubmit||(form._mceOldSubmit=form.submit,form.submit=function(){return editor.editorManager.triggerSave(),editor.setDirty(!1),form._mceOldSubmit(form)})),editor.windowManager=WindowManager(editor),editor.notificationManager=NotificationManager(editor),"xml"===settings.encoding&&editor.on("GetContent",function(e){e.save&&(e.content=DOM$7.encode(e.content))}),settings.add_form_submit_trigger&&editor.on("submit",function(){editor.initialized&&editor.save()}),settings.add_unload_trigger&&(editor._beforeUnload=function(){!editor.initialized||editor.destroyed||editor.isHidden()||editor.save({format:"raw",no_events:!0,set_dirty:!1})},editor.editorManager.on("BeforeUnload",editor._beforeUnload)),editor.editorManager.add(editor),loadScripts(editor,editor.suffix)}},Render={render:render},hasOnlyOneChild$1=function(node){return node.firstChild&&node.firstChild===node.lastChild},isPaddingNode=function(node){return"br"===node.name||" "===node.value},isPaddedEmptyBlock=function(schema,node){return schema.getBlockElements()[node.name]&&hasOnlyOneChild$1(node)&&isPaddingNode(node.firstChild)},isEmptyFragmentElement=function(schema,node){var nonEmptyElements=schema.getNonEmptyElements();return node&&(node.isEmpty(nonEmptyElements)||isPaddedEmptyBlock(schema,node))},isListFragment=function(schema,fragment){var firstChild=fragment.firstChild,lastChild=fragment.lastChild;return firstChild&&"meta"===firstChild.name&&(firstChild=firstChild.next),lastChild&&"mce_marker"===lastChild.attr("id")&&(lastChild=lastChild.prev),isEmptyFragmentElement(schema,lastChild)&&(lastChild=lastChild.prev),!(!firstChild||firstChild!==lastChild)&&("ul"===firstChild.name||"ol"===firstChild.name)},cleanupDomFragment=function(domFragment){var firstChild=domFragment.firstChild,lastChild=domFragment.lastChild;return firstChild&&"META"===firstChild.nodeName&&firstChild.parentNode.removeChild(firstChild),lastChild&&"mce_marker"===lastChild.id&&lastChild.parentNode.removeChild(lastChild),domFragment},toDomFragment=function(dom,serializer,fragment){var html=serializer.serialize(fragment),domFragment=dom.createFragment(html);return cleanupDomFragment(domFragment)},listItems$1=function(elm){return Tools.grep(elm.childNodes,function(child){return"LI"===child.nodeName})},isPadding=function(node){return" "===node.data||NodeType.isBr(node)},isListItemPadded=function(node){return node&&node.firstChild&&node.firstChild===node.lastChild&&isPadding(node.firstChild)},isEmptyOrPadded=function(elm){return!elm.firstChild||isListItemPadded(elm)},trimListItems=function(elms){return elms.length>0&&isEmptyOrPadded(elms[elms.length-1])?elms.slice(0,-1):elms},getParentLi=function(dom,node){var parentBlock=dom.getParent(node,dom.isBlock);return parentBlock&&"LI"===parentBlock.nodeName?parentBlock:null},isParentBlockLi=function(dom,node){return!!getParentLi(dom,node)},getSplit=function(parentNode,rng){var beforeRng=rng.cloneRange(),afterRng=rng.cloneRange();return beforeRng.setStartBefore(parentNode),afterRng.setEndAfter(parentNode),[beforeRng.cloneContents(),afterRng.cloneContents()]},findFirstIn=function(node,rootNode){var caretPos=CaretPosition$1.before(node),caretWalker=CaretWalker(rootNode),newCaretPos=caretWalker.next(caretPos);return newCaretPos?newCaretPos.toRange():null},findLastOf=function(node,rootNode){var caretPos=CaretPosition$1.after(node),caretWalker=CaretWalker(rootNode),newCaretPos=caretWalker.prev(caretPos);return newCaretPos?newCaretPos.toRange():null},insertMiddle=function(target,elms,rootNode,rng){var parts=getSplit(target,rng),parentElm=target.parentNode;return parentElm.insertBefore(parts[0],target),Tools.each(elms,function(li){parentElm.insertBefore(li,target)}),parentElm.insertBefore(parts[1],target),parentElm.removeChild(target),findLastOf(elms[elms.length-1],rootNode)},insertBefore$1=function(target,elms,rootNode){var parentElm=target.parentNode;return Tools.each(elms,function(elm){parentElm.insertBefore(elm,target)}),findFirstIn(target,rootNode)},insertAfter$1=function(target,elms,rootNode,dom){return dom.insertAfter(elms.reverse(),target),findLastOf(elms[0],rootNode)},insertAtCaret=function(serializer,dom,rng,fragment){var domFragment=toDomFragment(dom,serializer,fragment),liTarget=getParentLi(dom,rng.startContainer),liElms=trimListItems(listItems$1(domFragment.firstChild)),rootNode=dom.getRoot(),isAt=function(location){var caretPos=CaretPosition$1.fromRangeStart(rng),caretWalker=CaretWalker(dom.getRoot()),newPos=1===location?caretWalker.prev(caretPos):caretWalker.next(caretPos);return!newPos||getParentLi(dom,newPos.getNode())!==liTarget};return isAt(1)?insertBefore$1(liTarget,liElms,rootNode):isAt(2)?insertAfter$1(liTarget,liElms,rootNode,dom):insertMiddle(liTarget,liElms,rootNode,rng)},InsertList={isListFragment:isListFragment,insertAtCaret:insertAtCaret,isParentBlockLi:isParentBlockLi,trimListItems:trimListItems,listItems:listItems$1},isAfterNbsp=function(container,offset){return NodeType.isText(container)&&" "===container.nodeValue[offset-1]},trimOrPadLeftRight=function(rng,html){var container,offset;container=rng.startContainer,offset=rng.startOffset;var hasSiblingText=function(siblingName){return container[siblingName]&&3===container[siblingName].nodeType};return 3===container.nodeType&&(offset>0?html=html.replace(/^&nbsp;/," "):hasSiblingText("previousSibling")||(html=html.replace(/^ /,"&nbsp;")),offset<container.length?html=html.replace(/&nbsp;(<br>|)$/," "):hasSiblingText("nextSibling")||(html=html.replace(/(&nbsp;| )(<br>|)$/,"&nbsp;"))),html},trimNbspAfterDeleteAndPadValue=function(rng,value){var container,offset;return container=rng.startContainer,offset=rng.startOffset,3===container.nodeType&&rng.collapsed&&(" "===container.data[offset]?(container.deleteData(offset,1),/[\u00a0| ]$/.test(value)||(value+=" ")):" "===container.data[offset-1]&&(container.deleteData(offset-1,1),/[\u00a0| ]$/.test(value)||(value=" "+value))),value},isTableCell$5=NodeType.matchNodeNames(["td","th"]),selectionSetContent=function(editor,content){var rng=editor.selection.getRng(),container=rng.startContainer,offset=rng.startOffset;rng.collapsed&&isAfterNbsp(container,offset)&&NodeType.isText(container)&&(container.insertData(offset-1," "),container.deleteData(offset,1),rng.setStart(container,offset),rng.setEnd(container,offset),editor.selection.setRng(rng)),editor.selection.setContent(content)},validInsertion=function(editor,value,parentNode){if("all"===parentNode.getAttribute("data-mce-bogus"))parentNode.parentNode.insertBefore(editor.dom.createFragment(value),parentNode);else{var node=parentNode.firstChild,node2=parentNode.lastChild;!node||node===node2&&"BR"===node.nodeName?editor.dom.setHTML(parentNode,value):selectionSetContent(editor,value)}},trimBrsFromTableCell=function(dom,elm){Option.from(dom.getParent(elm,"td,th")).map(Element.fromDom).each(PaddingBr.trimBlockTrailingBr)},reduceInlineTextElements=function(editor,merge){var textInlineElements=editor.schema.getTextInlineElements(),dom=editor.dom;if(merge){var root_1=editor.getBody(),elementUtils_1=new ElementUtils(dom);Tools.each(dom.select("*[data-mce-fragment]"),function(node){for(var testNode=node.parentNode;testNode&&testNode!==root_1;testNode=testNode.parentNode)textInlineElements[node.nodeName.toLowerCase()]&&elementUtils_1.compare(testNode,node)&&dom.remove(node,!0)})}},markFragmentElements=function(fragment){for(var node=fragment;node=node.walk();)1===node.type&&node.attr("data-mce-fragment","1")},umarkFragmentElements=function(elm){Tools.each(elm.getElementsByTagName("*"),function(elm){elm.removeAttribute("data-mce-fragment")})},isPartOfFragment=function(node){return!!node.getAttribute("data-mce-fragment")},canHaveChildren=function(editor,node){return node&&!editor.schema.getShortEndedElements()[node.nodeName]},moveSelectionToMarker=function(editor,marker){var parentEditableFalseElm,parentBlock,nextRng,node,node2,dom=editor.dom,selection=editor.selection;if(marker){if(editor.selection.scrollIntoView(marker),parentEditableFalseElm=function(node){for(var root=editor.getBody();node&&node!==root;node=node.parentNode)if("false"===editor.dom.getContentEditable(node))return node;return null}(marker))return dom.remove(marker),void selection.select(parentEditableFalseElm);var rng=dom.createRng();node=marker.previousSibling,node&&3===node.nodeType?(rng.setStart(node,node.nodeValue.length),Env.ie||(node2=marker.nextSibling)&&3===node2.nodeType&&(node.appendData(node2.data),node2.parentNode.removeChild(node2))):(rng.setStartBefore(marker),rng.setEndBefore(marker));parentBlock=dom.getParent(marker,dom.isBlock),dom.remove(marker),parentBlock&&dom.isEmpty(parentBlock)&&(editor.$(parentBlock).empty(),rng.setStart(parentBlock,0),rng.setEnd(parentBlock,0),isTableCell$5(parentBlock)||isPartOfFragment(parentBlock)||!(nextRng=function(rng){var caretPos=CaretPosition$1.fromRangeStart(rng);if(caretPos=CaretWalker(editor.getBody()).next(caretPos))return caretPos.toRange()}(rng))?dom.add(parentBlock,dom.create("br",{"data-mce-bogus":"1"})):(rng=nextRng,dom.remove(parentBlock))),selection.setRng(rng)}},insertHtmlAtCaret=function(editor,value,details){var parser,serializer,parentNode,rootNode,fragment,args,marker,rng,node,bookmarkHtml,merge,selection=editor.selection,dom=editor.dom;if(/^ | $/.test(value)&&(value=trimOrPadLeftRight(selection.getRng(),value)),parser=editor.parser,merge=details.merge,serializer=Serializer({validate:editor.settings.validate},editor.schema),bookmarkHtml='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;&#x200B;</span>',args={content:value,format:"html",selection:!0,paste:details.paste},args=editor.fire("BeforeSetContent",args),args.isDefaultPrevented())return void editor.fire("SetContent",{content:args.content,format:"html",selection:!0,paste:details.paste});value=args.content,-1===value.indexOf("{$caret}")&&(value+="{$caret}"),value=value.replace(/\{\$caret\}/,bookmarkHtml),rng=selection.getRng();var caretElement=rng.startContainer||(rng.parentElement?rng.parentElement():null),body=editor.getBody();caretElement===body&&selection.isCollapsed()&&dom.isBlock(body.firstChild)&&canHaveChildren(editor,body.firstChild)&&dom.isEmpty(body.firstChild)&&(rng=dom.createRng(),rng.setStart(body.firstChild,0),rng.setEnd(body.firstChild,0),selection.setRng(rng)),selection.isCollapsed()||(editor.selection.setRng(RangeNormalizer.normalize(editor.selection.getRng())),editor.getDoc().execCommand("Delete",!1,null),value=trimNbspAfterDeleteAndPadValue(editor.selection.getRng(),value)),parentNode=selection.getNode();var parserArgs={context:parentNode.nodeName.toLowerCase(),data:details.data,insert:!0};if(fragment=parser.parse(value,parserArgs),!0===details.paste&&InsertList.isListFragment(editor.schema,fragment)&&InsertList.isParentBlockLi(dom,parentNode))return rng=InsertList.insertAtCaret(serializer,dom,editor.selection.getRng(),fragment),editor.selection.setRng(rng),void editor.fire("SetContent",args);if(markFragmentElements(fragment),node=fragment.lastChild,"mce_marker"===node.attr("id"))for(marker=node,node=node.prev;node;node=node.walk(!0))if(3===node.type||!dom.isBlock(node.name)){editor.schema.isValidChild(node.parent.name,"span")&&node.parent.insert(marker,node,"br"===node.name);break}if(editor._selectionOverrides.showBlockCaretContainer(parentNode),parserArgs.invalid){for(selectionSetContent(editor,bookmarkHtml),parentNode=selection.getNode(),rootNode=editor.getBody(),9===parentNode.nodeType?parentNode=node=rootNode:node=parentNode;node!==rootNode;)parentNode=node,node=node.parentNode;value=parentNode===rootNode?rootNode.innerHTML:dom.getOuterHTML(parentNode),value=serializer.serialize(parser.parse(value.replace(/<span (id="mce_marker"|id=mce_marker).+?<\/span>/i,function(){return serializer.serialize(fragment)}))),parentNode===rootNode?dom.setHTML(rootNode,value):dom.setOuterHTML(parentNode,value)}else value=serializer.serialize(fragment),validInsertion(editor,value,parentNode);reduceInlineTextElements(editor,merge),moveSelectionToMarker(editor,dom.get("mce_marker")),umarkFragmentElements(editor.getBody()),trimBrsFromTableCell(editor.dom,editor.selection.getStart()),editor.fire("SetContent",args),editor.addVisual()},processValue=function(value){var details;return"string"!=typeof value?(details=Tools.extend({paste:value.paste,data:{paste:value.paste}},value),{content:value.content,details:details}):{content:value,details:{}}},insertAtCaret$1=function(editor,value){var result=processValue(value);insertHtmlAtCaret(editor,result.content,result.details)},InsertContent={insertAtCaret:insertAtCaret$1},nativeCommand=function(editor,command){editor.getDoc().execCommand(command,!1,null)},deleteCommand=function(editor){Outdent.backspaceDelete(editor,!1)||CefDelete.backspaceDelete(editor,!1)||CefBoundaryDelete.backspaceDelete(editor,!1)||BoundaryDelete.backspaceDelete(editor,!1)||BlockBoundaryDelete.backspaceDelete(editor,!1)||TableDelete.backspaceDelete(editor)||BlockRangeDelete.backspaceDelete(editor,!1)||InlineFormatDelete.backspaceDelete(editor,!1)||(nativeCommand(editor,"Delete"),DeleteUtils.paddEmptyBody(editor))},forwardDeleteCommand=function(editor){CefDelete.backspaceDelete(editor,!0)||CefBoundaryDelete.backspaceDelete(editor,!0)||BoundaryDelete.backspaceDelete(editor,!0)||BlockBoundaryDelete.backspaceDelete(editor,!0)||TableDelete.backspaceDelete(editor)||BlockRangeDelete.backspaceDelete(editor,!0)||InlineFormatDelete.backspaceDelete(editor,!0)||nativeCommand(editor,"ForwardDelete")},DeleteCommands={deleteCommand:deleteCommand,forwardDeleteCommand:forwardDeleteCommand},ancestor$3=function(scope,transform,isRoot){for(var element=scope.dom(),stop=isFunction(isRoot)?isRoot:constant(!1);element.parentNode;){element=element.parentNode;var el=Element.fromDom(element),transformed=transform(el);if(transformed.isSome())return transformed;if(stop(el))break}return Option.none()},closest$2=function(scope,transform,isRoot){return transform(scope).orThunk(function(){return isRoot(scope)?Option.none():ancestor$3(scope,transform,isRoot)})},legacyPropNames={"font-size":"size","font-family":"face"},getSpecifiedFontProp=function(propName,rootElm,elm){var getProperty=function(elm){return getRaw(elm,propName).orThunk(function(){return"font"===name(elm)?get(legacyPropNames,propName).bind(function(legacyPropName){return getOpt(elm,legacyPropName)}):Option.none()})},isRoot=function(elm){return eq(Element.fromDom(rootElm),elm)};return closest$2(Element.fromDom(elm),function(elm){return getProperty(elm)},isRoot)},round$1=function(number,precision){var factor=Math.pow(10,precision);return Math.round(number*factor)/factor},toPt=function(fontSize,precision){return/[0-9.]+px$/.test(fontSize)?round$1(72*parseInt(fontSize,10)/96,precision||0)+"pt":fontSize},normalizeFontFamily=function(fontFamily){return fontFamily.replace(/[\'\"\\]/g,"").replace(/,\s+/g,",")},getComputedFontProp=function(propName,elm){return Option.from(DOMUtils$1.DOM.getStyle(elm,propName,!0))},getFontProp=function(propName){return function(rootElm,elm){return Option.from(elm).map(Element.fromDom).filter(isElement).bind(function(element){return getSpecifiedFontProp(propName,rootElm,element.dom()).or(getComputedFontProp(propName,element.dom()))}).getOr("")}},FontInfo={getFontSize:getFontProp("font-size"),getFontFamily:compose(normalizeFontFamily,getFontProp("font-family")),toPt:toPt},findFirstCaretElement=function(editor){return CaretFinder.firstPositionIn(editor.getBody()).map(function(caret){var container=caret.container();return NodeType.isText(container)?container.parentNode:container})},isRangeAtStartOfNode=function(rng,root){return rng.startContainer===root&&0===rng.startOffset},getCaretElement=function(editor){return Option.from(editor.selection.getRng()).bind(function(rng){var root=editor.getBody();return isRangeAtStartOfNode(rng,root)?Option.none():Option.from(editor.selection.getStart(!0))})},fromFontSizeNumber=function(editor,value){if(/^[0-9\.]+$/.test(value)){var fontSizeNumber=parseInt(value,10);if(fontSizeNumber>=1&&fontSizeNumber<=7){var fontSizes=Settings.getFontStyleValues(editor),fontClasses=Settings.getFontSizeClasses(editor);return fontClasses?fontClasses[fontSizeNumber-1]||value:fontSizes[fontSizeNumber-1]||value}return value}return value},normalizeFontNames=function(font){var fonts=font.split(/\s*,\s*/);return map(fonts,function(font){return-1===font.indexOf(" ")||startsWith(font,'"')||startsWith(font,"'")?font:"'"+font+"'"}).join(",")},fontNameAction=function(editor,value){var font=fromFontSizeNumber(editor,value);editor.formatter.toggle("fontname",{value:normalizeFontNames(font)}),editor.nodeChanged()},fontNameQuery=function(editor){return getCaretElement(editor).fold(function(){return findFirstCaretElement(editor).map(function(caretElement){return FontInfo.getFontFamily(editor.getBody(),caretElement)}).getOr("")},function(caretElement){return FontInfo.getFontFamily(editor.getBody(),caretElement)})},fontSizeAction=function(editor,value){editor.formatter.toggle("fontsize",{value:fromFontSizeNumber(editor,value)}),editor.nodeChanged()},fontSizeQuery=function(editor){return getCaretElement(editor).fold(function(){return findFirstCaretElement(editor).map(function(caretElement){return FontInfo.getFontSize(editor.getBody(),caretElement)}).getOr("")},function(caretElement){return FontInfo.getFontSize(editor.getBody(),caretElement)})},each$f=Tools.each,map$3=Tools.map,inArray$2=Tools.inArray,EditorCommands=function(){function EditorCommands(editor){this.commands={state:{},exec:{},value:{}},this.editor=editor,this.setupCommands(editor)}return EditorCommands.prototype.execCommand=function(command,ui,value,args){var func,customCommand,state=!1,self=this;if(!self.editor.removed){if(/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(command)||args&&args.skip_focus?SelectionBookmark.restore(self.editor):self.editor.focus(),args=self.editor.fire("BeforeExecCommand",{command:command,ui:ui,value:value}),args.isDefaultPrevented())return!1;if(customCommand=command.toLowerCase(),func=self.commands.exec[customCommand])return func(customCommand,ui,value),self.editor.fire("ExecCommand",{command:command,ui:ui,value:value}),!0;if(each$f(this.editor.plugins,function(p){if(p.execCommand&&p.execCommand(command,ui,value))return self.editor.fire("ExecCommand",{command:command,ui:ui,value:value}),state=!0,!1}),state)return state;if(self.editor.theme&&self.editor.theme.execCommand&&self.editor.theme.execCommand(command,ui,value))return self.editor.fire("ExecCommand",{command:command,ui:ui,value:value}),!0;try{state=self.editor.getDoc().execCommand(command,ui,value)}catch(ex){}return!!state&&(self.editor.fire("ExecCommand",{command:command,ui:ui,value:value}),!0)}},EditorCommands.prototype.queryCommandState=function(command){var func;if(!this.editor.quirks.isHidden()&&!this.editor.removed){if(command=command.toLowerCase(),func=this.commands.state[command])return func(command);try{return this.editor.getDoc().queryCommandState(command)}catch(ex){}return!1}},EditorCommands.prototype.queryCommandValue=function(command){var func;if(!this.editor.quirks.isHidden()&&!this.editor.removed){if(command=command.toLowerCase(),func=this.commands.value[command])return func(command);try{return this.editor.getDoc().queryCommandValue(command)}catch(ex){}}},EditorCommands.prototype.addCommands=function(commandList,type){var self=this;type=type||"exec",each$f(commandList,function(callback,command){each$f(command.toLowerCase().split(","),function(command){self.commands[type][command]=callback})})},EditorCommands.prototype.addCommand=function(command,callback,scope){var _this=this;command=command.toLowerCase(),this.commands.exec[command]=function(command,ui,value,args){return callback.call(scope||_this.editor,ui,value,args)}},EditorCommands.prototype.queryCommandSupported=function(command){if(command=command.toLowerCase(),this.commands.exec[command])return!0;try{return this.editor.getDoc().queryCommandSupported(command)}catch(ex){}return!1},EditorCommands.prototype.addQueryStateHandler=function(command,callback,scope){var _this=this;command=command.toLowerCase(),this.commands.state[command]=function(){return callback.call(scope||_this.editor)}},EditorCommands.prototype.addQueryValueHandler=function(command,callback,scope){var _this=this;command=command.toLowerCase(),this.commands.value[command]=function(){return callback.call(scope||_this.editor)}},EditorCommands.prototype.hasCustomCommand=function(command){return command=command.toLowerCase(),!!this.commands.exec[command]},EditorCommands.prototype.execNativeCommand=function(command,ui,value){return void 0===ui&&(ui=!1),void 0===value&&(value=null),this.editor.getDoc().execCommand(command,ui,value)},EditorCommands.prototype.isFormatMatch=function(name){return this.editor.formatter.match(name)},EditorCommands.prototype.toggleFormat=function(name,value){this.editor.formatter.toggle(name,value?{value:value}:void 0),this.editor.nodeChanged()},EditorCommands.prototype.storeSelection=function(type){this.selectionBookmark=this.editor.selection.getBookmark(type)},EditorCommands.prototype.restoreSelection=function(){this.editor.selection.moveToBookmark(this.selectionBookmark)},EditorCommands.prototype.setupCommands=function(editor){var self=this;this.addCommands({"mceResetDesignMode,mceBeginUndoLevel":function(){},"mceEndUndoLevel,mceAddUndoLevel":function(){editor.undoManager.add()},"Cut,Copy,Paste":function(command){var failed,doc=editor.getDoc();try{self.execNativeCommand(command)}catch(ex){failed=!0}if("paste"!==command||doc.queryCommandEnabled(command)||(failed=!0),failed||!doc.queryCommandSupported(command)){var msg=editor.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.");Env.mac&&(msg=msg.replace(/Ctrl\+/g,"⌘+")),editor.notificationManager.open({text:msg,type:"error"})}},unlink:function(){if(editor.selection.isCollapsed()){var elm=editor.dom.getParent(editor.selection.getStart(),"a");return void(elm&&editor.dom.remove(elm,!0))}editor.formatter.remove("link")},"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull,JustifyNone":function(command){var align=command.substring(7);"full"===align&&(align="justify"),each$f("left,center,right,justify".split(","),function(name){align!==name&&editor.formatter.remove("align"+name)}),"none"!==align&&self.toggleFormat("align"+align)},"InsertUnorderedList,InsertOrderedList":function(command){var listElm,listParent;self.execNativeCommand(command),(listElm=editor.dom.getParent(editor.selection.getNode(),"ol,ul"))&&(listParent=listElm.parentNode,/^(H[1-6]|P|ADDRESS|PRE)$/.test(listParent.nodeName)&&(self.storeSelection(),editor.dom.split(listParent,listElm),self.restoreSelection()))},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(command){self.toggleFormat(command)},"ForeColor,HiliteColor":function(command,ui,value){self.toggleFormat(command,value)},FontName:function(command,ui,value){fontNameAction(editor,value)},FontSize:function(command,ui,value){fontSizeAction(editor,value)},RemoveFormat:function(command){editor.formatter.remove(command)},mceBlockQuote:function(){self.toggleFormat("blockquote")},FormatBlock:function(command,ui,value){return self.toggleFormat(value||"p")},mceCleanup:function(){var bookmark=editor.selection.getBookmark();editor.setContent(editor.getContent()),editor.selection.moveToBookmark(bookmark)},mceRemoveNode:function(command,ui,value){var node=value||editor.selection.getNode();node!==editor.getBody()&&(self.storeSelection(),editor.dom.remove(node,!0),self.restoreSelection())},mceSelectNodeDepth:function(command,ui,value){var counter=0;editor.dom.getParent(editor.selection.getNode(),function(node){if(1===node.nodeType&&counter++===value)return editor.selection.select(node),!1},editor.getBody())},mceSelectNode:function(command,ui,value){editor.selection.select(value)},mceInsertContent:function(command,ui,value){InsertContent.insertAtCaret(editor,value)},mceInsertRawHTML:function(command,ui,value){editor.selection.setContent("tiny_mce_marker");var content=editor.getContent();editor.setContent(content.replace(/tiny_mce_marker/g,function(){return value}))},mceInsertNewLine:function(command,ui,value){InsertNewLine.insert(editor,value)},mceToggleFormat:function(command,ui,value){self.toggleFormat(value)},mceSetContent:function(command,ui,value){editor.setContent(value)},"Indent,Outdent":function(command){handle(editor,command)},mceRepaint:function(){},InsertHorizontalRule:function(){editor.execCommand("mceInsertContent",!1,"<hr />")},mceToggleVisualAid:function(){editor.hasVisual=!editor.hasVisual,editor.addVisual()},mceReplaceContent:function(command,ui,value){editor.execCommand("mceInsertContent",!1,value.replace(/\{\$selection\}/g,editor.selection.getContent({format:"text"})))},mceInsertLink:function(command,ui,value){var anchor;"string"==typeof value&&(value={href:value}),anchor=editor.dom.getParent(editor.selection.getNode(),"a"),value.href=value.href.replace(/ /g,"%20"),anchor&&value.href||editor.formatter.remove("link"),value.href&&editor.formatter.apply("link",value,anchor)},selectAll:function(){var editingHost=editor.dom.getParent(editor.selection.getStart(),NodeType.isContentEditableTrue);if(editingHost){var rng=editor.dom.createRng();rng.selectNodeContents(editingHost),editor.selection.setRng(rng)}},delete:function(){DeleteCommands.deleteCommand(editor)},forwardDelete:function(){DeleteCommands.forwardDeleteCommand(editor)},mceNewDocument:function(){editor.setContent("")},InsertLineBreak:function(command,ui,value){return InsertBr.insert(editor,value),!0}});var alignStates=function(name){return function(){var nodes=editor.selection.isCollapsed()?[editor.dom.getParent(editor.selection.getNode(),editor.dom.isBlock)]:editor.selection.getSelectedBlocks(),matches=map$3(nodes,function(node){return!!editor.formatter.matchNode(node,name)});return-1!==inArray$2(matches,!0)}};self.addCommands({JustifyLeft:alignStates("alignleft"),JustifyCenter:alignStates("aligncenter"),JustifyRight:alignStates("alignright"),JustifyFull:alignStates("alignjustify"),"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(command){return self.isFormatMatch(command)},mceBlockQuote:function(){return self.isFormatMatch("blockquote")},Outdent:function(){return canOutdent(editor)},"InsertUnorderedList,InsertOrderedList":function(command){var list=editor.dom.getParent(editor.selection.getNode(),"ul,ol");return list&&("insertunorderedlist"===command&&"UL"===list.tagName||"insertorderedlist"===command&&"OL"===list.tagName)}},"state"),self.addCommands({Undo:function(){editor.undoManager.undo()},Redo:function(){editor.undoManager.redo()}}),self.addQueryValueHandler("FontName",function(){return fontNameQuery(editor)},this),self.addQueryValueHandler("FontSize",function(){return fontSizeQuery(editor)},this)},EditorCommands}(),nativeEvents=Tools.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel"," "),EventDispatcher=function(){function EventDispatcher(settings){this.bindings={},this.settings=settings||{},this.scope=this.settings.scope||this,this.toggleEvent=this.settings.toggleEvent||never}return EventDispatcher.isNative=function(name){return!!nativeEvents[name.toLowerCase()]},EventDispatcher.prototype.fire=function(name,args){var handlers,i,l,callback;if(name=name.toLowerCase(),args=args||{},args.type=name,args.target||(args.target=this.scope),args.preventDefault||(args.preventDefault=function(){args.isDefaultPrevented=always},args.stopPropagation=function(){args.isPropagationStopped=always},args.stopImmediatePropagation=function(){args.isImmediatePropagationStopped=always},args.isDefaultPrevented=never,args.isPropagationStopped=never,args.isImmediatePropagationStopped=never),this.settings.beforeFire&&this.settings.beforeFire(args),handlers=this.bindings[name])for(i=0,l=handlers.length;i<l;i++){if(callback=handlers[i],callback.once&&this.off(name,callback.func),args.isImmediatePropagationStopped())return args.stopPropagation(),args;if(!1===callback.func.call(this.scope,args))return args.preventDefault(),args}return args},EventDispatcher.prototype.on=function(name,callback,prepend,extra){var handlers,names,i;if(!1===callback&&(callback=never),callback){var wrappedCallback={func:callback};for(extra&&Tools.extend(wrappedCallback,extra),names=name.toLowerCase().split(" "),i=names.length;i--;)name=names[i],handlers=this.bindings[name],handlers||(handlers=this.bindings[name]=[],this.toggleEvent(name,!0)),prepend?handlers.unshift(wrappedCallback):handlers.push(wrappedCallback)}return this},EventDispatcher.prototype.off=function(name,callback){var i,handlers,bindingName,names,hi;if(name)for(names=name.toLowerCase().split(" "),i=names.length;i--;){if(name=names[i],handlers=this.bindings[name],!name){for(bindingName in this.bindings)this.toggleEvent(bindingName,!1),delete this.bindings[bindingName];return this}if(handlers){if(callback)for(hi=handlers.length;hi--;)handlers[hi].func===callback&&(handlers=handlers.slice(0,hi).concat(handlers.slice(hi+1)),this.bindings[name]=handlers);else handlers.length=0;handlers.length||(this.toggleEvent(name,!1),delete this.bindings[name])}}else{for(name in this.bindings)this.toggleEvent(name,!1);this.bindings={}}return this},EventDispatcher.prototype.once=function(name,callback,prepend){return this.on(name,callback,prepend,{once:!0})},EventDispatcher.prototype.has=function(name){return name=name.toLowerCase(),!(!this.bindings[name]||0===this.bindings[name].length)},EventDispatcher}(),getEventDispatcher=function(obj){return obj._eventDispatcher||(obj._eventDispatcher=new EventDispatcher({scope:obj,toggleEvent:function(name,state){EventDispatcher.isNative(name)&&obj.toggleNativeEvent&&obj.toggleNativeEvent(name,state)}})),obj._eventDispatcher},Observable={fire:function(name,args,bubble){var self=this;if(self.removed&&"remove"!==name&&"detach"!==name)return args;var dispatcherArgs=getEventDispatcher(self).fire(name,args);if(!1!==bubble&&self.parent)for(var parent_1=self.parent();parent_1&&!dispatcherArgs.isPropagationStopped();)parent_1.fire(name,dispatcherArgs,!1),parent_1=parent_1.parent();return dispatcherArgs},on:function(name,callback,prepend){return getEventDispatcher(this).on(name,callback,prepend)},off:function(name,callback){return getEventDispatcher(this).off(name,callback)},once:function(name,callback){return getEventDispatcher(this).once(name,callback)},hasEventListeners:function(name){return getEventDispatcher(this).has(name)}},toggleClass=function(elm,cls,state){has$2(elm,cls)&&!1===state?remove$4(elm,cls):state&&add$3(elm,cls)},setEditorCommandState=function(editor,cmd,state){try{editor.getDoc().execCommand(cmd,!1,state)}catch(ex){}},setContentEditable=function(elm,state){elm.dom().contentEditable=state?"true":"false"},switchOffContentEditableTrue=function(elm){each(descendants$1(elm,'*[contenteditable="true"]'),function(elm){set(elm,"data-mce-contenteditable","true"),setContentEditable(elm,!1)})},switchOnContentEditableTrue=function(elm){each(descendants$1(elm,'*[data-mce-contenteditable="true"]'),function(elm){remove$1(elm,"data-mce-contenteditable"),setContentEditable(elm,!0)})},removeFakeSelection=function(editor){Option.from(editor.selection.getNode()).each(function(elm){elm.removeAttribute("data-mce-selected")})},restoreFakeSelection=function(editor){editor.selection.setRng(editor.selection.getRng())},toggleReadOnly=function(editor,state){var body=Element.fromDom(editor.getBody());toggleClass(body,"mce-content-readonly",state),state?(editor.selection.controlSelection.hideResizeRect(),editor._selectionOverrides.hideFakeCaret(),removeFakeSelection(editor),editor.readonly=!0,setContentEditable(body,!1),switchOffContentEditableTrue(body)):(editor.readonly=!1,setContentEditable(body,!0),switchOnContentEditableTrue(body),setEditorCommandState(editor,"StyleWithCSS",!1),setEditorCommandState(editor,"enableInlineTableEditing",!1),setEditorCommandState(editor,"enableObjectResizing",!1),EditorFocus.hasEditorOrUiFocus(editor)&&editor.focus(),restoreFakeSelection(editor),editor.nodeChanged())},isReadOnly=function(editor){return!0===editor.readonly},registerFilters=function(editor){editor.parser.addAttributeFilter("contenteditable",function(nodes){isReadOnly(editor)&&each(nodes,function(node){node.attr("data-mce-contenteditable",node.attr("contenteditable")),node.attr("contenteditable","false")})}),editor.serializer.addAttributeFilter("data-mce-contenteditable",function(nodes){isReadOnly(editor)&&each(nodes,function(node){node.attr("contenteditable",node.attr("data-mce-contenteditable"))})}),editor.serializer.addTempAttr("data-mce-contenteditable")},registerReadOnlyContentFilters=function(editor){editor.serializer?registerFilters(editor):editor.on("PreInit",function(){registerFilters(editor)})},isClickEvent=function(e){return"click"===e.type},isInAnchor=function(editor,target){return null!==editor.dom.getParent(target,"a")},preventReadOnlyEvents=function(editor,e){var target=e.target;isClickEvent(e)&&!VK.metaKeyPressed(e)&&isInAnchor(editor,target)&&e.preventDefault()},registerReadOnlySelectionBlockers=function(editor){editor.on("ShowCaret",function(e){isReadOnly(editor)&&e.preventDefault()}),editor.on("ObjectSelected",function(e){isReadOnly(editor)&&e.preventDefault()})},DOM$8=DOMUtils$1.DOM,getEventTarget=function(editor,eventName){return"selectionchange"===eventName?editor.getDoc():!editor.inline&&/^mouse|touch|click|contextmenu|drop|dragover|dragend/.test(eventName)?editor.getDoc().documentElement:editor.settings.event_root?(editor.eventRoot||(editor.eventRoot=DOM$8.select(editor.settings.event_root)[0]),editor.eventRoot):editor.getBody()},isListening=function(editor){return!editor.hidden&&!isReadOnly(editor)},fireEvent=function(editor,eventName,e){isListening(editor)?editor.fire(eventName,e):isReadOnly(editor)&&preventReadOnlyEvents(editor,e)},bindEventDelegate=function(editor,eventName){var eventRootElm,delegate;if(editor.delegates||(editor.delegates={}),!editor.delegates[eventName]&&!editor.removed)if(eventRootElm=getEventTarget(editor,eventName),editor.settings.event_root){if(customEventRootDelegates||(customEventRootDelegates={},editor.editorManager.on("removeEditor",function(){var name;if(!editor.editorManager.activeEditor&&customEventRootDelegates){for(name in customEventRootDelegates)editor.dom.unbind(getEventTarget(editor,name));customEventRootDelegates=null}})),customEventRootDelegates[eventName])return;delegate=function(e){for(var target=e.target,editors=editor.editorManager.get(),i=editors.length;i--;){var body=editors[i].getBody();(body===target||DOM$8.isChildOf(target,body))&&fireEvent(editors[i],eventName,e)}},customEventRootDelegates[eventName]=delegate,DOM$8.bind(eventRootElm,eventName,delegate)}else delegate=function(e){fireEvent(editor,eventName,e)},DOM$8.bind(eventRootElm,eventName,delegate),editor.delegates[eventName]=delegate},EditorObservable=__assign(__assign({},Observable),{bindPendingEventDelegates:function(){var self=this;Tools.each(self._pendingNativeEvents,function(name){bindEventDelegate(self,name)})},toggleNativeEvent:function(name,state){var self=this;"focus"!==name&&"blur"!==name&&(state?self.initialized?bindEventDelegate(self,name):self._pendingNativeEvents?self._pendingNativeEvents.push(name):self._pendingNativeEvents=[name]:self.initialized&&(self.dom.unbind(getEventTarget(self,name),name,self.delegates[name]),delete self.delegates[name]))},unbindAllNativeEvents:function(){var name,self=this,body=self.getBody(),dom=self.dom;if(self.delegates){for(name in self.delegates)self.dom.unbind(getEventTarget(self,name),name,self.delegates[name]);delete self.delegates}!self.inline&&body&&dom&&(body.onload=null,dom.unbind(self.getWin()),dom.unbind(self.getDoc())),dom&&(dom.unbind(body),dom.unbind(self.getContainer()))}}),defaultModes=["design","readonly"],switchToMode=function(editor,activeMode,availableModes,mode){var oldMode=availableModes[activeMode.get()],newMode=availableModes[mode];try{newMode.activate()}catch(e){return void domGlobals.console.error("problem while activating editor mode "+mode+":",e)}oldMode.deactivate(),oldMode.editorReadOnly!==newMode.editorReadOnly&&toggleReadOnly(editor,newMode.editorReadOnly),activeMode.set(mode),fireSwitchMode(editor,mode)},setMode=function(editor,availableModes,activeMode,mode){if(mode!==activeMode.get()){if(!has(availableModes,mode))throw new Error("Editor mode '"+mode+"' is invalid");editor.initialized?switchToMode(editor,activeMode,availableModes,mode):editor.on("init",function(){return switchToMode(editor,activeMode,availableModes,mode)})}},registerMode=function(availableModes,mode,api){var _a;if(contains(defaultModes,mode))throw new Error("Cannot override default mode "+mode);return __assign(__assign({},availableModes),(_a={},_a[mode]=__assign(__assign({},api),{deactivate:function(){try{api.deactivate()}catch(e){domGlobals.console.error("problem while deactivating editor mode "+mode+":",e)}}}),_a))},create$4=function(editor){var activeMode=Cell("design"),availableModes=Cell({design:{activate:noop,deactivate:noop,editorReadOnly:!1},readonly:{activate:noop,deactivate:noop,editorReadOnly:!0}});return registerReadOnlyContentFilters(editor),registerReadOnlySelectionBlockers(editor),{isReadOnly:function(){return isReadOnly(editor)},set:function(mode){return setMode(editor,availableModes.get(),activeMode,mode)},get:function(){return activeMode.get()},register:function(mode,api){availableModes.set(registerMode(availableModes.get(),mode,api))}}},each$g=Tools.each,explode$3=Tools.explode,keyCodeLookup={f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},modifierNames=Tools.makeMap("alt,ctrl,shift,meta,access"),Shortcuts=function(){function Shortcuts(editor){this.shortcuts={},this.pendingPatterns=[],this.editor=editor;var self=this;editor.on("keyup keypress keydown",function(e){!self.hasModifier(e)&&!self.isFunctionKey(e)||e.isDefaultPrevented()||(each$g(self.shortcuts,function(shortcut){if(self.matchShortcut(e,shortcut))return self.pendingPatterns=shortcut.subpatterns.slice(0),"keydown"===e.type&&self.executeShortcutAction(shortcut),!0}),self.matchShortcut(e,self.pendingPatterns[0])&&(1===self.pendingPatterns.length&&"keydown"===e.type&&self.executeShortcutAction(self.pendingPatterns[0]),self.pendingPatterns.shift()))})}return Shortcuts.prototype.add=function(pattern,desc,cmdFunc,scope){var cmd,self=this;return cmd=cmdFunc,"string"==typeof cmdFunc?cmdFunc=function(){self.editor.execCommand(cmd,!1,null)}:Tools.isArray(cmd)&&(cmdFunc=function(){self.editor.execCommand(cmd[0],cmd[1],cmd[2])}),each$g(explode$3(Tools.trim(pattern)),function(pattern){var shortcut=self.createShortcut(pattern,desc,cmdFunc,scope);self.shortcuts[shortcut.id]=shortcut}),!0},Shortcuts.prototype.remove=function(pattern){var shortcut=this.createShortcut(pattern);return!!this.shortcuts[shortcut.id]&&(delete this.shortcuts[shortcut.id],!0)},Shortcuts.prototype.parseShortcut=function(pattern){var id,key,shortcut={};each$g(explode$3(pattern.toLowerCase(),"+"),function(value){value in modifierNames?shortcut[value]=!0:/^[0-9]{2,}$/.test(value)?shortcut.keyCode=parseInt(value,10):(shortcut.charCode=value.charCodeAt(0),shortcut.keyCode=keyCodeLookup[value]||value.toUpperCase().charCodeAt(0))}),id=[shortcut.keyCode];for(key in modifierNames)shortcut[key]?id.push(key):shortcut[key]=!1;return shortcut.id=id.join(","),shortcut.access&&(shortcut.alt=!0,Env.mac?shortcut.ctrl=!0:shortcut.shift=!0),shortcut.meta&&(Env.mac?shortcut.meta=!0:(shortcut.ctrl=!0,shortcut.meta=!1)),shortcut},Shortcuts.prototype.createShortcut=function(pattern,desc,cmdFunc,scope){var shortcuts;return shortcuts=Tools.map(explode$3(pattern,">"),this.parseShortcut),shortcuts[shortcuts.length-1]=Tools.extend(shortcuts[shortcuts.length-1],{func:cmdFunc,scope:scope||this.editor}),Tools.extend(shortcuts[0],{desc:this.editor.translate(desc),subpatterns:shortcuts.slice(1)})},Shortcuts.prototype.hasModifier=function(e){return e.altKey||e.ctrlKey||e.metaKey},Shortcuts.prototype.isFunctionKey=function(e){return"keydown"===e.type&&e.keyCode>=112&&e.keyCode<=123},Shortcuts.prototype.matchShortcut=function(e,shortcut){return!!shortcut&&(shortcut.ctrl===e.ctrlKey&&shortcut.meta===e.metaKey&&(shortcut.alt===e.altKey&&shortcut.shift===e.shiftKey&&(!!(e.keyCode===shortcut.keyCode||e.charCode&&e.charCode===shortcut.charCode)&&(e.preventDefault(),!0))))},Shortcuts.prototype.executeShortcutAction=function(shortcut){return shortcut.func?shortcut.func.call(shortcut.scope):null},Shortcuts}(),create$5=function(){var buttons={},menuItems={},popups={},icons={},contextMenus={},contextToolbars={},sidebars={},add=function(collection,type){return function(name,spec){return collection[name.toLowerCase()]=__assign(__assign({},spec),{type:type})}},addIcon=function(name,svgData){return icons[name.toLowerCase()]=svgData};return{addButton:add(buttons,"button"),addGroupToolbarButton:add(buttons,"grouptoolbarbutton"),addToggleButton:add(buttons,"togglebutton"),addMenuButton:add(buttons,"menubutton"),addSplitButton:add(buttons,"splitbutton"),addMenuItem:add(menuItems,"menuitem"),addNestedMenuItem:add(menuItems,"nestedmenuitem"),addToggleMenuItem:add(menuItems,"togglemenuitem"),addAutocompleter:add(popups,"autocompleter"),addContextMenu:add(contextMenus,"contextmenu"),addContextToolbar:add(contextToolbars,"contexttoolbar"),addContextForm:add(contextToolbars,"contextform"),addSidebar:add(sidebars,"sidebar"),addIcon:addIcon,getAll:function(){return{buttons:buttons,menuItems:menuItems,icons:icons,popups:popups,contextMenus:contextMenus,contextToolbars:contextToolbars,sidebars:sidebars}}}},registry=function(){var bridge=create$5();return{addAutocompleter:bridge.addAutocompleter,addButton:bridge.addButton,addContextForm:bridge.addContextForm,addContextMenu:bridge.addContextMenu,addContextToolbar:bridge.addContextToolbar,addIcon:bridge.addIcon,addMenuButton:bridge.addMenuButton,addMenuItem:bridge.addMenuItem,addNestedMenuItem:bridge.addNestedMenuItem,addSidebar:bridge.addSidebar,addSplitButton:bridge.addSplitButton,addToggleButton:bridge.addToggleButton,addGroupToolbarButton:bridge.addGroupToolbarButton,addToggleMenuItem:bridge.addToggleMenuItem,getAll:bridge.getAll}},each$h=Tools.each,trim$4=Tools.trim,queryParts="source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),DEFAULT_PORTS={ftp:21,http:80,https:443,mailto:25},URI=function(){function URI(url,settings){url=trim$4(url),this.settings=settings||{};var baseUri=this.settings.base_uri,self=this;if(/^([\w\-]+):([^\/]{2})/i.test(url)||/^\s*#/.test(url))return void(self.source=url);var isProtocolRelative=0===url.indexOf("//");if(0!==url.indexOf("/")||isProtocolRelative||(url=(baseUri?baseUri.protocol||"http":"http")+"://mce_host"+url),!/^[\w\-]*:?\/\//.test(url)){var baseUrl=this.settings.base_uri?this.settings.base_uri.path:new URI(domGlobals.document.location.href).directory;if(this.settings.base_uri&&""==this.settings.base_uri.protocol)url="//mce_host"+self.toAbsPath(baseUrl,url);else{var match=/([^#?]*)([#?]?.*)/.exec(url);url=(baseUri&&baseUri.protocol||"http")+"://mce_host"+self.toAbsPath(baseUrl,match[1])+match[2]}}url=url.replace(/@@/g,"(mce_at)");var urlMatch=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(url);each$h(queryParts,function(v,i){var part=urlMatch[i];part&&(part=part.replace(/\(mce_at\)/g,"@@")),self[v]=part}),baseUri&&(self.protocol||(self.protocol=baseUri.protocol),self.userInfo||(self.userInfo=baseUri.userInfo),self.port||"mce_host"!==self.host||(self.port=baseUri.port),self.host&&"mce_host"!==self.host||(self.host=baseUri.host),self.source=""),isProtocolRelative&&(self.protocol="")}return URI.parseDataUri=function(uri){var type,uriComponents=decodeURIComponent(uri).split(","),matches=/data:([^;]+)/.exec(uriComponents[0]);return matches&&(type=matches[1]),{type:type,data:uriComponents[1]}},URI.getDocumentBaseUrl=function(loc){var baseUrl;return baseUrl=0!==loc.protocol.indexOf("http")&&"file:"!==loc.protocol?loc.href:loc.protocol+"//"+loc.host+loc.pathname,/^[^:]+:\/\/\/?[^\/]+\//.test(baseUrl)&&(baseUrl=baseUrl.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(baseUrl)||(baseUrl+="/")),baseUrl},URI.prototype.setPath=function(path){var pathMatch=/^(.*?)\/?(\w+)?$/.exec(path);this.path=pathMatch[0],this.directory=pathMatch[1],this.file=pathMatch[2],this.source="",this.getURI()},URI.prototype.toRelative=function(uri){var output;if("./"===uri)return uri;var relativeUri=new URI(uri,{base_uri:this});if("mce_host"!==relativeUri.host&&this.host!==relativeUri.host&&relativeUri.host||this.port!==relativeUri.port||this.protocol!==relativeUri.protocol&&""!==relativeUri.protocol)return relativeUri.getURI();var tu=this.getURI(),uu=relativeUri.getURI();return tu===uu||"/"===tu.charAt(tu.length-1)&&tu.substr(0,tu.length-1)===uu?tu:(output=this.toRelPath(this.path,relativeUri.path),relativeUri.query&&(output+="?"+relativeUri.query),relativeUri.anchor&&(output+="#"+relativeUri.anchor),output)},URI.prototype.toAbsolute=function(uri,noHost){var absoluteUri=new URI(uri,{base_uri:this});return absoluteUri.getURI(noHost&&this.isSameOrigin(absoluteUri))},URI.prototype.isSameOrigin=function(uri){if(this.host==uri.host&&this.protocol==uri.protocol){if(this.port==uri.port)return!0;var defaultPort=DEFAULT_PORTS[this.protocol];if(defaultPort&&(this.port||defaultPort)==(uri.port||defaultPort))return!0}return!1},URI.prototype.toRelPath=function(base,path){var items,i,l,breakPoint=0,out="",normalizedBase=base.substring(0,base.lastIndexOf("/")).split("/");if(items=path.split("/"),normalizedBase.length>=items.length)for(i=0,l=normalizedBase.length;i<l;i++)if(i>=items.length||normalizedBase[i]!==items[i]){breakPoint=i+1;break}if(normalizedBase.length<items.length)for(i=0,l=items.length;i<l;i++)if(i>=normalizedBase.length||normalizedBase[i]!==items[i]){breakPoint=i+1;break}if(1===breakPoint)return path;for(i=0,l=normalizedBase.length-(breakPoint-1);i<l;i++)out+="../";for(i=breakPoint-1,l=items.length;i<l;i++)out+=i!==breakPoint-1?"/"+items[i]:items[i];return out},URI.prototype.toAbsPath=function(base,path){var i,tr,outPath,nb=0,o=[];tr=/\/$/.test(path)?"/":"";var normalizedBase=base.split("/"),normalizedPath=path.split("/");for(each$h(normalizedBase,function(k){k&&o.push(k)}),normalizedBase=o,i=normalizedPath.length-1,o=[];i>=0;i--)0!==normalizedPath[i].length&&"."!==normalizedPath[i]&&(".."!==normalizedPath[i]?nb>0?nb--:o.push(normalizedPath[i]):nb++);return i=normalizedBase.length-nb,outPath=i<=0?reverse(o).join("/"):normalizedBase.slice(0,i).join("/")+"/"+reverse(o).join("/"),0!==outPath.indexOf("/")&&(outPath="/"+outPath),tr&&outPath.lastIndexOf("/")!==outPath.length-1&&(outPath+=tr),outPath},URI.prototype.getURI=function(noProtoHost){void 0===noProtoHost&&(noProtoHost=!1);var s;return this.source&&!noProtoHost||(s="",noProtoHost||(this.protocol?s+=this.protocol+"://":s+="//",this.userInfo&&(s+=this.userInfo+"@"),this.host&&(s+=this.host),this.port&&(s+=":"+this.port)),this.path&&(s+=this.path),this.query&&(s+="?"+this.query),this.anchor&&(s+="#"+this.anchor),this.source=s),this.source},URI}(),DOM$9=DOMUtils$1.DOM,extend$3=Tools.extend,each$i=Tools.each,resolve$3=Tools.resolve,ie$1=Env.ie,Editor=function(){function Editor(id,settings,editorManager){var _this=this;this.plugins={},this.contentCSS=[],this.contentStyles=[],this.loadedCSS={},this.isNotDirty=!1,this.editorManager=editorManager,this.documentBaseUrl=editorManager.documentBaseURL,extend$3(this,EditorObservable),this.settings=getEditorSettings(this,id,this.documentBaseUrl,editorManager.defaultSettings,settings),this.settings.suffix&&(editorManager.suffix=this.settings.suffix),this.suffix=editorManager.suffix,this.settings.base_url&&editorManager._setBaseUrl(this.settings.base_url),this.baseUri=editorManager.baseURI,this.settings.referrer_policy&&(ScriptLoader.ScriptLoader._setReferrerPolicy(this.settings.referrer_policy),DOMUtils$1.DOM.styleSheetLoader._setReferrerPolicy(this.settings.referrer_policy)),AddOnManager$1.languageLoad=this.settings.language_load,AddOnManager$1.baseURL=editorManager.baseURL,this.id=id,this.setDirty(!1),this.documentBaseURI=new URI(this.settings.document_base_url,{base_uri:this.baseUri}),this.baseURI=this.baseUri,this.inline=!!this.settings.inline,this.shortcuts=new Shortcuts(this),this.editorCommands=new EditorCommands(this),this.settings.cache_suffix&&(Env.cacheSuffix=this.settings.cache_suffix.replace(/^[\?\&]+/,"")),this.ui={registry:registry()};var self=this,modeInstance=create$4(self);this.mode=modeInstance,this.setMode=modeInstance.set,editorManager.fire("SetupEditor",{editor:this}),this.execCallback("setup",this),this.$=DomQuery.overrideDefaults(function(){return{context:_this.inline?_this.getBody():_this.getDoc(),element:_this.getBody()}})}return Editor.prototype.render=function(){Render.render(this)},Editor.prototype.focus=function(skipFocus){EditorFocus.focus(this,skipFocus)},Editor.prototype.hasFocus=function(){return EditorFocus.hasFocus(this)},Editor.prototype.execCallback=function(name){for(var x=[],_i=1;_i<arguments.length;_i++)x[_i-1]=arguments[_i];var scope,self=this,callback=self.settings[name];if(callback)return self.callbackLookup&&(scope=self.callbackLookup[name])&&(callback=scope.func,scope=scope.scope),"string"==typeof callback&&(scope=callback.replace(/\.\w+$/,""),scope=scope?resolve$3(scope):0,callback=resolve$3(callback),self.callbackLookup=self.callbackLookup||{},self.callbackLookup[name]={func:callback,scope:scope}),callback.apply(scope||self,Array.prototype.slice.call(arguments,1))},Editor.prototype.translate=function(text){return I18n.translate(text)},Editor.prototype.getParam=function(name,defaultVal,type){return getParam(this,name,defaultVal,type)},Editor.prototype.nodeChanged=function(args){this._nodeChangeDispatcher.nodeChanged(args)},Editor.prototype.addCommand=function(name,callback,scope){this.editorCommands.addCommand(name,callback,scope)},Editor.prototype.addQueryStateHandler=function(name,callback,scope){this.editorCommands.addQueryStateHandler(name,callback,scope)},Editor.prototype.addQueryValueHandler=function(name,callback,scope){this.editorCommands.addQueryValueHandler(name,callback,scope)},Editor.prototype.addShortcut=function(pattern,desc,cmdFunc,scope){this.shortcuts.add(pattern,desc,cmdFunc,scope)},Editor.prototype.execCommand=function(cmd,ui,value,args){return this.editorCommands.execCommand(cmd,ui,value,args)},Editor.prototype.queryCommandState=function(cmd){return this.editorCommands.queryCommandState(cmd)},Editor.prototype.queryCommandValue=function(cmd){return this.editorCommands.queryCommandValue(cmd)},Editor.prototype.queryCommandSupported=function(cmd){return this.editorCommands.queryCommandSupported(cmd)},Editor.prototype.show=function(){var self=this;self.hidden&&(self.hidden=!1,self.inline?self.getBody().contentEditable="true":(DOM$9.show(self.getContainer()),DOM$9.hide(self.id)),self.load(),self.fire("show"))},Editor.prototype.hide=function(){var self=this,doc=self.getDoc();self.hidden||(ie$1&&doc&&!self.inline&&doc.execCommand("SelectAll"),self.save(),self.inline?(self.getBody().contentEditable="false",self===self.editorManager.focusedEditor&&(self.editorManager.focusedEditor=null)):(DOM$9.hide(self.getContainer()),DOM$9.setStyle(self.id,"display",self.orgDisplay)),self.hidden=!0,self.fire("hide"))},Editor.prototype.isHidden=function(){return!!this.hidden},Editor.prototype.setProgressState=function(state,time){this.fire("ProgressState",{state:state,time:time})},Editor.prototype.load=function(args){var html,self=this,elm=self.getElement();if(self.removed)return"";if(elm){args=args||{},args.load=!0;var value=NodeType.isTextareaOrInput(elm)?elm.value:elm.innerHTML;return html=self.setContent(value,args),args.element=elm,args.no_events||self.fire("LoadContent",args),args.element=elm=null,html}},Editor.prototype.save=function(args){var html,form,self=this,elm=self.getElement();if(elm&&self.initialized&&!self.removed)return args=args||{},args.save=!0,args.element=elm,html=args.content=self.getContent(args),args.no_events||self.fire("SaveContent",args),"raw"===args.format&&self.fire("RawSaveContent",args),html=args.content,NodeType.isTextareaOrInput(elm)?elm.value=html:(!args.is_removing&&self.inline||(elm.innerHTML=html),(form=DOM$9.getParent(self.id,"form"))&&each$i(form.elements,function(elm){if(elm.name===self.id)return elm.value=html,!1})),args.element=elm=null,!1!==args.set_dirty&&self.setDirty(!1),html},Editor.prototype.setContent=function(content,args){return setContent(this,content,args)},Editor.prototype.getContent=function(args){return getContent(this,args)},Editor.prototype.insertContent=function(content,args){args&&(content=extend$3({content:content},args)),this.execCommand("mceInsertContent",!1,content)},Editor.prototype.resetContent=function(initialContent){void 0===initialContent?setContent(this,this.startContent,{format:"raw"}):setContent(this,initialContent),this.undoManager.reset(),this.setDirty(!1),this.nodeChanged()},Editor.prototype.isDirty=function(){return!this.isNotDirty},Editor.prototype.setDirty=function(state){var oldState=!this.isNotDirty;this.isNotDirty=!state,state&&state!==oldState&&this.fire("dirty")},Editor.prototype.getContainer=function(){var self=this;return self.container||(self.container=DOM$9.get(self.editorContainer||self.id+"_parent")),self.container},Editor.prototype.getContentAreaContainer=function(){return this.contentAreaContainer},Editor.prototype.getElement=function(){return this.targetElm||(this.targetElm=DOM$9.get(this.id)),this.targetElm},Editor.prototype.getWin=function(){var elm,self=this;return self.contentWindow||(elm=self.iframeElement)&&(self.contentWindow=elm.contentWindow),self.contentWindow},Editor.prototype.getDoc=function(){var win,self=this;return self.contentDocument||(win=self.getWin())&&(self.contentDocument=win.document),self.contentDocument},Editor.prototype.getBody=function(){var doc=this.getDoc();return this.bodyElement||(doc?doc.body:null)},Editor.prototype.convertURL=function(url,name,elm){var self=this,settings=self.settings;return settings.urlconverter_callback?self.execCallback("urlconverter_callback",url,elm,!0,name):!settings.convert_urls||elm&&"LINK"===elm.nodeName||0===url.indexOf("file:")||0===url.length?url:settings.relative_urls?self.documentBaseURI.toRelative(url):url=self.documentBaseURI.toAbsolute(url,settings.remove_script_host)},Editor.prototype.addVisual=function(elm){var cls,self=this,settings=self.settings,dom=self.dom;elm=elm||self.getBody(),void 0===self.hasVisual&&(self.hasVisual=settings.visual),each$i(dom.select("table,a",elm),function(elm){var value;switch(elm.nodeName){case"TABLE":return cls=settings.visual_table_class||"mce-item-table",value=dom.getAttrib(elm,"border"),void(value&&"0"!==value||!self.hasVisual?dom.removeClass(elm,cls):dom.addClass(elm,cls));case"A":return void(dom.getAttrib(elm,"href")||(value=dom.getAttrib(elm,"name")||elm.id,cls=settings.visual_anchor_class||"mce-item-anchor",value&&self.hasVisual?dom.addClass(elm,cls):dom.removeClass(elm,cls)))}}),self.fire("VisualAid",{element:elm,hasVisual:self.hasVisual})},Editor.prototype.remove=function(){remove$6(this)},Editor.prototype.destroy=function(automatic){destroy(this,automatic)},Editor.prototype.uploadImages=function(callback){return this.editorUpload.uploadImages(callback)},Editor.prototype._scanForImages=function(){return this.editorUpload.scanForImages()},Editor.prototype.addButton=function(){throw new Error("editor.addButton has been removed in tinymce 5x, use editor.ui.registry.addButton or editor.ui.registry.addToggleButton or editor.ui.registry.addSplitButton instead")},Editor.prototype.addSidebar=function(){throw new Error("editor.addSidebar has been removed in tinymce 5x, use editor.ui.registry.addSidebar instead")},Editor.prototype.addMenuItem=function(){throw new Error("editor.addMenuItem has been removed in tinymce 5x, use editor.ui.registry.addMenuItem instead")},Editor.prototype.addContextToolbar=function(){throw new Error("editor.addContextToolbar has been removed in tinymce 5x, use editor.ui.registry.addContextToolbar instead")},Editor}(),DOM$a=DOMUtils$1.DOM,explode$4=Tools.explode,each$j=Tools.each,extend$4=Tools.extend,instanceCounter=0,boundGlobalEvents=!1,legacyEditors=[],editors=[],isValidLegacyKey=function(id){return"length"!==id},globalEventDelegate=function(e){var type=e.type;each$j(EditorManager.get(),function(editor){switch(type){case"scroll":editor.fire("ScrollWindow",e);break;case"resize":editor.fire("ResizeWindow",e)}})},toggleGlobalEvents=function(state){state!==boundGlobalEvents&&(state?DomQuery(window).on("resize scroll",globalEventDelegate):DomQuery(window).off("resize scroll",globalEventDelegate),boundGlobalEvents=state)},removeEditorFromList=function(targetEditor){var oldEditors=editors;delete legacyEditors[targetEditor.id];for(var i=0;i<legacyEditors.length;i++)if(legacyEditors[i]===targetEditor){legacyEditors.splice(i,1);break}return editors=filter(editors,function(editor){return targetEditor!==editor}),EditorManager.activeEditor===targetEditor&&(EditorManager.activeEditor=editors.length>0?editors[0]:null),EditorManager.focusedEditor===targetEditor&&(EditorManager.focusedEditor=null),oldEditors.length!==editors.length},purgeDestroyedEditor=function(editor){return editor&&editor.initialized&&!(editor.getContainer()||editor.getBody()).parentNode&&(removeEditorFromList(editor),editor.unbindAllNativeEvents(),editor.destroy(!0),editor.removed=!0,editor=null),editor},isQuirksMode="CSS1Compat"!==domGlobals.document.compatMode,EditorManager=__assign(__assign({},Observable),{baseURI:null,baseURL:null,defaultSettings:{},documentBaseURL:null,suffix:null,$:DomQuery,majorVersion:"5",minorVersion:"2.0",releaseDate:"2020-02-13",editors:legacyEditors,i18n:I18n,activeEditor:null,focusedEditor:null,settings:{},setup:function(){var baseURL,documentBaseURL,self=this,suffix="";documentBaseURL=URI.getDocumentBaseUrl(domGlobals.document.location),/^[^:]+:\/\/\/?[^\/]+\//.test(documentBaseURL)&&(documentBaseURL=documentBaseURL.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(documentBaseURL)||(documentBaseURL+="/"));var preInit=window.tinymce||window.tinyMCEPreInit;if(preInit)baseURL=preInit.base||preInit.baseURL,suffix=preInit.suffix;else{for(var scripts=domGlobals.document.getElementsByTagName("script"),i=0;i<scripts.length;i++){var src=scripts[i].src||"";if(""!==src){var srcScript=src.substring(src.lastIndexOf("/"));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(src)){-1!==srcScript.indexOf(".min")&&(suffix=".min"),baseURL=src.substring(0,src.lastIndexOf("/"));break}}}if(!baseURL&&domGlobals.document.currentScript){var src=domGlobals.document.currentScript.src;-1!==src.indexOf(".min")&&(suffix=".min"),baseURL=src.substring(0,src.lastIndexOf("/"))}}self.baseURL=new URI(documentBaseURL).toAbsolute(baseURL),self.documentBaseURL=documentBaseURL,self.baseURI=new URI(self.baseURL),self.suffix=suffix,FocusController.setup(self)},overrideDefaults:function(defaultSettings){var baseUrl,suffix;baseUrl=defaultSettings.base_url,baseUrl&&this._setBaseUrl(baseUrl),suffix=defaultSettings.suffix,defaultSettings.suffix&&(this.suffix=suffix),this.defaultSettings=defaultSettings;var pluginBaseUrls=defaultSettings.plugin_base_urls;for(var name_1 in pluginBaseUrls)AddOnManager$1.PluginManager.urls[name_1]=pluginBaseUrls[name_1]},init:function(settings){var result,invalidInlineTargets,self=this;invalidInlineTargets=Tools.makeMap("area base basefont br col frame hr img input isindex link meta param embed source wbr track colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu"," ");var isInvalidInlineTarget=function(settings,elm){return settings.inline&&elm.tagName.toLowerCase()in invalidInlineTargets},createId=function(elm){var id=elm.id;return id||(id=elm.name,id=id&&!DOM$a.get(id)?elm.name:DOM$a.uniqueId(),elm.setAttribute("id",id)),id},execCallback=function(name){var callback=settings[name];if(callback)return callback.apply(self,Array.prototype.slice.call(arguments,2))},hasClass=function(elm,className){return className.constructor===RegExp?className.test(elm.className):DOM$a.hasClass(elm,className)},findTargets=function(settings){var l,targets=[];if(Env.browser.isIE()&&Env.browser.version.major<11)return ErrorReporter.initError("TinyMCE does not support the browser you are using. For a list of supported browsers please see: https://www.tinymce.com/docs/get-started/system-requirements/"),[];if(isQuirksMode)return ErrorReporter.initError("Failed to initialize the editor as the document is not in standards mode. TinyMCE requires standards mode."),[];if(settings.types)return each$j(settings.types,function(type){targets=targets.concat(DOM$a.select(type.selector))}),targets;if(settings.selector)return DOM$a.select(settings.selector);if(settings.target)return[settings.target];switch(settings.mode){case"exact":l=settings.elements||"",l.length>0&&each$j(explode$4(l),function(id){var elm;(elm=DOM$a.get(id))?targets.push(elm):each$j(domGlobals.document.forms,function(f){each$j(f.elements,function(e){e.name===id&&(id="mce_editor_"+instanceCounter++,DOM$a.setAttrib(e,"id",id),targets.push(e))})})});break;case"textareas":case"specific_textareas":each$j(DOM$a.select("textarea"),function(elm){settings.editor_deselector&&hasClass(elm,settings.editor_deselector)||settings.editor_selector&&!hasClass(elm,settings.editor_selector)||targets.push(elm)})}return targets},provideResults=function(editors){result=editors},initEditors=function(){var targets,initCount=0,editors=[],createEditor=function(id,settings,targetElm){var editor=new Editor(id,settings,self);editors.push(editor),editor.on("init",function(){++initCount===targets.length&&provideResults(editors)}),editor.targetElm=editor.targetElm||targetElm,editor.render()};if(DOM$a.unbind(window,"ready",initEditors),execCallback("onpageload"),targets=DomQuery.unique(findTargets(settings)),settings.types)return void each$j(settings.types,function(type){Tools.each(targets,function(elm){return!DOM$a.is(elm,type.selector)||(createEditor(createId(elm),extend$4({},settings,type),elm),!1)})});Tools.each(targets,function(elm){purgeDestroyedEditor(self.get(elm.id))}),targets=Tools.grep(targets,function(elm){return!self.get(elm.id)}),0===targets.length?provideResults([]):each$j(targets,function(elm){isInvalidInlineTarget(settings,elm)?ErrorReporter.initError("Could not initialize inline editor on invalid inline target element",elm):createEditor(createId(elm),settings,elm)})};return self.settings=settings,DOM$a.bind(window,"ready",initEditors),new promiseObj(function(resolve){result?resolve(result):provideResults=function(editors){resolve(editors)}})},get:function(id){return 0===arguments.length?editors.slice(0):isString(id)?find(editors,function(editor){return editor.id===id}).getOr(null):isNumber(id)&&editors[id]?editors[id]:null},add:function(editor){var self=this;return legacyEditors[editor.id]===editor?editor:(null===self.get(editor.id)&&(isValidLegacyKey(editor.id)&&(legacyEditors[editor.id]=editor),legacyEditors.push(editor),editors.push(editor)),toggleGlobalEvents(!0),self.activeEditor=editor,self.fire("AddEditor",{editor:editor}),beforeUnloadDelegate||(beforeUnloadDelegate=function(e){var event=self.fire("BeforeUnload");if(event.returnValue)return e.preventDefault(),e.returnValue=event.returnValue,event.returnValue},window.addEventListener("beforeunload",beforeUnloadDelegate)),editor)},createEditor:function(id,settings){return this.add(new Editor(id,settings,this))},remove:function(selector){var i,editor,self=this;if(selector)return isString(selector)?void each$j(DOM$a.select(selector),function(elm){(editor=self.get(elm.id))&&self.remove(editor)}):(editor=selector,isNull(self.get(editor.id))?null:(removeEditorFromList(editor)&&self.fire("RemoveEditor",{editor:editor}),0===editors.length&&window.removeEventListener("beforeunload",beforeUnloadDelegate),editor.remove(),toggleGlobalEvents(editors.length>0),editor));for(i=editors.length-1;i>=0;i--)self.remove(editors[i])},execCommand:function(cmd,ui,value){var self=this,editor=self.get(value);switch(cmd){case"mceAddEditor":return self.get(value)||new Editor(value,self.settings,self).render(),!0;case"mceRemoveEditor":return editor&&editor.remove(),!0;case"mceToggleEditor":return editor?(editor.isHidden()?editor.show():editor.hide(),!0):(self.execCommand("mceAddEditor",0,value),!0)}return!!self.activeEditor&&self.activeEditor.execCommand(cmd,ui,value)},triggerSave:function(){each$j(editors,function(editor){editor.save()})},addI18n:function(code,items){I18n.add(code,items)},translate:function(text){return I18n.translate(text)},setActive:function(editor){var activeEditor=this.activeEditor;this.activeEditor!==editor&&(activeEditor&&activeEditor.fire("deactivate",{relatedTarget:editor}),editor.fire("activate",{relatedTarget:activeEditor})),this.activeEditor=editor},_setBaseUrl:function(baseUrl){this.baseURL=new URI(this.documentBaseURL).toAbsolute(baseUrl.replace(/\/+$/,"")),this.baseURI=new URI(this.baseURL)}});EditorManager.setup(),function(RangeUtils){RangeUtils.compareRanges=RangeCompare.isEq,RangeUtils.getCaretRangeFromPoint=CaretRangeFromPoint.fromPoint,RangeUtils.getSelectedNode=getSelectedNode,RangeUtils.getNode=getNode}(RangeUtils||(RangeUtils={}));var extendClass,initializing,RangeUtils$1=RangeUtils,awaiter=function(resolveCb,rejectCb,timeout){void 0===timeout&&(timeout=1e3);var done=!1,timer=null,complete=function(completer){return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];done||(done=!0,null!==timer&&(domGlobals.clearTimeout(timer),timer=null),completer.apply(null,args))}},resolve=complete(resolveCb),reject=complete(rejectCb);return{start:function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];done||null!==timer||(timer=domGlobals.setTimeout(function(){return reject.apply(null,args)},timeout))},resolve:resolve,reject:reject}},Resource=function(){var tasks={},resultFns={};return{load:function(id,url){var loadErrMsg='Script at URL "'+url+'" failed to load',runErrMsg='Script at URL "'+url+"\" did not call `tinymce.Resource.add('"+id+"', data)` within 1 second";if(void 0!==tasks[id])return tasks[id];var task=new promiseObj(function(resolve,reject){var waiter=awaiter(resolve,reject);resultFns[id]=waiter.resolve,ScriptLoader.ScriptLoader.loadScript(url,function(){return waiter.start(runErrMsg)},function(){return waiter.reject(loadErrMsg)})});return tasks[id]=task,task},add:function(id,data){void 0!==resultFns[id]&&(resultFns[id](data),delete resultFns[id]),tasks[id]=promiseObj.resolve(data)}}}(),min=Math.min,max=Math.max,round$2=Math.round,relativePosition=function(rect,targetRect,rel){var x,y,w,h,targetW,targetH;return x=targetRect.x,y=targetRect.y,w=rect.w,h=rect.h,targetW=targetRect.w,targetH=targetRect.h,rel=(rel||"").split(""),"b"===rel[0]&&(y+=targetH),"r"===rel[1]&&(x+=targetW),"c"===rel[0]&&(y+=round$2(targetH/2)),"c"===rel[1]&&(x+=round$2(targetW/2)),"b"===rel[3]&&(y-=h),"r"===rel[4]&&(x-=w),"c"===rel[3]&&(y-=round$2(h/2)),"c"===rel[4]&&(x-=round$2(w/2)),create$7(x,y,w,h)},findBestRelativePosition=function(rect,targetRect,constrainRect,rels){var pos,i;for(i=0;i<rels.length;i++)if(pos=relativePosition(rect,targetRect,rels[i]),pos.x>=constrainRect.x&&pos.x+pos.w<=constrainRect.w+constrainRect.x&&pos.y>=constrainRect.y&&pos.y+pos.h<=constrainRect.h+constrainRect.y)return rels[i];return null},inflate=function(rect,w,h){return create$7(rect.x-w,rect.y-h,rect.w+2*w,rect.h+2*h)},intersect=function(rect,cropRect){var x1,y1,x2,y2;return x1=max(rect.x,cropRect.x),y1=max(rect.y,cropRect.y),x2=min(rect.x+rect.w,cropRect.x+cropRect.w),y2=min(rect.y+rect.h,cropRect.y+cropRect.h),x2-x1<0||y2-y1<0?null:create$7(x1,y1,x2-x1,y2-y1)},clamp$1=function(rect,clampRect,fixedSize){var underflowX1,underflowY1,overflowX2,overflowY2,x1,y1,x2,y2,cx2,cy2;return x1=rect.x,y1=rect.y,x2=rect.x+rect.w,y2=rect.y+rect.h,cx2=clampRect.x+clampRect.w,cy2=clampRect.y+clampRect.h,underflowX1=max(0,clampRect.x-x1),underflowY1=max(0,clampRect.y-y1),overflowX2=max(0,x2-cx2),overflowY2=max(0,y2-cy2),x1+=underflowX1,y1+=underflowY1,fixedSize&&(x2+=underflowX1,y2+=underflowY1,x1-=overflowX2,y1-=overflowY2),x2-=overflowX2,y2-=overflowY2,create$7(x1,y1,x2-x1,y2-y1)},create$7=function(x,y,w,h){return{x:x,y:y,w:w,h:h}},fromClientRect=function(clientRect){return create$7(clientRect.left,clientRect.top,clientRect.width,clientRect.height)},Rect={inflate:inflate,relativePosition:relativePosition,findBestRelativePosition:findBestRelativePosition,intersect:intersect,clamp:clamp$1,create:create$7,fromClientRect:fromClientRect},each$k=Tools.each,extend$5=Tools.extend,Class=function(){};Class.extend=extendClass=function(prop){var prototype,name,member,self=this,_super=self.prototype,Class=function(){var i,mixins,mixin,self=this;if(!initializing&&(self.init&&self.init.apply(self,arguments),mixins=self.Mixins))for(i=mixins.length;i--;)mixin=mixins[i],mixin.init&&mixin.init.apply(self,arguments)},dummy=function(){return this};initializing=!0,prototype=new self,initializing=!1,prop.Mixins&&(each$k(prop.Mixins,function(mixin){for(var name_1 in mixin)"init"!==name_1&&(prop[name_1]=mixin[name_1])}),_super.Mixins&&(prop.Mixins=_super.Mixins.concat(prop.Mixins))),prop.Methods&&each$k(prop.Methods.split(","),function(name){prop[name]=dummy}),prop.Properties&&each$k(prop.Properties.split(","),function(name){var fieldName="_"+name;prop[name]=function(value){var self=this;return void 0!==value?(self[fieldName]=value,self):self[fieldName]}}),prop.Statics&&each$k(prop.Statics,function(func,name){Class[name]=func}),prop.Defaults&&_super.Defaults&&(prop.Defaults=extend$5({},_super.Defaults,prop.Defaults));for(name in prop)member=prop[name],"function"==typeof member&&_super[name]?prototype[name]=function(name,fn){return function(){var ret,self=this,tmp=self._super;return self._super=_super[name],ret=fn.apply(self,arguments),self._super=tmp,ret}}(name,member):prototype[name]=member;return Class.prototype=prototype,Class.constructor=Class,Class.extend=extendClass,Class};var localStorage,min$1=Math.min,max$1=Math.max,round$3=Math.round,Color=function(value){var self={},r=0,g=0,b=0,rgb2hsv=function(r,g,b){var h,s,v,d,minRGB,maxRGB;return h=0,s=0,v=0,r/=255,g/=255,b/=255,minRGB=min$1(r,min$1(g,b)),maxRGB=max$1(r,max$1(g,b)),minRGB===maxRGB?(v=minRGB,{h:0,s:0,v:100*v}):(d=r===minRGB?g-b:b===minRGB?r-g:b-r,h=r===minRGB?3:b===minRGB?1:5,h=60*(h-d/(maxRGB-minRGB)),s=(maxRGB-minRGB)/maxRGB,v=maxRGB,{h:round$3(h),s:round$3(100*s),v:round$3(100*v)})},hsvToRgb=function(hue,saturation,brightness){var side,chroma,x,match;if(hue=(parseInt(hue,10)||0)%360,saturation=parseInt(saturation,10)/100,brightness=parseInt(brightness,10)/100,saturation=max$1(0,min$1(saturation,1)),brightness=max$1(0,min$1(brightness,1)),0===saturation)return void(r=g=b=round$3(255*brightness));switch(side=hue/60,chroma=brightness*saturation,x=chroma*(1-Math.abs(side%2-1)),match=brightness-chroma,Math.floor(side)){case 0:r=chroma,g=x,b=0;break;case 1:r=x,g=chroma,b=0;break;case 2:r=0,g=chroma,b=x;break;case 3:r=0,g=x,b=chroma;break;case 4:r=x,g=0,b=chroma;break;case 5:r=chroma,g=0,b=x;break;default:r=g=b=0}r=round$3(255*(r+match)),g=round$3(255*(g+match)),b=round$3(255*(b+match))},toHex=function(){var hex=function(val){return val=parseInt(val,10).toString(16),val.length>1?val:"0"+val};return"#"+hex(r)+hex(g)+hex(b)},toRgb=function(){return{r:r,g:g,b:b}},toHsv=function(){return rgb2hsv(r,g,b)},parse=function(value){var matches;return"object"==typeof value?"r"in value?(r=value.r,g=value.g,b=value.b):"v"in value&&hsvToRgb(value.h,value.s,value.v):(matches=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)[^\)]*\)/gi.exec(value))?(r=parseInt(matches[1],10),g=parseInt(matches[2],10),b=parseInt(matches[3],10)):(matches=/#([0-F]{2})([0-F]{2})([0-F]{2})/gi.exec(value))?(r=parseInt(matches[1],16),g=parseInt(matches[2],16),b=parseInt(matches[3],16)):(matches=/#([0-F])([0-F])([0-F])/gi.exec(value))&&(r=parseInt(matches[1]+matches[1],16),g=parseInt(matches[2]+matches[2],16),b=parseInt(matches[3]+matches[3],16)),r=r<0?0:r>255?255:r,g=g<0?0:g>255?255:g,b=b<0?0:b>255?255:b,self};return value&&parse(value),self.toRgb=toRgb,self.toHsv=toHsv,self.toHex=toHex,self.parse=parse,self},serialize=function(obj){var data=JSON.stringify(obj);return isString(data)?data.replace(/[\u0080-\uFFFF]/g,function(match){var hexCode=match.charCodeAt(0).toString(16);return"\\u"+"0000".substring(hexCode.length)+hexCode}):data},JSONUtils={serialize:serialize,parse:function(text){try{return JSON.parse(text)}catch(ex){}}},JSONP={callbacks:{},count:0,send:function(settings){var self=this,dom=DOMUtils$1.DOM,count=void 0!==settings.count?settings.count:self.count,id="tinymce_jsonp_"+count;self.callbacks[count]=function(json){dom.remove(id),delete self.callbacks[count],settings.callback(json)},dom.add(dom.doc.body,"script",{id:id,src:settings.url,type:"text/javascript"}),self.count++}},XHR=__assign(__assign({},Observable),{send:function(settings){var xhr,count=0,ready=function(){!settings.async||4===xhr.readyState||count++>1e4?(settings.success&&count<1e4&&200===xhr.status?settings.success.call(settings.success_scope,""+xhr.responseText,xhr,settings):settings.error&&settings.error.call(settings.error_scope,count>1e4?"TIMED_OUT":"GENERAL",xhr,settings),xhr=null):Delay.setTimeout(ready,10)};if(settings.scope=settings.scope||this,settings.success_scope=settings.success_scope||settings.scope,settings.error_scope=settings.error_scope||settings.scope,settings.async=!1!==settings.async,settings.data=settings.data||"",XHR.fire("beforeInitialize",{settings:settings}),xhr=new domGlobals.XMLHttpRequest){if(xhr.overrideMimeType&&xhr.overrideMimeType(settings.content_type),xhr.open(settings.type||(settings.data?"POST":"GET"),settings.url,settings.async),settings.crossDomain&&(xhr.withCredentials=!0),settings.content_type&&xhr.setRequestHeader("Content-Type",settings.content_type),settings.requestheaders&&Tools.each(settings.requestheaders,function(header){xhr.setRequestHeader(header.key,header.value)}),xhr.setRequestHeader("X-Requested-With","XMLHttpRequest"),xhr=XHR.fire("beforeSend",{xhr:xhr,settings:settings}).xhr,xhr.send(settings.data),!settings.async)return ready();Delay.setTimeout(ready,10)}}}),extend$6=Tools.extend,JSONRequest=function(){function JSONRequest(settings){this.settings=extend$6({},settings),this.count=0}return JSONRequest.sendRPC=function(o){return(new JSONRequest).send(o)},JSONRequest.prototype.send=function(args){var ecb=args.error,scb=args.success,xhrArgs=extend$6(this.settings,args);xhrArgs.success=function(c,x){c=JSONUtils.parse(c),void 0===c&&(c={error:"JSON Parse error."}),c.error?ecb.call(xhrArgs.error_scope||xhrArgs.scope,c.error,x):scb.call(xhrArgs.success_scope||xhrArgs.scope,c.result)},xhrArgs.error=function(ty,x){ecb&&ecb.call(xhrArgs.error_scope||xhrArgs.scope,ty,x)},xhrArgs.data=JSONUtils.serialize({id:args.id||"c"+this.count++,method:args.method,params:args.params}),xhrArgs.content_type="application/json",XHR.send(xhrArgs)},JSONRequest}();try{localStorage=domGlobals.window.localStorage}catch(e){localStorage=function(){return function(){var data={},keys=[],storage={getItem:function(key){var item=data[key];return item||null},setItem:function(key,value){keys.push(key),data[key]=String(value)},key:function(index){return keys[index]},removeItem:function(key){keys=keys.filter(function(k){return k===key}),delete data[key]},clear:function(){keys=[],data={}},length:0};return Object.defineProperty(storage,"length",{get:function(){return keys.length},configurable:!1,enumerable:!1}),storage}()}()}var LocalStorage=localStorage,publicApi={geom:{Rect:Rect},util:{Promise:promiseObj,Delay:Delay,Tools:Tools,VK:VK,URI:URI,Class:Class,EventDispatcher:EventDispatcher,Observable:Observable,I18n:I18n,XHR:XHR,JSON:JSONUtils,JSONRequest:JSONRequest,JSONP:JSONP,LocalStorage:LocalStorage,Color:Color},dom:{EventUtils:EventUtils,Sizzle:Sizzle,DomQuery:DomQuery,TreeWalker:TreeWalker,TextSeeker:TextSeeker,DOMUtils:DOMUtils$1,ScriptLoader:ScriptLoader,RangeUtils:RangeUtils$1,Serializer:Serializer$1,ControlSelection:ControlSelection,BookmarkManager:BookmarkManager$1,Selection:Selection$1,Event:EventUtils.Event},html:{Styles:Styles,Entities:Entities,Node:Node$1,Schema:Schema,SaxParser:SaxParser$1,DomParser:DomParser,Writer:Writer,Serializer:Serializer},Env:Env,AddOnManager:AddOnManager$1,Annotator:Annotator,Formatter:Formatter,UndoManager:UndoManager,EditorCommands:EditorCommands,WindowManager:WindowManager,NotificationManager:NotificationManager,EditorObservable:EditorObservable,Shortcuts:Shortcuts,Editor:Editor,FocusManager:FocusManager,EditorManager:EditorManager,DOM:DOMUtils$1.DOM,ScriptLoader:ScriptLoader.ScriptLoader,PluginManager:AddOnManager$1.PluginManager,ThemeManager:AddOnManager$1.ThemeManager,IconManager:IconManager,Resource:Resource,trim:Tools.trim,isArray:Tools.isArray,is:Tools.is,toArray:Tools.toArray,makeMap:Tools.makeMap,each:Tools.each,map:Tools.map,grep:Tools.grep,inArray:Tools.inArray,extend:Tools.extend,create:Tools.create,walk:Tools.walk,createNS:Tools.createNS,resolve:Tools.resolve,explode:Tools.explode,_addCacheSuffix:Tools._addCacheSuffix,isOpera:Env.opera,isWebKit:Env.webkit,isIE:Env.ie,isGecko:Env.gecko,isMac:Env.mac},tinymce=Tools.extend(EditorManager,publicApi);!function(tinymce){window.tinymce=tinymce,window.tinyMCE=tinymce}(tinymce),function(tinymce){try{module.exports=tinymce}catch(_){}}(tinymce)}(window)}).call(exports,__webpack_require__(95))},7:function(module,exports,__webpack_require__){!function(globals){"use strict";function sha256(message,options){message.constructor===String&&(message=_imports.convertString.UTF8.stringToBytes(message));var H=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],m=bytesToWords(message),l=8*message.length;m[l>>5]|=128<<24-l%32,m[15+(l+64>>9<<4)]=l;for(var i=0;i<m.length;i+=16)processBlock(H,m,i);var digestbytes=wordsToBytes(H);return options&&options.asBytes?digestbytes:options&&options.asString?_imports.convertString.bytesToString(digestbytes):_imports.bytesToHex(digestbytes)}var _imports={};void 0!==module&&module.exports?(_imports.bytesToHex=__webpack_require__(98).bytesToHex,_imports.convertString=__webpack_require__(99),module.exports=sha256):(_imports.bytesToHex=globals.convertHex.bytesToHex,_imports.convertString=globals.convertString,globals.sha256=sha256);var K=[];!function(){for(var n=2,nPrime=0;nPrime<64;)(function(n){for(var sqrtN=Math.sqrt(n),factor=2;factor<=sqrtN;factor++)if(!(n%factor))return!1;return!0})(n)&&(K[nPrime]=function(n){return 4294967296*(n-(0|n))|0}(Math.pow(n,1/3)),nPrime++),n++}();var bytesToWords=function(bytes){for(var words=[],i=0,b=0;i<bytes.length;i++,b+=8)words[b>>>5]|=bytes[i]<<24-b%32;return words},wordsToBytes=function(words){for(var bytes=[],b=0;b<32*words.length;b+=8)bytes.push(words[b>>>5]>>>24-b%32&255);return bytes},W=[],processBlock=function(H,M,offset){for(var a=H[0],b=H[1],c=H[2],d=H[3],e=H[4],f=H[5],g=H[6],h=H[7],i=0;i<64;i++){if(i<16)W[i]=0|M[offset+i];else{var gamma0x=W[i-15],gamma0=(gamma0x<<25|gamma0x>>>7)^(gamma0x<<14|gamma0x>>>18)^gamma0x>>>3,gamma1x=W[i-2],gamma1=(gamma1x<<15|gamma1x>>>17)^(gamma1x<<13|gamma1x>>>19)^gamma1x>>>10;W[i]=gamma0+W[i-7]+gamma1+W[i-16]}var ch=e&f^~e&g,maj=a&b^a&c^b&c,sigma0=(a<<30|a>>>2)^(a<<19|a>>>13)^(a<<10|a>>>22),sigma1=(e<<26|e>>>6)^(e<<21|e>>>11)^(e<<7|e>>>25),t1=h+sigma1+ch+K[i]+W[i],t2=sigma0+maj;h=g,g=f,f=e,e=d+t1|0,d=c,c=b,b=a,a=t1+t2|0}H[0]=H[0]+a|0,H[1]=H[1]+b|0,H[2]=H[2]+c|0,H[3]=H[3]+d|0,H[4]=H[4]+e|0,H[5]=H[5]+f|0,H[6]=H[6]+g|0,H[7]=H[7]+h|0};sha256.x2=function(message,options){return sha256(sha256(message,{asBytes:!0}),options)}}(this)},98:function(module,exports){!function(globals){"use strict";function arrBytesToHex(bytes){return bytes.map(function(x){return padLeft(x.toString(16),2)}).join("")}function padLeft(orig,len){return orig.length>len?orig:Array(len-orig.length+1).join("0")+orig}var convertHex={bytesToHex:function(bytes){return arrBytesToHex(bytes)},hexToBytes:function(hex){if(hex.length%2==1)throw new Error("hexToBytes can't have a string with an odd number of characters.");return 0===hex.indexOf("0x")&&(hex=hex.slice(2)),hex.match(/../g).map(function(x){return parseInt(x,16)})}};void 0!==module&&module.exports?module.exports=convertHex:globals.convertHex=convertHex}(this)},99:function(module,exports){!function(globals){"use strict";var convertString={bytesToString:function(bytes){return bytes.map(function(x){return String.fromCharCode(x)}).join("")},stringToBytes:function(str){return str.split("").map(function(x){return x.charCodeAt(0)})}};convertString.UTF8={bytesToString:function(bytes){return decodeURIComponent(escape(convertString.bytesToString(bytes)))},stringToBytes:function(str){return convertString.stringToBytes(unescape(encodeURIComponent(str)))}},void 0!==module&&module.exports?module.exports=convertString:globals.convertString=convertString}(this)}});
//# sourceMappingURL=vendor.b548d56514f7d4ba28de.js.map