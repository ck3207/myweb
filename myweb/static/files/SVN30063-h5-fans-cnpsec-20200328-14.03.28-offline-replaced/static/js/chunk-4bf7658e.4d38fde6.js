(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4bf7658e"],{"097d":function(e,t,r){var i=r("5ca1"),a=r("8378"),n=r("7726"),c=r("ebd6"),o=r("bcaa");i(i.P+i.R,"Promise",{finally:function(e){var t=c(this,a.Promise||n.Promise),r="function"==typeof e;return this.then(r?function(r){return o(t,e()).then((function(){return r}))}:e,r?function(r){return o(t,e()).then((function(){throw r}))}:e)}})},"5de6":function(e,t,r){},"634a":function(e,t,r){r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"page page-product-subscription"},[r("div",{staticClass:"page-content"},[r("header",{staticClass:"product-info"},[e._m(0),r("span",{staticClass:"order-title"},[e._v(e._s(e.orderTitle))])]),"2"===e.productType?r("div",{staticClass:"card-subscription viability-info"},[e._m(1),r("div",{staticClass:"content"},[999999999!==+e.combinePrice.farePerMonth?r("div",{staticClass:"viability-box",class:{active:"1"===e.viability},on:{click:function(t){e.viability="1"}}},[r("p",[e._v("1个月")]),r("p",{staticClass:"price"},[r("b",[e._v("￥")]),e._v(e._s(e.combinePrice.farePerMonth))])]):e._e(),999999999!==+e.combinePrice.farePerQuarter?r("div",{staticClass:"viability-box",class:{active:"3"===e.viability},on:{click:function(t){e.viability="3"}}},[r("p",[e._v("3个月")]),r("p",{staticClass:"price"},[r("b",[e._v("￥")]),e._v(e._s(e.combinePrice.farePerQuarter))])]):e._e(),999999999!==+e.combinePrice.farePerHalfyear?r("div",{staticClass:"viability-box",class:{active:"6"===e.viability},on:{click:function(t){e.viability="6"}}},[r("p",[e._v("6个月")]),r("p",{staticClass:"price"},[r("b",[e._v("￥")]),e._v(e._s(e.combinePrice.farePerHalfyear))])]):e._e(),999999999!==+e.combinePrice.farePerYear?r("div",{staticClass:"viability-box",class:{active:"12"===e.viability},on:{click:function(t){e.viability="12"}}},[r("p",[e._v("12个月")]),r("p",{staticClass:"price"},[r("b",[e._v("￥")]),e._v(e._s(e.combinePrice.farePerYear))])]):e._e()]),r("div",{staticClass:"tips"},[e._v("\n        服务方式：APP站内消息推送\n      ")])]):e._e(),"3"===e.productType?r("div",{staticClass:"card-subscription viability-info"},[e._m(2),r("div",{staticClass:"content"},[r("van-row",{staticStyle:{width:"100%"}},[r("van-col",{attrs:{span:"12"}},[r("div",{staticClass:"viability-box active"},[r("p",[e._v("长期有效")]),r("p",{staticClass:"price"},[r("b",[e._v("￥")]),e._v(e._s(e.orderPrice))])])])],1)],1)]):e._e(),r("div",{staticClass:"card-subscription pay-type"},[e._m(3),r("div",{staticClass:"content"},[r("van-radio-group",{model:{value:e.payWay,callback:function(t){e.payWay=t},expression:"payWay"}},[r("van-cell-group",[r("van-cell",{attrs:{clickable:"",title:"保证金"},on:{click:function(t){e.payWay="3"}}},[r("template",{slot:"icon"},[r("i",{staticClass:"iconfont-cnpsec iconfont-keep-money"})]),r("van-radio",{attrs:{slot:"right-icon",name:"3"},slot:"right-icon"})],2),r("van-cell",{attrs:{clickable:"",title:"支付宝"},on:{click:function(t){e.payWay="1"}}},[r("template",{slot:"icon"},[r("i",{staticClass:"iconfont-cnpsec iconfont-alipay"})]),r("van-radio",{attrs:{slot:"right-icon",name:"1"},slot:"right-icon"})],2),r("van-cell",{attrs:{clickable:"",title:"微信"},on:{click:function(t){e.payWay="2"}}},[r("template",{slot:"icon"},[r("i",{staticClass:"iconfont-cnpsec iconfont-weixin-pay"})]),r("van-radio",{attrs:{slot:"right-icon",name:"2"},slot:"right-icon"})],2)],1)],1)],1)])]),r("van-submit-bar",{staticClass:"submit-bar submitable",attrs:{price:100*e.submitPrice,label:e.submitLabel,"button-text":"支付"},on:{submit:e.onSubmit}}),r("van-dialog",{attrs:{className:"pay-dialog",title:1===e.payResultState?"支付成！":"支付失败！","confirm-button-text":e.confirmButtonText,"show-cancel-button":""},on:{confirm:e.handleConfirm},model:{value:e.payResultShow,callback:function(t){e.payResultShow=t},expression:"payResultShow"}},[r("div",{staticClass:"pay-result"},[r("i",{staticClass:"iconfont-cnpsec",class:{"iconfont-success":1===e.payResultState,"iconfont-fail":0===e.payResultState}})])])],1)},a=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("span",{staticClass:"info"},[r("i",{staticClass:"iconfont-cnpsec iconfont-product-info"}),e._v("商品信息")])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"header"},[r("span",[e._v("服务期限")])])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"header"},[r("span",[e._v("服务期限")])])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"header"},[r("span",[e._v("支付方式")])])}],n=(r("8e6e"),r("ac6a"),r("cadf"),r("456d"),r("e17f"),r("2241")),c=(r("097d"),r("bd86")),o=(r("96cf"),r("3b8d")),s=(r("7f7f"),r("c5f6"),r("d225")),u=r("b0b4"),l=r("308d"),p=r("6bb5"),f=r("4e2b"),v=r("9ab4"),d=r("60a3"),h=r("4bb5"),b=r("b3af"),y=r("8935");function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){Object(c["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var _=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(l["a"])(this,Object(p["a"])(t).apply(this,arguments)),e.productType="1",e.signatureId="",e.relationId="",e.orderTitle="",e.brokerId="",e.orderPrice="",e.combinePrice={},e.viewpointPkgPrice={},e.payWay="4",e.viability="1",e.confirmButtonText="确定",e.matchResult="",e.prodRiskLevel="",e.payResultShow=!1,e.payResultState=0,e}return Object(f["a"])(t,e),Object(u["a"])(t,[{key:"onServicePriceInit",value:function(){var e=[{type:"1",price:this.servicePrice.farePerMonth},{type:"3",price:this.servicePrice.farePerQuarter},{type:"6",price:this.servicePrice.farePerHalfyear},{type:"12",price:this.servicePrice.farePerYear}];this.viability=e.filter((function(e){return 999999999!==Number(e.price)}))[0].type}},{key:"beforeRouteEnter",value:function(e,t,r){r((function(e){if("protocolServer"!==t.name||"protocolRisk"!==t.name){var r=e.$route.query;e.productType=r.productType,e.prodRiskLevel=r.prodRiskLevel,e.matchResult=r.matchResult,e.getOrderInfoFromStorage()}}))}},{key:"beforeRouteLeave",value:function(e,t,r){"protocolServer"!==e.name&&"protocolRisk"!==e.name&&this.resetData(),r()}},{key:"resetData",value:function(){this.productType="1",this.signatureId="",this.relationId="",this.orderTitle="",this.brokerId="",this.orderPrice="",this.combinePrice={farePerMonth:null,farePerQuarter:null,farePerHalfyear:null,farePerYear:null},this.viewpointPkgPrice={farePerMonth:null,farePerQuarter:null,farePerHalfyear:null,farePerYear:null},this.payWay="4",this.viability="1"}},{key:"getOrderInfoFromStorage",value:function(){"1"===this.productType&&this.getViewOrderInfo(),"2"===this.productType&&this.getCombineOrderInfo()}},{key:"getCombineOrderInfo",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(y["a"])("".concat(b["i"],"_combineOrderInfo"));case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0={};case 5:t=e.t0,this.relationId=t.combiCode||"",this.orderTitle=t.combiName||"",this.brokerId=t.brokerId||"",this.combinePrice={farePerHalfyear:t.farePerHalfyear||0,farePerMonth:t.farePerMonth||0,farePerQuarter:t.farePerQuarter||0,farePerYear:t.farePerYear||0};case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getViewOrderInfo",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(y["a"])("".concat(b["i"],"_viewOrderInfo"));case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0={};case 5:t=e.t0,this.relationId=t.viewId||"",this.orderTitle=t.viewTitle||"",this.orderPrice=t.viewPrice||0,this.brokerId=t.brokerId||"";case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"setSignature",value:function(){var e={tenant_id:this.userInfo.tenant_id,product_type:this.productType,product_id:this.relationId,product_name:this.orderTitle};return e="3"===this.productType?P({},e,{},{agreement_type:"2,3"}):P({},e,{},{agreement_type:"".concat("1"===this.matchResult?"1":"5",",2,3"),busin_account:this.userInfo.fund_account,customer_risk_level:this.riskLevelDec,product_risk_level:this.productRiskLevelDec,match_result:this.matchResult}),this.$services.setSignature({data:e}).then((function(e){return e.signature_id})).catch((function(e){throw console.log("setSignature error: ",e),e}))}},{key:"onSubmit",value:function(){var e=this;if("1"===this.productType&&this.setSignature().then((function(t){e.orderAdd("2",t)})),"2"===this.productType){var t={1:"4",3:"5",6:"6",12:"7"};this.setSignature().then((function(r){e.orderAdd(t[e.viability],r)}))}}},{key:"orderAdd",value:function(e,t){var r=this,i={1:"1",2:"0",3:"2",4:"4"};return this.$services.orderAdd({data:{order_type:e,relation_id:this.relationId,signature_id:t,busin_account:this.userInfo.fund_account,order_title:this.orderTitle,order_content:this.orderTitle,third_type:i[this.payWay],broker_id:this.brokerId}}).then((function(e){var t=e;if(0===+t.error_no){if(0===+r.submitPrice)return r.$toast("支付完成"),void r.$router.go(-4);t.order_string?r.payResult(t.order_id):(r.payResultShow=!0,r.payResultState=0)}else 52004===+t.error_no?r.$dialog.confirm({title:"系统提示",message:"存在未支付完成的订单，请继续支付",showCancelButton:!0,cancelButtonColor:"#999",cancelButtonText:"取消",confirmButtonColor:"#E84A4D",confirmButtonText:"去支付"}).then((function(){r.$router.push({path:"orderList",query:{tabType:"0"}})})).catch((function(){})):r.$toast(t.error_info)})).catch((function(e){r.$toast(e)}))}},{key:"payResult",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$services.getPayResult({data:{order_id:""}}).then((function(e){0===+e.order_status?r.payResultState=0:r.payResultState=1})).catch((function(e){r.payResultState=0,console.log("getPayResult error: ",e)})).finally((function(){r.payResultShow=!0}));case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"handleConfirm",value:function(){this.$router.go(-4)}},{key:"servicePrice",get:function(){return"2"===this.productType?this.combinePrice:this.viewpointPkgPrice}},{key:"submitLabel",get:function(){return"2"===this.productType||"4"===this.productType?"共".concat(this.viability,"个月,合计"):""}},{key:"submitPrice",get:function(){if("2"===this.productType||"4"===this.productType){var e={1:this.servicePrice.farePerMonth,3:this.servicePrice.farePerQuarter,6:this.servicePrice.farePerHalfyear,12:this.servicePrice.farePerYear};return e[this.viability]}return+this.orderPrice}},{key:"riskLevelDec",get:function(){return"".concat(this.userInfo.corp_risk_name)}},{key:"productRiskLevelDec",get:function(){var e=Number(this.prodRiskLevel)-1;return"R".concat(this.prodRiskLevel,"级").concat(b["h"][e])}}]),t}(d["c"]);Object(v["a"])([h["a"]],_.prototype,"userInfo",void 0),Object(v["a"])([h["a"]],_.prototype,"payResultOption",void 0),Object(v["a"])([Object(d["d"])("servicePrice")],_.prototype,"onServicePriceInit",null),_=Object(v["a"])([Object(d["a"])({components:Object(c["a"])({},n["a"].Component.name,n["a"].Component)})],_);var g=_,k=g,O=(r("9a56"),r("2877")),w=Object(O["a"])(k,i,a,!1,null,"5cf5ed79",null);t["default"]=w.exports},"8e6e":function(e,t,r){var i=r("5ca1"),a=r("990b"),n=r("6821"),c=r("11e9"),o=r("f1ae");i(i.S,"Object",{getOwnPropertyDescriptors:function(e){var t,r,i=n(e),s=c.f,u=a(i),l={},p=0;while(u.length>p)r=s(i,t=u[p++]),void 0!==r&&o(l,t,r);return l}})},"990b":function(e,t,r){var i=r("9093"),a=r("2621"),n=r("cb7c"),c=r("7726").Reflect;e.exports=c&&c.ownKeys||function(e){var t=i.f(n(e)),r=a.f;return r?t.concat(r(e)):t}},"9a56":function(e,t,r){var i=r("5de6"),a=r.n(i);a.a},f1ae:function(e,t,r){var i=r("86cc"),a=r("4630");e.exports=function(e,t,r){t in e?i.f(e,t,a(0,r)):e[t]=r}}}]);