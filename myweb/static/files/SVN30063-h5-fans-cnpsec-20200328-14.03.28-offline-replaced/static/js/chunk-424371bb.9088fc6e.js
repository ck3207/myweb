(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-424371bb"],{"0b71":function(t,e,i){var a=i("b8ba"),s=i.n(a);s.a},"12e8":function(t,e,i){},1750:function(t,e,i){i("7f7f");var a=i("d257");e["a"]={mounted:function(){var t=this;Object(a["l"])((function(){t.$store.dispatch("getDataFromNative").then((function(e){console.log("唤起壳子登录之后的回调函数执行，返回 mobile",e),e&&"null"!==e&&(t.$store.dispatch("userLogin",{mobile:e}),t.init())}))}))},activated:function(){var t=this.$route.name;"liveList"!==t&&"adviserList"!==t&&this.init()}}},a494:function(t,e,i){i.r(e);var a,s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"page-live-list page-container"},[i("van-pull-refresh",{directives:[{name:"scroll-maintain",rawName:"v-scroll-maintain"}],staticClass:"pull-refresh-box page-content",on:{refresh:t.onRefresh},model:{value:t.isPullRefreshLoading,callback:function(e){t.isPullRefreshLoading=e},expression:"isPullRefreshLoading"}},[i("Search",{staticClass:"live-search",attrs:{historyList:t.historyList,searchFunc:t.searchAdviser,searchResult:t.searchLiveResult},on:{clearHistory:t.handleClearHistory},scopedSlots:t._u([{key:"search-result",fn:function(e){var a=e.resultItem;return[i("div",{staticClass:"search-result-item",on:{click:function(e){return t.liveClick(a)}}},[t._v(t._s(a.topic))])]}}])}),i("LoadMore",{ref:"myLoadMore",attrs:{bottomMethod:t.loadBottom,canInif:t.canInif,isFinal:t.isFinal}},[i("div",{staticClass:"live-box"},t._l(t.liveList,(function(t,e){return i("LiveCard",{key:e,attrs:{liveData:t}})})),1),i("NoData",{directives:[{name:"show",rawName:"v-show",value:t.showNoData,expression:"showNoData"}]}),t.isFinal&&!t.showNoData?i("div",{staticClass:"reach-bottom"},[t._v("已经到底了")]):t._e()],1)],1)],1)},n=[],r=i("bd86"),o=(i("96cf"),i("3b8d")),c=(i("7f7f"),i("f15a")),l=i("9d59"),u=i("a2c9"),h=i("501e"),v=i("1750"),f=i("de0d"),d={components:{LiveCard:c["a"],Search:l["a"],LoadMore:u["a"],NoData:h["a"]},mixins:[v["a"],f["a"]],data:function(){return{pageSize:20,showNoData:!1,isFinal:!1,canInif:!0,positionStr:0,liveList:[],historyList:[],searchLiveResult:[],searchPositionStr:0}},beforeRouteEnter:function(t,e,i){i((function(t){"reviewDetail"!==e.name&&"live"!==e.name&&t.init()}))},activated:function(){this.$forceUpdate()},beforeRouteLeave:function(t,e,i){"reviewDetail"!==t.name&&"live"!==t.name&&this.resetListData(),i()},methods:(a={init:function(){this.initData()},pullRefreshInit:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.positionStr=0,this.getLiveList().then((function(t){if(!t||!t.data_list.length)return e.showNoData=!0,e.isFinal=!0,void(e.canInif=!1);e.liveList=t.data_list,e.buildListData(t.data_list)}));case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),initData:function(){var t=this;this.resetListData(),setTimeout((function(){t.getLiveList().then((function(e){if(!e||!e.data_list.length)return t.showNoData=!0,t.isFinal=!0,void(t.canInif=!1);t.liveList=e.data_list,t.buildListData(e.data_list)}))}),200)},resetListData:function(){this.showNoData=!1,this.isFinal=!1,this.canInif=!0,this.positionStr=0,this.liveList=[],this.historyList=[],this.searchLiveResult=[],this.searchPositionStr=0},getLiveList:function(){return this.$services.searchChatLiveList({data:{tenant_key:window.LOCAL_CONFIG.TENANT_KEY,request_num:this.pageSize,position_str:this.positionStr,broker_id:this.$route.query.brokerId}}).then((function(t){return t})).catch((function(t){console.log("getLiveListError: ",t)}))},buildListData:function(t){t.length&&(this.positionStr=t[t.length-1].position_str),t.length<this.pageSize&&(this.isFinal=!0,this.canInif=!1)},loadBottom:function(){var t=this;setTimeout((function(){t.getLiveList().then((function(e){t.liveList=t.liveList.concat(e.data_list),t.buildListData(e.data_list)}))}),200)}},Object(r["a"])(a,"resetListData",(function(){this.liveList=[],this.showNoData=!1,this.canInif=!0,this.isFinal=!1,this.positionStr=0})),Object(r["a"])(a,"searchAdviser",(function(t){var e=this;return this.searchLiveResult=[],this.$services.searchChatLiveList({data:{tenant_key:window.LOCAL_CONFIG.TENANT_KEY,request_num:30,position_str:0,keyword:t}}).then((function(t){e.searchLiveResult=t.data_list}))})),Object(r["a"])(a,"handleClearHistory",(function(){this.historyList=[]})),Object(r["a"])(a,"handleTabChange",(function(t){this.tabKey!==t&&(this.tabKey=t)})),Object(r["a"])(a,"liveClick",(function(t){if(this.$store.getters.isLogin)if("1"===t.room_status)this.$router.push({path:"/live",query:{brokerId:t.broker_id,topicId:t.topic_id}});else{var e={brokerId:t.broker_id,brokerKey:t.broker_key,brokerName:t.broker_name,brokerAvatar:t.broker_avatar,topicId:t.topic_id,chatTopic:t.topic,onlineNum:t.online_num||0,startTime:t.create_time};this.$router.push({path:"/reviewDetail",query:e})}else this.$store.dispatch("nativeMobileLogin")})),a)},b=d,p=(i("0b71"),i("2877")),m=Object(p["a"])(b,s,n,!1,null,"149064dd",null);e["default"]=m.exports},b8ba:function(t,e,i){},de0d:function(t,e,i){i("96cf");var a=i("3b8d"),s=i("d225"),n=i("b0b4"),r=i("308d"),o=i("6bb5"),c=i("4e2b"),l=i("9ab4"),u=i("60a3"),h=i("b3af"),v=function(t){function e(){var t;return Object(s["a"])(this,e),t=Object(r["a"])(this,Object(o["a"])(e).apply(this,arguments)),t.isPullRefreshLoading=!1,t.pullRefreshInitTimerId=null,t}return Object(c["a"])(e,t),Object(n["a"])(e,[{key:"deactivated",value:function(){this.isPullRefreshLoading=!1,this.pullRefreshInitTimerId=null,this.$notify.clear(),clearInterval(this.pullRefreshInitTimerId)}},{key:"onRefresh",value:function(){var t=this;this.pullRefreshInitTimerId=setTimeout(Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.pullRefreshInit();case 2:t.isPullRefreshLoading=!1,t.$notify({message:"数据加载成功",color:"#fff",background:"rgba(0,0,0,.5)"});case 4:case"end":return e.stop()}}),e)}))),h["e"])}}]),e}(u["c"]);v=Object(l["a"])([u["a"]],v),e["a"]=v},f15a:function(t,e,i){var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"live-card-container",on:{click:t.handleClickToLive}},[i("div",{staticClass:"live-adviser-group",style:t.liveData.live_bg&&"background-image: url("+t.formatImage(t.liveData.live_bg)+")"},[i("img",{staticClass:"live-avatar",staticStyle:{"object-fit":"scale-down"},attrs:{src:t._f("formatImagePath")(t.liveData.live_avatar),alt:t.liveData.broker_name},on:{error:t.shopAvatarError}})]),i("div",{staticClass:"live-content"},[i("div",{staticClass:"live-info"},[i("span",{staticClass:"name"},[t._v(t._s(t.liveData.broker_name)+"的直播室")]),i("span",{staticClass:"live-state-sign",class:{living:"1"==t.liveData.room_status}},[t._v("\n        "+t._s("1"==t.liveData.room_status?"直播中":"看回放")+"\n      ")])]),i("div",{staticClass:"topic"},[t._v(t._s(t.liveData.topic))]),i("div",{staticClass:"live-foot"},[i("span",{staticClass:"name"},[t._v(t._s(t.liveData.broker_name))]),i("span",{staticClass:"live-number"},[t._v(t._s(t.liveData.online_num)+"人")]),i("span",{staticClass:"live-time"},[t._v(t._s(t._f("formatTime")(t.liveData.start_time,"yyyy-MM-dd HH:mm")))])])])])},s=[],n=i("d225"),r=i("b0b4"),o=i("308d"),c=i("6bb5"),l=i("4e2b"),u=i("9ab4"),h=i("60a3"),v=i("b1f3"),f=function(t){function e(){return Object(n["a"])(this,e),Object(o["a"])(this,Object(c["a"])(e).apply(this,arguments))}return Object(l["a"])(e,t),Object(r["a"])(e,[{key:"formatImage",value:function(t){return Object(v["b"])(t)}},{key:"handleClickToLive",value:function(){if(this.$store.getters.isLogin)if("1"===this.liveData.room_status)this.$router.push({path:"/live",query:{brokerId:this.liveData.broker_id,topicId:this.liveData.topic_id}});else{var t={brokerId:this.liveData.broker_id,brokerKey:this.liveData.broker_key,brokerName:this.liveData.broker_name,brokerAvatar:this.liveData.broker_avatar,topicId:this.liveData.topic_id,chatTopic:this.liveData.topic,onlineNum:this.liveData.online_num||0,startTime:this.liveData.create_time};this.$router.push({path:"/reviewDetail",query:t})}else this.$store.dispatch("nativeMobileLogin")}}]),e}(h["c"]);Object(u["a"])([Object(h["b"])({type:Object,default:function(){return{}}})],f.prototype,"liveData",void 0),f=Object(u["a"])([h["a"]],f);var d=f,b=d,p=(i("f794"),i("2877")),m=Object(p["a"])(b,a,s,!1,null,"3751be0c",null);e["a"]=m.exports},f6ab:function(t,e,i){t.exports=i.p+"static/img/bg_no_data.93c56ab0.png"},f794:function(t,e,i){var a=i("12e8"),s=i.n(a);s.a}}]);